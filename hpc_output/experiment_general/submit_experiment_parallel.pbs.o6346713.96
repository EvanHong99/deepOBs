This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/AAL_orderbooks/AAL_orderbooks_2019-12-18.csv
data/AAL_orderbooks/AAL_orderbooks_2019-12-10.csv
data/AAL_orderbooks/AAL_orderbooks_2019-11-27.csv
data/AAL_orderbooks/AAL_orderbooks_2019-12-06.csv
data/AAL_orderbooks/AAL_orderbooks_2019-12-02.csv
data/AAL_orderbooks/AAL_orderbooks_2019-12-04.csv
data/AAL_orderbooks/AAL_orderbooks_2019-11-29.csv
data/AAL_orderbooks/AAL_orderbooks_2019-12-20.csv
data/AAL_orderbooks/AAL_orderbooks_2019-12-03.csv
data/AAL_orderbooks/AAL_orderbooks_2019-12-16.csv
data/AAL_orderbooks/AAL_orderbooks_2019-12-05.csv
data/AAL_orderbooks/AAL_orderbooks_2019-11-26.csv
data/AAL_orderbooks/AAL_orderbooks_2019-12-12.csv
data/AAL_orderbooks/AAL_orderbooks_2019-12-11.csv
training model: results/AAL/W9/deepLOB_L1/h10
Epoch 1/50
1577/1577 - 33s - loss: 2.6540 - accuracy10: 0.4938 - val_loss: 2.7059 - val_accuracy10: 0.5149 - 33s/epoch - 21ms/step
Epoch 2/50
1577/1577 - 26s - loss: 2.4842 - accuracy10: 0.5128 - val_loss: 2.6887 - val_accuracy10: 0.5825 - 26s/epoch - 16ms/step
Epoch 3/50
1577/1577 - 25s - loss: 2.3370 - accuracy10: 0.5798 - val_loss: 2.6564 - val_accuracy10: 0.5088 - 25s/epoch - 16ms/step
Epoch 4/50
1577/1577 - 26s - loss: 2.2880 - accuracy10: 0.6017 - val_loss: 2.7052 - val_accuracy10: 0.5718 - 26s/epoch - 17ms/step
Epoch 5/50
1577/1577 - 25s - loss: 2.2243 - accuracy10: 0.6314 - val_loss: 2.6278 - val_accuracy10: 0.6472 - 25s/epoch - 16ms/step
Epoch 6/50
1577/1577 - 25s - loss: 2.1727 - accuracy10: 0.6517 - val_loss: 2.7000 - val_accuracy10: 0.5934 - 25s/epoch - 16ms/step
Epoch 7/50
1577/1577 - 26s - loss: 2.1424 - accuracy10: 0.6614 - val_loss: 2.7239 - val_accuracy10: 0.5716 - 26s/epoch - 17ms/step
Epoch 8/50
1577/1577 - 26s - loss: 2.1202 - accuracy10: 0.6669 - val_loss: 2.7857 - val_accuracy10: 0.5814 - 26s/epoch - 16ms/step
Epoch 9/50
1577/1577 - 26s - loss: 2.0933 - accuracy10: 0.6742 - val_loss: 2.6027 - val_accuracy10: 0.5921 - 26s/epoch - 16ms/step
Epoch 10/50
1577/1577 - 26s - loss: 2.0767 - accuracy10: 0.6780 - val_loss: 2.6451 - val_accuracy10: 0.5941 - 26s/epoch - 16ms/step
Epoch 11/50
1577/1577 - 26s - loss: 2.0542 - accuracy10: 0.6832 - val_loss: 2.5862 - val_accuracy10: 0.6138 - 26s/epoch - 16ms/step
Epoch 12/50
1577/1577 - 25s - loss: 2.0418 - accuracy10: 0.6853 - val_loss: 2.6087 - val_accuracy10: 0.6175 - 25s/epoch - 16ms/step
Epoch 13/50
1577/1577 - 26s - loss: 2.0254 - accuracy10: 0.6883 - val_loss: 2.6579 - val_accuracy10: 0.5928 - 26s/epoch - 16ms/step
Epoch 14/50
1577/1577 - 27s - loss: 2.0154 - accuracy10: 0.6908 - val_loss: 2.6164 - val_accuracy10: 0.6456 - 27s/epoch - 17ms/step
Epoch 15/50
1577/1577 - 26s - loss: 2.0042 - accuracy10: 0.6920 - val_loss: 2.5892 - val_accuracy10: 0.6360 - 26s/epoch - 16ms/step
Epoch 16/50
1577/1577 - 26s - loss: 1.9946 - accuracy10: 0.6918 - val_loss: 2.5589 - val_accuracy10: 0.6304 - 26s/epoch - 16ms/step
Epoch 17/50
1577/1577 - 26s - loss: 1.9861 - accuracy10: 0.6932 - val_loss: 2.4967 - val_accuracy10: 0.6272 - 26s/epoch - 17ms/step
Epoch 18/50
1577/1577 - 26s - loss: 1.9772 - accuracy10: 0.6946 - val_loss: 2.5256 - val_accuracy10: 0.5807 - 26s/epoch - 16ms/step
Epoch 19/50
1577/1577 - 26s - loss: 1.9683 - accuracy10: 0.6969 - val_loss: 2.5423 - val_accuracy10: 0.5979 - 26s/epoch - 16ms/step
Epoch 20/50
1577/1577 - 25s - loss: 1.9604 - accuracy10: 0.6972 - val_loss: 2.5736 - val_accuracy10: 0.5752 - 25s/epoch - 16ms/step
Epoch 21/50
1577/1577 - 25s - loss: 1.9505 - accuracy10: 0.6982 - val_loss: 2.4920 - val_accuracy10: 0.5858 - 25s/epoch - 16ms/step
Epoch 22/50
1577/1577 - 25s - loss: 1.9451 - accuracy10: 0.6986 - val_loss: 2.5114 - val_accuracy10: 0.5959 - 25s/epoch - 16ms/step
Epoch 23/50
1577/1577 - 26s - loss: 1.9367 - accuracy10: 0.7005 - val_loss: 2.4981 - val_accuracy10: 0.5785 - 26s/epoch - 16ms/step
Epoch 24/50
1577/1577 - 26s - loss: 1.9300 - accuracy10: 0.7005 - val_loss: 2.4942 - val_accuracy10: 0.6384 - 26s/epoch - 17ms/step
Epoch 25/50
1577/1577 - 26s - loss: 1.9228 - accuracy10: 0.7013 - val_loss: 2.4908 - val_accuracy10: 0.5823 - 26s/epoch - 16ms/step
Epoch 26/50
1577/1577 - 26s - loss: 1.9177 - accuracy10: 0.7013 - val_loss: 2.5804 - val_accuracy10: 0.5820 - 26s/epoch - 16ms/step
Epoch 27/50
1577/1577 - 26s - loss: 1.9142 - accuracy10: 0.7018 - val_loss: 2.4714 - val_accuracy10: 0.6080 - 26s/epoch - 16ms/step
Epoch 28/50
1577/1577 - 26s - loss: 1.9091 - accuracy10: 0.7012 - val_loss: 2.4624 - val_accuracy10: 0.5932 - 26s/epoch - 16ms/step
Epoch 29/50
1577/1577 - 25s - loss: 1.9003 - accuracy10: 0.7024 - val_loss: 2.4286 - val_accuracy10: 0.6041 - 25s/epoch - 16ms/step
Epoch 30/50
1577/1577 - 26s - loss: 1.8968 - accuracy10: 0.7024 - val_loss: 2.4337 - val_accuracy10: 0.5853 - 26s/epoch - 16ms/step
Epoch 31/50
1577/1577 - 27s - loss: 1.8926 - accuracy10: 0.7031 - val_loss: 2.4510 - val_accuracy10: 0.6224 - 27s/epoch - 17ms/step
Epoch 32/50
1577/1577 - 26s - loss: 1.8835 - accuracy10: 0.7037 - val_loss: 2.5932 - val_accuracy10: 0.5927 - 26s/epoch - 16ms/step
Epoch 33/50
1577/1577 - 26s - loss: 1.8798 - accuracy10: 0.7036 - val_loss: 2.5249 - val_accuracy10: 0.6012 - 26s/epoch - 16ms/step
Epoch 34/50
1577/1577 - 25s - loss: 1.8735 - accuracy10: 0.7038 - val_loss: 2.5549 - val_accuracy10: 0.5749 - 25s/epoch - 16ms/step
Epoch 35/50
1577/1577 - 26s - loss: 1.8695 - accuracy10: 0.7036 - val_loss: 2.5694 - val_accuracy10: 0.6262 - 26s/epoch - 16ms/step
Epoch 36/50
1577/1577 - 26s - loss: 1.8644 - accuracy10: 0.7040 - val_loss: 2.5253 - val_accuracy10: 0.5948 - 26s/epoch - 17ms/step
Epoch 37/50
1577/1577 - 26s - loss: 1.8613 - accuracy10: 0.7046 - val_loss: 2.6070 - val_accuracy10: 0.5601 - 26s/epoch - 16ms/step
Epoch 38/50
1577/1577 - 26s - loss: 1.8552 - accuracy10: 0.7051 - val_loss: 2.5694 - val_accuracy10: 0.6292 - 26s/epoch - 17ms/step
Epoch 39/50
1577/1577 - 26s - loss: 1.8505 - accuracy10: 0.7050 - val_loss: 2.5771 - val_accuracy10: 0.5948 - 26s/epoch - 16ms/step
testing model: results/AAL/W9/deepLOB_L1/h10
Evaluating performance on  test set...
3870/3870 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3117726
{'0': {'precision': 0.1899144552298818, 'recall': 0.7120253540185407, 'f1-score': 0.2998512890366279, 'support': 84247}, '1': {'precision': 0.949908476485497, 'recall': 0.2941892579402573, 'f1-score': 0.4492458463280096, 'support': 825540}, '2': {'precision': 0.14697686846324146, 'recall': 0.7614292247036868, 'f1-score': 0.24639306989495657, 'support': 80911}, 'accuracy': 0.367881029334873, 'macro avg': {'precision': 0.42893326672620674, 'recall': 0.5892146122208283, 'f1-score': 0.3318300684198647, 'support': 990698}, 'weighted avg': {'precision': 0.8197040997274835, 'recall': 0.367881029334873, 'f1-score': 0.41997450000238684, 'support': 990698}}
[[ 59986   6893  17368]
 [242483 242865 340192]
 [ 13389   5914  61608]]
Evaluating performance on  train set...
1577/1577 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93244374
{'0': {'precision': 0.2211366405761145, 'recall': 0.6859166439662218, 'f1-score': 0.3344484937033563, 'support': 29368}, '1': {'precision': 0.9624304896243049, 'recall': 0.5336696440968205, 'f1-score': 0.6866117117284755, 'support': 345712}, '2': {'precision': 0.17663333857967678, 'recall': 0.7500175870559268, 'f1-score': 0.28592883626440674, 'support': 28430}, 'accuracy': 0.5599935565413496, 'macro avg': {'precision': 0.45340015626003205, 'recall': 0.6565346250396563, 'f1-score': 0.43566301389874623, 'support': 403510}, 'weighted avg': {'precision': 0.8531134200026202, 'recall': 0.5599935565413496, 'f1-score': 0.6327499895000173, 'support': 403510}}
[[ 20144   4004   5220]
 [ 67040 184496  94176]
 [  3909   3198  21323]]
Evaluating performance on  val set...
600/600 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8478484
{'0': {'precision': 0.24445171046715986, 'recall': 0.5795542635658915, 'f1-score': 0.3438640871589962, 'support': 10320}, '1': {'precision': 0.9598924271132572, 'recall': 0.5926071272244275, 'f1-score': 0.7328041957715656, 'support': 132506}, '2': {'precision': 0.17372504133282463, 'recall': 0.771460843373494, 'f1-score': 0.28358880315560014, 'support': 10624}, 'accuracy': 0.6041120886282176, 'macro avg': {'precision': 0.4593563929710806, 'recall': 0.6478740780546043, 'f1-score': 0.45341902869538736, 'support': 153450}, 'weighted avg': {'precision': 0.8573470344621067, 'recall': 0.6041120886282176, 'f1-score': 0.675545634337654, 'support': 153450}}
[[ 5981  2001  2338]
 [17338 78524 36644]
 [ 1148  1280  8196]]
training model: results/AAL/W9/deepLOB_L1/h20
Epoch 1/50
1577/1577 - 28s - loss: 2.6637 - accuracy20: 0.5007 - val_loss: 2.9108 - val_accuracy20: 0.4102 - 28s/epoch - 18ms/step
Epoch 2/50
1577/1577 - 27s - loss: 2.4919 - accuracy20: 0.5356 - val_loss: 2.7429 - val_accuracy20: 0.5553 - 27s/epoch - 17ms/step
Epoch 3/50
1577/1577 - 25s - loss: 2.4063 - accuracy20: 0.5793 - val_loss: 2.5804 - val_accuracy20: 0.5042 - 25s/epoch - 16ms/step
Epoch 4/50
1577/1577 - 24s - loss: 2.3260 - accuracy20: 0.6151 - val_loss: 2.5767 - val_accuracy20: 0.6133 - 24s/epoch - 15ms/step
Epoch 5/50
1577/1577 - 26s - loss: 2.2698 - accuracy20: 0.6369 - val_loss: 2.6546 - val_accuracy20: 0.6793 - 26s/epoch - 16ms/step
Epoch 6/50
1577/1577 - 26s - loss: 2.2280 - accuracy20: 0.6463 - val_loss: 2.5778 - val_accuracy20: 0.6083 - 26s/epoch - 16ms/step
Epoch 7/50
1577/1577 - 25s - loss: 2.2018 - accuracy20: 0.6535 - val_loss: 2.6255 - val_accuracy20: 0.5748 - 25s/epoch - 16ms/step
Epoch 8/50
1577/1577 - 26s - loss: 2.1814 - accuracy20: 0.6580 - val_loss: 2.6019 - val_accuracy20: 0.6811 - 26s/epoch - 16ms/step
Epoch 9/50
1577/1577 - 26s - loss: 2.1667 - accuracy20: 0.6593 - val_loss: 2.7133 - val_accuracy20: 0.5571 - 26s/epoch - 17ms/step
Epoch 10/50
1577/1577 - 26s - loss: 2.1510 - accuracy20: 0.6610 - val_loss: 2.6025 - val_accuracy20: 0.5999 - 26s/epoch - 16ms/step
Epoch 11/50
1577/1577 - 26s - loss: 2.1334 - accuracy20: 0.6642 - val_loss: 2.6713 - val_accuracy20: 0.5750 - 26s/epoch - 17ms/step
Epoch 12/50
1577/1577 - 26s - loss: 2.1176 - accuracy20: 0.6654 - val_loss: 2.6941 - val_accuracy20: 0.4897 - 26s/epoch - 16ms/step
Epoch 13/50
1577/1577 - 26s - loss: 2.1038 - accuracy20: 0.6672 - val_loss: 2.7575 - val_accuracy20: 0.5703 - 26s/epoch - 17ms/step
Epoch 14/50
1577/1577 - 25s - loss: 2.0966 - accuracy20: 0.6671 - val_loss: 2.5815 - val_accuracy20: 0.5678 - 25s/epoch - 16ms/step
testing model: results/AAL/W9/deepLOB_L1/h20
Evaluating performance on  test set...
3870/3870 - 28s - 28s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1371424
{'0': {'precision': 0.22396927912480488, 'recall': 0.7325024052421277, 'f1-score': 0.3430483899120368, 'support': 115373}, '1': {'precision': 0.8803606987832227, 'recall': 0.3663532370301823, 'f1-score': 0.5173969464662481, 'support': 765084}, '2': {'precision': 0.22324337334693864, 'recall': 0.5973548861131521, 'f1-score': 0.32502023572147754, 'support': 110241}, 'accuracy': 0.4346985660615041, 'macro avg': {'precision': 0.44252445041832206, 'recall': 0.5654035094618207, 'f1-score': 0.39515519069992083, 'support': 990698}, 'weighted avg': {'precision': 0.7307983514950763, 'recall': 0.4346985660615041, 'f1-score': 0.4756860345793327, 'support': 990698}}
[[ 84511  15546  15316]
 [270979 280291 213814]
 [ 21843  22545  65853]]
Evaluating performance on  train set...
1577/1577 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90268415
{'0': {'precision': 0.23783763686725037, 'recall': 0.6325521605853851, 'f1-score': 0.3456950242505303, 'support': 40452}, '1': {'precision': 0.9027564383031981, 'recall': 0.5479067986586714, 'f1-score': 0.6819313779745435, 'support': 323858}, '2': {'precision': 0.2453454904091943, 'recall': 0.6219132653061225, 'f1-score': 0.3518756404890089, 'support': 39200}, 'accuracy': 0.5635820673589255, 'macro avg': {'precision': 0.4619798551932142, 'recall': 0.6007907415167263, 'f1-score': 0.45983401423802756, 'support': 403510}, 'weighted avg': {'precision': 0.7722322765398417, 'recall': 0.5635820673589255, 'f1-score': 0.6161594816391943, 'support': 403510}}
[[ 25588   9450   5414]
 [ 76841 177444  69573]
 [  5157   9664  24379]]
Evaluating performance on  val set...
600/600 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8232051
{'0': {'precision': 0.25462051444903144, 'recall': 0.5553400748026043, 'f1-score': 0.3491551994426058, 'support': 14438}, '1': {'precision': 0.8934878331402085, 'recall': 0.6206324804211171, 'f1-score': 0.7324749098750363, 'support': 124241}, '2': {'precision': 0.25347728547392034, 'recall': 0.611942319409654, 'f1-score': 0.35846998869742813, 'support': 14771}, 'accuracy': 0.6136526555881394, 'macro avg': {'precision': 0.4671952110210535, 'recall': 0.5959716248777919, 'f1-score': 0.4800333660050234, 'support': 153450}, 'weighted avg': {'precision': 0.771770256425696, 'recall': 0.6136526555881394, 'f1-score': 0.6604071570569334, 'support': 153450}}
[[ 8018  4681  1739]
 [22251 77108 24882]
 [ 1221  4511  9039]]
training model: results/AAL/W9/deepLOB_L1/h30
Epoch 1/50
1577/1577 - 29s - loss: 2.7581 - accuracy30: 0.4787 - val_loss: 3.5283 - val_accuracy30: 0.5731 - 29s/epoch - 18ms/step
Epoch 2/50
1577/1577 - 26s - loss: 2.6662 - accuracy30: 0.4795 - val_loss: 2.8037 - val_accuracy30: 0.2733 - 26s/epoch - 17ms/step
Epoch 3/50
1577/1577 - 26s - loss: 2.5730 - accuracy30: 0.5219 - val_loss: 2.7233 - val_accuracy30: 0.5176 - 26s/epoch - 17ms/step
Epoch 4/50
1577/1577 - 26s - loss: 2.5012 - accuracy30: 0.5638 - val_loss: 2.6593 - val_accuracy30: 0.4293 - 26s/epoch - 17ms/step
Epoch 5/50
1577/1577 - 27s - loss: 2.4361 - accuracy30: 0.5908 - val_loss: 2.6065 - val_accuracy30: 0.5252 - 27s/epoch - 17ms/step
Epoch 6/50
1577/1577 - 27s - loss: 2.3841 - accuracy30: 0.6108 - val_loss: 2.5890 - val_accuracy30: 0.5051 - 27s/epoch - 17ms/step
Epoch 7/50
1577/1577 - 26s - loss: 2.3547 - accuracy30: 0.6207 - val_loss: 2.6590 - val_accuracy30: 0.4402 - 26s/epoch - 17ms/step
Epoch 8/50
1577/1577 - 26s - loss: 2.3285 - accuracy30: 0.6262 - val_loss: 2.6349 - val_accuracy30: 0.4901 - 26s/epoch - 17ms/step
Epoch 9/50
1577/1577 - 26s - loss: 2.3066 - accuracy30: 0.6330 - val_loss: 2.6715 - val_accuracy30: 0.4357 - 26s/epoch - 17ms/step
Epoch 10/50
1577/1577 - 27s - loss: 2.2915 - accuracy30: 0.6348 - val_loss: 2.6241 - val_accuracy30: 0.4470 - 27s/epoch - 17ms/step
Epoch 11/50
1577/1577 - 27s - loss: 2.2765 - accuracy30: 0.6371 - val_loss: 2.6683 - val_accuracy30: 0.3935 - 27s/epoch - 17ms/step
Epoch 12/50
1577/1577 - 26s - loss: 2.2616 - accuracy30: 0.6397 - val_loss: 2.7440 - val_accuracy30: 0.4335 - 26s/epoch - 17ms/step
Epoch 13/50
1577/1577 - 26s - loss: 2.2457 - accuracy30: 0.6410 - val_loss: 2.7544 - val_accuracy30: 0.3832 - 26s/epoch - 17ms/step
Epoch 14/50
1577/1577 - 26s - loss: 2.2322 - accuracy30: 0.6432 - val_loss: 2.7210 - val_accuracy30: 0.3968 - 26s/epoch - 17ms/step
Epoch 15/50
1577/1577 - 27s - loss: 2.2196 - accuracy30: 0.6436 - val_loss: 2.7094 - val_accuracy30: 0.4164 - 27s/epoch - 17ms/step
Epoch 16/50
1577/1577 - 26s - loss: 2.2089 - accuracy30: 0.6459 - val_loss: 2.7024 - val_accuracy30: 0.3771 - 26s/epoch - 17ms/step
testing model: results/AAL/W9/deepLOB_L1/h30
Evaluating performance on  test set...
3870/3870 - 26s - 26s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1431966
{'0': {'precision': 0.25679934720277886, 'recall': 0.7432506608502217, 'f1-score': 0.38171348028078894, 'support': 138458}, '1': {'precision': 0.8749056944360875, 'recall': 0.26245628065907733, 'f1-score': 0.40378437035391423, 'support': 720219}, '2': {'precision': 0.23607411448805588, 'recall': 0.6686057521151938, 'f1-score': 0.3489422428838829, 'support': 132021}, 'accuracy': 0.38377487387680204, 'macro avg': {'precision': 0.45592638537564073, 'recall': 0.5581042312081642, 'f1-score': 0.3781466978395287, 'support': 990698}, 'weighted avg': {'precision': 0.7033892962586928, 'recall': 0.38377487387680204, 'f1-score': 0.3933914919909159, 'support': 990698}}
[[102909  13691  21858]
 [267413 189026 263780]
 [ 30415  13336  88270]]
Evaluating performance on  train set...
1577/1577 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.989423
{'0': {'precision': 0.2631878621428811, 'recall': 0.6426629045778895, 'f1-score': 0.3734413705840071, 'support': 48909}, '1': {'precision': 0.8831396187037024, 'recall': 0.41885036662716035, 'f1-score': 0.5682122861843921, 'support': 307124}, '2': {'precision': 0.23709552741274806, 'recall': 0.6912610316574341, 'f1-score': 0.3530861009801074, 'support': 47477}, 'accuracy': 0.47803028425565663, 'macro avg': {'precision': 0.4611410027531105, 'recall': 0.5842581009541613, 'f1-score': 0.43157991924950223, 'support': 403510}, 'weighted avg': {'precision': 0.7319823839787789, 'recall': 0.47803028425565663, 'f1-score': 0.5192925652207405, 'support': 403510}}
[[ 31432   9772   7705]
 [ 80588 128639  97897]
 [  7408   7250  32819]]
Evaluating performance on  val set...
600/600 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9491172
{'0': {'precision': 0.285843229063831, 'recall': 0.5759590792838875, 'f1-score': 0.38206906952194236, 'support': 17595}, '1': {'precision': 0.8911587185779665, 'recall': 0.45568546985357083, 'f1-score': 0.6030216158295417, 'support': 117941}, '2': {'precision': 0.23623221064674374, 'recall': 0.7607457854192252, 'f1-score': 0.36051479438646616, 'support': 17914}, 'accuracy': 0.505089605734767, 'macro avg': {'precision': 0.4710780527628471, 'recall': 0.5974634448522278, 'f1-score': 0.4485351599126501, 'support': 153450}, 'weighted avg': {'precision': 0.7452944012037004, 'recall': 0.505089605734767, 'f1-score': 0.5493759511073947, 'support': 153450}}
[[10134  3842  3619]
 [23755 53744 40442]
 [ 1564  2722 13628]]
training model: results/AAL/W9/deepLOB_L1/h50
Epoch 1/50
1577/1577 - 28s - loss: 2.8595 - accuracy50: 0.4681 - val_loss: 3.5710 - val_accuracy50: 0.4093 - 28s/epoch - 18ms/step
Epoch 2/50
1577/1577 - 26s - loss: 2.8038 - accuracy50: 0.4674 - val_loss: 2.9117 - val_accuracy50: 0.3745 - 26s/epoch - 16ms/step
Epoch 3/50
1577/1577 - 26s - loss: 2.7244 - accuracy50: 0.4978 - val_loss: 2.8528 - val_accuracy50: 0.4386 - 26s/epoch - 16ms/step
Epoch 4/50
1577/1577 - 26s - loss: 2.6662 - accuracy50: 0.5351 - val_loss: 2.8469 - val_accuracy50: 0.5082 - 26s/epoch - 16ms/step
Epoch 5/50
1577/1577 - 26s - loss: 2.6169 - accuracy50: 0.5540 - val_loss: 2.9012 - val_accuracy50: 0.5760 - 26s/epoch - 16ms/step
Epoch 6/50
1577/1577 - 26s - loss: 2.5772 - accuracy50: 0.5704 - val_loss: 3.0556 - val_accuracy50: 0.6416 - 26s/epoch - 17ms/step
Epoch 7/50
1577/1577 - 26s - loss: 2.5481 - accuracy50: 0.5841 - val_loss: 3.0717 - val_accuracy50: 0.6321 - 26s/epoch - 16ms/step
Epoch 8/50
1577/1577 - 26s - loss: 2.5223 - accuracy50: 0.5919 - val_loss: 3.0907 - val_accuracy50: 0.6367 - 26s/epoch - 16ms/step
Epoch 9/50
1577/1577 - 26s - loss: 2.5044 - accuracy50: 0.5981 - val_loss: 3.1278 - val_accuracy50: 0.6121 - 26s/epoch - 16ms/step
Epoch 10/50
1577/1577 - 26s - loss: 2.4861 - accuracy50: 0.6009 - val_loss: 3.0447 - val_accuracy50: 0.5785 - 26s/epoch - 17ms/step
Epoch 11/50
1577/1577 - 26s - loss: 2.4727 - accuracy50: 0.6042 - val_loss: 3.2678 - val_accuracy50: 0.5999 - 26s/epoch - 16ms/step
Epoch 12/50
1577/1577 - 27s - loss: 2.4549 - accuracy50: 0.6075 - val_loss: 3.0186 - val_accuracy50: 0.5402 - 27s/epoch - 17ms/step
Epoch 13/50
1577/1577 - 26s - loss: 2.4441 - accuracy50: 0.6086 - val_loss: 3.1595 - val_accuracy50: 0.5398 - 26s/epoch - 16ms/step
Epoch 14/50
1577/1577 - 26s - loss: 2.4326 - accuracy50: 0.6075 - val_loss: 3.0319 - val_accuracy50: 0.5938 - 26s/epoch - 16ms/step
testing model: results/AAL/W9/deepLOB_L1/h50
Evaluating performance on  test set...
3870/3870 - 26s - 26s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1038865
{'0': {'precision': 0.3071876260928043, 'recall': 0.6454178087998418, 'f1-score': 0.4162570509490874, 'support': 176935}, '1': {'precision': 0.7967822361805584, 'recall': 0.2681177893863475, 'f1-score': 0.40122356401168074, 'support': 647223}, '2': {'precision': 0.2699392008615081, 'recall': 0.6502221688483247, 'f1-score': 0.38149928571051106, 'support': 166540}, 'accuracy': 0.3997353381151471, 'macro avg': {'precision': 0.45796968771162355, 'recall': 0.5212525890115046, 'f1-score': 0.3996599668904264, 'support': 990698}, 'weighted avg': {'precision': 0.6207781850591154, 'recall': 0.3997353381151471, 'f1-score': 0.40059276502247637, 'support': 990698}}
[[114197  16162  46576]
 [227398 173532 246293]
 [ 30155  28097 108288]]
Evaluating performance on  train set...
1577/1577 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9712497
{'0': {'precision': 0.3026188487649982, 'recall': 0.5786752265144447, 'f1-score': 0.397411115696197, 'support': 63241}, '1': {'precision': 0.8053656502344155, 'recall': 0.4570840460591195, 'f1-score': 0.5831832999714042, 'support': 278859}, '2': {'precision': 0.2927449261139221, 'recall': 0.5926070672528904, 'f1-score': 0.39189545721316155, 'support': 61410}, 'accuracy': 0.4967658794081931, 'macro avg': {'precision': 0.466909808371112, 'recall': 0.5427887799421516, 'f1-score': 0.45749662429358756, 'support': 403510}, 'weighted avg': {'precision': 0.6485560317863798, 'recall': 0.4967658794081931, 'f1-score': 0.524955734038634, 'support': 403510}}
[[ 36596  14072  12573]
 [ 76049 127462  75348]
 [  8286  16732  36392]]
Evaluating performance on  val set...
600/600 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93503004
{'0': {'precision': 0.29658378085653686, 'recall': 0.5730479138509831, 'f1-score': 0.39087056724407104, 'support': 22937}, '1': {'precision': 0.8116354501224282, 'recall': 0.4756389590302172, 'f1-score': 0.5997873302901591, 'support': 107323}, '2': {'precision': 0.297201436048272, 'recall': 0.5925830099180681, 'f1-score': 0.39586334043901594, 'support': 23190}, 'accuracy': 0.5078722710980775, 'macro avg': {'precision': 0.4684735556757457, 'recall': 0.5470899609330894, 'f1-score': 0.462173745991082, 'support': 153450}, 'weighted avg': {'precision': 0.6569044959071696, 'recall': 0.5078722710980775, 'f1-score': 0.5377415751996663, 'support': 153450}}
[[13144  4919  4874]
 [28654 51047 27622]
 [ 2520  6928 13742]]
training model: results/AAL/W9/deepLOB_L1/h100
Epoch 1/50
1577/1577 - 28s - loss: 3.0338 - accuracy100: 0.4627 - val_loss: 3.2420 - val_accuracy100: 0.3856 - 28s/epoch - 17ms/step
Epoch 2/50
1577/1577 - 25s - loss: 2.9976 - accuracy100: 0.4553 - val_loss: 3.4429 - val_accuracy100: 0.3239 - 25s/epoch - 16ms/step
Epoch 3/50
1577/1577 - 26s - loss: 2.9644 - accuracy100: 0.4639 - val_loss: 3.4679 - val_accuracy100: 0.4393 - 26s/epoch - 16ms/step
Epoch 4/50
1577/1577 - 25s - loss: 2.9186 - accuracy100: 0.4883 - val_loss: 3.2769 - val_accuracy100: 0.4679 - 25s/epoch - 16ms/step
Epoch 5/50
1577/1577 - 25s - loss: 2.8918 - accuracy100: 0.5027 - val_loss: 3.2301 - val_accuracy100: 0.3991 - 25s/epoch - 16ms/step
Epoch 6/50
1577/1577 - 25s - loss: 2.8664 - accuracy100: 0.5133 - val_loss: 3.2607 - val_accuracy100: 0.3017 - 25s/epoch - 16ms/step
Epoch 7/50
1577/1577 - 25s - loss: 2.8520 - accuracy100: 0.5194 - val_loss: 3.2412 - val_accuracy100: 0.3721 - 25s/epoch - 16ms/step
Epoch 8/50
1577/1577 - 25s - loss: 2.8351 - accuracy100: 0.5256 - val_loss: 3.4150 - val_accuracy100: 0.3438 - 25s/epoch - 16ms/step
Epoch 9/50
1577/1577 - 25s - loss: 2.8281 - accuracy100: 0.5301 - val_loss: 3.2774 - val_accuracy100: 0.3300 - 25s/epoch - 16ms/step
Epoch 10/50
1577/1577 - 25s - loss: 2.8086 - accuracy100: 0.5341 - val_loss: 3.2489 - val_accuracy100: 0.3942 - 25s/epoch - 16ms/step
Epoch 11/50
1577/1577 - 26s - loss: 2.7915 - accuracy100: 0.5410 - val_loss: 3.2253 - val_accuracy100: 0.3993 - 26s/epoch - 16ms/step
Epoch 12/50
1577/1577 - 26s - loss: 2.7782 - accuracy100: 0.5433 - val_loss: 3.1941 - val_accuracy100: 0.3726 - 26s/epoch - 16ms/step
Epoch 13/50
1577/1577 - 26s - loss: 2.7683 - accuracy100: 0.5456 - val_loss: 3.2510 - val_accuracy100: 0.4057 - 26s/epoch - 17ms/step
Epoch 14/50
1577/1577 - 25s - loss: 2.7574 - accuracy100: 0.5468 - val_loss: 3.2456 - val_accuracy100: 0.4087 - 25s/epoch - 16ms/step
Epoch 15/50
1577/1577 - 25s - loss: 2.7460 - accuracy100: 0.5499 - val_loss: 3.2174 - val_accuracy100: 0.3892 - 25s/epoch - 16ms/step
Epoch 16/50
1577/1577 - 25s - loss: 2.7358 - accuracy100: 0.5508 - val_loss: 3.2887 - val_accuracy100: 0.4137 - 25s/epoch - 16ms/step
Epoch 17/50
1577/1577 - 25s - loss: 2.7287 - accuracy100: 0.5518 - val_loss: 3.2760 - val_accuracy100: 0.3836 - 25s/epoch - 16ms/step
Epoch 18/50
1577/1577 - 25s - loss: 2.7213 - accuracy100: 0.5547 - val_loss: 3.3484 - val_accuracy100: 0.3643 - 25s/epoch - 16ms/step
Epoch 19/50
1577/1577 - 25s - loss: 2.7115 - accuracy100: 0.5562 - val_loss: 3.4228 - val_accuracy100: 0.3992 - 25s/epoch - 16ms/step
Epoch 20/50
1577/1577 - 25s - loss: 2.7069 - accuracy100: 0.5565 - val_loss: 3.3926 - val_accuracy100: 0.4315 - 25s/epoch - 16ms/step
Epoch 21/50
1577/1577 - 25s - loss: 2.7021 - accuracy100: 0.5580 - val_loss: 3.2224 - val_accuracy100: 0.4094 - 25s/epoch - 16ms/step
Epoch 22/50
1577/1577 - 25s - loss: 2.7032 - accuracy100: 0.5573 - val_loss: 3.2508 - val_accuracy100: 0.4197 - 25s/epoch - 16ms/step
testing model: results/AAL/W9/deepLOB_L1/h100
Evaluating performance on  test set...
3870/3870 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2999399
{'0': {'precision': 0.2869256023072586, 'recall': 0.5849557669006954, 'f1-score': 0.3850037210763128, 'support': 240996}, '1': {'precision': 0.4859440420017279, 'recall': 0.08387260815287939, 'f1-score': 0.14305441656707876, 'support': 523079}, '2': {'precision': 0.27987494408416586, 'recall': 0.5052267422106318, 'f1-score': 0.36020889699867864, 'support': 226623}, 'accuracy': 0.3021506049270312, 'macro avg': {'precision': 0.35091486279771744, 'recall': 0.39135170575473555, 'f1-score': 0.29608901154735673, 'support': 990698}, 'weighted avg': {'precision': 0.3903925772062201, 'recall': 0.3021506049270312, 'f1-score': 0.25158498229786436, 'support': 990698}}
[[140972  24110  75914]
 [260520  43872 218687]
 [ 89827  22300 114496]]
Evaluating performance on  train set...
1577/1577 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1601416
{'0': {'precision': 0.2929737478083685, 'recall': 0.5594123235613464, 'f1-score': 0.38455139169647024, 'support': 88416}, '1': {'precision': 0.6121341683029127, 'recall': 0.23095266274783127, 'f1-score': 0.33537237428389555, 'support': 228129}, '2': {'precision': 0.2879991925444942, 'recall': 0.4921635140573794, 'f1-score': 0.36336700908396297, 'support': 86965}, 'accuracy': 0.35922034150330845, 'macro avg': {'precision': 0.3977023695519251, 'recall': 0.42750950012218575, 'f1-score': 0.3610969250214429, 'support': 403510}, 'weighted avg': {'precision': 0.47234262433801344, 'recall': 0.35922034150330845, 'f1-score': 0.35218178525001304, 'support': 403510}}
[[49461 17542 21413]
 [91041 52687 84401]
 [28322 15842 42801]]
Evaluating performance on  val set...
600/600 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1331921
{'0': {'precision': 0.28085873378608905, 'recall': 0.5382100783322026, 'f1-score': 0.3691045218053382, 'support': 32426}, '1': {'precision': 0.6714741245648421, 'recall': 0.26025875069449955, 'f1-score': 0.37512257305353985, 'support': 88193}, '2': {'precision': 0.29449141416793573, 'recall': 0.5124425086046724, 'f1-score': 0.37403290351267227, 'support': 32831}, 'accuracy': 0.3729488432714239, 'macro avg': {'precision': 0.4156080908396223, 'recall': 0.43697044587712486, 'f1-score': 0.3727533327905168, 'support': 153450}, 'weighted avg': {'precision': 0.5082755971850266, 'recall': 0.3729488432714239, 'f1-score': 0.3736177423564372, 'support': 153450}}
[[17452  6014  8960]
 [33895 22953 31345]
 [10791  5216 16824]]
training model: results/AAL/W9/deepLOB_L1/h200
Epoch 1/50
1577/1577 - 27s - loss: 3.1599 - accuracy200: 0.4432 - val_loss: 3.6753 - val_accuracy200: 0.3090 - 27s/epoch - 17ms/step
Epoch 2/50
1577/1577 - 25s - loss: 3.1404 - accuracy200: 0.4440 - val_loss: 3.5826 - val_accuracy200: 0.3414 - 25s/epoch - 16ms/step
Epoch 3/50
1577/1577 - 25s - loss: 3.1272 - accuracy200: 0.4485 - val_loss: 3.4447 - val_accuracy200: 0.3536 - 25s/epoch - 16ms/step
Epoch 4/50
1577/1577 - 25s - loss: 3.1029 - accuracy200: 0.4598 - val_loss: 3.4317 - val_accuracy200: 0.3429 - 25s/epoch - 16ms/step
Epoch 5/50
1577/1577 - 25s - loss: 3.0900 - accuracy200: 0.4629 - val_loss: 3.3438 - val_accuracy200: 0.4118 - 25s/epoch - 16ms/step
Epoch 6/50
1577/1577 - 25s - loss: 3.0689 - accuracy200: 0.4728 - val_loss: 3.3116 - val_accuracy200: 0.4112 - 25s/epoch - 16ms/step
Epoch 7/50
1577/1577 - 25s - loss: 3.0586 - accuracy200: 0.4761 - val_loss: 3.3229 - val_accuracy200: 0.4208 - 25s/epoch - 16ms/step
Epoch 8/50
1577/1577 - 25s - loss: 3.0480 - accuracy200: 0.4795 - val_loss: 3.3337 - val_accuracy200: 0.4235 - 25s/epoch - 16ms/step
Epoch 9/50
1577/1577 - 26s - loss: 3.0372 - accuracy200: 0.4850 - val_loss: 3.3309 - val_accuracy200: 0.4232 - 26s/epoch - 16ms/step
Epoch 10/50
1577/1577 - 25s - loss: 3.0303 - accuracy200: 0.4866 - val_loss: 3.3252 - val_accuracy200: 0.4209 - 25s/epoch - 16ms/step
Epoch 11/50
1577/1577 - 25s - loss: 3.0231 - accuracy200: 0.4887 - val_loss: 3.3343 - val_accuracy200: 0.4231 - 25s/epoch - 16ms/step
Epoch 12/50
1577/1577 - 25s - loss: 3.0173 - accuracy200: 0.4917 - val_loss: 3.3169 - val_accuracy200: 0.3679 - 25s/epoch - 16ms/step
Epoch 13/50
1577/1577 - 25s - loss: 3.0113 - accuracy200: 0.4931 - val_loss: 3.3171 - val_accuracy200: 0.3744 - 25s/epoch - 16ms/step
Epoch 14/50
1577/1577 - 25s - loss: 3.0088 - accuracy200: 0.4935 - val_loss: 3.3278 - val_accuracy200: 0.3904 - 25s/epoch - 16ms/step
Epoch 15/50
1577/1577 - 26s - loss: 3.0020 - accuracy200: 0.4954 - val_loss: 3.3191 - val_accuracy200: 0.3642 - 26s/epoch - 16ms/step
Epoch 16/50
1577/1577 - 25s - loss: 2.9987 - accuracy200: 0.4969 - val_loss: 3.3277 - val_accuracy200: 0.3496 - 25s/epoch - 16ms/step
testing model: results/AAL/W9/deepLOB_L1/h200
Evaluating performance on  test set...
3870/3870 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1012237
{'0': {'precision': 0.311568629820766, 'recall': 0.33352308378992035, 'f1-score': 0.32217226802803123, 'support': 309178}, '1': {'precision': 0.38497178819444444, 'recall': 0.635042356954186, 'f1-score': 0.47935294407166174, 'support': 391081}, '2': {'precision': 0.3498015601478035, 'recall': 0.01760094202224908, 'f1-score': 0.033515487472668685, 'support': 290439}, 'accuracy': 0.35993107889588954, 'macro avg': {'precision': 0.3487806593876713, 'recall': 0.3287221275887851, 'f1-score': 0.27834689985745387, 'support': 990698}, 'weighted avg': {'precision': 0.351753342650701, 'recall': 0.35993107889588954, 'f1-score': 0.29959544772567887, 'support': 990698}}
[[103118 202717   3343]
 [136569 248353   6159]
 [ 91277 194050   5112]]
Evaluating performance on  train set...
1577/1577 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0985001
{'0': {'precision': 0.3117982541881635, 'recall': 0.3206363080150337, 'f1-score': 0.316155526731965, 'support': 114410}, '1': {'precision': 0.43161580920641535, 'recall': 0.5651837919846352, 'f1-score': 0.4894509577177163, 'support': 175987}, '2': {'precision': 0.30238769874930066, 'recall': 0.14812621007311272, 'f1-score': 0.19884644141417737, 'support': 113113}, 'accuracy': 0.37893484672003175, 'macro avg': {'precision': 0.3486005873812932, 'recall': 0.3446487700242605, 'f1-score': 0.33481764195461955, 'support': 403510}, 'weighted avg': {'precision': 0.36141753474537647, 'recall': 0.37893484672003175, 'f1-score': 0.3588522639759949, 'support': 403510}}
[[36684 64703 13023]
 [50891 99465 25631]
 [30078 66280 16755]]
Evaluating performance on  val set...
600/600 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0863742
{'0': {'precision': 0.29156066806769165, 'recall': 0.25007708180157956, 'f1-score': 0.2692302781927049, 'support': 42163}, '1': {'precision': 0.44834179239379823, 'recall': 0.7594064652888183, 'f1-score': 0.5638156025268312, 'support': 67932}, '2': {'precision': 0.3235823582358236, 'recall': 0.01658401568446546, 'f1-score': 0.031551001601685065, 'support': 43355}, 'accuracy': 0.4095861844248941, 'macro avg': {'precision': 0.3544949395657711, 'recall': 0.3420225209249544, 'f1-score': 0.28819896077374035, 'support': 153450}, 'weighted avg': {'precision': 0.37001459908730994, 'recall': 0.4095861844248941, 'f1-score': 0.3324898755603308, 'support': 153450}}
[[10544 31074   545]
 [15386 51588   958]
 [10234 32402   719]]
training model: results/AAL/W9/deepLOB_L1/h300
Epoch 1/50
1577/1577 - 28s - loss: 3.2021 - accuracy300: 0.4287 - val_loss: 3.4046 - val_accuracy300: 0.3635 - 28s/epoch - 18ms/step
Epoch 2/50
1577/1577 - 25s - loss: 3.2071 - accuracy300: 0.4199 - val_loss: 3.5449 - val_accuracy300: 0.3286 - 25s/epoch - 16ms/step
Epoch 3/50
1577/1577 - 25s - loss: 3.1805 - accuracy300: 0.4341 - val_loss: 3.3019 - val_accuracy300: 0.3627 - 25s/epoch - 16ms/step
Epoch 4/50
1577/1577 - 26s - loss: 3.1595 - accuracy300: 0.4435 - val_loss: 3.3398 - val_accuracy300: 0.3658 - 26s/epoch - 16ms/step
Epoch 5/50
1577/1577 - 26s - loss: 3.1319 - accuracy300: 0.4534 - val_loss: 3.2941 - val_accuracy300: 0.3706 - 26s/epoch - 16ms/step
Epoch 6/50
1577/1577 - 26s - loss: 3.1183 - accuracy300: 0.4593 - val_loss: 3.2938 - val_accuracy300: 0.3661 - 26s/epoch - 16ms/step
Epoch 7/50
1577/1577 - 25s - loss: 3.1093 - accuracy300: 0.4621 - val_loss: 3.3208 - val_accuracy300: 0.3686 - 25s/epoch - 16ms/step
Epoch 8/50
1577/1577 - 26s - loss: 3.0992 - accuracy300: 0.4650 - val_loss: 3.2922 - val_accuracy300: 0.3752 - 26s/epoch - 16ms/step
Epoch 9/50
1577/1577 - 27s - loss: 3.0919 - accuracy300: 0.4675 - val_loss: 3.2939 - val_accuracy300: 0.3707 - 27s/epoch - 17ms/step
Epoch 10/50
1577/1577 - 26s - loss: 3.0861 - accuracy300: 0.4699 - val_loss: 3.3061 - val_accuracy300: 0.3660 - 26s/epoch - 16ms/step
Epoch 11/50
1577/1577 - 26s - loss: 3.0810 - accuracy300: 0.4713 - val_loss: 3.3078 - val_accuracy300: 0.3688 - 26s/epoch - 16ms/step
Epoch 12/50
1577/1577 - 25s - loss: 3.0745 - accuracy300: 0.4723 - val_loss: 3.3117 - val_accuracy300: 0.3672 - 25s/epoch - 16ms/step
Epoch 13/50
1577/1577 - 25s - loss: 3.0715 - accuracy300: 0.4740 - val_loss: 3.3239 - val_accuracy300: 0.3597 - 25s/epoch - 16ms/step
Epoch 14/50
1577/1577 - 25s - loss: 3.0665 - accuracy300: 0.4754 - val_loss: 3.3138 - val_accuracy300: 0.3632 - 25s/epoch - 16ms/step
Epoch 15/50
1577/1577 - 25s - loss: 3.0608 - accuracy300: 0.4765 - val_loss: 3.3242 - val_accuracy300: 0.3535 - 25s/epoch - 16ms/step
Epoch 16/50
1577/1577 - 24s - loss: 3.0583 - accuracy300: 0.4776 - val_loss: 3.3504 - val_accuracy300: 0.3623 - 24s/epoch - 15ms/step
Epoch 17/50
1577/1577 - 25s - loss: 3.0542 - accuracy300: 0.4792 - val_loss: 3.3236 - val_accuracy300: 0.3628 - 25s/epoch - 16ms/step
Epoch 18/50
1577/1577 - 25s - loss: 3.0494 - accuracy300: 0.4803 - val_loss: 3.3257 - val_accuracy300: 0.3681 - 25s/epoch - 16ms/step
testing model: results/AAL/W9/deepLOB_L1/h300
Evaluating performance on  test set...
3870/3870 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1037784
{'0': {'precision': 0.38541391415952586, 'recall': 0.0589212959222539, 'f1-score': 0.10221601517722614, 'support': 346564}, '1': {'precision': 0.3271956447130235, 'recall': 0.7576054099535666, 'f1-score': 0.4570150249789688, 'support': 320890}, '2': {'precision': 0.35945067304877487, 'recall': 0.21652064694162923, 'f1-score': 0.2702512766553079, 'support': 323244}, 'accuracy': 0.33664850438781546, 'macro avg': {'precision': 0.35735341064044146, 'recall': 0.3443491176058166, 'f1-score': 0.2764941056038343, 'support': 990698}, 'weighted avg': {'precision': 0.3580855836367109, 'recall': 0.33664850438781546, 'f1-score': 0.2719628445000897, 'support': 990698}}
[[ 20420 261698  64446]
 [ 17506 243108  60276]
 [ 15056 238199  69989]]
Evaluating performance on  train set...
1577/1577 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0992306
{'0': {'precision': 0.3876253004279266, 'recall': 0.10229180041303457, 'f1-score': 0.16186775190477648, 'support': 129287}, '1': {'precision': 0.3705849750592029, 'recall': 0.6965715986578634, 'f1-score': 0.483788367842662, 'support': 147824}, '2': {'precision': 0.35642493499683175, 'recall': 0.2581112192343294, 'f1-score': 0.299403945249228, 'support': 126399}, 'accuracy': 0.36881366013233874, 'macro avg': {'precision': 0.3715450701613204, 'recall': 0.3523248727684091, 'f1-score': 0.3150200216655555, 'support': 403510}, 'weighted avg': {'precision': 0.371609181750741, 'recall': 0.36881366013233874, 'f1-score': 0.3228849024907528, 'support': 403510}}
[[ 13225  90091  25971]
 [ 11916 102970  32938]
 [  8977  84797  32625]]
Evaluating performance on  val set...
600/600 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.093023
{'0': {'precision': 0.34313201496525925, 'recall': 0.04048855346969665, 'f1-score': 0.07243052160505435, 'support': 47569}, '1': {'precision': 0.37592680104942394, 'recall': 0.8098397486528707, 'f1-score': 0.5134914054544342, 'support': 56973}, '2': {'precision': 0.3698362745488587, 'recall': 0.18982579537090047, 'f1-score': 0.25088162570428724, 'support': 48908}, 'accuracy': 0.3737308569566634, 'macro avg': {'precision': 0.3629650301878473, 'recall': 0.34671803249782257, 'f1-score': 0.27893451758792526, 'support': 153450}, 'weighted avg': {'precision': 0.3638193351039872, 'recall': 0.3737308569566634, 'f1-score': 0.2930642676776252, 'support': 153450}}
[[ 1926 38421  7222]
 [ 2237 46139  8597]
 [ 1450 38174  9284]]
training model: results/AAL/W9/deepLOB_L1/h500
Epoch 1/50
1577/1577 - 27s - loss: 3.2553 - accuracy500: 0.4050 - val_loss: 3.5139 - val_accuracy500: 0.3312 - 27s/epoch - 17ms/step
Epoch 2/50
1577/1577 - 26s - loss: 3.2155 - accuracy500: 0.4229 - val_loss: 3.4241 - val_accuracy500: 0.3323 - 26s/epoch - 16ms/step
Epoch 3/50
1577/1577 - 25s - loss: 3.1908 - accuracy500: 0.4351 - val_loss: 3.4289 - val_accuracy500: 0.3286 - 25s/epoch - 16ms/step
Epoch 4/50
1577/1577 - 25s - loss: 3.1758 - accuracy500: 0.4390 - val_loss: 3.4531 - val_accuracy500: 0.3283 - 25s/epoch - 16ms/step
Epoch 5/50
1577/1577 - 25s - loss: 3.1605 - accuracy500: 0.4453 - val_loss: 3.4385 - val_accuracy500: 0.3291 - 25s/epoch - 16ms/step
Epoch 6/50
1577/1577 - 25s - loss: 3.1538 - accuracy500: 0.4480 - val_loss: 3.4962 - val_accuracy500: 0.3296 - 25s/epoch - 16ms/step
Epoch 7/50
1577/1577 - 25s - loss: 3.1446 - accuracy500: 0.4513 - val_loss: 3.4643 - val_accuracy500: 0.3295 - 25s/epoch - 16ms/step
Epoch 8/50
1577/1577 - 26s - loss: 3.1393 - accuracy500: 0.4538 - val_loss: 3.4505 - val_accuracy500: 0.3292 - 26s/epoch - 16ms/step
Epoch 9/50
1577/1577 - 25s - loss: 3.1320 - accuracy500: 0.4562 - val_loss: 3.5399 - val_accuracy500: 0.3277 - 25s/epoch - 16ms/step
Epoch 10/50
1577/1577 - 25s - loss: 3.1289 - accuracy500: 0.4565 - val_loss: 3.3806 - val_accuracy500: 0.3326 - 25s/epoch - 16ms/step
Epoch 11/50
1577/1577 - 26s - loss: 3.1229 - accuracy500: 0.4593 - val_loss: 3.3942 - val_accuracy500: 0.3309 - 26s/epoch - 16ms/step
Epoch 12/50
1577/1577 - 25s - loss: 3.1163 - accuracy500: 0.4611 - val_loss: 3.3850 - val_accuracy500: 0.3338 - 25s/epoch - 16ms/step
Epoch 13/50
1577/1577 - 25s - loss: 3.1172 - accuracy500: 0.4613 - val_loss: 3.4183 - val_accuracy500: 0.3291 - 25s/epoch - 16ms/step
Epoch 14/50
1577/1577 - 26s - loss: 3.1115 - accuracy500: 0.4625 - val_loss: 3.4129 - val_accuracy500: 0.3279 - 26s/epoch - 16ms/step
Epoch 15/50
1577/1577 - 25s - loss: 3.1066 - accuracy500: 0.4645 - val_loss: 3.4003 - val_accuracy500: 0.3282 - 25s/epoch - 16ms/step
Epoch 16/50
1577/1577 - 26s - loss: 3.1020 - accuracy500: 0.4662 - val_loss: 3.3891 - val_accuracy500: 0.3302 - 26s/epoch - 16ms/step
Epoch 17/50
1577/1577 - 26s - loss: 3.0971 - accuracy500: 0.4688 - val_loss: 3.3920 - val_accuracy500: 0.3278 - 26s/epoch - 16ms/step
Epoch 18/50
1577/1577 - 25s - loss: 3.0948 - accuracy500: 0.4692 - val_loss: 3.3679 - val_accuracy500: 0.3341 - 25s/epoch - 16ms/step
Epoch 19/50
1577/1577 - 25s - loss: 3.0923 - accuracy500: 0.4694 - val_loss: 3.3541 - val_accuracy500: 0.3309 - 25s/epoch - 16ms/step
Epoch 20/50
1577/1577 - 26s - loss: 3.0869 - accuracy500: 0.4710 - val_loss: 3.3535 - val_accuracy500: 0.3358 - 26s/epoch - 16ms/step
Epoch 21/50
1577/1577 - 25s - loss: 3.0813 - accuracy500: 0.4736 - val_loss: 3.3655 - val_accuracy500: 0.3337 - 25s/epoch - 16ms/step
Epoch 22/50
1577/1577 - 25s - loss: 3.0781 - accuracy500: 0.4739 - val_loss: 3.3486 - val_accuracy500: 0.3330 - 25s/epoch - 16ms/step
Epoch 23/50
1577/1577 - 25s - loss: 3.0759 - accuracy500: 0.4738 - val_loss: 3.3594 - val_accuracy500: 0.3313 - 25s/epoch - 16ms/step
Epoch 24/50
1577/1577 - 25s - loss: 3.0760 - accuracy500: 0.4749 - val_loss: 3.3462 - val_accuracy500: 0.3315 - 25s/epoch - 16ms/step
Epoch 25/50
1577/1577 - 25s - loss: 3.0693 - accuracy500: 0.4765 - val_loss: 3.3524 - val_accuracy500: 0.3313 - 25s/epoch - 16ms/step
Epoch 26/50
1577/1577 - 25s - loss: 3.0658 - accuracy500: 0.4780 - val_loss: 3.3486 - val_accuracy500: 0.3273 - 25s/epoch - 16ms/step
Epoch 27/50
1577/1577 - 25s - loss: 3.0633 - accuracy500: 0.4785 - val_loss: 3.3468 - val_accuracy500: 0.3323 - 25s/epoch - 16ms/step
Epoch 28/50
1577/1577 - 26s - loss: 3.0575 - accuracy500: 0.4800 - val_loss: 3.3582 - val_accuracy500: 0.3285 - 26s/epoch - 16ms/step
Epoch 29/50
1577/1577 - 25s - loss: 3.0584 - accuracy500: 0.4795 - val_loss: 3.3475 - val_accuracy500: 0.3320 - 25s/epoch - 16ms/step
Epoch 30/50
1577/1577 - 25s - loss: 3.0574 - accuracy500: 0.4808 - val_loss: 3.3495 - val_accuracy500: 0.3330 - 25s/epoch - 16ms/step
Epoch 31/50
1577/1577 - 25s - loss: 3.0536 - accuracy500: 0.4809 - val_loss: 3.3524 - val_accuracy500: 0.3332 - 25s/epoch - 16ms/step
Epoch 32/50
1577/1577 - 25s - loss: 3.0523 - accuracy500: 0.4809 - val_loss: 3.3713 - val_accuracy500: 0.3347 - 25s/epoch - 16ms/step
Epoch 33/50
1577/1577 - 26s - loss: 3.0530 - accuracy500: 0.4818 - val_loss: 3.3558 - val_accuracy500: 0.3328 - 26s/epoch - 16ms/step
Epoch 34/50
1577/1577 - 25s - loss: 3.0497 - accuracy500: 0.4829 - val_loss: 3.3820 - val_accuracy500: 0.3279 - 25s/epoch - 16ms/step
testing model: results/AAL/W9/deepLOB_L1/h500
Evaluating performance on  test set...
3870/3870 - 21s - 21s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.109642
{'0': {'precision': 0.35134949229488405, 'recall': 0.4380146960982894, 'f1-score': 0.389924557902994, 'support': 338185}, '1': {'precision': 0.3512686057805896, 'recall': 0.3178647678378948, 'f1-score': 0.33373290954353224, 'support': 336769}, '2': {'precision': 0.31989665255663874, 'recall': 0.26782773386034253, 'f1-score': 0.2915556934640016, 'support': 315744}, 'accuracy': 0.3429319530270577, 'macro avg': {'precision': 0.34083825021070413, 'recall': 0.3412357325988422, 'f1-score': 0.338404386970176, 'support': 990698}, 'weighted avg': {'precision': 0.3412977050692664, 'recall': 0.3429319530270577, 'f1-score': 0.3394722667307167, 'support': 990698}}
[[148130 101249  88806]
 [138742 107047  90980]
 [134731  96448  84565]]
Evaluating performance on  train set...
1577/1577 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1253272
{'0': {'precision': 0.34717114730134074, 'recall': 0.4433344514284881, 'f1-score': 0.3894037699111643, 'support': 137138}, '1': {'precision': 0.33249220721389344, 'recall': 0.25385696368938787, 'f1-score': 0.2879017021331288, 'support': 132358}, '2': {'precision': 0.3410795485781153, 'recall': 0.32407061948751625, 'f1-score': 0.33235761158621746, 'support': 134014}, 'accuracy': 0.34157269956134917, 'macro avg': {'precision': 0.3402476343644498, 'recall': 0.3404206782017974, 'f1-score': 0.33655436121017024, 'support': 403510}, 'weighted avg': {'precision': 0.340333064816672, 'recall': 0.34157269956134917, 'f1-score': 0.3371631945878151, 'support': 403510}}
[[60798 33793 42547]
 [57404 33600 41354]
 [56922 33662 43430]]
Evaluating performance on  val set...
600/600 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1146742
{'0': {'precision': 0.32187428324721057, 'recall': 0.4763017089921738, 'f1-score': 0.3841490415193991, 'support': 50088}, '1': {'precision': 0.33194715080081744, 'recall': 0.270031509153119, 'f1-score': 0.29780520823340045, 'support': 51731}, '2': {'precision': 0.34800934253268545, 'recall': 0.25107009354844956, 'f1-score': 0.29169666966696667, 'support': 51631}, 'accuracy': 0.3309807754969045, 'macro avg': {'precision': 0.33394359219357117, 'recall': 0.3324677705645808, 'f1-score': 0.3245503064732554, 'support': 153450}, 'weighted avg': {'precision': 0.3340636527967967, 'recall': 0.3309807754969045, 'f1-score': 0.32393358859772475, 'support': 153450}}
[[23857 14060 12171]
 [25647 13969 12115]
 [24615 14053 12963]]
training model: results/AAL/W9/deepLOB_L1/h1000
Epoch 1/50
1577/1577 - 28s - loss: 3.1834 - accuracy1000: 0.4389 - val_loss: 3.4287 - val_accuracy1000: 0.3387 - 28s/epoch - 17ms/step
Epoch 2/50
1577/1577 - 25s - loss: 3.1311 - accuracy1000: 0.4600 - val_loss: 3.3466 - val_accuracy1000: 0.3456 - 25s/epoch - 16ms/step
Epoch 3/50
1577/1577 - 25s - loss: 3.1079 - accuracy1000: 0.4671 - val_loss: 3.3639 - val_accuracy1000: 0.3323 - 25s/epoch - 16ms/step
Epoch 4/50
1577/1577 - 25s - loss: 3.0997 - accuracy1000: 0.4691 - val_loss: 3.3600 - val_accuracy1000: 0.3330 - 25s/epoch - 16ms/step
Epoch 5/50
1577/1577 - 25s - loss: 3.1022 - accuracy1000: 0.4685 - val_loss: 3.4531 - val_accuracy1000: 0.3335 - 25s/epoch - 16ms/step
Epoch 6/50
1577/1577 - 25s - loss: 3.0987 - accuracy1000: 0.4677 - val_loss: 3.3232 - val_accuracy1000: 0.3401 - 25s/epoch - 16ms/step
Epoch 7/50
1577/1577 - 26s - loss: 3.0934 - accuracy1000: 0.4690 - val_loss: 3.3270 - val_accuracy1000: 0.3344 - 26s/epoch - 16ms/step
Epoch 8/50
1577/1577 - 26s - loss: 3.0882 - accuracy1000: 0.4713 - val_loss: 3.3782 - val_accuracy1000: 0.3332 - 26s/epoch - 16ms/step
Epoch 9/50
1577/1577 - 27s - loss: 3.0806 - accuracy1000: 0.4720 - val_loss: 3.3116 - val_accuracy1000: 0.3400 - 27s/epoch - 17ms/step
Epoch 10/50
1577/1577 - 25s - loss: 3.0748 - accuracy1000: 0.4763 - val_loss: 3.3749 - val_accuracy1000: 0.3341 - 25s/epoch - 16ms/step
Epoch 11/50
1577/1577 - 25s - loss: 3.0696 - accuracy1000: 0.4785 - val_loss: 3.3312 - val_accuracy1000: 0.3351 - 25s/epoch - 16ms/step
Epoch 12/50
1577/1577 - 25s - loss: 3.0616 - accuracy1000: 0.4809 - val_loss: 3.3220 - val_accuracy1000: 0.3353 - 25s/epoch - 16ms/step
Epoch 13/50
1577/1577 - 26s - loss: 3.0702 - accuracy1000: 0.4778 - val_loss: 3.3200 - val_accuracy1000: 0.3460 - 26s/epoch - 16ms/step
Epoch 14/50
1577/1577 - 25s - loss: 3.0559 - accuracy1000: 0.4824 - val_loss: 3.3199 - val_accuracy1000: 0.3340 - 25s/epoch - 16ms/step
Epoch 15/50
1577/1577 - 25s - loss: 3.0468 - accuracy1000: 0.4840 - val_loss: 3.3098 - val_accuracy1000: 0.3430 - 25s/epoch - 16ms/step
Epoch 16/50
1577/1577 - 25s - loss: 3.0537 - accuracy1000: 0.4831 - val_loss: 3.3357 - val_accuracy1000: 0.3418 - 25s/epoch - 16ms/step
Epoch 17/50
1577/1577 - 25s - loss: 3.0422 - accuracy1000: 0.4866 - val_loss: 3.3401 - val_accuracy1000: 0.3279 - 25s/epoch - 16ms/step
Epoch 18/50
1577/1577 - 25s - loss: 3.0371 - accuracy1000: 0.4888 - val_loss: 3.4891 - val_accuracy1000: 0.3329 - 25s/epoch - 16ms/step
Epoch 19/50
1577/1577 - 25s - loss: 3.0269 - accuracy1000: 0.4906 - val_loss: 3.3538 - val_accuracy1000: 0.3448 - 25s/epoch - 16ms/step
Epoch 20/50
1577/1577 - 25s - loss: 3.0440 - accuracy1000: 0.4838 - val_loss: 3.4124 - val_accuracy1000: 0.3388 - 25s/epoch - 16ms/step
Epoch 21/50
1577/1577 - 25s - loss: 3.0303 - accuracy1000: 0.4897 - val_loss: 3.4412 - val_accuracy1000: 0.3414 - 25s/epoch - 16ms/step
Epoch 22/50
1577/1577 - 25s - loss: 3.0235 - accuracy1000: 0.4932 - val_loss: 3.3878 - val_accuracy1000: 0.3438 - 25s/epoch - 16ms/step
Epoch 23/50
1577/1577 - 25s - loss: 3.0230 - accuracy1000: 0.4934 - val_loss: 3.3141 - val_accuracy1000: 0.3417 - 25s/epoch - 16ms/step
Epoch 24/50
1577/1577 - 25s - loss: 3.0252 - accuracy1000: 0.4907 - val_loss: 3.3238 - val_accuracy1000: 0.3307 - 25s/epoch - 16ms/step
Epoch 25/50
1577/1577 - 25s - loss: 3.0190 - accuracy1000: 0.4953 - val_loss: 3.3492 - val_accuracy1000: 0.3374 - 25s/epoch - 16ms/step
testing model: results/AAL/W9/deepLOB_L1/h1000
Evaluating performance on  test set...
3870/3870 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999476
{'0': {'precision': 0.2927744405324265, 'recall': 0.7967226233563102, 'f1-score': 0.42819761162108505, 'support': 274915}, '1': {'precision': 0.5538593716925452, 'recall': 0.28012175282078194, 'f1-score': 0.3720661138590396, 'support': 476375}, '2': {'precision': 0.2525867315885575, 'recall': 0.0017334424914789814, 'f1-score': 0.003443254746920776, 'support': 239408}, 'accuracy': 0.3562023946752694, 'macro avg': {'precision': 0.36640684793784306, 'recall': 0.35952593955619033, 'f1-score': 0.26790232674234843, 'support': 990698}, 'weighted avg': {'precision': 0.40860497118714445, 'recall': 0.3562023946752694, 'f1-score': 0.2985625126131893, 'support': 990698}}
[[219031  55476    408]
 [342112 133443    820]
 [186979  52014    415]]
Evaluating performance on  train set...
1577/1577 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1051273
{'0': {'precision': 0.33795024252855577, 'recall': 0.7996860259324807, 'f1-score': 0.4751151029602303, 'support': 135043}, '1': {'precision': 0.3937531772375228, 'recall': 0.19038496294957527, 'f1-score': 0.2566676575360489, 'support': 138325}, '2': {'precision': 0.38441269469492917, 'recall': 0.05044489864916783, 'f1-score': 0.08918625186795272, 'support': 130142}, 'accuracy': 0.34916606775544595, 'macro avg': {'precision': 0.3720387048203359, 'recall': 0.34683862917707464, 'f1-score': 0.273656337454744, 'support': 403510}, 'weighted avg': {'precision': 0.37206502876298375, 'recall': 0.34916606775544595, 'f1-score': 0.2757587166819445, 'support': 403510}}
[[107992  20773   6278]
 [107755  26335   4235]
 [103803  19774   6565]]
Evaluating performance on  val set...
600/600 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.101716
{'0': {'precision': 0.3352736326777813, 'recall': 0.7878476408847424, 'f1-score': 0.47037581207626, 'support': 50591}, '1': {'precision': 0.36146506080176877, 'recall': 0.24478899877851767, 'f1-score': 0.2918996382088991, 'support': 50758}, '2': {'precision': 0.27835051546391754, 'recall': 0.0010364484366902746, 'f1-score': 0.002065206998757051, 'support': 52101}, 'accuracy': 0.34106875203649395, 'macro avg': {'precision': 0.3250297363144892, 'recall': 0.34455769603331676, 'f1-score': 0.2547802190946387, 'support': 153450}, 'weighted avg': {'precision': 0.32461004961331624, 'recall': 0.34106875203649395, 'f1-score': 0.25233381488953804, 'support': 153450}}
[[39858 10664    69]
 [38262 12425    71]
 [40762 11285    54]]
training model: results/AAL/W9/deepOF_L1/h10
Epoch 1/50
1577/1577 - 25s - loss: 2.9481 - accuracy10: 0.4436 - val_loss: 2.8789 - val_accuracy10: 0.7204 - 25s/epoch - 16ms/step
Epoch 2/50
1577/1577 - 23s - loss: 2.8351 - accuracy10: 0.4969 - val_loss: 2.7981 - val_accuracy10: 0.7229 - 23s/epoch - 14ms/step
Epoch 3/50
1577/1577 - 23s - loss: 2.7870 - accuracy10: 0.5160 - val_loss: 2.7654 - val_accuracy10: 0.7298 - 23s/epoch - 14ms/step
Epoch 4/50
1577/1577 - 22s - loss: 2.7516 - accuracy10: 0.5221 - val_loss: 2.7334 - val_accuracy10: 0.7266 - 22s/epoch - 14ms/step
Epoch 5/50
1577/1577 - 23s - loss: 2.7224 - accuracy10: 0.5265 - val_loss: 2.7036 - val_accuracy10: 0.7298 - 23s/epoch - 15ms/step
Epoch 6/50
1577/1577 - 22s - loss: 2.7018 - accuracy10: 0.5337 - val_loss: 2.6734 - val_accuracy10: 0.7293 - 22s/epoch - 14ms/step
Epoch 7/50
1577/1577 - 23s - loss: 2.6797 - accuracy10: 0.5395 - val_loss: 2.6715 - val_accuracy10: 0.7338 - 23s/epoch - 14ms/step
Epoch 8/50
1577/1577 - 23s - loss: 2.6633 - accuracy10: 0.5421 - val_loss: 2.6649 - val_accuracy10: 0.7362 - 23s/epoch - 14ms/step
Epoch 9/50
1577/1577 - 22s - loss: 2.6428 - accuracy10: 0.5467 - val_loss: 2.6597 - val_accuracy10: 0.7371 - 22s/epoch - 14ms/step
Epoch 10/50
1577/1577 - 23s - loss: 2.6243 - accuracy10: 0.5493 - val_loss: 2.6459 - val_accuracy10: 0.7515 - 23s/epoch - 15ms/step
Epoch 11/50
1577/1577 - 23s - loss: 2.6060 - accuracy10: 0.5551 - val_loss: 2.6465 - val_accuracy10: 0.7466 - 23s/epoch - 14ms/step
Epoch 12/50
1577/1577 - 22s - loss: 2.5949 - accuracy10: 0.5571 - val_loss: 2.6519 - val_accuracy10: 0.7478 - 22s/epoch - 14ms/step
Epoch 13/50
1577/1577 - 22s - loss: 2.5742 - accuracy10: 0.5583 - val_loss: 2.6625 - val_accuracy10: 0.7559 - 22s/epoch - 14ms/step
Epoch 14/50
1577/1577 - 23s - loss: 2.5574 - accuracy10: 0.5634 - val_loss: 2.6603 - val_accuracy10: 0.7587 - 23s/epoch - 15ms/step
Epoch 15/50
1577/1577 - 23s - loss: 2.5406 - accuracy10: 0.5653 - val_loss: 2.6440 - val_accuracy10: 0.7535 - 23s/epoch - 15ms/step
Epoch 16/50
1577/1577 - 22s - loss: 2.5244 - accuracy10: 0.5700 - val_loss: 2.6650 - val_accuracy10: 0.7525 - 22s/epoch - 14ms/step
Epoch 17/50
1577/1577 - 23s - loss: 2.5105 - accuracy10: 0.5703 - val_loss: 2.6671 - val_accuracy10: 0.7478 - 23s/epoch - 14ms/step
Epoch 18/50
1577/1577 - 23s - loss: 2.4916 - accuracy10: 0.5725 - val_loss: 2.6907 - val_accuracy10: 0.7546 - 23s/epoch - 14ms/step
Epoch 19/50
1577/1577 - 23s - loss: 2.4891 - accuracy10: 0.5745 - val_loss: 2.6759 - val_accuracy10: 0.7568 - 23s/epoch - 14ms/step
Epoch 20/50
1577/1577 - 22s - loss: 2.4671 - accuracy10: 0.5789 - val_loss: 2.6726 - val_accuracy10: 0.7563 - 22s/epoch - 14ms/step
Epoch 21/50
1577/1577 - 23s - loss: 2.4556 - accuracy10: 0.5806 - val_loss: 2.7146 - val_accuracy10: 0.7547 - 23s/epoch - 14ms/step
Epoch 22/50
1577/1577 - 22s - loss: 2.4373 - accuracy10: 0.5834 - val_loss: 2.6749 - val_accuracy10: 0.7481 - 22s/epoch - 14ms/step
Epoch 23/50
1577/1577 - 23s - loss: 2.4257 - accuracy10: 0.5854 - val_loss: 2.7009 - val_accuracy10: 0.7512 - 23s/epoch - 14ms/step
Epoch 24/50
1577/1577 - 22s - loss: 2.4139 - accuracy10: 0.5883 - val_loss: 2.6872 - val_accuracy10: 0.7603 - 22s/epoch - 14ms/step
Epoch 25/50
1577/1577 - 23s - loss: 2.3960 - accuracy10: 0.5902 - val_loss: 2.7110 - val_accuracy10: 0.7480 - 23s/epoch - 14ms/step
testing model: results/AAL/W9/deepOF_L1/h10
Evaluating performance on  test set...
3870/3870 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6823589
{'0': {'precision': 0.2799469173701714, 'recall': 0.41566858567274023, 'f1-score': 0.33456741173154736, 'support': 84245}, '1': {'precision': 0.89098087095898, 'recall': 0.8026402176520039, 'f1-score': 0.8445065841460493, 'support': 825538}, '2': {'precision': 0.28224245406824144, 'recall': 0.4252944593442177, 'f1-score': 0.3393071078878475, 'support': 80911}, 'accuracy': 0.7389153462118474, 'macro avg': {'precision': 0.484390080799131, 'recall': 0.5478677542229873, 'f1-score': 0.5061270345884814, 'support': 990694}, 'weighted avg': {'precision': 0.789304481004932, 'recall': 0.7389153462118474, 'f1-score': 0.7598830572007088, 'support': 990694}}
[[ 35018  43147   6080]
 [ 81499 662610  81429]
 [  8571  37929  34411]]
Evaluating performance on  train set...
1577/1577 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.65029514
{'0': {'precision': 0.26766374419804023, 'recall': 0.45916700694160884, 'f1-score': 0.3381870128568207, 'support': 29388}, '1': {'precision': 0.9152895107503072, 'recall': 0.7951109169850944, 'f1-score': 0.8509781340069904, 'support': 345709}, '2': {'precision': 0.2575835085924326, 'recall': 0.47847816140499067, 'f1-score': 0.3348852103655533, 'support': 28413}, 'accuracy': 0.7483482441575178, 'macro avg': {'precision': 0.48017892118026007, 'recall': 0.5775853617772313, 'f1-score': 0.5080167857431215, 'support': 403510}, 'weighted avg': {'precision': 0.8218102248174931, 'recall': 0.7483482441575178, 'f1-score': 0.7772906077801675, 'support': 403510}}
[[ 13494  13475   2419]
 [ 34067 274877  36765]
 [  2853  11965  13595]]
Evaluating performance on  val set...
600/600 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.64203006
{'0': {'precision': 0.2551594746716698, 'recall': 0.4620910591204737, 'f1-score': 0.3287746926371045, 'support': 10301}, '1': {'precision': 0.9199269374619466, 'recall': 0.7981405597941335, 'f1-score': 0.8547172937131036, 'support': 132513}, '2': {'precision': 0.2631525851197982, 'recall': 0.49050394885295223, 'f1-score': 0.34253635796592363, 'support': 10636}, 'accuracy': 0.7542587161942, 'macro avg': {'precision': 0.47941299908447155, 'recall': 0.5835785225891864, 'f1-score': 0.5086761147720439, 'support': 153450}, 'weighted avg': {'precision': 0.8297788654794526, 'recall': 0.7542587161942, 'f1-score': 0.78391057382851, 'support': 153450}}
[[  4760   4730    811]
 [ 12952 105764  13797]
 [   943   4476   5217]]
training model: results/AAL/W9/deepOF_L1/h20
Epoch 1/50
1577/1577 - 25s - loss: 2.9692 - accuracy20: 0.4388 - val_loss: 2.8861 - val_accuracy20: 0.7041 - 25s/epoch - 16ms/step
Epoch 2/50
1577/1577 - 23s - loss: 2.8609 - accuracy20: 0.4766 - val_loss: 2.8231 - val_accuracy20: 0.7000 - 23s/epoch - 14ms/step
Epoch 3/50
1577/1577 - 22s - loss: 2.8079 - accuracy20: 0.4916 - val_loss: 2.7914 - val_accuracy20: 0.7043 - 22s/epoch - 14ms/step
Epoch 4/50
1577/1577 - 23s - loss: 2.7689 - accuracy20: 0.5044 - val_loss: 2.7648 - val_accuracy20: 0.7011 - 23s/epoch - 14ms/step
Epoch 5/50
1577/1577 - 23s - loss: 2.7423 - accuracy20: 0.5115 - val_loss: 2.7311 - val_accuracy20: 0.6901 - 23s/epoch - 14ms/step
Epoch 6/50
1577/1577 - 23s - loss: 2.7204 - accuracy20: 0.5208 - val_loss: 2.7208 - val_accuracy20: 0.6973 - 23s/epoch - 14ms/step
Epoch 7/50
1577/1577 - 23s - loss: 2.7029 - accuracy20: 0.5226 - val_loss: 2.7092 - val_accuracy20: 0.7071 - 23s/epoch - 14ms/step
Epoch 8/50
1577/1577 - 23s - loss: 2.6841 - accuracy20: 0.5309 - val_loss: 2.6936 - val_accuracy20: 0.7033 - 23s/epoch - 14ms/step
Epoch 9/50
1577/1577 - 23s - loss: 2.6679 - accuracy20: 0.5350 - val_loss: 2.6882 - val_accuracy20: 0.7084 - 23s/epoch - 15ms/step
Epoch 10/50
1577/1577 - 23s - loss: 2.6518 - accuracy20: 0.5363 - val_loss: 2.6843 - val_accuracy20: 0.7164 - 23s/epoch - 14ms/step
Epoch 11/50
1577/1577 - 22s - loss: 2.6341 - accuracy20: 0.5405 - val_loss: 2.6868 - val_accuracy20: 0.7212 - 22s/epoch - 14ms/step
Epoch 12/50
1577/1577 - 23s - loss: 2.6200 - accuracy20: 0.5445 - val_loss: 2.6795 - val_accuracy20: 0.7202 - 23s/epoch - 15ms/step
Epoch 13/50
1577/1577 - 22s - loss: 2.6033 - accuracy20: 0.5476 - val_loss: 2.6912 - val_accuracy20: 0.7221 - 22s/epoch - 14ms/step
Epoch 14/50
1577/1577 - 22s - loss: 2.5871 - accuracy20: 0.5506 - val_loss: 2.6764 - val_accuracy20: 0.7188 - 22s/epoch - 14ms/step
Epoch 15/50
1577/1577 - 23s - loss: 2.5719 - accuracy20: 0.5540 - val_loss: 2.6578 - val_accuracy20: 0.7137 - 23s/epoch - 14ms/step
Epoch 16/50
1577/1577 - 23s - loss: 2.5573 - accuracy20: 0.5565 - val_loss: 2.6446 - val_accuracy20: 0.7190 - 23s/epoch - 14ms/step
Epoch 17/50
1577/1577 - 23s - loss: 2.5464 - accuracy20: 0.5583 - val_loss: 2.6675 - val_accuracy20: 0.7187 - 23s/epoch - 15ms/step
Epoch 18/50
1577/1577 - 23s - loss: 2.5321 - accuracy20: 0.5592 - val_loss: 2.6545 - val_accuracy20: 0.7207 - 23s/epoch - 15ms/step
Epoch 19/50
1577/1577 - 24s - loss: 2.5147 - accuracy20: 0.5640 - val_loss: 2.6647 - val_accuracy20: 0.7215 - 24s/epoch - 15ms/step
Epoch 20/50
1577/1577 - 23s - loss: 2.4994 - accuracy20: 0.5666 - val_loss: 2.6602 - val_accuracy20: 0.7258 - 23s/epoch - 14ms/step
Epoch 21/50
1577/1577 - 23s - loss: 2.4890 - accuracy20: 0.5695 - val_loss: 2.7216 - val_accuracy20: 0.7343 - 23s/epoch - 15ms/step
Epoch 22/50
1577/1577 - 22s - loss: 2.4761 - accuracy20: 0.5699 - val_loss: 2.7113 - val_accuracy20: 0.7251 - 22s/epoch - 14ms/step
Epoch 23/50
1577/1577 - 23s - loss: 2.4648 - accuracy20: 0.5720 - val_loss: 2.6585 - val_accuracy20: 0.7243 - 23s/epoch - 15ms/step
Epoch 24/50
1577/1577 - 24s - loss: 2.4511 - accuracy20: 0.5757 - val_loss: 2.7004 - val_accuracy20: 0.7294 - 24s/epoch - 15ms/step
Epoch 25/50
1577/1577 - 23s - loss: 2.4351 - accuracy20: 0.5779 - val_loss: 2.7281 - val_accuracy20: 0.7275 - 23s/epoch - 15ms/step
Epoch 26/50
1577/1577 - 24s - loss: 2.4259 - accuracy20: 0.5800 - val_loss: 2.7270 - val_accuracy20: 0.7267 - 24s/epoch - 15ms/step
testing model: results/AAL/W9/deepOF_L1/h20
Evaluating performance on  test set...
3870/3870 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.74319655
{'0': {'precision': 0.3681165333768565, 'recall': 0.3909908035814893, 'f1-score': 0.379209031948922, 'support': 115371}, '1': {'precision': 0.8425470610562616, 'recall': 0.7804640548333381, 'f1-score': 0.8103181663046747, 'support': 765082}, '2': {'precision': 0.31650642533255563, 'recall': 0.45777886630201103, 'f1-score': 0.3742546943134289, 'support': 110241}, 'accuracy': 0.6992007622939072, 'macro avg': {'precision': 0.5090566732552245, 'recall': 0.5430779082389462, 'f1-score': 0.5212606308556752, 'support': 990694}, 'weighted avg': {'precision': 0.728761401577434, 'recall': 0.6992007622939072, 'f1-score': 0.7115898353008082, 'support': 990694}}
[[ 45109  61252   9010]
 [ 67992 597119  99971]
 [  9439  50336  50466]]
Evaluating performance on  train set...
1577/1577 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7130942
{'0': {'precision': 0.33623438496454966, 'recall': 0.4433068724188243, 'f1-score': 0.382417254215955, 'support': 40437}, '1': {'precision': 0.8754734865106809, 'recall': 0.7698645699238418, 'f1-score': 0.8192796812016047, 'support': 323931}, '2': {'precision': 0.3027348831514669, 'recall': 0.5053650809871749, 'f1-score': 0.3786453298622742, 'support': 39142}, 'accuracy': 0.7114817476642462, 'macro avg': {'precision': 0.5048142515422325, 'recall': 0.5728455077766137, 'f1-score': 0.526780755093278, 'support': 403510}, 'weighted avg': {'precision': 0.7658768322470759, 'recall': 0.7114817476642462, 'f1-score': 0.7327571272620671, 'support': 403510}}
[[ 17926  19329   3182]
 [ 32170 249383  42378]
 [  3218  16143  19781]]
Evaluating performance on  val set...
600/600 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7032662
{'0': {'precision': 0.3272192946899068, 'recall': 0.44704416447459505, 'f1-score': 0.3778596922356796, 'support': 14446}, '1': {'precision': 0.8810481469604654, 'recall': 0.7741203178206584, 'f1-score': 0.8241303360386689, 'support': 124221}, '2': {'precision': 0.30831535675037647, 'recall': 0.5124129067171751, 'f1-score': 0.3849867859321, 'support': 14783}, 'accuracy': 0.7181166503747148, 'macro avg': {'precision': 0.5055275994669163, 'recall': 0.5778591296708094, 'f1-score': 0.5289922714021494, 'support': 153450}, 'weighted avg': {'precision': 0.7737342307820604, 'recall': 0.7181166503747148, 'f1-score': 0.7398117643762161, 'support': 153450}}
[[ 6458  6921  1067]
 [12132 96162 15927]
 [ 1146  6062  7575]]
training model: results/AAL/W9/deepOF_L1/h30
Epoch 1/50
1577/1577 - 26s - loss: 3.0147 - accuracy30: 0.4197 - val_loss: 2.9036 - val_accuracy30: 0.6430 - 26s/epoch - 16ms/step
Epoch 2/50
1577/1577 - 24s - loss: 2.9076 - accuracy30: 0.4528 - val_loss: 2.8238 - val_accuracy30: 0.6349 - 24s/epoch - 15ms/step
Epoch 3/50
1577/1577 - 24s - loss: 2.8565 - accuracy30: 0.4752 - val_loss: 2.8235 - val_accuracy30: 0.6548 - 24s/epoch - 15ms/step
Epoch 4/50
1577/1577 - 24s - loss: 2.8220 - accuracy30: 0.4881 - val_loss: 2.7880 - val_accuracy30: 0.6617 - 24s/epoch - 15ms/step
Epoch 5/50
1577/1577 - 24s - loss: 2.7948 - accuracy30: 0.4936 - val_loss: 2.7590 - val_accuracy30: 0.6623 - 24s/epoch - 15ms/step
Epoch 6/50
1577/1577 - 23s - loss: 2.7688 - accuracy30: 0.5016 - val_loss: 2.7365 - val_accuracy30: 0.6633 - 23s/epoch - 14ms/step
Epoch 7/50
1577/1577 - 23s - loss: 2.7502 - accuracy30: 0.5066 - val_loss: 2.7254 - val_accuracy30: 0.6789 - 23s/epoch - 15ms/step
Epoch 8/50
1577/1577 - 23s - loss: 2.7347 - accuracy30: 0.5128 - val_loss: 2.7106 - val_accuracy30: 0.6656 - 23s/epoch - 14ms/step
Epoch 9/50
1577/1577 - 23s - loss: 2.7202 - accuracy30: 0.5181 - val_loss: 2.6989 - val_accuracy30: 0.6768 - 23s/epoch - 15ms/step
Epoch 10/50
1577/1577 - 25s - loss: 2.7024 - accuracy30: 0.5223 - val_loss: 2.7010 - val_accuracy30: 0.6744 - 25s/epoch - 16ms/step
Epoch 11/50
1577/1577 - 25s - loss: 2.6868 - accuracy30: 0.5239 - val_loss: 2.6913 - val_accuracy30: 0.6786 - 25s/epoch - 16ms/step
Epoch 12/50
1577/1577 - 23s - loss: 2.6720 - accuracy30: 0.5255 - val_loss: 2.6970 - val_accuracy30: 0.6746 - 23s/epoch - 15ms/step
Epoch 13/50
1577/1577 - 24s - loss: 2.6577 - accuracy30: 0.5311 - val_loss: 2.6892 - val_accuracy30: 0.6779 - 24s/epoch - 15ms/step
Epoch 14/50
1577/1577 - 24s - loss: 2.6450 - accuracy30: 0.5318 - val_loss: 2.6899 - val_accuracy30: 0.6830 - 24s/epoch - 15ms/step
Epoch 15/50
1577/1577 - 24s - loss: 2.6279 - accuracy30: 0.5363 - val_loss: 2.7013 - val_accuracy30: 0.6834 - 24s/epoch - 15ms/step
Epoch 16/50
1577/1577 - 24s - loss: 2.6164 - accuracy30: 0.5386 - val_loss: 2.6881 - val_accuracy30: 0.6907 - 24s/epoch - 15ms/step
Epoch 17/50
1577/1577 - 23s - loss: 2.5986 - accuracy30: 0.5412 - val_loss: 2.6881 - val_accuracy30: 0.6865 - 23s/epoch - 15ms/step
Epoch 18/50
1577/1577 - 24s - loss: 2.5874 - accuracy30: 0.5438 - val_loss: 2.6908 - val_accuracy30: 0.6988 - 24s/epoch - 15ms/step
Epoch 19/50
1577/1577 - 24s - loss: 2.5753 - accuracy30: 0.5444 - val_loss: 2.6932 - val_accuracy30: 0.6947 - 24s/epoch - 15ms/step
Epoch 20/50
1577/1577 - 23s - loss: 2.5628 - accuracy30: 0.5494 - val_loss: 2.7028 - val_accuracy30: 0.6975 - 23s/epoch - 15ms/step
Epoch 21/50
1577/1577 - 23s - loss: 2.5444 - accuracy30: 0.5529 - val_loss: 2.7061 - val_accuracy30: 0.6938 - 23s/epoch - 15ms/step
Epoch 22/50
1577/1577 - 23s - loss: 2.5352 - accuracy30: 0.5539 - val_loss: 2.7126 - val_accuracy30: 0.6991 - 23s/epoch - 15ms/step
Epoch 23/50
1577/1577 - 23s - loss: 2.5210 - accuracy30: 0.5556 - val_loss: 2.7430 - val_accuracy30: 0.6969 - 23s/epoch - 14ms/step
Epoch 24/50
1577/1577 - 23s - loss: 2.5100 - accuracy30: 0.5578 - val_loss: 2.7293 - val_accuracy30: 0.6977 - 23s/epoch - 15ms/step
Epoch 25/50
1577/1577 - 24s - loss: 2.5000 - accuracy30: 0.5571 - val_loss: 2.7042 - val_accuracy30: 0.6904 - 24s/epoch - 15ms/step
Epoch 26/50
1577/1577 - 23s - loss: 2.4863 - accuracy30: 0.5609 - val_loss: 2.7316 - val_accuracy30: 0.6947 - 23s/epoch - 15ms/step
Epoch 27/50
1577/1577 - 24s - loss: 2.4753 - accuracy30: 0.5623 - val_loss: 2.7477 - val_accuracy30: 0.7027 - 24s/epoch - 15ms/step
testing model: results/AAL/W9/deepOF_L1/h30
Evaluating performance on  test set...
3870/3870 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8079078
{'0': {'precision': 0.3817464186096894, 'recall': 0.4072557346738314, 'f1-score': 0.39408870437930704, 'support': 138456}, '1': {'precision': 0.8015223207557587, 'recall': 0.7458154972737383, 'f1-score': 0.7726661382731891, 'support': 720217}, '2': {'precision': 0.3426529726602054, 'recall': 0.4485574264700313, 'f1-score': 0.3885174809575983, 'support': 132021}, 'accuracy': 0.6588865986873848, 'macro avg': {'precision': 0.5086405706752178, 'recall': 0.5338762194725337, 'f1-score': 0.5184241078700315, 'support': 990694}, 'weighted avg': {'precision': 0.681706431578617, 'recall': 0.6588865986873848, 'f1-score': 0.6685653694437897, 'support': 990694}}
[[ 56387  71616  10453]
 [ 79915 537149 103153]
 [ 11406  61396  59219]]
Evaluating performance on  train set...
1577/1577 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76452845
{'0': {'precision': 0.36175779492392557, 'recall': 0.4438265420866472, 'f1-score': 0.3986117997025285, 'support': 48911}, '1': {'precision': 0.839611410067146, 'recall': 0.7461812428377956, 'f1-score': 0.7901440132378416, 'support': 307168}, '2': {'precision': 0.3298116739463384, 'recall': 0.49033332630558074, 'f1-score': 0.3943635700780859, 'support': 47431}, 'accuracy': 0.6794577581720403, 'macro avg': {'precision': 0.51039362631247, 'recall': 0.5601137037433411, 'f1-score': 0.527706461006152, 'support': 403510}, 'weighted avg': {'precision': 0.7217639974770836, 'recall': 0.6794577581720403, 'f1-score': 0.6961624655792058, 'support': 403510}}
[[ 21708  23275   3928]
 [ 34634 229203  43331]
 [  3665  20509  23257]]
Evaluating performance on  val set...
600/600 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.75988024
{'0': {'precision': 0.35824037987725665, 'recall': 0.4540396298188838, 'f1-score': 0.4004907852564103, 'support': 17613}, '1': {'precision': 0.8475378515126204, 'recall': 0.748827266789383, 'f1-score': 0.7951306948172434, 'support': 117887}, '2': {'precision': 0.33511308861698186, 'recall': 0.5035097493036211, 'f1-score': 0.40240427426536063, 'support': 17950}, 'accuracy': 0.6862952101661779, 'macro avg': {'precision': 0.5136304400022863, 'recall': 0.5687922153039627, 'f1-score': 0.5326752514463381, 'support': 153450}, 'weighted avg': {'precision': 0.7314347504250325, 'recall': 0.6862952101661779, 'f1-score': 0.7038942531359058, 'support': 153450}}
[[ 7997  8303  1313]
 [12991 88277 16619]
 [ 1335  7577  9038]]
training model: results/AAL/W9/deepOF_L1/h50
Epoch 1/50
1577/1577 - 25s - loss: 3.0861 - accuracy50: 0.4113 - val_loss: 2.9804 - val_accuracy50: 0.6004 - 25s/epoch - 16ms/step
Epoch 2/50
1577/1577 - 24s - loss: 2.9890 - accuracy50: 0.4381 - val_loss: 2.9030 - val_accuracy50: 0.6005 - 24s/epoch - 15ms/step
Epoch 3/50
1577/1577 - 23s - loss: 2.9366 - accuracy50: 0.4604 - val_loss: 2.8737 - val_accuracy50: 0.5869 - 23s/epoch - 15ms/step
Epoch 4/50
1577/1577 - 24s - loss: 2.9043 - accuracy50: 0.4711 - val_loss: 2.8528 - val_accuracy50: 0.6071 - 24s/epoch - 15ms/step
Epoch 5/50
1577/1577 - 24s - loss: 2.8808 - accuracy50: 0.4808 - val_loss: 2.8337 - val_accuracy50: 0.6060 - 24s/epoch - 15ms/step
Epoch 6/50
1577/1577 - 24s - loss: 2.8606 - accuracy50: 0.4857 - val_loss: 2.8293 - val_accuracy50: 0.6046 - 24s/epoch - 15ms/step
Epoch 7/50
1577/1577 - 23s - loss: 2.8429 - accuracy50: 0.4888 - val_loss: 2.8184 - val_accuracy50: 0.6189 - 23s/epoch - 15ms/step
Epoch 8/50
1577/1577 - 23s - loss: 2.8274 - accuracy50: 0.4937 - val_loss: 2.8133 - val_accuracy50: 0.6225 - 23s/epoch - 15ms/step
Epoch 9/50
1577/1577 - 24s - loss: 2.8120 - accuracy50: 0.4969 - val_loss: 2.8140 - val_accuracy50: 0.6249 - 24s/epoch - 15ms/step
Epoch 10/50
1577/1577 - 24s - loss: 2.7972 - accuracy50: 0.4985 - val_loss: 2.8166 - val_accuracy50: 0.6235 - 24s/epoch - 15ms/step
Epoch 11/50
1577/1577 - 24s - loss: 2.7855 - accuracy50: 0.5011 - val_loss: 2.8096 - val_accuracy50: 0.6272 - 24s/epoch - 15ms/step
Epoch 12/50
1577/1577 - 24s - loss: 2.7711 - accuracy50: 0.5038 - val_loss: 2.8028 - val_accuracy50: 0.6269 - 24s/epoch - 15ms/step
Epoch 13/50
1577/1577 - 24s - loss: 2.7595 - accuracy50: 0.5055 - val_loss: 2.8160 - val_accuracy50: 0.6329 - 24s/epoch - 15ms/step
Epoch 14/50
1577/1577 - 24s - loss: 2.7479 - accuracy50: 0.5075 - val_loss: 2.8146 - val_accuracy50: 0.6394 - 24s/epoch - 15ms/step
Epoch 15/50
1577/1577 - 23s - loss: 2.7333 - accuracy50: 0.5110 - val_loss: 2.8276 - val_accuracy50: 0.6376 - 23s/epoch - 15ms/step
Epoch 16/50
1577/1577 - 24s - loss: 2.7222 - accuracy50: 0.5130 - val_loss: 2.8241 - val_accuracy50: 0.6411 - 24s/epoch - 15ms/step
Epoch 17/50
1577/1577 - 23s - loss: 2.7105 - accuracy50: 0.5146 - val_loss: 2.8184 - val_accuracy50: 0.6392 - 23s/epoch - 15ms/step
Epoch 18/50
1577/1577 - 24s - loss: 2.6985 - accuracy50: 0.5174 - val_loss: 2.8352 - val_accuracy50: 0.6391 - 24s/epoch - 15ms/step
Epoch 19/50
1577/1577 - 23s - loss: 2.6858 - accuracy50: 0.5191 - val_loss: 2.8073 - val_accuracy50: 0.6395 - 23s/epoch - 15ms/step
Epoch 20/50
1577/1577 - 23s - loss: 2.6794 - accuracy50: 0.5191 - val_loss: 2.8204 - val_accuracy50: 0.6420 - 23s/epoch - 15ms/step
Epoch 21/50
1577/1577 - 24s - loss: 2.6620 - accuracy50: 0.5244 - val_loss: 2.8206 - val_accuracy50: 0.6374 - 24s/epoch - 15ms/step
Epoch 22/50
1577/1577 - 24s - loss: 2.6526 - accuracy50: 0.5246 - val_loss: 2.8227 - val_accuracy50: 0.6416 - 24s/epoch - 15ms/step
testing model: results/AAL/W9/deepOF_L1/h50
Evaluating performance on  test set...
3870/3870 - 25s - 25s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89054114
{'0': {'precision': 0.39101306287543847, 'recall': 0.4403700835909638, 'f1-score': 0.4142264752791068, 'support': 176933}, '1': {'precision': 0.7242877921039734, 'recall': 0.7055410748415147, 'f1-score': 0.7147915378534699, 'support': 647221}, '2': {'precision': 0.38401322084021916, 'recall': 0.37114206797165844, 'f1-score': 0.37746795400277255, 'support': 166540}, 'accuracy': 0.6019689227955353, 'macro avg': {'precision': 0.4997713586065437, 'recall': 0.505684408801379, 'f1-score': 0.5021619890451164, 'support': 990694}, 'weighted avg': {'precision': 0.6075649445194943, 'recall': 0.6019689227955353, 'f1-score': 0.6044065472600426, 'support': 990694}}
[[ 77916  87203  11814]
 [103246 456641  87334]
 [ 18105  86625  61810]]
Evaluating performance on  train set...
1577/1577 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86469555
{'0': {'precision': 0.3722111604635728, 'recall': 0.46121241835233834, 'f1-score': 0.4119595697041186, 'support': 63229}, '1': {'precision': 0.7680727363188072, 'recall': 0.6864813108075639, 'f1-score': 0.7249886380851387, 'support': 278851}, '2': {'precision': 0.35738084890627264, 'recall': 0.44175484291063, 'f1-score': 0.39511367689989296, 'support': 61430}, 'accuracy': 0.6139253054447226, 'macro avg': {'precision': 0.49922158189621757, 'recall': 0.5298161906901774, 'f1-score': 0.5106872948963833, 'support': 403510}, 'weighted avg': {'precision': 0.6435188610158342, 'recall': 0.6139253054447226, 'f1-score': 0.625717904199304, 'support': 403510}}
[[ 29162  29128   4939]
 [ 43568 191426  43857]
 [  5618  28675  27137]]
Evaluating performance on  val set...
600/600 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.85438496
{'0': {'precision': 0.36582410555013295, 'recall': 0.47357413620321553, 'f1-score': 0.41278341118833306, 'support': 22951}, '1': {'precision': 0.7779498264502317, 'recall': 0.6976022514420971, 'f1-score': 0.7355884737268774, 'support': 107309}, '2': {'precision': 0.3735688583578672, 'recall': 0.4432082794307891, 'f1-score': 0.4054197976451097, 'support': 23190}, 'accuracy': 0.6256500488758553, 'macro avg': {'precision': 0.5057809301194106, 'recall': 0.5381282223587006, 'f1-score': 0.51793056085344, 'support': 153450}, 'weighted avg': {'precision': 0.6551978416314627, 'recall': 0.6256500488758553, 'f1-score': 0.6374111482875922, 'support': 153450}}
[[10869 10517  1565]
 [16780 74859 15670]
 [ 2062 10850 10278]]
training model: results/AAL/W9/deepOF_L1/h100
Epoch 1/50
1577/1577 - 27s - loss: 3.1951 - accuracy100: 0.4099 - val_loss: 3.1178 - val_accuracy100: 0.5078 - 27s/epoch - 17ms/step
Epoch 2/50
1577/1577 - 24s - loss: 3.1324 - accuracy100: 0.4193 - val_loss: 3.0745 - val_accuracy100: 0.5016 - 24s/epoch - 15ms/step
Epoch 3/50
1577/1577 - 24s - loss: 3.0995 - accuracy100: 0.4356 - val_loss: 3.0515 - val_accuracy100: 0.5149 - 24s/epoch - 15ms/step
Epoch 4/50
1577/1577 - 24s - loss: 3.0758 - accuracy100: 0.4447 - val_loss: 3.0363 - val_accuracy100: 0.5028 - 24s/epoch - 15ms/step
Epoch 5/50
1577/1577 - 24s - loss: 3.0566 - accuracy100: 0.4517 - val_loss: 3.0194 - val_accuracy100: 0.5066 - 24s/epoch - 15ms/step
Epoch 6/50
1577/1577 - 25s - loss: 3.0407 - accuracy100: 0.4556 - val_loss: 3.0222 - val_accuracy100: 0.5059 - 25s/epoch - 16ms/step
Epoch 7/50
1577/1577 - 25s - loss: 3.0277 - accuracy100: 0.4595 - val_loss: 3.0108 - val_accuracy100: 0.5171 - 25s/epoch - 16ms/step
Epoch 8/50
1577/1577 - 24s - loss: 3.0129 - accuracy100: 0.4645 - val_loss: 3.0100 - val_accuracy100: 0.5204 - 24s/epoch - 15ms/step
Epoch 9/50
1577/1577 - 23s - loss: 3.0003 - accuracy100: 0.4675 - val_loss: 3.0090 - val_accuracy100: 0.5219 - 23s/epoch - 15ms/step
Epoch 10/50
1577/1577 - 24s - loss: 2.9880 - accuracy100: 0.4695 - val_loss: 3.0145 - val_accuracy100: 0.5294 - 24s/epoch - 15ms/step
Epoch 11/50
1577/1577 - 24s - loss: 2.9762 - accuracy100: 0.4732 - val_loss: 3.0111 - val_accuracy100: 0.5382 - 24s/epoch - 15ms/step
Epoch 12/50
1577/1577 - 23s - loss: 2.9647 - accuracy100: 0.4751 - val_loss: 3.0194 - val_accuracy100: 0.5344 - 23s/epoch - 15ms/step
Epoch 13/50
1577/1577 - 24s - loss: 2.9535 - accuracy100: 0.4798 - val_loss: 3.0247 - val_accuracy100: 0.5361 - 24s/epoch - 15ms/step
Epoch 14/50
1577/1577 - 23s - loss: 2.9432 - accuracy100: 0.4821 - val_loss: 3.0311 - val_accuracy100: 0.5398 - 23s/epoch - 15ms/step
Epoch 15/50
1577/1577 - 24s - loss: 2.9309 - accuracy100: 0.4839 - val_loss: 3.0504 - val_accuracy100: 0.5315 - 24s/epoch - 15ms/step
Epoch 16/50
1577/1577 - 24s - loss: 2.9205 - accuracy100: 0.4873 - val_loss: 3.0313 - val_accuracy100: 0.5459 - 24s/epoch - 15ms/step
Epoch 17/50
1577/1577 - 24s - loss: 2.9096 - accuracy100: 0.4889 - val_loss: 3.0574 - val_accuracy100: 0.5418 - 24s/epoch - 15ms/step
Epoch 18/50
1577/1577 - 24s - loss: 2.9008 - accuracy100: 0.4914 - val_loss: 3.0432 - val_accuracy100: 0.5434 - 24s/epoch - 15ms/step
Epoch 19/50
1577/1577 - 23s - loss: 2.8877 - accuracy100: 0.4939 - val_loss: 3.0425 - val_accuracy100: 0.5505 - 23s/epoch - 15ms/step
testing model: results/AAL/W9/deepOF_L1/h100
Evaluating performance on  test set...
3870/3870 - 21s - 21s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.99920577
{'0': {'precision': 0.4088666705703244, 'recall': 0.4635883051030316, 'f1-score': 0.43451137791156696, 'support': 240994}, '1': {'precision': 0.5857577673760068, 'recall': 0.6074275729432321, 'f1-score': 0.5963958941611833, 'support': 523078}, '2': {'precision': 0.4001725546661182, 'recall': 0.309047665275216, 'f1-score': 0.3487559724030784, 'support': 226622}, 'accuracy': 0.5041829263122619, 'macro avg': {'precision': 0.4649323308708164, 'recall': 0.4600211811071599, 'f1-score': 0.4598877481586096, 'support': 990694}, 'weighted avg': {'precision': 0.500274878554303, 'recall': 0.5041829263122619, 'f1-score': 0.5003684109446449, 'support': 990694}}
[[111722 108582  20690]
 [121056 317732  84290]
 [ 40470 116115  70037]]
Evaluating performance on  train set...
1577/1577 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9813913
{'0': {'precision': 0.38653222704544205, 'recall': 0.47754118392469225, 'f1-score': 0.4272439239186549, 'support': 88384}, '1': {'precision': 0.6291751335717242, 'recall': 0.5929610363429993, 'f1-score': 0.6105315404746864, 'support': 228187}, '2': {'precision': 0.39612429506831687, 'recall': 0.3611497716789933, 'f1-score': 0.37782938833467705, 'support': 86939}, 'accuracy': 0.5177343808084063, 'macro avg': {'precision': 0.47061055189516104, 'recall': 0.47721733064889493, 'f1-score': 0.47186828424267274, 'support': 403510}, 'weighted avg': {'precision': 0.5258147273883169, 'recall': 0.5177343808084063, 'f1-score': 0.5202473217277197, 'support': 403510}}
[[ 42207  37701   8476]
 [ 53492 135306  39389]
 [ 13495  42046  31398]]
Evaluating performance on  val set...
600/600 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9783478
{'0': {'precision': 0.3710840000933075, 'recall': 0.4901404979048558, 'f1-score': 0.42238300696979747, 'support': 32456}, '1': {'precision': 0.6387246390888892, 'recall': 0.5969407439348206, 'f1-score': 0.6171262324986656, 'support': 88126}, '2': {'precision': 0.41190644932671866, 'recall': 0.35365705245223317, 'f1-score': 0.38056574122577264, 'support': 32868}, 'accuracy': 0.5222417725643532, 'macro avg': {'precision': 0.4739050295029718, 'recall': 0.4802460980973031, 'f1-score': 0.47335832689807855, 'support': 153450}, 'weighted avg': {'precision': 0.5335333400315831, 'recall': 0.5222417725643532, 'f1-score': 0.5252666277093375, 'support': 153450}}
[[15908 13826  2722]
 [21646 52606 13874]
 [ 5315 15929 11624]]
training model: results/AAL/W9/deepOF_L1/h200
Epoch 1/50
1577/1577 - 27s - loss: 3.2645 - accuracy200: 0.3940 - val_loss: 3.2325 - val_accuracy200: 0.4468 - 27s/epoch - 17ms/step
Epoch 2/50
1577/1577 - 25s - loss: 3.2326 - accuracy200: 0.4025 - val_loss: 3.2071 - val_accuracy200: 0.4356 - 25s/epoch - 16ms/step
Epoch 3/50
1577/1577 - 24s - loss: 3.2182 - accuracy200: 0.4080 - val_loss: 3.1984 - val_accuracy200: 0.4386 - 24s/epoch - 15ms/step
Epoch 4/50
1577/1577 - 25s - loss: 3.2067 - accuracy200: 0.4145 - val_loss: 3.1908 - val_accuracy200: 0.4420 - 25s/epoch - 16ms/step
Epoch 5/50
1577/1577 - 24s - loss: 3.1977 - accuracy200: 0.4202 - val_loss: 3.1841 - val_accuracy200: 0.4438 - 24s/epoch - 15ms/step
Epoch 6/50
1577/1577 - 24s - loss: 3.1889 - accuracy200: 0.4246 - val_loss: 3.1801 - val_accuracy200: 0.4491 - 24s/epoch - 15ms/step
Epoch 7/50
1577/1577 - 24s - loss: 3.1811 - accuracy200: 0.4270 - val_loss: 3.1756 - val_accuracy200: 0.4512 - 24s/epoch - 15ms/step
Epoch 8/50
1577/1577 - 25s - loss: 3.1719 - accuracy200: 0.4297 - val_loss: 3.1749 - val_accuracy200: 0.4558 - 25s/epoch - 16ms/step
Epoch 9/50
1577/1577 - 24s - loss: 3.1631 - accuracy200: 0.4329 - val_loss: 3.1751 - val_accuracy200: 0.4570 - 24s/epoch - 15ms/step
Epoch 10/50
1577/1577 - 24s - loss: 3.1549 - accuracy200: 0.4357 - val_loss: 3.1726 - val_accuracy200: 0.4618 - 24s/epoch - 15ms/step
Epoch 11/50
1577/1577 - 24s - loss: 3.1460 - accuracy200: 0.4398 - val_loss: 3.1741 - val_accuracy200: 0.4604 - 24s/epoch - 15ms/step
Epoch 12/50
1577/1577 - 24s - loss: 3.1395 - accuracy200: 0.4417 - val_loss: 3.1695 - val_accuracy200: 0.4634 - 24s/epoch - 15ms/step
Epoch 13/50
1577/1577 - 24s - loss: 3.1310 - accuracy200: 0.4446 - val_loss: 3.1771 - val_accuracy200: 0.4672 - 24s/epoch - 15ms/step
Epoch 14/50
1577/1577 - 23s - loss: 3.1222 - accuracy200: 0.4470 - val_loss: 3.1701 - val_accuracy200: 0.4663 - 23s/epoch - 15ms/step
Epoch 15/50
1577/1577 - 23s - loss: 3.1156 - accuracy200: 0.4489 - val_loss: 3.1757 - val_accuracy200: 0.4689 - 23s/epoch - 15ms/step
Epoch 16/50
1577/1577 - 23s - loss: 3.1067 - accuracy200: 0.4516 - val_loss: 3.1788 - val_accuracy200: 0.4664 - 23s/epoch - 15ms/step
Epoch 17/50
1577/1577 - 23s - loss: 3.1001 - accuracy200: 0.4535 - val_loss: 3.1765 - val_accuracy200: 0.4685 - 23s/epoch - 15ms/step
Epoch 18/50
1577/1577 - 23s - loss: 3.0946 - accuracy200: 0.4567 - val_loss: 3.1796 - val_accuracy200: 0.4674 - 23s/epoch - 15ms/step
Epoch 19/50
1577/1577 - 24s - loss: 3.0882 - accuracy200: 0.4583 - val_loss: 3.1816 - val_accuracy200: 0.4688 - 24s/epoch - 15ms/step
Epoch 20/50
1577/1577 - 24s - loss: 3.0784 - accuracy200: 0.4612 - val_loss: 3.1884 - val_accuracy200: 0.4668 - 24s/epoch - 15ms/step
Epoch 21/50
1577/1577 - 24s - loss: 3.0710 - accuracy200: 0.4632 - val_loss: 3.1991 - val_accuracy200: 0.4696 - 24s/epoch - 16ms/step
Epoch 22/50
1577/1577 - 24s - loss: 3.0642 - accuracy200: 0.4654 - val_loss: 3.2104 - val_accuracy200: 0.4664 - 24s/epoch - 15ms/step
testing model: results/AAL/W9/deepOF_L1/h200
Evaluating performance on  test set...
3870/3870 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0599777
{'0': {'precision': 0.47355291576673864, 'recall': 0.2836645912509097, 'f1-score': 0.3547994943109987, 'support': 309175}, '1': {'precision': 0.4271781722720166, 'recall': 0.6790485858428306, 'f1-score': 0.5244399155170728, 'support': 391081}, '2': {'precision': 0.4191626864534941, 'recall': 0.265299306564568, 'f1-score': 0.3249371657979522, 'support': 290438}, 'accuracy': 0.4343601556080889, 'macro avg': {'precision': 0.43996459149741646, 'recall': 0.4093374945527694, 'f1-score': 0.4013921918753412, 'support': 990694}, 'weighted avg': {'precision': 0.4393008959887451, 'recall': 0.4343601556080889, 'f1-score': 0.4130112030697279, 'support': 990694}}
[[ 87702 181752  39721]
 [ 58466 265563  67052]
 [ 39032 174353  77053]]
Evaluating performance on  train set...
1577/1577 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0430231
{'0': {'precision': 0.4431644457284557, 'recall': 0.3217981888745149, 'f1-score': 0.37285354750173444, 'support': 114404}, '1': {'precision': 0.4781638575357257, 'recall': 0.6440900413617563, 'f1-score': 0.5488607864591908, 'support': 176008}, '2': {'precision': 0.41898911856801796, 'recall': 0.30879414313250453, 'f1-score': 0.3555492209253198, 'support': 113098}, 'accuracy': 0.4587346038512057, 'macro avg': {'precision': 0.44677247394406644, 'recall': 0.42489412445625857, 'f1-score': 0.425754518295415, 'support': 403510}, 'weighted avg': {'precision': 0.45165493003413043, 'recall': 0.4587346038512057, 'f1-score': 0.44477641778322596, 'support': 403510}}
[[ 36815  61649  15940]
 [ 30154 113365  32489]
 [ 16104  62070  34924]]
Evaluating performance on  val set...
600/600 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0408987
{'0': {'precision': 0.4342773467925351, 'recall': 0.3303941785773543, 'f1-score': 0.37527932584874674, 'support': 42189}, '1': {'precision': 0.48558880043919844, 'recall': 0.6511720360445256, 'f1-score': 0.556320798032593, 'support': 67916}, '2': {'precision': 0.4287271286082304, 'recall': 0.29948090898604224, 'f1-score': 0.35263436697771083, 'support': 43345}, 'accuracy': 0.4636363636363636, 'macro avg': {'precision': 0.44953109194665464, 'recall': 0.42701570786930737, 'f1-score': 0.42807816361968354, 'support': 153450}, 'weighted avg': {'precision': 0.4554197024697466, 'recall': 0.4636363636363636, 'f1-score': 0.449010618664472, 'support': 153450}}
[[13939 22759  5491]
 [11885 44225 11806]
 [ 6273 24091 12981]]
training model: results/AAL/W9/deepOF_L1/h300
Epoch 1/50
1577/1577 - 27s - loss: 3.2848 - accuracy300: 0.3840 - val_loss: 3.2760 - val_accuracy300: 0.3978 - 27s/epoch - 17ms/step
Epoch 2/50
1577/1577 - 25s - loss: 3.2586 - accuracy300: 0.3940 - val_loss: 3.2509 - val_accuracy300: 0.4073 - 25s/epoch - 16ms/step
Epoch 3/50
1577/1577 - 25s - loss: 3.2478 - accuracy300: 0.3991 - val_loss: 3.2428 - val_accuracy300: 0.4087 - 25s/epoch - 16ms/step
Epoch 4/50
1577/1577 - 25s - loss: 3.2399 - accuracy300: 0.4040 - val_loss: 3.2391 - val_accuracy300: 0.4115 - 25s/epoch - 16ms/step
Epoch 5/50
1577/1577 - 23s - loss: 3.2332 - accuracy300: 0.4074 - val_loss: 3.2370 - val_accuracy300: 0.4121 - 23s/epoch - 14ms/step
Epoch 6/50
1577/1577 - 23s - loss: 3.2268 - accuracy300: 0.4116 - val_loss: 3.2356 - val_accuracy300: 0.4134 - 23s/epoch - 14ms/step
Epoch 7/50
1577/1577 - 22s - loss: 3.2209 - accuracy300: 0.4149 - val_loss: 3.2342 - val_accuracy300: 0.4141 - 22s/epoch - 14ms/step
Epoch 8/50
1577/1577 - 22s - loss: 3.2151 - accuracy300: 0.4178 - val_loss: 3.2319 - val_accuracy300: 0.4150 - 22s/epoch - 14ms/step
Epoch 9/50
1577/1577 - 22s - loss: 3.2095 - accuracy300: 0.4209 - val_loss: 3.2325 - val_accuracy300: 0.4143 - 22s/epoch - 14ms/step
Epoch 10/50
1577/1577 - 22s - loss: 3.2039 - accuracy300: 0.4227 - val_loss: 3.2321 - val_accuracy300: 0.4141 - 22s/epoch - 14ms/step
Epoch 11/50
1577/1577 - 22s - loss: 3.1982 - accuracy300: 0.4256 - val_loss: 3.2324 - val_accuracy300: 0.4169 - 22s/epoch - 14ms/step
Epoch 12/50
1577/1577 - 22s - loss: 3.1924 - accuracy300: 0.4285 - val_loss: 3.2364 - val_accuracy300: 0.4181 - 22s/epoch - 14ms/step
Epoch 13/50
1577/1577 - 22s - loss: 3.1877 - accuracy300: 0.4297 - val_loss: 3.2370 - val_accuracy300: 0.4178 - 22s/epoch - 14ms/step
Epoch 14/50
1577/1577 - 22s - loss: 3.1820 - accuracy300: 0.4321 - val_loss: 3.2431 - val_accuracy300: 0.4156 - 22s/epoch - 14ms/step
Epoch 15/50
1577/1577 - 22s - loss: 3.1768 - accuracy300: 0.4346 - val_loss: 3.2453 - val_accuracy300: 0.4187 - 22s/epoch - 14ms/step
Epoch 16/50
1577/1577 - 22s - loss: 3.1715 - accuracy300: 0.4369 - val_loss: 3.2427 - val_accuracy300: 0.4178 - 22s/epoch - 14ms/step
Epoch 17/50
1577/1577 - 22s - loss: 3.1658 - accuracy300: 0.4389 - val_loss: 3.2484 - val_accuracy300: 0.4189 - 22s/epoch - 14ms/step
Epoch 18/50
1577/1577 - 22s - loss: 3.1633 - accuracy300: 0.4405 - val_loss: 3.2466 - val_accuracy300: 0.4187 - 22s/epoch - 14ms/step
testing model: results/AAL/W9/deepOF_L1/h300
Evaluating performance on  test set...
3870/3870 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0880413
{'0': {'precision': 0.498967121782254, 'recall': 0.20699963354214698, 'f1-score': 0.2926087116129006, 'support': 346561}, '1': {'precision': 0.34505643360713295, 'recall': 0.7335005765215494, 'f1-score': 0.4693290954608038, 'support': 320890}, '2': {'precision': 0.4324117675615321, 'recall': 0.22044715585488317, 'f1-score': 0.29202003954634403, 'support': 323243}, 'accuracy': 0.38192317708596196, 'macro avg': {'precision': 0.4254784409836397, 'recall': 0.3869824553061932, 'f1-score': 0.3513192822066828, 'support': 990694}, 'weighted avg': {'precision': 0.4273991572110712, 'recall': 0.38192317708596196, 'f1-score': 0.34965712398659393, 'support': 990694}}
[[ 71738 229914  44909]
 [ 36892 235373  48625]
 [ 35143 216842  71258]]
Evaluating performance on  train set...
1577/1577 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0744293
{'0': {'precision': 0.45820128479657385, 'recall': 0.24834229564006344, 'f1-score': 0.32210542161117933, 'support': 129245}, '1': {'precision': 0.3937668587542913, 'recall': 0.6949412711400229, 'f1-score': 0.5026964231121981, 'support': 147883}, '2': {'precision': 0.4355577634266159, 'recall': 0.24975075564558244, 'f1-score': 0.3174654262006537, 'support': 126382}, 'accuracy': 0.41245817947510593, 'macro avg': {'precision': 0.42917530232582707, 'recall': 0.3976781074752229, 'f1-score': 0.38075575697467706, 'support': 403510}, 'weighted avg': {'precision': 0.4274945123641957, 'recall': 0.41245817947510593, 'f1-score': 0.386837218035065, 'support': 403510}}
[[ 32097  79728  17420]
 [ 21629 102770  23484]
 [ 16324  78494  31564]]
Evaluating performance on  val set...
600/600 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0723845
{'0': {'precision': 0.46051128530350177, 'recall': 0.24569699262341593, 'f1-score': 0.3204330546800055, 'support': 47583}, '1': {'precision': 0.39723953872811646, 'recall': 0.7002545422627929, 'f1-score': 0.5069162488960053, 'support': 56965}, '2': {'precision': 0.44311810453969974, 'recall': 0.250501002004008, 'f1-score': 0.3200647967915137, 'support': 48902}, 'accuracy': 0.4159726295210166, 'macro avg': {'precision': 0.4336229761904393, 'recall': 0.39881751229673895, 'f1-score': 0.3824713667891748, 'support': 153450}, 'weighted avg': {'precision': 0.4314800935838649, 'recall': 0.4159726295210166, 'f1-score': 0.38954355719712114, 'support': 153450}}
[[11691 29689  6203]
 [ 7883 39890  9192]
 [ 5813 30839 12250]]
training model: results/AAL/W9/deepOF_L1/h500
Epoch 1/50
1577/1577 - 25s - loss: 3.3049 - accuracy500: 0.3683 - val_loss: 3.2988 - val_accuracy500: 0.3519 - 25s/epoch - 16ms/step
Epoch 2/50
1577/1577 - 22s - loss: 3.2853 - accuracy500: 0.3743 - val_loss: 3.2809 - val_accuracy500: 0.3662 - 22s/epoch - 14ms/step
Epoch 3/50
1577/1577 - 22s - loss: 3.2788 - accuracy500: 0.3759 - val_loss: 3.2784 - val_accuracy500: 0.3715 - 22s/epoch - 14ms/step
Epoch 4/50
1577/1577 - 23s - loss: 3.2745 - accuracy500: 0.3788 - val_loss: 3.2771 - val_accuracy500: 0.3742 - 23s/epoch - 15ms/step
Epoch 5/50
1577/1577 - 22s - loss: 3.2719 - accuracy500: 0.3805 - val_loss: 3.2756 - val_accuracy500: 0.3750 - 22s/epoch - 14ms/step
Epoch 6/50
1577/1577 - 22s - loss: 3.2694 - accuracy500: 0.3819 - val_loss: 3.2753 - val_accuracy500: 0.3755 - 22s/epoch - 14ms/step
Epoch 7/50
1577/1577 - 22s - loss: 3.2673 - accuracy500: 0.3835 - val_loss: 3.2742 - val_accuracy500: 0.3759 - 22s/epoch - 14ms/step
Epoch 8/50
1577/1577 - 22s - loss: 3.2649 - accuracy500: 0.3863 - val_loss: 3.2733 - val_accuracy500: 0.3771 - 22s/epoch - 14ms/step
Epoch 9/50
1577/1577 - 22s - loss: 3.2624 - accuracy500: 0.3879 - val_loss: 3.2722 - val_accuracy500: 0.3779 - 22s/epoch - 14ms/step
Epoch 10/50
1577/1577 - 22s - loss: 3.2609 - accuracy500: 0.3892 - val_loss: 3.2714 - val_accuracy500: 0.3794 - 22s/epoch - 14ms/step
Epoch 11/50
1577/1577 - 22s - loss: 3.2581 - accuracy500: 0.3912 - val_loss: 3.2704 - val_accuracy500: 0.3781 - 22s/epoch - 14ms/step
Epoch 12/50
1577/1577 - 22s - loss: 3.2556 - accuracy500: 0.3932 - val_loss: 3.2708 - val_accuracy500: 0.3766 - 22s/epoch - 14ms/step
Epoch 13/50
1577/1577 - 22s - loss: 3.2528 - accuracy500: 0.3953 - val_loss: 3.2704 - val_accuracy500: 0.3782 - 22s/epoch - 14ms/step
Epoch 14/50
1577/1577 - 22s - loss: 3.2508 - accuracy500: 0.3967 - val_loss: 3.2695 - val_accuracy500: 0.3782 - 22s/epoch - 14ms/step
Epoch 15/50
1577/1577 - 22s - loss: 3.2480 - accuracy500: 0.3982 - val_loss: 3.2697 - val_accuracy500: 0.3769 - 22s/epoch - 14ms/step
Epoch 16/50
1577/1577 - 22s - loss: 3.2456 - accuracy500: 0.3997 - val_loss: 3.2703 - val_accuracy500: 0.3755 - 22s/epoch - 14ms/step
Epoch 17/50
1577/1577 - 22s - loss: 3.2431 - accuracy500: 0.4016 - val_loss: 3.2705 - val_accuracy500: 0.3762 - 22s/epoch - 14ms/step
Epoch 18/50
1577/1577 - 22s - loss: 3.2401 - accuracy500: 0.4035 - val_loss: 3.2693 - val_accuracy500: 0.3775 - 22s/epoch - 14ms/step
Epoch 19/50
1577/1577 - 23s - loss: 3.2368 - accuracy500: 0.4056 - val_loss: 3.2723 - val_accuracy500: 0.3744 - 23s/epoch - 14ms/step
Epoch 20/50
1577/1577 - 22s - loss: 3.2352 - accuracy500: 0.4068 - val_loss: 3.2713 - val_accuracy500: 0.3764 - 22s/epoch - 14ms/step
Epoch 21/50
1577/1577 - 22s - loss: 3.2314 - accuracy500: 0.4094 - val_loss: 3.2711 - val_accuracy500: 0.3783 - 22s/epoch - 14ms/step
Epoch 22/50
1577/1577 - 23s - loss: 3.2302 - accuracy500: 0.4093 - val_loss: 3.2747 - val_accuracy500: 0.3748 - 23s/epoch - 14ms/step
Epoch 23/50
1577/1577 - 23s - loss: 3.2271 - accuracy500: 0.4120 - val_loss: 3.2761 - val_accuracy500: 0.3747 - 23s/epoch - 14ms/step
Epoch 24/50
1577/1577 - 22s - loss: 3.2239 - accuracy500: 0.4142 - val_loss: 3.2831 - val_accuracy500: 0.3719 - 22s/epoch - 14ms/step
Epoch 25/50
1577/1577 - 22s - loss: 3.2209 - accuracy500: 0.4168 - val_loss: 3.2833 - val_accuracy500: 0.3704 - 22s/epoch - 14ms/step
Epoch 26/50
1577/1577 - 23s - loss: 3.2192 - accuracy500: 0.4163 - val_loss: 3.2908 - val_accuracy500: 0.3713 - 23s/epoch - 14ms/step
Epoch 27/50
1577/1577 - 23s - loss: 3.2177 - accuracy500: 0.4170 - val_loss: 3.2895 - val_accuracy500: 0.3687 - 23s/epoch - 14ms/step
Epoch 28/50
1577/1577 - 22s - loss: 3.2148 - accuracy500: 0.4189 - val_loss: 3.2965 - val_accuracy500: 0.3677 - 22s/epoch - 14ms/step
testing model: results/AAL/W9/deepOF_L1/h500
Evaluating performance on  test set...
3870/3870 - 21s - 21s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0943773
{'0': {'precision': 0.39686867065158327, 'recall': 0.38009302655662763, 'f1-score': 0.3882997442872441, 'support': 338183}, '1': {'precision': 0.33911888723754796, 'recall': 0.32454590535352124, 'f1-score': 0.3316723969981762, 'support': 336769}, '2': {'precision': 0.3632154747771466, 'recall': 0.39630774493098797, 'f1-score': 0.3790406981587306, 'support': 315742}, 'accuracy': 0.36637851849309677, 'macro avg': {'precision': 0.36640101088875926, 'recall': 0.3669822256137123, 'f1-score': 0.3663376131480503, 'support': 990694}, 'weighted avg': {'precision': 0.3665121082999917, 'recall': 0.36637851849309677, 'f1-score': 0.36609934248618226, 'support': 990694}}
[[128541 107954 101688]
 [109782 109297 117690]
 [ 85565 105046 125131]]
Evaluating performance on  train set...
1577/1577 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0848439
{'0': {'precision': 0.41291445018006345, 'recall': 0.4205931900556435, 'f1-score': 0.41671844968857935, 'support': 137123}, '1': {'precision': 0.3482856448083002, 'recall': 0.3246935783698823, 'f1-score': 0.3360760879767231, 'support': 132334}, '2': {'precision': 0.401176076943339, 'recall': 0.42037104727234753, 'f1-score': 0.4105493224537375, 'support': 134053}, 'accuracy': 0.38906842457436, 'macro avg': {'precision': 0.38745872397723424, 'recall': 0.3885526052326244, 'f1-score': 0.38778128670634665, 'support': 403510}, 'weighted avg': {'precision': 0.3878192791122596, 'recall': 0.38906842457436, 'f1-score': 0.3882217177414428, 'support': 403510}}
[[57673 40336 39114]
 [44365 42968 45001]
 [37635 40066 56352]]
Evaluating performance on  val set...
600/600 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0894955
{'0': {'precision': 0.3885946193125524, 'recall': 0.4071264597265196, 'f1-score': 0.39764474210120976, 'support': 50095}, '1': {'precision': 0.3404880917377242, 'recall': 0.31346313733830894, 'f1-score': 0.326417202742291, 'support': 51719}, '2': {'precision': 0.39646123856650173, 'recall': 0.4096366875823069, 'f1-score': 0.40294128852821276, 'support': 51636}, 'accuracy': 0.37640273704789834, 'macro avg': {'precision': 0.37518131653892617, 'recall': 0.37674209488237853, 'f1-score': 0.3756677444572379, 'support': 153450}, 'weighted avg': {'precision': 0.37502785002062927, 'recall': 0.37640273704789834, 'f1-score': 0.37542040429215673, 'support': 153450}}
[[20395 15241 14459]
 [17766 16212 17741]
 [14323 16161 21152]]
training model: results/AAL/W9/deepOF_L1/h1000
Epoch 1/50
1577/1577 - 24s - loss: 3.2451 - accuracy1000: 0.4059 - val_loss: 3.3477 - val_accuracy1000: 0.3355 - 24s/epoch - 15ms/step
Epoch 2/50
1577/1577 - 22s - loss: 3.2380 - accuracy1000: 0.4036 - val_loss: 3.3207 - val_accuracy1000: 0.3524 - 22s/epoch - 14ms/step
Epoch 3/50
1577/1577 - 22s - loss: 3.2526 - accuracy1000: 0.3945 - val_loss: 3.3116 - val_accuracy1000: 0.3588 - 22s/epoch - 14ms/step
Epoch 4/50
1577/1577 - 22s - loss: 3.2586 - accuracy1000: 0.3929 - val_loss: 3.3103 - val_accuracy1000: 0.3631 - 22s/epoch - 14ms/step
Epoch 5/50
1577/1577 - 22s - loss: 3.2691 - accuracy1000: 0.3879 - val_loss: 3.3169 - val_accuracy1000: 0.3640 - 22s/epoch - 14ms/step
Epoch 6/50
1577/1577 - 22s - loss: 3.2726 - accuracy1000: 0.3830 - val_loss: 3.3064 - val_accuracy1000: 0.3644 - 22s/epoch - 14ms/step
Epoch 7/50
1577/1577 - 22s - loss: 3.2774 - accuracy1000: 0.3797 - val_loss: 3.3052 - val_accuracy1000: 0.3645 - 22s/epoch - 14ms/step
Epoch 8/50
1577/1577 - 22s - loss: 3.2753 - accuracy1000: 0.3819 - val_loss: 3.3052 - val_accuracy1000: 0.3646 - 22s/epoch - 14ms/step
Epoch 9/50
1577/1577 - 23s - loss: 3.2717 - accuracy1000: 0.3850 - val_loss: 3.3066 - val_accuracy1000: 0.3652 - 23s/epoch - 14ms/step
Epoch 10/50
1577/1577 - 22s - loss: 3.2652 - accuracy1000: 0.3901 - val_loss: 3.3127 - val_accuracy1000: 0.3654 - 22s/epoch - 14ms/step
Epoch 11/50
1577/1577 - 22s - loss: 3.2565 - accuracy1000: 0.3970 - val_loss: 3.3209 - val_accuracy1000: 0.3657 - 22s/epoch - 14ms/step
Epoch 12/50
1577/1577 - 22s - loss: 3.2469 - accuracy1000: 0.4031 - val_loss: 3.3273 - val_accuracy1000: 0.3631 - 22s/epoch - 14ms/step
Epoch 13/50
1577/1577 - 22s - loss: 3.2342 - accuracy1000: 0.4091 - val_loss: 3.3280 - val_accuracy1000: 0.3635 - 22s/epoch - 14ms/step
Epoch 14/50
1577/1577 - 22s - loss: 3.2288 - accuracy1000: 0.4118 - val_loss: 3.3303 - val_accuracy1000: 0.3630 - 22s/epoch - 14ms/step
Epoch 15/50
1577/1577 - 22s - loss: 3.2241 - accuracy1000: 0.4128 - val_loss: 3.3292 - val_accuracy1000: 0.3625 - 22s/epoch - 14ms/step
Epoch 16/50
1577/1577 - 23s - loss: 3.2216 - accuracy1000: 0.4136 - val_loss: 3.3283 - val_accuracy1000: 0.3629 - 23s/epoch - 15ms/step
Epoch 17/50
1577/1577 - 23s - loss: 3.2184 - accuracy1000: 0.4145 - val_loss: 3.3296 - val_accuracy1000: 0.3621 - 23s/epoch - 14ms/step
testing model: results/AAL/W9/deepOF_L1/h1000
Evaluating performance on  test set...
3870/3870 - 21s - 21s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1541507
{'0': {'precision': 0.3159920750288034, 'recall': 0.426991713772307, 'f1-score': 0.36320038118929826, 'support': 274914}, '1': {'precision': 0.5, 'recall': 4.198381943598937e-06, 'f1-score': 8.39669338214611e-06, 'support': 476374}, '2': {'precision': 0.25459217126449035, 'recall': 0.6584839143546946, 'f1-score': 0.36720893721494696, 'support': 239406}, 'accuracy': 0.2776164991410062, 'macro avg': {'precision': 0.3568614154310979, 'recall': 0.36182660883631507, 'f1-score': 0.24347257169920913, 'support': 990694}, 'weighted avg': {'precision': 0.3896344771122213, 'recall': 0.2776164991410062, 'f1-score': 0.1895286459629003, 'support': 990694}}
[[117386      2 157526]
 [172337      2 304035]
 [ 81761      0 157645]]
Evaluating performance on  train set...
1577/1577 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1091305
{'0': {'precision': 0.3672821894044875, 'recall': 0.4767809655029371, 'f1-score': 0.41492903903739353, 'support': 134997}, '1': {'precision': 1.0, 'recall': 7.2243373476567865e-06, 'f1-score': 1.4448570313967433e-05, 'support': 138421}, '2': {'precision': 0.34062164589402666, 'recall': 0.5976693416966454, 'f1-score': 0.4339359912043019, 'support': 130092}, 'accuracy': 0.35220192808108847, 'macro avg': {'precision': 0.5693012784328381, 'recall': 0.35815251051231006, 'f1-score': 0.2829598262706698, 'support': 403510}, 'weighted avg': {'precision': 0.575735780725839, 'recall': 0.35220192808108847, 'f1-score': 0.2787236411395814, 'support': 403510}}
[[64364     0 70633]
 [58540     1 79880]
 [52340     0 77752]]
Evaluating performance on  val set...
600/600 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.103855
{'0': {'precision': 0.3593919484302848, 'recall': 0.4584321631878558, 'f1-score': 0.4029150669701023, 'support': 50592}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 50762}, '2': {'precision': 0.3683139142561519, 'recall': 0.6286279176904177, 'f1-score': 0.4644852920318838, 'support': 52096}, 'accuracy': 0.3645617464972304, 'macro avg': {'precision': 0.24256862089547893, 'recall': 0.36235336029275783, 'f1-score': 0.289133453000662, 'support': 153450}, 'weighted avg': {'precision': 0.24353235016013988, 'recall': 0.3645617464972304, 'f1-score': 0.29053180085920133, 'support': 153450}}
[[23193     0 27399]
 [21994     0 28768]
 [19347     0 32749]]
training model: results/AAL/W9/deepLOB_L2/h10
Epoch 1/50
1577/1577 - 68s - loss: 2.6976 - accuracy10: 0.4826 - val_loss: 4.0206 - val_accuracy10: 0.8468 - 68s/epoch - 43ms/step
Epoch 2/50
1577/1577 - 65s - loss: 2.4731 - accuracy10: 0.5307 - val_loss: 2.7584 - val_accuracy10: 0.6421 - 65s/epoch - 41ms/step
Epoch 3/50
1577/1577 - 65s - loss: 2.2960 - accuracy10: 0.5994 - val_loss: 2.4099 - val_accuracy10: 0.4110 - 65s/epoch - 41ms/step
Epoch 4/50
1577/1577 - 65s - loss: 2.1719 - accuracy10: 0.6555 - val_loss: 2.2586 - val_accuracy10: 0.6374 - 65s/epoch - 41ms/step
Epoch 5/50
1577/1577 - 65s - loss: 2.0843 - accuracy10: 0.6818 - val_loss: 2.3754 - val_accuracy10: 0.5111 - 65s/epoch - 41ms/step
Epoch 6/50
1577/1577 - 65s - loss: 2.0444 - accuracy10: 0.6914 - val_loss: 2.3066 - val_accuracy10: 0.6731 - 65s/epoch - 41ms/step
Epoch 7/50
1577/1577 - 65s - loss: 2.0117 - accuracy10: 0.6973 - val_loss: 2.3740 - val_accuracy10: 0.5161 - 65s/epoch - 41ms/step
Epoch 8/50
1577/1577 - 64s - loss: 1.9836 - accuracy10: 0.7021 - val_loss: 2.4485 - val_accuracy10: 0.4867 - 64s/epoch - 41ms/step
Epoch 9/50
1577/1577 - 64s - loss: 1.9613 - accuracy10: 0.7053 - val_loss: 2.5799 - val_accuracy10: 0.4342 - 64s/epoch - 41ms/step
Epoch 10/50
1577/1577 - 65s - loss: 1.9442 - accuracy10: 0.7072 - val_loss: 2.4582 - val_accuracy10: 0.4683 - 65s/epoch - 41ms/step
Epoch 11/50
1577/1577 - 64s - loss: 1.9268 - accuracy10: 0.7105 - val_loss: 2.2569 - val_accuracy10: 0.5419 - 64s/epoch - 41ms/step
Epoch 12/50
1577/1577 - 64s - loss: 1.9122 - accuracy10: 0.7113 - val_loss: 2.3193 - val_accuracy10: 0.5090 - 64s/epoch - 41ms/step
Epoch 13/50
1577/1577 - 64s - loss: 1.8938 - accuracy10: 0.7132 - val_loss: 2.3207 - val_accuracy10: 0.5063 - 64s/epoch - 41ms/step
Epoch 14/50
1577/1577 - 65s - loss: 1.8826 - accuracy10: 0.7128 - val_loss: 2.2858 - val_accuracy10: 0.5231 - 65s/epoch - 41ms/step
Epoch 15/50
1577/1577 - 65s - loss: 1.8689 - accuracy10: 0.7140 - val_loss: 2.3354 - val_accuracy10: 0.5022 - 65s/epoch - 41ms/step
Epoch 16/50
1577/1577 - 65s - loss: 1.8579 - accuracy10: 0.7148 - val_loss: 2.5172 - val_accuracy10: 0.4090 - 65s/epoch - 41ms/step
Epoch 17/50
1577/1577 - 65s - loss: 1.8473 - accuracy10: 0.7141 - val_loss: 2.3697 - val_accuracy10: 0.5032 - 65s/epoch - 41ms/step
Epoch 18/50
1577/1577 - 64s - loss: 1.8365 - accuracy10: 0.7142 - val_loss: 2.4697 - val_accuracy10: 0.4431 - 64s/epoch - 41ms/step
Epoch 19/50
1577/1577 - 65s - loss: 1.8257 - accuracy10: 0.7165 - val_loss: 2.4671 - val_accuracy10: 0.4175 - 65s/epoch - 41ms/step
Epoch 20/50
1577/1577 - 64s - loss: 1.8152 - accuracy10: 0.7163 - val_loss: 2.4431 - val_accuracy10: 0.4887 - 64s/epoch - 41ms/step
Epoch 21/50
1577/1577 - 65s - loss: 1.8048 - accuracy10: 0.7163 - val_loss: 2.3763 - val_accuracy10: 0.5220 - 65s/epoch - 41ms/step
testing model: results/AAL/W9/deepLOB_L2/h10
Evaluating performance on  test set...
3870/3870 - 52s - 52s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.6554563
{'0': {'precision': 0.1653178801427883, 'recall': 0.7574987833394661, 'f1-score': 0.2714040567925439, 'support': 84247}, '1': {'precision': 0.9545118769272475, 'recall': 0.1706071177653415, 'f1-score': 0.28947430620854075, 'support': 825540}, '2': {'precision': 0.1353373425184362, 'recall': 0.7646055542509671, 'f1-score': 0.22996944396945884, 'support': 80911}, 'accuracy': 0.26902749374683305, 'macro avg': {'precision': 0.4183890331961573, 'recall': 0.5642371517852582, 'f1-score': 0.2636159356568479, 'support': 990698}, 'weighted avg': {'precision': 0.8204978207762795, 'recall': 0.26902749374683305, 'f1-score': 0.2830778441068954, 'support': 990698}}
[[ 63817   3853  16577]
 [306022 140843 378675]
 [ 16187   2859  61865]]
Evaluating performance on  train set...
1577/1577 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1143025
{'0': {'precision': 0.190504628247238, 'recall': 0.7603514028874966, 'f1-score': 0.30467380255554877, 'support': 29368}, '1': {'precision': 0.9702072858128759, 'recall': 0.45544557319387236, 'f1-score': 0.6198937007874015, 'support': 345712}, '2': {'precision': 0.1738208326949285, 'recall': 0.7581779810059796, 'f1-score': 0.28280535565512305, 'support': 28430}, 'accuracy': 0.49896656836261805, 'macro avg': {'precision': 0.44484424891834745, 'recall': 0.6579916523624495, 'f1-score': 0.4024576196660244, 'support': 403510}, 'weighted avg': {'precision': 0.8573486837719576, 'recall': 0.49896656836261805, 'f1-score': 0.5732014264363724, 'support': 403510}}
[[ 22330   2623   4415]
 [ 90222 157453  98037]
 [  4663   2212  21555]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0353773
{'0': {'precision': 0.19795497821947466, 'recall': 0.7353682170542636, 'f1-score': 0.31193867275006687, 'support': 10320}, '1': {'precision': 0.9734284802599136, 'recall': 0.5064978189666883, 'f1-score': 0.6663026428131763, 'support': 132506}, '2': {'precision': 0.18017198431780276, 'recall': 0.7829442771084337, 'f1-score': 0.2929337395009773, 'support': 10624}, 'accuracy': 0.541029651352232, 'macro avg': {'precision': 0.450518480932397, 'recall': 0.6749367710431285, 'f1-score': 0.42372501835474013, 'support': 153450}, 'weighted avg': {'precision': 0.8663548826454052, 'recall': 0.541029651352232, 'f1-score': 0.6166206134887052, 'support': 153450}}
[[ 7589  1058  1673]
 [29216 67114 36176]
 [ 1532   774  8318]]
training model: results/AAL/W9/deepLOB_L2/h20
Epoch 1/50
1577/1577 - 67s - loss: 2.7295 - accuracy20: 0.4821 - val_loss: 2.9474 - val_accuracy20: 0.5109 - 67s/epoch - 43ms/step
Epoch 2/50
1577/1577 - 65s - loss: 2.4924 - accuracy20: 0.5439 - val_loss: 2.9241 - val_accuracy20: 0.7201 - 65s/epoch - 41ms/step
Epoch 3/50
1577/1577 - 64s - loss: 2.3718 - accuracy20: 0.5899 - val_loss: 2.8490 - val_accuracy20: 0.7349 - 64s/epoch - 41ms/step
Epoch 4/50
1577/1577 - 65s - loss: 2.2627 - accuracy20: 0.6332 - val_loss: 2.3865 - val_accuracy20: 0.6893 - 65s/epoch - 41ms/step
Epoch 5/50
1577/1577 - 64s - loss: 2.1897 - accuracy20: 0.6573 - val_loss: 2.3774 - val_accuracy20: 0.5431 - 64s/epoch - 41ms/step
Epoch 6/50
1577/1577 - 65s - loss: 2.1505 - accuracy20: 0.6659 - val_loss: 2.3180 - val_accuracy20: 0.6138 - 65s/epoch - 41ms/step
Epoch 7/50
1577/1577 - 65s - loss: 2.1246 - accuracy20: 0.6704 - val_loss: 2.2899 - val_accuracy20: 0.6091 - 65s/epoch - 41ms/step
Epoch 8/50
1577/1577 - 65s - loss: 2.1029 - accuracy20: 0.6743 - val_loss: 2.2828 - val_accuracy20: 0.6172 - 65s/epoch - 41ms/step
Epoch 9/50
1577/1577 - 65s - loss: 2.0835 - accuracy20: 0.6788 - val_loss: 2.3868 - val_accuracy20: 0.5168 - 65s/epoch - 41ms/step
Epoch 10/50
1577/1577 - 64s - loss: 2.0654 - accuracy20: 0.6815 - val_loss: 2.4223 - val_accuracy20: 0.5132 - 64s/epoch - 41ms/step
Epoch 11/50
1577/1577 - 64s - loss: 2.0494 - accuracy20: 0.6816 - val_loss: 2.4410 - val_accuracy20: 0.4971 - 64s/epoch - 41ms/step
Epoch 12/50
1577/1577 - 64s - loss: 2.0339 - accuracy20: 0.6827 - val_loss: 2.5401 - val_accuracy20: 0.4527 - 64s/epoch - 41ms/step
Epoch 13/50
1577/1577 - 65s - loss: 2.0195 - accuracy20: 0.6846 - val_loss: 2.3640 - val_accuracy20: 0.5487 - 65s/epoch - 41ms/step
Epoch 14/50
1577/1577 - 64s - loss: 2.0036 - accuracy20: 0.6847 - val_loss: 2.7192 - val_accuracy20: 0.4191 - 64s/epoch - 41ms/step
Epoch 15/50
1577/1577 - 65s - loss: 1.9926 - accuracy20: 0.6855 - val_loss: 2.5021 - val_accuracy20: 0.4948 - 65s/epoch - 41ms/step
Epoch 16/50
1577/1577 - 65s - loss: 1.9793 - accuracy20: 0.6873 - val_loss: 2.8022 - val_accuracy20: 0.3896 - 65s/epoch - 41ms/step
Epoch 17/50
1577/1577 - 64s - loss: 1.9653 - accuracy20: 0.6875 - val_loss: 2.6429 - val_accuracy20: 0.4533 - 64s/epoch - 41ms/step
Epoch 18/50
1577/1577 - 65s - loss: 1.9543 - accuracy20: 0.6883 - val_loss: 3.0847 - val_accuracy20: 0.3197 - 65s/epoch - 41ms/step
testing model: results/AAL/W9/deepLOB_L2/h20
Evaluating performance on  test set...
3870/3870 - 52s - 52s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.5344561
{'0': {'precision': 0.19547331991412825, 'recall': 0.8097301795047368, 'f1-score': 0.31492259331361294, 'support': 115373}, '1': {'precision': 0.9094375828836482, 'recall': 0.19450674697157436, 'f1-score': 0.32047222135483683, 'support': 765084}, '2': {'precision': 0.19895000042962338, 'recall': 0.6300922524287697, 'f1-score': 0.3024136669975445, 'support': 110241}, 'accuracy': 0.3146236289969294, 'macro avg': {'precision': 0.4346203010757999, 'recall': 0.5447763929683602, 'f1-score': 0.3126028272219981, 'support': 990698}, 'weighted avg': {'precision': 0.7472316831151046, 'recall': 0.3146236289969294, 'f1-score': 0.3178164470150255, 'support': 990698}}
[[ 93421   6593  15359]
 [351948 148814 264322]
 [ 32553   8226  69462]]
Evaluating performance on  train set...
1577/1577 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8817004
{'0': {'precision': 0.25571997015667747, 'recall': 0.7117324236131711, 'f1-score': 0.3762545739675902, 'support': 40452}, '1': {'precision': 0.9278555080208476, 'recall': 0.5645468075514577, 'f1-score': 0.7019794320291337, 'support': 323858}, '2': {'precision': 0.2749672429772139, 'recall': 0.658469387755102, 'f1-score': 0.38793744786696027, 'support': 39200}, 'accuracy': 0.5884265569626527, 'macro avg': {'precision': 0.4861809070515796, 'recall': 0.644916206306577, 'f1-score': 0.4887238179545614, 'support': 403510}, 'weighted avg': {'precision': 0.7970472337094505, 'recall': 0.5884265569626527, 'f1-score': 0.638817012913219, 'support': 403510}}
[[ 28791   7009   4652]
 [ 77616 182833  63409]
 [  6181   7207  25812]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.824867
{'0': {'precision': 0.2677454153182309, 'recall': 0.6876298656323591, 'f1-score': 0.38541868861368844, 'support': 14438}, '1': {'precision': 0.9332908115409148, 'recall': 0.6006471293695318, 'f1-score': 0.7309010773751224, 'support': 124241}, '2': {'precision': 0.2787893768366702, 'recall': 0.6872249678423938, 'f1-score': 0.39666288929701843, 'support': 14771}, 'accuracy': 0.6171652003910069, 'macro avg': {'precision': 0.49327520123193863, 'recall': 0.6585006542814282, 'f1-score': 0.5043275517619431, 'support': 153450}, 'weighted avg': {'precision': 0.8076682300962781, 'recall': 0.6171652003910069, 'f1-score': 0.6662213314967305, 'support': 153450}}
[[ 9928  2593  1917]
 [25273 74625 24343]
 [ 1879  2741 10151]]
training model: results/AAL/W9/deepLOB_L2/h30
Epoch 1/50
1577/1577 - 78s - loss: 2.7861 - accuracy30: 0.4759 - val_loss: 3.0094 - val_accuracy30: 0.4158 - 78s/epoch - 49ms/step
Epoch 2/50
1577/1577 - 66s - loss: 2.5784 - accuracy30: 0.5286 - val_loss: 2.8227 - val_accuracy30: 0.5713 - 66s/epoch - 42ms/step
Epoch 3/50
1577/1577 - 66s - loss: 2.4715 - accuracy30: 0.5696 - val_loss: 2.5728 - val_accuracy30: 0.6668 - 66s/epoch - 42ms/step
Epoch 4/50
1577/1577 - 65s - loss: 2.3935 - accuracy30: 0.6023 - val_loss: 2.5715 - val_accuracy30: 0.4749 - 65s/epoch - 41ms/step
Epoch 5/50
1577/1577 - 65s - loss: 2.3268 - accuracy30: 0.6245 - val_loss: 2.4546 - val_accuracy30: 0.5304 - 65s/epoch - 41ms/step
Epoch 6/50
1577/1577 - 65s - loss: 2.2685 - accuracy30: 0.6417 - val_loss: 2.6006 - val_accuracy30: 0.7319 - 65s/epoch - 41ms/step
Epoch 7/50
1577/1577 - 65s - loss: 2.2343 - accuracy30: 0.6484 - val_loss: 2.5341 - val_accuracy30: 0.6392 - 65s/epoch - 41ms/step
Epoch 8/50
1577/1577 - 65s - loss: 2.2095 - accuracy30: 0.6527 - val_loss: 2.4393 - val_accuracy30: 0.6149 - 65s/epoch - 41ms/step
Epoch 9/50
1577/1577 - 64s - loss: 2.1892 - accuracy30: 0.6561 - val_loss: 2.6385 - val_accuracy30: 0.4590 - 64s/epoch - 41ms/step
Epoch 10/50
1577/1577 - 64s - loss: 2.1659 - accuracy30: 0.6596 - val_loss: 2.8217 - val_accuracy30: 0.4037 - 64s/epoch - 41ms/step
Epoch 11/50
1577/1577 - 65s - loss: 2.1476 - accuracy30: 0.6611 - val_loss: 2.9740 - val_accuracy30: 0.3441 - 65s/epoch - 41ms/step
Epoch 12/50
1577/1577 - 65s - loss: 2.1328 - accuracy30: 0.6619 - val_loss: 3.0260 - val_accuracy30: 0.3639 - 65s/epoch - 41ms/step
Epoch 13/50
1577/1577 - 65s - loss: 2.1173 - accuracy30: 0.6618 - val_loss: 3.0235 - val_accuracy30: 0.3677 - 65s/epoch - 41ms/step
Epoch 14/50
1577/1577 - 65s - loss: 2.1033 - accuracy30: 0.6627 - val_loss: 3.3822 - val_accuracy30: 0.3042 - 65s/epoch - 41ms/step
Epoch 15/50
1577/1577 - 65s - loss: 2.0900 - accuracy30: 0.6638 - val_loss: 2.8577 - val_accuracy30: 0.4443 - 65s/epoch - 41ms/step
Epoch 16/50
1577/1577 - 64s - loss: 2.0758 - accuracy30: 0.6640 - val_loss: 3.6086 - val_accuracy30: 0.2909 - 64s/epoch - 41ms/step
Epoch 17/50
1577/1577 - 64s - loss: 2.0633 - accuracy30: 0.6653 - val_loss: 3.0702 - val_accuracy30: 0.4244 - 64s/epoch - 41ms/step
Epoch 18/50
1577/1577 - 65s - loss: 2.0526 - accuracy30: 0.6656 - val_loss: 2.7197 - val_accuracy30: 0.4984 - 65s/epoch - 41ms/step
testing model: results/AAL/W9/deepLOB_L2/h30
Evaluating performance on  test set...
3870/3870 - 52s - 52s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3488067
{'0': {'precision': 0.27849886959360814, 'recall': 0.6530355775758714, 'f1-score': 0.39047331145275527, 'support': 138458}, '1': {'precision': 0.8906077616582829, 'recall': 0.2544323323877876, 'f1-score': 0.3957929704289754, 'support': 720219}, '2': {'precision': 0.2115577223478701, 'recall': 0.7375796274835064, 'f1-score': 0.3288052378685198, 'support': 132021}, 'accuracy': 0.3745248299683657, 'macro avg': {'precision': 0.46022145119992036, 'recall': 0.5483491791490551, 'f1-score': 0.3716905065834168, 'support': 990698}, 'weighted avg': {'precision': 0.7145700203715429, 'recall': 0.3745248299683657, 'f1-score': 0.3861226806101876, 'support': 990698}}
[[ 90418  12723  35317]
 [209384 183247 327588]
 [ 24860   9785  97376]]
Evaluating performance on  train set...
1577/1577 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8671683
{'0': {'precision': 0.30223077905366247, 'recall': 0.6290866711648163, 'f1-score': 0.40830192685386696, 'support': 48909}, '1': {'precision': 0.8967407733810185, 'recall': 0.5698545213008427, 'f1-score': 0.6968681626062876, 'support': 307124}, '2': {'precision': 0.2931630028722146, 'recall': 0.6578553826063146, 'f1-score': 0.40558387170080834, 'support': 47477}, 'accuracy': 0.5873881688186167, 'macro avg': {'precision': 0.4973781851022985, 'recall': 0.6189321916906579, 'f1-score': 0.503584653720321, 'support': 403510}, 'weighted avg': {'precision': 0.7536638951797272, 'recall': 0.5873881688186167, 'f1-score': 0.6276188495688547, 'support': 403510}}
[[ 30768  10996   7145]
 [ 63948 175016  68160]
 [  7087   9157  31233]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8307355
{'0': {'precision': 0.29471589652885255, 'recall': 0.6060812730889458, 'f1-score': 0.39658602800349585, 'support': 17595}, '1': {'precision': 0.9060581900097447, 'recall': 0.6070323297241841, 'f1-score': 0.7269976340133428, 'support': 117941}, '2': {'precision': 0.31525007189730453, 'recall': 0.6731048342078821, 'f1-score': 0.429393016754803, 'support': 17914}, 'accuracy': 0.6146366894753992, 'macro avg': {'precision': 0.5053413861453006, 'recall': 0.6287394790070041, 'f1-score': 0.5176588929238806, 'support': 153450}, 'weighted avg': {'precision': 0.7669881067144527, 'recall': 0.6146366894753992, 'f1-score': 0.6543688863997048, 'support': 153450}}
[[10664  4080  2851]
 [23007 71594 23340]
 [ 2513  3343 12058]]
training model: results/AAL/W9/deepLOB_L2/h50
Epoch 1/50
1577/1577 - 67s - loss: 2.8918 - accuracy50: 0.4664 - val_loss: 3.4076 - val_accuracy50: 0.3767 - 67s/epoch - 43ms/step
Epoch 2/50
1577/1577 - 65s - loss: 2.7812 - accuracy50: 0.4853 - val_loss: 3.2137 - val_accuracy50: 0.5781 - 65s/epoch - 41ms/step
Epoch 3/50
1577/1577 - 65s - loss: 2.6803 - accuracy50: 0.5261 - val_loss: 3.1386 - val_accuracy50: 0.6360 - 65s/epoch - 41ms/step
Epoch 4/50
1577/1577 - 64s - loss: 2.6295 - accuracy50: 0.5454 - val_loss: 3.0645 - val_accuracy50: 0.4418 - 64s/epoch - 41ms/step
Epoch 5/50
1577/1577 - 64s - loss: 2.5907 - accuracy50: 0.5597 - val_loss: 2.9778 - val_accuracy50: 0.5891 - 64s/epoch - 41ms/step
Epoch 6/50
1577/1577 - 64s - loss: 2.5548 - accuracy50: 0.5724 - val_loss: 2.9776 - val_accuracy50: 0.6284 - 64s/epoch - 41ms/step
Epoch 7/50
1577/1577 - 64s - loss: 2.5228 - accuracy50: 0.5836 - val_loss: 2.9298 - val_accuracy50: 0.5789 - 64s/epoch - 41ms/step
Epoch 8/50
1577/1577 - 65s - loss: 2.4955 - accuracy50: 0.5927 - val_loss: 2.9832 - val_accuracy50: 0.6212 - 65s/epoch - 41ms/step
Epoch 9/50
1577/1577 - 64s - loss: 2.4660 - accuracy50: 0.6018 - val_loss: 3.0630 - val_accuracy50: 0.6607 - 64s/epoch - 41ms/step
Epoch 10/50
1577/1577 - 64s - loss: 2.4350 - accuracy50: 0.6087 - val_loss: 3.0720 - val_accuracy50: 0.6603 - 64s/epoch - 41ms/step
Epoch 11/50
1577/1577 - 64s - loss: 2.4132 - accuracy50: 0.6126 - val_loss: 2.9725 - val_accuracy50: 0.6367 - 64s/epoch - 41ms/step
Epoch 12/50
1577/1577 - 65s - loss: 2.3937 - accuracy50: 0.6181 - val_loss: 2.9938 - val_accuracy50: 0.6286 - 65s/epoch - 41ms/step
Epoch 13/50
1577/1577 - 64s - loss: 2.3732 - accuracy50: 0.6215 - val_loss: 3.0663 - val_accuracy50: 0.6369 - 64s/epoch - 41ms/step
Epoch 14/50
1577/1577 - 64s - loss: 2.3560 - accuracy50: 0.6241 - val_loss: 3.0196 - val_accuracy50: 0.5826 - 64s/epoch - 41ms/step
Epoch 15/50
1577/1577 - 65s - loss: 2.3409 - accuracy50: 0.6247 - val_loss: 3.1333 - val_accuracy50: 0.6354 - 65s/epoch - 41ms/step
Epoch 16/50
1577/1577 - 64s - loss: 2.3256 - accuracy50: 0.6278 - val_loss: 3.1664 - val_accuracy50: 0.6364 - 64s/epoch - 41ms/step
Epoch 17/50
1577/1577 - 65s - loss: 2.3100 - accuracy50: 0.6284 - val_loss: 3.1540 - val_accuracy50: 0.6001 - 65s/epoch - 41ms/step
testing model: results/AAL/W9/deepLOB_L2/h50
Evaluating performance on  test set...
3870/3870 - 51s - 51s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9793514
{'0': {'precision': 0.31920369275887095, 'recall': 0.48229010653629867, 'f1-score': 0.384154645046132, 'support': 176935}, '1': {'precision': 0.7180281566028416, 'recall': 0.47840697873839466, 'f1-score': 0.5742219881422852, 'support': 647223}, '2': {'precision': 0.27353294561038977, 'recall': 0.479812657619791, 'f1-score': 0.3484312353245122, 'support': 166540}, 'accuracy': 0.47933679082828473, 'macro avg': {'precision': 0.43692159832403404, 'recall': 0.48016991429816147, 'f1-score': 0.4356026228376431, 'support': 990698}, 'weighted avg': {'precision': 0.5720782920135158, 'recall': 0.47933679082828473, 'f1-score': 0.5023204022654693, 'support': 990698}}
[[ 85334  61157  30444]
 [155806 309636 181781]
 [ 26194  60438  79908]]
Evaluating performance on  train set...
1577/1577 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9165408
{'0': {'precision': 0.3033551150403602, 'recall': 0.43677361205547033, 'f1-score': 0.35803909369005027, 'support': 63241}, '1': {'precision': 0.7567581573715503, 'recall': 0.5760294629185359, 'f1-score': 0.6541402220634019, 'support': 278859}, '2': {'precision': 0.2899503957362291, 'recall': 0.4730662758508386, 'f1-score': 0.35953540466451744, 'support': 61410}, 'accuracy': 0.5385343609823796, 'macro avg': {'precision': 0.4500212227160465, 'recall': 0.49528978360828163, 'f1-score': 0.4572382401393232, 'support': 403510}, 'weighted avg': {'precision': 0.614654302592011, 'recall': 0.5385343609823796, 'f1-score': 0.5628973450692144, 'support': 403510}}
[[ 27622  27209   8410]
 [ 55496 160631  62732]
 [  7937  24422  29051]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8888551
{'0': {'precision': 0.29546333063921004, 'recall': 0.3665692985133191, 'f1-score': 0.3271977273611706, 'support': 22937}, '1': {'precision': 0.7467642734370147, 'recall': 0.6719994782106352, 'f1-score': 0.7074119302995081, 'support': 107323}, '2': {'precision': 0.3013197254970966, 'recall': 0.36921086675291076, 'f1-score': 0.3318283112101541, 'support': 23190}, 'accuracy': 0.5805865102639296, 'macro avg': {'precision': 0.4478491098577737, 'recall': 0.469259881158955, 'f1-score': 0.45547932295694427, 'support': 153450}, 'weighted avg': {'precision': 0.6119884585678068, 'recall': 0.5805865102639296, 'f1-score': 0.5938195073638367, 'support': 153450}}
[[ 8408 12371  2158]
 [17507 72121 17695]
 [ 2542 12086  8562]]
training model: results/AAL/W9/deepLOB_L2/h100
Epoch 1/50
1577/1577 - 67s - loss: 3.0743 - accuracy100: 0.4475 - val_loss: 3.6455 - val_accuracy100: 0.2924 - 67s/epoch - 43ms/step
Epoch 2/50
1577/1577 - 65s - loss: 2.9946 - accuracy100: 0.4553 - val_loss: 4.0712 - val_accuracy100: 0.2371 - 65s/epoch - 41ms/step
Epoch 3/50
1577/1577 - 65s - loss: 2.9301 - accuracy100: 0.4850 - val_loss: 3.2803 - val_accuracy100: 0.3921 - 65s/epoch - 41ms/step
Epoch 4/50
1577/1577 - 65s - loss: 2.8849 - accuracy100: 0.5021 - val_loss: 3.2742 - val_accuracy100: 0.3929 - 65s/epoch - 41ms/step
Epoch 5/50
1577/1577 - 64s - loss: 2.8558 - accuracy100: 0.5132 - val_loss: 3.2929 - val_accuracy100: 0.5079 - 64s/epoch - 41ms/step
Epoch 6/50
1577/1577 - 64s - loss: 2.8306 - accuracy100: 0.5246 - val_loss: 3.3644 - val_accuracy100: 0.5288 - 64s/epoch - 41ms/step
Epoch 7/50
1577/1577 - 64s - loss: 2.8081 - accuracy100: 0.5330 - val_loss: 3.3593 - val_accuracy100: 0.5107 - 64s/epoch - 41ms/step
Epoch 8/50
1577/1577 - 65s - loss: 2.7865 - accuracy100: 0.5393 - val_loss: 3.4867 - val_accuracy100: 0.4973 - 65s/epoch - 41ms/step
Epoch 9/50
1577/1577 - 64s - loss: 2.7676 - accuracy100: 0.5444 - val_loss: 3.6053 - val_accuracy100: 0.4357 - 64s/epoch - 41ms/step
Epoch 10/50
1577/1577 - 65s - loss: 2.7528 - accuracy100: 0.5478 - val_loss: 4.1324 - val_accuracy100: 0.2827 - 65s/epoch - 41ms/step
Epoch 11/50
1577/1577 - 64s - loss: 2.7354 - accuracy100: 0.5512 - val_loss: 4.0895 - val_accuracy100: 0.3254 - 64s/epoch - 40ms/step
Epoch 12/50
1577/1577 - 64s - loss: 2.7161 - accuracy100: 0.5553 - val_loss: 4.7585 - val_accuracy100: 0.2769 - 64s/epoch - 41ms/step
Epoch 13/50
1577/1577 - 65s - loss: 2.7001 - accuracy100: 0.5590 - val_loss: 4.8358 - val_accuracy100: 0.2484 - 65s/epoch - 41ms/step
Epoch 14/50
1577/1577 - 65s - loss: 2.6877 - accuracy100: 0.5612 - val_loss: 4.8678 - val_accuracy100: 0.2636 - 65s/epoch - 41ms/step
testing model: results/AAL/W9/deepLOB_L2/h100
Evaluating performance on  test set...
3870/3870 - 51s - 51s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0976863
{'0': {'precision': 0.27963098794173197, 'recall': 0.654911284834603, 'f1-score': 0.3919212537030277, 'support': 240996}, '1': {'precision': 0.5524195759974964, 'recall': 0.32733678851569264, 'f1-score': 0.4110848348798963, 'support': 523079}, '2': {'precision': 0.3176468565435304, 'recall': 0.1630417036223155, 'f1-score': 0.21548124475132965, 'support': 226623}, 'accuracy': 0.369439526475273, 'macro avg': {'precision': 0.38323247349425293, 'recall': 0.3817632589908704, 'f1-score': 0.33949577777808454, 'support': 990698}, 'weighted avg': {'precision': 0.4323568963838269, 'recall': 0.369439526475273, 'f1-score': 0.3616786396367376, 'support': 990698}}
[[157831  62222  20943]
 [293427 171223  58429]
 [113168  76506  36949]]
Evaluating performance on  train set...
1577/1577 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0568174
{'0': {'precision': 0.2816147184463862, 'recall': 0.57338038364097, 'f1-score': 0.3777152755788179, 'support': 88416}, '1': {'precision': 0.6020979986197378, 'recall': 0.3824327463847209, 'f1-score': 0.46775987925871715, 'support': 228129}, '2': {'precision': 0.293583234721533, 'recall': 0.2653136319208877, 'f1-score': 0.278733479910121, 'support': 86965}, 'accuracy': 0.39903100294912147, 'macro avg': {'precision': 0.392431983929219, 'recall': 0.4070422539821929, 'f1-score': 0.37473621158255205, 'support': 403510}, 'weighted avg': {'precision': 0.4653830816605189, 'recall': 0.39903100294912147, 'f1-score': 0.40729033823541505, 'support': 403510}}
[[50696 25695 12025]
 [97392 87244 43493]
 [31931 31961 23073]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0648487
{'0': {'precision': 0.2531404038797901, 'recall': 0.6382532535619565, 'f1-score': 0.36250580208962807, 'support': 32426}, '1': {'precision': 0.6044701929998971, 'recall': 0.39987300579411067, 'f1-score': 0.4813321049578599, 'support': 88193}, '2': {'precision': 0.365365890195491, 'recall': 0.1485790868386586, 'f1-score': 0.211251136806548, 'support': 32831}, 'accuracy': 0.3964809384164223, 'macro avg': {'precision': 0.4076588290250594, 'recall': 0.3955684487315752, 'f1-score': 0.3516963479513453, 'support': 153450}, 'weighted avg': {'precision': 0.47907264912645275, 'recall': 0.3964809384164223, 'f1-score': 0.3984380680586679, 'support': 153450}}
[[20696  9796  1934]
 [46388 35266  6539]
 [14673 13280  4878]]
training model: results/AAL/W9/deepLOB_L2/h200
Epoch 1/50
1577/1577 - 67s - loss: 3.2009 - accuracy200: 0.4271 - val_loss: 3.4206 - val_accuracy200: 0.3294 - 67s/epoch - 43ms/step
Epoch 2/50
1577/1577 - 65s - loss: 3.1281 - accuracy200: 0.4432 - val_loss: 3.5928 - val_accuracy200: 0.4186 - 65s/epoch - 41ms/step
Epoch 3/50
1577/1577 - 65s - loss: 3.0859 - accuracy200: 0.4631 - val_loss: 3.8061 - val_accuracy200: 0.3717 - 65s/epoch - 41ms/step
Epoch 4/50
1577/1577 - 65s - loss: 3.0641 - accuracy200: 0.4714 - val_loss: 3.6602 - val_accuracy200: 0.3944 - 65s/epoch - 41ms/step
Epoch 5/50
1577/1577 - 65s - loss: 3.0432 - accuracy200: 0.4793 - val_loss: 3.7409 - val_accuracy200: 0.3905 - 65s/epoch - 41ms/step
Epoch 6/50
1577/1577 - 64s - loss: 3.0247 - accuracy200: 0.4838 - val_loss: 3.5945 - val_accuracy200: 0.4312 - 64s/epoch - 41ms/step
Epoch 7/50
1577/1577 - 64s - loss: 3.0092 - accuracy200: 0.4897 - val_loss: 3.6759 - val_accuracy200: 0.3964 - 64s/epoch - 41ms/step
Epoch 8/50
1577/1577 - 64s - loss: 2.9972 - accuracy200: 0.4918 - val_loss: 3.5437 - val_accuracy200: 0.4272 - 64s/epoch - 41ms/step
Epoch 9/50
1577/1577 - 65s - loss: 2.9811 - accuracy200: 0.4972 - val_loss: 3.6161 - val_accuracy200: 0.3931 - 65s/epoch - 41ms/step
Epoch 10/50
1577/1577 - 64s - loss: 2.9646 - accuracy200: 0.5014 - val_loss: 3.8068 - val_accuracy200: 0.4293 - 64s/epoch - 41ms/step
Epoch 11/50
1577/1577 - 64s - loss: 2.9501 - accuracy200: 0.5034 - val_loss: 3.5059 - val_accuracy200: 0.3891 - 64s/epoch - 40ms/step
testing model: results/AAL/W9/deepLOB_L2/h200
Evaluating performance on  test set...
3870/3870 - 51s - 51s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1190716
{'0': {'precision': 0.33225716743866723, 'recall': 0.494634158963445, 'f1-score': 0.39750264473249863, 'support': 309178}, '1': {'precision': 0.4025125834738023, 'recall': 0.35047982387280385, 'f1-score': 0.3746984378224921, 'support': 391081}, '2': {'precision': 0.3159413573745629, 'recall': 0.20657005429711575, 'f1-score': 0.24980898747748964, 'support': 290439}, 'accuracy': 0.3532781937583401, 'macro avg': {'precision': 0.35023703609567747, 'recall': 0.3505613457111216, 'f1-score': 0.34067002334416013, 'support': 990698}, 'weighted avg': {'precision': 0.3552074618767586, 'recall': 0.3532781937583401, 'f1-score': 0.34520185260204134, 'support': 990698}}
[[152930 101984  54264]
 [178379 137066  75636]
 [128967 101476  59996]]
Evaluating performance on  train set...
1577/1577 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1112653
{'0': {'precision': 0.3028014662054659, 'recall': 0.5639104973341491, 'f1-score': 0.39402461852282755, 'support': 114410}, '1': {'precision': 0.4341509972794637, 'recall': 0.3282572008159694, 'f1-score': 0.3738501014402246, 'support': 175987}, '2': {'precision': 0.33721963716212683, 'recall': 0.17106787018291444, 'f1-score': 0.2269874599692658, 'support': 113113}, 'accuracy': 0.35100988823077495, 'macro avg': {'precision': 0.3580573668823521, 'recall': 0.354411856111011, 'f1-score': 0.331620726644106, 'support': 403510}, 'weighted avg': {'precision': 0.3697364925902902, 'recall': 0.35100988823077495, 'f1-score': 0.3384013951744964, 'support': 403510}}
[[64517 35014 14879]
 [95066 57769 23152]
 [53484 40279 19350]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1242062
{'0': {'precision': 0.27536957876925816, 'recall': 0.5866992386689752, 'f1-score': 0.3748172279253002, 'support': 42163}, '1': {'precision': 0.42824430748159564, 'recall': 0.29457398575045635, 'f1-score': 0.3490493633350777, 'support': 67932}, '2': {'precision': 0.33380698638247486, 'recall': 0.1300426709722062, 'f1-score': 0.1871690596730019, 'support': 43355}, 'accuracy': 0.3283545128706419, 'macro avg': {'precision': 0.3458069575444429, 'recall': 0.3371052984638792, 'f1-score': 0.3036785503111266, 'support': 153450}, 'weighted avg': {'precision': 0.3595575219296199, 'recall': 0.3283545128706419, 'f1-score': 0.310392666752792, 'support': 153450}}
[[24737 12578  4848]
 [41517 20011  6404]
 [23578 14139  5638]]
training model: results/AAL/W9/deepLOB_L2/h300
Epoch 1/50
1577/1577 - 67s - loss: 3.2277 - accuracy300: 0.4185 - val_loss: 3.7462 - val_accuracy300: 0.3144 - 67s/epoch - 42ms/step
Epoch 2/50
1577/1577 - 66s - loss: 3.2001 - accuracy300: 0.4271 - val_loss: 3.3494 - val_accuracy300: 0.3585 - 66s/epoch - 42ms/step
Epoch 3/50
1577/1577 - 65s - loss: 3.1533 - accuracy300: 0.4446 - val_loss: 3.4408 - val_accuracy300: 0.3421 - 65s/epoch - 41ms/step
Epoch 4/50
1577/1577 - 65s - loss: 3.1254 - accuracy300: 0.4550 - val_loss: 3.3563 - val_accuracy300: 0.3659 - 65s/epoch - 41ms/step
Epoch 5/50
1577/1577 - 65s - loss: 3.1079 - accuracy300: 0.4619 - val_loss: 3.3489 - val_accuracy300: 0.3667 - 65s/epoch - 41ms/step
Epoch 6/50
1577/1577 - 65s - loss: 3.0973 - accuracy300: 0.4644 - val_loss: 3.3903 - val_accuracy300: 0.3695 - 65s/epoch - 41ms/step
Epoch 7/50
1577/1577 - 66s - loss: 3.0811 - accuracy300: 0.4709 - val_loss: 3.3735 - val_accuracy300: 0.3665 - 66s/epoch - 42ms/step
Epoch 8/50
1577/1577 - 66s - loss: 3.0658 - accuracy300: 0.4750 - val_loss: 3.3926 - val_accuracy300: 0.3525 - 66s/epoch - 42ms/step
Epoch 9/50
1577/1577 - 64s - loss: 3.0475 - accuracy300: 0.4805 - val_loss: 3.3838 - val_accuracy300: 0.3636 - 64s/epoch - 41ms/step
Epoch 10/50
1577/1577 - 65s - loss: 3.0353 - accuracy300: 0.4840 - val_loss: 3.4188 - val_accuracy300: 0.3597 - 65s/epoch - 41ms/step
Epoch 11/50
1577/1577 - 65s - loss: 3.0240 - accuracy300: 0.4867 - val_loss: 3.4254 - val_accuracy300: 0.3492 - 65s/epoch - 41ms/step
Epoch 12/50
1577/1577 - 64s - loss: 3.0021 - accuracy300: 0.4933 - val_loss: 3.4074 - val_accuracy300: 0.3485 - 64s/epoch - 41ms/step
Epoch 13/50
1577/1577 - 64s - loss: 2.9865 - accuracy300: 0.4975 - val_loss: 3.3880 - val_accuracy300: 0.3501 - 64s/epoch - 41ms/step
Epoch 14/50
1577/1577 - 64s - loss: 2.9709 - accuracy300: 0.5017 - val_loss: 3.4251 - val_accuracy300: 0.3526 - 64s/epoch - 41ms/step
Epoch 15/50
1577/1577 - 64s - loss: 2.9511 - accuracy300: 0.5072 - val_loss: 3.4531 - val_accuracy300: 0.3411 - 64s/epoch - 40ms/step
testing model: results/AAL/W9/deepLOB_L2/h300
Evaluating performance on  test set...
3870/3870 - 51s - 51s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1179209
{'0': {'precision': 0.36354784745275376, 'recall': 0.1605273484839741, 'f1-score': 0.22271373440727638, 'support': 346564}, '1': {'precision': 0.32426338879768013, 'recall': 0.8112374957150426, 'f1-score': 0.46332789884736697, 'support': 320890}, '2': {'precision': 0.3338495067676073, 'recall': 0.03601613641707194, 'f1-score': 0.06501803884774766, 'support': 323244}, 'accuracy': 0.33066888193980404, 'macro avg': {'precision': 0.3405535810060137, 'recall': 0.3359269935386962, 'f1-score': 0.25035322403413035, 'support': 990698}, 'weighted avg': {'precision': 0.34113354927686557, 'recall': 0.33066888193980404, 'f1-score': 0.24919656955152455, 'support': 990698}}
[[ 55633 278521  12410]
 [ 49752 260318  10820]
 [ 47643 263959  11642]]
Evaluating performance on  train set...
1577/1577 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1041751
{'0': {'precision': 0.36585365853658536, 'recall': 0.15686031851616944, 'f1-score': 0.21957676254202327, 'support': 129287}, '1': {'precision': 0.3696576886836473, 'recall': 0.830677021322654, 'f1-score': 0.5116342053345055, 'support': 147824}, '2': {'precision': 0.35847750865051903, 'recall': 0.04507947056543169, 'f1-score': 0.08008770573601136, 'support': 126399}, 'accuracy': 0.3686947039726401, 'macro avg': {'precision': 0.36466295195691717, 'recall': 0.344205603468085, 'f1-score': 0.27043289120418007, 'support': 403510}, 'weighted avg': {'precision': 0.36493667750268377, 'recall': 0.3686947039726401, 'f1-score': 0.28287586822003075, 'support': 403510}}
[[ 20280 104338   4669]
 [ 19502 122794   5528]
 [ 15650 105051   5698]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1058272
{'0': {'precision': 0.3307132459970888, 'recall': 0.11940549517542938, 'f1-score': 0.17546027431113306, 'support': 47569}, '1': {'precision': 0.37341290381512043, 'recall': 0.8610394397346112, 'f1-score': 0.5209164034086384, 'support': 56973}, '2': {'precision': 0.315929023047114, 'recall': 0.03167171014966877, 'f1-score': 0.05757187192209772, 'support': 48908}, 'accuracy': 0.36679700228087325, 'macro avg': {'precision': 0.34001839095310776, 'recall': 0.33737221501990317, 'f1-score': 0.2513161832139564, 'support': 153450}, 'weighted avg': {'precision': 0.3418547307076092, 'recall': 0.36679700228087325, 'f1-score': 0.26614770382582337, 'support': 153450}}
[[ 5680 40369  1520]
 [ 6083 49056  1834]
 [ 5412 41947  1549]]
training model: results/AAL/W9/deepLOB_L2/h500
Epoch 1/50
1577/1577 - 66s - loss: 3.2591 - accuracy500: 0.3995 - val_loss: 3.5451 - val_accuracy500: 0.3299 - 66s/epoch - 42ms/step
Epoch 2/50
1577/1577 - 64s - loss: 3.2192 - accuracy500: 0.4197 - val_loss: 3.3399 - val_accuracy500: 0.3367 - 64s/epoch - 41ms/step
Epoch 3/50
1577/1577 - 64s - loss: 3.2075 - accuracy500: 0.4267 - val_loss: 3.3161 - val_accuracy500: 0.3361 - 64s/epoch - 41ms/step
Epoch 4/50
1577/1577 - 64s - loss: 3.1833 - accuracy500: 0.4371 - val_loss: 3.3207 - val_accuracy500: 0.3373 - 64s/epoch - 41ms/step
Epoch 5/50
1577/1577 - 65s - loss: 3.1704 - accuracy500: 0.4396 - val_loss: 3.3222 - val_accuracy500: 0.3358 - 65s/epoch - 41ms/step
Epoch 6/50
1577/1577 - 65s - loss: 3.1593 - accuracy500: 0.4466 - val_loss: 3.3194 - val_accuracy500: 0.3371 - 65s/epoch - 41ms/step
Epoch 7/50
1577/1577 - 64s - loss: 3.1428 - accuracy500: 0.4527 - val_loss: 3.3324 - val_accuracy500: 0.3330 - 64s/epoch - 41ms/step
Epoch 8/50
1577/1577 - 64s - loss: 3.1319 - accuracy500: 0.4549 - val_loss: 3.3351 - val_accuracy500: 0.3356 - 64s/epoch - 41ms/step
Epoch 9/50
1577/1577 - 64s - loss: 3.1172 - accuracy500: 0.4598 - val_loss: 3.3330 - val_accuracy500: 0.3340 - 64s/epoch - 41ms/step
Epoch 10/50
1577/1577 - 65s - loss: 3.1029 - accuracy500: 0.4660 - val_loss: 3.3396 - val_accuracy500: 0.3332 - 65s/epoch - 41ms/step
Epoch 11/50
1577/1577 - 64s - loss: 3.0847 - accuracy500: 0.4719 - val_loss: 3.3261 - val_accuracy500: 0.3364 - 64s/epoch - 41ms/step
Epoch 12/50
1577/1577 - 64s - loss: 3.0668 - accuracy500: 0.4778 - val_loss: 3.3300 - val_accuracy500: 0.3358 - 64s/epoch - 41ms/step
Epoch 13/50
1577/1577 - 64s - loss: 3.0496 - accuracy500: 0.4837 - val_loss: 3.3332 - val_accuracy500: 0.3374 - 64s/epoch - 41ms/step
testing model: results/AAL/W9/deepLOB_L2/h500
Evaluating performance on  test set...
3870/3870 - 51s - 51s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1029935
{'0': {'precision': 0.3461123385761891, 'recall': 0.280707305173204, 'f1-score': 0.3099975018899101, 'support': 338185}, '1': {'precision': 0.3414416346694367, 'recall': 0.7232405595526904, 'f1-score': 0.4638838523890785, 'support': 336769}, '2': {'precision': 0.333441663958401, 'recall': 0.003249467923380967, 'f1-score': 0.006436213423833436, 'support': 315744}, 'accuracy': 0.3427098873723375, 'macro avg': {'precision': 0.340331879068009, 'recall': 0.3357324442164251, 'f1-score': 0.26010585590094065, 'support': 990698}, 'weighted avg': {'precision': 0.3404863680276547, 'recall': 0.3427098873723375, 'f1-score': 0.26556064717315636, 'support': 990698}}
[[ 94931 242292    962]
 [ 92115 243565   1089]
 [ 87232 227486   1026]]
Evaluating performance on  train set...
1577/1577 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1064653
{'0': {'precision': 0.35462727863210375, 'recall': 0.30655252373521563, 'f1-score': 0.3288421299646049, 'support': 137138}, '1': {'precision': 0.3301204463054879, 'recall': 0.6748590942746189, 'f1-score': 0.44336183255363776, 'support': 132358}, '2': {'precision': 0.3720283609064368, 'recall': 0.03993612607638008, 'f1-score': 0.07212938005390836, 'support': 134014}, 'accuracy': 0.33881440360833687, 'macro avg': {'precision': 0.35225869528134285, 'recall': 0.34044924802873816, 'f1-score': 0.28144444752405035, 'support': 403510}, 'weighted avg': {'precision': 0.3523678881010791, 'recall': 0.33881440360833687, 'f1-score': 0.2811468964604715, 'support': 403510}}
[[42040 90418  4680]
 [38681 89323  4354]
 [37826 90836  5352]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1052135
{'0': {'precision': 0.33165877383847436, 'recall': 0.20693579300431242, 'f1-score': 0.25485615933120237, 'support': 50088}, '1': {'precision': 0.3382866629955042, 'recall': 0.7956351124084204, 'f1-score': 0.4747289504036909, 'support': 51731}, '2': {'precision': 0.3440453686200378, 'recall': 0.0035250140419515407, 'f1-score': 0.006978527607361964, 'support': 51631}, 'accuracy': 0.3369566634082763, 'macro avg': {'precision': 0.3379969351513388, 'recall': 0.33536530648489477, 'f1-score': 0.24552121244741842, 'support': 153450}, 'weighted avg': {'precision': 0.3380608566612128, 'recall': 0.3369566634082763, 'f1-score': 0.2455767155478026, 'support': 153450}}
[[10365 39550   173]
 [10398 41159   174]
 [10489 40960   182]]
training model: results/AAL/W9/deepLOB_L2/h1000
Epoch 1/50
1577/1577 - 66s - loss: 3.1779 - accuracy1000: 0.4394 - val_loss: 3.3573 - val_accuracy1000: 0.3320 - 66s/epoch - 42ms/step
Epoch 2/50
1577/1577 - 64s - loss: 3.1438 - accuracy1000: 0.4527 - val_loss: 3.4329 - val_accuracy1000: 0.3322 - 64s/epoch - 41ms/step
Epoch 3/50
1577/1577 - 64s - loss: 3.1153 - accuracy1000: 0.4645 - val_loss: 3.5770 - val_accuracy1000: 0.3300 - 64s/epoch - 41ms/step
Epoch 4/50
1577/1577 - 64s - loss: 3.1007 - accuracy1000: 0.4680 - val_loss: 3.4901 - val_accuracy1000: 0.3287 - 64s/epoch - 41ms/step
Epoch 5/50
1577/1577 - 64s - loss: 3.0811 - accuracy1000: 0.4751 - val_loss: 3.4607 - val_accuracy1000: 0.3288 - 64s/epoch - 41ms/step
Epoch 6/50
1577/1577 - 64s - loss: 3.0711 - accuracy1000: 0.4759 - val_loss: 3.3479 - val_accuracy1000: 0.3390 - 64s/epoch - 41ms/step
Epoch 7/50
1577/1577 - 64s - loss: 3.0622 - accuracy1000: 0.4814 - val_loss: 3.4274 - val_accuracy1000: 0.3281 - 64s/epoch - 40ms/step
Epoch 8/50
1577/1577 - 64s - loss: 3.0499 - accuracy1000: 0.4863 - val_loss: 3.4808 - val_accuracy1000: 0.3251 - 64s/epoch - 41ms/step
Epoch 9/50
1577/1577 - 64s - loss: 3.0354 - accuracy1000: 0.4912 - val_loss: 3.3693 - val_accuracy1000: 0.3356 - 64s/epoch - 41ms/step
Epoch 10/50
1577/1577 - 64s - loss: 3.0233 - accuracy1000: 0.4955 - val_loss: 3.3591 - val_accuracy1000: 0.3378 - 64s/epoch - 41ms/step
Epoch 11/50
1577/1577 - 64s - loss: 3.0058 - accuracy1000: 0.4991 - val_loss: 3.3836 - val_accuracy1000: 0.3373 - 64s/epoch - 41ms/step
Epoch 12/50
1577/1577 - 64s - loss: 2.9939 - accuracy1000: 0.5042 - val_loss: 3.5743 - val_accuracy1000: 0.3339 - 64s/epoch - 41ms/step
Epoch 13/50
1577/1577 - 65s - loss: 2.9917 - accuracy1000: 0.5045 - val_loss: 3.5199 - val_accuracy1000: 0.3416 - 65s/epoch - 41ms/step
Epoch 14/50
1577/1577 - 64s - loss: 2.9737 - accuracy1000: 0.5106 - val_loss: 3.5942 - val_accuracy1000: 0.3341 - 64s/epoch - 41ms/step
Epoch 15/50
1577/1577 - 65s - loss: 2.9642 - accuracy1000: 0.5121 - val_loss: 3.5433 - val_accuracy1000: 0.3279 - 65s/epoch - 41ms/step
Epoch 16/50
1577/1577 - 64s - loss: 2.9430 - accuracy1000: 0.5180 - val_loss: 3.5624 - val_accuracy1000: 0.3295 - 64s/epoch - 41ms/step
testing model: results/AAL/W9/deepLOB_L2/h1000
Evaluating performance on  test set...
3870/3870 - 51s - 51s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098295
{'0': {'precision': 0.31569062952894666, 'recall': 0.4017205318007384, 'f1-score': 0.35354735029163764, 'support': 274915}, '1': {'precision': 0.5182384015900413, 'recall': 0.41598320650747833, 'f1-score': 0.4615146345581685, 'support': 476375}, '2': {'precision': 0.22812542313867343, 'recall': 0.24630338167479784, 'f1-score': 0.23686615397284158, 'support': 239408}, 'accuracy': 0.37102123957048466, 'macro avg': {'precision': 0.35401815141922044, 'recall': 0.3546690399943382, 'f1-score': 0.3506427129408826, 'support': 990698}, 'weighted avg': {'precision': 0.3919246422998632, 'recall': 0.37102123957048466, 'f1-score': 0.3772664889132744, 'support': 990698}}
[[110439  97407  67069]
 [145762 198164 132449]
 [ 93632  86809  58967]]
Evaluating performance on  train set...
1577/1577 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1243355
{'0': {'precision': 0.351499103100709, 'recall': 0.4266048591929978, 'f1-score': 0.38542722477010516, 'support': 135043}, '1': {'precision': 0.38764622261804854, 'recall': 0.3272510392192301, 'f1-score': 0.35489751037832373, 'support': 138325}, '2': {'precision': 0.3338543447467396, 'recall': 0.3151173333743142, 'f1-score': 0.3242153529923314, 'support': 130142}, 'accuracy': 0.35658843646997596, 'macro avg': {'precision': 0.3576665568218324, 'recall': 0.35632441059551406, 'f1-score': 0.3548466960469201, 'support': 403510}, 'weighted avg': {'precision': 0.3581996214658888, 'recall': 0.35658843646997596, 'f1-score': 0.3552191551803894, 'support': 403510}}
[[57610 36447 40986]
 [52216 45267 40842]
 [54072 35060 41010]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1139156
{'0': {'precision': 0.3386188740380721, 'recall': 0.33051333241090314, 'f1-score': 0.3345170099328805, 'support': 50591}, '1': {'precision': 0.33680705432570757, 'recall': 0.43043461129280114, 'f1-score': 0.37790808295712036, 'support': 50758}, '2': {'precision': 0.34000816284883423, 'recall': 0.2558300224563828, 'f1-score': 0.2919728815044413, 'support': 52101}, 'accuracy': 0.3382078853046595, 'macro avg': {'precision': 0.3384780304042046, 'recall': 0.33892598872002905, 'f1-score': 0.3347993247981474, 'support': 153450}, 'weighted avg': {'precision': 0.33849126889873893, 'recall': 0.3382078853046595, 'f1-score': 0.33442481344747327, 'support': 153450}}
[[16721 21158 12712]
 [15749 21848 13161]
 [16910 21862 13329]]
training model: results/AAL/W9/deepOF_L2/h10
Epoch 1/50
1577/1577 - 38s - loss: 2.6370 - accuracy10: 0.5235 - val_loss: 2.4066 - val_accuracy10: 0.7807 - 38s/epoch - 24ms/step
Epoch 2/50
1577/1577 - 35s - loss: 2.2267 - accuracy10: 0.6430 - val_loss: 2.2350 - val_accuracy10: 0.7744 - 35s/epoch - 22ms/step
Epoch 3/50
1577/1577 - 35s - loss: 2.0822 - accuracy10: 0.6739 - val_loss: 2.1906 - val_accuracy10: 0.7915 - 35s/epoch - 22ms/step
Epoch 4/50
1577/1577 - 35s - loss: 2.0271 - accuracy10: 0.6828 - val_loss: 2.1640 - val_accuracy10: 0.7785 - 35s/epoch - 22ms/step
Epoch 5/50
1577/1577 - 35s - loss: 1.9920 - accuracy10: 0.6865 - val_loss: 2.1781 - val_accuracy10: 0.7910 - 35s/epoch - 22ms/step
Epoch 6/50
1577/1577 - 35s - loss: 1.9657 - accuracy10: 0.6899 - val_loss: 2.1192 - val_accuracy10: 0.7729 - 35s/epoch - 22ms/step
Epoch 7/50
1577/1577 - 35s - loss: 1.9489 - accuracy10: 0.6936 - val_loss: 2.1895 - val_accuracy10: 0.7937 - 35s/epoch - 22ms/step
Epoch 8/50
1577/1577 - 35s - loss: 1.9347 - accuracy10: 0.6937 - val_loss: 2.1339 - val_accuracy10: 0.7826 - 35s/epoch - 22ms/step
Epoch 9/50
1577/1577 - 35s - loss: 1.9195 - accuracy10: 0.6944 - val_loss: 2.1446 - val_accuracy10: 0.7955 - 35s/epoch - 22ms/step
Epoch 10/50
1577/1577 - 35s - loss: 1.9070 - accuracy10: 0.6958 - val_loss: 2.1460 - val_accuracy10: 0.7834 - 35s/epoch - 22ms/step
Epoch 11/50
1577/1577 - 35s - loss: 1.8967 - accuracy10: 0.6965 - val_loss: 2.1181 - val_accuracy10: 0.7847 - 35s/epoch - 22ms/step
Epoch 12/50
1577/1577 - 35s - loss: 1.8866 - accuracy10: 0.6983 - val_loss: 2.1189 - val_accuracy10: 0.7852 - 35s/epoch - 22ms/step
Epoch 13/50
1577/1577 - 35s - loss: 1.8738 - accuracy10: 0.6987 - val_loss: 2.1426 - val_accuracy10: 0.7871 - 35s/epoch - 22ms/step
Epoch 14/50
1577/1577 - 35s - loss: 1.8642 - accuracy10: 0.6996 - val_loss: 2.1803 - val_accuracy10: 0.7868 - 35s/epoch - 22ms/step
Epoch 15/50
1577/1577 - 35s - loss: 1.8537 - accuracy10: 0.7003 - val_loss: 2.1561 - val_accuracy10: 0.7892 - 35s/epoch - 22ms/step
Epoch 16/50
1577/1577 - 35s - loss: 1.8474 - accuracy10: 0.7006 - val_loss: 2.1639 - val_accuracy10: 0.7878 - 35s/epoch - 22ms/step
Epoch 17/50
1577/1577 - 35s - loss: 1.8357 - accuracy10: 0.7007 - val_loss: 2.1830 - val_accuracy10: 0.7960 - 35s/epoch - 22ms/step
Epoch 18/50
1577/1577 - 35s - loss: 1.8260 - accuracy10: 0.7007 - val_loss: 2.2389 - val_accuracy10: 0.7797 - 35s/epoch - 22ms/step
Epoch 19/50
1577/1577 - 35s - loss: 1.8224 - accuracy10: 0.7022 - val_loss: 2.2236 - val_accuracy10: 0.7923 - 35s/epoch - 22ms/step
Epoch 20/50
1577/1577 - 35s - loss: 1.8106 - accuracy10: 0.7021 - val_loss: 2.1928 - val_accuracy10: 0.7857 - 35s/epoch - 22ms/step
Epoch 21/50
1577/1577 - 35s - loss: 1.8016 - accuracy10: 0.7018 - val_loss: 2.1982 - val_accuracy10: 0.7855 - 35s/epoch - 22ms/step
testing model: results/AAL/W9/deepOF_L2/h10
Evaluating performance on  test set...
3870/3870 - 29s - 29s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.60023123
{'0': {'precision': 0.3433668433558764, 'recall': 0.5574692860110392, 'f1-score': 0.4249751153741742, 'support': 84245}, '1': {'precision': 0.9326565503933713, 'recall': 0.7962577131519082, 'f1-score': 0.8590766906503966, 'support': 825538}, '2': {'precision': 0.3221562026369087, 'recall': 0.593714080903709, 'f1-score': 0.4176763395283122, 'support': 80911}, 'accuracy': 0.7594100701124666, 'macro avg': {'precision': 0.5327265321287188, 'recall': 0.6491470266888855, 'f1-score': 0.5672427151842944, 'support': 990694}, 'weighted avg': {'precision': 0.8326853130519754, 'recall': 0.7594100701124666, 'f1-score': 0.7861126563282101, 'support': 990694}}
[[ 46964  26145  11136]
 [ 78257 657341  89940]
 [ 11554  21319  48038]]
Evaluating performance on  train set...
1577/1577 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5260728
{'0': {'precision': 0.35655643044619423, 'recall': 0.5778208792704506, 'f1-score': 0.44099048212639425, 'support': 29388}, '1': {'precision': 0.9453886086422718, 'recall': 0.8196691437017839, 'f1-score': 0.8780515768190938, 'support': 345709}, '2': {'precision': 0.3200947479029012, 'recall': 0.6325625593918277, 'f1-score': 0.42508455334547435, 'support': 28413}, 'accuracy': 0.7888800773215038, 'macro avg': {'precision': 0.5406799289971225, 'recall': 0.676684194121354, 'f1-score': 0.5813755374303208, 'support': 403510}, 'weighted avg': {'precision': 0.8584736015346064, 'recall': 0.7888800773215038, 'f1-score': 0.8143245229944427, 'support': 403510}}
[[ 16981   9237   3170]
 [ 27336 283367  35006]
 [  3308   7132  17973]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5299289
{'0': {'precision': 0.34975456857294934, 'recall': 0.5741190175711096, 'f1-score': 0.43469312752664463, 'support': 10301}, '1': {'precision': 0.9512249206152099, 'recall': 0.8093017288869772, 'f1-score': 0.874542822776294, 'support': 132513}, '2': {'precision': 0.30253371990419764, 'recall': 0.6769462203836029, 'f1-score': 0.41817917816175404, 'support': 10636}, 'accuracy': 0.7843401759530791, 'macro avg': {'precision': 0.5345044030307856, 'recall': 0.6867889889472298, 'f1-score': 0.5758050428215643, 'support': 153450}, 'weighted avg': {'precision': 0.8658862063294513, 'recall': 0.7843401759530791, 'f1-score': 0.8133842992514528, 'support': 153450}}
[[  5914   3183   1204]
 [  9875 107243  15395]
 [  1120   2316   7200]]
training model: results/AAL/W9/deepOF_L2/h20
Epoch 1/50
1577/1577 - 38s - loss: 2.6873 - accuracy20: 0.5102 - val_loss: 2.5534 - val_accuracy20: 0.7657 - 38s/epoch - 24ms/step
Epoch 2/50
1577/1577 - 36s - loss: 2.3125 - accuracy20: 0.6141 - val_loss: 2.4442 - val_accuracy20: 0.7633 - 36s/epoch - 23ms/step
Epoch 3/50
1577/1577 - 35s - loss: 2.1711 - accuracy20: 0.6517 - val_loss: 2.2932 - val_accuracy20: 0.7669 - 35s/epoch - 22ms/step
Epoch 4/50
1577/1577 - 36s - loss: 2.1216 - accuracy20: 0.6586 - val_loss: 2.3260 - val_accuracy20: 0.7500 - 36s/epoch - 23ms/step
Epoch 5/50
1577/1577 - 35s - loss: 2.0947 - accuracy20: 0.6623 - val_loss: 2.3220 - val_accuracy20: 0.7475 - 35s/epoch - 22ms/step
Epoch 6/50
1577/1577 - 35s - loss: 2.0735 - accuracy20: 0.6647 - val_loss: 2.3071 - val_accuracy20: 0.7492 - 35s/epoch - 22ms/step
Epoch 7/50
1577/1577 - 35s - loss: 2.0529 - accuracy20: 0.6681 - val_loss: 2.3137 - val_accuracy20: 0.7541 - 35s/epoch - 22ms/step
Epoch 8/50
1577/1577 - 35s - loss: 2.0379 - accuracy20: 0.6673 - val_loss: 2.3281 - val_accuracy20: 0.7466 - 35s/epoch - 22ms/step
Epoch 9/50
1577/1577 - 35s - loss: 2.0241 - accuracy20: 0.6691 - val_loss: 2.3111 - val_accuracy20: 0.7446 - 35s/epoch - 22ms/step
Epoch 10/50
1577/1577 - 35s - loss: 2.0159 - accuracy20: 0.6708 - val_loss: 2.3098 - val_accuracy20: 0.7543 - 35s/epoch - 22ms/step
Epoch 11/50
1577/1577 - 35s - loss: 2.0027 - accuracy20: 0.6720 - val_loss: 2.2649 - val_accuracy20: 0.7487 - 35s/epoch - 22ms/step
Epoch 12/50
1577/1577 - 35s - loss: 1.9895 - accuracy20: 0.6728 - val_loss: 2.3123 - val_accuracy20: 0.7451 - 35s/epoch - 22ms/step
Epoch 13/50
1577/1577 - 35s - loss: 1.9809 - accuracy20: 0.6742 - val_loss: 2.3341 - val_accuracy20: 0.7514 - 35s/epoch - 22ms/step
Epoch 14/50
1577/1577 - 35s - loss: 1.9719 - accuracy20: 0.6736 - val_loss: 2.2913 - val_accuracy20: 0.7525 - 35s/epoch - 22ms/step
Epoch 15/50
1577/1577 - 35s - loss: 1.9599 - accuracy20: 0.6751 - val_loss: 2.2897 - val_accuracy20: 0.7578 - 35s/epoch - 22ms/step
Epoch 16/50
1577/1577 - 35s - loss: 1.9487 - accuracy20: 0.6750 - val_loss: 2.3189 - val_accuracy20: 0.7529 - 35s/epoch - 22ms/step
Epoch 17/50
1577/1577 - 35s - loss: 1.9365 - accuracy20: 0.6762 - val_loss: 2.3207 - val_accuracy20: 0.7627 - 35s/epoch - 22ms/step
Epoch 18/50
1577/1577 - 35s - loss: 1.9281 - accuracy20: 0.6765 - val_loss: 2.3583 - val_accuracy20: 0.7514 - 35s/epoch - 22ms/step
Epoch 19/50
1577/1577 - 35s - loss: 1.9187 - accuracy20: 0.6758 - val_loss: 2.3552 - val_accuracy20: 0.7570 - 35s/epoch - 22ms/step
Epoch 20/50
1577/1577 - 35s - loss: 1.9100 - accuracy20: 0.6760 - val_loss: 2.3297 - val_accuracy20: 0.7564 - 35s/epoch - 22ms/step
Epoch 21/50
1577/1577 - 35s - loss: 1.8999 - accuracy20: 0.6777 - val_loss: 2.3666 - val_accuracy20: 0.7663 - 35s/epoch - 22ms/step
testing model: results/AAL/W9/deepOF_L2/h20
Evaluating performance on  test set...
3870/3870 - 29s - 29s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6573285
{'0': {'precision': 0.42137808546884625, 'recall': 0.5038267848939508, 'f1-score': 0.4589287688104976, 'support': 115371}, '1': {'precision': 0.8902427883139309, 'recall': 0.776931100195796, 'f1-score': 0.8297362545479671, 'support': 765082}, '2': {'precision': 0.3533029268081795, 'recall': 0.5930461443564554, 'f1-score': 0.44280687733034413, 'support': 110241}, 'accuracy': 0.7246647299771675, 'macro avg': {'precision': 0.5549746001969856, 'recall': 0.6246013431487341, 'f1-score': 0.577157300229603, 'support': 990694}, 'weighted avg': {'precision': 0.7758924673225897, 'recall': 0.7246647299771675, 'f1-score': 0.7434978076502715, 'support': 990694}}
[[ 58127  42898  14346]
 [ 65342 594416 105324]
 [ 14476  30387  65378]]
Evaluating performance on  train set...
1577/1577 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5836934
{'0': {'precision': 0.4300538735264298, 'recall': 0.5349803397878181, 'f1-score': 0.47681287194181177, 'support': 40437}, '1': {'precision': 0.910558674339226, 'recall': 0.7996548647705839, 'f1-score': 0.8515108282599835, 'support': 323931}, '2': {'precision': 0.35681652844463846, 'recall': 0.6265392672832252, 'f1-score': 0.45468703648768916, 'support': 39142}, 'accuracy': 0.7563381328839434, 'macro avg': {'precision': 0.5658096921034315, 'recall': 0.6537248239472091, 'f1-score': 0.5943369122298282, 'support': 403510}, 'weighted avg': {'precision': 0.8086906965813687, 'recall': 0.7563381328839434, 'f1-score': 0.7754677608832419, 'support': 403510}}
[[ 21633  14848   3956]
 [ 24648 259033  40250]
 [  4022  10596  24524]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5891764
{'0': {'precision': 0.42559225892559227, 'recall': 0.5297660251972864, 'f1-score': 0.47199950659923523, 'support': 14446}, '1': {'precision': 0.9207436677374421, 'recall': 0.7822107373149467, 'f1-score': 0.8458424736237334, 'support': 124221}, '2': {'precision': 0.33740855797174063, 'recall': 0.683284854224447, 'f1-score': 0.4517441860465116, 'support': 14783}, 'accuracy': 0.7489149560117302, 'macro avg': {'precision': 0.561248161544925, 'recall': 0.6650872055788933, 'f1-score': 0.5898620554231601, 'support': 153450}, 'weighted avg': {'precision': 0.817932327370141, 'recall': 0.7489149560117302, 'f1-score': 0.7726818969740757, 'support': 153450}}
[[ 7653  5038  1755]
 [ 8973 97167 18081]
 [ 1356  3326 10101]]
training model: results/AAL/W9/deepOF_L2/h30
Epoch 1/50
1577/1577 - 37s - loss: 2.7588 - accuracy30: 0.4941 - val_loss: 2.6094 - val_accuracy30: 0.7124 - 37s/epoch - 24ms/step
Epoch 2/50
1577/1577 - 35s - loss: 2.4223 - accuracy30: 0.5819 - val_loss: 2.5314 - val_accuracy30: 0.7299 - 35s/epoch - 22ms/step
Epoch 3/50
1577/1577 - 35s - loss: 2.2892 - accuracy30: 0.6197 - val_loss: 2.4657 - val_accuracy30: 0.7473 - 35s/epoch - 22ms/step
Epoch 4/50
1577/1577 - 35s - loss: 2.2295 - accuracy30: 0.6350 - val_loss: 2.4369 - val_accuracy30: 0.7317 - 35s/epoch - 22ms/step
Epoch 5/50
1577/1577 - 35s - loss: 2.1989 - accuracy30: 0.6417 - val_loss: 2.3850 - val_accuracy30: 0.7357 - 35s/epoch - 22ms/step
Epoch 6/50
1577/1577 - 35s - loss: 2.1764 - accuracy30: 0.6448 - val_loss: 2.4417 - val_accuracy30: 0.7347 - 35s/epoch - 22ms/step
Epoch 7/50
1577/1577 - 35s - loss: 2.1627 - accuracy30: 0.6452 - val_loss: 2.4134 - val_accuracy30: 0.7257 - 35s/epoch - 22ms/step
Epoch 8/50
1577/1577 - 35s - loss: 2.1450 - accuracy30: 0.6481 - val_loss: 2.4273 - val_accuracy30: 0.7305 - 35s/epoch - 22ms/step
Epoch 9/50
1577/1577 - 35s - loss: 2.1354 - accuracy30: 0.6502 - val_loss: 2.4188 - val_accuracy30: 0.7406 - 35s/epoch - 22ms/step
Epoch 10/50
1577/1577 - 35s - loss: 2.1209 - accuracy30: 0.6502 - val_loss: 2.4253 - val_accuracy30: 0.7345 - 35s/epoch - 22ms/step
Epoch 11/50
1577/1577 - 35s - loss: 2.1075 - accuracy30: 0.6515 - val_loss: 2.4336 - val_accuracy30: 0.7364 - 35s/epoch - 22ms/step
Epoch 12/50
1577/1577 - 35s - loss: 2.0958 - accuracy30: 0.6520 - val_loss: 2.4761 - val_accuracy30: 0.7299 - 35s/epoch - 22ms/step
Epoch 13/50
1577/1577 - 35s - loss: 2.0906 - accuracy30: 0.6530 - val_loss: 2.4666 - val_accuracy30: 0.7362 - 35s/epoch - 22ms/step
Epoch 14/50
1577/1577 - 35s - loss: 2.0834 - accuracy30: 0.6531 - val_loss: 2.5279 - val_accuracy30: 0.7317 - 35s/epoch - 22ms/step
Epoch 15/50
1577/1577 - 35s - loss: 2.0647 - accuracy30: 0.6541 - val_loss: 2.4778 - val_accuracy30: 0.7416 - 35s/epoch - 22ms/step
testing model: results/AAL/W9/deepOF_L2/h30
Evaluating performance on  test set...
3870/3870 - 29s - 29s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70169586
{'0': {'precision': 0.4615725851170012, 'recall': 0.48096146068064943, 'f1-score': 0.47106759853993946, 'support': 138456}, '1': {'precision': 0.8457053414787434, 'recall': 0.7884554238514225, 'f1-score': 0.8160775581150539, 'support': 720217}, '2': {'precision': 0.39695930498399634, 'recall': 0.5260678225433832, 'f1-score': 0.45248402995625137, 'support': 132021}, 'accuracy': 0.7105150530839996, 'macro avg': {'precision': 0.568079077193247, 'recall': 0.598494902358485, 'f1-score': 0.5798763955370816, 'support': 990694}, 'weighted avg': {'precision': 0.7322198601909851, 'recall': 0.7105150530839996, 'f1-score': 0.7194072642160444, 'support': 990694}}
[[ 66592  57703  14161]
 [ 61011 567859  91347]
 [ 16669  45900  69452]]
Evaluating performance on  train set...
1577/1577 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.647876
{'0': {'precision': 0.444672058771589, 'recall': 0.5148126188382981, 'f1-score': 0.47717861982053683, 'support': 48911}, '1': {'precision': 0.8715023101228622, 'recall': 0.7964664287946661, 'f1-score': 0.8322965729925208, 'support': 307168}, '2': {'precision': 0.3967020842464822, 'recall': 0.5533722670827096, 'f1-score': 0.4621194781414511, 'support': 47431}, 'accuracy': 0.7337513320611633, 'macro avg': {'precision': 0.5709588177136444, 'recall': 0.6215504382385579, 'f1-score': 0.5905315569848363, 'support': 403510}, 'weighted avg': {'precision': 0.7639536894260153, 'recall': 0.7337513320611633, 'f1-score': 0.7457385100114894, 'support': 403510}}
[[ 25180  19612   4119]
 [ 26722 244649  35797]
 [  4724  16460  26247]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6372739
{'0': {'precision': 0.45302438777062315, 'recall': 0.5072957474592631, 'f1-score': 0.47862652667666594, 'support': 17613}, '1': {'precision': 0.8823880823463591, 'recall': 0.7893491224647332, 'f1-score': 0.8332796045562003, 'support': 117887}, '2': {'precision': 0.38981252210824197, 'recall': 0.6139275766016713, 'f1-score': 0.4768498485504111, 'support': 17950}, 'accuracy': 0.736454871293581, 'macro avg': {'precision': 0.5750749974084081, 'recall': 0.6368574821752225, 'f1-score': 0.5962519932610925, 'support': 153450}, 'weighted avg': {'precision': 0.7754860682776941, 'recall': 0.736454871293581, 'f1-score': 0.7508787001508815, 'support': 153450}}
[[ 8935  6968  1710]
 [ 9293 93054 15540]
 [ 1495  5435 11020]]
training model: results/AAL/W9/deepOF_L2/h50
Epoch 1/50
1577/1577 - 39s - loss: 2.8879 - accuracy50: 0.4652 - val_loss: 2.7241 - val_accuracy50: 0.6567 - 39s/epoch - 25ms/step
Epoch 2/50
1577/1577 - 36s - loss: 2.5877 - accuracy50: 0.5480 - val_loss: 2.6653 - val_accuracy50: 0.6694 - 36s/epoch - 23ms/step
Epoch 3/50
1577/1577 - 35s - loss: 2.4765 - accuracy50: 0.5842 - val_loss: 2.6606 - val_accuracy50: 0.6863 - 35s/epoch - 22ms/step
Epoch 4/50
1577/1577 - 35s - loss: 2.4252 - accuracy50: 0.6007 - val_loss: 2.6553 - val_accuracy50: 0.6806 - 35s/epoch - 22ms/step
Epoch 5/50
1577/1577 - 35s - loss: 2.3987 - accuracy50: 0.6075 - val_loss: 2.6592 - val_accuracy50: 0.6647 - 35s/epoch - 22ms/step
Epoch 6/50
1577/1577 - 36s - loss: 2.3783 - accuracy50: 0.6112 - val_loss: 2.6165 - val_accuracy50: 0.6797 - 36s/epoch - 23ms/step
Epoch 7/50
1577/1577 - 35s - loss: 2.3630 - accuracy50: 0.6132 - val_loss: 2.6335 - val_accuracy50: 0.6871 - 35s/epoch - 22ms/step
Epoch 8/50
1577/1577 - 35s - loss: 2.3458 - accuracy50: 0.6166 - val_loss: 2.6422 - val_accuracy50: 0.6770 - 35s/epoch - 22ms/step
Epoch 9/50
1577/1577 - 35s - loss: 2.3340 - accuracy50: 0.6158 - val_loss: 2.6231 - val_accuracy50: 0.6715 - 35s/epoch - 22ms/step
Epoch 10/50
1577/1577 - 35s - loss: 2.3236 - accuracy50: 0.6184 - val_loss: 2.6579 - val_accuracy50: 0.6673 - 35s/epoch - 22ms/step
Epoch 11/50
1577/1577 - 35s - loss: 2.3114 - accuracy50: 0.6184 - val_loss: 2.6424 - val_accuracy50: 0.6896 - 35s/epoch - 22ms/step
Epoch 12/50
1577/1577 - 35s - loss: 2.3001 - accuracy50: 0.6197 - val_loss: 2.6825 - val_accuracy50: 0.6852 - 35s/epoch - 22ms/step
Epoch 13/50
1577/1577 - 35s - loss: 2.2891 - accuracy50: 0.6216 - val_loss: 2.6684 - val_accuracy50: 0.6888 - 35s/epoch - 22ms/step
Epoch 14/50
1577/1577 - 35s - loss: 2.2781 - accuracy50: 0.6220 - val_loss: 2.6606 - val_accuracy50: 0.6924 - 35s/epoch - 22ms/step
Epoch 15/50
1577/1577 - 35s - loss: 2.2661 - accuracy50: 0.6227 - val_loss: 2.6939 - val_accuracy50: 0.6999 - 35s/epoch - 22ms/step
Epoch 16/50
1577/1577 - 35s - loss: 2.2556 - accuracy50: 0.6242 - val_loss: 2.7322 - val_accuracy50: 0.6740 - 35s/epoch - 22ms/step
testing model: results/AAL/W9/deepOF_L2/h50
Evaluating performance on  test set...
3870/3870 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8200753
{'0': {'precision': 0.505513367662479, 'recall': 0.4277833982354903, 'f1-score': 0.46341149819384064, 'support': 176933}, '1': {'precision': 0.7709299571968702, 'recall': 0.7393981344857475, 'f1-score': 0.7548348935700371, 'support': 647221}, '2': {'precision': 0.3881108719541545, 'recall': 0.5132040350666507, 'f1-score': 0.44197663655309005, 'support': 166540}, 'accuracy': 0.64572108037396, 'macro avg': {'precision': 0.5548513989378345, 'recall': 0.5601285225959628, 'f1-score': 0.5534076761056559, 'support': 990694}, 'weighted avg': {'precision': 0.6591743153009767, 'recall': 0.64572108037396, 'f1-score': 0.650195287659737, 'support': 990694}}
[[ 75689  81340  19904]
 [ 53822 478554 114845]
 [ 20216  60855  85469]]
Evaluating performance on  train set...
1577/1577 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7594945
{'0': {'precision': 0.490433252694084, 'recall': 0.4584921475905044, 'f1-score': 0.4739251266960929, 'support': 63229}, '1': {'precision': 0.8040814932329343, 'recall': 0.7597641751329564, 'f1-score': 0.7812948870896662, 'support': 278851}, '2': {'precision': 0.40165848956337974, 'recall': 0.5290737424711053, 'f1-score': 0.45664467814565807, 'support': 61430}, 'accuracy': 0.6774355034571634, 'macro avg': {'precision': 0.5653910784967994, 'recall': 0.5824433550648553, 'f1-score': 0.5706215639771391, 'support': 403510}, 'weighted avg': {'precision': 0.6936690877994836, 'recall': 0.6774355034571634, 'f1-score': 0.6837063640905939, 'support': 403510}}
[[ 28990  28384   5855]
 [ 24429 211861  42561]
 [  5692  23237  32501]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.75054115
{'0': {'precision': 0.4946387601254858, 'recall': 0.46028495490392574, 'f1-score': 0.47684391080617494, 'support': 22951}, '1': {'precision': 0.8202500512400082, 'recall': 0.7458833834999861, 'f1-score': 0.7813010947391026, 'support': 107309}, '2': {'precision': 0.3974734158143308, 'recall': 0.5915480810694265, 'f1-score': 0.4754692130391834, 'support': 23190}, 'accuracy': 0.6798435972629521, 'macro avg': {'precision': 0.5707874090599416, 'recall': 0.5992388064911128, 'f1-score': 0.5778714061948202, 'support': 153450}, 'weighted avg': {'precision': 0.7076577089924301, 'recall': 0.6798435972629521, 'f1-score': 0.6895458769804468, 'support': 153450}}
[[10564  9930  2457]
 [ 8931 80040 18338]
 [ 1862  7610 13718]]
training model: results/AAL/W9/deepOF_L2/h100
Epoch 1/50
1577/1577 - 38s - loss: 3.0707 - accuracy100: 0.4424 - val_loss: 2.9813 - val_accuracy100: 0.5531 - 38s/epoch - 24ms/step
Epoch 2/50
1577/1577 - 36s - loss: 2.8656 - accuracy100: 0.5007 - val_loss: 2.9594 - val_accuracy100: 0.5320 - 36s/epoch - 23ms/step
Epoch 3/50
1577/1577 - 35s - loss: 2.7835 - accuracy100: 0.5289 - val_loss: 2.9484 - val_accuracy100: 0.5583 - 35s/epoch - 22ms/step
Epoch 4/50
1577/1577 - 35s - loss: 2.7481 - accuracy100: 0.5390 - val_loss: 2.9501 - val_accuracy100: 0.5725 - 35s/epoch - 22ms/step
Epoch 5/50
1577/1577 - 35s - loss: 2.7267 - accuracy100: 0.5451 - val_loss: 2.9326 - val_accuracy100: 0.5782 - 35s/epoch - 22ms/step
Epoch 6/50
1577/1577 - 35s - loss: 2.7102 - accuracy100: 0.5486 - val_loss: 2.9479 - val_accuracy100: 0.5602 - 35s/epoch - 22ms/step
Epoch 7/50
1577/1577 - 35s - loss: 2.6957 - accuracy100: 0.5525 - val_loss: 2.9312 - val_accuracy100: 0.5805 - 35s/epoch - 22ms/step
Epoch 8/50
1577/1577 - 35s - loss: 2.6836 - accuracy100: 0.5553 - val_loss: 2.9709 - val_accuracy100: 0.5751 - 35s/epoch - 22ms/step
Epoch 9/50
1577/1577 - 35s - loss: 2.6737 - accuracy100: 0.5563 - val_loss: 2.9730 - val_accuracy100: 0.5839 - 35s/epoch - 22ms/step
Epoch 10/50
1577/1577 - 35s - loss: 2.6625 - accuracy100: 0.5583 - val_loss: 3.0191 - val_accuracy100: 0.5750 - 35s/epoch - 22ms/step
Epoch 11/50
1577/1577 - 35s - loss: 2.6517 - accuracy100: 0.5591 - val_loss: 3.0248 - val_accuracy100: 0.5698 - 35s/epoch - 22ms/step
Epoch 12/50
1577/1577 - 35s - loss: 2.6422 - accuracy100: 0.5609 - val_loss: 3.0257 - val_accuracy100: 0.5633 - 35s/epoch - 22ms/step
Epoch 13/50
1577/1577 - 35s - loss: 2.6311 - accuracy100: 0.5626 - val_loss: 3.0401 - val_accuracy100: 0.5736 - 35s/epoch - 22ms/step
Epoch 14/50
1577/1577 - 35s - loss: 2.6199 - accuracy100: 0.5639 - val_loss: 3.0392 - val_accuracy100: 0.5586 - 35s/epoch - 22ms/step
Epoch 15/50
1577/1577 - 35s - loss: 2.6081 - accuracy100: 0.5641 - val_loss: 3.0548 - val_accuracy100: 0.5643 - 35s/epoch - 22ms/step
Epoch 16/50
1577/1577 - 35s - loss: 2.5989 - accuracy100: 0.5647 - val_loss: 3.0701 - val_accuracy100: 0.5562 - 35s/epoch - 22ms/step
Epoch 17/50
1577/1577 - 35s - loss: 2.5900 - accuracy100: 0.5666 - val_loss: 3.0915 - val_accuracy100: 0.5464 - 35s/epoch - 22ms/step
testing model: results/AAL/W9/deepOF_L2/h100
Evaluating performance on  test set...
3870/3870 - 29s - 29s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9595874
{'0': {'precision': 0.4845685646432185, 'recall': 0.3835365195814004, 'f1-score': 0.4281733724617305, 'support': 240994}, '1': {'precision': 0.6257184675541121, 'recall': 0.671813763912839, 'f1-score': 0.6479473397929362, 'support': 523078}, '2': {'precision': 0.41031741036775965, 'recall': 0.4315247416402644, 'f1-score': 0.42065395294618646, 'support': 226622}, 'accuracy': 0.5467217930057111, 'macro avg': {'precision': 0.5068681475216967, 'recall': 0.4956250083781679, 'f1-score': 0.4989248884002844, 'support': 990694}, 'weighted avg': {'precision': 0.5421095044597627, 'recall': 0.5467217930057111, 'f1-score': 0.5424920837835118, 'support': 990694}}
[[ 92430 113087  35477]
 [ 66602 351411 105065]
 [ 31715  97114  97793]]
Evaluating performance on  train set...
1577/1577 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.920493
{'0': {'precision': 0.4636715104652713, 'recall': 0.43286115133960895, 'f1-score': 0.4477369144796512, 'support': 88384}, '1': {'precision': 0.6646344656635129, 'recall': 0.6674218951999895, 'f1-score': 0.6660252639772944, 'support': 228187}, '2': {'precision': 0.41941102825104787, 'recall': 0.4431267900481947, 'f1-score': 0.430942872803338, 'support': 86939}, 'accuracy': 0.5677182721617804, 'macro avg': {'precision': 0.5159056681266107, 'recall': 0.5144699455292644, 'f1-score': 0.5149016837534278, 'support': 403510}, 'weighted avg': {'precision': 0.5677808802320646, 'recall': 0.5677182721617804, 'f1-score': 0.567561717873673, 'support': 403510}}
[[ 38258  39267  10859]
 [ 33419 152297  42471]
 [ 10834  37580  38525]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.90396965
{'0': {'precision': 0.4587072144092407, 'recall': 0.43314025141730345, 'f1-score': 0.4455572635215441, 'support': 32456}, '1': {'precision': 0.678667029626605, 'recall': 0.6789596713796155, 'f1-score': 0.6788133189630723, 'support': 88126}, '2': {'precision': 0.441323363838448, 'recall': 0.4651028355847633, 'f1-score': 0.4529011806183063, 'support': 32868}, 'accuracy': 0.5811599869664386, 'macro avg': {'precision': 0.5262325359580978, 'recall': 0.5257342527938941, 'f1-score': 0.5257572543676409, 'support': 153450}, 'weighted avg': {'precision': 0.5813061474511737, 'recall': 0.5811599869664386, 'f1-score': 0.5810887265973115, 'support': 153450}}
[[14058 14431  3967]
 [12907 59834 15385]
 [ 3682 13899 15287]]
training model: results/AAL/W9/deepOF_L2/h200
Epoch 1/50
1577/1577 - 38s - loss: 3.1953 - accuracy200: 0.4213 - val_loss: 3.1695 - val_accuracy200: 0.4652 - 38s/epoch - 24ms/step
Epoch 2/50
1577/1577 - 35s - loss: 3.0924 - accuracy200: 0.4582 - val_loss: 3.1294 - val_accuracy200: 0.4765 - 35s/epoch - 22ms/step
Epoch 3/50
1577/1577 - 36s - loss: 3.0354 - accuracy200: 0.4754 - val_loss: 3.1260 - val_accuracy200: 0.4850 - 36s/epoch - 23ms/step
Epoch 4/50
1577/1577 - 35s - loss: 3.0039 - accuracy200: 0.4819 - val_loss: 3.1360 - val_accuracy200: 0.4785 - 35s/epoch - 22ms/step
Epoch 5/50
1577/1577 - 35s - loss: 2.9877 - accuracy200: 0.4863 - val_loss: 3.1598 - val_accuracy200: 0.4741 - 35s/epoch - 22ms/step
Epoch 6/50
1577/1577 - 35s - loss: 2.9764 - accuracy200: 0.4899 - val_loss: 3.1420 - val_accuracy200: 0.4799 - 35s/epoch - 22ms/step
Epoch 7/50
1577/1577 - 35s - loss: 2.9664 - accuracy200: 0.4917 - val_loss: 3.1508 - val_accuracy200: 0.4762 - 35s/epoch - 22ms/step
Epoch 8/50
1577/1577 - 35s - loss: 2.9583 - accuracy200: 0.4931 - val_loss: 3.1552 - val_accuracy200: 0.4836 - 35s/epoch - 22ms/step
Epoch 9/50
1577/1577 - 35s - loss: 2.9491 - accuracy200: 0.4956 - val_loss: 3.1792 - val_accuracy200: 0.4800 - 35s/epoch - 22ms/step
Epoch 10/50
1577/1577 - 35s - loss: 2.9407 - accuracy200: 0.4970 - val_loss: 3.1893 - val_accuracy200: 0.4794 - 35s/epoch - 22ms/step
Epoch 11/50
1577/1577 - 35s - loss: 2.9349 - accuracy200: 0.4979 - val_loss: 3.2223 - val_accuracy200: 0.4778 - 35s/epoch - 22ms/step
Epoch 12/50
1577/1577 - 35s - loss: 2.9252 - accuracy200: 0.4995 - val_loss: 3.2006 - val_accuracy200: 0.4745 - 35s/epoch - 22ms/step
Epoch 13/50
1577/1577 - 35s - loss: 2.9163 - accuracy200: 0.5011 - val_loss: 3.2414 - val_accuracy200: 0.4645 - 35s/epoch - 22ms/step
testing model: results/AAL/W9/deepOF_L2/h200
Evaluating performance on  test set...
3870/3870 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0408012
{'0': {'precision': 0.5116594810465729, 'recall': 0.22915824371310747, 'f1-score': 0.316544769751098, 'support': 309175}, '1': {'precision': 0.4428244315805405, 'recall': 0.6957663501934382, 'f1-score': 0.5411994255868442, 'support': 391081}, '2': {'precision': 0.41784434462221776, 'recall': 0.34205234852188765, 'f1-score': 0.3761686047172062, 'support': 290438}, 'accuracy': 0.4464506699344096, 'macro avg': {'precision': 0.4574427524164437, 'recall': 0.4223256474761445, 'f1-score': 0.4113042666850495, 'support': 990694}, 'weighted avg': {'precision': 0.4569831020909698, 'recall': 0.4464506699344096, 'f1-score': 0.4227079188554491, 'support': 990694}}
[[ 70850 184546  53779]
 [ 34348 272101  84632]
 [ 33273 157820  99345]]
Evaluating performance on  train set...
1577/1577 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0214685
{'0': {'precision': 0.4887676394270074, 'recall': 0.24038495157511974, 'f1-score': 0.32227104939356654, 'support': 114404}, '1': {'precision': 0.485451743402042, 'recall': 0.7158708695059316, 'f1-score': 0.5785635896941396, 'support': 176008}, '2': {'precision': 0.4241111136451753, 'recall': 0.32884754814408745, 'f1-score': 0.37045300609586046, 'support': 113098}, 'accuracy': 0.47258308344278954, 'macro avg': {'precision': 0.4661101654914082, 'recall': 0.4283677897417129, 'f1-score': 0.4237625483945222, 'support': 403510}, 'weighted avg': {'precision': 0.46919898442357316, 'recall': 0.47258308344278954, 'f1-score': 0.4475686141932972, 'support': 403510}}
[[ 27501  69829  17074]
 [ 16581 125999  33428]
 [ 12184  63722  37192]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0125756
{'0': {'precision': 0.5101849927250052, 'recall': 0.2327146886629216, 'f1-score': 0.3196327706607198, 'support': 42189}, '1': {'precision': 0.4934340797367721, 'recall': 0.7374992637964545, 'f1-score': 0.5912704736609119, 'support': 67916}, '2': {'precision': 0.4398874514481451, 'recall': 0.33182604683354483, 'f1-score': 0.3782909444780516, 'support': 43345}, 'accuracy': 0.4841251221896383, 'macro avg': {'precision': 0.48116884130330745, 'recall': 0.4340133330976403, 'f1-score': 0.42973139626656115, 'support': 153450}, 'weighted avg': {'precision': 0.48291420788854816, 'recall': 0.4841251221896383, 'f1-score': 0.4564270670509009, 'support': 153450}}
[[ 9818 26235  6136]
 [ 5650 50088 12178]
 [ 3776 25186 14383]]
training model: results/AAL/W9/deepOF_L2/h300
Epoch 1/50
1577/1577 - 37s - loss: 3.2299 - accuracy300: 0.4059 - val_loss: 3.2292 - val_accuracy300: 0.4156 - 37s/epoch - 23ms/step
Epoch 2/50
1577/1577 - 35s - loss: 3.1498 - accuracy300: 0.4380 - val_loss: 3.2130 - val_accuracy300: 0.4209 - 35s/epoch - 22ms/step
Epoch 3/50
1577/1577 - 35s - loss: 3.1117 - accuracy300: 0.4510 - val_loss: 3.2054 - val_accuracy300: 0.4255 - 35s/epoch - 22ms/step
Epoch 4/50
1577/1577 - 35s - loss: 3.0896 - accuracy300: 0.4575 - val_loss: 3.1962 - val_accuracy300: 0.4321 - 35s/epoch - 22ms/step
Epoch 5/50
1577/1577 - 35s - loss: 3.0745 - accuracy300: 0.4605 - val_loss: 3.1879 - val_accuracy300: 0.4324 - 35s/epoch - 22ms/step
Epoch 6/50
1577/1577 - 35s - loss: 3.0649 - accuracy300: 0.4637 - val_loss: 3.1793 - val_accuracy300: 0.4357 - 35s/epoch - 22ms/step
Epoch 7/50
1577/1577 - 36s - loss: 3.0562 - accuracy300: 0.4655 - val_loss: 3.1802 - val_accuracy300: 0.4366 - 36s/epoch - 23ms/step
Epoch 8/50
1577/1577 - 36s - loss: 3.0491 - accuracy300: 0.4675 - val_loss: 3.1809 - val_accuracy300: 0.4372 - 36s/epoch - 23ms/step
Epoch 9/50
1577/1577 - 35s - loss: 3.0425 - accuracy300: 0.4703 - val_loss: 3.1803 - val_accuracy300: 0.4369 - 35s/epoch - 22ms/step
Epoch 10/50
1577/1577 - 36s - loss: 3.0347 - accuracy300: 0.4724 - val_loss: 3.1838 - val_accuracy300: 0.4387 - 36s/epoch - 23ms/step
Epoch 11/50
1577/1577 - 37s - loss: 3.0292 - accuracy300: 0.4744 - val_loss: 3.1796 - val_accuracy300: 0.4405 - 37s/epoch - 23ms/step
Epoch 12/50
1577/1577 - 37s - loss: 3.0234 - accuracy300: 0.4763 - val_loss: 3.1844 - val_accuracy300: 0.4395 - 37s/epoch - 23ms/step
Epoch 13/50
1577/1577 - 35s - loss: 3.0172 - accuracy300: 0.4778 - val_loss: 3.1946 - val_accuracy300: 0.4399 - 35s/epoch - 22ms/step
Epoch 14/50
1577/1577 - 35s - loss: 3.0110 - accuracy300: 0.4796 - val_loss: 3.2021 - val_accuracy300: 0.4378 - 35s/epoch - 22ms/step
Epoch 15/50
1577/1577 - 35s - loss: 3.0055 - accuracy300: 0.4812 - val_loss: 3.2070 - val_accuracy300: 0.4360 - 35s/epoch - 22ms/step
Epoch 16/50
1577/1577 - 35s - loss: 3.0229 - accuracy300: 0.4757 - val_loss: 3.1804 - val_accuracy300: 0.4397 - 35s/epoch - 22ms/step
testing model: results/AAL/W9/deepOF_L2/h300
Evaluating performance on  test set...
3870/3870 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0688703
{'0': {'precision': 0.5476177590157132, 'recall': 0.17517839572254235, 'f1-score': 0.265443582854382, 'support': 346561}, '1': {'precision': 0.36397915063716463, 'recall': 0.875680139611705, 'f1-score': 0.5142208281788702, 'support': 320890}, '2': {'precision': 0.4971618839154872, 'recall': 0.16582880371732722, 'f1-score': 0.248702619814829, 'support': 323243}, 'accuracy': 0.3990233109315288, 'macro avg': {'precision': 0.46958626452278834, 'recall': 0.4055624463505249, 'f1-score': 0.34278901028269376, 'support': 990694}, 'weighted avg': {'precision': 0.47167372233272653, 'recall': 0.3990233109315288, 'f1-score': 0.34056136002511356, 'support': 990694}}
[[ 60710 252007  33844]
 [ 19522 280997  20371]
 [ 30630 239010  53603]]
Evaluating performance on  train set...
1577/1577 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0494213
{'0': {'precision': 0.531688904494382, 'recall': 0.18745792873998995, 'f1-score': 0.2771876233460898, 'support': 129245}, '1': {'precision': 0.4062581592945965, 'recall': 0.8732917238627834, 'f1-score': 0.5545417071013284, 'support': 147883}, '2': {'precision': 0.5216088682495693, 'recall': 0.16530835087275086, 'f1-score': 0.251052963619431, 'support': 126382}, 'accuracy': 0.43187281603925554, 'macro avg': {'precision': 0.4865186440128493, 'recall': 0.40868600115850806, 'f1-score': 0.3609274313556164, 'support': 403510}, 'weighted avg': {'precision': 0.4825624639276753, 'recall': 0.43187281603925554, 'f1-score': 0.37064999950133093, 'support': 403510}}
[[ 24228  94466  10551]
 [ 10128 129145   8610]
 [ 11212  94278  20892]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0469626
{'0': {'precision': 0.5364291930871565, 'recall': 0.18134627913330392, 'f1-score': 0.271058128759679, 'support': 47583}, '1': {'precision': 0.4104767481176655, 'recall': 0.8737645922935136, 'f1-score': 0.5585555256306671, 'support': 56965}, '2': {'precision': 0.5232536479354237, 'recall': 0.17232424031736943, 'f1-score': 0.2592643869121787, 'support': 48902}, 'accuracy': 0.4355164548712936, 'macro avg': {'precision': 0.4900531963800819, 'recall': 0.4091450372480623, 'f1-score': 0.3629593471008416, 'support': 153450}, 'weighted avg': {'precision': 0.4854732365104404, 'recall': 0.4355164548712936, 'f1-score': 0.37402685895798055, 'support': 153450}}
[[ 8629 34824  4130]
 [ 3643 49774  3548]
 [ 3814 36661  8427]]
training model: results/AAL/W9/deepOF_L2/h500
Epoch 1/50
1577/1577 - 38s - loss: 3.2808 - accuracy500: 0.3809 - val_loss: 3.3020 - val_accuracy500: 0.3588 - 38s/epoch - 24ms/step
Epoch 2/50
1577/1577 - 36s - loss: 3.2465 - accuracy500: 0.4009 - val_loss: 3.2961 - val_accuracy500: 0.3599 - 36s/epoch - 23ms/step
Epoch 3/50
1577/1577 - 37s - loss: 3.2272 - accuracy500: 0.4109 - val_loss: 3.2940 - val_accuracy500: 0.3602 - 37s/epoch - 23ms/step
Epoch 4/50
1577/1577 - 37s - loss: 3.2181 - accuracy500: 0.4146 - val_loss: 3.2931 - val_accuracy500: 0.3641 - 37s/epoch - 23ms/step
Epoch 5/50
1577/1577 - 37s - loss: 3.2115 - accuracy500: 0.4175 - val_loss: 3.2917 - val_accuracy500: 0.3663 - 37s/epoch - 23ms/step
Epoch 6/50
1577/1577 - 36s - loss: 3.2062 - accuracy500: 0.4194 - val_loss: 3.2908 - val_accuracy500: 0.3678 - 36s/epoch - 23ms/step
Epoch 7/50
1577/1577 - 35s - loss: 3.2012 - accuracy500: 0.4218 - val_loss: 3.2920 - val_accuracy500: 0.3679 - 35s/epoch - 22ms/step
Epoch 8/50
1577/1577 - 35s - loss: 3.1970 - accuracy500: 0.4240 - val_loss: 3.2953 - val_accuracy500: 0.3690 - 35s/epoch - 22ms/step
Epoch 9/50
1577/1577 - 35s - loss: 3.1927 - accuracy500: 0.4257 - val_loss: 3.2991 - val_accuracy500: 0.3691 - 35s/epoch - 22ms/step
Epoch 10/50
1577/1577 - 36s - loss: 3.1888 - accuracy500: 0.4275 - val_loss: 3.2988 - val_accuracy500: 0.3724 - 36s/epoch - 23ms/step
Epoch 11/50
1577/1577 - 36s - loss: 3.1844 - accuracy500: 0.4292 - val_loss: 3.3055 - val_accuracy500: 0.3711 - 36s/epoch - 23ms/step
Epoch 12/50
1577/1577 - 35s - loss: 3.1812 - accuracy500: 0.4301 - val_loss: 3.2998 - val_accuracy500: 0.3728 - 35s/epoch - 22ms/step
Epoch 13/50
1577/1577 - 37s - loss: 3.1773 - accuracy500: 0.4325 - val_loss: 3.2960 - val_accuracy500: 0.3749 - 37s/epoch - 23ms/step
Epoch 14/50
1577/1577 - 37s - loss: 3.1740 - accuracy500: 0.4331 - val_loss: 3.2999 - val_accuracy500: 0.3738 - 37s/epoch - 23ms/step
Epoch 15/50
1577/1577 - 36s - loss: 3.1690 - accuracy500: 0.4351 - val_loss: 3.3099 - val_accuracy500: 0.3743 - 36s/epoch - 23ms/step
Epoch 16/50
1577/1577 - 36s - loss: 3.1646 - accuracy500: 0.4365 - val_loss: 3.3112 - val_accuracy500: 0.3754 - 36s/epoch - 23ms/step
testing model: results/AAL/W9/deepOF_L2/h500
Evaluating performance on  test set...
3870/3870 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1085916
{'0': {'precision': 0.4079815553566824, 'recall': 0.15906772368806238, 'f1-score': 0.22889261909168854, 'support': 338183}, '1': {'precision': 0.33475830410793667, 'recall': 0.7119954627652783, 'f1-score': 0.4554010717531416, 'support': 336769}, '2': {'precision': 0.3706582122215364, 'recall': 0.16736449379556725, 'f1-score': 0.2306037398267548, 'support': 315742}, 'accuracy': 0.3496700292925969, 'macro avg': {'precision': 0.3711326905620518, 'recall': 0.3461425600829693, 'f1-score': 0.30496581022386166, 'support': 990694}, 'weighted avg': {'precision': 0.3711953548669589, 'recall': 0.3496700292925969, 'f1-score': 0.3064355312093315, 'support': 990694}}
[[ 53794 246464  37925]
 [ 45192 239778  51799]
 [ 32868 230030  52844]]
Evaluating performance on  train set...
1577/1577 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0961173
{'0': {'precision': 0.45837983101414287, 'recall': 0.14678062761170627, 'f1-score': 0.22235847805912767, 'support': 137123}, '1': {'precision': 0.3424792716471541, 'recall': 0.7893814136956488, 'f1-score': 0.47770326351145875, 'support': 132334}, '2': {'precision': 0.43785724754506816, 'recall': 0.17828769218145063, 'f1-score': 0.253396735529085, 'support': 134053}, 'accuracy': 0.3679933582810835, 'macro avg': {'precision': 0.41290545006878837, 'recall': 0.37148324449626857, 'f1-score': 0.31781949236655715, 'support': 403510}, 'weighted avg': {'precision': 0.4135514537619039, 'recall': 0.3679933582810835, 'f1-score': 0.31641207863078386, 'support': 403510}}
[[ 20127 102598  14398]
 [ 11586 104462  16286]
 [ 12196  97957  23900]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0981256
{'0': {'precision': 0.4293306339364798, 'recall': 0.13546262102006187, 'f1-score': 0.2059452815587017, 'support': 50095}, '1': {'precision': 0.3461558241193109, 'recall': 0.7808735667742995, 'f1-score': 0.47967503815569906, 'support': 51719}, '2': {'precision': 0.438829026413655, 'recall': 0.1782477341389728, 'f1-score': 0.25351879906348984, 'support': 51636}, 'accuracy': 0.3673900293255132, 'macro avg': {'precision': 0.4047718281564819, 'recall': 0.3648613073111114, 'f1-score': 0.31304637292596355, 'support': 153450}, 'weighted avg': {'precision': 0.404493494835908, 'recall': 0.3673900293255132, 'f1-score': 0.3142120487878796, 'support': 153450}}
[[ 6786 38094  5215]
 [ 4778 40386  6555]
 [ 4242 38190  9204]]
training model: results/AAL/W9/deepOF_L2/h1000
Epoch 1/50
1577/1577 - 39s - loss: 3.2320 - accuracy1000: 0.4109 - val_loss: 3.3298 - val_accuracy1000: 0.3417 - 39s/epoch - 25ms/step
Epoch 2/50
1577/1577 - 36s - loss: 3.2238 - accuracy1000: 0.4067 - val_loss: 3.2985 - val_accuracy1000: 0.3605 - 36s/epoch - 23ms/step
Epoch 3/50
1577/1577 - 36s - loss: 3.2271 - accuracy1000: 0.4049 - val_loss: 3.2940 - val_accuracy1000: 0.3648 - 36s/epoch - 23ms/step
Epoch 4/50
1577/1577 - 36s - loss: 3.2192 - accuracy1000: 0.4063 - val_loss: 3.2893 - val_accuracy1000: 0.3690 - 36s/epoch - 23ms/step
Epoch 5/50
1577/1577 - 37s - loss: 3.2156 - accuracy1000: 0.4069 - val_loss: 3.2894 - val_accuracy1000: 0.3701 - 37s/epoch - 23ms/step
Epoch 6/50
1577/1577 - 37s - loss: 3.2063 - accuracy1000: 0.4097 - val_loss: 3.2883 - val_accuracy1000: 0.3708 - 37s/epoch - 24ms/step
Epoch 7/50
1577/1577 - 38s - loss: 3.2014 - accuracy1000: 0.4122 - val_loss: 3.2866 - val_accuracy1000: 0.3708 - 38s/epoch - 24ms/step
Epoch 8/50
1577/1577 - 37s - loss: 3.1945 - accuracy1000: 0.4148 - val_loss: 3.2862 - val_accuracy1000: 0.3708 - 37s/epoch - 23ms/step
Epoch 9/50
1577/1577 - 37s - loss: 3.2002 - accuracy1000: 0.4146 - val_loss: 3.2856 - val_accuracy1000: 0.3703 - 37s/epoch - 23ms/step
Epoch 10/50
1577/1577 - 37s - loss: 3.1967 - accuracy1000: 0.4146 - val_loss: 3.2856 - val_accuracy1000: 0.3712 - 37s/epoch - 24ms/step
Epoch 11/50
1577/1577 - 38s - loss: 3.1944 - accuracy1000: 0.4169 - val_loss: 3.2874 - val_accuracy1000: 0.3711 - 38s/epoch - 24ms/step
Epoch 12/50
1577/1577 - 37s - loss: 3.1935 - accuracy1000: 0.4186 - val_loss: 3.2885 - val_accuracy1000: 0.3702 - 37s/epoch - 24ms/step
Epoch 13/50
1577/1577 - 37s - loss: 3.1902 - accuracy1000: 0.4203 - val_loss: 3.2906 - val_accuracy1000: 0.3721 - 37s/epoch - 24ms/step
Epoch 14/50
1577/1577 - 37s - loss: 3.1886 - accuracy1000: 0.4217 - val_loss: 3.2877 - val_accuracy1000: 0.3708 - 37s/epoch - 23ms/step
Epoch 15/50
1577/1577 - 37s - loss: 3.1900 - accuracy1000: 0.4192 - val_loss: 3.2922 - val_accuracy1000: 0.3704 - 37s/epoch - 23ms/step
Epoch 16/50
1577/1577 - 37s - loss: 3.1879 - accuracy1000: 0.4205 - val_loss: 3.2954 - val_accuracy1000: 0.3692 - 37s/epoch - 24ms/step
Epoch 17/50
1577/1577 - 37s - loss: 3.1846 - accuracy1000: 0.4229 - val_loss: 3.2991 - val_accuracy1000: 0.3682 - 37s/epoch - 23ms/step
Epoch 18/50
1577/1577 - 37s - loss: 3.1837 - accuracy1000: 0.4226 - val_loss: 3.2994 - val_accuracy1000: 0.3677 - 37s/epoch - 24ms/step
Epoch 19/50
1577/1577 - 37s - loss: 3.1814 - accuracy1000: 0.4240 - val_loss: 3.3052 - val_accuracy1000: 0.3662 - 37s/epoch - 24ms/step
testing model: results/AAL/W9/deepOF_L2/h1000
Evaluating performance on  test set...
3870/3870 - 31s - 31s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1310551
{'0': {'precision': 0.30462959836577586, 'recall': 0.5250842081523677, 'f1-score': 0.3855695546610611, 'support': 274914}, '1': {'precision': 0.41266779325957337, 'recall': 0.05433755830502924, 'f1-score': 0.0960304210721573, 'support': 476374}, '2': {'precision': 0.2594405686803023, 'recall': 0.49210546101601466, 'f1-score': 0.33975861919799283, 'support': 239406}, 'accuracy': 0.2907567826190529, 'macro avg': {'precision': 0.32557932010188384, 'recall': 0.3571757424911372, 'f1-score': 0.27378619831040374, 'support': 990694}, 'weighted avg': {'precision': 0.34565948470147323, 'recall': 0.2907567826190529, 'f1-score': 0.2352745816020219, 'support': 990694}}
[[144353  20049 110512]
 [224710  25885 225779]
 [104801  16792 117813]]
Evaluating performance on  train set...
1577/1577 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001937
{'0': {'precision': 0.3679427696825176, 'recall': 0.5680644755068631, 'f1-score': 0.4466102533938233, 'support': 134997}, '1': {'precision': 0.38510618904384286, 'recall': 0.06104565058769984, 'f1-score': 0.10538590572638326, 'support': 138421}, '2': {'precision': 0.35172425742288344, 'recall': 0.46813024628724287, 'f1-score': 0.4016633744340272, 'support': 130092}, 'accuracy': 0.3619166811231444, 'macro avg': {'precision': 0.3682577387164146, 'recall': 0.3657467907939353, 'f1-score': 0.3178865111847446, 'support': 403510}, 'weighted avg': {'precision': 0.3686016851357497, 'recall': 0.3619166811231444, 'f1-score': 0.31506495140350704, 'support': 403510}}
[[76687  6779 51531]
 [69255  8450 60716]
 [62479  6713 60900]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0954742
{'0': {'precision': 0.3667691601066612, 'recall': 0.5682123655913979, 'f1-score': 0.4457901388684278, 'support': 50592}, '1': {'precision': 0.3974340899478359, 'recall': 0.055533666916197155, 'f1-score': 0.09745052285887132, 'support': 50762}, '2': {'precision': 0.3712965959575157, 'recall': 0.48449017199017197, 'f1-score': 0.4204074154271533, 'support': 52096}, 'accuracy': 0.3701922450309547, 'macro avg': {'precision': 0.3784999486706709, 'recall': 0.3694120681659223, 'f1-score': 0.32121602571815083, 'support': 153450}, 'weighted avg': {'precision': 0.3784503231349038, 'recall': 0.3701922450309547, 'f1-score': 0.32194032493376673, 'support': 153450}}
[[28747  2073 19772]
 [24977  2819 22966]
 [24655  2201 25240]]
training model: results/AAL/W9/deepVOL_L2/h10
Epoch 1/50
1577/1577 - 39s - loss: 2.4737 - accuracy10: 0.5738 - val_loss: 2.1187 - val_accuracy10: 0.7314 - 39s/epoch - 24ms/step
Epoch 2/50
1577/1577 - 38s - loss: 2.2155 - accuracy10: 0.6433 - val_loss: 2.1079 - val_accuracy10: 0.7009 - 38s/epoch - 24ms/step
Epoch 3/50
1577/1577 - 36s - loss: 2.1448 - accuracy10: 0.6670 - val_loss: 2.0249 - val_accuracy10: 0.7027 - 36s/epoch - 23ms/step
Epoch 4/50
1577/1577 - 37s - loss: 2.1018 - accuracy10: 0.6793 - val_loss: 1.9935 - val_accuracy10: 0.6881 - 37s/epoch - 23ms/step
Epoch 5/50
1577/1577 - 37s - loss: 2.0702 - accuracy10: 0.6836 - val_loss: 1.9808 - val_accuracy10: 0.7228 - 37s/epoch - 24ms/step
Epoch 6/50
1577/1577 - 37s - loss: 2.0443 - accuracy10: 0.6909 - val_loss: 1.9799 - val_accuracy10: 0.7356 - 37s/epoch - 24ms/step
Epoch 7/50
1577/1577 - 39s - loss: 2.0306 - accuracy10: 0.6942 - val_loss: 1.9676 - val_accuracy10: 0.7480 - 39s/epoch - 25ms/step
Epoch 8/50
1577/1577 - 36s - loss: 2.0089 - accuracy10: 0.6993 - val_loss: 1.9777 - val_accuracy10: 0.7602 - 36s/epoch - 23ms/step
Epoch 9/50
1577/1577 - 38s - loss: 1.9969 - accuracy10: 0.7001 - val_loss: 1.9820 - val_accuracy10: 0.7726 - 38s/epoch - 24ms/step
Epoch 10/50
1577/1577 - 40s - loss: 1.9936 - accuracy10: 0.6992 - val_loss: 1.9901 - val_accuracy10: 0.7659 - 40s/epoch - 25ms/step
Epoch 11/50
1577/1577 - 38s - loss: 1.9748 - accuracy10: 0.7027 - val_loss: 1.9837 - val_accuracy10: 0.7822 - 38s/epoch - 24ms/step
Epoch 12/50
1577/1577 - 36s - loss: 1.9686 - accuracy10: 0.7051 - val_loss: 2.0067 - val_accuracy10: 0.7997 - 36s/epoch - 23ms/step
Epoch 13/50
1577/1577 - 38s - loss: 1.9553 - accuracy10: 0.7057 - val_loss: 1.9883 - val_accuracy10: 0.7923 - 38s/epoch - 24ms/step
Epoch 14/50
1577/1577 - 39s - loss: 1.9453 - accuracy10: 0.7073 - val_loss: 1.9956 - val_accuracy10: 0.7876 - 39s/epoch - 25ms/step
Epoch 15/50
1577/1577 - 39s - loss: 1.9305 - accuracy10: 0.7075 - val_loss: 1.9894 - val_accuracy10: 0.7844 - 39s/epoch - 25ms/step
Epoch 16/50
1577/1577 - 38s - loss: 1.9215 - accuracy10: 0.7090 - val_loss: 1.9598 - val_accuracy10: 0.7801 - 38s/epoch - 24ms/step
Epoch 17/50
1577/1577 - 39s - loss: 1.9118 - accuracy10: 0.7101 - val_loss: 1.9845 - val_accuracy10: 0.7925 - 39s/epoch - 25ms/step
Epoch 18/50
1577/1577 - 40s - loss: 1.9028 - accuracy10: 0.7105 - val_loss: 1.9544 - val_accuracy10: 0.7757 - 40s/epoch - 25ms/step
Epoch 19/50
1577/1577 - 38s - loss: 1.8945 - accuracy10: 0.7104 - val_loss: 1.9832 - val_accuracy10: 0.7835 - 38s/epoch - 24ms/step
Epoch 20/50
1577/1577 - 41s - loss: 1.8876 - accuracy10: 0.7114 - val_loss: 1.9638 - val_accuracy10: 0.7897 - 41s/epoch - 26ms/step
Epoch 21/50
1577/1577 - 38s - loss: 1.8772 - accuracy10: 0.7121 - val_loss: 1.9828 - val_accuracy10: 0.7847 - 38s/epoch - 24ms/step
Epoch 22/50
1577/1577 - 39s - loss: 1.8710 - accuracy10: 0.7116 - val_loss: 1.9893 - val_accuracy10: 0.7911 - 39s/epoch - 25ms/step
Epoch 23/50
1577/1577 - 40s - loss: 1.8622 - accuracy10: 0.7131 - val_loss: 1.9693 - val_accuracy10: 0.7715 - 40s/epoch - 26ms/step
Epoch 24/50
1577/1577 - 35s - loss: 1.8564 - accuracy10: 0.7122 - val_loss: 1.9623 - val_accuracy10: 0.7675 - 35s/epoch - 22ms/step
Epoch 25/50
1577/1577 - 39s - loss: 1.8475 - accuracy10: 0.7129 - val_loss: 1.9731 - val_accuracy10: 0.7688 - 39s/epoch - 25ms/step
Epoch 26/50
1577/1577 - 39s - loss: 1.8428 - accuracy10: 0.7129 - val_loss: 1.9858 - val_accuracy10: 0.7746 - 39s/epoch - 25ms/step
Epoch 27/50
1577/1577 - 37s - loss: 1.8375 - accuracy10: 0.7130 - val_loss: 1.9780 - val_accuracy10: 0.7765 - 37s/epoch - 24ms/step
Epoch 28/50
1577/1577 - 37s - loss: 1.8298 - accuracy10: 0.7135 - val_loss: 1.9709 - val_accuracy10: 0.7786 - 37s/epoch - 23ms/step
testing model: results/AAL/W9/deepVOL_L2/h10
Evaluating performance on  test set...
3870/3870 - 36s - 36s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.65458673
{'0': {'precision': 0.349002868554331, 'recall': 0.603653542559379, 'f1-score': 0.4422933924727676, 'support': 84247}, '1': {'precision': 0.9401490132357396, 'recall': 0.7555345591976161, 'f1-score': 0.8377920053513467, 'support': 825540}, '2': {'precision': 0.27889991131870734, 'recall': 0.6257987171089221, 'f1-score': 0.3858416520612664, 'support': 80911}, 'accuracy': 0.7320232805557294, 'macro avg': {'precision': 0.5226839310362593, 'recall': 0.6616622729553058, 'f1-score': 0.5553090166284602, 'support': 990698}, 'weighted avg': {'precision': 0.8358744357800633, 'recall': 0.7320232805557294, 'f1-score': 0.7672484828306235, 'support': 990698}}
[[ 50856  22797  10594]
 [ 81495 623724 120321]
 [ 13367  16910  50634]]
Evaluating performance on  train set...
1577/1577 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.561793
{'0': {'precision': 0.33416663690582477, 'recall': 0.6372241895941161, 'f1-score': 0.4384209909804381, 'support': 29368}, '1': {'precision': 0.9513159576047879, 'recall': 0.7968019623270236, 'f1-score': 0.8672303088593408, 'support': 345712}, '2': {'precision': 0.3115778211123958, 'recall': 0.6350685895181146, 'f1-score': 0.4180511015663892, 'support': 28430}, 'accuracy': 0.7737924710663924, 'macro avg': {'precision': 0.5323534718743362, 'recall': 0.689698247146418, 'f1-score': 0.5745674671353894, 'support': 403510}, 'weighted avg': {'precision': 0.8613251358884344, 'recall': 0.7737924710663924, 'f1-score': 0.8043732869495834, 'support': 403510}}
[[ 18714   7534   3120]
 [ 33476 275464  36772]
 [  3812   6563  18055]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5584199
{'0': {'precision': 0.3244642252430942, 'recall': 0.6499031007751938, 'f1-score': 0.4328353392920526, 'support': 10320}, '1': {'precision': 0.9565494045995818, 'recall': 0.7941527176127874, 'f1-score': 0.867819030496957, 'support': 132506}, '2': {'precision': 0.3097632746277834, 'recall': 0.6638742469879518, 'f1-score': 0.42242386128829396, 'support': 10624}, 'accuracy': 0.7754317367220593, 'macro avg': {'precision': 0.5302589681568198, 'recall': 0.702643355125311, 'f1-score': 0.5743594103591012, 'support': 153450}, 'weighted avg': {'precision': 0.8692598972957086, 'recall': 0.7754317367220593, 'f1-score': 0.8077283822668659, 'support': 153450}}
[[  6707   2512   1101]
 [ 12661 105230  14615]
 [  1303   2268   7053]]
training model: results/AAL/W9/deepVOL_L2/h20
Epoch 1/50
1577/1577 - 38s - loss: 2.5658 - accuracy20: 0.5599 - val_loss: 2.2644 - val_accuracy20: 0.6943 - 38s/epoch - 24ms/step
Epoch 2/50
1577/1577 - 38s - loss: 2.3368 - accuracy20: 0.6279 - val_loss: 2.2495 - val_accuracy20: 0.6765 - 38s/epoch - 24ms/step
Epoch 3/50
1577/1577 - 39s - loss: 2.2737 - accuracy20: 0.6462 - val_loss: 2.1640 - val_accuracy20: 0.6999 - 39s/epoch - 25ms/step
Epoch 4/50
1577/1577 - 37s - loss: 2.2170 - accuracy20: 0.6553 - val_loss: 2.1534 - val_accuracy20: 0.7144 - 37s/epoch - 23ms/step
Epoch 5/50
1577/1577 - 38s - loss: 2.1868 - accuracy20: 0.6584 - val_loss: 2.1410 - val_accuracy20: 0.6993 - 38s/epoch - 24ms/step
Epoch 6/50
1577/1577 - 36s - loss: 2.1679 - accuracy20: 0.6637 - val_loss: 2.1255 - val_accuracy20: 0.7049 - 36s/epoch - 23ms/step
Epoch 7/50
1577/1577 - 37s - loss: 2.1521 - accuracy20: 0.6654 - val_loss: 2.1215 - val_accuracy20: 0.6974 - 37s/epoch - 23ms/step
Epoch 8/50
1577/1577 - 39s - loss: 2.1309 - accuracy20: 0.6707 - val_loss: 2.1113 - val_accuracy20: 0.7028 - 39s/epoch - 25ms/step
Epoch 9/50
1577/1577 - 36s - loss: 2.1187 - accuracy20: 0.6701 - val_loss: 2.0986 - val_accuracy20: 0.7194 - 36s/epoch - 23ms/step
Epoch 10/50
1577/1577 - 39s - loss: 2.1037 - accuracy20: 0.6747 - val_loss: 2.0797 - val_accuracy20: 0.7021 - 39s/epoch - 24ms/step
Epoch 11/50
1577/1577 - 36s - loss: 2.0898 - accuracy20: 0.6766 - val_loss: 2.0716 - val_accuracy20: 0.6964 - 36s/epoch - 23ms/step
Epoch 12/50
1577/1577 - 35s - loss: 2.0792 - accuracy20: 0.6783 - val_loss: 2.0603 - val_accuracy20: 0.7104 - 35s/epoch - 22ms/step
Epoch 13/50
1577/1577 - 38s - loss: 2.0672 - accuracy20: 0.6787 - val_loss: 2.0619 - val_accuracy20: 0.7157 - 38s/epoch - 24ms/step
Epoch 14/50
1577/1577 - 39s - loss: 2.0537 - accuracy20: 0.6799 - val_loss: 2.0567 - val_accuracy20: 0.7062 - 39s/epoch - 24ms/step
Epoch 15/50
1577/1577 - 38s - loss: 2.0435 - accuracy20: 0.6822 - val_loss: 2.0630 - val_accuracy20: 0.7024 - 38s/epoch - 24ms/step
Epoch 16/50
1577/1577 - 35s - loss: 2.0353 - accuracy20: 0.6829 - val_loss: 2.0620 - val_accuracy20: 0.7131 - 35s/epoch - 22ms/step
Epoch 17/50
1577/1577 - 39s - loss: 2.0259 - accuracy20: 0.6836 - val_loss: 2.0607 - val_accuracy20: 0.7273 - 39s/epoch - 25ms/step
Epoch 18/50
1577/1577 - 39s - loss: 2.0175 - accuracy20: 0.6840 - val_loss: 2.0899 - val_accuracy20: 0.7045 - 39s/epoch - 25ms/step
Epoch 19/50
1577/1577 - 38s - loss: 2.0089 - accuracy20: 0.6843 - val_loss: 2.0789 - val_accuracy20: 0.7324 - 38s/epoch - 24ms/step
Epoch 20/50
1577/1577 - 36s - loss: 2.0017 - accuracy20: 0.6848 - val_loss: 2.0876 - val_accuracy20: 0.7349 - 36s/epoch - 23ms/step
Epoch 21/50
1577/1577 - 34s - loss: 1.9932 - accuracy20: 0.6867 - val_loss: 2.1037 - val_accuracy20: 0.7313 - 34s/epoch - 22ms/step
Epoch 22/50
1577/1577 - 39s - loss: 1.9852 - accuracy20: 0.6862 - val_loss: 2.1053 - val_accuracy20: 0.7343 - 39s/epoch - 25ms/step
Epoch 23/50
1577/1577 - 39s - loss: 1.9776 - accuracy20: 0.6863 - val_loss: 2.1082 - val_accuracy20: 0.7407 - 39s/epoch - 25ms/step
Epoch 24/50
1577/1577 - 38s - loss: 1.9705 - accuracy20: 0.6860 - val_loss: 2.1177 - val_accuracy20: 0.7375 - 38s/epoch - 24ms/step
testing model: results/AAL/W9/deepVOL_L2/h20
Evaluating performance on  test set...
3870/3870 - 40s - 40s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7851061
{'0': {'precision': 0.359658857994141, 'recall': 0.623577440128973, 'f1-score': 0.45619786498080256, 'support': 115373}, '1': {'precision': 0.9152042889014684, 'recall': 0.6466231158931568, 'f1-score': 0.7578202907075599, 'support': 765084}, '2': {'precision': 0.2957186153071098, 'recall': 0.6709028401411453, 'f1-score': 0.4104987692418697, 'support': 110241}, 'accuracy': 0.6466410550944889, 'macro avg': {'precision': 0.5235272540675731, 'recall': 0.6470344653877583, 'f1-score': 0.5415056416434108, 'support': 990698}, 'weighted avg': {'precision': 0.7815735930256448, 'recall': 0.6466410550944889, 'f1-score': 0.6840458852164089, 'support': 990698}}
[[ 71944  25280  18149]
 [112367 494721 157996]
 [ 15723  20557  73961]]
Evaluating performance on  train set...
1577/1577 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.67481315
{'0': {'precision': 0.33799833671188734, 'recall': 0.6430089983189954, 'f1-score': 0.4430873535023167, 'support': 40452}, '1': {'precision': 0.9278581171084223, 'recall': 0.718379660221455, 'f1-score': 0.8097911590671772, 'support': 323858}, '2': {'precision': 0.33848203450641057, 'recall': 0.6546173469387755, 'f1-score': 0.4462316975619935, 'support': 39200}, 'accuracy': 0.7046293772149389, 'macro avg': {'precision': 0.5347794961089067, 'recall': 0.6720020018264087, 'f1-score': 0.5663700700438291, 'support': 403510}, 'weighted avg': {'precision': 0.8114680641367501, 'recall': 0.7046293772149389, 'f1-score': 0.7377100873868895, 'support': 403510}}
[[ 26011   9312   5129]
 [ 46183 232653  45022]
 [  4762   8777  25661]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.66512644
{'0': {'precision': 0.3312248018907271, 'recall': 0.6600637207369442, 'f1-score': 0.44110159685258044, 'support': 14438}, '1': {'precision': 0.9354327715118489, 'recall': 0.7129530509252179, 'f1-score': 0.8091790639145309, 'support': 124241}, '2': {'precision': 0.339891949576469, 'recall': 0.6900006770022341, 'f1-score': 0.45543713832473126, 'support': 14771}, 'accuracy': 0.7057673509286413, 'macro avg': {'precision': 0.5355165076596816, 'recall': 0.6876724828881321, 'f1-score': 0.5685725996972809, 'support': 153450}, 'weighted avg': {'precision': 0.8212568956813031, 'recall': 0.7057673509286413, 'f1-score': 0.7404959459456332, 'support': 153450}}
[[ 9530  3170  1738]
 [17607 88578 18056]
 [ 1635  2944 10192]]
training model: results/AAL/W9/deepVOL_L2/h30
Epoch 1/50
1577/1577 - 39s - loss: 2.7027 - accuracy30: 0.5173 - val_loss: 2.4158 - val_accuracy30: 0.6492 - 39s/epoch - 25ms/step
Epoch 2/50
1577/1577 - 37s - loss: 2.4486 - accuracy30: 0.6035 - val_loss: 2.3560 - val_accuracy30: 0.6592 - 37s/epoch - 23ms/step
Epoch 3/50
1577/1577 - 39s - loss: 2.3660 - accuracy30: 0.6213 - val_loss: 2.3212 - val_accuracy30: 0.6969 - 39s/epoch - 25ms/step
Epoch 4/50
1577/1577 - 37s - loss: 2.3237 - accuracy30: 0.6275 - val_loss: 2.3072 - val_accuracy30: 0.6950 - 37s/epoch - 24ms/step
Epoch 5/50
1577/1577 - 40s - loss: 2.2946 - accuracy30: 0.6343 - val_loss: 2.2843 - val_accuracy30: 0.6961 - 40s/epoch - 25ms/step
Epoch 6/50
1577/1577 - 37s - loss: 2.2715 - accuracy30: 0.6399 - val_loss: 2.2861 - val_accuracy30: 0.7034 - 37s/epoch - 23ms/step
Epoch 7/50
1577/1577 - 36s - loss: 2.2490 - accuracy30: 0.6423 - val_loss: 2.2759 - val_accuracy30: 0.6737 - 36s/epoch - 23ms/step
Epoch 8/50
1577/1577 - 38s - loss: 2.2280 - accuracy30: 0.6463 - val_loss: 2.2533 - val_accuracy30: 0.6625 - 38s/epoch - 24ms/step
Epoch 9/50
1577/1577 - 36s - loss: 2.2129 - accuracy30: 0.6464 - val_loss: 2.2284 - val_accuracy30: 0.6709 - 36s/epoch - 23ms/step
Epoch 10/50
1577/1577 - 38s - loss: 2.1944 - accuracy30: 0.6507 - val_loss: 2.2332 - val_accuracy30: 0.6398 - 38s/epoch - 24ms/step
Epoch 11/50
1577/1577 - 38s - loss: 2.1861 - accuracy30: 0.6515 - val_loss: 2.2119 - val_accuracy30: 0.6599 - 38s/epoch - 24ms/step
Epoch 12/50
1577/1577 - 36s - loss: 2.1711 - accuracy30: 0.6515 - val_loss: 2.2000 - val_accuracy30: 0.6567 - 36s/epoch - 23ms/step
Epoch 13/50
1577/1577 - 37s - loss: 2.1602 - accuracy30: 0.6537 - val_loss: 2.1978 - val_accuracy30: 0.6825 - 37s/epoch - 24ms/step
Epoch 14/50
1577/1577 - 36s - loss: 2.1544 - accuracy30: 0.6550 - val_loss: 2.1936 - val_accuracy30: 0.6771 - 36s/epoch - 23ms/step
Epoch 15/50
1577/1577 - 39s - loss: 2.1428 - accuracy30: 0.6544 - val_loss: 2.2133 - val_accuracy30: 0.6732 - 39s/epoch - 25ms/step
Epoch 16/50
1577/1577 - 37s - loss: 2.1346 - accuracy30: 0.6544 - val_loss: 2.2083 - val_accuracy30: 0.6475 - 37s/epoch - 24ms/step
Epoch 17/50
1577/1577 - 35s - loss: 2.1227 - accuracy30: 0.6575 - val_loss: 2.1867 - val_accuracy30: 0.6758 - 35s/epoch - 22ms/step
Epoch 18/50
1577/1577 - 40s - loss: 2.1142 - accuracy30: 0.6576 - val_loss: 2.1958 - val_accuracy30: 0.6759 - 40s/epoch - 25ms/step
Epoch 19/50
1577/1577 - 38s - loss: 2.1061 - accuracy30: 0.6585 - val_loss: 2.1976 - val_accuracy30: 0.6703 - 38s/epoch - 24ms/step
Epoch 20/50
1577/1577 - 37s - loss: 2.0970 - accuracy30: 0.6588 - val_loss: 2.2006 - val_accuracy30: 0.6844 - 37s/epoch - 23ms/step
Epoch 21/50
1577/1577 - 36s - loss: 2.0891 - accuracy30: 0.6594 - val_loss: 2.2095 - val_accuracy30: 0.6662 - 36s/epoch - 23ms/step
Epoch 22/50
1577/1577 - 36s - loss: 2.0798 - accuracy30: 0.6591 - val_loss: 2.2071 - val_accuracy30: 0.6430 - 36s/epoch - 23ms/step
Epoch 23/50
1577/1577 - 39s - loss: 2.0723 - accuracy30: 0.6596 - val_loss: 2.2103 - val_accuracy30: 0.6697 - 39s/epoch - 24ms/step
Epoch 24/50
1577/1577 - 37s - loss: 2.0660 - accuracy30: 0.6599 - val_loss: 2.2181 - val_accuracy30: 0.6319 - 37s/epoch - 24ms/step
Epoch 25/50
1577/1577 - 37s - loss: 2.0570 - accuracy30: 0.6606 - val_loss: 2.2136 - val_accuracy30: 0.6459 - 37s/epoch - 24ms/step
Epoch 26/50
1577/1577 - 37s - loss: 2.0538 - accuracy30: 0.6608 - val_loss: 2.2238 - val_accuracy30: 0.6334 - 37s/epoch - 23ms/step
Epoch 27/50
1577/1577 - 38s - loss: 2.0470 - accuracy30: 0.6614 - val_loss: 2.2211 - val_accuracy30: 0.6329 - 38s/epoch - 24ms/step
testing model: results/AAL/W9/deepVOL_L2/h30
Evaluating performance on  test set...
3870/3870 - 40s - 40s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88345075
{'0': {'precision': 0.3790266182019115, 'recall': 0.6341273165869794, 'f1-score': 0.4744612325184272, 'support': 138458}, '1': {'precision': 0.8810984095327915, 'recall': 0.6109697189327136, 'f1-score': 0.7215815918244192, 'support': 720219}, '2': {'precision': 0.31601569872014607, 'recall': 0.6214920353580112, 'f1-score': 0.4189858550783843, 'support': 132021}, 'accuracy': 0.6156083892366796, 'macro avg': {'precision': 0.5253802421516164, 'recall': 0.6221963569592347, 'f1-score': 0.5383428931404102, 'support': 990698}, 'weighted avg': {'precision': 0.7356265900193906, 'recall': 0.6156083892366796, 'f1-score': 0.6467204510229466, 'support': 990698}}
[[ 87800  32281  18377]
 [120975 440032 159212]
 [ 22871  27100  82050]]
Evaluating performance on  train set...
1577/1577 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74965405
{'0': {'precision': 0.3605841885643397, 'recall': 0.6537242634279989, 'f1-score': 0.464794772458006, 'support': 48909}, '1': {'precision': 0.8994945835920789, 'recall': 0.6791458824448757, 'f1-score': 0.7739419530548485, 'support': 307124}, '2': {'precision': 0.3515406500144662, 'recall': 0.6142131979695431, 'f1-score': 0.44715515721196974, 'support': 47477}, 'accuracy': 0.668424574359991, 'macro avg': {'precision': 0.5372064740569616, 'recall': 0.649027781280806, 'f1-score': 0.5619639609082747, 'support': 403510}, 'weighted avg': {'precision': 0.7697015737165467, 'recall': 0.668424574359991, 'f1-score': 0.6980208205871442, 'support': 403510}}
[[ 31973  11746   5190]
 [ 49941 208582  48601]
 [  6756  11560  29161]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7338979
{'0': {'precision': 0.3621117617107943, 'recall': 0.6467178175618074, 'f1-score': 0.464268956935066, 'support': 17595}, '1': {'precision': 0.9094295481130683, 'recall': 0.6789666019450403, 'f1-score': 0.7774789556977388, 'support': 117941}, '2': {'precision': 0.3562534954228358, 'recall': 0.6756168359941945, 'f1-score': 0.4665137703085552, 'support': 17914}, 'accuracy': 0.6748778103616814, 'macro avg': {'precision': 0.5425982684155661, 'recall': 0.6671004185003474, 'f1-score': 0.5694205609804533, 'support': 153450}, 'weighted avg': {'precision': 0.7820939191809025, 'recall': 0.6748778103616814, 'f1-score': 0.7052628575596414, 'support': 153450}}
[[11379  4203  2013]
 [18006 80078 19857]
 [ 2039  3772 12103]]
training model: results/AAL/W9/deepVOL_L2/h50
Epoch 1/50
1577/1577 - 38s - loss: 2.8757 - accuracy50: 0.4756 - val_loss: 2.6128 - val_accuracy50: 0.6347 - 38s/epoch - 24ms/step
Epoch 2/50
1577/1577 - 39s - loss: 2.5931 - accuracy50: 0.5815 - val_loss: 2.5620 - val_accuracy50: 0.6439 - 39s/epoch - 25ms/step
Epoch 3/50
1577/1577 - 35s - loss: 2.5271 - accuracy50: 0.5926 - val_loss: 2.5499 - val_accuracy50: 0.6514 - 35s/epoch - 22ms/step
Epoch 4/50
1577/1577 - 39s - loss: 2.4986 - accuracy50: 0.6021 - val_loss: 2.5215 - val_accuracy50: 0.6392 - 39s/epoch - 25ms/step
Epoch 5/50
1577/1577 - 41s - loss: 2.4787 - accuracy50: 0.6055 - val_loss: 2.5173 - val_accuracy50: 0.6328 - 41s/epoch - 26ms/step
Epoch 6/50
1577/1577 - 37s - loss: 2.4648 - accuracy50: 0.6079 - val_loss: 2.5055 - val_accuracy50: 0.6238 - 37s/epoch - 24ms/step
Epoch 7/50
1577/1577 - 36s - loss: 2.4611 - accuracy50: 0.6079 - val_loss: 2.5029 - val_accuracy50: 0.6303 - 36s/epoch - 23ms/step
Epoch 8/50
1577/1577 - 36s - loss: 2.4452 - accuracy50: 0.6100 - val_loss: 2.5024 - val_accuracy50: 0.6221 - 36s/epoch - 23ms/step
Epoch 9/50
1577/1577 - 39s - loss: 2.4353 - accuracy50: 0.6137 - val_loss: 2.4921 - val_accuracy50: 0.6439 - 39s/epoch - 25ms/step
Epoch 10/50
1577/1577 - 40s - loss: 2.4195 - accuracy50: 0.6147 - val_loss: 2.4903 - val_accuracy50: 0.6658 - 40s/epoch - 25ms/step
Epoch 11/50
1577/1577 - 34s - loss: 2.4054 - accuracy50: 0.6175 - val_loss: 2.4776 - val_accuracy50: 0.6496 - 34s/epoch - 22ms/step
Epoch 12/50
1577/1577 - 36s - loss: 2.3926 - accuracy50: 0.6196 - val_loss: 2.4766 - val_accuracy50: 0.6439 - 36s/epoch - 23ms/step
Epoch 13/50
1577/1577 - 37s - loss: 2.3819 - accuracy50: 0.6201 - val_loss: 2.4665 - val_accuracy50: 0.6378 - 37s/epoch - 23ms/step
Epoch 14/50
1577/1577 - 37s - loss: 2.3714 - accuracy50: 0.6216 - val_loss: 2.4772 - val_accuracy50: 0.6376 - 37s/epoch - 23ms/step
Epoch 15/50
1577/1577 - 39s - loss: 2.3603 - accuracy50: 0.6230 - val_loss: 2.4584 - val_accuracy50: 0.6335 - 39s/epoch - 24ms/step
Epoch 16/50
1577/1577 - 37s - loss: 2.3503 - accuracy50: 0.6230 - val_loss: 2.4693 - val_accuracy50: 0.6343 - 37s/epoch - 24ms/step
Epoch 17/50
1577/1577 - 37s - loss: 2.3419 - accuracy50: 0.6236 - val_loss: 2.4703 - val_accuracy50: 0.6257 - 37s/epoch - 23ms/step
Epoch 18/50
1577/1577 - 40s - loss: 2.3350 - accuracy50: 0.6249 - val_loss: 2.4584 - val_accuracy50: 0.6346 - 40s/epoch - 26ms/step
Epoch 19/50
1577/1577 - 39s - loss: 2.3260 - accuracy50: 0.6252 - val_loss: 2.4828 - val_accuracy50: 0.6382 - 39s/epoch - 25ms/step
Epoch 20/50
1577/1577 - 36s - loss: 2.3191 - accuracy50: 0.6255 - val_loss: 2.4572 - val_accuracy50: 0.6302 - 36s/epoch - 23ms/step
Epoch 21/50
1577/1577 - 36s - loss: 2.3102 - accuracy50: 0.6272 - val_loss: 2.4643 - val_accuracy50: 0.6368 - 36s/epoch - 23ms/step
Epoch 22/50
1577/1577 - 39s - loss: 2.3031 - accuracy50: 0.6280 - val_loss: 2.4746 - val_accuracy50: 0.6425 - 39s/epoch - 25ms/step
Epoch 23/50
1577/1577 - 36s - loss: 2.2960 - accuracy50: 0.6284 - val_loss: 2.4719 - val_accuracy50: 0.6467 - 36s/epoch - 23ms/step
Epoch 24/50
1577/1577 - 37s - loss: 2.2882 - accuracy50: 0.6297 - val_loss: 2.4742 - val_accuracy50: 0.6435 - 37s/epoch - 24ms/step
Epoch 25/50
1577/1577 - 36s - loss: 2.2826 - accuracy50: 0.6302 - val_loss: 2.4689 - val_accuracy50: 0.6129 - 36s/epoch - 23ms/step
Epoch 26/50
1577/1577 - 37s - loss: 2.2712 - accuracy50: 0.6314 - val_loss: 2.4966 - val_accuracy50: 0.6322 - 37s/epoch - 23ms/step
Epoch 27/50
1577/1577 - 37s - loss: 2.2692 - accuracy50: 0.6310 - val_loss: 2.4613 - val_accuracy50: 0.6111 - 37s/epoch - 24ms/step
Epoch 28/50
1577/1577 - 40s - loss: 2.2588 - accuracy50: 0.6317 - val_loss: 2.4890 - val_accuracy50: 0.6225 - 40s/epoch - 25ms/step
Epoch 29/50
1577/1577 - 39s - loss: 2.2538 - accuracy50: 0.6319 - val_loss: 2.4797 - val_accuracy50: 0.6335 - 39s/epoch - 25ms/step
Epoch 30/50
1577/1577 - 38s - loss: 2.2464 - accuracy50: 0.6336 - val_loss: 2.4828 - val_accuracy50: 0.6279 - 38s/epoch - 24ms/step
testing model: results/AAL/W9/deepVOL_L2/h50
Evaluating performance on  test set...
3870/3870 - 39s - 39s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8892375
{'0': {'precision': 0.42253911412371575, 'recall': 0.560177466301184, 'f1-score': 0.48171954168236103, 'support': 176935}, '1': {'precision': 0.8047085501442053, 'recall': 0.5768058304479291, 'f1-score': 0.67195910524729, 'support': 647223}, '2': {'precision': 0.34003066329917936, 'recall': 0.5966074216404468, 'f1-score': 0.4331765290596539, 'support': 166540}, 'accuracy': 0.5771647868472531, 'macro avg': {'precision': 0.5224261091890335, 'recall': 0.5778635727965199, 'f1-score': 0.5289517253297683, 'support': 990698}, 'weighted avg': {'precision': 0.6583404294480336, 'recall': 0.5771647868472531, 'f1-score': 0.5978427878451658, 'support': 990698}}
[[ 99115  51569  26251]
 [107305 373322 166596]
 [ 28150  39031  99359]]
Evaluating performance on  train set...
1577/1577 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81055194
{'0': {'precision': 0.3904483410220951, 'recall': 0.5848421119210638, 'f1-score': 0.46827205509976705, 'support': 63241}, '1': {'precision': 0.8325668779092592, 'recall': 0.638838983142018, 'f1-score': 0.7229496521119816, 'support': 278859}, '2': {'precision': 0.37522017487422343, 'recall': 0.5793030451066602, 'f1-score': 0.4554445305048617, 'support': 61410}, 'accuracy': 0.6213154568660009, 'macro avg': {'precision': 0.532745131268526, 'recall': 0.600994713389914, 'f1-score': 0.5488887459055368, 'support': 403510}, 'weighted avg': {'precision': 0.6936714864080258, 'recall': 0.6213154568660009, 'f1-score': 0.6423232601253078, 'support': 403510}}
[[ 36986  18916   7339]
 [ 48816 178146  51897]
 [  8925  16910  35575]]
Evaluating performance on  val set...
600/600 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.79832846
{'0': {'precision': 0.3998511904761905, 'recall': 0.5857348389065702, 'f1-score': 0.4752639864159754, 'support': 22937}, '1': {'precision': 0.8460176991150442, 'recall': 0.6413536706950048, 'f1-score': 0.7296046808668508, 'support': 107323}, '2': {'precision': 0.3733956871914783, 'recall': 0.6197498921949116, 'f1-score': 0.4660181582360571, 'support': 23190}, 'accuracy': 0.6297751710654936, 'macro avg': {'precision': 0.539754858927571, 'recall': 0.6156128005988288, 'f1-score': 0.5569622751729612, 'support': 153450}, 'weighted avg': {'precision': 0.7079021848422721, 'recall': 0.6297751710654936, 'f1-score': 0.6517527162632155, 'support': 153450}}
[[13435  6672  2830]
 [17203 68832 21288]
 [ 2962  5856 14372]]
training model: results/AAL/W9/deepVOL_L2/h100
Epoch 1/50
1577/1577 - 38s - loss: 3.0833 - accuracy100: 0.4393 - val_loss: 2.9655 - val_accuracy100: 0.4930 - 38s/epoch - 24ms/step
Epoch 2/50
1577/1577 - 36s - loss: 2.8928 - accuracy100: 0.5223 - val_loss: 2.8919 - val_accuracy100: 0.5526 - 36s/epoch - 23ms/step
Epoch 3/50
1577/1577 - 39s - loss: 2.8216 - accuracy100: 0.5390 - val_loss: 2.8613 - val_accuracy100: 0.5611 - 39s/epoch - 25ms/step
Epoch 4/50
1577/1577 - 37s - loss: 2.7934 - accuracy100: 0.5433 - val_loss: 2.8604 - val_accuracy100: 0.5603 - 37s/epoch - 24ms/step
Epoch 5/50
1577/1577 - 38s - loss: 2.7777 - accuracy100: 0.5488 - val_loss: 2.8559 - val_accuracy100: 0.5700 - 38s/epoch - 24ms/step
Epoch 6/50
1577/1577 - 35s - loss: 2.7642 - accuracy100: 0.5514 - val_loss: 2.8692 - val_accuracy100: 0.5576 - 35s/epoch - 22ms/step
Epoch 7/50
1577/1577 - 37s - loss: 2.7522 - accuracy100: 0.5551 - val_loss: 2.8656 - val_accuracy100: 0.5623 - 37s/epoch - 23ms/step
Epoch 8/50
1577/1577 - 39s - loss: 2.7443 - accuracy100: 0.5574 - val_loss: 2.8763 - val_accuracy100: 0.5495 - 39s/epoch - 25ms/step
Epoch 9/50
1577/1577 - 37s - loss: 2.7356 - accuracy100: 0.5573 - val_loss: 2.8717 - val_accuracy100: 0.5626 - 37s/epoch - 23ms/step
Epoch 10/50
1577/1577 - 37s - loss: 2.7264 - accuracy100: 0.5594 - val_loss: 2.8805 - val_accuracy100: 0.5592 - 37s/epoch - 24ms/step
Epoch 11/50
1577/1577 - 36s - loss: 2.7187 - accuracy100: 0.5608 - val_loss: 2.8865 - val_accuracy100: 0.5611 - 36s/epoch - 23ms/step
Epoch 12/50
1577/1577 - 36s - loss: 2.7098 - accuracy100: 0.5626 - val_loss: 2.8786 - val_accuracy100: 0.5728 - 36s/epoch - 23ms/step
Epoch 13/50
1577/1577 - 38s - loss: 2.7005 - accuracy100: 0.5630 - val_loss: 2.8961 - val_accuracy100: 0.5531 - 38s/epoch - 24ms/step
Epoch 14/50
1577/1577 - 36s - loss: 2.6942 - accuracy100: 0.5632 - val_loss: 2.8934 - val_accuracy100: 0.5473 - 36s/epoch - 23ms/step
Epoch 15/50
1577/1577 - 37s - loss: 2.6837 - accuracy100: 0.5645 - val_loss: 2.9030 - val_accuracy100: 0.5489 - 37s/epoch - 23ms/step
testing model: results/AAL/W9/deepVOL_L2/h100
Evaluating performance on  test set...
3870/3870 - 38s - 38s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.98833
{'0': {'precision': 0.4988069359768875, 'recall': 0.37038789025543994, 'f1-score': 0.4251107877898878, 'support': 240996}, '1': {'precision': 0.6616128400008711, 'recall': 0.5808032821046152, 'f1-score': 0.6185800427377837, 'support': 523079}, '2': {'precision': 0.3732162458836443, 'recall': 0.5806118531658305, 'f1-score': 0.45436651818087637, 'support': 226623}, 'accuracy': 0.5295740982620334, 'macro avg': {'precision': 0.5112120072871343, 'recall': 0.5106010085086286, 'f1-score': 0.499352449569516, 'support': 990698}, 'weighted avg': {'precision': 0.5560379089978892, 'recall': 0.5295740982620334, 'f1-score': 0.5339529635056836, 'support': 990698}}
[[ 89262  88256  63478]
 [ 61774 303806 157499]
 [ 27915  67128 131580]]
Evaluating performance on  train set...
1577/1577 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.94126165
{'0': {'precision': 0.46688718614356095, 'recall': 0.3783478103510677, 'f1-score': 0.4179801955455596, 'support': 88416}, '1': {'precision': 0.6821829705487807, 'recall': 0.6397739875246023, 'f1-score': 0.6602982292637466, 'support': 228129}, '2': {'precision': 0.3944993809047272, 'recall': 0.5348933478985799, 'f1-score': 0.45409241552330887, 'support': 86965}, 'accuracy': 0.5598869916482863, 'macro avg': {'precision': 0.514523179199023, 'recall': 0.5176717152580833, 'f1-score': 0.5107902801108717, 'support': 403510}, 'weighted avg': {'precision': 0.5730060097612735, 'recall': 0.5598869916482863, 'f1-score': 0.5627604238533122, 'support': 403510}}
[[ 33452  36968  17996]
 [ 28777 145951  53401]
 [  9420  31028  46517]]
Evaluating performance on  val set...
600/600 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9280456
{'0': {'precision': 0.4577085456398311, 'recall': 0.38783692098932954, 'f1-score': 0.4198858134953758, 'support': 32426}, '1': {'precision': 0.6997504748426502, 'recall': 0.6391323574433345, 'f1-score': 0.66806916904697, 'support': 88193}, '2': {'precision': 0.4025450782677616, 'recall': 0.5569126739971368, 'f1-score': 0.4673107396616061, 'support': 32831}, 'accuracy': 0.5684392310198761, 'macro avg': {'precision': 0.520001366250081, 'recall': 0.5279606508099336, 'f1-score': 0.5184219074013173, 'support': 153450}, 'weighted avg': {'precision': 0.5850160208101917, 'recall': 0.5684392310198761, 'f1-score': 0.5726720137373129, 'support': 153450}}
[[12576 13072  6778]
 [11467 56367 20359]
 [ 3433 11114 18284]]
training model: results/AAL/W9/deepVOL_L2/h200
Epoch 1/50
1577/1577 - 38s - loss: 3.2245 - accuracy200: 0.4112 - val_loss: 3.2180 - val_accuracy200: 0.4118 - 38s/epoch - 24ms/step
Epoch 2/50
1577/1577 - 35s - loss: 3.1795 - accuracy200: 0.4161 - val_loss: 3.2111 - val_accuracy200: 0.4314 - 35s/epoch - 22ms/step
Epoch 3/50
1577/1577 - 37s - loss: 3.0985 - accuracy200: 0.4644 - val_loss: 3.1406 - val_accuracy200: 0.4599 - 37s/epoch - 23ms/step
Epoch 4/50
1577/1577 - 37s - loss: 3.0402 - accuracy200: 0.4832 - val_loss: 3.1256 - val_accuracy200: 0.4676 - 37s/epoch - 23ms/step
Epoch 5/50
1577/1577 - 36s - loss: 3.0157 - accuracy200: 0.4892 - val_loss: 3.1366 - val_accuracy200: 0.4850 - 36s/epoch - 23ms/step
Epoch 6/50
1577/1577 - 37s - loss: 2.9974 - accuracy200: 0.4933 - val_loss: 3.1536 - val_accuracy200: 0.4769 - 37s/epoch - 23ms/step
Epoch 7/50
1577/1577 - 38s - loss: 2.9873 - accuracy200: 0.4950 - val_loss: 3.1447 - val_accuracy200: 0.4777 - 38s/epoch - 24ms/step
Epoch 8/50
1577/1577 - 38s - loss: 2.9770 - accuracy200: 0.4979 - val_loss: 3.1646 - val_accuracy200: 0.4776 - 38s/epoch - 24ms/step
Epoch 9/50
1577/1577 - 36s - loss: 2.9661 - accuracy200: 0.4998 - val_loss: 3.1725 - val_accuracy200: 0.4888 - 36s/epoch - 23ms/step
Epoch 10/50
1577/1577 - 36s - loss: 2.9591 - accuracy200: 0.5011 - val_loss: 3.1891 - val_accuracy200: 0.4834 - 36s/epoch - 23ms/step
Epoch 11/50
1577/1577 - 36s - loss: 2.9508 - accuracy200: 0.5017 - val_loss: 3.2133 - val_accuracy200: 0.4781 - 36s/epoch - 23ms/step
Epoch 12/50
1577/1577 - 36s - loss: 2.9444 - accuracy200: 0.5040 - val_loss: 3.2318 - val_accuracy200: 0.4650 - 36s/epoch - 23ms/step
Epoch 13/50
1577/1577 - 39s - loss: 2.9352 - accuracy200: 0.5056 - val_loss: 3.2185 - val_accuracy200: 0.4619 - 39s/epoch - 25ms/step
Epoch 14/50
1577/1577 - 39s - loss: 2.9269 - accuracy200: 0.5079 - val_loss: 3.2294 - val_accuracy200: 0.4599 - 39s/epoch - 25ms/step
testing model: results/AAL/W9/deepVOL_L2/h200
Evaluating performance on  test set...
3870/3870 - 36s - 36s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0507319
{'0': {'precision': 0.4991743773066739, 'recall': 0.2786614830291935, 'f1-score': 0.3576607337450054, 'support': 309178}, '1': {'precision': 0.5052849840627667, 'recall': 0.5103316192809162, 'f1-score': 0.5077957632164138, 'support': 391081}, '2': {'precision': 0.3778225253714129, 'recall': 0.5504150613381812, 'f1-score': 0.44807323352294787, 'support': 290439}, 'accuracy': 0.44978288035304403, 'macro avg': {'precision': 0.46076062891361785, 'recall': 0.4464693878827637, 'f1-score': 0.43784324349478904, 'support': 990698}, 'weighted avg': {'precision': 0.4660103168932626, 'recall': 0.44978288035304403, 'f1-score': 0.443432859542891, 'support': 990698}}
[[ 86156 104252 118770]
 [ 47018 199581 144482]
 [ 39423  91154 159862]]
Evaluating performance on  train set...
1577/1577 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.034652
{'0': {'precision': 0.46657755797634165, 'recall': 0.30510444891180843, 'f1-score': 0.36894702074250235, 'support': 114410}, '1': {'precision': 0.516812811493064, 'recall': 0.5167540784262474, 'f1-score': 0.5167834432908845, 'support': 175987}, '2': {'precision': 0.37878450578806766, 'recall': 0.5114443079044849, 'f1-score': 0.4352300811387258, 'support': 113113}, 'accuracy': 0.45525513618002034, 'macro avg': {'precision': 0.4540582917524911, 'recall': 0.4444342784141802, 'f1-score': 0.4403201817240376, 'support': 403510}, 'weighted avg': {'precision': 0.463876797272704, 'recall': 0.45525513618002034, 'f1-score': 0.4520050968883727, 'support': 403510}}
[[34907 44583 34920]
 [25088 90942 59957]
 [14820 40442 57851]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0264659
{'0': {'precision': 0.4579465740806349, 'recall': 0.3065721129900624, 'f1-score': 0.3672732955433377, 'support': 42163}, '1': {'precision': 0.5255592155133205, 'recall': 0.5613407525172232, 'f1-score': 0.5428610069115731, 'support': 67932}, '2': {'precision': 0.39556078758995195, 'recall': 0.48052127782262716, 'f1-score': 0.43392139301410093, 'support': 43355}, 'accuracy': 0.4685043988269795, 'macro avg': {'precision': 0.4596888590613024, 'recall': 0.4494780477766376, 'f1-score': 0.44801856515633726, 'support': 153450}, 'weighted avg': {'precision': 0.4702523817346045, 'recall': 0.4685043988269795, 'f1-score': 0.4638360369868822, 'support': 153450}}
[[12926 17601 11636]
 [ 9601 38133 20198]
 [ 5699 16823 20833]]
training model: results/AAL/W9/deepVOL_L2/h300
Epoch 1/50
1577/1577 - 38s - loss: 3.2577 - accuracy300: 0.3984 - val_loss: 3.3787 - val_accuracy300: 0.3872 - 38s/epoch - 24ms/step
Epoch 2/50
1577/1577 - 37s - loss: 3.1910 - accuracy300: 0.4261 - val_loss: 3.2651 - val_accuracy300: 0.4126 - 37s/epoch - 23ms/step
Epoch 3/50
1577/1577 - 35s - loss: 3.1282 - accuracy300: 0.4507 - val_loss: 3.2273 - val_accuracy300: 0.4287 - 35s/epoch - 22ms/step
Epoch 4/50
1577/1577 - 35s - loss: 3.1031 - accuracy300: 0.4562 - val_loss: 3.1914 - val_accuracy300: 0.4376 - 35s/epoch - 22ms/step
Epoch 5/50
1577/1577 - 36s - loss: 3.0796 - accuracy300: 0.4623 - val_loss: 3.1833 - val_accuracy300: 0.4393 - 36s/epoch - 23ms/step
Epoch 6/50
1577/1577 - 35s - loss: 3.0643 - accuracy300: 0.4656 - val_loss: 3.2193 - val_accuracy300: 0.4359 - 35s/epoch - 22ms/step
Epoch 7/50
1577/1577 - 36s - loss: 3.0543 - accuracy300: 0.4680 - val_loss: 3.2282 - val_accuracy300: 0.4355 - 36s/epoch - 23ms/step
Epoch 8/50
1577/1577 - 36s - loss: 3.0473 - accuracy300: 0.4696 - val_loss: 3.2305 - val_accuracy300: 0.4339 - 36s/epoch - 23ms/step
Epoch 9/50
1577/1577 - 37s - loss: 3.0378 - accuracy300: 0.4725 - val_loss: 3.2588 - val_accuracy300: 0.4293 - 37s/epoch - 24ms/step
Epoch 10/50
1577/1577 - 36s - loss: 3.0272 - accuracy300: 0.4754 - val_loss: 3.2633 - val_accuracy300: 0.4298 - 36s/epoch - 23ms/step
Epoch 11/50
1577/1577 - 38s - loss: 3.0189 - accuracy300: 0.4791 - val_loss: 3.2759 - val_accuracy300: 0.4280 - 38s/epoch - 24ms/step
Epoch 12/50
1577/1577 - 38s - loss: 3.0122 - accuracy300: 0.4806 - val_loss: 3.2801 - val_accuracy300: 0.4263 - 38s/epoch - 24ms/step
Epoch 13/50
1577/1577 - 36s - loss: 3.0034 - accuracy300: 0.4819 - val_loss: 3.2867 - val_accuracy300: 0.4283 - 36s/epoch - 23ms/step
Epoch 14/50
1577/1577 - 36s - loss: 2.9909 - accuracy300: 0.4863 - val_loss: 3.3004 - val_accuracy300: 0.4255 - 36s/epoch - 23ms/step
Epoch 15/50
1577/1577 - 35s - loss: 2.9839 - accuracy300: 0.4888 - val_loss: 3.3313 - val_accuracy300: 0.4207 - 35s/epoch - 22ms/step
testing model: results/AAL/W9/deepVOL_L2/h300
Evaluating performance on  test set...
3870/3870 - 39s - 39s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0593257
{'0': {'precision': 0.4850352370805517, 'recall': 0.28636846296787893, 'f1-score': 0.3601195983874538, 'support': 346564}, '1': {'precision': 0.41210567069920856, 'recall': 0.6385396864969304, 'f1-score': 0.5009222645291805, 'support': 320890}, '2': {'precision': 0.41863548406080053, 'recall': 0.3741291408347873, 'f1-score': 0.3951330043144923, 'support': 323244}, 'accuracy': 0.42907222988236576, 'macro avg': {'precision': 0.4385921306135203, 'recall': 0.4330124300998655, 'f1-score': 0.4187249557437089, 'support': 990698}, 'weighted avg': {'precision': 0.43974828755483786, 'recall': 0.42907222988236576, 'f1-score': 0.4171501373849064, 'support': 990698}}
[[ 99245 149141  98178]
 [ 46223 204901  69766]
 [ 59146 143163 120935]]
Evaluating performance on  train set...
1577/1577 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0475285
{'0': {'precision': 0.463175508472579, 'recall': 0.30402128597616157, 'f1-score': 0.3670902035498648, 'support': 129287}, '1': {'precision': 0.43676908416958843, 'recall': 0.6480476783201645, 'f1-score': 0.5218341027631382, 'support': 147824}, '2': {'precision': 0.42978543451775625, 'recall': 0.33770045649095326, 'f1-score': 0.37821864644065994, 'support': 126399}, 'accuracy': 0.4406037025104706, 'macro avg': {'precision': 0.44324334238664126, 'recall': 0.42992314026242645, 'f1-score': 0.42238098425122095, 'support': 403510}, 'weighted avg': {'precision': 0.44304223984483515, 'recall': 0.4406037025104706, 'f1-score': 0.4272658775362755, 'support': 403510}}
[[39306 62313 27668]
 [23063 95797 28964]
 [22493 61221 42685]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0520401
{'0': {'precision': 0.4375784753363229, 'recall': 0.30770039311316194, 'f1-score': 0.36132265271109243, 'support': 47569}, '1': {'precision': 0.4357972665148064, 'recall': 0.6715988275147877, 'f1-score': 0.5285930387572269, 'support': 56973}, '2': {'precision': 0.4494099378881988, 'recall': 0.29588206428396174, 'f1-score': 0.3568328648222124, 'support': 48908}, 'accuracy': 0.4390420332355816, 'macro avg': {'precision': 0.44092855991310936, 'recall': 0.42506042830397045, 'f1-score': 0.41558285209684387, 'support': 153450}, 'weighted avg': {'precision': 0.44068810296942085, 'recall': 0.4390420332355816, 'f1-score': 0.4219958958400404, 'support': 153450}}
[[14637 24041  8891]
 [ 9872 38263  8838]
 [ 8941 25496 14471]]
training model: results/AAL/W9/deepVOL_L2/h500
Epoch 1/50
1577/1577 - 38s - loss: 3.2853 - accuracy500: 0.3831 - val_loss: 3.2972 - val_accuracy500: 0.3533 - 38s/epoch - 24ms/step
Epoch 2/50
1577/1577 - 45s - loss: 3.2566 - accuracy500: 0.3917 - val_loss: 3.2919 - val_accuracy500: 0.3573 - 45s/epoch - 28ms/step
Epoch 3/50
1577/1577 - 37s - loss: 3.2243 - accuracy500: 0.4144 - val_loss: 3.3158 - val_accuracy500: 0.3553 - 37s/epoch - 24ms/step
Epoch 4/50
1577/1577 - 38s - loss: 3.2115 - accuracy500: 0.4206 - val_loss: 3.3254 - val_accuracy500: 0.3563 - 38s/epoch - 24ms/step
Epoch 5/50
1577/1577 - 39s - loss: 3.1976 - accuracy500: 0.4264 - val_loss: 3.3269 - val_accuracy500: 0.3577 - 39s/epoch - 25ms/step
Epoch 6/50
1577/1577 - 37s - loss: 3.1895 - accuracy500: 0.4291 - val_loss: 3.3441 - val_accuracy500: 0.3593 - 37s/epoch - 24ms/step
Epoch 7/50
1577/1577 - 37s - loss: 3.1816 - accuracy500: 0.4322 - val_loss: 3.3207 - val_accuracy500: 0.3615 - 37s/epoch - 23ms/step
Epoch 8/50
1577/1577 - 39s - loss: 3.1728 - accuracy500: 0.4350 - val_loss: 3.3415 - val_accuracy500: 0.3593 - 39s/epoch - 25ms/step
Epoch 9/50
1577/1577 - 39s - loss: 3.1615 - accuracy500: 0.4387 - val_loss: 3.3473 - val_accuracy500: 0.3588 - 39s/epoch - 25ms/step
Epoch 10/50
1577/1577 - 36s - loss: 3.1559 - accuracy500: 0.4415 - val_loss: 3.3571 - val_accuracy500: 0.3634 - 36s/epoch - 23ms/step
Epoch 11/50
1577/1577 - 40s - loss: 3.1453 - accuracy500: 0.4462 - val_loss: 3.3560 - val_accuracy500: 0.3614 - 40s/epoch - 26ms/step
Epoch 12/50
1577/1577 - 36s - loss: 3.1352 - accuracy500: 0.4513 - val_loss: 3.3535 - val_accuracy500: 0.3663 - 36s/epoch - 23ms/step
testing model: results/AAL/W9/deepVOL_L2/h500
Evaluating performance on  test set...
3870/3870 - 36s - 36s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1004357
{'0': {'precision': 0.41100536766885104, 'recall': 0.07381167112675015, 'f1-score': 0.12514821304575616, 'support': 338185}, '1': {'precision': 0.34437285195139744, 'recall': 0.6224355567169187, 'f1-score': 0.4434175497455739, 'support': 336769}, '2': {'precision': 0.35088336362957245, 'recall': 0.3570265784939698, 'f1-score': 0.35392831577228834, 'support': 315744}, 'accuracy': 0.35056899277075354, 'macro avg': {'precision': 0.3687538610832737, 'recall': 0.35109126877921293, 'f1-score': 0.3074980261878728, 'support': 990698}, 'weighted avg': {'precision': 0.3691935060026024, 'recall': 0.35056899277075354, 'f1-score': 0.3062520317739126, 'support': 990698}}
[[ 24962 211334 101889]
 [ 20498 209617 106654]
 [ 15274 187741 112729]]
Evaluating performance on  train set...
1577/1577 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0972852
{'0': {'precision': 0.40575298683509625, 'recall': 0.11664163105776663, 'f1-score': 0.1811951676757608, 'support': 137138}, '1': {'precision': 0.32875673303122127, 'recall': 0.6451215642424334, 'f1-score': 0.4355535151816571, 'support': 132358}, '2': {'precision': 0.39259294748945955, 'recall': 0.30572179026071905, 'f1-score': 0.3437539328953661, 'support': 134014}, 'accuracy': 0.3527892741196005, 'macro avg': {'precision': 0.3757008891185924, 'recall': 0.3558283285203063, 'f1-score': 0.32016753858426134, 'support': 403510}, 'weighted avg': {'precision': 0.3761262125944593, 'recall': 0.3527892741196005, 'f1-score': 0.31861806307197305, 'support': 403510}}
[[15996 90960 30182]
 [13764 85387 33207]
 [ 9663 83380 40971]]
Evaluating performance on  val set...
600/600 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0979123
{'0': {'precision': 0.3535223918901578, 'recall': 0.11000638875578982, 'f1-score': 0.1677985199622377, 'support': 50088}, '1': {'precision': 0.3418901621665205, 'recall': 0.6557383387137307, 'f1-score': 0.4494468367008943, 'support': 51731}, '2': {'precision': 0.3994307154871264, 'recall': 0.29896767445914274, 'f1-score': 0.3419735034782223, 'support': 51631}, 'accuracy': 0.3575627240143369, 'macro avg': {'precision': 0.36494775651460154, 'recall': 0.3549041339762211, 'f1-score': 0.3197396200471181, 'support': 153450}, 'weighted avg': {'precision': 0.36504761691330284, 'recall': 0.3575627240143369, 'f1-score': 0.32135197481477107, 'support': 153450}}
[[ 5510 33280 11298]
 [ 5898 33922 11911]
 [ 4178 32017 15436]]
training model: results/AAL/W9/deepVOL_L2/h1000
Epoch 1/50
1577/1577 - 39s - loss: 3.2054 - accuracy1000: 0.4223 - val_loss: 3.3208 - val_accuracy1000: 0.3281 - 39s/epoch - 25ms/step
Epoch 2/50
1577/1577 - 36s - loss: 3.2198 - accuracy1000: 0.4077 - val_loss: 3.3354 - val_accuracy1000: 0.3267 - 36s/epoch - 23ms/step
Epoch 3/50
1577/1577 - 40s - loss: 3.2159 - accuracy1000: 0.4116 - val_loss: 3.4611 - val_accuracy1000: 0.3317 - 40s/epoch - 25ms/step
Epoch 4/50
1577/1577 - 38s - loss: 3.2178 - accuracy1000: 0.4073 - val_loss: 3.3534 - val_accuracy1000: 0.3131 - 38s/epoch - 24ms/step
Epoch 5/50
1577/1577 - 39s - loss: 3.2172 - accuracy1000: 0.4065 - val_loss: 3.3358 - val_accuracy1000: 0.3240 - 39s/epoch - 25ms/step
Epoch 6/50
1577/1577 - 38s - loss: 3.1969 - accuracy1000: 0.4181 - val_loss: 3.3779 - val_accuracy1000: 0.3263 - 38s/epoch - 24ms/step
Epoch 7/50
1577/1577 - 35s - loss: 3.2049 - accuracy1000: 0.4190 - val_loss: 3.3882 - val_accuracy1000: 0.3350 - 35s/epoch - 22ms/step
Epoch 8/50
1577/1577 - 36s - loss: 3.1858 - accuracy1000: 0.4273 - val_loss: 3.4480 - val_accuracy1000: 0.3362 - 36s/epoch - 23ms/step
Epoch 9/50
1577/1577 - 37s - loss: 3.1889 - accuracy1000: 0.4258 - val_loss: 3.3386 - val_accuracy1000: 0.3312 - 37s/epoch - 24ms/step
Epoch 10/50
1577/1577 - 36s - loss: 3.1771 - accuracy1000: 0.4299 - val_loss: 3.4260 - val_accuracy1000: 0.3325 - 36s/epoch - 23ms/step
Epoch 11/50
1577/1577 - 40s - loss: 3.1682 - accuracy1000: 0.4351 - val_loss: 3.4017 - val_accuracy1000: 0.3444 - 40s/epoch - 25ms/step
testing model: results/AAL/W9/deepVOL_L2/h1000
Evaluating performance on  test set...
3870/3870 - 35s - 35s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1317285
{'0': {'precision': 0.27947007036705485, 'recall': 0.8709892148482258, 'f1-score': 0.4231621584366285, 'support': 274915}, '1': {'precision': 0.5025606582150953, 'recall': 0.012565730779323013, 'f1-score': 0.024518417484834708, 'support': 476375}, '2': {'precision': 0.23929865403216552, 'recall': 0.12193828109336363, 'f1-score': 0.16155416959507696, 'support': 239408}, 'accuracy': 0.2772055661765745, 'macro avg': {'precision': 0.34044312753810524, 'recall': 0.3351644089069708, 'f1-score': 0.20307824850551337, 'support': 990698}, 'weighted avg': {'precision': 0.3770350400593396, 'recall': 0.2772055661765745, 'f1-score': 0.16825606446198746, 'support': 990698}}
[[239448   2945  32522]
 [410110   5986  60279]
 [207235   2980  29193]]
Evaluating performance on  train set...
1577/1577 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1052369
{'0': {'precision': 0.33562056548451363, 'recall': 0.8620291314618307, 'f1-score': 0.4831374404435812, 'support': 135043}, '1': {'precision': 0.3585170340681363, 'recall': 0.012933309235496114, 'f1-score': 0.02496598402121202, 'support': 138325}, '2': {'precision': 0.3267269243424236, 'recall': 0.12971216056307724, 'f1-score': 0.18570037786908236, 'support': 130142}, 'accuracy': 0.33476493767192883, 'macro avg': {'precision': 0.3402881746316912, 'recall': 0.334891533753468, 'f1-score': 0.23126793411129185, 'support': 403510}, 'weighted avg': {'precision': 0.34060115523771856, 'recall': 0.33476493767192883, 'f1-score': 0.23014341078584127, 'support': 403510}}
[[116411   1562  17070]
 [118820   1789  17716]
 [111622   1639  16881]]
Evaluating performance on  val set...
600/600 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1067795
{'0': {'precision': 0.32817459117976, 'recall': 0.858413551817517, 'f1-score': 0.47482273962268273, 'support': 50591}, '1': {'precision': 0.3317409766454352, 'recall': 0.012313329918436502, 'f1-score': 0.02374529843091068, 'support': 50758}, '2': {'precision': 0.31943433503171464, 'recall': 0.11792479990787125, 'f1-score': 0.17225765753136607, 'support': 52101}, 'accuracy': 0.3271228413163897, 'macro avg': {'precision': 0.32644996761897, 'recall': 0.3295505605479416, 'f1-score': 0.22360856519498648, 'support': 153450}, 'weighted avg': {'precision': 0.3263866896346146, 'recall': 0.3271228413163897, 'f1-score': 0.22288574319354193, 'support': 153450}}
[[43428   665  6498]
 [43541   625  6592]
 [45363   594  6144]]
training model: results/AAL/W9/deepVOL_L3/h10
Epoch 1/50
1577/1577 - 58s - loss: 2.8914 - accuracy10: 0.3851 - val_loss: 2.8582 - val_accuracy10: 0.6913 - 58s/epoch - 37ms/step
Epoch 2/50
1577/1577 - 53s - loss: 2.4312 - accuracy10: 0.5691 - val_loss: 2.0936 - val_accuracy10: 0.6594 - 53s/epoch - 34ms/step
Epoch 3/50
1577/1577 - 53s - loss: 2.1482 - accuracy10: 0.6625 - val_loss: 2.0550 - val_accuracy10: 0.7092 - 53s/epoch - 34ms/step
Epoch 4/50
1577/1577 - 54s - loss: 2.0729 - accuracy10: 0.6803 - val_loss: 2.0305 - val_accuracy10: 0.6942 - 54s/epoch - 34ms/step
Epoch 5/50
1577/1577 - 55s - loss: 2.0313 - accuracy10: 0.6915 - val_loss: 2.0061 - val_accuracy10: 0.7190 - 55s/epoch - 35ms/step
Epoch 6/50
1577/1577 - 56s - loss: 2.0081 - accuracy10: 0.6967 - val_loss: 1.9770 - val_accuracy10: 0.7517 - 56s/epoch - 35ms/step
Epoch 7/50
1577/1577 - 57s - loss: 1.9925 - accuracy10: 0.7014 - val_loss: 2.0223 - val_accuracy10: 0.7564 - 57s/epoch - 36ms/step
Epoch 8/50
1577/1577 - 56s - loss: 1.9755 - accuracy10: 0.7029 - val_loss: 1.9638 - val_accuracy10: 0.7307 - 56s/epoch - 36ms/step
Epoch 9/50
1577/1577 - 55s - loss: 1.9613 - accuracy10: 0.7050 - val_loss: 1.9568 - val_accuracy10: 0.7514 - 55s/epoch - 35ms/step
Epoch 10/50
1577/1577 - 56s - loss: 1.9469 - accuracy10: 0.7074 - val_loss: 1.9789 - val_accuracy10: 0.7335 - 56s/epoch - 36ms/step
Epoch 11/50
1577/1577 - 56s - loss: 1.9359 - accuracy10: 0.7066 - val_loss: 1.9942 - val_accuracy10: 0.7241 - 56s/epoch - 35ms/step
Epoch 12/50
1577/1577 - 55s - loss: 1.9265 - accuracy10: 0.7087 - val_loss: 1.9602 - val_accuracy10: 0.7242 - 55s/epoch - 35ms/step
Epoch 13/50
1577/1577 - 56s - loss: 1.9128 - accuracy10: 0.7104 - val_loss: 1.9094 - val_accuracy10: 0.7496 - 56s/epoch - 36ms/step
Epoch 14/50
1577/1577 - 55s - loss: 1.9059 - accuracy10: 0.7121 - val_loss: 1.9391 - val_accuracy10: 0.7504 - 55s/epoch - 35ms/step
Epoch 15/50
1577/1577 - 55s - loss: 1.8980 - accuracy10: 0.7116 - val_loss: 1.9327 - val_accuracy10: 0.7255 - 55s/epoch - 35ms/step
Epoch 16/50
1577/1577 - 55s - loss: 1.8899 - accuracy10: 0.7125 - val_loss: 1.9451 - val_accuracy10: 0.7335 - 55s/epoch - 35ms/step
Epoch 17/50
1577/1577 - 55s - loss: 1.8827 - accuracy10: 0.7127 - val_loss: 1.9404 - val_accuracy10: 0.7304 - 55s/epoch - 35ms/step
Epoch 18/50
1577/1577 - 54s - loss: 1.8798 - accuracy10: 0.7136 - val_loss: 1.9307 - val_accuracy10: 0.7300 - 54s/epoch - 35ms/step
Epoch 19/50
1577/1577 - 55s - loss: 1.8674 - accuracy10: 0.7143 - val_loss: 1.9441 - val_accuracy10: 0.7305 - 55s/epoch - 35ms/step
Epoch 20/50
1577/1577 - 54s - loss: 1.8636 - accuracy10: 0.7151 - val_loss: 1.9521 - val_accuracy10: 0.7037 - 54s/epoch - 35ms/step
Epoch 21/50
1577/1577 - 53s - loss: 1.8515 - accuracy10: 0.7149 - val_loss: 1.9167 - val_accuracy10: 0.7476 - 53s/epoch - 34ms/step
Epoch 22/50
1577/1577 - 54s - loss: 1.8477 - accuracy10: 0.7165 - val_loss: 1.8856 - val_accuracy10: 0.7321 - 54s/epoch - 34ms/step
Epoch 23/50
1577/1577 - 54s - loss: 1.8413 - accuracy10: 0.7169 - val_loss: 1.9437 - val_accuracy10: 0.7263 - 54s/epoch - 34ms/step
Epoch 24/50
1577/1577 - 53s - loss: 1.8352 - accuracy10: 0.7170 - val_loss: 1.9194 - val_accuracy10: 0.7096 - 53s/epoch - 34ms/step
Epoch 25/50
1577/1577 - 54s - loss: 1.8286 - accuracy10: 0.7167 - val_loss: 1.9319 - val_accuracy10: 0.7094 - 54s/epoch - 34ms/step
Epoch 26/50
1577/1577 - 54s - loss: 1.8192 - accuracy10: 0.7175 - val_loss: 1.9344 - val_accuracy10: 0.7094 - 54s/epoch - 34ms/step
Epoch 27/50
1577/1577 - 55s - loss: 1.8116 - accuracy10: 0.7185 - val_loss: 1.9225 - val_accuracy10: 0.7251 - 55s/epoch - 35ms/step
Epoch 28/50
1577/1577 - 54s - loss: 1.8058 - accuracy10: 0.7184 - val_loss: 1.9374 - val_accuracy10: 0.7210 - 54s/epoch - 34ms/step
Epoch 29/50
1577/1577 - 55s - loss: 1.7994 - accuracy10: 0.7195 - val_loss: 1.9189 - val_accuracy10: 0.7119 - 55s/epoch - 35ms/step
Epoch 30/50
1577/1577 - 54s - loss: 1.7935 - accuracy10: 0.7195 - val_loss: 1.9088 - val_accuracy10: 0.7141 - 54s/epoch - 34ms/step
Epoch 31/50
1577/1577 - 55s - loss: 1.7905 - accuracy10: 0.7198 - val_loss: 1.9341 - val_accuracy10: 0.7286 - 55s/epoch - 35ms/step
Epoch 32/50
1577/1577 - 54s - loss: 1.7822 - accuracy10: 0.7201 - val_loss: 1.9383 - val_accuracy10: 0.7320 - 54s/epoch - 34ms/step
testing model: results/AAL/W9/deepVOL_L3/h10
Evaluating performance on  test set...
3870/3870 - 53s - 53s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81635946
{'0': {'precision': 0.29917307542487004, 'recall': 0.6381473524279796, 'f1-score': 0.4073665746034271, 'support': 84247}, '1': {'precision': 0.9555920629495279, 'recall': 0.6299101194369746, 'f1-score': 0.7593015224987261, 'support': 825540}, '2': {'precision': 0.2163979401380737, 'recall': 0.7135988926103991, 'f1-score': 0.33209001366022, 'support': 80911}, 'accuracy': 0.6374455182103931, 'macro avg': {'precision': 0.4903876928374906, 'recall': 0.6605521214917844, 'f1-score': 0.4995860369207911, 'support': 990698}, 'weighted avg': {'precision': 0.8394009874524668, 'recall': 0.6374455182103931, 'f1-score': 0.6944830067179657, 'support': 990698}}
[[ 53762  14050  16435]
 [112883 520016 192641]
 [ 13057  10116  57738]]
Evaluating performance on  train set...
1577/1577 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.68078345
{'0': {'precision': 0.2935629987982621, 'recall': 0.6488014165077636, 'f1-score': 0.4042259795914038, 'support': 29368}, '1': {'precision': 0.9619963567273225, 'recall': 0.7103137871985931, 'f1-score': 0.8172159666676097, 'support': 345712}, '2': {'precision': 0.24576728782442794, 'recall': 0.7204361589869855, 'f1-score': 0.3665059184568172, 'support': 28430}, 'accuracy': 0.7065500235434066, 'macro avg': {'precision': 0.5004422144500041, 'recall': 0.6931837875644474, 'f1-score': 0.5293159549052768, 'support': 403510}, 'weighted avg': {'precision': 0.8628837119736116, 'recall': 0.7065500235434066, 'f1-score': 0.7554024388465225, 'support': 403510}}
[[ 19054   5288   5026]
 [ 42317 245564  57831]
 [  3535   4413  20482]]
Evaluating performance on  val set...
600/600 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6362614
{'0': {'precision': 0.29730074931880107, 'recall': 0.6766472868217054, 'f1-score': 0.4130974917179366, 'support': 10320}, '1': {'precision': 0.9667245916290155, 'recall': 0.734713899747936, 'f1-score': 0.834900583591683, 'support': 132506}, '2': {'precision': 0.26926889291451617, 'recall': 0.7415286144578314, 'f1-score': 0.39507534916376225, 'support': 10624}, 'accuracy': 0.7312805474095797, 'macro avg': {'precision': 0.5110980779541109, 'recall': 0.7176299336758243, 'f1-score': 0.5476911414911273, 'support': 153450}, 'weighted avg': {'precision': 0.873415869597186, 'recall': 0.7312805474095797, 'f1-score': 0.7760820029549981, 'support': 153450}}
[[ 6983  1853  1484]
 [15257 97354 19895]
 [ 1248  1498  7878]]
training model: results/AAL/W9/deepVOL_L3/h20
Epoch 1/50
1577/1577 - 58s - loss: 2.8672 - accuracy20: 0.4083 - val_loss: 2.8546 - val_accuracy20: 0.6121 - 58s/epoch - 37ms/step
Epoch 2/50
1577/1577 - 55s - loss: 2.4505 - accuracy20: 0.5727 - val_loss: 2.2175 - val_accuracy20: 0.6588 - 55s/epoch - 35ms/step
Epoch 3/50
1577/1577 - 55s - loss: 2.2528 - accuracy20: 0.6429 - val_loss: 2.1223 - val_accuracy20: 0.6933 - 55s/epoch - 35ms/step
Epoch 4/50
1577/1577 - 54s - loss: 2.1844 - accuracy20: 0.6557 - val_loss: 2.0895 - val_accuracy20: 0.7076 - 54s/epoch - 34ms/step
Epoch 5/50
1577/1577 - 55s - loss: 2.1415 - accuracy20: 0.6656 - val_loss: 2.0818 - val_accuracy20: 0.7046 - 55s/epoch - 35ms/step
Epoch 6/50
1577/1577 - 55s - loss: 2.1180 - accuracy20: 0.6715 - val_loss: 2.0741 - val_accuracy20: 0.7107 - 55s/epoch - 35ms/step
Epoch 7/50
1577/1577 - 56s - loss: 2.0990 - accuracy20: 0.6743 - val_loss: 2.0838 - val_accuracy20: 0.7188 - 56s/epoch - 36ms/step
Epoch 8/50
1577/1577 - 54s - loss: 2.0816 - accuracy20: 0.6774 - val_loss: 2.0723 - val_accuracy20: 0.7197 - 54s/epoch - 34ms/step
Epoch 9/50
1577/1577 - 55s - loss: 2.0648 - accuracy20: 0.6790 - val_loss: 2.0764 - val_accuracy20: 0.7221 - 55s/epoch - 35ms/step
Epoch 10/50
1577/1577 - 54s - loss: 2.0546 - accuracy20: 0.6804 - val_loss: 2.0775 - val_accuracy20: 0.7330 - 54s/epoch - 34ms/step
Epoch 11/50
1577/1577 - 54s - loss: 2.0414 - accuracy20: 0.6831 - val_loss: 2.0663 - val_accuracy20: 0.7054 - 54s/epoch - 34ms/step
Epoch 12/50
1577/1577 - 53s - loss: 2.0331 - accuracy20: 0.6831 - val_loss: 2.0821 - val_accuracy20: 0.7169 - 53s/epoch - 34ms/step
Epoch 13/50
1577/1577 - 54s - loss: 2.0206 - accuracy20: 0.6842 - val_loss: 2.0591 - val_accuracy20: 0.7262 - 54s/epoch - 34ms/step
Epoch 14/50
1577/1577 - 54s - loss: 2.0096 - accuracy20: 0.6859 - val_loss: 2.0493 - val_accuracy20: 0.7247 - 54s/epoch - 34ms/step
Epoch 15/50
1577/1577 - 55s - loss: 1.9981 - accuracy20: 0.6880 - val_loss: 2.0874 - val_accuracy20: 0.7506 - 55s/epoch - 35ms/step
Epoch 16/50
1577/1577 - 57s - loss: 1.9893 - accuracy20: 0.6892 - val_loss: 2.1122 - val_accuracy20: 0.7435 - 57s/epoch - 36ms/step
Epoch 17/50
1577/1577 - 54s - loss: 1.9814 - accuracy20: 0.6890 - val_loss: 2.0757 - val_accuracy20: 0.7210 - 54s/epoch - 34ms/step
Epoch 18/50
1577/1577 - 53s - loss: 1.9746 - accuracy20: 0.6900 - val_loss: 2.0884 - val_accuracy20: 0.7326 - 53s/epoch - 34ms/step
Epoch 19/50
1577/1577 - 54s - loss: 1.9672 - accuracy20: 0.6911 - val_loss: 2.1496 - val_accuracy20: 0.7396 - 54s/epoch - 34ms/step
Epoch 20/50
1577/1577 - 54s - loss: 1.9594 - accuracy20: 0.6908 - val_loss: 2.1131 - val_accuracy20: 0.7628 - 54s/epoch - 34ms/step
Epoch 21/50
1577/1577 - 54s - loss: 1.9506 - accuracy20: 0.6919 - val_loss: 2.1484 - val_accuracy20: 0.7669 - 54s/epoch - 35ms/step
Epoch 22/50
1577/1577 - 55s - loss: 1.9431 - accuracy20: 0.6926 - val_loss: 2.1425 - val_accuracy20: 0.7516 - 55s/epoch - 35ms/step
Epoch 23/50
1577/1577 - 54s - loss: 1.9354 - accuracy20: 0.6919 - val_loss: 2.0790 - val_accuracy20: 0.7159 - 54s/epoch - 35ms/step
Epoch 24/50
1577/1577 - 53s - loss: 1.9298 - accuracy20: 0.6927 - val_loss: 2.0831 - val_accuracy20: 0.7534 - 53s/epoch - 34ms/step
testing model: results/AAL/W9/deepVOL_L3/h20
Evaluating performance on  test set...
3870/3870 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86758065
{'0': {'precision': 0.3934613370365358, 'recall': 0.5795636760767251, 'f1-score': 0.46871538925261813, 'support': 115373}, '1': {'precision': 0.9151778963306668, 'recall': 0.6248973968871392, 'f1-score': 0.742680942450262, 'support': 765084}, '2': {'precision': 0.26623964282841284, 'recall': 0.7205214031077367, 'f1-score': 0.3888101619002166, 'support': 110241}, 'accuracy': 0.6302586661121754, 'macro avg': {'precision': 0.5249596253985385, 'recall': 0.6416608253572004, 'f1-score': 0.5334021645343655, 'support': 990698}, 'weighted avg': {'precision': 0.7822094169355497, 'recall': 0.6302586661121754, 'f1-score': 0.6713985774029021, 'support': 990698}}
[[ 66866  26260  22247]
 [ 90319 478099 196666]
 [ 12758  18052  79431]]
Evaluating performance on  train set...
1577/1577 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7258292
{'0': {'precision': 0.35987777956462624, 'recall': 0.6085236823890042, 'f1-score': 0.4522796799353256, 'support': 40452}, '1': {'precision': 0.926343358009876, 'recall': 0.7055252610712103, 'f1-score': 0.8009941877177854, 'support': 323858}, '2': {'precision': 0.30397621281839665, 'recall': 0.6858928571428572, 'f1-score': 0.42125796115972464, 'support': 39200}, 'accuracy': 0.6938935838021363, 'macro avg': {'precision': 0.5300657834642997, 'recall': 0.6666472668676905, 'f1-score': 0.5581772762709453, 'support': 403510}, 'weighted avg': {'precision': 0.8090935806294561, 'recall': 0.6938935838021364, 'f1-score': 0.7291450158264022, 'support': 403510}}
[[ 24616   9849   5987]
 [ 39791 228490  55577]
 [  3994   8319  26887]]
Evaluating performance on  val set...
600/600 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65726924
{'0': {'precision': 0.3742974582669239, 'recall': 0.6180911483584984, 'f1-score': 0.4662486938349007, 'support': 14438}, '1': {'precision': 0.933213400008131, 'recall': 0.7390233497798633, 'f1-score': 0.8248431246603093, 'support': 124241}, '2': {'precision': 0.3344971172325432, 'recall': 0.7069934330783292, 'f1-score': 0.4541323302385249, 'support': 14771}, 'accuracy': 0.7245617464972304, 'macro avg': {'precision': 0.5473359918358661, 'recall': 0.6880359770722304, 'f1-score': 0.581741382911245, 'support': 153450}, 'weighted avg': {'precision': 0.8229933506126422, 'recall': 0.7245617464972304, 'f1-score': 0.7554188461548584, 'support': 153450}}
[[ 8924  3574  1940]
 [13587 91817 18837]
 [ 1331  2997 10443]]
training model: results/AAL/W9/deepVOL_L3/h30
Epoch 1/50
1577/1577 - 58s - loss: 2.9438 - accuracy30: 0.3880 - val_loss: 2.8060 - val_accuracy30: 0.5275 - 58s/epoch - 36ms/step
Epoch 2/50
1577/1577 - 59s - loss: 2.6993 - accuracy30: 0.4591 - val_loss: 2.4227 - val_accuracy30: 0.5862 - 59s/epoch - 38ms/step
Epoch 3/50
1577/1577 - 57s - loss: 2.4260 - accuracy30: 0.6012 - val_loss: 2.3366 - val_accuracy30: 0.6238 - 57s/epoch - 36ms/step
Epoch 4/50
1577/1577 - 59s - loss: 2.3362 - accuracy30: 0.6252 - val_loss: 2.3307 - val_accuracy30: 0.6314 - 59s/epoch - 37ms/step
Epoch 5/50
1577/1577 - 54s - loss: 2.2963 - accuracy30: 0.6346 - val_loss: 2.3091 - val_accuracy30: 0.6540 - 54s/epoch - 34ms/step
Epoch 6/50
1577/1577 - 56s - loss: 2.2648 - accuracy30: 0.6418 - val_loss: 2.2570 - val_accuracy30: 0.6603 - 56s/epoch - 35ms/step
Epoch 7/50
1577/1577 - 56s - loss: 2.2459 - accuracy30: 0.6436 - val_loss: 2.2245 - val_accuracy30: 0.6679 - 56s/epoch - 36ms/step
Epoch 8/50
1577/1577 - 54s - loss: 2.2286 - accuracy30: 0.6470 - val_loss: 2.2146 - val_accuracy30: 0.6710 - 54s/epoch - 34ms/step
Epoch 9/50
1577/1577 - 54s - loss: 2.2136 - accuracy30: 0.6519 - val_loss: 2.2263 - val_accuracy30: 0.6599 - 54s/epoch - 34ms/step
Epoch 10/50
1577/1577 - 54s - loss: 2.2020 - accuracy30: 0.6520 - val_loss: 2.2274 - val_accuracy30: 0.6668 - 54s/epoch - 35ms/step
Epoch 11/50
1577/1577 - 54s - loss: 2.1876 - accuracy30: 0.6553 - val_loss: 2.2147 - val_accuracy30: 0.6744 - 54s/epoch - 34ms/step
Epoch 12/50
1577/1577 - 55s - loss: 2.1756 - accuracy30: 0.6572 - val_loss: 2.2167 - val_accuracy30: 0.6597 - 55s/epoch - 35ms/step
Epoch 13/50
1577/1577 - 55s - loss: 2.1621 - accuracy30: 0.6591 - val_loss: 2.2141 - val_accuracy30: 0.6856 - 55s/epoch - 35ms/step
Epoch 14/50
1577/1577 - 54s - loss: 2.1505 - accuracy30: 0.6619 - val_loss: 2.2111 - val_accuracy30: 0.6840 - 54s/epoch - 34ms/step
Epoch 15/50
1577/1577 - 54s - loss: 2.1391 - accuracy30: 0.6630 - val_loss: 2.1947 - val_accuracy30: 0.6492 - 54s/epoch - 34ms/step
Epoch 16/50
1577/1577 - 55s - loss: 2.1271 - accuracy30: 0.6637 - val_loss: 2.1761 - val_accuracy30: 0.6422 - 55s/epoch - 35ms/step
Epoch 17/50
1577/1577 - 55s - loss: 2.1197 - accuracy30: 0.6638 - val_loss: 2.1884 - val_accuracy30: 0.6543 - 55s/epoch - 35ms/step
Epoch 18/50
1577/1577 - 57s - loss: 2.1127 - accuracy30: 0.6651 - val_loss: 2.1573 - val_accuracy30: 0.6339 - 57s/epoch - 36ms/step
Epoch 19/50
1577/1577 - 54s - loss: 2.1044 - accuracy30: 0.6662 - val_loss: 2.1622 - val_accuracy30: 0.6522 - 54s/epoch - 34ms/step
Epoch 20/50
1577/1577 - 56s - loss: 2.0951 - accuracy30: 0.6665 - val_loss: 2.2083 - val_accuracy30: 0.5970 - 56s/epoch - 35ms/step
Epoch 21/50
1577/1577 - 54s - loss: 2.0878 - accuracy30: 0.6670 - val_loss: 2.1826 - val_accuracy30: 0.6242 - 54s/epoch - 34ms/step
Epoch 22/50
1577/1577 - 55s - loss: 2.0834 - accuracy30: 0.6670 - val_loss: 2.1962 - val_accuracy30: 0.6263 - 55s/epoch - 35ms/step
Epoch 23/50
1577/1577 - 55s - loss: 2.0764 - accuracy30: 0.6666 - val_loss: 2.1510 - val_accuracy30: 0.6465 - 55s/epoch - 35ms/step
Epoch 24/50
1577/1577 - 54s - loss: 2.0711 - accuracy30: 0.6686 - val_loss: 2.1915 - val_accuracy30: 0.6312 - 54s/epoch - 34ms/step
Epoch 25/50
1577/1577 - 53s - loss: 2.0631 - accuracy30: 0.6673 - val_loss: 2.1463 - val_accuracy30: 0.6661 - 53s/epoch - 34ms/step
Epoch 26/50
1577/1577 - 55s - loss: 2.0580 - accuracy30: 0.6679 - val_loss: 2.1468 - val_accuracy30: 0.6817 - 55s/epoch - 35ms/step
Epoch 27/50
1577/1577 - 58s - loss: 2.0498 - accuracy30: 0.6688 - val_loss: 2.1440 - val_accuracy30: 0.6639 - 58s/epoch - 37ms/step
Epoch 28/50
1577/1577 - 55s - loss: 2.0409 - accuracy30: 0.6693 - val_loss: 2.1583 - val_accuracy30: 0.6664 - 55s/epoch - 35ms/step
Epoch 29/50
1577/1577 - 54s - loss: 2.0353 - accuracy30: 0.6706 - val_loss: 2.1507 - val_accuracy30: 0.7011 - 54s/epoch - 34ms/step
Epoch 30/50
1577/1577 - 55s - loss: 2.0305 - accuracy30: 0.6699 - val_loss: 2.1365 - val_accuracy30: 0.6877 - 55s/epoch - 35ms/step
Epoch 31/50
1577/1577 - 54s - loss: 2.0244 - accuracy30: 0.6701 - val_loss: 2.1435 - val_accuracy30: 0.6857 - 54s/epoch - 34ms/step
Epoch 32/50
1577/1577 - 53s - loss: 2.0190 - accuracy30: 0.6711 - val_loss: 2.1461 - val_accuracy30: 0.6850 - 53s/epoch - 34ms/step
Epoch 33/50
1577/1577 - 54s - loss: 2.0107 - accuracy30: 0.6713 - val_loss: 2.1323 - val_accuracy30: 0.6679 - 54s/epoch - 34ms/step
Epoch 34/50
1577/1577 - 53s - loss: 2.0022 - accuracy30: 0.6719 - val_loss: 2.1531 - val_accuracy30: 0.6766 - 53s/epoch - 33ms/step
Epoch 35/50
1577/1577 - 53s - loss: 1.9965 - accuracy30: 0.6715 - val_loss: 2.1523 - val_accuracy30: 0.6665 - 53s/epoch - 34ms/step
Epoch 36/50
1577/1577 - 54s - loss: 1.9940 - accuracy30: 0.6719 - val_loss: 2.1662 - val_accuracy30: 0.7085 - 54s/epoch - 34ms/step
Epoch 37/50
1577/1577 - 56s - loss: 1.9884 - accuracy30: 0.6726 - val_loss: 2.1652 - val_accuracy30: 0.6761 - 56s/epoch - 35ms/step
Epoch 38/50
1577/1577 - 58s - loss: 1.9775 - accuracy30: 0.6733 - val_loss: 2.1732 - val_accuracy30: 0.6844 - 58s/epoch - 37ms/step
Epoch 39/50
1577/1577 - 54s - loss: 1.9740 - accuracy30: 0.6740 - val_loss: 2.1840 - val_accuracy30: 0.6787 - 54s/epoch - 34ms/step
Epoch 40/50
1577/1577 - 54s - loss: 1.9668 - accuracy30: 0.6735 - val_loss: 2.1767 - val_accuracy30: 0.6855 - 54s/epoch - 35ms/step
Epoch 41/50
1577/1577 - 53s - loss: 1.9594 - accuracy30: 0.6733 - val_loss: 2.2101 - val_accuracy30: 0.6985 - 53s/epoch - 33ms/step
Epoch 42/50
1577/1577 - 54s - loss: 1.9617 - accuracy30: 0.6733 - val_loss: 2.2187 - val_accuracy30: 0.6623 - 54s/epoch - 35ms/step
Epoch 43/50
1577/1577 - 54s - loss: 1.9619 - accuracy30: 0.6734 - val_loss: 2.2030 - val_accuracy30: 0.6761 - 54s/epoch - 34ms/step
testing model: results/AAL/W9/deepVOL_L3/h30
Evaluating performance on  test set...
3870/3870 - 56s - 56s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9252048
{'0': {'precision': 0.3570355183299745, 'recall': 0.6640786375651823, 'f1-score': 0.46439403313745153, 'support': 138458}, '1': {'precision': 0.8964895095228221, 'recall': 0.5222592017150339, 'f1-score': 0.6600180735047684, 'support': 720219}, '2': {'precision': 0.28069056562860734, 'recall': 0.6667424121919998, 'f1-score': 0.3950639447599855, 'support': 132021}, 'accuracy': 0.5613335244443817, 'macro avg': {'precision': 0.5114051978271347, 'recall': 0.6176934171574053, 'f1-score': 0.5064920171340684, 'support': 990698}, 'weighted avg': {'precision': 0.739034752286573, 'recall': 0.5613335244443817, 'f1-score': 0.5973700996396825, 'support': 990698}}
[[ 91947  23085  23426]
 [141930 376141 202148]
 [ 23652  20345  88024]]
Evaluating performance on  train set...
1577/1577 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7749031
{'0': {'precision': 0.3586743560509625, 'recall': 0.6625161013310433, 'f1-score': 0.46539317773788147, 'support': 48909}, '1': {'precision': 0.9099469000419818, 'recall': 0.642219429285891, 'f1-score': 0.7529935004819761, 'support': 307124}, '2': {'precision': 0.327815119077255, 'recall': 0.6656696926933041, 'f1-score': 0.4392952705285471, 'support': 47477}, 'accuracy': 0.6474387251864886, 'macro avg': {'precision': 0.5321454583900663, 'recall': 0.6568017411034128, 'f1-score': 0.5525606495828016, 'support': 403510}, 'weighted avg': {'precision': 0.7746341211296398, 'recall': 0.6474387251864886, 'f1-score': 0.6812240398773075, 'support': 403510}}
[[ 32403  10331   6175]
 [ 51254 197241  58629]
 [  6684   9189  31604]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7383931
{'0': {'precision': 0.3680498965711778, 'recall': 0.6674055129298097, 'f1-score': 0.4744550615139087, 'support': 17595}, '1': {'precision': 0.9200570431831039, 'recall': 0.6618987459831611, 'f1-score': 0.769913555468985, 'support': 117941}, '2': {'precision': 0.34011881403967736, 'recall': 0.6967176509992185, 'f1-score': 0.45709577000549345, 'support': 17914}, 'accuracy': 0.666594982078853, 'macro avg': {'precision': 0.5427419179313197, 'recall': 0.6753406366373964, 'f1-score': 0.5671547956627957, 'support': 153450}, 'weighted avg': {'precision': 0.7890594597258723, 'recall': 0.666594982078853, 'f1-score': 0.6995166182911906, 'support': 153450}}
[[11743  3610  2242]
 [17903 78065 21973]
 [ 2260  3173 12481]]
training model: results/AAL/W9/deepVOL_L3/h50
Epoch 1/50
1577/1577 - 57s - loss: 2.9849 - accuracy50: 0.4226 - val_loss: 2.9656 - val_accuracy50: 0.5740 - 57s/epoch - 36ms/step
Epoch 2/50
1577/1577 - 54s - loss: 2.7981 - accuracy50: 0.4792 - val_loss: 2.6037 - val_accuracy50: 0.5941 - 54s/epoch - 34ms/step
Epoch 3/50
1577/1577 - 54s - loss: 2.5724 - accuracy50: 0.5840 - val_loss: 2.5415 - val_accuracy50: 0.6443 - 54s/epoch - 34ms/step
Epoch 4/50
1577/1577 - 56s - loss: 2.5047 - accuracy50: 0.5985 - val_loss: 2.4986 - val_accuracy50: 0.6521 - 56s/epoch - 35ms/step
Epoch 5/50
1577/1577 - 54s - loss: 2.4689 - accuracy50: 0.6039 - val_loss: 2.5013 - val_accuracy50: 0.6523 - 54s/epoch - 34ms/step
Epoch 6/50
1577/1577 - 54s - loss: 2.4461 - accuracy50: 0.6087 - val_loss: 2.4620 - val_accuracy50: 0.6473 - 54s/epoch - 34ms/step
Epoch 7/50
1577/1577 - 54s - loss: 2.4276 - accuracy50: 0.6120 - val_loss: 2.4734 - val_accuracy50: 0.6560 - 54s/epoch - 34ms/step
Epoch 8/50
1577/1577 - 53s - loss: 2.4151 - accuracy50: 0.6135 - val_loss: 2.4778 - val_accuracy50: 0.6533 - 53s/epoch - 33ms/step
Epoch 9/50
1577/1577 - 54s - loss: 2.4018 - accuracy50: 0.6152 - val_loss: 2.4248 - val_accuracy50: 0.6466 - 54s/epoch - 34ms/step
Epoch 10/50
1577/1577 - 54s - loss: 2.3869 - accuracy50: 0.6182 - val_loss: 2.4483 - val_accuracy50: 0.6329 - 54s/epoch - 34ms/step
Epoch 11/50
1577/1577 - 54s - loss: 2.3743 - accuracy50: 0.6203 - val_loss: 2.4162 - val_accuracy50: 0.6002 - 54s/epoch - 34ms/step
Epoch 12/50
1577/1577 - 55s - loss: 2.3642 - accuracy50: 0.6210 - val_loss: 2.3878 - val_accuracy50: 0.5793 - 55s/epoch - 35ms/step
Epoch 13/50
1577/1577 - 54s - loss: 2.3522 - accuracy50: 0.6232 - val_loss: 2.4338 - val_accuracy50: 0.5487 - 54s/epoch - 34ms/step
Epoch 14/50
1577/1577 - 54s - loss: 2.3462 - accuracy50: 0.6223 - val_loss: 2.4182 - val_accuracy50: 0.5742 - 54s/epoch - 34ms/step
Epoch 15/50
1577/1577 - 54s - loss: 2.3365 - accuracy50: 0.6249 - val_loss: 2.4233 - val_accuracy50: 0.5500 - 54s/epoch - 34ms/step
Epoch 16/50
1577/1577 - 54s - loss: 2.3285 - accuracy50: 0.6247 - val_loss: 2.4413 - val_accuracy50: 0.5515 - 54s/epoch - 34ms/step
Epoch 17/50
1577/1577 - 55s - loss: 2.3215 - accuracy50: 0.6263 - val_loss: 2.4232 - val_accuracy50: 0.5788 - 55s/epoch - 35ms/step
Epoch 18/50
1577/1577 - 54s - loss: 2.3166 - accuracy50: 0.6266 - val_loss: 2.4573 - val_accuracy50: 0.5188 - 54s/epoch - 34ms/step
Epoch 19/50
1577/1577 - 53s - loss: 2.3084 - accuracy50: 0.6268 - val_loss: 2.4183 - val_accuracy50: 0.5336 - 53s/epoch - 33ms/step
Epoch 20/50
1577/1577 - 55s - loss: 2.3007 - accuracy50: 0.6294 - val_loss: 2.4173 - val_accuracy50: 0.5463 - 55s/epoch - 35ms/step
Epoch 21/50
1577/1577 - 55s - loss: 2.2929 - accuracy50: 0.6287 - val_loss: 2.4252 - val_accuracy50: 0.5541 - 55s/epoch - 35ms/step
Epoch 22/50
1577/1577 - 54s - loss: 2.2879 - accuracy50: 0.6284 - val_loss: 2.4681 - val_accuracy50: 0.5119 - 54s/epoch - 34ms/step
testing model: results/AAL/W9/deepVOL_L3/h50
Evaluating performance on  test set...
3870/3870 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9909974
{'0': {'precision': 0.37520917615947197, 'recall': 0.5917992483115269, 'f1-score': 0.459248343223554, 'support': 176935}, '1': {'precision': 0.847946162148435, 'recall': 0.3714453905377281, 'f1-score': 0.5165948421741386, 'support': 647223}, '2': {'precision': 0.28884699924551926, 'recall': 0.7425123093551099, 'f1-score': 0.415902490376676, 'support': 166540}, 'accuracy': 0.47317749707781787, 'macro avg': {'precision': 0.5040007791844755, 'recall': 0.568585649401455, 'f1-score': 0.4639152252581229, 'support': 990698}, 'weighted avg': {'precision': 0.6695304459505536, 'recall': 0.47317749707781787, 'f1-score': 0.4894262125209334, 'support': 990698}}
[[104710  25491  46734]
 [149098 240408 257717]
 [ 25263  17619 123658]]
Evaluating performance on  train set...
1577/1577 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89392936
{'0': {'precision': 0.3621785876728635, 'recall': 0.5917838111351813, 'f1-score': 0.4493498385102117, 'support': 63241}, '1': {'precision': 0.8587344550560758, 'recall': 0.4994603007254562, 'f1-score': 0.6315791860333295, 'support': 278859}, '2': {'precision': 0.3126186714594234, 'recall': 0.7024425989252565, 'f1-score': 0.4326766835844249, 'support': 61410}, 'accuracy': 0.5448216896731184, 'macro avg': {'precision': 0.5111772380627876, 'recall': 0.5978955702619647, 'f1-score': 0.5045352360426554, 'support': 403510}, 'weighted avg': {'precision': 0.697797526901006, 'recall': 0.5448216896731184, 'f1-score': 0.5727480075195461, 'support': 403510}}
[[ 37425  13127  12689]
 [ 57420 139279  82160]
 [  8488   9785  43137]]
Evaluating performance on  val set...
600/600 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.85202837
{'0': {'precision': 0.37291035935237593, 'recall': 0.6175611457470462, 'f1-score': 0.46502084632809165, 'support': 22937}, '1': {'precision': 0.8776311418476127, 'recall': 0.5415614546742078, 'f1-score': 0.6698050694616505, 'support': 107323}, '2': {'precision': 0.3369077357379313, 'recall': 0.7153514445881846, 'f1-score': 0.4580761849535407, 'support': 23190}, 'accuracy': 0.5791854024112089, 'macro avg': {'precision': 0.5291497456459734, 'recall': 0.6248246816698129, 'f1-score': 0.5309673669144276, 'support': 153450}, 'weighted avg': {'precision': 0.7204714391706707, 'recall': 0.5791854024112089, 'f1-score': 0.6071975193948047, 'support': 153450}}
[[14165  4498  4274]
 [20825 58122 28376]
 [ 2995  3606 16589]]
training model: results/AAL/W9/deepVOL_L3/h100
Epoch 1/50
1577/1577 - 63s - loss: 3.1887 - accuracy100: 0.4101 - val_loss: 3.1424 - val_accuracy100: 0.4618 - 63s/epoch - 40ms/step
Epoch 2/50
1577/1577 - 54s - loss: 3.0726 - accuracy100: 0.3884 - val_loss: 3.0643 - val_accuracy100: 0.4246 - 54s/epoch - 34ms/step
Epoch 3/50
1577/1577 - 55s - loss: 3.0247 - accuracy100: 0.4153 - val_loss: 3.0543 - val_accuracy100: 0.4754 - 55s/epoch - 35ms/step
Epoch 4/50
1577/1577 - 54s - loss: 2.8958 - accuracy100: 0.5033 - val_loss: 2.8941 - val_accuracy100: 0.5264 - 54s/epoch - 34ms/step
Epoch 5/50
1577/1577 - 54s - loss: 2.8194 - accuracy100: 0.5354 - val_loss: 2.8948 - val_accuracy100: 0.5603 - 54s/epoch - 34ms/step
Epoch 6/50
1577/1577 - 54s - loss: 2.7827 - accuracy100: 0.5441 - val_loss: 2.9145 - val_accuracy100: 0.5664 - 54s/epoch - 34ms/step
Epoch 7/50
1577/1577 - 54s - loss: 2.7614 - accuracy100: 0.5478 - val_loss: 2.9124 - val_accuracy100: 0.5753 - 54s/epoch - 34ms/step
Epoch 8/50
1577/1577 - 54s - loss: 2.7444 - accuracy100: 0.5533 - val_loss: 2.9356 - val_accuracy100: 0.5645 - 54s/epoch - 35ms/step
Epoch 9/50
1577/1577 - 54s - loss: 2.7337 - accuracy100: 0.5545 - val_loss: 2.9172 - val_accuracy100: 0.5662 - 54s/epoch - 34ms/step
Epoch 10/50
1577/1577 - 55s - loss: 2.7208 - accuracy100: 0.5587 - val_loss: 2.9280 - val_accuracy100: 0.5700 - 55s/epoch - 35ms/step
Epoch 11/50
1577/1577 - 53s - loss: 2.7129 - accuracy100: 0.5602 - val_loss: 2.9267 - val_accuracy100: 0.5526 - 53s/epoch - 34ms/step
Epoch 12/50
1577/1577 - 55s - loss: 2.7042 - accuracy100: 0.5616 - val_loss: 2.9105 - val_accuracy100: 0.5564 - 55s/epoch - 35ms/step
Epoch 13/50
1577/1577 - 54s - loss: 2.6946 - accuracy100: 0.5633 - val_loss: 2.8991 - val_accuracy100: 0.5534 - 54s/epoch - 34ms/step
Epoch 14/50
1577/1577 - 55s - loss: 2.6857 - accuracy100: 0.5660 - val_loss: 2.9296 - val_accuracy100: 0.5464 - 55s/epoch - 35ms/step
testing model: results/AAL/W9/deepVOL_L3/h100
Evaluating performance on  test set...
3870/3870 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0184677
{'0': {'precision': 0.4307693449784901, 'recall': 0.48155985991468736, 'f1-score': 0.4547508165052595, 'support': 240996}, '1': {'precision': 0.6832320492112927, 'recall': 0.43911340352030953, 'f1-score': 0.5346238981823938, 'support': 523079}, '2': {'precision': 0.3549067264946612, 'recall': 0.6030985381007223, 'f1-score': 0.4468529262236259, 'support': 226623}, 'accuracy': 0.48695061461716893, 'macro avg': {'precision': 0.48963604022814805, 'recall': 0.5079239338452397, 'f1-score': 0.47874254697042634, 'support': 990698}, 'weighted avg': {'precision': 0.5467135829589135, 'recall': 0.48695061461716893, 'f1-score': 0.4951163851258675, 'support': 990698}}
[[116054  54823  70119]
 [115079 229691 178309]
 [ 38278  51669 136676]]
Evaluating performance on  train set...
1577/1577 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9871993
{'0': {'precision': 0.37712768979764116, 'recall': 0.5254818132464713, 'f1-score': 0.4391129089422673, 'support': 88416}, '1': {'precision': 0.6922317122770322, 'recall': 0.4700235393132833, 'f1-score': 0.559885961339641, 'support': 228129}, '2': {'precision': 0.37918414212129425, 'recall': 0.546829184154545, 'f1-score': 0.4478314710964832, 'support': 86965}, 'accuracy': 0.49872865604322075, 'macro avg': {'precision': 0.4828478480653225, 'recall': 0.5141115122380998, 'f1-score': 0.4822767804594638, 'support': 403510}, 'weighted avg': {'precision': 0.5557185671501913, 'recall': 0.49872865604322075, 'f1-score': 0.5092723732135415, 'support': 403510}}
[[ 46461  23747  18208]
 [ 61252 107226  59651]
 [ 15484  23926  47555]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9587763
{'0': {'precision': 0.3804998159057437, 'recall': 0.5099303028433972, 'f1-score': 0.43580822856540413, 'support': 32426}, '1': {'precision': 0.7094808713889867, 'recall': 0.5254838819407436, 'f1-score': 0.6037755514155061, 'support': 88193}, '2': {'precision': 0.4003536811944575, 'recall': 0.5447595260576894, 'f1-score': 0.4615245664739885, 'support': 32831}, 'accuracy': 0.5263212772890192, 'macro avg': {'precision': 0.4967781228297293, 'recall': 0.52672457028061, 'f1-score': 0.5003694488182996, 'support': 153450}, 'weighted avg': {'precision': 0.5738243416634982, 'recall': 0.5263212772890192, 'f1-score': 0.5378469069231478, 'support': 153450}}
[[16535  9284  6607]
 [21668 46344 20181]
 [ 5253  9693 17885]]
training model: results/AAL/W9/deepVOL_L3/h200
Epoch 1/50
1577/1577 - 60s - loss: 3.2381 - accuracy200: 0.4163 - val_loss: 3.2600 - val_accuracy200: 0.4113 - 60s/epoch - 38ms/step
Epoch 2/50
1577/1577 - 59s - loss: 3.2023 - accuracy200: 0.3968 - val_loss: 3.2291 - val_accuracy200: 0.3985 - 59s/epoch - 37ms/step
Epoch 3/50
1577/1577 - 58s - loss: 3.1555 - accuracy200: 0.4261 - val_loss: 3.3008 - val_accuracy200: 0.4393 - 58s/epoch - 37ms/step
Epoch 4/50
1577/1577 - 58s - loss: 3.1126 - accuracy200: 0.4479 - val_loss: 3.2772 - val_accuracy200: 0.4258 - 58s/epoch - 37ms/step
Epoch 5/50
1577/1577 - 58s - loss: 3.0841 - accuracy200: 0.4629 - val_loss: 3.2338 - val_accuracy200: 0.4545 - 58s/epoch - 37ms/step
Epoch 6/50
1577/1577 - 58s - loss: 3.0491 - accuracy200: 0.4798 - val_loss: 3.1897 - val_accuracy200: 0.4571 - 58s/epoch - 37ms/step
Epoch 7/50
1577/1577 - 65s - loss: 3.0270 - accuracy200: 0.4865 - val_loss: 3.1885 - val_accuracy200: 0.4638 - 65s/epoch - 41ms/step
Epoch 8/50
1577/1577 - 59s - loss: 3.0078 - accuracy200: 0.4907 - val_loss: 3.1961 - val_accuracy200: 0.4704 - 59s/epoch - 37ms/step
Epoch 9/50
1577/1577 - 59s - loss: 2.9923 - accuracy200: 0.4936 - val_loss: 3.2120 - val_accuracy200: 0.4779 - 59s/epoch - 37ms/step
Epoch 10/50
1577/1577 - 58s - loss: 2.9771 - accuracy200: 0.4978 - val_loss: 3.2112 - val_accuracy200: 0.4746 - 58s/epoch - 37ms/step
Epoch 11/50
1577/1577 - 59s - loss: 2.9639 - accuracy200: 0.5018 - val_loss: 3.1915 - val_accuracy200: 0.4667 - 59s/epoch - 38ms/step
Epoch 12/50
1577/1577 - 59s - loss: 2.9539 - accuracy200: 0.5033 - val_loss: 3.2195 - val_accuracy200: 0.4599 - 59s/epoch - 38ms/step
Epoch 13/50
1577/1577 - 59s - loss: 2.9484 - accuracy200: 0.5044 - val_loss: 3.2276 - val_accuracy200: 0.4568 - 59s/epoch - 37ms/step
Epoch 14/50
1577/1577 - 58s - loss: 2.9389 - accuracy200: 0.5057 - val_loss: 3.2502 - val_accuracy200: 0.4605 - 58s/epoch - 37ms/step
Epoch 15/50
1577/1577 - 58s - loss: 2.9316 - accuracy200: 0.5071 - val_loss: 3.2714 - val_accuracy200: 0.4561 - 58s/epoch - 37ms/step
Epoch 16/50
1577/1577 - 58s - loss: 2.9221 - accuracy200: 0.5083 - val_loss: 3.2377 - val_accuracy200: 0.4445 - 58s/epoch - 37ms/step
Epoch 17/50
1577/1577 - 60s - loss: 2.9128 - accuracy200: 0.5100 - val_loss: 3.2517 - val_accuracy200: 0.4493 - 60s/epoch - 38ms/step
testing model: results/AAL/W9/deepVOL_L3/h200
Evaluating performance on  test set...
3870/3870 - 59s - 59s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0760655
{'0': {'precision': 0.4581670143425317, 'recall': 0.20529921275123067, 'f1-score': 0.28354518590984934, 'support': 309178}, '1': {'precision': 0.4877094134450731, 'recall': 0.4741012731377899, 'f1-score': 0.4808090761750405, 'support': 391081}, '2': {'precision': 0.3674781245365368, 'recall': 0.5971856396696036, 'f1-score': 0.45498269347047393, 'support': 290439}, 'accuracy': 0.4262974185877028, 'macro avg': {'precision': 0.4377848507747139, 'recall': 0.4255287085195414, 'f1-score': 0.4064456518517879, 'support': 990698}, 'weighted avg': {'precision': 0.4432420629618462, 'recall': 0.4262974185877028, 'f1-score': 0.411675350427393, 'support': 990698}}
[[ 63474 104754 140950]
 [ 48075 185412 157594]
 [ 26990  90003 173446]]
Evaluating performance on  train set...
1577/1577 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0467955
{'0': {'precision': 0.4342207177486445, 'recall': 0.26460099641639717, 'f1-score': 0.32882559958289886, 'support': 114410}, '1': {'precision': 0.5120245691196066, 'recall': 0.5371476302226869, 'f1-score': 0.524285306245823, 'support': 175987}, '2': {'precision': 0.37884963464503585, 'recall': 0.49961542881896864, 'f1-score': 0.43093147478105703, 'support': 113113}, 'accuracy': 0.44934945850164804, 'macro avg': {'precision': 0.44169830717109565, 'recall': 0.4337880184860176, 'f1-score': 0.4280141268699263, 'support': 403510}, 'weighted avg': {'precision': 0.4526323483603345, 'recall': 0.44934945850164804, 'f1-score': 0.4426960594420778, 'support': 403510}}
[[30273 46608 37529]
 [26328 94531 55128]
 [13117 43483 56513]]
Evaluating performance on  val set...
600/600 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0381463
{'0': {'precision': 0.41635674931129474, 'recall': 0.2867680193534616, 'f1-score': 0.3396205216072356, 'support': 42163}, '1': {'precision': 0.5258796122744069, 'recall': 0.5782105635046811, 'f1-score': 0.5508049136190263, 'support': 67932}, '2': {'precision': 0.3989903053220162, 'recall': 0.45754814900242186, 'f1-score': 0.4262675534258055, 'support': 43355}, 'accuracy': 0.46404040404040403, 'macro avg': {'precision': 0.4470755556359059, 'recall': 0.4408422439535215, 'f1-score': 0.4388976628840225, 'support': 153450}, 'weighted avg': {'precision': 0.45993566718457574, 'recall': 0.46404040404040403, 'f1-score': 0.45759223996917153, 'support': 153450}}
[[12091 17647 12425]
 [11197 39279 17456]
 [ 5752 17766 19837]]
training model: results/AAL/W9/deepVOL_L3/h300
Epoch 1/50
1577/1577 - 59s - loss: 3.2498 - accuracy300: 0.4052 - val_loss: 3.3674 - val_accuracy300: 0.3707 - 59s/epoch - 38ms/step
Epoch 2/50
1577/1577 - 61s - loss: 3.2214 - accuracy300: 0.4096 - val_loss: 3.2938 - val_accuracy300: 0.3826 - 61s/epoch - 39ms/step
Epoch 3/50
1577/1577 - 60s - loss: 3.1991 - accuracy300: 0.4205 - val_loss: 3.2906 - val_accuracy300: 0.3815 - 60s/epoch - 38ms/step
Epoch 4/50
1577/1577 - 63s - loss: 3.1746 - accuracy300: 0.4322 - val_loss: 3.3194 - val_accuracy300: 0.3923 - 63s/epoch - 40ms/step
Epoch 5/50
1577/1577 - 62s - loss: 3.1486 - accuracy300: 0.4436 - val_loss: 3.3036 - val_accuracy300: 0.3983 - 62s/epoch - 39ms/step
Epoch 6/50
1577/1577 - 62s - loss: 3.1261 - accuracy300: 0.4532 - val_loss: 3.3012 - val_accuracy300: 0.4027 - 62s/epoch - 39ms/step
Epoch 7/50
1577/1577 - 59s - loss: 3.1034 - accuracy300: 0.4613 - val_loss: 3.2866 - val_accuracy300: 0.4080 - 59s/epoch - 37ms/step
Epoch 8/50
1577/1577 - 58s - loss: 3.0824 - accuracy300: 0.4675 - val_loss: 3.2828 - val_accuracy300: 0.4129 - 58s/epoch - 37ms/step
Epoch 9/50
1577/1577 - 57s - loss: 3.0621 - accuracy300: 0.4725 - val_loss: 3.2743 - val_accuracy300: 0.4184 - 57s/epoch - 36ms/step
Epoch 10/50
1577/1577 - 57s - loss: 3.0446 - accuracy300: 0.4759 - val_loss: 3.3032 - val_accuracy300: 0.4118 - 57s/epoch - 36ms/step
Epoch 11/50
1577/1577 - 58s - loss: 3.0286 - accuracy300: 0.4803 - val_loss: 3.2901 - val_accuracy300: 0.4123 - 58s/epoch - 37ms/step
Epoch 12/50
1577/1577 - 58s - loss: 3.0162 - accuracy300: 0.4829 - val_loss: 3.2900 - val_accuracy300: 0.4079 - 58s/epoch - 37ms/step
Epoch 13/50
1577/1577 - 58s - loss: 3.0059 - accuracy300: 0.4851 - val_loss: 3.3042 - val_accuracy300: 0.4153 - 58s/epoch - 37ms/step
Epoch 14/50
1577/1577 - 58s - loss: 2.9924 - accuracy300: 0.4889 - val_loss: 3.3229 - val_accuracy300: 0.4059 - 58s/epoch - 36ms/step
Epoch 15/50
1577/1577 - 58s - loss: 2.9792 - accuracy300: 0.4921 - val_loss: 3.3557 - val_accuracy300: 0.4034 - 58s/epoch - 37ms/step
Epoch 16/50
1577/1577 - 58s - loss: 2.9647 - accuracy300: 0.4959 - val_loss: 3.3831 - val_accuracy300: 0.4021 - 58s/epoch - 37ms/step
Epoch 17/50
1577/1577 - 58s - loss: 2.9512 - accuracy300: 0.4997 - val_loss: 3.4693 - val_accuracy300: 0.4024 - 58s/epoch - 37ms/step
Epoch 18/50
1577/1577 - 58s - loss: 2.9398 - accuracy300: 0.5020 - val_loss: 3.4530 - val_accuracy300: 0.4021 - 58s/epoch - 37ms/step
Epoch 19/50
1577/1577 - 58s - loss: 2.9274 - accuracy300: 0.5057 - val_loss: 3.4998 - val_accuracy300: 0.3969 - 58s/epoch - 37ms/step
testing model: results/AAL/W9/deepVOL_L3/h300
Evaluating performance on  test set...
3870/3870 - 60s - 60s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0981404
{'0': {'precision': 0.4718657019575982, 'recall': 0.1240117265497859, 'f1-score': 0.19640576266151788, 'support': 346564}, '1': {'precision': 0.4081572128349934, 'recall': 0.5060861977624731, 'f1-score': 0.45187688429277195, 'support': 320890}, '2': {'precision': 0.3868508538354832, 'recall': 0.6004659019192932, 'f1-score': 0.47054958908094735, 'support': 323244}, 'accuracy': 0.40322378767293365, 'macro avg': {'precision': 0.4222912562093582, 'recall': 0.41018794207718406, 'f1-score': 0.3729440786784124, 'support': 990698}, 'weighted avg': {'precision': 0.4234917710109953, 'recall': 0.40322378767293365, 'f1-score': 0.368600997987899, 'support': 990698}}
[[ 42978 129378 174208]
 [ 25061 162398 133431]
 [ 23042 106105 194097]]
Evaluating performance on  train set...
1577/1577 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0712726
{'0': {'precision': 0.46965460699194855, 'recall': 0.1728015964482121, 'f1-score': 0.2526462206540915, 'support': 129287}, '1': {'precision': 0.43586892291163043, 'recall': 0.5488756900097413, 'f1-score': 0.48588812302754114, 'support': 147824}, '2': {'precision': 0.39842512265078833, 'recall': 0.5352020190033149, 'f1-score': 0.45679462507174445, 'support': 126399}, 'accuracy': 0.42409605709895665, 'macro avg': {'precision': 0.4346495508514558, 'recall': 0.41895976848708943, 'f1-score': 0.398442989584459, 'support': 403510}, 'weighted avg': {'precision': 0.43496483336867464, 'recall': 0.42409605709895665, 'f1-score': 0.4020425308978023, 'support': 403510}}
[[22341 56907 50039]
 [14584 81137 52103]
 [10644 48106 67649]]
Evaluating performance on  val set...
600/600 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0841591
{'0': {'precision': 0.41218116574532054, 'recall': 0.17868780087872355, 'f1-score': 0.2492997609655233, 'support': 47569}, '1': {'precision': 0.43444777863345463, 'recall': 0.5743071279377951, 'f1-score': 0.49468201712942317, 'support': 56973}, '2': {'precision': 0.40202385506137633, 'recall': 0.47276519178866444, 'f1-score': 0.4345342128507263, 'support': 48908}, 'accuracy': 0.4193027044639948, 'macro avg': {'precision': 0.41621759981338385, 'recall': 0.4085867068683944, 'f1-score': 0.39283866364855763, 'support': 153450}, 'weighted avg': {'precision': 0.4172109603699235, 'recall': 0.4193027044639948, 'f1-score': 0.39944384603054367, 'support': 153450}}
[[ 8500 21847 17222]
 [ 7083 32720 17170]
 [ 5039 20747 23122]]
training model: results/AAL/W9/deepVOL_L3/h500
Epoch 1/50
1577/1577 - 61s - loss: 3.2957 - accuracy500: 0.3752 - val_loss: 3.3876 - val_accuracy500: 0.3273 - 61s/epoch - 39ms/step
Epoch 2/50
1577/1577 - 59s - loss: 3.2759 - accuracy500: 0.3795 - val_loss: 3.3332 - val_accuracy500: 0.3347 - 59s/epoch - 37ms/step
Epoch 3/50
1577/1577 - 59s - loss: 3.2620 - accuracy500: 0.3859 - val_loss: 3.3218 - val_accuracy500: 0.3494 - 59s/epoch - 37ms/step
Epoch 4/50
1577/1577 - 58s - loss: 3.2537 - accuracy500: 0.3946 - val_loss: 3.3129 - val_accuracy500: 0.3558 - 58s/epoch - 37ms/step
Epoch 5/50
1577/1577 - 60s - loss: 3.2486 - accuracy500: 0.3954 - val_loss: 3.3606 - val_accuracy500: 0.3516 - 60s/epoch - 38ms/step
Epoch 6/50
1577/1577 - 58s - loss: 3.2416 - accuracy500: 0.3996 - val_loss: 3.3584 - val_accuracy500: 0.3492 - 58s/epoch - 37ms/step
Epoch 7/50
1577/1577 - 58s - loss: 3.2283 - accuracy500: 0.4103 - val_loss: 3.3481 - val_accuracy500: 0.3536 - 58s/epoch - 37ms/step
Epoch 8/50
1577/1577 - 58s - loss: 3.2125 - accuracy500: 0.4190 - val_loss: 3.3847 - val_accuracy500: 0.3528 - 58s/epoch - 37ms/step
Epoch 9/50
1577/1577 - 61s - loss: 3.2056 - accuracy500: 0.4229 - val_loss: 3.3939 - val_accuracy500: 0.3511 - 61s/epoch - 39ms/step
Epoch 10/50
1577/1577 - 57s - loss: 3.1924 - accuracy500: 0.4286 - val_loss: 3.4028 - val_accuracy500: 0.3517 - 57s/epoch - 36ms/step
Epoch 11/50
1577/1577 - 61s - loss: 3.1790 - accuracy500: 0.4353 - val_loss: 3.4161 - val_accuracy500: 0.3547 - 61s/epoch - 38ms/step
Epoch 12/50
1577/1577 - 57s - loss: 3.1677 - accuracy500: 0.4387 - val_loss: 3.4378 - val_accuracy500: 0.3541 - 57s/epoch - 36ms/step
Epoch 13/50
1577/1577 - 57s - loss: 3.1579 - accuracy500: 0.4421 - val_loss: 3.4076 - val_accuracy500: 0.3501 - 57s/epoch - 36ms/step
Epoch 14/50
1577/1577 - 58s - loss: 3.1438 - accuracy500: 0.4484 - val_loss: 3.4233 - val_accuracy500: 0.3519 - 58s/epoch - 37ms/step
testing model: results/AAL/W9/deepVOL_L3/h500
Evaluating performance on  test set...
3870/3870 - 62s - 62s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1009672
{'0': {'precision': 0.36303216279337686, 'recall': 0.5124916835459882, 'f1-score': 0.42500490436488475, 'support': 338185}, '1': {'precision': 0.34869393790044356, 'recall': 0.05042031778459419, 'f1-score': 0.08810138404264978, 'support': 336769}, '2': {'precision': 0.35264439168551853, 'recall': 0.5188823857302118, 'f1-score': 0.41990898733998777, 'support': 315744}, 'accuracy': 0.3574560562350989, 'macro avg': {'precision': 0.3547901641264463, 'recall': 0.3605981290202647, 'f1-score': 0.31100509191584075, 'support': 990698}, 'weighted avg': {'precision': 0.3548474828408102, 'recall': 0.3574560562350989, 'f1-score': 0.30885682809895115, 'support': 990698}}
[[173317  16086 148782]
 [167818  16980 151971]
 [136280  15630 163834]]
Evaluating performance on  train set...
1577/1577 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0939418
{'0': {'precision': 0.3778114433558903, 'recall': 0.6037495077950678, 'f1-score': 0.46477699158262864, 'support': 137138}, '1': {'precision': 0.33232190571079206, 'recall': 0.05544054760573596, 'f1-score': 0.09502781033288224, 'support': 132358}, '2': {'precision': 0.3833374414592063, 'recall': 0.4641903084752339, 'f1-score': 0.4199072542812206, 'support': 134014}, 'accuracy': 0.3775445466035538, 'macro avg': {'precision': 0.36449026350862956, 'recall': 0.3744601212920125, 'f1-score': 0.3265706853989105, 'support': 403510}, 'weighted avg': {'precision': 0.36472541546609294, 'recall': 0.3775445466035538, 'f1-score': 0.3285909364500053, 'support': 403510}}
[[82797  7172 47169]
 [72117  7338 52903]
 [64235  7571 62208]]
Evaluating performance on  val set...
600/600 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.103238
{'0': {'precision': 0.34351921713880695, 'recall': 0.599924133524996, 'f1-score': 0.43687937075645894, 'support': 50088}, '1': {'precision': 0.34297769740807715, 'recall': 0.04399682975391931, 'f1-score': 0.07798927476142341, 'support': 51731}, '2': {'precision': 0.37861476238624875, 'recall': 0.43514555209079814, 'f1-score': 0.4049165998323886, 'support': 51631}, 'accuracy': 0.3570674486803519, 'macro avg': {'precision': 0.3550372256443776, 'recall': 0.3596888384565711, 'f1-score': 0.30659508178342365, 'support': 153450}, 'weighted avg': {'precision': 0.35514518481218776, 'recall': 0.3570674486803519, 'f1-score': 0.3051360447121457, 'support': 153450}}
[[30049  2040 17999]
 [30581  2276 18874]
 [26844  2320 22467]]
training model: results/AAL/W9/deepVOL_L3/h1000
Epoch 1/50
1577/1577 - 61s - loss: 3.2105 - accuracy1000: 0.4281 - val_loss: 3.3698 - val_accuracy1000: 0.3240 - 61s/epoch - 39ms/step
Epoch 2/50
1577/1577 - 60s - loss: 3.2211 - accuracy1000: 0.4204 - val_loss: 3.4046 - val_accuracy1000: 0.3289 - 60s/epoch - 38ms/step
Epoch 3/50
1577/1577 - 59s - loss: 3.2047 - accuracy1000: 0.4292 - val_loss: 3.4005 - val_accuracy1000: 0.3336 - 59s/epoch - 37ms/step
Epoch 4/50
1577/1577 - 58s - loss: 3.1942 - accuracy1000: 0.4354 - val_loss: 3.4138 - val_accuracy1000: 0.3316 - 58s/epoch - 37ms/step
Epoch 5/50
1577/1577 - 56s - loss: 3.1784 - accuracy1000: 0.4415 - val_loss: 3.3960 - val_accuracy1000: 0.3306 - 56s/epoch - 36ms/step
Epoch 6/50
1577/1577 - 56s - loss: 3.1887 - accuracy1000: 0.4397 - val_loss: 3.3986 - val_accuracy1000: 0.3290 - 56s/epoch - 36ms/step
Epoch 7/50
1577/1577 - 58s - loss: 3.1961 - accuracy1000: 0.4363 - val_loss: 3.3944 - val_accuracy1000: 0.3318 - 58s/epoch - 37ms/step
Epoch 8/50
1577/1577 - 56s - loss: 3.1876 - accuracy1000: 0.4372 - val_loss: 3.4234 - val_accuracy1000: 0.3319 - 56s/epoch - 35ms/step
Epoch 9/50
1577/1577 - 55s - loss: 3.1917 - accuracy1000: 0.4361 - val_loss: 3.4054 - val_accuracy1000: 0.3358 - 55s/epoch - 35ms/step
Epoch 10/50
1577/1577 - 56s - loss: 3.1797 - accuracy1000: 0.4420 - val_loss: 3.4266 - val_accuracy1000: 0.3385 - 56s/epoch - 35ms/step
Epoch 11/50
1577/1577 - 56s - loss: 3.1587 - accuracy1000: 0.4514 - val_loss: 3.4073 - val_accuracy1000: 0.3282 - 56s/epoch - 35ms/step
testing model: results/AAL/W9/deepVOL_L3/h1000
Evaluating performance on  test set...
3870/3870 - 55s - 55s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.14653
{'0': {'precision': 0.2682548735026473, 'recall': 0.8195514977356637, 'f1-score': 0.4042055446020591, 'support': 274915}, '1': {'precision': 0.49056603773584906, 'recall': 0.0001091577013907111, 'f1-score': 0.0002182668354037202, 'support': 476375}, '2': {'precision': 0.26247403661749386, 'recall': 0.16521168883245338, 'f1-score': 0.20278338173960078, 'support': 239408}, 'accuracy': 0.26739934874199806, 'macro avg': {'precision': 0.3404316492853301, 'recall': 0.3282907814231693, 'f1-score': 0.20240239772568788, 'support': 990698}, 'weighted avg': {'precision': 0.3737557448727224, 'recall': 0.26739934874199806, 'f1-score': 0.16127428137889133, 'support': 990698}}
[[225307     31  49577]
 [414760     52  61563]
 [199832     23  39553]]
Evaluating performance on  train set...
1577/1577 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1157949
{'0': {'precision': 0.3384084196513998, 'recall': 0.8433610035322082, 'f1-score': 0.4830053287926563, 'support': 135043}, '1': {'precision': 0.3157894736842105, 'recall': 0.00013012832098319177, 'f1-score': 0.0002601494414013383, 'support': 138325}, '2': {'precision': 0.3546714095685055, 'recall': 0.18233929092837056, 'f1-score': 0.24085379778633742, 'support': 130142}, 'accuracy': 0.3411018314292087, 'macro avg': {'precision': 0.33628976763470525, 'recall': 0.3419434742605207, 'f1-score': 0.24137309200679835, 'support': 403510}, 'weighted avg': {'precision': 0.3358997639374906, 'recall': 0.3411018314292087, 'f1-score': 0.23941827647180505, 'support': 403510}}
[[113890     20  21133]
 [116263     18  22044]
 [106393     19  23730]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.122461
{'0': {'precision': 0.3224977684635386, 'recall': 0.8212725583601826, 'f1-score': 0.46313243342659366, 'support': 50591}, '1': {'precision': 0.16666666666666666, 'recall': 7.880531147799361e-05, 'f1-score': 0.00015753613485093142, 'support': 50758}, '2': {'precision': 0.33121873856288886, 'recall': 0.15633097253411643, 'f1-score': 0.212408073853857, 'support': 52101}, 'accuracy': 0.32387096774193547, 'macro avg': {'precision': 0.27346105789769803, 'recall': 0.32589411206859237, 'f1-score': 0.22523268113843387, 'support': 153450}, 'weighted avg': {'precision': 0.2739131884579382, 'recall': 0.32387096774193547, 'f1-score': 0.22486153284116892, 'support': 153450}}
[[41549    11  9031]
 [43339     4  7415]
 [43947     9  8145]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        21 (peak)  15.29 (ave)

============================================
