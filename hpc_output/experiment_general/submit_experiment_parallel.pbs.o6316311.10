This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/LILAK_orderbooks/LILAK_orderbooks_2019-03-13.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-03-05.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-02-20.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-02-21.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-03-01.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-02-25.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-02-27.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-02-22.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-03-15.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-02-26.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-03-11.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-02-28.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-02-19.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-03-07.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-03-06.csv
training model: results/LILAK/W1/deepLOB_L1/h10
Epoch 1/50
260/260 - 19s - loss: 3.3190 - accuracy10: 0.3601 - val_loss: 3.3724 - val_accuracy10: 0.3570 - 19s/epoch - 72ms/step
Epoch 2/50
260/260 - 7s - loss: 3.2676 - accuracy10: 0.3550 - val_loss: 3.3149 - val_accuracy10: 0.3813 - 7s/epoch - 29ms/step
Epoch 3/50
260/260 - 7s - loss: 3.2423 - accuracy10: 0.3693 - val_loss: 3.2563 - val_accuracy10: 0.4262 - 7s/epoch - 28ms/step
Epoch 4/50
260/260 - 7s - loss: 3.2151 - accuracy10: 0.3814 - val_loss: 3.2444 - val_accuracy10: 0.4157 - 7s/epoch - 28ms/step
Epoch 5/50
260/260 - 7s - loss: 3.1976 - accuracy10: 0.3971 - val_loss: 3.2294 - val_accuracy10: 0.4118 - 7s/epoch - 27ms/step
Epoch 6/50
260/260 - 7s - loss: 3.1827 - accuracy10: 0.4090 - val_loss: 3.2198 - val_accuracy10: 0.3999 - 7s/epoch - 28ms/step
Epoch 7/50
260/260 - 7s - loss: 3.1694 - accuracy10: 0.4209 - val_loss: 3.2134 - val_accuracy10: 0.4259 - 7s/epoch - 27ms/step
Epoch 8/50
260/260 - 7s - loss: 3.1573 - accuracy10: 0.4296 - val_loss: 3.2126 - val_accuracy10: 0.4111 - 7s/epoch - 28ms/step
Epoch 9/50
260/260 - 7s - loss: 3.1514 - accuracy10: 0.4352 - val_loss: 3.2101 - val_accuracy10: 0.4268 - 7s/epoch - 28ms/step
Epoch 10/50
260/260 - 7s - loss: 3.1415 - accuracy10: 0.4401 - val_loss: 3.2073 - val_accuracy10: 0.4282 - 7s/epoch - 28ms/step
Epoch 11/50
260/260 - 7s - loss: 3.1371 - accuracy10: 0.4437 - val_loss: 3.1940 - val_accuracy10: 0.3959 - 7s/epoch - 28ms/step
Epoch 12/50
260/260 - 7s - loss: 3.1309 - accuracy10: 0.4483 - val_loss: 3.2062 - val_accuracy10: 0.4269 - 7s/epoch - 28ms/step
Epoch 13/50
260/260 - 7s - loss: 3.1282 - accuracy10: 0.4483 - val_loss: 3.1973 - val_accuracy10: 0.4295 - 7s/epoch - 27ms/step
Epoch 14/50
260/260 - 7s - loss: 3.1209 - accuracy10: 0.4543 - val_loss: 3.1940 - val_accuracy10: 0.4305 - 7s/epoch - 28ms/step
Epoch 15/50
260/260 - 7s - loss: 3.1130 - accuracy10: 0.4595 - val_loss: 3.1921 - val_accuracy10: 0.4277 - 7s/epoch - 28ms/step
Epoch 16/50
260/260 - 7s - loss: 3.1080 - accuracy10: 0.4595 - val_loss: 3.2024 - val_accuracy10: 0.4212 - 7s/epoch - 26ms/step
Epoch 17/50
260/260 - 7s - loss: 3.1050 - accuracy10: 0.4600 - val_loss: 3.2024 - val_accuracy10: 0.4466 - 7s/epoch - 27ms/step
Epoch 18/50
260/260 - 7s - loss: 3.1016 - accuracy10: 0.4633 - val_loss: 3.2028 - val_accuracy10: 0.4306 - 7s/epoch - 28ms/step
Epoch 19/50
260/260 - 7s - loss: 3.0965 - accuracy10: 0.4637 - val_loss: 3.2039 - val_accuracy10: 0.4332 - 7s/epoch - 29ms/step
Epoch 20/50
260/260 - 7s - loss: 3.0927 - accuracy10: 0.4654 - val_loss: 3.2059 - val_accuracy10: 0.4331 - 7s/epoch - 29ms/step
Epoch 21/50
260/260 - 8s - loss: 3.0900 - accuracy10: 0.4650 - val_loss: 3.2068 - val_accuracy10: 0.4301 - 8s/epoch - 29ms/step
Epoch 22/50
260/260 - 7s - loss: 3.0859 - accuracy10: 0.4666 - val_loss: 3.2181 - val_accuracy10: 0.4603 - 7s/epoch - 29ms/step
Epoch 23/50
260/260 - 8s - loss: 3.0833 - accuracy10: 0.4673 - val_loss: 3.2070 - val_accuracy10: 0.4372 - 8s/epoch - 29ms/step
Epoch 24/50
260/260 - 7s - loss: 3.0794 - accuracy10: 0.4706 - val_loss: 3.2246 - val_accuracy10: 0.4451 - 7s/epoch - 28ms/step
Epoch 25/50
260/260 - 8s - loss: 3.0792 - accuracy10: 0.4689 - val_loss: 3.2264 - val_accuracy10: 0.4213 - 8s/epoch - 29ms/step
testing model: results/LILAK/W1/deepLOB_L1/h10
Evaluating performance on  test set...
663/663 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0768466
{'0': {'precision': 0.38630981707220163, 'recall': 0.4696732556566769, 'f1-score': 0.42393219038317315, 'support': 51753}, '1': {'precision': 0.4645983546377003, 'recall': 0.3709900484050389, 'f1-score': 0.41255088138681556, 'support': 66522}, '2': {'precision': 0.371439755442887, 'recall': 0.3875867971135705, 'f1-score': 0.37934152539952987, 'support': 51413}, 'accuracy': 0.4061159304134647, 'macro avg': {'precision': 0.40744930905092963, 'recall': 0.4094167003917621, 'f1-score': 0.40527486572317284, 'support': 169688}, 'weighted avg': {'precision': 0.41249549677485675, 'recall': 0.4061159304134647, 'f1-score': 0.40596010457946424, 'support': 169688}}
[[24307 14098 13348]
 [21470 24679 20373]
 [17144 14342 19927]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0475019
{'0': {'precision': 0.33751995295303705, 'recall': 0.5022502812851607, 'f1-score': 0.4037282685157271, 'support': 15998}, '1': {'precision': 0.6007842820181113, 'recall': 0.44018245905038356, 'f1-score': 0.508094432193104, 'support': 33761}, '2': {'precision': 0.3652744563706134, 'recall': 0.3917919350990217, 'f1-score': 0.3780687868758094, 'support': 16764}, 'accuracy': 0.44291448070592127, 'macro avg': {'precision': 0.4345262304472539, 'recall': 0.44474155847818864, 'f1-score': 0.4299638291948802, 'support': 66523}, 'weighted avg': {'precision': 0.4781231053793891, 'recall': 0.44291448070592127, 'f1-score': 0.4502287345455265, 'support': 66523}}
[[ 8035  4618  3345]
 [10832 14861  8068]
 [ 4939  5257  6568]]
Evaluating performance on  val set...
51/51 - 1s - 908ms/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0546433
{'0': {'precision': 0.3333333333333333, 'recall': 0.44349747474747475, 'f1-score': 0.3806040904781254, 'support': 3168}, '1': {'precision': 0.5726703052354962, 'recall': 0.43232107431710665, 'f1-score': 0.49269565217391303, 'support': 6553}, '2': {'precision': 0.33134328358208953, 'recall': 0.390595009596929, 'f1-score': 0.35853765966818374, 'support': 3126}, 'accuracy': 0.4249241067953608, 'macro avg': {'precision': 0.41244897405030634, 'recall': 0.42213785288717015, 'f1-score': 0.410612467440074, 'support': 12847}, 'weighted avg': {'precision': 0.45493014825919037, 'recall': 0.4249241067953608, 'f1-score': 0.43241045313716014, 'support': 12847}}
[[1405 1044  719]
 [1975 2833 1745]
 [ 835 1070 1221]]
training model: results/LILAK/W1/deepLOB_L1/h20
Epoch 1/50
260/260 - 9s - loss: 3.3243 - accuracy20: 0.3635 - val_loss: 3.3635 - val_accuracy20: 0.3497 - 9s/epoch - 33ms/step
Epoch 2/50
260/260 - 7s - loss: 3.2855 - accuracy20: 0.3694 - val_loss: 3.3134 - val_accuracy20: 0.3595 - 7s/epoch - 27ms/step
Epoch 3/50
260/260 - 7s - loss: 3.2718 - accuracy20: 0.3756 - val_loss: 3.2684 - val_accuracy20: 0.3872 - 7s/epoch - 28ms/step
Epoch 4/50
260/260 - 7s - loss: 3.2496 - accuracy20: 0.3876 - val_loss: 3.2766 - val_accuracy20: 0.3771 - 7s/epoch - 27ms/step
Epoch 5/50
260/260 - 7s - loss: 3.2382 - accuracy20: 0.3922 - val_loss: 3.2849 - val_accuracy20: 0.3737 - 7s/epoch - 27ms/step
Epoch 6/50
260/260 - 7s - loss: 3.2273 - accuracy20: 0.4016 - val_loss: 3.2758 - val_accuracy20: 0.3940 - 7s/epoch - 28ms/step
Epoch 7/50
260/260 - 7s - loss: 3.2202 - accuracy20: 0.4042 - val_loss: 3.2669 - val_accuracy20: 0.3769 - 7s/epoch - 28ms/step
Epoch 8/50
260/260 - 7s - loss: 3.2091 - accuracy20: 0.4165 - val_loss: 3.2489 - val_accuracy20: 0.3978 - 7s/epoch - 28ms/step
Epoch 9/50
260/260 - 7s - loss: 3.1999 - accuracy20: 0.4236 - val_loss: 3.2642 - val_accuracy20: 0.3889 - 7s/epoch - 28ms/step
Epoch 10/50
260/260 - 7s - loss: 3.1966 - accuracy20: 0.4254 - val_loss: 3.2569 - val_accuracy20: 0.3921 - 7s/epoch - 26ms/step
Epoch 11/50
260/260 - 7s - loss: 3.1849 - accuracy20: 0.4357 - val_loss: 3.2614 - val_accuracy20: 0.4039 - 7s/epoch - 27ms/step
Epoch 12/50
260/260 - 7s - loss: 3.1782 - accuracy20: 0.4372 - val_loss: 3.2783 - val_accuracy20: 0.3986 - 7s/epoch - 28ms/step
Epoch 13/50
260/260 - 7s - loss: 3.1742 - accuracy20: 0.4377 - val_loss: 3.2707 - val_accuracy20: 0.3992 - 7s/epoch - 27ms/step
Epoch 14/50
260/260 - 7s - loss: 3.1686 - accuracy20: 0.4431 - val_loss: 3.2673 - val_accuracy20: 0.3992 - 7s/epoch - 29ms/step
Epoch 15/50
260/260 - 7s - loss: 3.1617 - accuracy20: 0.4473 - val_loss: 3.2728 - val_accuracy20: 0.3993 - 7s/epoch - 28ms/step
Epoch 16/50
260/260 - 7s - loss: 3.1582 - accuracy20: 0.4480 - val_loss: 3.2664 - val_accuracy20: 0.4046 - 7s/epoch - 27ms/step
Epoch 17/50
260/260 - 7s - loss: 3.1523 - accuracy20: 0.4508 - val_loss: 3.2667 - val_accuracy20: 0.4122 - 7s/epoch - 28ms/step
Epoch 18/50
260/260 - 7s - loss: 3.1485 - accuracy20: 0.4524 - val_loss: 3.2847 - val_accuracy20: 0.4052 - 7s/epoch - 28ms/step
testing model: results/LILAK/W1/deepLOB_L1/h20
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0993247
{'0': {'precision': 0.4065634595701126, 'recall': 0.5266411442019258, 'f1-score': 0.4588769594004289, 'support': 60339}, '1': {'precision': 0.33139376924470204, 'recall': 0.29629554655870444, 'f1-score': 0.31286337209302323, 'support': 49400}, '2': {'precision': 0.3874366554054054, 'recall': 0.30607683197384444, 'f1-score': 0.3419843629145738, 'support': 59949}, 'accuracy': 0.38165928056197257, 'macro avg': {'precision': 0.37513129474007334, 'recall': 0.37633784091149153, 'f1-score': 0.3712415648026753, 'support': 169688}, 'weighted avg': {'precision': 0.37792256872959756, 'recall': 0.38165928056197257, 'f1-score': 0.37507217957088074, 'support': 169688}}
[[31777 13242 15320]
 [21072 14637 13691]
 [25311 16289 18349]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0780602
{'0': {'precision': 0.3565123515590271, 'recall': 0.5737646277275282, 'f1-score': 0.4397704796036269, 'support': 19569}, '1': {'precision': 0.4395415248601494, 'recall': 0.4277447845287041, 'f1-score': 0.4335629256622484, 'support': 26268}, '2': {'precision': 0.4369321783224171, 'recall': 0.19994198975152278, 'f1-score': 0.27434332714247817, 'support': 20686}, 'accuracy': 0.39986170196774046, 'macro avg': {'precision': 0.4109953515805312, 'recall': 0.4004838006692517, 'f1-score': 0.3825589108027845, 'support': 66523}, 'weighted avg': {'precision': 0.414305518744833, 'recall': 0.39986170196774046, 'f1-score': 0.385878049876413, 'support': 66523}}
[[11228  6172  2169]
 [11871 11236  3161]
 [ 8395  8155  4136]]
Evaluating performance on  val set...
51/51 - 1s - 958ms/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0809474
{'0': {'precision': 0.3726301275422268, 'recall': 0.5523760858456822, 'f1-score': 0.4450391107451626, 'support': 3914}, '1': {'precision': 0.43534303534303537, 'recall': 0.40565672220069743, 'f1-score': 0.41997593261131166, 'support': 5162}, '2': {'precision': 0.39149888143176736, 'recall': 0.23203394325112703, 'f1-score': 0.2913752913752914, 'support': 3771}, 'accuracy': 0.3993928543628863, 'macro avg': {'precision': 0.39982401477234325, 'recall': 0.3966889170991689, 'f1-score': 0.38546344491058854, 'support': 12847}, 'weighted avg': {'precision': 0.4033671167992698, 'recall': 0.3993928543628863, 'f1-score': 0.38986339747586063, 'support': 12847}}
[[2162 1301  451]
 [2159 2094  909]
 [1481 1415  875]]
training model: results/LILAK/W1/deepLOB_L1/h30
Epoch 1/50
260/260 - 9s - loss: 3.3251 - accuracy30: 0.3637 - val_loss: 3.3686 - val_accuracy30: 0.3307 - 9s/epoch - 36ms/step
Epoch 2/50
260/260 - 7s - loss: 3.2977 - accuracy30: 0.3713 - val_loss: 3.3641 - val_accuracy30: 0.3442 - 7s/epoch - 27ms/step
Epoch 3/50
260/260 - 7s - loss: 3.2706 - accuracy30: 0.3875 - val_loss: 3.3372 - val_accuracy30: 0.3542 - 7s/epoch - 28ms/step
Epoch 4/50
260/260 - 7s - loss: 3.2612 - accuracy30: 0.3953 - val_loss: 3.3128 - val_accuracy30: 0.3634 - 7s/epoch - 28ms/step
Epoch 5/50
260/260 - 7s - loss: 3.2494 - accuracy30: 0.4010 - val_loss: 3.3035 - val_accuracy30: 0.3503 - 7s/epoch - 28ms/step
Epoch 6/50
260/260 - 7s - loss: 3.2356 - accuracy30: 0.4097 - val_loss: 3.2882 - val_accuracy30: 0.3773 - 7s/epoch - 27ms/step
Epoch 7/50
260/260 - 7s - loss: 3.2328 - accuracy30: 0.4118 - val_loss: 3.2749 - val_accuracy30: 0.3823 - 7s/epoch - 28ms/step
Epoch 8/50
260/260 - 7s - loss: 3.2246 - accuracy30: 0.4176 - val_loss: 3.3193 - val_accuracy30: 0.3630 - 7s/epoch - 27ms/step
Epoch 9/50
260/260 - 7s - loss: 3.2185 - accuracy30: 0.4205 - val_loss: 3.3101 - val_accuracy30: 0.3636 - 7s/epoch - 28ms/step
Epoch 10/50
260/260 - 7s - loss: 3.2085 - accuracy30: 0.4268 - val_loss: 3.3156 - val_accuracy30: 0.3662 - 7s/epoch - 28ms/step
Epoch 11/50
260/260 - 7s - loss: 3.2030 - accuracy30: 0.4281 - val_loss: 3.3256 - val_accuracy30: 0.3645 - 7s/epoch - 28ms/step
Epoch 12/50
260/260 - 7s - loss: 3.1976 - accuracy30: 0.4303 - val_loss: 3.3257 - val_accuracy30: 0.3655 - 7s/epoch - 28ms/step
Epoch 13/50
260/260 - 7s - loss: 3.1924 - accuracy30: 0.4335 - val_loss: 3.3211 - val_accuracy30: 0.3730 - 7s/epoch - 28ms/step
Epoch 14/50
260/260 - 7s - loss: 3.1881 - accuracy30: 0.4365 - val_loss: 3.3207 - val_accuracy30: 0.3643 - 7s/epoch - 27ms/step
Epoch 15/50
260/260 - 7s - loss: 3.1828 - accuracy30: 0.4364 - val_loss: 3.3008 - val_accuracy30: 0.3779 - 7s/epoch - 29ms/step
Epoch 16/50
260/260 - 7s - loss: 3.1770 - accuracy30: 0.4415 - val_loss: 3.3364 - val_accuracy30: 0.3686 - 7s/epoch - 28ms/step
Epoch 17/50
260/260 - 8s - loss: 3.1772 - accuracy30: 0.4392 - val_loss: 3.3120 - val_accuracy30: 0.3734 - 8s/epoch - 29ms/step
testing model: results/LILAK/W1/deepLOB_L1/h30
Evaluating performance on  test set...
663/663 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1220607
{'0': {'precision': 0.43047751697503994, 'recall': 0.4173969091941499, 'f1-score': 0.423836312352932, 'support': 65161}, '1': {'precision': 0.25588691991227647, 'recall': 0.4025738534767169, 'f1-score': 0.312891481365487, 'support': 39707}, '2': {'precision': 0.4023116399473182, 'recall': 0.2733261339092873, 'f1-score': 0.3255066233074281, 'support': 64820}, 'accuracy': 0.35889397010984864, 'macro avg': {'precision': 0.3628920256115449, 'recall': 0.3644322988600514, 'f1-score': 0.3540781390086157, 'support': 169688}, 'weighted avg': {'precision': 0.3788640794514197, 'recall': 0.35889397010984864, 'f1-score': 0.36031374830628143, 'support': 169688}}
[[27198 21895 16068]
 [13469 15985 10253]
 [22514 24589 17717]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1034205
{'0': {'precision': 0.3810505067496531, 'recall': 0.4144634525660964, 'f1-score': 0.39705527924453893, 'support': 21862}, '1': {'precision': 0.34057019463655197, 'recall': 0.5395746648173833, 'f1-score': 0.41757455410651356, 'support': 21630}, '2': {'precision': 0.44365781710914454, 'recall': 0.16325821718553254, 'f1-score': 0.2386846949787342, 'support': 23031}, 'accuracy': 0.3681734137065376, 'macro avg': {'precision': 0.3884261728317832, 'recall': 0.37243211152300404, 'f1-score': 0.35110484277659554, 'support': 66523}, 'weighted avg': {'precision': 0.389563649781132, 'recall': 0.3681734137065376, 'f1-score': 0.3488974840314361, 'support': 66523}}
[[ 9061 10476  2325]
 [ 7569 11671  2390]
 [ 7149 12122  3760]]
Evaluating performance on  val set...
51/51 - 1s - 984ms/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.093064
{'0': {'precision': 0.41978425522148266, 'recall': 0.4218173431734317, 'f1-score': 0.42079834349476597, 'support': 4336}, '1': {'precision': 0.3528481012658228, 'recall': 0.5159648310967145, 'f1-score': 0.4190941552339786, 'support': 4322}, '2': {'precision': 0.39493087557603684, 'recall': 0.20458343280019098, 'f1-score': 0.2695392357288882, 'support': 4189}, 'accuracy': 0.3826574297501362, 'macro avg': {'precision': 0.38918774402111406, 'recall': 0.3807885356901124, 'f1-score': 0.36981057815254426, 'support': 12847}, 'weighted avg': {'precision': 0.38916163011592225, 'recall': 0.3826574297501362, 'f1-score': 0.3709042122505545, 'support': 12847}}
[[1829 1947  560]
 [1339 2230  753]
 [1189 2143  857]]
training model: results/LILAK/W1/deepLOB_L1/h50
Epoch 1/50
260/260 - 9s - loss: 3.3390 - accuracy50: 0.3549 - val_loss: 3.3383 - val_accuracy50: 0.3740 - 9s/epoch - 36ms/step
Epoch 2/50
260/260 - 7s - loss: 3.3108 - accuracy50: 0.3598 - val_loss: 3.2850 - val_accuracy50: 0.3740 - 7s/epoch - 27ms/step
Epoch 3/50
260/260 - 7s - loss: 3.2847 - accuracy50: 0.3757 - val_loss: 3.2938 - val_accuracy50: 0.3706 - 7s/epoch - 27ms/step
Epoch 4/50
260/260 - 7s - loss: 3.2775 - accuracy50: 0.3791 - val_loss: 3.2762 - val_accuracy50: 0.3834 - 7s/epoch - 26ms/step
Epoch 5/50
260/260 - 7s - loss: 3.2726 - accuracy50: 0.3812 - val_loss: 3.2697 - val_accuracy50: 0.3875 - 7s/epoch - 26ms/step
Epoch 6/50
260/260 - 7s - loss: 3.2593 - accuracy50: 0.3914 - val_loss: 3.2799 - val_accuracy50: 0.3798 - 7s/epoch - 27ms/step
Epoch 7/50
260/260 - 7s - loss: 3.2523 - accuracy50: 0.3964 - val_loss: 3.2735 - val_accuracy50: 0.3758 - 7s/epoch - 27ms/step
Epoch 8/50
260/260 - 7s - loss: 3.2468 - accuracy50: 0.4024 - val_loss: 3.2648 - val_accuracy50: 0.3861 - 7s/epoch - 27ms/step
Epoch 9/50
260/260 - 7s - loss: 3.2416 - accuracy50: 0.4052 - val_loss: 3.2797 - val_accuracy50: 0.3752 - 7s/epoch - 26ms/step
Epoch 10/50
260/260 - 7s - loss: 3.2381 - accuracy50: 0.4073 - val_loss: 3.2901 - val_accuracy50: 0.3669 - 7s/epoch - 28ms/step
Epoch 11/50
260/260 - 8s - loss: 3.2354 - accuracy50: 0.4082 - val_loss: 3.2937 - val_accuracy50: 0.3718 - 8s/epoch - 29ms/step
Epoch 12/50
260/260 - 8s - loss: 3.2284 - accuracy50: 0.4130 - val_loss: 3.2942 - val_accuracy50: 0.3716 - 8s/epoch - 30ms/step
Epoch 13/50
260/260 - 7s - loss: 3.2234 - accuracy50: 0.4153 - val_loss: 3.2939 - val_accuracy50: 0.3710 - 7s/epoch - 29ms/step
Epoch 14/50
260/260 - 8s - loss: 3.2207 - accuracy50: 0.4147 - val_loss: 3.2918 - val_accuracy50: 0.3747 - 8s/epoch - 29ms/step
Epoch 15/50
260/260 - 8s - loss: 3.2138 - accuracy50: 0.4208 - val_loss: 3.2970 - val_accuracy50: 0.3743 - 8s/epoch - 29ms/step
Epoch 16/50
260/260 - 8s - loss: 3.2119 - accuracy50: 0.4177 - val_loss: 3.2928 - val_accuracy50: 0.3791 - 8s/epoch - 29ms/step
Epoch 17/50
260/260 - 7s - loss: 3.2108 - accuracy50: 0.4202 - val_loss: 3.3012 - val_accuracy50: 0.3700 - 7s/epoch - 28ms/step
Epoch 18/50
260/260 - 7s - loss: 3.2056 - accuracy50: 0.4247 - val_loss: 3.2877 - val_accuracy50: 0.3862 - 7s/epoch - 27ms/step
testing model: results/LILAK/W1/deepLOB_L1/h50
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.11167
{'0': {'precision': 0.39753078387039054, 'recall': 0.40276541744948746, 'f1-score': 0.40013098113053086, 'support': 60678}, '1': {'precision': 0.29644792717546864, 'recall': 0.5216323329067415, 'f1-score': 0.3780480507435, 'support': 48446}, '2': {'precision': 0.3996951883300675, 'recall': 0.15155868172511724, 'f1-score': 0.2197799566617582, 'support': 60564}, 'accuracy': 0.34704280797699305, 'macro avg': {'precision': 0.36455796645864225, 'recall': 0.35865214402711537, 'f1-score': 0.3326529961785964, 'support': 169688}, 'weighted avg': {'precision': 0.36944408897301234, 'recall': 0.34704280797699305, 'f1-score': 0.3294565133340052, 'support': 169688}}
[[24439 28776  7463]
 [16852 25271  6323]
 [20186 31199  9179]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0975673
{'0': {'precision': 0.3947416636130451, 'recall': 0.39532110091743117, 'f1-score': 0.395031169783645, 'support': 21800}, '1': {'precision': 0.3436232418479692, 'recall': 0.5937286670004096, 'f1-score': 0.43530923105156905, 'support': 21973}, '2': {'precision': 0.45561338289962827, 'recall': 0.1346813186813187, 'f1-score': 0.2079050042408821, 'support': 22750}, 'accuracy': 0.3717210588818905, 'macro avg': {'precision': 0.39799276278688084, 'recall': 0.3745770288663865, 'f1-score': 0.346081801692032, 'support': 66523}, 'weighted avg': {'precision': 0.3986742362920547, 'recall': 0.3717210588818905, 'f1-score': 0.34434057516437405, 'support': 66523}}
[[ 8618 11463  1719]
 [ 6985 13046  1942]
 [ 6229 13457  3064]]
Evaluating performance on  val set...
51/51 - 1s - 959ms/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0877013
{'0': {'precision': 0.39404553415061294, 'recall': 0.4402054292002935, 'f1-score': 0.4158484463439991, 'support': 4089}, '1': {'precision': 0.3926083866382374, 'recall': 0.5669129720853858, 'f1-score': 0.4639287813890988, 'support': 4872}, '2': {'precision': 0.36012861736334406, 'recall': 0.1152856407617087, 'f1-score': 0.1746588693957115, 'support': 3886}, 'accuracy': 0.38997431306919905, 'macro avg': {'precision': 0.38226084605073146, 'recall': 0.37413468068246264, 'f1-score': 0.35147869904293644, 'support': 12847}, 'weighted avg': {'precision': 0.3832412279845337, 'recall': 0.38997431306919905, 'f1-score': 0.3611263085934488, 'support': 12847}}
[[1800 2034  255]
 [1569 2762  541]
 [1199 2239  448]]
training model: results/LILAK/W1/deepLOB_L1/h100
Epoch 1/50
260/260 - 9s - loss: 3.3203 - accuracy100: 0.3705 - val_loss: 3.2236 - val_accuracy100: 0.4614 - 9s/epoch - 34ms/step
Epoch 2/50
260/260 - 7s - loss: 3.2940 - accuracy100: 0.3815 - val_loss: 3.2091 - val_accuracy100: 0.4389 - 7s/epoch - 27ms/step
Epoch 3/50
260/260 - 7s - loss: 3.2800 - accuracy100: 0.3874 - val_loss: 3.1941 - val_accuracy100: 0.4679 - 7s/epoch - 28ms/step
Epoch 4/50
260/260 - 7s - loss: 3.2744 - accuracy100: 0.3872 - val_loss: 3.2059 - val_accuracy100: 0.4457 - 7s/epoch - 27ms/step
Epoch 5/50
260/260 - 7s - loss: 3.2639 - accuracy100: 0.3896 - val_loss: 3.2233 - val_accuracy100: 0.4291 - 7s/epoch - 28ms/step
Epoch 6/50
260/260 - 7s - loss: 3.2559 - accuracy100: 0.4002 - val_loss: 3.2588 - val_accuracy100: 0.3959 - 7s/epoch - 26ms/step
Epoch 7/50
260/260 - 7s - loss: 3.2627 - accuracy100: 0.3922 - val_loss: 3.2205 - val_accuracy100: 0.4283 - 7s/epoch - 28ms/step
Epoch 8/50
260/260 - 7s - loss: 3.2526 - accuracy100: 0.4011 - val_loss: 3.2259 - val_accuracy100: 0.4290 - 7s/epoch - 26ms/step
Epoch 9/50
260/260 - 7s - loss: 3.2457 - accuracy100: 0.4017 - val_loss: 3.2167 - val_accuracy100: 0.4362 - 7s/epoch - 27ms/step
Epoch 10/50
260/260 - 7s - loss: 3.2421 - accuracy100: 0.4055 - val_loss: 3.2405 - val_accuracy100: 0.4194 - 7s/epoch - 27ms/step
Epoch 11/50
260/260 - 7s - loss: 3.2375 - accuracy100: 0.4081 - val_loss: 3.2711 - val_accuracy100: 0.3915 - 7s/epoch - 28ms/step
Epoch 12/50
260/260 - 7s - loss: 3.2330 - accuracy100: 0.4093 - val_loss: 3.2627 - val_accuracy100: 0.4031 - 7s/epoch - 28ms/step
Epoch 13/50
260/260 - 7s - loss: 3.2299 - accuracy100: 0.4116 - val_loss: 3.2439 - val_accuracy100: 0.4224 - 7s/epoch - 28ms/step
testing model: results/LILAK/W1/deepLOB_L1/h100
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.140804
{'0': {'precision': 0.33908528670687943, 'recall': 0.07948382939881517, 'f1-score': 0.12878062925909814, 'support': 55873}, '1': {'precision': 0.35341076839406416, 'recall': 0.9106910474156629, 'f1-score': 0.5092121834040766, 'support': 59938}, '2': {'precision': 0.34642356241234223, 'recall': 0.013753549752213375, 'f1-score': 0.026456726649528705, 'support': 53877}, 'accuracy': 0.3522170100419594, 'macro avg': {'precision': 0.3463065391710953, 'recall': 0.3346428088555638, 'f1-score': 0.22148317977090115, 'support': 169688}, 'weighted avg': {'precision': 0.3464753496550531, 'recall': 0.3522170100419594, 'f1-score': 0.2306699885033932, 'support': 169688}}
[[ 4441 50790   642]
 [ 4597 54585   756]
 [ 4059 49077   741]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.169742
{'0': {'precision': 0.35699797160243407, 'recall': 0.03214171574670136, 'f1-score': 0.05897382198952879, 'support': 21903}, '1': {'precision': 0.32835937378057345, 'recall': 0.9622632878968073, 'f1-score': 0.48963679316645126, 'support': 21862}, '2': {'precision': 0.35537190082644626, 'recall': 0.007557781878899728, 'f1-score': 0.01480079167025213, 'support': 22758}, 'accuracy': 0.32940486748943976, 'macro avg': {'precision': 0.34690974873648456, 'recall': 0.33398759517413606, 'f1-score': 0.18780380227541074, 'support': 66523}, 'weighted avg': {'precision': 0.3470299433370003, 'recall': 0.32940486748943976, 'f1-score': 0.18539421872244494, 'support': 66523}}
[[  704 21053   146]
 [  659 21037   166]
 [  609 21977   172]]
Evaluating performance on  val set...
51/51 - 1s - 952ms/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0644635
{'0': {'precision': 0.23820224719101124, 'recall': 0.03075137800986365, 'f1-score': 0.05447070914696814, 'support': 3447}, '1': {'precision': 0.4765383990907615, 'recall': 0.9588369813786344, 'f1-score': 0.6366594360086768, 'support': 6122}, '2': {'precision': 0.23809523809523808, 'recall': 0.006101281269066504, 'f1-score': 0.01189767995240928, 'support': 3278}, 'accuracy': 0.46672374873511324, 'macro avg': {'precision': 0.3176119614590036, 'recall': 0.33189654688585485, 'f1-score': 0.23434260836935142, 'support': 12847}, 'weighted avg': {'precision': 0.3517496237080445, 'recall': 0.46672374873511324, 'f1-score': 0.3210391684096456, 'support': 12847}}
[[ 106 3319   22]
 [ 210 5870   42]
 [ 129 3129   20]]
training model: results/LILAK/W1/deepLOB_L1/h200
Epoch 1/50
260/260 - 10s - loss: 3.3413 - accuracy200: 0.3579 - val_loss: 3.3086 - val_accuracy200: 0.3951 - 10s/epoch - 38ms/step
Epoch 2/50
260/260 - 7s - loss: 3.3048 - accuracy200: 0.3691 - val_loss: 3.3397 - val_accuracy200: 0.3671 - 7s/epoch - 28ms/step
Epoch 3/50
260/260 - 7s - loss: 3.3035 - accuracy200: 0.3629 - val_loss: 3.2978 - val_accuracy200: 0.3951 - 7s/epoch - 28ms/step
Epoch 4/50
260/260 - 7s - loss: 3.2928 - accuracy200: 0.3673 - val_loss: 3.3331 - val_accuracy200: 0.3823 - 7s/epoch - 27ms/step
Epoch 5/50
260/260 - 7s - loss: 3.2842 - accuracy200: 0.3728 - val_loss: 3.3104 - val_accuracy200: 0.3810 - 7s/epoch - 27ms/step
Epoch 6/50
260/260 - 7s - loss: 3.2731 - accuracy200: 0.3779 - val_loss: 3.3122 - val_accuracy200: 0.3781 - 7s/epoch - 28ms/step
Epoch 7/50
260/260 - 7s - loss: 3.2670 - accuracy200: 0.3843 - val_loss: 3.3538 - val_accuracy200: 0.3711 - 7s/epoch - 28ms/step
Epoch 8/50
260/260 - 7s - loss: 3.2647 - accuracy200: 0.3848 - val_loss: 3.3575 - val_accuracy200: 0.3598 - 7s/epoch - 25ms/step
Epoch 9/50
260/260 - 7s - loss: 3.2564 - accuracy200: 0.3902 - val_loss: 3.3407 - val_accuracy200: 0.3635 - 7s/epoch - 25ms/step
Epoch 10/50
260/260 - 7s - loss: 3.2479 - accuracy200: 0.3976 - val_loss: 3.4063 - val_accuracy200: 0.3525 - 7s/epoch - 25ms/step
Epoch 11/50
260/260 - 7s - loss: 3.2420 - accuracy200: 0.4003 - val_loss: 3.3849 - val_accuracy200: 0.3512 - 7s/epoch - 26ms/step
Epoch 12/50
260/260 - 6s - loss: 3.2384 - accuracy200: 0.4012 - val_loss: 3.4245 - val_accuracy200: 0.3620 - 6s/epoch - 24ms/step
Epoch 13/50
260/260 - 7s - loss: 3.2338 - accuracy200: 0.4062 - val_loss: 3.4161 - val_accuracy200: 0.3483 - 7s/epoch - 25ms/step
testing model: results/LILAK/W1/deepLOB_L1/h200
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1517045
{'0': {'precision': 0.3524590163934426, 'recall': 0.03825808434573014, 'f1-score': 0.06902388839435551, 'support': 61817}, '1': {'precision': 0.30958644248653217, 'recall': 0.7997052236663285, 'f1-score': 0.4463711443742855, 'support': 52243}, '2': {'precision': 0.33546223284689763, 'recall': 0.1690156036528367, 'f1-score': 0.2247803478572709, 'support': 55628}, 'accuracy': 0.3155556079392768, 'macro avg': {'precision': 0.33250256390895744, 'recall': 0.3356596372216318, 'f1-score': 0.24672512687530399, 'support': 169688}, 'weighted avg': {'precision': 0.33368757142534866, 'recall': 0.3155556079392768, 'f1-score': 0.23626124767233947, 'support': 169688}}
[[ 2365 49081 10371]
 [ 2210 41779  8254]
 [ 2135 44091  9402]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.13881
{'0': {'precision': 0.39086830298231723, 'recall': 0.06793577981651376, 'f1-score': 0.11575286255813044, 'support': 21800}, '1': {'precision': 0.3317429132753298, 'recall': 0.9133636363636364, 'f1-score': 0.4867084085211515, 'support': 22000}, '2': {'precision': 0.3883495145631068, 'recall': 0.03696694978655987, 'f1-score': 0.06750783573093305, 'support': 22723}, 'accuracy': 0.33695112968447005, 'macro avg': {'precision': 0.37032024360691795, 'recall': 0.3394221219889033, 'f1-score': 0.22332303560340497, 'support': 66523}, 'weighted avg': {'precision': 0.37045441601384854, 'recall': 0.33695112968447005, 'f1-score': 0.22195297780536907, 'support': 66523}}
[[ 1481 19661   658]
 [ 1241 20094   665]
 [ 1067 20816   840]]
Evaluating performance on  val set...
51/51 - 1s - 871ms/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.099748
{'0': {'precision': 0.391304347826087, 'recall': 0.06818181818181818, 'f1-score': 0.11612903225806451, 'support': 4092}, '1': {'precision': 0.3986832479882955, 'recall': 0.8597909682508381, 'f1-score': 0.5447616667707879, 'support': 5071}, '2': {'precision': 0.34056761268781305, 'recall': 0.11074918566775244, 'f1-score': 0.1671446128635805, 'support': 3684}, 'accuracy': 0.39285436288627695, 'macro avg': {'precision': 0.3768517361673985, 'recall': 0.34624065736680293, 'f1-score': 0.27601177063081095, 'support': 12847}, 'weighted avg': {'precision': 0.37966772219155426, 'recall': 0.39285436288627695, 'f1-score': 0.2999491839327544, 'support': 12847}}
[[ 279 3462  351]
 [ 272 4360  439]
 [ 162 3114  408]]
training model: results/LILAK/W1/deepLOB_L1/h300
Epoch 1/50
260/260 - 9s - loss: 3.3342 - accuracy300: 0.3645 - val_loss: 3.2618 - val_accuracy300: 0.4161 - 9s/epoch - 36ms/step
Epoch 2/50
260/260 - 7s - loss: 3.3039 - accuracy300: 0.3788 - val_loss: 3.3017 - val_accuracy300: 0.3978 - 7s/epoch - 28ms/step
Epoch 3/50
260/260 - 7s - loss: 3.2944 - accuracy300: 0.3777 - val_loss: 3.2924 - val_accuracy300: 0.4154 - 7s/epoch - 25ms/step
Epoch 4/50
260/260 - 6s - loss: 3.2706 - accuracy300: 0.3903 - val_loss: 3.3009 - val_accuracy300: 0.4189 - 6s/epoch - 24ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2664 - accuracy300: 0.3839 - val_loss: 3.3076 - val_accuracy300: 0.4056 - 6s/epoch - 24ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2554 - accuracy300: 0.3903 - val_loss: 3.3173 - val_accuracy300: 0.4118 - 6s/epoch - 24ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2399 - accuracy300: 0.3977 - val_loss: 3.3382 - val_accuracy300: 0.3999 - 6s/epoch - 24ms/step
Epoch 8/50
260/260 - 7s - loss: 3.2324 - accuracy300: 0.4053 - val_loss: 3.3210 - val_accuracy300: 0.4156 - 7s/epoch - 26ms/step
Epoch 9/50
260/260 - 7s - loss: 3.2230 - accuracy300: 0.4069 - val_loss: 3.3502 - val_accuracy300: 0.4015 - 7s/epoch - 25ms/step
Epoch 10/50
260/260 - 7s - loss: 3.2138 - accuracy300: 0.4125 - val_loss: 3.3819 - val_accuracy300: 0.3908 - 7s/epoch - 25ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2049 - accuracy300: 0.4163 - val_loss: 3.3972 - val_accuracy300: 0.3721 - 6s/epoch - 24ms/step
testing model: results/LILAK/W1/deepLOB_L1/h300
Evaluating performance on  test set...
663/663 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1378555
{'0': {'precision': 0.347859433830707, 'recall': 0.25632813837985957, 'f1-score': 0.29516052693855016, 'support': 58390}, '1': {'precision': 0.3664370138749771, 'recall': 0.7088507354551734, 'f1-score': 0.48312490669606456, 'support': 59351}, '2': {'precision': 0.33431777909037214, 'recall': 0.07627004446840048, 'f1-score': 0.12420452051788457, 'support': 51947}, 'accuracy': 0.35948328697374005, 'macro avg': {'precision': 0.34953807559868544, 'recall': 0.3471496394344778, 'f1-score': 0.3008299847174998, 'support': 169688}, 'weighted avg': {'precision': 0.35021168982059014, 'recall': 0.35948328697374005, 'f1-score': 0.3085687952748728, 'support': 169688}}
[[14967 39054  4369]
 [13760 42071  3520]
 [14299 33686  3962]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1475431
{'0': {'precision': 0.34433113377324537, 'recall': 0.1580904291943998, 'f1-score': 0.2166923585113411, 'support': 21785}, '1': {'precision': 0.33608620271807016, 'recall': 0.8228957458462662, 'f1-score': 0.47725317343710705, 'support': 21908}, '2': {'precision': 0.3972222222222222, 'recall': 0.05010950503723171, 'f1-score': 0.08899260987942434, 'support': 22830}, 'accuracy': 0.3399726410414443, 'macro avg': {'precision': 0.35921318623784587, 'recall': 0.34369856002596594, 'f1-score': 0.2609793806092909, 'support': 66523}, 'weighted avg': {'precision': 0.3597675031452424, 'recall': 0.3399726410414443, 'f1-score': 0.2586775526866943, 'support': 66523}}
[[ 3444 17379   962]
 [ 3106 18028   774]
 [ 3452 18234  1144]]
Evaluating performance on  val set...
51/51 - 1s - 802ms/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.083155
{'0': {'precision': 0.32213029989658737, 'recall': 0.1591315453384419, 'f1-score': 0.21302786801162593, 'support': 3915}, '1': {'precision': 0.44336054150905835, 'recall': 0.8010791366906475, 'f1-score': 0.5708061002178649, 'support': 5560}, '2': {'precision': 0.31718569780853517, 'recall': 0.08155397390272835, 'f1-score': 0.12974758197688135, 'support': 3372}, 'accuracy': 0.41659531408110845, 'macro avg': {'precision': 0.36089217973806026, 'recall': 0.3472548853106059, 'f1-score': 0.3045271834021241, 'support': 12847}, 'weighted avg': {'precision': 0.3732992066549299, 'recall': 0.41659531408110845, 'f1-score': 0.3460103422513341, 'support': 12847}}
[[ 623 3041  251]
 [ 765 4454  341]
 [ 546 2551  275]]
training model: results/LILAK/W1/deepLOB_L1/h500
Epoch 1/50
260/260 - 9s - loss: 3.3267 - accuracy500: 0.3705 - val_loss: 3.2754 - val_accuracy500: 0.4089 - 9s/epoch - 36ms/step
Epoch 2/50
260/260 - 7s - loss: 3.2885 - accuracy500: 0.3813 - val_loss: 3.3192 - val_accuracy500: 0.3915 - 7s/epoch - 27ms/step
Epoch 3/50
260/260 - 7s - loss: 3.2666 - accuracy500: 0.3926 - val_loss: 3.2604 - val_accuracy500: 0.4220 - 7s/epoch - 26ms/step
Epoch 4/50
260/260 - 7s - loss: 3.2632 - accuracy500: 0.3929 - val_loss: 3.2746 - val_accuracy500: 0.3847 - 7s/epoch - 26ms/step
Epoch 5/50
260/260 - 7s - loss: 3.2420 - accuracy500: 0.4082 - val_loss: 3.3389 - val_accuracy500: 0.3537 - 7s/epoch - 27ms/step
Epoch 6/50
260/260 - 7s - loss: 3.2459 - accuracy500: 0.4061 - val_loss: 3.3336 - val_accuracy500: 0.3979 - 7s/epoch - 26ms/step
Epoch 7/50
260/260 - 7s - loss: 3.2363 - accuracy500: 0.4099 - val_loss: 3.4492 - val_accuracy500: 0.3493 - 7s/epoch - 27ms/step
Epoch 8/50
260/260 - 7s - loss: 3.2247 - accuracy500: 0.4112 - val_loss: 3.5322 - val_accuracy500: 0.3339 - 7s/epoch - 27ms/step
Epoch 9/50
260/260 - 7s - loss: 3.2150 - accuracy500: 0.4184 - val_loss: 3.5153 - val_accuracy500: 0.3440 - 7s/epoch - 27ms/step
Epoch 10/50
260/260 - 7s - loss: 3.2072 - accuracy500: 0.4204 - val_loss: 3.7462 - val_accuracy500: 0.3319 - 7s/epoch - 27ms/step
Epoch 11/50
260/260 - 7s - loss: 3.1883 - accuracy500: 0.4321 - val_loss: 3.7290 - val_accuracy500: 0.3477 - 7s/epoch - 26ms/step
Epoch 12/50
260/260 - 7s - loss: 3.1815 - accuracy500: 0.4291 - val_loss: 3.7360 - val_accuracy500: 0.3430 - 7s/epoch - 27ms/step
Epoch 13/50
260/260 - 7s - loss: 3.1686 - accuracy500: 0.4386 - val_loss: 3.7297 - val_accuracy500: 0.3370 - 7s/epoch - 25ms/step
testing model: results/LILAK/W1/deepLOB_L1/h500
Evaluating performance on  test set...
663/663 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1234293
{'0': {'precision': 0.34900859799964906, 'recall': 0.03551468618873315, 'f1-score': 0.06446907817969662, 'support': 56005}, '1': {'precision': 0.3956538797638792, 'recall': 0.6910832489681489, 'f1-score': 0.5032123435648225, 'support': 64205}, '2': {'precision': 0.3252705283259071, 'recall': 0.34081814139617606, 'f1-score': 0.3328628813375312, 'support': 49478}, 'accuracy': 0.3725838008580454, 'macro avg': {'precision': 0.35664433536314516, 'recall': 0.3558053588510193, 'f1-score': 0.30018143436068345, 'support': 169688}, 'weighted avg': {'precision': 0.3597362163601401, 'recall': 0.3725838008580454, 'f1-score': 0.3087356140967641, 'support': 169688}}
[[ 1989 36730 17286]
 [ 2140 44371 17694]
 [ 1570 31045 16863]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1626848
{'0': {'precision': 0.34830339321357284, 'recall': 0.03182129017551858, 'f1-score': 0.05831488366264255, 'support': 21935}, '1': {'precision': 0.3369941404242196, 'recall': 0.8977589118627048, 'f1-score': 0.4900404858299595, 'support': 21909}, '2': {'precision': 0.4240208028603933, 'recall': 0.1150403456942546, 'f1-score': 0.18097946725860153, 'support': 22679}, 'accuracy': 0.34538430317333857, 'macro avg': {'precision': 0.3697727788327286, 'recall': 0.3482068492441594, 'f1-score': 0.2431116122504012, 'support': 66523}, 'weighted avg': {'precision': 0.370392305529889, 'recall': 0.34538430317333857, 'f1-score': 0.2423202097792714, 'support': 66523}}
[[  698 19332  1905]
 [  601 19669  1639]
 [  705 19365  2609]]
Evaluating performance on  val set...
51/51 - 1s - 935ms/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0858332
{'0': {'precision': 0.3793859649122807, 'recall': 0.04276885043263288, 'f1-score': 0.07687180626527437, 'support': 4045}, '1': {'precision': 0.43754347610056643, 'recall': 0.8009823540112789, 'f1-score': 0.5659383033419023, 'support': 5497}, '2': {'precision': 0.3556701030927835, 'recall': 0.25052950075642966, 'f1-score': 0.29398189241966977, 'support': 3305}, 'accuracy': 0.4206429516618666, 'macro avg': {'precision': 0.3908665147018769, 'recall': 0.3647602350667805, 'f1-score': 0.3122640006756155, 'support': 12847}, 'weighted avg': {'precision': 0.39816940973897713, 'recall': 0.4206429516618666, 'f1-score': 0.341987971064099, 'support': 12847}}
[[ 173 3297  575]
 [ 169 4403  925]
 [ 114 2363  828]]
training model: results/LILAK/W1/deepLOB_L1/h1000
Epoch 1/50
260/260 - 9s - loss: 3.3127 - accuracy1000: 0.3804 - val_loss: 3.2703 - val_accuracy1000: 0.4070 - 9s/epoch - 35ms/step
Epoch 2/50
260/260 - 7s - loss: 3.2812 - accuracy1000: 0.3944 - val_loss: 3.2546 - val_accuracy1000: 0.4056 - 7s/epoch - 28ms/step
Epoch 3/50
260/260 - 7s - loss: 3.2578 - accuracy1000: 0.3953 - val_loss: 3.2602 - val_accuracy1000: 0.4192 - 7s/epoch - 26ms/step
Epoch 4/50
260/260 - 7s - loss: 3.2376 - accuracy1000: 0.4095 - val_loss: 3.3124 - val_accuracy1000: 0.3952 - 7s/epoch - 26ms/step
Epoch 5/50
260/260 - 7s - loss: 3.2439 - accuracy1000: 0.4053 - val_loss: 3.2619 - val_accuracy1000: 0.4157 - 7s/epoch - 26ms/step
Epoch 6/50
260/260 - 7s - loss: 3.2229 - accuracy1000: 0.4105 - val_loss: 3.3475 - val_accuracy1000: 0.3921 - 7s/epoch - 26ms/step
Epoch 7/50
260/260 - 7s - loss: 3.2133 - accuracy1000: 0.4191 - val_loss: 3.3544 - val_accuracy1000: 0.4023 - 7s/epoch - 26ms/step
Epoch 8/50
260/260 - 7s - loss: 3.2092 - accuracy1000: 0.4181 - val_loss: 3.3184 - val_accuracy1000: 0.3862 - 7s/epoch - 26ms/step
Epoch 9/50
260/260 - 7s - loss: 3.1914 - accuracy1000: 0.4227 - val_loss: 3.4188 - val_accuracy1000: 0.3844 - 7s/epoch - 26ms/step
Epoch 10/50
260/260 - 7s - loss: 3.1788 - accuracy1000: 0.4282 - val_loss: 3.5037 - val_accuracy1000: 0.3796 - 7s/epoch - 27ms/step
Epoch 11/50
260/260 - 7s - loss: 3.1546 - accuracy1000: 0.4422 - val_loss: 3.5160 - val_accuracy1000: 0.3655 - 7s/epoch - 26ms/step
Epoch 12/50
260/260 - 7s - loss: 3.1407 - accuracy1000: 0.4481 - val_loss: 3.5873 - val_accuracy1000: 0.3715 - 7s/epoch - 27ms/step
testing model: results/LILAK/W1/deepLOB_L1/h1000
Evaluating performance on  test set...
663/663 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.121665
{'0': {'precision': 0.2825709922083301, 'recall': 0.1917914119052639, 'f1-score': 0.22849487686688227, 'support': 56916}, '1': {'precision': 0.37897709444618766, 'recall': 0.6563518926808062, 'f1-score': 0.48050877801206027, 'support': 64406}, '2': {'precision': 0.2768040180401804, 'recall': 0.11166935450523095, 'f1-score': 0.1591384542856301, 'support': 48366}, 'accuracy': 0.34528075055395785, 'macro avg': {'precision': 0.31278403489823275, 'recall': 0.31993755303043364, 'f1-score': 0.2893807030548576, 'support': 169688}, 'weighted avg': {'precision': 0.31751869592405974, 'recall': 0.34528075055395785, 'f1-score': 0.30437952741725405, 'support': 169688}}
[[10916 38437  7563]
 [15585 42273  6548]
 [12130 30835  5401]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1456293
{'0': {'precision': 0.351318387733767, 'recall': 0.28352472463088824, 'f1-score': 0.3138017793686614, 'support': 21335}, '1': {'precision': 0.350249178241968, 'recall': 0.7454414154179455, 'f1-score': 0.47657658957452637, 'support': 22156}, '2': {'precision': 0.4530232558139535, 'recall': 0.04228898923237235, 'f1-score': 0.07735684218886506, 'support': 23032}, 'accuracy': 0.3538475414518287, 'macro avg': {'precision': 0.3848636072632295, 'recall': 0.35708504309373534, 'f1-score': 0.289245070377351, 'support': 66523}, 'weighted avg': {'precision': 0.3861751608216097, 'recall': 0.3538475414518287, 'f1-score': 0.2861517771408015, 'support': 66523}}
[[ 6049 14697   589]
 [ 5053 16516   587]
 [ 6116 15942   974]]
Evaluating performance on  val set...
51/51 - 1s - 896ms/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0829173
{'0': {'precision': 0.4180437695399732, 'recall': 0.22070266446592784, 'f1-score': 0.28888888888888886, 'support': 4241}, '1': {'precision': 0.4171765968867418, 'recall': 0.737661351556568, 'f1-score': 0.5329493245559898, 'support': 5268}, '2': {'precision': 0.3588553750966744, 'recall': 0.1390053924505692, 'f1-score': 0.20038868494925502, 'support': 3338}, 'accuracy': 0.4114579279209154, 'macro avg': {'precision': 0.3980252471744632, 'recall': 0.36578980282435497, 'f1-score': 0.3407422994647112, 'support': 12847}, 'weighted avg': {'precision': 0.40230942485335724, 'recall': 0.4114579279209154, 'f1-score': 0.36597277573747533, 'support': 12847}}
[[ 936 2891  414]
 [ 967 3886  415]
 [ 336 2538  464]]
training model: results/LILAK/W1/deepOF_L1/h10
Epoch 1/50
260/260 - 9s - loss: 3.2937 - accuracy10: 0.3878 - val_loss: 3.2578 - val_accuracy10: 0.4266 - 9s/epoch - 33ms/step
Epoch 2/50
260/260 - 7s - loss: 3.2638 - accuracy10: 0.4174 - val_loss: 3.2546 - val_accuracy10: 0.4308 - 7s/epoch - 25ms/step
Epoch 3/50
260/260 - 6s - loss: 3.2502 - accuracy10: 0.4195 - val_loss: 3.2455 - val_accuracy10: 0.4294 - 6s/epoch - 25ms/step
Epoch 4/50
260/260 - 7s - loss: 3.2420 - accuracy10: 0.4216 - val_loss: 3.2474 - val_accuracy10: 0.4234 - 7s/epoch - 25ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2370 - accuracy10: 0.4221 - val_loss: 3.2406 - val_accuracy10: 0.4346 - 6s/epoch - 25ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2316 - accuracy10: 0.4237 - val_loss: 3.2380 - val_accuracy10: 0.4245 - 6s/epoch - 25ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2279 - accuracy10: 0.4217 - val_loss: 3.2364 - val_accuracy10: 0.4238 - 6s/epoch - 24ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2240 - accuracy10: 0.4251 - val_loss: 3.2358 - val_accuracy10: 0.4279 - 6s/epoch - 24ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2209 - accuracy10: 0.4251 - val_loss: 3.2393 - val_accuracy10: 0.4334 - 6s/epoch - 24ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2167 - accuracy10: 0.4262 - val_loss: 3.2398 - val_accuracy10: 0.4396 - 6s/epoch - 24ms/step
Epoch 11/50
260/260 - 7s - loss: 3.2136 - accuracy10: 0.4285 - val_loss: 3.2333 - val_accuracy10: 0.4335 - 7s/epoch - 25ms/step
Epoch 12/50
260/260 - 6s - loss: 3.2100 - accuracy10: 0.4316 - val_loss: 3.2321 - val_accuracy10: 0.4292 - 6s/epoch - 25ms/step
Epoch 13/50
260/260 - 6s - loss: 3.2071 - accuracy10: 0.4309 - val_loss: 3.2383 - val_accuracy10: 0.4368 - 6s/epoch - 24ms/step
Epoch 14/50
260/260 - 6s - loss: 3.2050 - accuracy10: 0.4328 - val_loss: 3.2337 - val_accuracy10: 0.4262 - 6s/epoch - 25ms/step
Epoch 15/50
260/260 - 7s - loss: 3.2016 - accuracy10: 0.4324 - val_loss: 3.2353 - val_accuracy10: 0.4275 - 7s/epoch - 26ms/step
Epoch 16/50
260/260 - 7s - loss: 3.1964 - accuracy10: 0.4365 - val_loss: 3.2414 - val_accuracy10: 0.4348 - 7s/epoch - 26ms/step
Epoch 17/50
260/260 - 7s - loss: 3.1972 - accuracy10: 0.4362 - val_loss: 3.2280 - val_accuracy10: 0.4361 - 7s/epoch - 26ms/step
Epoch 18/50
260/260 - 6s - loss: 3.1925 - accuracy10: 0.4395 - val_loss: 3.2347 - val_accuracy10: 0.4333 - 6s/epoch - 24ms/step
Epoch 19/50
260/260 - 6s - loss: 3.1913 - accuracy10: 0.4398 - val_loss: 3.2274 - val_accuracy10: 0.4365 - 6s/epoch - 24ms/step
Epoch 20/50
260/260 - 7s - loss: 3.1871 - accuracy10: 0.4430 - val_loss: 3.2377 - val_accuracy10: 0.4410 - 7s/epoch - 25ms/step
Epoch 21/50
260/260 - 7s - loss: 3.1833 - accuracy10: 0.4443 - val_loss: 3.2363 - val_accuracy10: 0.4393 - 7s/epoch - 25ms/step
Epoch 22/50
260/260 - 7s - loss: 3.1822 - accuracy10: 0.4432 - val_loss: 3.2391 - val_accuracy10: 0.4424 - 7s/epoch - 26ms/step
Epoch 23/50
260/260 - 7s - loss: 3.1779 - accuracy10: 0.4460 - val_loss: 3.2307 - val_accuracy10: 0.4410 - 7s/epoch - 26ms/step
Epoch 24/50
260/260 - 6s - loss: 3.1750 - accuracy10: 0.4462 - val_loss: 3.2402 - val_accuracy10: 0.4464 - 6s/epoch - 25ms/step
Epoch 25/50
260/260 - 7s - loss: 3.1730 - accuracy10: 0.4471 - val_loss: 3.2427 - val_accuracy10: 0.4457 - 7s/epoch - 26ms/step
Epoch 26/50
260/260 - 6s - loss: 3.1702 - accuracy10: 0.4468 - val_loss: 3.2417 - val_accuracy10: 0.4401 - 6s/epoch - 25ms/step
Epoch 27/50
260/260 - 6s - loss: 3.1687 - accuracy10: 0.4508 - val_loss: 3.2410 - val_accuracy10: 0.4436 - 6s/epoch - 22ms/step
Epoch 28/50
260/260 - 6s - loss: 3.1641 - accuracy10: 0.4532 - val_loss: 3.2403 - val_accuracy10: 0.4392 - 6s/epoch - 23ms/step
Epoch 29/50
260/260 - 6s - loss: 3.1600 - accuracy10: 0.4513 - val_loss: 3.2408 - val_accuracy10: 0.4384 - 6s/epoch - 23ms/step
testing model: results/LILAK/W1/deepOF_L1/h10
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0701174
{'0': {'precision': 0.36516269974101934, 'recall': 0.4005062606276086, 'f1-score': 0.38201874429791816, 'support': 51752}, '1': {'precision': 0.5132476884052042, 'recall': 0.47146722790138307, 'f1-score': 0.4914711067580803, 'support': 66520}, '2': {'precision': 0.36285388965011484, 'recall': 0.36571939857228997, 'f1-score': 0.36428100902855814, 'support': 51411}, 'accuracy': 0.41778492836642445, 'macro avg': {'precision': 0.4137547592654461, 'recall': 0.4125642957004272, 'f1-score': 0.41259028669485226, 'support': 169683}, 'weighted avg': {'precision': 0.4225162072247277, 'recall': 0.41778492836642445, 'f1-score': 0.4195525953196288, 'support': 169683}}
[[20727 15246 15779]
 [17922 31362 17236]
 [18112 14497 18802]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0476451
{'0': {'precision': 0.3242216754038729, 'recall': 0.3801906912558023, 'f1-score': 0.3499826769834854, 'support': 15942}, '1': {'precision': 0.5955488304646618, 'recall': 0.5592492821408485, 'f1-score': 0.5768285422041739, 'support': 33781}, '2': {'precision': 0.3414043583535109, 'recall': 0.3273214285714286, 'f1-score': 0.3342146047953323, 'support': 16800}, 'accuracy': 0.4577664867790088, 'macro avg': {'precision': 0.4203916214073485, 'recall': 0.4222538006560264, 'f1-score': 0.4203419413276639, 'support': 66523}, 'weighted avg': {'precision': 0.466343523466384, 'recall': 0.4577664867790088, 'f1-score': 0.46119498791743463, 'support': 66523}}
[[ 6061  6261  3620]
 [ 7901 18892  6988]
 [ 4732  6569  5499]]
Evaluating performance on  val set...
51/51 - 1s - 888ms/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0620185
{'0': {'precision': 0.29660357791029296, 'recall': 0.3643312101910828, 'f1-score': 0.3269972845505216, 'support': 3140}, '1': {'precision': 0.5974025974025974, 'recall': 0.5231235784685367, 'f1-score': 0.5578011317704124, 'support': 6595}, '2': {'precision': 0.3004665629860031, 'recall': 0.31041131105398456, 'f1-score': 0.3053579895685159, 'support': 3112}, 'accuracy': 0.432785864404141, 'macro avg': {'precision': 0.3981575794329644, 'recall': 0.3992886999045347, 'f1-score': 0.39671880196314996, 'support': 12847}, 'weighted avg': {'precision': 0.4519543324138625, 'recall': 0.432785864404141, 'f1-score': 0.44023849934239345, 'support': 12847}}
[[1144 1205  791]
 [1687 3450 1458]
 [1026 1120  966]]
training model: results/LILAK/W1/deepOF_L1/h20
Epoch 1/50
260/260 - 8s - loss: 3.3025 - accuracy20: 0.3678 - val_loss: 3.2783 - val_accuracy20: 0.3903 - 8s/epoch - 32ms/step
Epoch 2/50
260/260 - 6s - loss: 3.2761 - accuracy20: 0.3877 - val_loss: 3.2741 - val_accuracy20: 0.3952 - 6s/epoch - 24ms/step
Epoch 3/50
260/260 - 7s - loss: 3.2644 - accuracy20: 0.3954 - val_loss: 3.2667 - val_accuracy20: 0.3897 - 7s/epoch - 26ms/step
Epoch 4/50
260/260 - 6s - loss: 3.2550 - accuracy20: 0.4032 - val_loss: 3.2708 - val_accuracy20: 0.3950 - 6s/epoch - 25ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2501 - accuracy20: 0.4053 - val_loss: 3.2664 - val_accuracy20: 0.3976 - 6s/epoch - 24ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2452 - accuracy20: 0.4047 - val_loss: 3.2697 - val_accuracy20: 0.3974 - 6s/epoch - 24ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2439 - accuracy20: 0.4067 - val_loss: 3.2624 - val_accuracy20: 0.3955 - 6s/epoch - 24ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2392 - accuracy20: 0.4091 - val_loss: 3.2552 - val_accuracy20: 0.4020 - 6s/epoch - 24ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2360 - accuracy20: 0.4107 - val_loss: 3.2616 - val_accuracy20: 0.4006 - 6s/epoch - 24ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2325 - accuracy20: 0.4112 - val_loss: 3.2648 - val_accuracy20: 0.4055 - 6s/epoch - 24ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2308 - accuracy20: 0.4122 - val_loss: 3.2575 - val_accuracy20: 0.4015 - 6s/epoch - 25ms/step
Epoch 12/50
260/260 - 7s - loss: 3.2264 - accuracy20: 0.4133 - val_loss: 3.2533 - val_accuracy20: 0.4033 - 7s/epoch - 25ms/step
Epoch 13/50
260/260 - 6s - loss: 3.2220 - accuracy20: 0.4149 - val_loss: 3.2571 - val_accuracy20: 0.4034 - 6s/epoch - 24ms/step
Epoch 14/50
260/260 - 6s - loss: 3.2212 - accuracy20: 0.4149 - val_loss: 3.2593 - val_accuracy20: 0.4076 - 6s/epoch - 24ms/step
Epoch 15/50
260/260 - 6s - loss: 3.2189 - accuracy20: 0.4171 - val_loss: 3.2646 - val_accuracy20: 0.4005 - 6s/epoch - 24ms/step
Epoch 16/50
260/260 - 7s - loss: 3.2196 - accuracy20: 0.4178 - val_loss: 3.2541 - val_accuracy20: 0.4039 - 7s/epoch - 26ms/step
Epoch 17/50
260/260 - 7s - loss: 3.2148 - accuracy20: 0.4168 - val_loss: 3.2510 - val_accuracy20: 0.4067 - 7s/epoch - 25ms/step
Epoch 18/50
260/260 - 7s - loss: 3.2101 - accuracy20: 0.4215 - val_loss: 3.2544 - val_accuracy20: 0.4074 - 7s/epoch - 26ms/step
Epoch 19/50
260/260 - 7s - loss: 3.2101 - accuracy20: 0.4200 - val_loss: 3.2512 - val_accuracy20: 0.4038 - 7s/epoch - 26ms/step
Epoch 20/50
260/260 - 6s - loss: 3.2074 - accuracy20: 0.4228 - val_loss: 3.2433 - val_accuracy20: 0.4061 - 6s/epoch - 25ms/step
Epoch 21/50
260/260 - 7s - loss: 3.2013 - accuracy20: 0.4246 - val_loss: 3.2540 - val_accuracy20: 0.4092 - 7s/epoch - 26ms/step
Epoch 22/50
260/260 - 7s - loss: 3.2031 - accuracy20: 0.4257 - val_loss: 3.2575 - val_accuracy20: 0.4033 - 7s/epoch - 26ms/step
Epoch 23/50
260/260 - 7s - loss: 3.1988 - accuracy20: 0.4264 - val_loss: 3.2513 - val_accuracy20: 0.4099 - 7s/epoch - 25ms/step
Epoch 24/50
260/260 - 7s - loss: 3.1954 - accuracy20: 0.4265 - val_loss: 3.2465 - val_accuracy20: 0.4083 - 7s/epoch - 26ms/step
Epoch 25/50
260/260 - 6s - loss: 3.1925 - accuracy20: 0.4290 - val_loss: 3.2593 - val_accuracy20: 0.4114 - 6s/epoch - 24ms/step
Epoch 26/50
260/260 - 6s - loss: 3.1898 - accuracy20: 0.4280 - val_loss: 3.2505 - val_accuracy20: 0.4107 - 6s/epoch - 24ms/step
Epoch 27/50
260/260 - 6s - loss: 3.1875 - accuracy20: 0.4301 - val_loss: 3.2502 - val_accuracy20: 0.4066 - 6s/epoch - 23ms/step
Epoch 28/50
260/260 - 6s - loss: 3.1865 - accuracy20: 0.4298 - val_loss: 3.2528 - val_accuracy20: 0.4088 - 6s/epoch - 23ms/step
Epoch 29/50
260/260 - 6s - loss: 3.1830 - accuracy20: 0.4317 - val_loss: 3.2481 - val_accuracy20: 0.4045 - 6s/epoch - 24ms/step
Epoch 30/50
260/260 - 6s - loss: 3.1797 - accuracy20: 0.4345 - val_loss: 3.2541 - val_accuracy20: 0.4093 - 6s/epoch - 24ms/step
testing model: results/LILAK/W1/deepOF_L1/h20
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.079205
{'0': {'precision': 0.40772384269336814, 'recall': 0.37252432172630395, 'f1-score': 0.3893301000303122, 'support': 60337}, '1': {'precision': 0.3878930709419941, 'recall': 0.45646673009575095, 'f1-score': 0.41939533715858685, 'support': 49399}, '2': {'precision': 0.40292079471137654, 'recall': 0.37923499090863594, 'f1-score': 0.3907192575406032, 'support': 59947}, 'accuracy': 0.39933287365263465, 'macro avg': {'precision': 0.39951256944891295, 'recall': 0.4027420142435636, 'f1-score': 0.39981489824316735, 'support': 169683}, 'weighted avg': {'precision': 0.4002537448572704, 'recall': 0.39933287365263465, 'f1-score': 0.398573621621568, 'support': 169683}}
[[22477 18258 19602]
 [12763 22549 14087]
 [19888 17325 22734]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0658673
{'0': {'precision': 0.37848541610917846, 'recall': 0.36140637775960754, 'f1-score': 0.3697487778736308, 'support': 19568}, '1': {'precision': 0.47274691459063084, 'recall': 0.5505108264714852, 'f1-score': 0.508673981577696, 'support': 26232}, '2': {'precision': 0.399745532357874, 'recall': 0.3335424407662983, 'f1-score': 0.36365549534382063, 'support': 20723}, 'accuracy': 0.42729582249748205, 'macro avg': {'precision': 0.4169926210192278, 'recall': 0.4151532149991304, 'f1-score': 0.41402608493171583, 'support': 66523}, 'weighted avg': {'precision': 0.42227840525860316, 'recall': 0.42729582249748205, 'f1-score': 0.42263296604463607, 'support': 66523}}
[[ 7072  7888  4608]
 [ 6020 14441  5771]
 [ 5593  8218  6912]]
Evaluating performance on  val set...
51/51 - 1s - 863ms/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0794488
{'0': {'precision': 0.3432954244908754, 'recall': 0.335140717789827, 'f1-score': 0.33916906192840346, 'support': 3873}, '1': {'precision': 0.47052686489306206, 'recall': 0.5210860774119006, 'f1-score': 0.4945175438596491, 'support': 5193}, '2': {'precision': 0.3559577677224736, 'recall': 0.3120867495371595, 'f1-score': 0.33258173618940245, 'support': 3781}, 'accuracy': 0.40351833112788976, 'macro avg': {'precision': 0.38992668570213707, 'recall': 0.3894378482462957, 'f1-score': 0.38875611399248494, 'support': 12847}, 'weighted avg': {'precision': 0.39845142898742925, 'recall': 0.40351833112788976, 'f1-score': 0.40002513634653963, 'support': 12847}}
[[1298 1579  996]
 [1348 2706 1139]
 [1135 1466 1180]]
training model: results/LILAK/W1/deepOF_L1/h30
Epoch 1/50
260/260 - 9s - loss: 3.3065 - accuracy30: 0.3634 - val_loss: 3.2963 - val_accuracy30: 0.3644 - 9s/epoch - 34ms/step
Epoch 2/50
260/260 - 7s - loss: 3.2823 - accuracy30: 0.3758 - val_loss: 3.2884 - val_accuracy30: 0.3727 - 7s/epoch - 26ms/step
Epoch 3/50
260/260 - 7s - loss: 3.2709 - accuracy30: 0.3836 - val_loss: 3.2863 - val_accuracy30: 0.3738 - 7s/epoch - 26ms/step
Epoch 4/50
260/260 - 7s - loss: 3.2630 - accuracy30: 0.3922 - val_loss: 3.2903 - val_accuracy30: 0.3768 - 7s/epoch - 25ms/step
Epoch 5/50
260/260 - 7s - loss: 3.2588 - accuracy30: 0.3944 - val_loss: 3.2848 - val_accuracy30: 0.3807 - 7s/epoch - 25ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2517 - accuracy30: 0.4008 - val_loss: 3.2891 - val_accuracy30: 0.3778 - 6s/epoch - 24ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2483 - accuracy30: 0.3998 - val_loss: 3.2852 - val_accuracy30: 0.3772 - 6s/epoch - 24ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2473 - accuracy30: 0.4004 - val_loss: 3.2801 - val_accuracy30: 0.3837 - 6s/epoch - 25ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2444 - accuracy30: 0.4025 - val_loss: 3.2803 - val_accuracy30: 0.3813 - 6s/epoch - 23ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2402 - accuracy30: 0.4035 - val_loss: 3.2933 - val_accuracy30: 0.3815 - 6s/epoch - 22ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2372 - accuracy30: 0.4069 - val_loss: 3.2804 - val_accuracy30: 0.3792 - 6s/epoch - 24ms/step
Epoch 12/50
260/260 - 6s - loss: 3.2341 - accuracy30: 0.4072 - val_loss: 3.2854 - val_accuracy30: 0.3757 - 6s/epoch - 23ms/step
Epoch 13/50
260/260 - 6s - loss: 3.2325 - accuracy30: 0.4069 - val_loss: 3.2829 - val_accuracy30: 0.3828 - 6s/epoch - 23ms/step
Epoch 14/50
260/260 - 6s - loss: 3.2277 - accuracy30: 0.4107 - val_loss: 3.2850 - val_accuracy30: 0.3799 - 6s/epoch - 24ms/step
Epoch 15/50
260/260 - 6s - loss: 3.2281 - accuracy30: 0.4090 - val_loss: 3.2816 - val_accuracy30: 0.3830 - 6s/epoch - 25ms/step
Epoch 16/50
260/260 - 7s - loss: 3.2247 - accuracy30: 0.4131 - val_loss: 3.2778 - val_accuracy30: 0.3851 - 7s/epoch - 25ms/step
Epoch 17/50
260/260 - 6s - loss: 3.2221 - accuracy30: 0.4135 - val_loss: 3.2810 - val_accuracy30: 0.3794 - 6s/epoch - 24ms/step
Epoch 18/50
260/260 - 6s - loss: 3.2189 - accuracy30: 0.4154 - val_loss: 3.2854 - val_accuracy30: 0.3826 - 6s/epoch - 25ms/step
Epoch 19/50
260/260 - 6s - loss: 3.2185 - accuracy30: 0.4152 - val_loss: 3.2799 - val_accuracy30: 0.3818 - 6s/epoch - 25ms/step
Epoch 20/50
260/260 - 6s - loss: 3.2143 - accuracy30: 0.4163 - val_loss: 3.2840 - val_accuracy30: 0.3792 - 6s/epoch - 24ms/step
Epoch 21/50
260/260 - 6s - loss: 3.2111 - accuracy30: 0.4173 - val_loss: 3.2858 - val_accuracy30: 0.3807 - 6s/epoch - 25ms/step
Epoch 22/50
260/260 - 6s - loss: 3.2121 - accuracy30: 0.4163 - val_loss: 3.2830 - val_accuracy30: 0.3739 - 6s/epoch - 25ms/step
Epoch 23/50
260/260 - 6s - loss: 3.2073 - accuracy30: 0.4187 - val_loss: 3.2893 - val_accuracy30: 0.3800 - 6s/epoch - 24ms/step
Epoch 24/50
260/260 - 6s - loss: 3.2048 - accuracy30: 0.4218 - val_loss: 3.2795 - val_accuracy30: 0.3814 - 6s/epoch - 24ms/step
Epoch 25/50
260/260 - 6s - loss: 3.2014 - accuracy30: 0.4223 - val_loss: 3.2899 - val_accuracy30: 0.3836 - 6s/epoch - 24ms/step
Epoch 26/50
260/260 - 7s - loss: 3.1998 - accuracy30: 0.4249 - val_loss: 3.2876 - val_accuracy30: 0.3823 - 7s/epoch - 25ms/step
testing model: results/LILAK/W1/deepOF_L1/h30
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0885382
{'0': {'precision': 0.4316034027983999, 'recall': 0.3791955063767093, 'f1-score': 0.4037057007009461, 'support': 65159}, '1': {'precision': 0.31001509813789635, 'recall': 0.46542084319750165, 'f1-score': 0.37214547504933754, 'support': 39706}, '2': {'precision': 0.43154885851663954, 'recall': 0.35170785892807555, 'f1-score': 0.3875590765359899, 'support': 64818}, 'accuracy': 0.38887219108573046, 'macro avg': {'precision': 0.391055786484312, 'recall': 0.3987747361674288, 'f1-score': 0.38780341742875785, 'support': 169683}, 'weighted avg': {'precision': 0.40313077633549493, 'recall': 0.38887219108573046, 'f1-score': 0.39015265057307885, 'support': 169683}}
[[24708 21232 19219]
 [10416 18480 10810]
 [22123 19898 22797]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0811869
{'0': {'precision': 0.40645288215620695, 'recall': 0.3781458771849547, 'f1-score': 0.39178874508130657, 'support': 21854}, '1': {'precision': 0.38878730490432967, 'recall': 0.551122425364499, 'f1-score': 0.45593612988455134, 'support': 21605}, '2': {'precision': 0.43662062319306133, 'recall': 0.2946583420048561, 'f1-score': 0.35186000155323716, 'support': 23064}, 'accuracy': 0.4053785908633104, 'macro avg': {'precision': 0.41062027008453267, 'recall': 0.40797554818476994, 'f1-score': 0.399861625506365, 'support': 66523}, 'weighted avg': {'precision': 0.41117491788440924, 'recall': 0.4053785908633104, 'f1-score': 0.3987786238892784, 'support': 66523}}
[[ 8264  9158  4432]
 [ 5361 11907  4337]
 [ 6707  9561  6796]]
Evaluating performance on  val set...
51/51 - 1s - 916ms/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0937216
{'0': {'precision': 0.3694451116982945, 'recall': 0.3580908032596042, 'f1-score': 0.3636793568219437, 'support': 4295}, '1': {'precision': 0.38653541923009316, 'recall': 0.5062154696132597, 'f1-score': 0.4383534336688927, 'support': 4344}, '2': {'precision': 0.38430717863105174, 'recall': 0.2735266159695818, 'f1-score': 0.31958906011384147, 'support': 4208}, 'accuracy': 0.38047793259126644, 'macro avg': {'precision': 0.38009590318647984, 'recall': 0.3792776296141485, 'f1-score': 0.37387395020155934, 'support': 12847}, 'weighted avg': {'precision': 0.38009194547825687, 'recall': 0.38047793259126644, 'f1-score': 0.37448750045667956, 'support': 12847}}
[[1538 1822  935]
 [1236 2199  909]
 [1389 1668 1151]]
training model: results/LILAK/W1/deepOF_L1/h50
Epoch 1/50
260/260 - 9s - loss: 3.3149 - accuracy50: 0.3543 - val_loss: 3.2990 - val_accuracy50: 0.3693 - 9s/epoch - 34ms/step
Epoch 2/50
260/260 - 7s - loss: 3.2890 - accuracy50: 0.3718 - val_loss: 3.2890 - val_accuracy50: 0.3757 - 7s/epoch - 25ms/step
Epoch 3/50
260/260 - 6s - loss: 3.2796 - accuracy50: 0.3801 - val_loss: 3.2893 - val_accuracy50: 0.3776 - 6s/epoch - 23ms/step
Epoch 4/50
260/260 - 7s - loss: 3.2708 - accuracy50: 0.3845 - val_loss: 3.2862 - val_accuracy50: 0.3706 - 7s/epoch - 25ms/step
Epoch 5/50
260/260 - 7s - loss: 3.2679 - accuracy50: 0.3878 - val_loss: 3.2860 - val_accuracy50: 0.3683 - 7s/epoch - 25ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2647 - accuracy50: 0.3890 - val_loss: 3.2830 - val_accuracy50: 0.3723 - 6s/epoch - 23ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2597 - accuracy50: 0.3921 - val_loss: 3.2862 - val_accuracy50: 0.3686 - 6s/epoch - 23ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2594 - accuracy50: 0.3921 - val_loss: 3.2840 - val_accuracy50: 0.3731 - 6s/epoch - 24ms/step
Epoch 9/50
260/260 - 7s - loss: 3.2548 - accuracy50: 0.3940 - val_loss: 3.2849 - val_accuracy50: 0.3702 - 7s/epoch - 25ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2529 - accuracy50: 0.3967 - val_loss: 3.2853 - val_accuracy50: 0.3684 - 6s/epoch - 24ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2507 - accuracy50: 0.3967 - val_loss: 3.2851 - val_accuracy50: 0.3723 - 6s/epoch - 24ms/step
Epoch 12/50
260/260 - 6s - loss: 3.2453 - accuracy50: 0.3998 - val_loss: 3.2841 - val_accuracy50: 0.3716 - 6s/epoch - 25ms/step
Epoch 13/50
260/260 - 6s - loss: 3.2445 - accuracy50: 0.4016 - val_loss: 3.2829 - val_accuracy50: 0.3762 - 6s/epoch - 25ms/step
Epoch 14/50
260/260 - 6s - loss: 3.2436 - accuracy50: 0.4016 - val_loss: 3.2865 - val_accuracy50: 0.3657 - 6s/epoch - 25ms/step
Epoch 15/50
260/260 - 6s - loss: 3.2415 - accuracy50: 0.4032 - val_loss: 3.2838 - val_accuracy50: 0.3715 - 6s/epoch - 25ms/step
Epoch 16/50
260/260 - 6s - loss: 3.2389 - accuracy50: 0.4046 - val_loss: 3.2808 - val_accuracy50: 0.3768 - 6s/epoch - 24ms/step
Epoch 17/50
260/260 - 6s - loss: 3.2361 - accuracy50: 0.4049 - val_loss: 3.2879 - val_accuracy50: 0.3717 - 6s/epoch - 24ms/step
Epoch 18/50
260/260 - 6s - loss: 3.2368 - accuracy50: 0.4038 - val_loss: 3.2862 - val_accuracy50: 0.3748 - 6s/epoch - 24ms/step
Epoch 19/50
260/260 - 6s - loss: 3.2343 - accuracy50: 0.4075 - val_loss: 3.2855 - val_accuracy50: 0.3736 - 6s/epoch - 24ms/step
Epoch 20/50
260/260 - 6s - loss: 3.2314 - accuracy50: 0.4083 - val_loss: 3.2837 - val_accuracy50: 0.3775 - 6s/epoch - 24ms/step
Epoch 21/50
260/260 - 6s - loss: 3.2287 - accuracy50: 0.4113 - val_loss: 3.2842 - val_accuracy50: 0.3762 - 6s/epoch - 24ms/step
Epoch 22/50
260/260 - 6s - loss: 3.2252 - accuracy50: 0.4111 - val_loss: 3.2881 - val_accuracy50: 0.3764 - 6s/epoch - 24ms/step
Epoch 23/50
260/260 - 6s - loss: 3.2240 - accuracy50: 0.4119 - val_loss: 3.2903 - val_accuracy50: 0.3757 - 6s/epoch - 23ms/step
Epoch 24/50
260/260 - 6s - loss: 3.2226 - accuracy50: 0.4128 - val_loss: 3.2898 - val_accuracy50: 0.3724 - 6s/epoch - 24ms/step
Epoch 25/50
260/260 - 6s - loss: 3.2190 - accuracy50: 0.4137 - val_loss: 3.2921 - val_accuracy50: 0.3774 - 6s/epoch - 24ms/step
Epoch 26/50
260/260 - 7s - loss: 3.2158 - accuracy50: 0.4168 - val_loss: 3.2933 - val_accuracy50: 0.3725 - 7s/epoch - 26ms/step
testing model: results/LILAK/W1/deepOF_L1/h50
Evaluating performance on  test set...
663/663 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.101577
{'0': {'precision': 0.4008604106187262, 'recall': 0.37777081925606076, 'f1-score': 0.38897326466370835, 'support': 60677}, '1': {'precision': 0.31143548846482483, 'recall': 0.4514284534720502, 'f1-score': 0.3685869345378548, 'support': 48444}, '2': {'precision': 0.39533123625269034, 'recall': 0.2759981506555266, 'f1-score': 0.32505858444425, 'support': 60562}, 'accuracy': 0.36247591096338466, 'macro avg': {'precision': 0.36920904511208047, 'recall': 0.36839914112787914, 'f1-score': 0.36087292788193776, 'support': 169683}, 'weighted avg': {'precision': 0.37335642502924776, 'recall': 0.36247591096338466, 'f1-score': 0.3603410726346442, 'support': 169683}}
[[22922 24328 13427]
 [14436 21869 12139]
 [19824 24023 16715]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0870773
{'0': {'precision': 0.3977779843808107, 'recall': 0.39272109780164305, 'f1-score': 0.39523336643495527, 'support': 21789}, '1': {'precision': 0.36830938958598536, 'recall': 0.5539246968730057, 'f1-score': 0.44243792325056436, 'support': 21938}, '2': {'precision': 0.4440376133810435, 'recall': 0.2340761537111774, 'f1-score': 0.3065521500588861, 'support': 22796}, 'accuracy': 0.39151872284773687, 'macro avg': {'precision': 0.40337499578261315, 'recall': 0.39357398279527533, 'f1-score': 0.3814078132481353, 'support': 66523}, 'weighted avg': {'precision': 0.4039119902145889, 'recall': 0.39151872284773687, 'f1-score': 0.3804113734236954, 'support': 66523}}
[[ 8557 10115  3117]
 [ 6222 12152  3564]
 [ 6733 10727  5336]]
Evaluating performance on  val set...
51/51 - 1s - 935ms/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0939823
{'0': {'precision': 0.35317553316147177, 'recall': 0.3683695917868492, 'f1-score': 0.36061258674324004, 'support': 4091}, '1': {'precision': 0.3957551020408163, 'recall': 0.4994848547290336, 'f1-score': 0.4416104937147021, 'support': 4853}, '2': {'precision': 0.3478615071283096, 'recall': 0.21880604663079684, 'f1-score': 0.2686379364580057, 'support': 3903}, 'accuracy': 0.3724604966139955, 'macro avg': {'precision': 0.36559738077686593, 'recall': 0.36222016438222654, 'f1-score': 0.356953672305316, 'support': 12847}, 'weighted avg': {'precision': 0.3676456821584381, 'recall': 0.3724604966139955, 'f1-score': 0.3632673530286947, 'support': 12847}}
[[1507 1878  706]
 [1534 2424  895]
 [1226 1823  854]]
training model: results/LILAK/W1/deepOF_L1/h100
Epoch 1/50
260/260 - 9s - loss: 3.3114 - accuracy100: 0.3577 - val_loss: 3.1994 - val_accuracy100: 0.4626 - 9s/epoch - 34ms/step
Epoch 2/50
260/260 - 7s - loss: 3.2894 - accuracy100: 0.3716 - val_loss: 3.1889 - val_accuracy100: 0.4642 - 7s/epoch - 27ms/step
Epoch 3/50
260/260 - 7s - loss: 3.2806 - accuracy100: 0.3777 - val_loss: 3.1934 - val_accuracy100: 0.4617 - 7s/epoch - 27ms/step
Epoch 4/50
260/260 - 7s - loss: 3.2738 - accuracy100: 0.3818 - val_loss: 3.1894 - val_accuracy100: 0.4650 - 7s/epoch - 27ms/step
Epoch 5/50
260/260 - 7s - loss: 3.2709 - accuracy100: 0.3847 - val_loss: 3.1990 - val_accuracy100: 0.4569 - 7s/epoch - 27ms/step
Epoch 6/50
260/260 - 7s - loss: 3.2660 - accuracy100: 0.3892 - val_loss: 3.1979 - val_accuracy100: 0.4602 - 7s/epoch - 25ms/step
Epoch 7/50
260/260 - 7s - loss: 3.2627 - accuracy100: 0.3892 - val_loss: 3.2031 - val_accuracy100: 0.4582 - 7s/epoch - 25ms/step
Epoch 8/50
260/260 - 7s - loss: 3.2600 - accuracy100: 0.3914 - val_loss: 3.2019 - val_accuracy100: 0.4580 - 7s/epoch - 27ms/step
Epoch 9/50
260/260 - 7s - loss: 3.2573 - accuracy100: 0.3925 - val_loss: 3.2049 - val_accuracy100: 0.4576 - 7s/epoch - 25ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2533 - accuracy100: 0.3967 - val_loss: 3.2087 - val_accuracy100: 0.4597 - 6s/epoch - 22ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2517 - accuracy100: 0.3967 - val_loss: 3.2147 - val_accuracy100: 0.4475 - 6s/epoch - 23ms/step
Epoch 12/50
260/260 - 6s - loss: 3.2475 - accuracy100: 0.3994 - val_loss: 3.2077 - val_accuracy100: 0.4520 - 6s/epoch - 25ms/step
testing model: results/LILAK/W1/deepOF_L1/h100
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1159537
{'0': {'precision': 0.3526997158193874, 'recall': 0.019991767043115637, 'f1-score': 0.037838753387533876, 'support': 55873}, '1': {'precision': 0.3530986372485399, 'recall': 0.9441728539250855, 'f1-score': 0.5139805357880826, 'support': 59935}, '2': {'precision': 0.3626039667306462, 'recall': 0.042078886310904874, 'f1-score': 0.07540705506677534, 'support': 53875}, 'accuracy': 0.3534414172309542, 'macro avg': {'precision': 0.3561341065995245, 'recall': 0.33541450242636867, 'f1-score': 0.20907544808079725, 'support': 169683}, 'weighted avg': {'precision': 0.3559852592957541, 'recall': 0.3534414172309542, 'f1-score': 0.2179484283764604, 'support': 169683}}
[[ 1117 53007  1749]
 [ 1110 56589  2236]
 [  940 50668  2267]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1291155
{'0': {'precision': 0.41173986486486486, 'recall': 0.044555134122378104, 'f1-score': 0.0804090552966888, 'support': 21883}, '1': {'precision': 0.3291930443144483, 'recall': 0.9424612278608792, 'f1-score': 0.487949732150281, 'support': 21794}, '2': {'precision': 0.42045454545454547, 'recall': 0.03239079051037381, 'f1-score': 0.06014793139884581, 'support': 22846}, 'accuracy': 0.3345459465147393, 'macro avg': {'precision': 0.3871291515446195, 'recall': 0.33980238416454367, 'f1-score': 0.20950223961527184, 'support': 66523}, 'weighted avg': {'precision': 0.38768908822634984, 'recall': 0.3345459465147393, 'f1-score': 0.20696762714066858, 'support': 66523}}
[[  975 20422   486]
 [  720 20540   534]
 [  673 21433   740]]
Evaluating performance on  val set...
51/51 - 1s - 842ms/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0614722
{'0': {'precision': 0.3303249097472924, 'recall': 0.05312046444121916, 'f1-score': 0.09152288072018006, 'support': 3445}, '1': {'precision': 0.4775290355159064, 'recall': 0.9250081512879035, 'f1-score': 0.6298845470692718, 'support': 6134}, '2': {'precision': 0.2871046228710462, 'recall': 0.03610771113831089, 'f1-score': 0.0641478662680076, 'support': 3268}, 'accuracy': 0.4650891258659609, 'macro avg': {'precision': 0.3649861893780817, 'recall': 0.33807877562247785, 'f1-score': 0.2618517646858198, 'support': 12847}, 'weighted avg': {'precision': 0.3896154997646588, 'recall': 0.4650891258659609, 'f1-score': 0.3416084193016099, 'support': 12847}}
[[ 183 3166   96]
 [ 263 5674  197]
 [ 108 3042  118]]
training model: results/LILAK/W1/deepOF_L1/h200
Epoch 1/50
260/260 - 8s - loss: 3.3208 - accuracy200: 0.3508 - val_loss: 3.3066 - val_accuracy200: 0.3848 - 8s/epoch - 32ms/step
Epoch 2/50
260/260 - 6s - loss: 3.3102 - accuracy200: 0.3526 - val_loss: 3.2891 - val_accuracy200: 0.3865 - 6s/epoch - 24ms/step
Epoch 3/50
260/260 - 6s - loss: 3.2991 - accuracy200: 0.3574 - val_loss: 3.2819 - val_accuracy200: 0.3897 - 6s/epoch - 25ms/step
Epoch 4/50
260/260 - 6s - loss: 3.2930 - accuracy200: 0.3610 - val_loss: 3.2791 - val_accuracy200: 0.3886 - 6s/epoch - 24ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2898 - accuracy200: 0.3627 - val_loss: 3.2780 - val_accuracy200: 0.3880 - 6s/epoch - 25ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2862 - accuracy200: 0.3655 - val_loss: 3.2770 - val_accuracy200: 0.3898 - 6s/epoch - 23ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2838 - accuracy200: 0.3677 - val_loss: 3.2798 - val_accuracy200: 0.3871 - 6s/epoch - 24ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2820 - accuracy200: 0.3708 - val_loss: 3.2796 - val_accuracy200: 0.3898 - 6s/epoch - 24ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2784 - accuracy200: 0.3731 - val_loss: 3.2804 - val_accuracy200: 0.3911 - 6s/epoch - 24ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2763 - accuracy200: 0.3746 - val_loss: 3.2771 - val_accuracy200: 0.3920 - 6s/epoch - 22ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2738 - accuracy200: 0.3766 - val_loss: 3.2809 - val_accuracy200: 0.3890 - 6s/epoch - 23ms/step
Epoch 12/50
260/260 - 6s - loss: 3.2710 - accuracy200: 0.3765 - val_loss: 3.2743 - val_accuracy200: 0.3904 - 6s/epoch - 24ms/step
Epoch 13/50
260/260 - 6s - loss: 3.2689 - accuracy200: 0.3787 - val_loss: 3.2763 - val_accuracy200: 0.3878 - 6s/epoch - 24ms/step
Epoch 14/50
260/260 - 6s - loss: 3.2678 - accuracy200: 0.3802 - val_loss: 3.2768 - val_accuracy200: 0.3918 - 6s/epoch - 25ms/step
Epoch 15/50
260/260 - 7s - loss: 3.2653 - accuracy200: 0.3817 - val_loss: 3.2781 - val_accuracy200: 0.3918 - 7s/epoch - 26ms/step
Epoch 16/50
260/260 - 7s - loss: 3.2621 - accuracy200: 0.3849 - val_loss: 3.2801 - val_accuracy200: 0.3871 - 7s/epoch - 26ms/step
Epoch 17/50
260/260 - 7s - loss: 3.2592 - accuracy200: 0.3876 - val_loss: 3.2778 - val_accuracy200: 0.3906 - 7s/epoch - 25ms/step
Epoch 18/50
260/260 - 6s - loss: 3.2579 - accuracy200: 0.3883 - val_loss: 3.2800 - val_accuracy200: 0.3888 - 6s/epoch - 25ms/step
Epoch 19/50
260/260 - 6s - loss: 3.2550 - accuracy200: 0.3911 - val_loss: 3.2793 - val_accuracy200: 0.3877 - 6s/epoch - 25ms/step
Epoch 20/50
260/260 - 7s - loss: 3.2541 - accuracy200: 0.3916 - val_loss: 3.2810 - val_accuracy200: 0.3922 - 7s/epoch - 26ms/step
Epoch 21/50
260/260 - 7s - loss: 3.2498 - accuracy200: 0.3959 - val_loss: 3.2810 - val_accuracy200: 0.3930 - 7s/epoch - 25ms/step
Epoch 22/50
260/260 - 7s - loss: 3.2473 - accuracy200: 0.3978 - val_loss: 3.2842 - val_accuracy200: 0.3907 - 7s/epoch - 26ms/step
testing model: results/LILAK/W1/deepOF_L1/h200
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1162935
{'0': {'precision': 0.3907726514730406, 'recall': 0.07960593364284906, 'f1-score': 0.13226716839134525, 'support': 61817}, '1': {'precision': 0.30643966434546016, 'recall': 0.8710017036427328, 'f1-score': 0.45337199280614965, 'support': 52241}, '2': {'precision': 0.34553695955369595, 'recall': 0.053447191011235955, 'f1-score': 0.09257500506001963, 'support': 55625}, 'accuracy': 0.31468090498164225, 'macro avg': {'precision': 0.34758309179073227, 'recall': 0.33468494276560595, 'f1-score': 0.22607138875250485, 'support': 169683}, 'weighted avg': {'precision': 0.34997967313375217, 'recall': 0.31468090498164225, 'f1-score': 0.2181152530371189, 'support': 169683}}
[[ 4921 54112  2784]
 [ 3892 45502  2847]
 [ 3780 48872  2973]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1020042
{'0': {'precision': 0.4323119777158774, 'recall': 0.10678899082568807, 'f1-score': 0.17127092146404266, 'support': 21800}, '1': {'precision': 0.3355335533553355, 'recall': 0.8877569583409132, 'f1-score': 0.48700164662441997, 'support': 21988}, '2': {'precision': 0.4486833220796759, 'recall': 0.05845612491752804, 'f1-score': 0.10343619877806746, 'support': 22735}, 'accuracy': 0.34840581453031283, 'macro avg': {'precision': 0.405509617716963, 'recall': 0.3510006913613764, 'f1-score': 0.25390292228884337, 'support': 66523}, 'weighted avg': {'precision': 0.4059186779439393, 'recall': 0.34840581453031283, 'f1-score': 0.25244682700890275, 'support': 66523}}
[[ 2328 18717   755]
 [ 1590 19520   878]
 [ 1467 19939  1329]]
Evaluating performance on  val set...
51/51 - 1s - 819ms/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0915457
{'0': {'precision': 0.38578680203045684, 'recall': 0.1118195193722413, 'f1-score': 0.17338403041825096, 'support': 4078}, '1': {'precision': 0.3953405017921147, 'recall': 0.8724540241249753, 'f1-score': 0.5441203675155701, 'support': 5057}, '2': {'precision': 0.32673267326732675, 'recall': 0.044450431034482756, 'f1-score': 0.07825468342423524, 'support': 3712}, 'accuracy': 0.39176461430684206, 'macro avg': {'precision': 0.3692866590299661, 'recall': 0.34290799151056645, 'f1-score': 0.2652530271193521, 'support': 12847}, 'weighted avg': {'precision': 0.3724844072087837, 'recall': 0.39176461430684206, 'f1-score': 0.29183141273780855, 'support': 12847}}
[[ 456 3489  133]
 [ 438 4412  207]
 [ 288 3259  165]]
training model: results/LILAK/W1/deepOF_L1/h300
Epoch 1/50
260/260 - 9s - loss: 3.3124 - accuracy300: 0.3536 - val_loss: 3.2661 - val_accuracy300: 0.4224 - 9s/epoch - 33ms/step
Epoch 2/50
260/260 - 6s - loss: 3.3080 - accuracy300: 0.3543 - val_loss: 3.2520 - val_accuracy300: 0.4245 - 6s/epoch - 25ms/step
Epoch 3/50
260/260 - 6s - loss: 3.2997 - accuracy300: 0.3581 - val_loss: 3.2468 - val_accuracy300: 0.4278 - 6s/epoch - 24ms/step
Epoch 4/50
260/260 - 7s - loss: 3.2977 - accuracy300: 0.3591 - val_loss: 3.2456 - val_accuracy300: 0.4296 - 7s/epoch - 26ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2941 - accuracy300: 0.3599 - val_loss: 3.2410 - val_accuracy300: 0.4277 - 6s/epoch - 25ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2903 - accuracy300: 0.3635 - val_loss: 3.2441 - val_accuracy300: 0.4282 - 6s/epoch - 24ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2856 - accuracy300: 0.3665 - val_loss: 3.2437 - val_accuracy300: 0.4283 - 6s/epoch - 25ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2833 - accuracy300: 0.3690 - val_loss: 3.2443 - val_accuracy300: 0.4284 - 6s/epoch - 25ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2813 - accuracy300: 0.3690 - val_loss: 3.2411 - val_accuracy300: 0.4294 - 6s/epoch - 24ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2777 - accuracy300: 0.3728 - val_loss: 3.2412 - val_accuracy300: 0.4280 - 6s/epoch - 25ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2746 - accuracy300: 0.3754 - val_loss: 3.2431 - val_accuracy300: 0.4289 - 6s/epoch - 24ms/step
Epoch 12/50
260/260 - 7s - loss: 3.2730 - accuracy300: 0.3781 - val_loss: 3.2402 - val_accuracy300: 0.4299 - 7s/epoch - 26ms/step
Epoch 13/50
260/260 - 7s - loss: 3.2735 - accuracy300: 0.3757 - val_loss: 3.2417 - val_accuracy300: 0.4308 - 7s/epoch - 25ms/step
Epoch 14/50
260/260 - 6s - loss: 3.2708 - accuracy300: 0.3789 - val_loss: 3.2411 - val_accuracy300: 0.4309 - 6s/epoch - 25ms/step
Epoch 15/50
260/260 - 7s - loss: 3.2682 - accuracy300: 0.3793 - val_loss: 3.2425 - val_accuracy300: 0.4298 - 7s/epoch - 25ms/step
Epoch 16/50
260/260 - 6s - loss: 3.2660 - accuracy300: 0.3811 - val_loss: 3.2412 - val_accuracy300: 0.4308 - 6s/epoch - 24ms/step
Epoch 17/50
260/260 - 6s - loss: 3.2637 - accuracy300: 0.3844 - val_loss: 3.2418 - val_accuracy300: 0.4291 - 6s/epoch - 25ms/step
Epoch 18/50
260/260 - 6s - loss: 3.2646 - accuracy300: 0.3826 - val_loss: 3.2415 - val_accuracy300: 0.4294 - 6s/epoch - 25ms/step
Epoch 19/50
260/260 - 6s - loss: 3.2620 - accuracy300: 0.3856 - val_loss: 3.2403 - val_accuracy300: 0.4284 - 6s/epoch - 25ms/step
Epoch 20/50
260/260 - 6s - loss: 3.2604 - accuracy300: 0.3853 - val_loss: 3.2427 - val_accuracy300: 0.4275 - 6s/epoch - 25ms/step
Epoch 21/50
260/260 - 7s - loss: 3.2569 - accuracy300: 0.3894 - val_loss: 3.2419 - val_accuracy300: 0.4283 - 7s/epoch - 25ms/step
Epoch 22/50
260/260 - 7s - loss: 3.2553 - accuracy300: 0.3872 - val_loss: 3.2427 - val_accuracy300: 0.4292 - 7s/epoch - 27ms/step
testing model: results/LILAK/W1/deepOF_L1/h300
Evaluating performance on  test set...
663/663 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1056367
{'0': {'precision': 0.35807860262008734, 'recall': 0.01685220071930125, 'f1-score': 0.03218947299551834, 'support': 58390}, '1': {'precision': 0.34990311656797235, 'recall': 0.9766971642319163, 'f1-score': 0.5152258546210869, 'support': 59349}, '2': {'precision': 0.3128930817610063, 'recall': 0.007662097643616202, 'f1-score': 0.014957907396271796, 'support': 51944}, 'accuracy': 0.3497580782989457, 'macro avg': {'precision': 0.34029160031635536, 'recall': 0.33373715419827793, 'f1-score': 0.18745774500429235, 'support': 169683}, 'weighted avg': {'precision': 0.3413867500643742, 'recall': 0.3497580782989457, 'f1-score': 0.19586320442181684, 'support': 169683}}
[[  984 56993   413]
 [  922 57966   461]
 [  842 50704   398]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.105507
{'0': {'precision': 0.4227574750830565, 'recall': 0.04680459770114943, 'f1-score': 0.08427849987581754, 'support': 21750}, '1': {'precision': 0.33242312149740433, 'recall': 0.9547672244767681, 'f1-score': 0.4931464908148846, 'support': 21931}, '2': {'precision': 0.45204262877442275, 'recall': 0.022283512827248053, 'f1-score': 0.04247329773030708, 'support': 22842}, 'accuracy': 0.3377177818198217, 'macro avg': {'precision': 0.4024077417849612, 'recall': 0.34128511166838854, 'f1-score': 0.20663276280700305, 'support': 66523}, 'weighted avg': {'precision': 0.4030320984784423, 'recall': 0.3377177818198217, 'f1-score': 0.20471758833961096, 'support': 66523}}
[[ 1018 20413   319]
 [  694 20939   298]
 [  696 21637   509]]
Evaluating performance on  val set...
51/51 - 1s - 870ms/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0794042
{'0': {'precision': 0.403747870528109, 'recall': 0.060675883256528416, 'f1-score': 0.10549744046294236, 'support': 3906}, '1': {'precision': 0.4349623749276441, 'recall': 0.9441751929635613, 'f1-score': 0.5955615942028986, 'support': 5571}, '2': {'precision': 0.2634730538922156, 'recall': 0.013056379821958458, 'f1-score': 0.024879841673734807, 'support': 3370}, 'accuracy': 0.4313069199034794, 'macro avg': {'precision': 0.36739443311598957, 'recall': 0.3393024853473494, 'f1-score': 0.24197962544652526, 'support': 12847}, 'weighted avg': {'precision': 0.38048717713251856, 'recall': 0.4313069199034794, 'f1-score': 0.29686243560310477, 'support': 12847}}
[[ 237 3616   53]
 [ 241 5260   70]
 [ 109 3217   44]]
training model: results/LILAK/W1/deepOF_L1/h500
Epoch 1/50
260/260 - 8s - loss: 3.3167 - accuracy500: 0.3559 - val_loss: 3.2568 - val_accuracy500: 0.4222 - 8s/epoch - 33ms/step
Epoch 2/50
260/260 - 6s - loss: 3.3094 - accuracy500: 0.3563 - val_loss: 3.2519 - val_accuracy500: 0.4261 - 6s/epoch - 23ms/step
Epoch 3/50
260/260 - 6s - loss: 3.3044 - accuracy500: 0.3568 - val_loss: 3.2353 - val_accuracy500: 0.4284 - 6s/epoch - 23ms/step
Epoch 4/50
260/260 - 7s - loss: 3.2989 - accuracy500: 0.3606 - val_loss: 3.2341 - val_accuracy500: 0.4284 - 7s/epoch - 25ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2940 - accuracy500: 0.3620 - val_loss: 3.2374 - val_accuracy500: 0.4271 - 6s/epoch - 24ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2925 - accuracy500: 0.3636 - val_loss: 3.2361 - val_accuracy500: 0.4277 - 6s/epoch - 23ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2877 - accuracy500: 0.3682 - val_loss: 3.2371 - val_accuracy500: 0.4274 - 6s/epoch - 24ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2852 - accuracy500: 0.3685 - val_loss: 3.2375 - val_accuracy500: 0.4275 - 6s/epoch - 24ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2846 - accuracy500: 0.3699 - val_loss: 3.2368 - val_accuracy500: 0.4285 - 6s/epoch - 24ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2815 - accuracy500: 0.3749 - val_loss: 3.2361 - val_accuracy500: 0.4290 - 6s/epoch - 24ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2799 - accuracy500: 0.3731 - val_loss: 3.2360 - val_accuracy500: 0.4297 - 6s/epoch - 24ms/step
Epoch 12/50
260/260 - 6s - loss: 3.2786 - accuracy500: 0.3742 - val_loss: 3.2344 - val_accuracy500: 0.4273 - 6s/epoch - 24ms/step
Epoch 13/50
260/260 - 7s - loss: 3.2766 - accuracy500: 0.3744 - val_loss: 3.2331 - val_accuracy500: 0.4291 - 7s/epoch - 25ms/step
Epoch 14/50
260/260 - 6s - loss: 3.2750 - accuracy500: 0.3777 - val_loss: 3.2368 - val_accuracy500: 0.4279 - 6s/epoch - 24ms/step
Epoch 15/50
260/260 - 7s - loss: 3.2725 - accuracy500: 0.3784 - val_loss: 3.2328 - val_accuracy500: 0.4325 - 7s/epoch - 25ms/step
Epoch 16/50
260/260 - 6s - loss: 3.2724 - accuracy500: 0.3777 - val_loss: 3.2353 - val_accuracy500: 0.4297 - 6s/epoch - 25ms/step
Epoch 17/50
260/260 - 6s - loss: 3.2695 - accuracy500: 0.3798 - val_loss: 3.2377 - val_accuracy500: 0.4294 - 6s/epoch - 25ms/step
Epoch 18/50
260/260 - 6s - loss: 3.2682 - accuracy500: 0.3813 - val_loss: 3.2379 - val_accuracy500: 0.4296 - 6s/epoch - 23ms/step
Epoch 19/50
260/260 - 6s - loss: 3.2673 - accuracy500: 0.3815 - val_loss: 3.2370 - val_accuracy500: 0.4276 - 6s/epoch - 23ms/step
Epoch 20/50
260/260 - 6s - loss: 3.2658 - accuracy500: 0.3830 - val_loss: 3.2363 - val_accuracy500: 0.4285 - 6s/epoch - 24ms/step
Epoch 21/50
260/260 - 6s - loss: 3.2635 - accuracy500: 0.3840 - val_loss: 3.2371 - val_accuracy500: 0.4301 - 6s/epoch - 24ms/step
Epoch 22/50
260/260 - 6s - loss: 3.2643 - accuracy500: 0.3835 - val_loss: 3.2351 - val_accuracy500: 0.4304 - 6s/epoch - 24ms/step
Epoch 23/50
260/260 - 7s - loss: 3.2611 - accuracy500: 0.3877 - val_loss: 3.2337 - val_accuracy500: 0.4302 - 7s/epoch - 25ms/step
Epoch 24/50
260/260 - 7s - loss: 3.2590 - accuracy500: 0.3869 - val_loss: 3.2405 - val_accuracy500: 0.4301 - 7s/epoch - 26ms/step
Epoch 25/50
260/260 - 7s - loss: 3.2579 - accuracy500: 0.3884 - val_loss: 3.2380 - val_accuracy500: 0.4286 - 7s/epoch - 26ms/step
testing model: results/LILAK/W1/deepOF_L1/h500
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0986162
{'0': {'precision': 0.3012295081967213, 'recall': 0.010499437530132315, 'f1-score': 0.020291605556034858, 'support': 56003}, '1': {'precision': 0.37793945926524747, 'recall': 0.9830075539288218, 'f1-score': 0.5459688581314879, 'support': 64205}, '2': {'precision': 0.30978260869565216, 'recall': 0.004608388074785245, 'f1-score': 0.00908167533010695, 'support': 49475}, 'accuracy': 0.3767613726772865, 'macro avg': {'precision': 0.32965052538587364, 'recall': 0.33270512651124645, 'f1-score': 0.19178071300587654, 'support': 169683}, 'weighted avg': {'precision': 0.33274903022037317, 'recall': 0.3767613726772865, 'f1-score': 0.21592992349996074, 'support': 169683}}
[[  588 55177   238]
 [  821 63114   270]
 [  543 48704   228]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1108785
{'0': {'precision': 0.4000918695452457, 'recall': 0.03974265376893594, 'f1-score': 0.07230315859378243, 'support': 21916}, '1': {'precision': 0.33168184463423456, 'recall': 0.9629223744292238, 'f1-score': 0.49340773757297113, 'support': 21900}, '2': {'precision': 0.45632333767926986, 'recall': 0.015413749064165235, 'f1-score': 0.029820226633722413, 'support': 22707}, 'accuracy': 0.3353576958345234, 'macro avg': {'precision': 0.39603235061958336, 'recall': 0.339359592420775, 'f1-score': 0.1985103742668253, 'support': 66523}, 'weighted avg': {'precision': 0.39676472557050224, 'recall': 0.3353576958345234, 'f1-score': 0.1964336148814897, 'support': 66523}}
[[  871 20818   227]
 [  622 21088   190]
 [  684 21673   350]]
Evaluating performance on  val set...
51/51 - 1s - 939ms/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0772101
{'0': {'precision': 0.4187866927592955, 'recall': 0.053062236548475084, 'f1-score': 0.09419014084507044, 'support': 4033}, '1': {'precision': 0.4312428548097338, 'recall': 0.9586131784352877, 'f1-score': 0.5948746831878344, 'support': 5509}, '2': {'precision': 0.24444444444444444, 'recall': 0.0066565809379727685, 'f1-score': 0.012960235640648013, 'support': 3305}, 'accuracy': 0.42943877948159104, 'macro avg': {'precision': 0.3648246640044912, 'recall': 0.33944399864057856, 'f1-score': 0.23400835322451763, 'support': 12847}, 'weighted avg': {'precision': 0.3792770691938936, 'recall': 0.42943877948159104, 'f1-score': 0.2879946327159874, 'support': 12847}}
[[ 214 3785   34]
 [ 194 5281   34]
 [ 103 3180   22]]
training model: results/LILAK/W1/deepOF_L1/h1000
Epoch 1/50
260/260 - 9s - loss: 3.3159 - accuracy1000: 0.3603 - val_loss: 3.2952 - val_accuracy1000: 0.4102 - 9s/epoch - 35ms/step
Epoch 2/50
260/260 - 7s - loss: 3.3021 - accuracy1000: 0.3669 - val_loss: 3.2680 - val_accuracy1000: 0.4129 - 7s/epoch - 27ms/step
Epoch 3/50
260/260 - 7s - loss: 3.2965 - accuracy1000: 0.3685 - val_loss: 3.2716 - val_accuracy1000: 0.4140 - 7s/epoch - 27ms/step
Epoch 4/50
260/260 - 7s - loss: 3.2936 - accuracy1000: 0.3692 - val_loss: 3.2538 - val_accuracy1000: 0.4150 - 7s/epoch - 25ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2882 - accuracy1000: 0.3728 - val_loss: 3.2602 - val_accuracy1000: 0.4135 - 6s/epoch - 25ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2842 - accuracy1000: 0.3768 - val_loss: 3.2590 - val_accuracy1000: 0.4138 - 6s/epoch - 25ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2815 - accuracy1000: 0.3801 - val_loss: 3.2600 - val_accuracy1000: 0.4128 - 6s/epoch - 24ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2792 - accuracy1000: 0.3814 - val_loss: 3.2640 - val_accuracy1000: 0.4144 - 6s/epoch - 24ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2785 - accuracy1000: 0.3808 - val_loss: 3.2619 - val_accuracy1000: 0.4164 - 6s/epoch - 24ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2762 - accuracy1000: 0.3823 - val_loss: 3.2598 - val_accuracy1000: 0.4148 - 6s/epoch - 24ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2746 - accuracy1000: 0.3827 - val_loss: 3.2644 - val_accuracy1000: 0.4145 - 6s/epoch - 24ms/step
Epoch 12/50
260/260 - 6s - loss: 3.2736 - accuracy1000: 0.3837 - val_loss: 3.2616 - val_accuracy1000: 0.4161 - 6s/epoch - 23ms/step
Epoch 13/50
260/260 - 6s - loss: 3.2712 - accuracy1000: 0.3842 - val_loss: 3.2729 - val_accuracy1000: 0.4153 - 6s/epoch - 25ms/step
Epoch 14/50
260/260 - 6s - loss: 3.2704 - accuracy1000: 0.3839 - val_loss: 3.2651 - val_accuracy1000: 0.4157 - 6s/epoch - 24ms/step
testing model: results/LILAK/W1/deepOF_L1/h1000
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1035057
{'0': {'precision': 0.3538260300850229, 'recall': 0.00950573682638413, 'f1-score': 0.01851408233804456, 'support': 56913}, '1': {'precision': 0.38019448113461274, 'recall': 0.9876874825326832, 'f1-score': 0.5490434700051355, 'support': 64406}, '2': {'precision': 0.3906810035842294, 'recall': 0.006761227359192788, 'f1-score': 0.013292412755838296, 'support': 48364}, 'accuracy': 0.3800086042797452, 'macro avg': {'precision': 0.3749005049346217, 'recall': 0.33465148223942004, 'f1-score': 0.1936166550330061, 'support': 169683}, 'weighted avg': {'precision': 0.3743392246691328, 'recall': 0.3800086042797452, 'f1-score': 0.21839701058903513, 'support': 169683}}
[[  541 56142   230]
 [  513 63613   280]
 [  475 47562   327]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1326338
{'0': {'precision': 0.39561443581544087, 'recall': 0.040567761277931325, 'f1-score': 0.07358939496940856, 'support': 21347}, '1': {'precision': 0.3356797530747547, 'recall': 0.9630867934758054, 'f1-score': 0.49783964313240076, 'support': 22133}, '2': {'precision': 0.38895558223289317, 'recall': 0.01406066918370004, 'f1-score': 0.027140224493214946, 'support': 23043}, 'accuracy': 0.3383190776122544, 'macro avg': {'precision': 0.3734165903743629, 'recall': 0.33923840797914556, 'f1-score': 0.19952308753167478, 'support': 66523}, 'weighted avg': {'precision': 0.3733668778850671, 'recall': 0.3383190776122544, 'f1-score': 0.19865294452833668, 'support': 66523}}
[[  866 20208   273]
 [  581 21316   236]
 [  742 21977   324]]
Evaluating performance on  val set...
51/51 - 1s - 825ms/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0844729
{'0': {'precision': 0.4157303370786517, 'recall': 0.052494679593284466, 'f1-score': 0.09321855973126181, 'support': 4229}, '1': {'precision': 0.41524936324048967, 'recall': 0.9582859309821767, 'f1-score': 0.5794210375465749, 'support': 5274}, '2': {'precision': 0.3028169014084507, 'recall': 0.012858851674641148, 'f1-score': 0.024670109007458405, 'support': 3344}, 'accuracy': 0.4140266210010119, 'macro avg': {'precision': 0.377932200575864, 'recall': 0.34121315408336744, 'f1-score': 0.23243656876176502, 'support': 12847}, 'weighted avg': {'precision': 0.386142169809747, 'recall': 0.4140266210010119, 'f1-score': 0.2749735102082263, 'support': 12847}}
[[ 222 3954   53]
 [ 174 5054   46]
 [ 138 3163   43]]
training model: results/LILAK/W1/deepLOB_L2/h10
Epoch 1/50
260/260 - 16s - loss: 3.3505 - accuracy10: 0.3420 - val_loss: 3.3790 - val_accuracy10: 0.3231 - 16s/epoch - 62ms/step
Epoch 2/50
260/260 - 13s - loss: 3.3011 - accuracy10: 0.3576 - val_loss: 3.3534 - val_accuracy10: 0.3909 - 13s/epoch - 49ms/step
Epoch 3/50
260/260 - 13s - loss: 3.2737 - accuracy10: 0.3585 - val_loss: 3.3369 - val_accuracy10: 0.3905 - 13s/epoch - 48ms/step
Epoch 4/50
260/260 - 13s - loss: 3.2536 - accuracy10: 0.3605 - val_loss: 3.3136 - val_accuracy10: 0.3683 - 13s/epoch - 48ms/step
Epoch 5/50
260/260 - 12s - loss: 3.2246 - accuracy10: 0.3637 - val_loss: 3.2902 - val_accuracy10: 0.3744 - 12s/epoch - 48ms/step
Epoch 6/50
260/260 - 13s - loss: 3.2087 - accuracy10: 0.3641 - val_loss: 3.2771 - val_accuracy10: 0.3658 - 13s/epoch - 48ms/step
Epoch 7/50
260/260 - 13s - loss: 3.1972 - accuracy10: 0.3741 - val_loss: 3.2611 - val_accuracy10: 0.3781 - 13s/epoch - 48ms/step
Epoch 8/50
260/260 - 13s - loss: 3.1781 - accuracy10: 0.3868 - val_loss: 3.2528 - val_accuracy10: 0.3919 - 13s/epoch - 48ms/step
Epoch 9/50
260/260 - 12s - loss: 3.1698 - accuracy10: 0.3954 - val_loss: 3.2611 - val_accuracy10: 0.3977 - 12s/epoch - 47ms/step
Epoch 10/50
260/260 - 12s - loss: 3.1522 - accuracy10: 0.4062 - val_loss: 3.2599 - val_accuracy10: 0.4122 - 12s/epoch - 48ms/step
Epoch 11/50
260/260 - 12s - loss: 3.1396 - accuracy10: 0.4179 - val_loss: 3.2619 - val_accuracy10: 0.4091 - 12s/epoch - 48ms/step
Epoch 12/50
260/260 - 12s - loss: 3.1290 - accuracy10: 0.4224 - val_loss: 3.2613 - val_accuracy10: 0.4102 - 12s/epoch - 47ms/step
Epoch 13/50
260/260 - 12s - loss: 3.1196 - accuracy10: 0.4284 - val_loss: 3.2687 - val_accuracy10: 0.4177 - 12s/epoch - 47ms/step
Epoch 14/50
260/260 - 12s - loss: 3.1042 - accuracy10: 0.4374 - val_loss: 3.2817 - val_accuracy10: 0.4130 - 12s/epoch - 48ms/step
Epoch 15/50
260/260 - 12s - loss: 3.0956 - accuracy10: 0.4414 - val_loss: 3.2818 - val_accuracy10: 0.4087 - 12s/epoch - 48ms/step
Epoch 16/50
260/260 - 12s - loss: 3.0794 - accuracy10: 0.4490 - val_loss: 3.2987 - val_accuracy10: 0.3689 - 12s/epoch - 47ms/step
Epoch 17/50
260/260 - 12s - loss: 3.0682 - accuracy10: 0.4535 - val_loss: 3.3201 - val_accuracy10: 0.3690 - 12s/epoch - 47ms/step
Epoch 18/50
260/260 - 12s - loss: 3.0563 - accuracy10: 0.4588 - val_loss: 3.3328 - val_accuracy10: 0.3568 - 12s/epoch - 48ms/step
testing model: results/LILAK/W1/deepLOB_L2/h10
Evaluating performance on  test set...
663/663 - 14s - 14s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1051949
{'0': {'precision': 0.36675803024237014, 'recall': 0.4602245280466833, 'f1-score': 0.4082094348515361, 'support': 51753}, '1': {'precision': 0.42075941039820736, 'recall': 0.30767264964973995, 'f1-score': 0.35543785004124523, 'support': 66522}, '2': {'precision': 0.328182093649181, 'recall': 0.358119541750141, 'f1-score': 0.3424978607835113, 'support': 51413}, 'accuracy': 0.3694839941539767, 'macro avg': {'precision': 0.37189984476325283, 'recall': 0.3753389064821881, 'f1-score': 0.3687150485587642, 'support': 169688}, 'weighted avg': {'precision': 0.3762399923296183, 'recall': 0.3694839941539767, 'f1-score': 0.36761198233686493, 'support': 169688}}
[[23818 12634 15301]
 [23665 20467 22390]
 [17459 15542 18412]]
Evaluating performance on  train set...
260/260 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0371174
{'0': {'precision': 0.3289835164835165, 'recall': 0.359294911863983, 'f1-score': 0.34347176576038246, 'support': 15998}, '1': {'precision': 0.5393566773095496, 'recall': 0.6054323035455111, 'f1-score': 0.5704875938485584, 'support': 33761}, '2': {'precision': 0.3468710776403084, 'recall': 0.23079217370555954, 'f1-score': 0.2771688516369368, 'support': 16764}, 'accuracy': 0.45182869082873595, 'macro avg': {'precision': 0.40507042381112485, 'recall': 0.39850646303835124, 'f1-score': 0.3970427370819592, 'support': 66523}, 'weighted avg': {'precision': 0.44025744216155516, 'recall': 0.45182869082873595, 'f1-score': 0.4419757316025643, 'support': 66523}}
[[ 5748  7890  2360]
 [ 8396 20440  4925]
 [ 3328  9567  3869]]
Evaluating performance on  val set...
51/51 - 1s - 1s/epoch - 23ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0742925
{'0': {'precision': 0.310445580715851, 'recall': 0.4024621212121212, 'f1-score': 0.3505154639175258, 'support': 3168}, '1': {'precision': 0.5326271186440678, 'recall': 0.3836410804211811, 'f1-score': 0.4460214672225672, 'support': 6553}, '2': {'precision': 0.295273631840796, 'recall': 0.3797184900831734, 'f1-score': 0.3322138259165967, 'support': 3126}, 'accuracy': 0.3873277808048572, 'macro avg': {'precision': 0.3794487770669049, 'recall': 0.38860723057215857, 'f1-score': 0.3762502523522299, 'support': 12847}, 'weighted avg': {'precision': 0.4200842594626543, 'recall': 0.3873277808048572, 'f1-score': 0.3947779313626127, 'support': 12847}}
[[1275 1073  820]
 [2026 2514 2013]
 [ 806 1133 1187]]
training model: results/LILAK/W1/deepLOB_L2/h20
Epoch 1/50
260/260 - 15s - loss: 3.3470 - accuracy20: 0.3491 - val_loss: 3.3768 - val_accuracy20: 0.3570 - 15s/epoch - 58ms/step
Epoch 2/50
260/260 - 13s - loss: 3.3060 - accuracy20: 0.3564 - val_loss: 3.3346 - val_accuracy20: 0.3600 - 13s/epoch - 50ms/step
Epoch 3/50
260/260 - 13s - loss: 3.2772 - accuracy20: 0.3704 - val_loss: 3.3420 - val_accuracy20: 0.3609 - 13s/epoch - 51ms/step
Epoch 4/50
260/260 - 13s - loss: 3.2636 - accuracy20: 0.3785 - val_loss: 3.3358 - val_accuracy20: 0.3567 - 13s/epoch - 49ms/step
Epoch 5/50
260/260 - 13s - loss: 3.2397 - accuracy20: 0.3920 - val_loss: 3.3051 - val_accuracy20: 0.3801 - 13s/epoch - 49ms/step
Epoch 6/50
260/260 - 13s - loss: 3.2248 - accuracy20: 0.4006 - val_loss: 3.3225 - val_accuracy20: 0.3638 - 13s/epoch - 49ms/step
Epoch 7/50
260/260 - 13s - loss: 3.2121 - accuracy20: 0.4070 - val_loss: 3.3174 - val_accuracy20: 0.3652 - 13s/epoch - 49ms/step
Epoch 8/50
260/260 - 12s - loss: 3.2000 - accuracy20: 0.4152 - val_loss: 3.3289 - val_accuracy20: 0.3577 - 12s/epoch - 48ms/step
Epoch 9/50
260/260 - 12s - loss: 3.1905 - accuracy20: 0.4230 - val_loss: 3.3240 - val_accuracy20: 0.3620 - 12s/epoch - 47ms/step
Epoch 10/50
260/260 - 12s - loss: 3.1784 - accuracy20: 0.4271 - val_loss: 3.3351 - val_accuracy20: 0.3609 - 12s/epoch - 48ms/step
Epoch 11/50
260/260 - 12s - loss: 3.1661 - accuracy20: 0.4346 - val_loss: 3.3215 - val_accuracy20: 0.3736 - 12s/epoch - 48ms/step
Epoch 12/50
260/260 - 13s - loss: 3.1582 - accuracy20: 0.4392 - val_loss: 3.3167 - val_accuracy20: 0.3817 - 13s/epoch - 48ms/step
Epoch 13/50
260/260 - 13s - loss: 3.1507 - accuracy20: 0.4419 - val_loss: 3.3643 - val_accuracy20: 0.3698 - 13s/epoch - 49ms/step
Epoch 14/50
260/260 - 13s - loss: 3.1403 - accuracy20: 0.4478 - val_loss: 3.3508 - val_accuracy20: 0.3741 - 13s/epoch - 48ms/step
Epoch 15/50
260/260 - 12s - loss: 3.1273 - accuracy20: 0.4540 - val_loss: 3.3970 - val_accuracy20: 0.3671 - 12s/epoch - 48ms/step
testing model: results/LILAK/W1/deepLOB_L2/h20
Evaluating performance on  test set...
663/663 - 14s - 14s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.110394
{'0': {'precision': 0.3830353061761569, 'recall': 0.4583105454183861, 'f1-score': 0.41730548681113055, 'support': 60339}, '1': {'precision': 0.294795483560758, 'recall': 0.359919028340081, 'f1-score': 0.3241183815956176, 'support': 49400}, '2': {'precision': 0.3756791650976384, 'recall': 0.2329813674957047, 'f1-score': 0.2876028292853687, 'support': 59949}, 'accuracy': 0.3500601103201169, 'macro avg': {'precision': 0.3511699849448511, 'recall': 0.3504036470847239, 'f1-score': 0.34300889923070566, 'support': 169688}, 'weighted avg': {'precision': 0.3547478578078762, 'recall': 0.3500601103201169, 'f1-score': 0.3443540252248178, 'support': 169688}}
[[27654 20442 12243]
 [20652 17780 10968]
 [23891 22091 13967]]
Evaluating performance on  train set...
260/260 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0797739
{'0': {'precision': 0.3714982335671991, 'recall': 0.38152179467525166, 'f1-score': 0.3764433015680936, 'support': 19569}, '1': {'precision': 0.4217024945076337, 'recall': 0.5772803410994366, 'f1-score': 0.4873768621338005, 'support': 26268}, '2': {'precision': 0.40173879812744817, 'recall': 0.20327757903896354, 'f1-score': 0.26995794947517093, 'support': 20686}, 'accuracy': 0.4033943147482825, 'macro avg': {'precision': 0.39831317540076033, 'recall': 0.38735990493788397, 'f1-score': 0.37792603772568834, 'support': 66523}, 'weighted avg': {'precision': 0.40072604717868154, 'recall': 0.4033943147482825, 'f1-score': 0.38713504390601866, 'support': 66523}}
[[ 7466  9557  2546]
 [ 7388 15164  3716]
 [ 5243 11238  4205]]
Evaluating performance on  val set...
51/51 - 1s - 1s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1025792
{'0': {'precision': 0.35442769165427906, 'recall': 0.4264179867143587, 'f1-score': 0.38710425605937615, 'support': 3914}, '1': {'precision': 0.41795423430471346, 'recall': 0.41398682681131344, 'f1-score': 0.4159610705596106, 'support': 5162}, '2': {'precision': 0.3401652892561983, 'recall': 0.2728719172633254, 'f1-score': 0.3028251912889935, 'support': 3771}, 'accuracy': 0.3763524558262629, 'macro avg': {'precision': 0.370849071738397, 'recall': 0.37109224359633247, 'f1-score': 0.36863017263599346, 'support': 12847}, 'weighted avg': {'precision': 0.37576656405393505, 'recall': 0.3763524558262629, 'f1-score': 0.3739605278116216, 'support': 12847}}
[[1669 1466  779]
 [1808 2137 1217]
 [1232 1510 1029]]
training model: results/LILAK/W1/deepLOB_L2/h30
Epoch 1/50
260/260 - 15s - loss: 3.3470 - accuracy30: 0.3493 - val_loss: 3.4431 - val_accuracy30: 0.3395 - 15s/epoch - 59ms/step
Epoch 2/50
260/260 - 13s - loss: 3.3110 - accuracy30: 0.3607 - val_loss: 3.3683 - val_accuracy30: 0.3420 - 13s/epoch - 50ms/step
Epoch 3/50
260/260 - 13s - loss: 3.2886 - accuracy30: 0.3715 - val_loss: 3.3644 - val_accuracy30: 0.3394 - 13s/epoch - 50ms/step
Epoch 4/50
260/260 - 13s - loss: 3.2653 - accuracy30: 0.3847 - val_loss: 3.3434 - val_accuracy30: 0.3395 - 13s/epoch - 50ms/step
Epoch 5/50
260/260 - 13s - loss: 3.2509 - accuracy30: 0.3973 - val_loss: 3.3209 - val_accuracy30: 0.3422 - 13s/epoch - 49ms/step
Epoch 6/50
260/260 - 13s - loss: 3.2322 - accuracy30: 0.4105 - val_loss: 3.3323 - val_accuracy30: 0.3500 - 13s/epoch - 50ms/step
Epoch 7/50
260/260 - 13s - loss: 3.2180 - accuracy30: 0.4189 - val_loss: 3.3311 - val_accuracy30: 0.3510 - 13s/epoch - 49ms/step
Epoch 8/50
260/260 - 13s - loss: 3.2059 - accuracy30: 0.4263 - val_loss: 3.3245 - val_accuracy30: 0.3541 - 13s/epoch - 49ms/step
Epoch 9/50
260/260 - 13s - loss: 3.1960 - accuracy30: 0.4318 - val_loss: 3.3346 - val_accuracy30: 0.3500 - 13s/epoch - 49ms/step
Epoch 10/50
260/260 - 12s - loss: 3.1841 - accuracy30: 0.4356 - val_loss: 3.3392 - val_accuracy30: 0.3511 - 12s/epoch - 48ms/step
Epoch 11/50
260/260 - 13s - loss: 3.1722 - accuracy30: 0.4430 - val_loss: 3.3343 - val_accuracy30: 0.3559 - 13s/epoch - 49ms/step
Epoch 12/50
260/260 - 13s - loss: 3.1580 - accuracy30: 0.4489 - val_loss: 3.3559 - val_accuracy30: 0.3433 - 13s/epoch - 49ms/step
Epoch 13/50
260/260 - 13s - loss: 3.1500 - accuracy30: 0.4495 - val_loss: 3.3453 - val_accuracy30: 0.3508 - 13s/epoch - 49ms/step
Epoch 14/50
260/260 - 13s - loss: 3.1404 - accuracy30: 0.4547 - val_loss: 3.3504 - val_accuracy30: 0.3554 - 13s/epoch - 50ms/step
Epoch 15/50
260/260 - 13s - loss: 3.1295 - accuracy30: 0.4594 - val_loss: 3.3642 - val_accuracy30: 0.3552 - 13s/epoch - 51ms/step
testing model: results/LILAK/W1/deepLOB_L2/h30
Evaluating performance on  test set...
663/663 - 13s - 13s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1324809
{'0': {'precision': 0.40708216029134486, 'recall': 0.24187781034667977, 'f1-score': 0.30345212653304837, 'support': 65161}, '1': {'precision': 0.23843905628088527, 'recall': 0.6246001964389151, 'f1-score': 0.34512701692863257, 'support': 39707}, '2': {'precision': 0.40672181622584114, 'recall': 0.1691453255168158, 'f1-score': 0.2389269642720943, 'support': 64820}, 'accuracy': 0.30365140728867096, 'macro avg': {'precision': 0.35074767759935704, 'recall': 0.3452077774341369, 'f1-score': 0.2958353692445918, 'support': 169688}, 'weighted avg': {'precision': 0.36748201630196864, 'recall': 0.30365140728867096, 'f1-score': 0.28855575115696064, 'support': 169688}}
[[15761 39425  9975]
 [ 8888 24801  6018]
 [14068 39788 10964]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1086121
{'0': {'precision': 0.3864596941520018, 'recall': 0.23003384868721982, 'f1-score': 0.28840143369175625, 'support': 21862}, '1': {'precision': 0.3349592823777438, 'recall': 0.7492371705963939, 'f1-score': 0.46294920870707884, 'support': 21630}, '2': {'precision': 0.41887675507020283, 'recall': 0.09326559854109678, 'f1-score': 0.15256223587485349, 'support': 23031}, 'accuracy': 0.3515024878613412, 'macro avg': {'precision': 0.3800985771999828, 'recall': 0.35751220594157024, 'f1-score': 0.3013042927578962, 'support': 66523}, 'weighted avg': {'precision': 0.3809374450551464, 'recall': 0.3515024878613412, 'f1-score': 0.29812672883269004, 'support': 66523}}
[[ 5029 15288  1545]
 [ 3989 16206  1435]
 [ 3995 16888  2148]]
Evaluating performance on  val set...
51/51 - 1s - 1s/epoch - 24ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.112734
{'0': {'precision': 0.3699070764832023, 'recall': 0.23869926199261993, 'f1-score': 0.29015979814970566, 'support': 4336}, '1': {'precision': 0.3382129054924464, 'recall': 0.6682091624248033, 'f1-score': 0.4491097115309851, 'support': 4322}, '2': {'precision': 0.3609271523178808, 'recall': 0.1301026497970876, 'f1-score': 0.1912616248464643, 'support': 4189}, 'accuracy': 0.34778547520821984, 'macro avg': {'precision': 0.35634904476450985, 'recall': 0.34567035807150365, 'f1-score': 0.310177044842385, 'support': 12847}, 'weighted avg': {'precision': 0.35631642424138876, 'recall': 0.34778547520821984, 'f1-score': 0.31138631622136537, 'support': 12847}}
[[1035 2855  446]
 [ 915 2888  519]
 [ 848 2796  545]]
training model: results/LILAK/W1/deepLOB_L2/h50
Epoch 1/50
260/260 - 15s - loss: 3.3471 - accuracy50: 0.3475 - val_loss: 3.3784 - val_accuracy50: 0.3584 - 15s/epoch - 56ms/step
Epoch 2/50
260/260 - 12s - loss: 3.3058 - accuracy50: 0.3610 - val_loss: 3.3494 - val_accuracy50: 0.3564 - 12s/epoch - 47ms/step
Epoch 3/50
260/260 - 12s - loss: 3.2902 - accuracy50: 0.3689 - val_loss: 3.3395 - val_accuracy50: 0.3564 - 12s/epoch - 48ms/step
Epoch 4/50
260/260 - 12s - loss: 3.2743 - accuracy50: 0.3797 - val_loss: 3.3052 - val_accuracy50: 0.3721 - 12s/epoch - 47ms/step
Epoch 5/50
260/260 - 12s - loss: 3.2574 - accuracy50: 0.3912 - val_loss: 3.3169 - val_accuracy50: 0.3655 - 12s/epoch - 48ms/step
Epoch 6/50
260/260 - 12s - loss: 3.2459 - accuracy50: 0.3995 - val_loss: 3.3143 - val_accuracy50: 0.3641 - 12s/epoch - 47ms/step
Epoch 7/50
260/260 - 12s - loss: 3.2347 - accuracy50: 0.4082 - val_loss: 3.3148 - val_accuracy50: 0.3709 - 12s/epoch - 47ms/step
Epoch 8/50
260/260 - 12s - loss: 3.2258 - accuracy50: 0.4143 - val_loss: 3.3310 - val_accuracy50: 0.3662 - 12s/epoch - 47ms/step
Epoch 9/50
260/260 - 12s - loss: 3.2131 - accuracy50: 0.4185 - val_loss: 3.3214 - val_accuracy50: 0.3691 - 12s/epoch - 47ms/step
Epoch 10/50
260/260 - 12s - loss: 3.2093 - accuracy50: 0.4211 - val_loss: 3.3276 - val_accuracy50: 0.3637 - 12s/epoch - 47ms/step
Epoch 11/50
260/260 - 13s - loss: 3.1960 - accuracy50: 0.4261 - val_loss: 3.3525 - val_accuracy50: 0.3628 - 13s/epoch - 49ms/step
Epoch 12/50
260/260 - 12s - loss: 3.1872 - accuracy50: 0.4316 - val_loss: 3.3636 - val_accuracy50: 0.3635 - 12s/epoch - 47ms/step
Epoch 13/50
260/260 - 12s - loss: 3.1805 - accuracy50: 0.4342 - val_loss: 3.3704 - val_accuracy50: 0.3647 - 12s/epoch - 47ms/step
Epoch 14/50
260/260 - 12s - loss: 3.1690 - accuracy50: 0.4396 - val_loss: 3.3966 - val_accuracy50: 0.3638 - 12s/epoch - 48ms/step
testing model: results/LILAK/W1/deepLOB_L2/h50
Evaluating performance on  test set...
663/663 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1229112
{'0': {'precision': 0.3839372765680858, 'recall': 0.15575661689574474, 'f1-score': 0.22160996084132528, 'support': 60678}, '1': {'precision': 0.28826814561011255, 'recall': 0.6147669570243157, 'f1-score': 0.39249355903612865, 'support': 48446}, '2': {'precision': 0.35267632618848044, 'recall': 0.24314774453470708, 'f1-score': 0.287844877295517, 'support': 60564}, 'accuracy': 0.31799537975578707, 'macro avg': {'precision': 0.3416272494555596, 'recall': 0.3378904394849225, 'f1-score': 0.30064946572432366, 'support': 169688}, 'weighted avg': {'precision': 0.34546623019367867, 'recall': 0.31799537975578707, 'f1-score': 0.29403746472066333, 'support': 169688}}
[[ 9451 36115 15112]
 [ 6746 29783 11917]
 [ 8419 37419 14726]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1088716
{'0': {'precision': 0.4052868521297472, 'recall': 0.16105504587155964, 'f1-score': 0.23050914223812494, 'support': 21800}, '1': {'precision': 0.3410666877996592, 'recall': 0.7834615209575388, 'f1-score': 0.4752439714549947, 'support': 21973}, '2': {'precision': 0.3851881938803141, 'recall': 0.12505494505494505, 'f1-score': 0.188810724714627, 'support': 22750}, 'accuracy': 0.35432857808577484, 'macro avg': {'precision': 0.3771805779365735, 'recall': 0.3565238372946811, 'f1-score': 0.29818794613591554, 'support': 66523}, 'weighted avg': {'precision': 0.37720101496065345, 'recall': 0.35432857808577484, 'f1-score': 0.2970864073001742, 'support': 66523}}
[[ 3511 15956  2333]
 [ 2550 17215  2208]
 [ 2602 17303  2845]]
Evaluating performance on  val set...
51/51 - 1s - 1s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1001216
{'0': {'precision': 0.3574677786201668, 'recall': 0.2306187331865982, 'f1-score': 0.28036271740746244, 'support': 4089}, '1': {'precision': 0.3880396889246447, 'recall': 0.5940065681444991, 'f1-score': 0.4694241686942417, 'support': 4872}, '2': {'precision': 0.32133769538349694, 'recall': 0.22748327328872878, 'f1-score': 0.26638541509718244, 'support': 3886}, 'accuracy': 0.3674787888222931, 'macro avg': {'precision': 0.35561505430943613, 'recall': 0.35070285820660874, 'f1-score': 0.33872410039962886, 'support': 12847}, 'weighted avg': {'precision': 0.35813290227126954, 'recall': 0.3674787888222931, 'f1-score': 0.3478330679866981, 'support': 12847}}
[[ 943 2335  811]
 [ 922 2894 1056]
 [ 773 2229  884]]
training model: results/LILAK/W1/deepLOB_L2/h100
Epoch 1/50
260/260 - 15s - loss: 3.3425 - accuracy100: 0.3552 - val_loss: 3.2698 - val_accuracy100: 0.4226 - 15s/epoch - 58ms/step
Epoch 2/50
260/260 - 12s - loss: 3.3047 - accuracy100: 0.3726 - val_loss: 3.2690 - val_accuracy100: 0.4495 - 12s/epoch - 47ms/step
Epoch 3/50
260/260 - 12s - loss: 3.2801 - accuracy100: 0.3839 - val_loss: 3.3051 - val_accuracy100: 0.3828 - 12s/epoch - 48ms/step
Epoch 4/50
260/260 - 13s - loss: 3.2697 - accuracy100: 0.3894 - val_loss: 3.3117 - val_accuracy100: 0.3940 - 13s/epoch - 48ms/step
Epoch 5/50
260/260 - 13s - loss: 3.2490 - accuracy100: 0.4027 - val_loss: 3.2932 - val_accuracy100: 0.3966 - 13s/epoch - 49ms/step
Epoch 6/50
260/260 - 12s - loss: 3.2352 - accuracy100: 0.4078 - val_loss: 3.3286 - val_accuracy100: 0.3698 - 12s/epoch - 48ms/step
Epoch 7/50
260/260 - 13s - loss: 3.2237 - accuracy100: 0.4155 - val_loss: 3.3651 - val_accuracy100: 0.3556 - 13s/epoch - 49ms/step
Epoch 8/50
260/260 - 12s - loss: 3.2030 - accuracy100: 0.4272 - val_loss: 3.4112 - val_accuracy100: 0.3513 - 12s/epoch - 47ms/step
Epoch 9/50
260/260 - 12s - loss: 3.1904 - accuracy100: 0.4340 - val_loss: 3.4044 - val_accuracy100: 0.3555 - 12s/epoch - 48ms/step
Epoch 10/50
260/260 - 13s - loss: 3.1738 - accuracy100: 0.4405 - val_loss: 3.4680 - val_accuracy100: 0.3551 - 13s/epoch - 49ms/step
Epoch 11/50
260/260 - 13s - loss: 3.1563 - accuracy100: 0.4457 - val_loss: 3.5508 - val_accuracy100: 0.3435 - 13s/epoch - 48ms/step
Epoch 12/50
260/260 - 12s - loss: 3.1444 - accuracy100: 0.4507 - val_loss: 3.5271 - val_accuracy100: 0.3465 - 12s/epoch - 48ms/step
testing model: results/LILAK/W1/deepLOB_L2/h100
Evaluating performance on  test set...
663/663 - 12s - 12s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1690699
{'0': {'precision': 0.31385658027291874, 'recall': 0.0613355287885025, 'f1-score': 0.10261707988980716, 'support': 55873}, '1': {'precision': 0.352288300808771, 'recall': 0.9134939437418665, 'f1-score': 0.5084811872269095, 'support': 59938}, '2': {'precision': 0.3419952210274791, 'recall': 0.021252111290532137, 'f1-score': 0.0400174748798602, 'support': 53877}, 'accuracy': 0.34961222950355947, 'macro avg': {'precision': 0.33604670070305626, 'recall': 0.33202719460696706, 'f1-score': 0.21703858066552562, 'support': 169688}, 'weighted avg': {'precision': 0.3363658090540427, 'recall': 0.34961222950355947, 'f1-score': 0.22610255880670363, 'support': 169688}}
[[ 3427 51408  1038]
 [ 4020 54753  1165]
 [ 3472 49260  1145]]
Evaluating performance on  train set...
260/260 - 6s - 6s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1774325
{'0': {'precision': 0.3681305495560355, 'recall': 0.07003606811852257, 'f1-score': 0.11768316072113538, 'support': 21903}, '1': {'precision': 0.3283070826476811, 'recall': 0.8943372061110603, 'f1-score': 0.48029871278372804, 'support': 21862}, '2': {'precision': 0.3497501784439686, 'recall': 0.04306178047280077, 'f1-score': 0.07668231611893583, 'support': 22758}, 'accuracy': 0.33170482389549477, 'macro avg': {'precision': 0.34872927021589506, 'recall': 0.33581168490079455, 'f1-score': 0.2248880632079331, 'support': 66523}, 'weighted avg': {'precision': 0.3487549784104338, 'recall': 0.33170482389549477, 'f1-score': 0.22282580278080716, 'support': 66523}}
[[ 1534 19527   842]
 [ 1330 19552   980]
 [ 1303 20475   980]]
Evaluating performance on  val set...
51/51 - 1s - 1s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0916241
{'0': {'precision': 0.30032292787944026, 'recall': 0.08093994778067885, 'f1-score': 0.12751371115173674, 'support': 3447}, '1': {'precision': 0.4737650139980132, 'recall': 0.8569095066971578, 'f1-score': 0.6101773771445187, 'support': 6122}, '2': {'precision': 0.22130177514792898, 'recall': 0.05704697986577181, 'f1-score': 0.0907106475867087, 'support': 3278}, 'accuracy': 0.4446174204094341, 'macro avg': {'precision': 0.33179657234179416, 'recall': 0.3316321447812028, 'f1-score': 0.276133911960988, 'support': 12847}, 'weighted avg': {'precision': 0.36281075480899655, 'recall': 0.4446174204094341, 'f1-score': 0.3481275915005847, 'support': 12847}}
[[ 279 2939  229]
 [ 447 5246  429]
 [ 203 2888  187]]
training model: results/LILAK/W1/deepLOB_L2/h200
Epoch 1/50
260/260 - 15s - loss: 3.3490 - accuracy200: 0.3506 - val_loss: 3.3417 - val_accuracy200: 0.3790 - 15s/epoch - 57ms/step
Epoch 2/50
260/260 - 12s - loss: 3.3134 - accuracy200: 0.3592 - val_loss: 3.3218 - val_accuracy200: 0.3750 - 12s/epoch - 48ms/step
Epoch 3/50
260/260 - 12s - loss: 3.2908 - accuracy200: 0.3741 - val_loss: 3.3243 - val_accuracy200: 0.3658 - 12s/epoch - 47ms/step
Epoch 4/50
260/260 - 13s - loss: 3.2701 - accuracy200: 0.3816 - val_loss: 3.3184 - val_accuracy200: 0.3662 - 13s/epoch - 49ms/step
Epoch 5/50
260/260 - 13s - loss: 3.2647 - accuracy200: 0.3903 - val_loss: 3.3192 - val_accuracy200: 0.3732 - 13s/epoch - 49ms/step
Epoch 6/50
260/260 - 13s - loss: 3.2450 - accuracy200: 0.4001 - val_loss: 3.3313 - val_accuracy200: 0.3636 - 13s/epoch - 48ms/step
Epoch 7/50
260/260 - 13s - loss: 3.2369 - accuracy200: 0.4054 - val_loss: 3.3427 - val_accuracy200: 0.3609 - 13s/epoch - 48ms/step
Epoch 8/50
260/260 - 12s - loss: 3.2182 - accuracy200: 0.4188 - val_loss: 3.3747 - val_accuracy200: 0.3535 - 12s/epoch - 48ms/step
Epoch 9/50
260/260 - 13s - loss: 3.2052 - accuracy200: 0.4205 - val_loss: 3.3827 - val_accuracy200: 0.3625 - 13s/epoch - 48ms/step
Epoch 10/50
260/260 - 12s - loss: 3.1956 - accuracy200: 0.4249 - val_loss: 3.4319 - val_accuracy200: 0.3665 - 12s/epoch - 48ms/step
Epoch 11/50
260/260 - 12s - loss: 3.1825 - accuracy200: 0.4319 - val_loss: 3.4549 - val_accuracy200: 0.3547 - 12s/epoch - 47ms/step
Epoch 12/50
260/260 - 12s - loss: 3.1691 - accuracy200: 0.4374 - val_loss: 3.4374 - val_accuracy200: 0.3588 - 12s/epoch - 47ms/step
Epoch 13/50
260/260 - 12s - loss: 3.1549 - accuracy200: 0.4448 - val_loss: 3.4845 - val_accuracy200: 0.3626 - 12s/epoch - 47ms/step
Epoch 14/50
260/260 - 13s - loss: 3.1443 - accuracy200: 0.4469 - val_loss: 3.5513 - val_accuracy200: 0.3661 - 13s/epoch - 48ms/step
testing model: results/LILAK/W1/deepLOB_L2/h200
Evaluating performance on  test set...
663/663 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1363446
{'0': {'precision': 0.39115508885298866, 'recall': 0.125337690279373, 'f1-score': 0.189843797856049, 'support': 61817}, '1': {'precision': 0.3114593606254094, 'recall': 0.8281875083743276, 'f1-score': 0.4526783845992886, 'support': 52243}, '2': {'precision': 0.32326917814466843, 'recall': 0.06370892356367297, 'f1-score': 0.10644081031971288, 'support': 55628}, 'accuracy': 0.32152538777049644, 'macro avg': {'precision': 0.34196120920768885, 'recall': 0.33907804073912456, 'f1-score': 0.2496543309250168, 'support': 169688}, 'weighted avg': {'precision': 0.3443639110992532, 'recall': 0.32152538777049644, 'f1-score': 0.24342287194824033, 'support': 169688}}
[[ 7748 49850  4219]
 [ 5776 43267  3200]
 [ 6284 45800  3544]]
Evaluating performance on  train set...
260/260 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1339326
{'0': {'precision': 0.3707627118644068, 'recall': 0.11238532110091744, 'f1-score': 0.1724866234863419, 'support': 21800}, '1': {'precision': 0.33624446596568897, 'recall': 0.8837727272727273, 'f1-score': 0.48714672279013826, 'support': 22000}, '2': {'precision': 0.3935915829746533, 'recall': 0.03621880913611759, 'f1-score': 0.06633352139921012, 'support': 22723}, 'accuracy': 0.34147588052252603, 'macro avg': {'precision': 0.366866253601583, 'recall': 0.34412561916992074, 'f1-score': 0.24198895589189676, 'support': 66523}, 'weighted avg': {'precision': 0.367145001124758, 'recall': 0.34147588052252603, 'f1-score': 0.24028881590035844, 'support': 66523}}
[[ 2450 18682   668]
 [ 1957 19443   600]
 [ 2201 19699   823]]
Evaluating performance on  val set...
51/51 - 1s - 1s/epoch - 24ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1061127
{'0': {'precision': 0.31216032608695654, 'recall': 0.22458455522971651, 'f1-score': 0.2612279704377487, 'support': 4092}, '1': {'precision': 0.38799775659001684, 'recall': 0.6821139814632222, 'f1-score': 0.4946374946374947, 'support': 5071}, '2': {'precision': 0.3410931174089069, 'recall': 0.09147665580890336, 'f1-score': 0.144263698630137, 'support': 3684}, 'accuracy': 0.36701175371682104, 'macro avg': {'precision': 0.3470837333619601, 'recall': 0.3327250641672807, 'f1-score': 0.30004305456846014, 'support': 12847}, 'weighted avg': {'precision': 0.3503918208570261, 'recall': 0.36701175371682104, 'f1-score': 0.3198193396194775, 'support': 12847}}
[[ 919 2887  286]
 [1247 3459  365]
 [ 778 2569  337]]
training model: results/LILAK/W1/deepLOB_L2/h300
Epoch 1/50
260/260 - 15s - loss: 3.3270 - accuracy300: 0.3666 - val_loss: 3.3337 - val_accuracy300: 0.3903 - 15s/epoch - 58ms/step
Epoch 2/50
260/260 - 13s - loss: 3.3100 - accuracy300: 0.3712 - val_loss: 3.2880 - val_accuracy300: 0.4278 - 13s/epoch - 49ms/step
Epoch 3/50
260/260 - 13s - loss: 3.2912 - accuracy300: 0.3757 - val_loss: 3.2704 - val_accuracy300: 0.4100 - 13s/epoch - 48ms/step
Epoch 4/50
260/260 - 12s - loss: 3.2784 - accuracy300: 0.3770 - val_loss: 3.2461 - val_accuracy300: 0.4209 - 12s/epoch - 47ms/step
Epoch 5/50
260/260 - 12s - loss: 3.2649 - accuracy300: 0.3853 - val_loss: 3.2803 - val_accuracy300: 0.3857 - 12s/epoch - 48ms/step
Epoch 6/50
260/260 - 13s - loss: 3.2508 - accuracy300: 0.3964 - val_loss: 3.3048 - val_accuracy300: 0.3894 - 13s/epoch - 48ms/step
Epoch 7/50
260/260 - 13s - loss: 3.2450 - accuracy300: 0.3984 - val_loss: 3.3623 - val_accuracy300: 0.3777 - 13s/epoch - 48ms/step
Epoch 8/50
260/260 - 13s - loss: 3.2284 - accuracy300: 0.4072 - val_loss: 3.3540 - val_accuracy300: 0.3697 - 13s/epoch - 49ms/step
Epoch 9/50
260/260 - 13s - loss: 3.2090 - accuracy300: 0.4185 - val_loss: 3.4052 - val_accuracy300: 0.3648 - 13s/epoch - 49ms/step
Epoch 10/50
260/260 - 12s - loss: 3.1981 - accuracy300: 0.4227 - val_loss: 3.4588 - val_accuracy300: 0.3434 - 12s/epoch - 47ms/step
Epoch 11/50
260/260 - 12s - loss: 3.1754 - accuracy300: 0.4316 - val_loss: 3.5035 - val_accuracy300: 0.3567 - 12s/epoch - 47ms/step
Epoch 12/50
260/260 - 12s - loss: 3.1542 - accuracy300: 0.4428 - val_loss: 3.5649 - val_accuracy300: 0.3416 - 12s/epoch - 47ms/step
Epoch 13/50
260/260 - 12s - loss: 3.1442 - accuracy300: 0.4446 - val_loss: 3.6614 - val_accuracy300: 0.3388 - 12s/epoch - 47ms/step
Epoch 14/50
260/260 - 12s - loss: 3.1181 - accuracy300: 0.4547 - val_loss: 3.7293 - val_accuracy300: 0.3293 - 12s/epoch - 48ms/step
testing model: results/LILAK/W1/deepLOB_L2/h300
Evaluating performance on  test set...
663/663 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1256453
{'0': {'precision': 0.3186680729245141, 'recall': 0.1448878232574071, 'f1-score': 0.1992041253620288, 'support': 58390}, '1': {'precision': 0.3450759194900292, 'recall': 0.6256844872032484, 'f1-score': 0.44482376545982694, 'support': 59351}, '2': {'precision': 0.3076338456341834, 'recall': 0.21038751034708453, 'f1-score': 0.249882820984761, 'support': 51947}, 'accuracy': 0.333105464145962, 'macro avg': {'precision': 0.3237926126829089, 'recall': 0.32698660693591336, 'f1-score': 0.29797023726887223, 'support': 169688}, 'weighted avg': {'precision': 0.3245266904841475, 'recall': 0.333105464145962, 'f1-score': 0.3006277820788178, 'support': 169688}}
[[ 8460 38097 11833]
 [ 9452 37135 12764]
 [ 8636 32382 10929]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1311301
{'0': {'precision': 0.35305698348463305, 'recall': 0.14817535001147578, 'f1-score': 0.2087428867046042, 'support': 21785}, '1': {'precision': 0.3438508778836312, 'recall': 0.7973799525287566, 'f1-score': 0.4804984046649796, 'support': 21908}, '2': {'precision': 0.41545012165450124, 'recall': 0.11966710468681559, 'f1-score': 0.18581241923416988, 'support': 22830}, 'accuracy': 0.3521939780226388, 'macro avg': {'precision': 0.3707859943409218, 'recall': 0.3550741357423493, 'f1-score': 0.2916845702012512, 'support': 66523}, 'weighted avg': {'precision': 0.3714378139178868, 'recall': 0.3521939780226388, 'f1-score': 0.29037055405463186, 'support': 66523}}
[[ 3228 16354  2203]
 [ 2798 17469  1641]
 [ 3117 16981  2732]]
Evaluating performance on  val set...
51/51 - 1s - 1s/epoch - 23ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0803535
{'0': {'precision': 0.34101941747572817, 'recall': 0.14355044699872285, 'f1-score': 0.20204925399964047, 'support': 3915}, '1': {'precision': 0.4398887400844751, 'recall': 0.7679856115107914, 'f1-score': 0.5593764328289774, 'support': 5560}, '2': {'precision': 0.3820375335120643, 'recall': 0.16903914590747332, 'f1-score': 0.234375, 'support': 3372}, 'accuracy': 0.4204872732933759, 'macro avg': {'precision': 0.38764856369075584, 'recall': 0.3601917348056625, 'f1-score': 0.33193356227620596, 'support': 12847}, 'weighted avg': {'precision': 0.3945748406079114, 'recall': 0.4204872732933759, 'f1-score': 0.3651800650687092, 'support': 12847}}
[[ 562 3023  330]
 [ 698 4270  592]
 [ 388 2414  570]]
training model: results/LILAK/W1/deepLOB_L2/h500
Epoch 1/50
260/260 - 15s - loss: 3.3335 - accuracy500: 0.3603 - val_loss: 3.3427 - val_accuracy500: 0.3925 - 15s/epoch - 59ms/step
Epoch 2/50
260/260 - 13s - loss: 3.2911 - accuracy500: 0.3850 - val_loss: 3.3506 - val_accuracy500: 0.3666 - 13s/epoch - 49ms/step
Epoch 3/50
260/260 - 12s - loss: 3.2597 - accuracy500: 0.3965 - val_loss: 3.4718 - val_accuracy500: 0.3528 - 12s/epoch - 48ms/step
Epoch 4/50
260/260 - 12s - loss: 3.2485 - accuracy500: 0.4041 - val_loss: 3.5687 - val_accuracy500: 0.3248 - 12s/epoch - 47ms/step
Epoch 5/50
260/260 - 12s - loss: 3.2286 - accuracy500: 0.4158 - val_loss: 3.6263 - val_accuracy500: 0.3429 - 12s/epoch - 47ms/step
Epoch 6/50
260/260 - 12s - loss: 3.2242 - accuracy500: 0.4192 - val_loss: 3.7054 - val_accuracy500: 0.3170 - 12s/epoch - 47ms/step
Epoch 7/50
260/260 - 12s - loss: 3.1898 - accuracy500: 0.4299 - val_loss: 3.7164 - val_accuracy500: 0.3175 - 12s/epoch - 47ms/step
Epoch 8/50
260/260 - 12s - loss: 3.1548 - accuracy500: 0.4462 - val_loss: 3.7637 - val_accuracy500: 0.3209 - 12s/epoch - 47ms/step
Epoch 9/50
260/260 - 12s - loss: 3.1325 - accuracy500: 0.4553 - val_loss: 3.8476 - val_accuracy500: 0.3300 - 12s/epoch - 47ms/step
Epoch 10/50
260/260 - 12s - loss: 3.1121 - accuracy500: 0.4620 - val_loss: 4.0036 - val_accuracy500: 0.3154 - 12s/epoch - 47ms/step
Epoch 11/50
260/260 - 12s - loss: 3.0900 - accuracy500: 0.4690 - val_loss: 3.9884 - val_accuracy500: 0.3184 - 12s/epoch - 48ms/step
testing model: results/LILAK/W1/deepLOB_L2/h500
Evaluating performance on  test set...
663/663 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1303573
{'0': {'precision': 0.3098406374501992, 'recall': 0.13886260155343272, 'f1-score': 0.19177609271931448, 'support': 56005}, '1': {'precision': 0.3925691772035917, 'recall': 0.667315629623861, 'f1-score': 0.49433211226167467, 'support': 64205}, '2': {'precision': 0.3274091627172196, 'recall': 0.2345688993087837, 'f1-score': 0.27332030238089633, 'support': 49478}, 'accuracy': 0.36672009806232614, 'macro avg': {'precision': 0.3432729924570035, 'recall': 0.3469157101620259, 'f1-score': 0.31980950245396184, 'support': 169688}, 'weighted avg': {'precision': 0.3462653780802272, 'recall': 0.36672009806232614, 'f1-score': 0.33003132373360533, 'support': 169688}}
[[ 7777 35958 12270]
 [ 9788 42845 11572]
 [ 7535 30337 11606]]
Evaluating performance on  train set...
260/260 - 6s - 6s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1625159
{'0': {'precision': 0.36345363179534035, 'recall': 0.18135400045589242, 'f1-score': 0.24197080291970804, 'support': 21935}, '1': {'precision': 0.3370040642539191, 'recall': 0.7947875302387147, 'f1-score': 0.4733143967708178, 'support': 21909}, '2': {'precision': 0.381525076765609, 'recall': 0.06574363949027735, 'f1-score': 0.11216007823372326, 'support': 22679}, 'accuracy': 0.3439712580611217, 'macro avg': {'precision': 0.36066092427162283, 'recall': 0.34729505672829486, 'f1-score': 0.2758150926414164, 'support': 66523}, 'weighted avg': {'precision': 0.3609035171765728, 'recall': 0.3439712580611217, 'f1-score': 0.2739075672347647, 'support': 66523}}
[[ 3978 16712  1245]
 [ 3324 17413  1172]
 [ 3643 17545  1491]]
Evaluating performance on  val set...
51/51 - 1s - 1s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1168998
{'0': {'precision': 0.3333333333333333, 'recall': 0.15698393077873918, 'f1-score': 0.2134453781512605, 'support': 4045}, '1': {'precision': 0.4200169276343631, 'recall': 0.7222121156994724, 'f1-score': 0.5311392066358953, 'support': 5497}, '2': {'precision': 0.24697986577181208, 'recall': 0.1113464447806354, 'f1-score': 0.1534932221063608, 'support': 3305}, 'accuracy': 0.3870942632521211, 'macro avg': {'precision': 0.3334433755798362, 'recall': 0.33018083041961566, 'f1-score': 0.29935926896450554, 'support': 12847}, 'weighted avg': {'precision': 0.3482085187915674, 'recall': 0.3870942632521211, 'f1-score': 0.33395764556401397, 'support': 12847}}
[[ 635 2976  434]
 [ 839 3970  688]
 [ 431 2506  368]]
training model: results/LILAK/W1/deepLOB_L2/h1000
Epoch 1/50
260/260 - 15s - loss: 3.3168 - accuracy1000: 0.3767 - val_loss: 3.3379 - val_accuracy1000: 0.3869 - 15s/epoch - 57ms/step
Epoch 2/50
260/260 - 13s - loss: 3.2769 - accuracy1000: 0.3966 - val_loss: 3.3959 - val_accuracy1000: 0.3736 - 13s/epoch - 49ms/step
Epoch 3/50
260/260 - 13s - loss: 3.2325 - accuracy1000: 0.4156 - val_loss: 3.4319 - val_accuracy1000: 0.3863 - 13s/epoch - 48ms/step
Epoch 4/50
260/260 - 13s - loss: 3.2029 - accuracy1000: 0.4238 - val_loss: 3.3995 - val_accuracy1000: 0.3941 - 13s/epoch - 49ms/step
Epoch 5/50
260/260 - 13s - loss: 3.2092 - accuracy1000: 0.4203 - val_loss: 3.4816 - val_accuracy1000: 0.3758 - 13s/epoch - 48ms/step
Epoch 6/50
260/260 - 13s - loss: 3.1769 - accuracy1000: 0.4349 - val_loss: 3.4211 - val_accuracy1000: 0.3749 - 13s/epoch - 49ms/step
Epoch 7/50
260/260 - 13s - loss: 3.1655 - accuracy1000: 0.4358 - val_loss: 3.4178 - val_accuracy1000: 0.3778 - 13s/epoch - 49ms/step
Epoch 8/50
260/260 - 13s - loss: 3.1257 - accuracy1000: 0.4565 - val_loss: 3.4711 - val_accuracy1000: 0.3708 - 13s/epoch - 49ms/step
Epoch 9/50
260/260 - 13s - loss: 3.0972 - accuracy1000: 0.4644 - val_loss: 3.6040 - val_accuracy1000: 0.3701 - 13s/epoch - 49ms/step
Epoch 10/50
260/260 - 13s - loss: 3.0733 - accuracy1000: 0.4726 - val_loss: 3.7138 - val_accuracy1000: 0.3665 - 13s/epoch - 49ms/step
Epoch 11/50
260/260 - 13s - loss: 3.0456 - accuracy1000: 0.4835 - val_loss: 3.7525 - val_accuracy1000: 0.3638 - 13s/epoch - 49ms/step
testing model: results/LILAK/W1/deepLOB_L2/h1000
Evaluating performance on  test set...
663/663 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1391203
{'0': {'precision': 0.3396264420435818, 'recall': 0.3258661887694146, 'f1-score': 0.33260405645320373, 'support': 56916}, '1': {'precision': 0.37549684358194996, 'recall': 0.4737757351799522, 'f1-score': 0.4189498108725947, 'support': 64406}, '2': {'precision': 0.3157178766819459, 'recall': 0.22073357317123599, 'f1-score': 0.25981674596317883, 'support': 48366}, 'accuracy': 0.3520402149827919, 'macro avg': {'precision': 0.3436137207691592, 'recall': 0.3401251657068676, 'f1-score': 0.3371235377629924, 'support': 169688}, 'weighted avg': {'precision': 0.3464266129996851, 'recall': 0.3520402149827919, 'f1-score': 0.34463056156832533, 'support': 169688}}
[[18547 28989  9380]
 [20133 30514 13759]
 [15930 21760 10676]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1632402
{'0': {'precision': 0.3465281334601595, 'recall': 0.22198265760487462, 'f1-score': 0.27061310782241016, 'support': 21335}, '1': {'precision': 0.3507801743919229, 'recall': 0.6899711139194801, 'f1-score': 0.4651028355847633, 'support': 22156}, '2': {'precision': 0.423134971970677, 'recall': 0.1704150746787079, 'f1-score': 0.242973876439272, 'support': 23032}, 'accuracy': 0.359995790929453, 'macro avg': {'precision': 0.3734810932742531, 'recall': 0.36078961540102084, 'f1-score': 0.32622993994881516, 'support': 66523}, 'weighted avg': {'precision': 0.3744675968556526, 'recall': 0.359995790929453, 'f1-score': 0.32581999312653437, 'support': 66523}}
[[ 4736 14124  2475]
 [ 3993 15287  2876]
 [ 4938 14169  3925]]
Evaluating performance on  val set...
51/51 - 1s - 1s/epoch - 24ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1088812
{'0': {'precision': 0.3720862470862471, 'recall': 0.3011082291912285, 'f1-score': 0.3328554672227291, 'support': 4241}, '1': {'precision': 0.4110567385266499, 'recall': 0.5899772209567198, 'f1-score': 0.48452724296515703, 'support': 5268}, '2': {'precision': 0.2988133764832794, 'recall': 0.16596764529658478, 'f1-score': 0.21340523882896764, 'support': 3338}, 'accuracy': 0.38444773098777923, 'macro avg': {'precision': 0.3606521206987255, 'recall': 0.35235103181484434, 'f1-score': 0.3435959830056179, 'support': 12847}, 'weighted avg': {'precision': 0.36902807839591756, 'recall': 0.38444773098777923, 'f1-score': 0.36401309563657935, 'support': 12847}}
[[1277 2393  571]
 [1431 3108  729]
 [ 724 2060  554]]
training model: results/LILAK/W1/deepOF_L2/h10
Epoch 1/50
260/260 - 11s - loss: 3.3282 - accuracy10: 0.3579 - val_loss: 3.2970 - val_accuracy10: 0.3877 - 11s/epoch - 41ms/step
Epoch 2/50
260/260 - 8s - loss: 3.2820 - accuracy10: 0.3931 - val_loss: 3.2771 - val_accuracy10: 0.4037 - 8s/epoch - 31ms/step
Epoch 3/50
260/260 - 8s - loss: 3.2553 - accuracy10: 0.4082 - val_loss: 3.2585 - val_accuracy10: 0.4150 - 8s/epoch - 31ms/step
Epoch 4/50
260/260 - 8s - loss: 3.2267 - accuracy10: 0.4236 - val_loss: 3.2478 - val_accuracy10: 0.4255 - 8s/epoch - 31ms/step
Epoch 5/50
260/260 - 8s - loss: 3.2089 - accuracy10: 0.4299 - val_loss: 3.2282 - val_accuracy10: 0.4326 - 8s/epoch - 32ms/step
Epoch 6/50
260/260 - 8s - loss: 3.1856 - accuracy10: 0.4379 - val_loss: 3.2209 - val_accuracy10: 0.4354 - 8s/epoch - 33ms/step
Epoch 7/50
260/260 - 8s - loss: 3.1646 - accuracy10: 0.4462 - val_loss: 3.2065 - val_accuracy10: 0.4485 - 8s/epoch - 31ms/step
Epoch 8/50
260/260 - 8s - loss: 3.1488 - accuracy10: 0.4522 - val_loss: 3.2049 - val_accuracy10: 0.4403 - 8s/epoch - 30ms/step
Epoch 9/50
260/260 - 8s - loss: 3.1337 - accuracy10: 0.4562 - val_loss: 3.1955 - val_accuracy10: 0.4332 - 8s/epoch - 32ms/step
Epoch 10/50
260/260 - 8s - loss: 3.1182 - accuracy10: 0.4582 - val_loss: 3.2090 - val_accuracy10: 0.4277 - 8s/epoch - 30ms/step
Epoch 11/50
260/260 - 8s - loss: 3.1006 - accuracy10: 0.4625 - val_loss: 3.2071 - val_accuracy10: 0.4290 - 8s/epoch - 30ms/step
Epoch 12/50
260/260 - 8s - loss: 3.0900 - accuracy10: 0.4684 - val_loss: 3.2090 - val_accuracy10: 0.4435 - 8s/epoch - 30ms/step
Epoch 13/50
260/260 - 8s - loss: 3.0744 - accuracy10: 0.4691 - val_loss: 3.2070 - val_accuracy10: 0.4452 - 8s/epoch - 30ms/step
Epoch 14/50
260/260 - 8s - loss: 3.0588 - accuracy10: 0.4736 - val_loss: 3.2090 - val_accuracy10: 0.4457 - 8s/epoch - 30ms/step
Epoch 15/50
260/260 - 8s - loss: 3.0412 - accuracy10: 0.4757 - val_loss: 3.2128 - val_accuracy10: 0.4405 - 8s/epoch - 31ms/step
Epoch 16/50
260/260 - 8s - loss: 3.0249 - accuracy10: 0.4804 - val_loss: 3.2320 - val_accuracy10: 0.4298 - 8s/epoch - 32ms/step
Epoch 17/50
260/260 - 8s - loss: 3.0104 - accuracy10: 0.4818 - val_loss: 3.2448 - val_accuracy10: 0.4255 - 8s/epoch - 32ms/step
Epoch 18/50
260/260 - 8s - loss: 2.9930 - accuracy10: 0.4858 - val_loss: 3.2709 - val_accuracy10: 0.4301 - 8s/epoch - 32ms/step
Epoch 19/50
260/260 - 8s - loss: 2.9802 - accuracy10: 0.4891 - val_loss: 3.2717 - val_accuracy10: 0.4288 - 8s/epoch - 31ms/step
testing model: results/LILAK/W1/deepOF_L2/h10
Evaluating performance on  test set...
663/663 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0676843
{'0': {'precision': 0.4062837205956406, 'recall': 0.43652419230174677, 'f1-score': 0.4208614329893066, 'support': 51752}, '1': {'precision': 0.5239251614327501, 'recall': 0.42812687913409503, 'f1-score': 0.4712062675281485, 'support': 66520}, '2': {'precision': 0.3774990790663407, 'recall': 0.4385248293166832, 'f1-score': 0.40573007117597837, 'support': 51411}, 'accuracy': 0.4338383927676903, 'macro avg': {'precision': 0.4359026536982438, 'recall': 0.4343919669175083, 'f1-score': 0.4325992572311445, 'support': 169683}, 'weighted avg': {'precision': 0.44368087551877194, 'recall': 0.4338383927676903, 'f1-score': 0.4360133336000852, 'support': 169683}}
[[22591 12929 16232]
 [17096 28479 20945]
 [15917 12949 22545]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0443183
{'0': {'precision': 0.37544545350040237, 'recall': 0.40973529042780077, 'f1-score': 0.39184163167366526, 'support': 15942}, '1': {'precision': 0.6338341905957636, 'recall': 0.4632781741215476, 'f1-score': 0.5352989465043098, 'support': 33781}, '2': {'precision': 0.347712204305476, 'recall': 0.5057142857142857, 'f1-score': 0.4120871125769996, 'support': 16800}, 'accuracy': 0.46116380800625345, 'macro avg': {'precision': 0.4523306161338807, 'recall': 0.4595759167545446, 'f1-score': 0.44640923025165824, 'support': 66523}, 'weighted avg': {'precision': 0.4996537925912977, 'recall': 0.46116380800625345, 'f1-score': 0.4698034739157472, 'support': 66523}}
[[ 6532  4330  5080]
 [ 7273 15650 10858]
 [ 3593  4711  8496]]
Evaluating performance on  val set...
51/51 - 1s - 940ms/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0685966
{'0': {'precision': 0.31809775429326287, 'recall': 0.3834394904458599, 'f1-score': 0.34772563176895305, 'support': 3140}, '1': {'precision': 0.6092228185251441, 'recall': 0.46474601971190294, 'f1-score': 0.527266471701359, 'support': 6595}, '2': {'precision': 0.33316794839990077, 'recall': 0.4315552699228792, 'f1-score': 0.37603247935041306, 'support': 3112}, 'accuracy': 0.4368335019848992, 'macro avg': {'precision': 0.42016284040610263, 'recall': 0.4265802600268807, 'f1-score': 0.41700819427357505, 'support': 12847}, 'weighted avg': {'precision': 0.4711971738207101, 'recall': 0.4368335019848992, 'f1-score': 0.4467497423805916, 'support': 12847}}
[[1204 1041  895]
 [1737 3065 1793]
 [ 844  925 1343]]
training model: results/LILAK/W1/deepOF_L2/h20
Epoch 1/50
260/260 - 11s - loss: 3.3296 - accuracy20: 0.3520 - val_loss: 3.3116 - val_accuracy20: 0.3721 - 11s/epoch - 43ms/step
Epoch 2/50
260/260 - 8s - loss: 3.2916 - accuracy20: 0.3762 - val_loss: 3.2952 - val_accuracy20: 0.3853 - 8s/epoch - 33ms/step
Epoch 3/50
260/260 - 9s - loss: 3.2705 - accuracy20: 0.3874 - val_loss: 3.2839 - val_accuracy20: 0.3873 - 9s/epoch - 35ms/step
Epoch 4/50
260/260 - 8s - loss: 3.2513 - accuracy20: 0.4004 - val_loss: 3.2765 - val_accuracy20: 0.3977 - 8s/epoch - 32ms/step
Epoch 5/50
260/260 - 8s - loss: 3.2351 - accuracy20: 0.4081 - val_loss: 3.2605 - val_accuracy20: 0.4044 - 8s/epoch - 32ms/step
Epoch 6/50
260/260 - 8s - loss: 3.2205 - accuracy20: 0.4142 - val_loss: 3.2631 - val_accuracy20: 0.4068 - 8s/epoch - 32ms/step
Epoch 7/50
260/260 - 8s - loss: 3.2057 - accuracy20: 0.4232 - val_loss: 3.2460 - val_accuracy20: 0.4132 - 8s/epoch - 31ms/step
Epoch 8/50
260/260 - 8s - loss: 3.1919 - accuracy20: 0.4279 - val_loss: 3.2513 - val_accuracy20: 0.4094 - 8s/epoch - 32ms/step
Epoch 9/50
260/260 - 8s - loss: 3.1771 - accuracy20: 0.4337 - val_loss: 3.2437 - val_accuracy20: 0.4118 - 8s/epoch - 31ms/step
Epoch 10/50
260/260 - 8s - loss: 3.1647 - accuracy20: 0.4394 - val_loss: 3.2496 - val_accuracy20: 0.4151 - 8s/epoch - 32ms/step
Epoch 11/50
260/260 - 9s - loss: 3.1532 - accuracy20: 0.4437 - val_loss: 3.2413 - val_accuracy20: 0.4172 - 9s/epoch - 33ms/step
Epoch 12/50
260/260 - 8s - loss: 3.1426 - accuracy20: 0.4463 - val_loss: 3.2470 - val_accuracy20: 0.4115 - 8s/epoch - 31ms/step
Epoch 13/50
260/260 - 8s - loss: 3.1292 - accuracy20: 0.4509 - val_loss: 3.2505 - val_accuracy20: 0.4166 - 8s/epoch - 30ms/step
Epoch 14/50
260/260 - 8s - loss: 3.1199 - accuracy20: 0.4554 - val_loss: 3.2525 - val_accuracy20: 0.4153 - 8s/epoch - 30ms/step
Epoch 15/50
260/260 - 8s - loss: 3.1044 - accuracy20: 0.4608 - val_loss: 3.2414 - val_accuracy20: 0.4201 - 8s/epoch - 31ms/step
Epoch 16/50
260/260 - 8s - loss: 3.0921 - accuracy20: 0.4622 - val_loss: 3.2604 - val_accuracy20: 0.4129 - 8s/epoch - 31ms/step
Epoch 17/50
260/260 - 8s - loss: 3.0804 - accuracy20: 0.4673 - val_loss: 3.2733 - val_accuracy20: 0.4187 - 8s/epoch - 32ms/step
Epoch 18/50
260/260 - 8s - loss: 3.0631 - accuracy20: 0.4716 - val_loss: 3.2745 - val_accuracy20: 0.4123 - 8s/epoch - 31ms/step
Epoch 19/50
260/260 - 8s - loss: 3.0510 - accuracy20: 0.4746 - val_loss: 3.2890 - val_accuracy20: 0.4198 - 8s/epoch - 31ms/step
Epoch 20/50
260/260 - 8s - loss: 3.0358 - accuracy20: 0.4806 - val_loss: 3.2837 - val_accuracy20: 0.4154 - 8s/epoch - 31ms/step
Epoch 21/50
260/260 - 8s - loss: 3.0206 - accuracy20: 0.4831 - val_loss: 3.3081 - val_accuracy20: 0.4139 - 8s/epoch - 32ms/step
testing model: results/LILAK/W1/deepOF_L2/h20
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0759965
{'0': {'precision': 0.4419589221351336, 'recall': 0.38409267945042014, 'f1-score': 0.4109989891286999, 'support': 60337}, '1': {'precision': 0.3821422189007847, 'recall': 0.4761634850907913, 'f1-score': 0.4240031725430817, 'support': 49399}, '2': {'precision': 0.4282046217657515, 'recall': 0.3978180726308239, 'f1-score': 0.4124524386025597, 'support': 59947}, 'accuracy': 0.41574583193366454, 'macro avg': {'precision': 0.4174352542672233, 'recall': 0.4193580790573452, 'f1-score': 0.41581820009144704, 'support': 169683}, 'weighted avg': {'precision': 0.4196855396082043, 'recall': 0.41574583193366454, 'f1-score': 0.4152983213664404, 'support': 169683}}
[[23175 19281 17881]
 [11913 23522 13964]
 [17349 18750 23848]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0504305
{'0': {'precision': 0.4144827586206897, 'recall': 0.39927432542927227, 'f1-score': 0.4067364256338175, 'support': 19568}, '1': {'precision': 0.4974288779549406, 'recall': 0.512580054894785, 'f1-score': 0.5048908247751723, 'support': 26232}, '2': {'precision': 0.4205503342699351, 'recall': 0.41890652897746466, 'f1-score': 0.419726822192675, 'support': 20723}, 'accuracy': 0.4500699006358703, 'macro avg': {'precision': 0.44415399028185515, 'recall': 0.443586969767174, 'f1-score': 0.4437846908672216, 'support': 66523}, 'weighted avg': {'precision': 0.44908103248920705, 'recall': 0.4500699006358703, 'f1-score': 0.4494883488207637, 'support': 66523}}
[[ 7813  6574  5181]
 [ 6006 13446  6780]
 [ 5031  7011  8681]]
Evaluating performance on  val set...
51/51 - 1s - 916ms/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0791525
{'0': {'precision': 0.3648509763617677, 'recall': 0.36664084688871673, 'f1-score': 0.3657437218287186, 'support': 3873}, '1': {'precision': 0.47388675096206706, 'recall': 0.49797804737146156, 'f1-score': 0.4856338028169013, 'support': 5193}, '2': {'precision': 0.3822184105202973, 'recall': 0.35361015604337476, 'f1-score': 0.36735815359252644, 'support': 3781}, 'accuracy': 0.41589476142290027, 'macro avg': {'precision': 0.40698537928137735, 'recall': 0.4060763501011843, 'f1-score': 0.40624522607938207, 'support': 12847}, 'weighted avg': {'precision': 0.414036704240086, 'recall': 0.41589476142290027, 'f1-score': 0.4146806998835633, 'support': 12847}}
[[1420 1504  949]
 [1395 2586 1212]
 [1077 1367 1337]]
training model: results/LILAK/W1/deepOF_L2/h30
Epoch 1/50
260/260 - 10s - loss: 3.3310 - accuracy30: 0.3480 - val_loss: 3.3310 - val_accuracy30: 0.3570 - 10s/epoch - 40ms/step
Epoch 2/50
260/260 - 8s - loss: 3.2981 - accuracy30: 0.3644 - val_loss: 3.3113 - val_accuracy30: 0.3636 - 8s/epoch - 31ms/step
Epoch 3/50
260/260 - 8s - loss: 3.2809 - accuracy30: 0.3750 - val_loss: 3.3002 - val_accuracy30: 0.3679 - 8s/epoch - 31ms/step
Epoch 4/50
260/260 - 8s - loss: 3.2671 - accuracy30: 0.3830 - val_loss: 3.3022 - val_accuracy30: 0.3695 - 8s/epoch - 32ms/step
Epoch 5/50
260/260 - 9s - loss: 3.2551 - accuracy30: 0.3923 - val_loss: 3.2896 - val_accuracy30: 0.3781 - 9s/epoch - 33ms/step
Epoch 6/50
260/260 - 9s - loss: 3.2427 - accuracy30: 0.3987 - val_loss: 3.2853 - val_accuracy30: 0.3835 - 9s/epoch - 35ms/step
Epoch 7/50
260/260 - 8s - loss: 3.2296 - accuracy30: 0.4066 - val_loss: 3.2782 - val_accuracy30: 0.3839 - 8s/epoch - 32ms/step
Epoch 8/50
260/260 - 9s - loss: 3.2171 - accuracy30: 0.4130 - val_loss: 3.2843 - val_accuracy30: 0.3910 - 9s/epoch - 33ms/step
Epoch 9/50
260/260 - 8s - loss: 3.2064 - accuracy30: 0.4182 - val_loss: 3.2801 - val_accuracy30: 0.3906 - 8s/epoch - 32ms/step
Epoch 10/50
260/260 - 8s - loss: 3.1973 - accuracy30: 0.4242 - val_loss: 3.2816 - val_accuracy30: 0.3967 - 8s/epoch - 31ms/step
Epoch 11/50
260/260 - 8s - loss: 3.1859 - accuracy30: 0.4262 - val_loss: 3.2855 - val_accuracy30: 0.3901 - 8s/epoch - 31ms/step
Epoch 12/50
260/260 - 8s - loss: 3.1784 - accuracy30: 0.4322 - val_loss: 3.2830 - val_accuracy30: 0.3912 - 8s/epoch - 31ms/step
Epoch 13/50
260/260 - 8s - loss: 3.1670 - accuracy30: 0.4384 - val_loss: 3.2730 - val_accuracy30: 0.3974 - 8s/epoch - 31ms/step
Epoch 14/50
260/260 - 8s - loss: 3.1556 - accuracy30: 0.4409 - val_loss: 3.2838 - val_accuracy30: 0.3929 - 8s/epoch - 32ms/step
Epoch 15/50
260/260 - 8s - loss: 3.1423 - accuracy30: 0.4492 - val_loss: 3.2909 - val_accuracy30: 0.3956 - 8s/epoch - 32ms/step
Epoch 16/50
260/260 - 8s - loss: 3.1310 - accuracy30: 0.4524 - val_loss: 3.2924 - val_accuracy30: 0.3985 - 8s/epoch - 32ms/step
Epoch 17/50
260/260 - 8s - loss: 3.1216 - accuracy30: 0.4553 - val_loss: 3.2975 - val_accuracy30: 0.4045 - 8s/epoch - 32ms/step
Epoch 18/50
260/260 - 8s - loss: 3.1109 - accuracy30: 0.4590 - val_loss: 3.3101 - val_accuracy30: 0.3991 - 8s/epoch - 32ms/step
Epoch 19/50
260/260 - 8s - loss: 3.0975 - accuracy30: 0.4638 - val_loss: 3.3126 - val_accuracy30: 0.4029 - 8s/epoch - 31ms/step
Epoch 20/50
260/260 - 8s - loss: 3.0841 - accuracy30: 0.4686 - val_loss: 3.3248 - val_accuracy30: 0.4013 - 8s/epoch - 32ms/step
Epoch 21/50
260/260 - 8s - loss: 3.0711 - accuracy30: 0.4759 - val_loss: 3.3426 - val_accuracy30: 0.4018 - 8s/epoch - 30ms/step
Epoch 22/50
260/260 - 8s - loss: 3.0556 - accuracy30: 0.4805 - val_loss: 3.3429 - val_accuracy30: 0.4069 - 8s/epoch - 30ms/step
Epoch 23/50
260/260 - 8s - loss: 3.0412 - accuracy30: 0.4852 - val_loss: 3.3637 - val_accuracy30: 0.3978 - 8s/epoch - 30ms/step
testing model: results/LILAK/W1/deepOF_L2/h30
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.082623
{'0': {'precision': 0.44830626531943785, 'recall': 0.39016866434414277, 'f1-score': 0.4172219122329077, 'support': 65159}, '1': {'precision': 0.30914381144224645, 'recall': 0.4522238452626807, 'f1-score': 0.36723966908343475, 'support': 39706}, '2': {'precision': 0.4440072142974258, 'recall': 0.3760066648153291, 'f1-score': 0.40718742951657766, 'support': 64818}, 'accuracy': 0.3992798335720137, 'macro avg': {'precision': 0.40048576368637007, 'recall': 0.4061330581407175, 'f1-score': 0.3972163369443067, 'support': 169683}, 'weighted avg': {'precision': 0.4140998905924909, 'recall': 0.3992798335720137, 'f1-score': 0.4016928960839708, 'support': 169683}}
[[25423 20153 19583]
 [10814 17956 10936]
 [20472 19974 24372]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.053954
{'0': {'precision': 0.43931532969713094, 'recall': 0.4533266221286721, 'f1-score': 0.4462110122733926, 'support': 21854}, '1': {'precision': 0.42093134138588684, 'recall': 0.490349456144411, 'f1-score': 0.4529963868043529, 'support': 21605}, '2': {'precision': 0.46649649010848754, 'recall': 0.3803329864724246, 'f1-score': 0.4190312410432789, 'support': 23064}, 'accuracy': 0.44004329329705516, 'macro avg': {'precision': 0.4422477203971684, 'recall': 0.4413363549151692, 'f1-score': 0.43941288004034146, 'support': 66523}, 'weighted avg': {'precision': 0.4427685746840242, 'recall': 0.44004329329705516, 'f1-score': 0.43899131041223255, 'support': 66523}}
[[ 9907  6891  5056]
 [ 6035 10594  4976]
 [ 6609  7683  8772]]
Evaluating performance on  val set...
51/51 - 1s - 958ms/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0932194
{'0': {'precision': 0.38324265505984767, 'recall': 0.410011641443539, 'f1-score': 0.39617547806524184, 'support': 4295}, '1': {'precision': 0.4018636003172086, 'recall': 0.4666206261510129, 'f1-score': 0.4318278653600341, 'support': 4344}, '2': {'precision': 0.40118453865336656, 'recall': 0.30584600760456276, 'f1-score': 0.34708737864077666, 'support': 4208}, 'accuracy': 0.39503386004514673, 'macro avg': {'precision': 0.3954302646768076, 'recall': 0.3941594250663716, 'f1-score': 0.3916969073553509, 'support': 12847}, 'weighted avg': {'precision': 0.3954158341957941, 'recall': 0.39503386004514673, 'f1-score': 0.39215206777727013, 'support': 12847}}
[[1761 1531 1003]
 [1399 2027  918]
 [1435 1486 1287]]
training model: results/LILAK/W1/deepOF_L2/h50
Epoch 1/50
260/260 - 11s - loss: 3.3358 - accuracy50: 0.3430 - val_loss: 3.3098 - val_accuracy50: 0.3649 - 11s/epoch - 42ms/step
Epoch 2/50
260/260 - 8s - loss: 3.3063 - accuracy50: 0.3563 - val_loss: 3.2988 - val_accuracy50: 0.3798 - 8s/epoch - 32ms/step
Epoch 3/50
260/260 - 8s - loss: 3.2911 - accuracy50: 0.3653 - val_loss: 3.2949 - val_accuracy50: 0.3712 - 8s/epoch - 32ms/step
Epoch 4/50
260/260 - 8s - loss: 3.2781 - accuracy50: 0.3727 - val_loss: 3.2896 - val_accuracy50: 0.3732 - 8s/epoch - 31ms/step
Epoch 5/50
260/260 - 8s - loss: 3.2679 - accuracy50: 0.3828 - val_loss: 3.2880 - val_accuracy50: 0.3741 - 8s/epoch - 31ms/step
Epoch 6/50
260/260 - 8s - loss: 3.2584 - accuracy50: 0.3878 - val_loss: 3.2883 - val_accuracy50: 0.3768 - 8s/epoch - 31ms/step
Epoch 7/50
260/260 - 8s - loss: 3.2502 - accuracy50: 0.3937 - val_loss: 3.2825 - val_accuracy50: 0.3797 - 8s/epoch - 31ms/step
Epoch 8/50
260/260 - 8s - loss: 3.2427 - accuracy50: 0.3986 - val_loss: 3.2873 - val_accuracy50: 0.3789 - 8s/epoch - 31ms/step
Epoch 9/50
260/260 - 8s - loss: 3.2350 - accuracy50: 0.4039 - val_loss: 3.2820 - val_accuracy50: 0.3795 - 8s/epoch - 31ms/step
Epoch 10/50
260/260 - 8s - loss: 3.2280 - accuracy50: 0.4082 - val_loss: 3.2874 - val_accuracy50: 0.3816 - 8s/epoch - 31ms/step
Epoch 11/50
260/260 - 8s - loss: 3.2184 - accuracy50: 0.4137 - val_loss: 3.2897 - val_accuracy50: 0.3816 - 8s/epoch - 31ms/step
Epoch 12/50
260/260 - 8s - loss: 3.2110 - accuracy50: 0.4181 - val_loss: 3.2872 - val_accuracy50: 0.3830 - 8s/epoch - 31ms/step
Epoch 13/50
260/260 - 8s - loss: 3.1995 - accuracy50: 0.4213 - val_loss: 3.2983 - val_accuracy50: 0.3810 - 8s/epoch - 31ms/step
Epoch 14/50
260/260 - 8s - loss: 3.1944 - accuracy50: 0.4266 - val_loss: 3.2988 - val_accuracy50: 0.3834 - 8s/epoch - 31ms/step
Epoch 15/50
260/260 - 8s - loss: 3.1804 - accuracy50: 0.4322 - val_loss: 3.3007 - val_accuracy50: 0.3872 - 8s/epoch - 30ms/step
Epoch 16/50
260/260 - 8s - loss: 3.1699 - accuracy50: 0.4370 - val_loss: 3.3068 - val_accuracy50: 0.3864 - 8s/epoch - 31ms/step
Epoch 17/50
260/260 - 8s - loss: 3.1581 - accuracy50: 0.4417 - val_loss: 3.3078 - val_accuracy50: 0.3841 - 8s/epoch - 31ms/step
Epoch 18/50
260/260 - 8s - loss: 3.1493 - accuracy50: 0.4443 - val_loss: 3.3191 - val_accuracy50: 0.3891 - 8s/epoch - 31ms/step
Epoch 19/50
260/260 - 8s - loss: 3.1356 - accuracy50: 0.4496 - val_loss: 3.3264 - val_accuracy50: 0.3878 - 8s/epoch - 31ms/step
testing model: results/LILAK/W1/deepOF_L2/h50
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1053951
{'0': {'precision': 0.41601471489883507, 'recall': 0.27956227236020237, 'f1-score': 0.3344044474234121, 'support': 60677}, '1': {'precision': 0.3008844653307324, 'recall': 0.5603789943027, 'f1-score': 0.391539504427842, 'support': 48444}, '2': {'precision': 0.4071967738599938, 'recall': 0.2600970905848552, 'f1-score': 0.31743344819942365, 'support': 60562}, 'accuracy': 0.3527872562366295, 'macro avg': {'precision': 0.3746986513631871, 'recall': 0.3666794524159192, 'f1-score': 0.34779246668355923, 'support': 169683}, 'weighted avg': {'precision': 0.3799981312972281, 'recall': 0.3527872562366295, 'f1-score': 0.34465917563142007, 'support': 169683}}
[[16963 31553 12161]
 [10526 27147 10771]
 [13286 31524 15752]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0796226
{'0': {'precision': 0.41799163179916315, 'recall': 0.3667905824039653, 'f1-score': 0.39072086826859614, 'support': 21789}, '1': {'precision': 0.36906377204884666, 'recall': 0.5703345792688486, 'f1-score': 0.4481375358166189, 'support': 21938}, '2': {'precision': 0.44493000518480114, 'recall': 0.26351114230566763, 'f1-score': 0.33099154200071623, 'support': 22796}, 'accuracy': 0.3985238188295777, 'macro avg': {'precision': 0.41066180301093697, 'recall': 0.4002121013261604, 'f1-score': 0.3899499820286438, 'support': 66523}, 'weighted avg': {'precision': 0.41108736970179177, 'recall': 0.3985238188295777, 'f1-score': 0.3891878215188394, 'support': 66523}}
[[ 7992 10116  3681]
 [ 5613 12512  3813]
 [ 5515 11274  6007]]
Evaluating performance on  val set...
51/51 - 1s - 928ms/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0939487
{'0': {'precision': 0.36809045226130654, 'recall': 0.3581031532632608, 'f1-score': 0.36302812538718876, 'support': 4091}, '1': {'precision': 0.39921128469588957, 'recall': 0.5423449412734391, 'f1-score': 0.4598986545518085, 'support': 4853}, '2': {'precision': 0.3579595426561126, 'recall': 0.20855751985652063, 'f1-score': 0.2635583616642383, 'support': 3903}, 'accuracy': 0.38226823382890945, 'macro avg': {'precision': 0.3750870932044363, 'recall': 0.36966853813107353, 'f1-score': 0.36216171386774515, 'support': 12847}, 'weighted avg': {'precision': 0.3767686230105834, 'recall': 0.38226823382890945, 'f1-score': 0.36940176827854276, 'support': 12847}}
[[1465 1977  649]
 [1410 2632  811]
 [1105 1984  814]]
training model: results/LILAK/W1/deepOF_L2/h100
Epoch 1/50
260/260 - 11s - loss: 3.3391 - accuracy100: 0.3444 - val_loss: 3.2232 - val_accuracy100: 0.4462 - 11s/epoch - 41ms/step
Epoch 2/50
260/260 - 8s - loss: 3.3179 - accuracy100: 0.3550 - val_loss: 3.2109 - val_accuracy100: 0.4476 - 8s/epoch - 33ms/step
Epoch 3/50
260/260 - 8s - loss: 3.3016 - accuracy100: 0.3643 - val_loss: 3.2074 - val_accuracy100: 0.4536 - 8s/epoch - 32ms/step
Epoch 4/50
260/260 - 8s - loss: 3.2924 - accuracy100: 0.3662 - val_loss: 3.2060 - val_accuracy100: 0.4513 - 8s/epoch - 31ms/step
Epoch 5/50
260/260 - 8s - loss: 3.2827 - accuracy100: 0.3737 - val_loss: 3.2003 - val_accuracy100: 0.4556 - 8s/epoch - 31ms/step
Epoch 6/50
260/260 - 8s - loss: 3.2737 - accuracy100: 0.3807 - val_loss: 3.2043 - val_accuracy100: 0.4512 - 8s/epoch - 33ms/step
Epoch 7/50
260/260 - 9s - loss: 3.2673 - accuracy100: 0.3859 - val_loss: 3.2095 - val_accuracy100: 0.4491 - 9s/epoch - 33ms/step
Epoch 8/50
260/260 - 8s - loss: 3.2611 - accuracy100: 0.3899 - val_loss: 3.2060 - val_accuracy100: 0.4472 - 8s/epoch - 32ms/step
Epoch 9/50
260/260 - 8s - loss: 3.2545 - accuracy100: 0.3944 - val_loss: 3.2152 - val_accuracy100: 0.4412 - 8s/epoch - 32ms/step
Epoch 10/50
260/260 - 9s - loss: 3.2496 - accuracy100: 0.3980 - val_loss: 3.2165 - val_accuracy100: 0.4381 - 9s/epoch - 33ms/step
Epoch 11/50
260/260 - 9s - loss: 3.2401 - accuracy100: 0.4020 - val_loss: 3.2142 - val_accuracy100: 0.4389 - 9s/epoch - 33ms/step
Epoch 12/50
260/260 - 8s - loss: 3.2331 - accuracy100: 0.4074 - val_loss: 3.2124 - val_accuracy100: 0.4429 - 8s/epoch - 32ms/step
Epoch 13/50
260/260 - 8s - loss: 3.2272 - accuracy100: 0.4099 - val_loss: 3.2199 - val_accuracy100: 0.4380 - 8s/epoch - 31ms/step
Epoch 14/50
260/260 - 8s - loss: 3.2200 - accuracy100: 0.4141 - val_loss: 3.2117 - val_accuracy100: 0.4399 - 8s/epoch - 30ms/step
Epoch 15/50
260/260 - 8s - loss: 3.2109 - accuracy100: 0.4193 - val_loss: 3.2144 - val_accuracy100: 0.4411 - 8s/epoch - 30ms/step
testing model: results/LILAK/W1/deepOF_L2/h100
Evaluating performance on  test set...
663/663 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.111611
{'0': {'precision': 0.3110773899848255, 'recall': 0.025683245932740323, 'f1-score': 0.04744899646199121, 'support': 55873}, '1': {'precision': 0.3533136018530434, 'recall': 0.9161925419204138, 'f1-score': 0.5099672633558543, 'support': 59935}, '2': {'precision': 0.37865284974093266, 'recall': 0.06782366589327146, 'f1-score': 0.1150413223140496, 'support': 53875}, 'accuracy': 0.3536064308151082, 'macro avg': {'precision': 0.3476812805262672, 'recall': 0.33656648458214183, 'f1-score': 0.22415252737729838, 'support': 169683}, 'weighted avg': {'precision': 0.347451424229163, 'recall': 0.3536064308151082, 'f1-score': 0.23227935001280847, 'support': 169683}}
[[ 1435 51802  2636]
 [ 1663 54912  3360]
 [ 1515 48706  3654]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1081436
{'0': {'precision': 0.41079316304974073, 'recall': 0.09774710962847873, 'f1-score': 0.15791805094130676, 'support': 21883}, '1': {'precision': 0.3355410348378849, 'recall': 0.8670735064696705, 'f1-score': 0.48384371159360917, 'support': 21794}, '2': {'precision': 0.43257302921168467, 'recall': 0.09463363389652456, 'f1-score': 0.1552937796293636, 'support': 22846}, 'accuracy': 0.34872149482133996, 'macro avg': {'precision': 0.39296907569977013, 'recall': 0.35315141666489125, 'f1-score': 0.2656851807214265, 'support': 66523}, 'weighted avg': {'precision': 0.39361922230874263, 'recall': 0.34872149482133996, 'f1-score': 0.26379526252021374, 'support': 66523}}
[[ 2139 18276  1468]
 [ 1529 18897  1368]
 [ 1539 19145  2162]]
Evaluating performance on  val set...
51/51 - 1s - 889ms/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0681801
{'0': {'precision': 0.29922027290448344, 'recall': 0.08911465892597968, 'f1-score': 0.13732945649742787, 'support': 3445}, '1': {'precision': 0.4785662167092302, 'recall': 0.8553961525921095, 'f1-score': 0.6137559948531992, 'support': 6134}, '2': {'precision': 0.2742123687281214, 'recall': 0.0719094247246022, 'f1-score': 0.11393939393939392, 'support': 3268}, 'accuracy': 0.450611037596326, 'macro avg': {'precision': 0.35066628611394507, 'recall': 0.3388067454142305, 'f1-score': 0.28834161509667366, 'support': 12847}, 'weighted avg': {'precision': 0.3784903117034221, 'recall': 0.450611037596326, 'f1-score': 0.3588567906481749, 'support': 12847}}
[[ 307 2920  218]
 [ 483 5247  404]
 [ 236 2797  235]]
training model: results/LILAK/W1/deepOF_L2/h200
Epoch 1/50
260/260 - 10s - loss: 3.3416 - accuracy200: 0.3386 - val_loss: 3.3175 - val_accuracy200: 0.3739 - 10s/epoch - 38ms/step
Epoch 2/50
260/260 - 8s - loss: 3.3217 - accuracy200: 0.3437 - val_loss: 3.3072 - val_accuracy200: 0.3792 - 8s/epoch - 30ms/step
Epoch 3/50
260/260 - 8s - loss: 3.3064 - accuracy200: 0.3515 - val_loss: 3.2959 - val_accuracy200: 0.3780 - 8s/epoch - 30ms/step
Epoch 4/50
260/260 - 8s - loss: 3.2963 - accuracy200: 0.3574 - val_loss: 3.2877 - val_accuracy200: 0.3793 - 8s/epoch - 31ms/step
Epoch 5/50
260/260 - 8s - loss: 3.2891 - accuracy200: 0.3622 - val_loss: 3.2951 - val_accuracy200: 0.3780 - 8s/epoch - 31ms/step
Epoch 6/50
260/260 - 8s - loss: 3.2802 - accuracy200: 0.3691 - val_loss: 3.2931 - val_accuracy200: 0.3785 - 8s/epoch - 31ms/step
Epoch 7/50
260/260 - 8s - loss: 3.2751 - accuracy200: 0.3722 - val_loss: 3.2872 - val_accuracy200: 0.3815 - 8s/epoch - 30ms/step
Epoch 8/50
260/260 - 8s - loss: 3.2688 - accuracy200: 0.3781 - val_loss: 3.2855 - val_accuracy200: 0.3817 - 8s/epoch - 30ms/step
Epoch 9/50
260/260 - 8s - loss: 3.2636 - accuracy200: 0.3807 - val_loss: 3.2870 - val_accuracy200: 0.3813 - 8s/epoch - 31ms/step
Epoch 10/50
260/260 - 8s - loss: 3.2563 - accuracy200: 0.3860 - val_loss: 3.2827 - val_accuracy200: 0.3850 - 8s/epoch - 30ms/step
Epoch 11/50
260/260 - 8s - loss: 3.2521 - accuracy200: 0.3898 - val_loss: 3.2891 - val_accuracy200: 0.3759 - 8s/epoch - 29ms/step
Epoch 12/50
260/260 - 8s - loss: 3.2455 - accuracy200: 0.3945 - val_loss: 3.2884 - val_accuracy200: 0.3792 - 8s/epoch - 29ms/step
Epoch 13/50
260/260 - 8s - loss: 3.2391 - accuracy200: 0.3974 - val_loss: 3.2935 - val_accuracy200: 0.3754 - 8s/epoch - 31ms/step
Epoch 14/50
260/260 - 8s - loss: 3.2317 - accuracy200: 0.4023 - val_loss: 3.2987 - val_accuracy200: 0.3760 - 8s/epoch - 30ms/step
Epoch 15/50
260/260 - 8s - loss: 3.2235 - accuracy200: 0.4075 - val_loss: 3.2997 - val_accuracy200: 0.3779 - 8s/epoch - 31ms/step
Epoch 16/50
260/260 - 8s - loss: 3.2175 - accuracy200: 0.4098 - val_loss: 3.3040 - val_accuracy200: 0.3757 - 8s/epoch - 31ms/step
Epoch 17/50
260/260 - 8s - loss: 3.2069 - accuracy200: 0.4167 - val_loss: 3.3146 - val_accuracy200: 0.3705 - 8s/epoch - 31ms/step
Epoch 18/50
260/260 - 8s - loss: 3.1994 - accuracy200: 0.4223 - val_loss: 3.3200 - val_accuracy200: 0.3736 - 8s/epoch - 31ms/step
Epoch 19/50
260/260 - 8s - loss: 3.1923 - accuracy200: 0.4241 - val_loss: 3.3231 - val_accuracy200: 0.3708 - 8s/epoch - 32ms/step
Epoch 20/50
260/260 - 8s - loss: 3.1832 - accuracy200: 0.4267 - val_loss: 3.3333 - val_accuracy200: 0.3717 - 8s/epoch - 32ms/step
testing model: results/LILAK/W1/deepOF_L2/h200
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1156574
{'0': {'precision': 0.36308381317978244, 'recall': 0.07344258051992171, 'f1-score': 0.12217273718060845, 'support': 61817}, '1': {'precision': 0.30689084509778025, 'recall': 0.7560919584234606, 'f1-score': 0.4365784645312466, 'support': 52241}, '2': {'precision': 0.3575091317785895, 'recall': 0.1829932584269663, 'f1-score': 0.24207760086566701, 'support': 55625}, 'accuracy': 0.31952523234501984, 'macro avg': {'precision': 0.34249459668538407, 'recall': 0.3375092657901162, 'f1-score': 0.2669429341925073, 'support': 169683}, 'weighted avg': {'precision': 0.34395597775423464, 'recall': 0.31952523234501984, 'f1-score': 0.2582769883136393, 'support': 169683}}
[[ 4540 47727  9550]
 [ 3999 39499  8743]
 [ 3965 41481 10179]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0914581
{'0': {'precision': 0.42212263635369984, 'recall': 0.1771559633027523, 'f1-score': 0.24957187631264338, 'support': 21800}, '1': {'precision': 0.3488829652195989, 'recall': 0.75, 'f1-score': 0.4762331061568673, 'support': 21988}, '2': {'precision': 0.44537898278250543, 'recall': 0.19797668792610512, 'f1-score': 0.27410858378246705, 'support': 22735}, 'accuracy': 0.37361514062805345, 'macro avg': {'precision': 0.40546152811860137, 'recall': 0.37504421707628577, 'f1-score': 0.3333045220839926, 'support': 66523}, 'weighted avg': {'precision': 0.40586268336243797, 'recall': 0.37361514062805345, 'f1-score': 0.3328764351290112, 'support': 66523}}
[[ 3862 15175  2763]
 [ 2655 16491  2842]
 [ 2632 15602  4501]]
Evaluating performance on  val set...
51/51 - 1s - 919ms/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0949821
{'0': {'precision': 0.3558870538092701, 'recall': 0.16380578715056401, 'f1-score': 0.22434928631402182, 'support': 4078}, '1': {'precision': 0.39588299024918744, 'recall': 0.7225627842594423, 'f1-score': 0.5115139637432631, 'support': 5057}, '2': {'precision': 0.3074712643678161, 'recall': 0.14412715517241378, 'f1-score': 0.19625825385179752, 'support': 3712}, 'accuracy': 0.3780649178796606, 'macro avg': {'precision': 0.3530804361420912, 'recall': 0.34349857552747337, 'f1-score': 0.31070716796969416, 'support': 12847}, 'weighted avg': {'precision': 0.3576415521489591, 'recall': 0.3780649178796606, 'f1-score': 0.32927011306422777, 'support': 12847}}
[[ 668 2889  521]
 [ 719 3654  684]
 [ 490 2687  535]]
training model: results/LILAK/W1/deepOF_L2/h300
Epoch 1/50
260/260 - 10s - loss: 3.3385 - accuracy300: 0.3449 - val_loss: 3.2825 - val_accuracy300: 0.4024 - 10s/epoch - 39ms/step
Epoch 2/50
260/260 - 8s - loss: 3.3233 - accuracy300: 0.3473 - val_loss: 3.2700 - val_accuracy300: 0.4079 - 8s/epoch - 31ms/step
Epoch 3/50
260/260 - 8s - loss: 3.3072 - accuracy300: 0.3552 - val_loss: 3.2583 - val_accuracy300: 0.4150 - 8s/epoch - 32ms/step
Epoch 4/50
260/260 - 8s - loss: 3.2976 - accuracy300: 0.3574 - val_loss: 3.2582 - val_accuracy300: 0.4106 - 8s/epoch - 32ms/step
Epoch 5/50
260/260 - 8s - loss: 3.2905 - accuracy300: 0.3631 - val_loss: 3.2615 - val_accuracy300: 0.4118 - 8s/epoch - 32ms/step
Epoch 6/50
260/260 - 8s - loss: 3.2841 - accuracy300: 0.3680 - val_loss: 3.2536 - val_accuracy300: 0.4111 - 8s/epoch - 31ms/step
Epoch 7/50
260/260 - 8s - loss: 3.2775 - accuracy300: 0.3740 - val_loss: 3.2548 - val_accuracy300: 0.4118 - 8s/epoch - 31ms/step
Epoch 8/50
260/260 - 8s - loss: 3.2728 - accuracy300: 0.3758 - val_loss: 3.2572 - val_accuracy300: 0.4097 - 8s/epoch - 31ms/step
Epoch 9/50
260/260 - 8s - loss: 3.2644 - accuracy300: 0.3832 - val_loss: 3.2591 - val_accuracy300: 0.4076 - 8s/epoch - 31ms/step
Epoch 10/50
260/260 - 8s - loss: 3.2606 - accuracy300: 0.3847 - val_loss: 3.2552 - val_accuracy300: 0.4077 - 8s/epoch - 31ms/step
Epoch 11/50
260/260 - 8s - loss: 3.2553 - accuracy300: 0.3884 - val_loss: 3.2644 - val_accuracy300: 0.4034 - 8s/epoch - 32ms/step
Epoch 12/50
260/260 - 8s - loss: 3.2487 - accuracy300: 0.3937 - val_loss: 3.2549 - val_accuracy300: 0.4073 - 8s/epoch - 32ms/step
Epoch 13/50
260/260 - 8s - loss: 3.2431 - accuracy300: 0.3971 - val_loss: 3.2631 - val_accuracy300: 0.4009 - 8s/epoch - 32ms/step
Epoch 14/50
260/260 - 8s - loss: 3.2354 - accuracy300: 0.4018 - val_loss: 3.2683 - val_accuracy300: 0.3978 - 8s/epoch - 31ms/step
Epoch 15/50
260/260 - 8s - loss: 3.2308 - accuracy300: 0.4040 - val_loss: 3.2668 - val_accuracy300: 0.4020 - 8s/epoch - 30ms/step
Epoch 16/50
260/260 - 8s - loss: 3.2211 - accuracy300: 0.4105 - val_loss: 3.2757 - val_accuracy300: 0.3987 - 8s/epoch - 31ms/step
testing model: results/LILAK/W1/deepOF_L2/h300
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1067407
{'0': {'precision': 0.32986696646055835, 'recall': 0.06030142147628018, 'f1-score': 0.10196339627012624, 'support': 58390}, '1': {'precision': 0.34842579962697995, 'recall': 0.8435862440816189, 'f1-score': 0.49316147970114416, 'support': 59349}, '2': {'precision': 0.34745707383952473, 'recall': 0.10245649160634529, 'f1-score': 0.15824920830793476, 'support': 51944}, 'accuracy': 0.3471709010331029, 'macro avg': {'precision': 0.341916613309021, 'recall': 0.3354480523880814, 'f1-score': 0.25112469475973503, 'support': 169683}, 'weighted avg': {'precision': 0.34174292767816405, 'recall': 0.3471709010331029, 'f1-score': 0.2560208167190776, 'support': 169683}}
[[ 3521 50283  4586]
 [ 3874 50066  5409]
 [ 3279 43343  5322]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1004395
{'0': {'precision': 0.4044930464756924, 'recall': 0.15645977011494253, 'f1-score': 0.22564068560819547, 'support': 21750}, '1': {'precision': 0.3431622757077231, 'recall': 0.7970452783730793, 'f1-score': 0.4797650578435274, 'support': 21931}, '2': {'precision': 0.4304238706079197, 'recall': 0.1351457840819543, 'f1-score': 0.20570400479776105, 'support': 22842}, 'accuracy': 0.36032650361529095, 'macro avg': {'precision': 0.3926930642637784, 'recall': 0.36288361085665866, 'f1-score': 0.3037032494164947, 'support': 66523}, 'weighted avg': {'precision': 0.39317766309123897, 'recall': 0.36032650361529095, 'f1-score': 0.30257359519467114, 'support': 66523}}
[[ 3403 16282  2065]
 [ 2431 17480  2020]
 [ 2579 17176  3087]]
Evaluating performance on  val set...
51/51 - 1s - 952ms/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0850779
{'0': {'precision': 0.32357043235704325, 'recall': 0.11879160266257041, 'f1-score': 0.17378277153558053, 'support': 3906}, '1': {'precision': 0.43703199455411845, 'recall': 0.806677436725902, 'f1-score': 0.5669231739624069, 'support': 5571}, '2': {'precision': 0.28584070796460176, 'recall': 0.09584569732937685, 'f1-score': 0.14355555555555555, 'support': 3370}, 'accuracy': 0.41106873199968863, 'macro avg': {'precision': 0.34881437829192113, 'recall': 0.3404382455726164, 'f1-score': 0.2947538336845143, 'support': 12847}, 'weighted avg': {'precision': 0.3628749541751625, 'recall': 0.41106873199968863, 'f1-score': 0.33633585506225333, 'support': 12847}}
[[ 464 3088  354]
 [ 624 4494  453]
 [ 346 2701  323]]
training model: results/LILAK/W1/deepOF_L2/h500
Epoch 1/50
260/260 - 11s - loss: 3.3448 - accuracy500: 0.3426 - val_loss: 3.2855 - val_accuracy500: 0.4022 - 11s/epoch - 42ms/step
Epoch 2/50
260/260 - 9s - loss: 3.3236 - accuracy500: 0.3486 - val_loss: 3.2724 - val_accuracy500: 0.4061 - 9s/epoch - 33ms/step
Epoch 3/50
260/260 - 9s - loss: 3.3094 - accuracy500: 0.3543 - val_loss: 3.2558 - val_accuracy500: 0.4137 - 9s/epoch - 34ms/step
Epoch 4/50
260/260 - 8s - loss: 3.2998 - accuracy500: 0.3598 - val_loss: 3.2550 - val_accuracy500: 0.4148 - 8s/epoch - 32ms/step
Epoch 5/50
260/260 - 8s - loss: 3.2944 - accuracy500: 0.3610 - val_loss: 3.2572 - val_accuracy500: 0.4117 - 8s/epoch - 31ms/step
Epoch 6/50
260/260 - 8s - loss: 3.2873 - accuracy500: 0.3655 - val_loss: 3.2563 - val_accuracy500: 0.4083 - 8s/epoch - 32ms/step
Epoch 7/50
260/260 - 8s - loss: 3.2806 - accuracy500: 0.3732 - val_loss: 3.2531 - val_accuracy500: 0.4125 - 8s/epoch - 32ms/step
Epoch 8/50
260/260 - 8s - loss: 3.2775 - accuracy500: 0.3727 - val_loss: 3.2517 - val_accuracy500: 0.4115 - 8s/epoch - 31ms/step
Epoch 9/50
260/260 - 8s - loss: 3.2713 - accuracy500: 0.3788 - val_loss: 3.2521 - val_accuracy500: 0.4118 - 8s/epoch - 31ms/step
Epoch 10/50
260/260 - 8s - loss: 3.2668 - accuracy500: 0.3823 - val_loss: 3.2530 - val_accuracy500: 0.4069 - 8s/epoch - 32ms/step
Epoch 11/50
260/260 - 8s - loss: 3.2602 - accuracy500: 0.3843 - val_loss: 3.2578 - val_accuracy500: 0.4065 - 8s/epoch - 31ms/step
Epoch 12/50
260/260 - 8s - loss: 3.2582 - accuracy500: 0.3867 - val_loss: 3.2500 - val_accuracy500: 0.4071 - 8s/epoch - 31ms/step
Epoch 13/50
260/260 - 8s - loss: 3.2506 - accuracy500: 0.3922 - val_loss: 3.2564 - val_accuracy500: 0.4062 - 8s/epoch - 30ms/step
Epoch 14/50
260/260 - 8s - loss: 3.2453 - accuracy500: 0.3933 - val_loss: 3.2616 - val_accuracy500: 0.4068 - 8s/epoch - 31ms/step
Epoch 15/50
260/260 - 8s - loss: 3.2395 - accuracy500: 0.3966 - val_loss: 3.2615 - val_accuracy500: 0.4069 - 8s/epoch - 31ms/step
Epoch 16/50
260/260 - 8s - loss: 3.2327 - accuracy500: 0.4022 - val_loss: 3.2592 - val_accuracy500: 0.4066 - 8s/epoch - 30ms/step
Epoch 17/50
260/260 - 8s - loss: 3.2265 - accuracy500: 0.4037 - val_loss: 3.2569 - val_accuracy500: 0.4073 - 8s/epoch - 32ms/step
Epoch 18/50
260/260 - 8s - loss: 3.2197 - accuracy500: 0.4079 - val_loss: 3.2694 - val_accuracy500: 0.4031 - 8s/epoch - 30ms/step
Epoch 19/50
260/260 - 8s - loss: 3.2140 - accuracy500: 0.4095 - val_loss: 3.2685 - val_accuracy500: 0.4052 - 8s/epoch - 32ms/step
Epoch 20/50
260/260 - 8s - loss: 3.2049 - accuracy500: 0.4142 - val_loss: 3.2777 - val_accuracy500: 0.4020 - 8s/epoch - 30ms/step
Epoch 21/50
260/260 - 8s - loss: 3.1994 - accuracy500: 0.4176 - val_loss: 3.2728 - val_accuracy500: 0.4073 - 8s/epoch - 31ms/step
Epoch 22/50
260/260 - 8s - loss: 3.1893 - accuracy500: 0.4232 - val_loss: 3.2867 - val_accuracy500: 0.4014 - 8s/epoch - 31ms/step
testing model: results/LILAK/W1/deepOF_L2/h500
Evaluating performance on  test set...
663/663 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1004808
{'0': {'precision': 0.3251259093452714, 'recall': 0.04149777690480867, 'f1-score': 0.0736013681493563, 'support': 56003}, '1': {'precision': 0.3778470669483818, 'recall': 0.8606650572385328, 'f1-score': 0.5251458764944025, 'support': 64205}, '2': {'precision': 0.30157170923379173, 'recall': 0.09928246589186458, 'f1-score': 0.1493849124887855, 'support': 49475}, 'accuracy': 0.36830442648939493, 'macro avg': {'precision': 0.3348482285091483, 'recall': 0.33381510001173537, 'f1-score': 0.24937738571084808, 'support': 169683}, 'weighted avg': {'precision': 0.33820687722886755, 'recall': 0.36830442648939493, 'f1-score': 0.2665541448829533, 'support': 169683}}
[[ 2324 48482  5197]
 [ 2767 55259  6179]
 [ 2057 42506  4912]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.097894
{'0': {'precision': 0.4359053657027988, 'recall': 0.12862748676765834, 'f1-score': 0.1986400310044745, 'support': 21916}, '1': {'precision': 0.34623148112884183, 'recall': 0.8302283105022831, 'f1-score': 0.48867148654823017, 'support': 21900}, '2': {'precision': 0.4502784407319014, 'recall': 0.14955740520544325, 'f1-score': 0.22453634830903502, 'support': 22707}, 'accuracy': 0.36674533619950994, 'macro avg': {'precision': 0.41080509585451397, 'recall': 0.36947106749179487, 'f1-score': 0.3039492886205799, 'support': 66523}, 'weighted avg': {'precision': 0.41128998970526676, 'recall': 0.36674533619950994, 'f1-score': 0.30296059011099263, 'support': 66523}}
[[ 2819 16929  2168]
 [ 1740 18182  1978]
 [ 1908 17403  3396]]
Evaluating performance on  val set...
51/51 - 1s - 1s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0835161
{'0': {'precision': 0.3233357717629846, 'recall': 0.10959583436647657, 'f1-score': 0.16370370370370368, 'support': 4033}, '1': {'precision': 0.42973777735087887, 'recall': 0.8121256126338718, 'f1-score': 0.5620603015075377, 'support': 5509}, '2': {'precision': 0.2871842843779233, 'recall': 0.09288956127080182, 'f1-score': 0.14037494284407864, 'support': 3305}, 'accuracy': 0.4065540593134584, 'macro avg': {'precision': 0.3467526111639289, 'recall': 0.3382036694237167, 'f1-score': 0.2887129826851067, 'support': 12847}, 'weighted avg': {'precision': 0.3596623836549502, 'recall': 0.4065540593134584, 'f1-score': 0.3285238907248184, 'support': 12847}}
[[ 442 3261  330]
 [ 603 4474  432]
 [ 322 2676  307]]
training model: results/LILAK/W1/deepOF_L2/h1000
Epoch 1/50
260/260 - 10s - loss: 3.3443 - accuracy1000: 0.3446 - val_loss: 3.3182 - val_accuracy1000: 0.3907 - 10s/epoch - 39ms/step
Epoch 2/50
260/260 - 8s - loss: 3.3202 - accuracy1000: 0.3548 - val_loss: 3.3088 - val_accuracy1000: 0.3922 - 8s/epoch - 32ms/step
Epoch 3/50
260/260 - 9s - loss: 3.3078 - accuracy1000: 0.3595 - val_loss: 3.2832 - val_accuracy1000: 0.3984 - 9s/epoch - 33ms/step
Epoch 4/50
260/260 - 8s - loss: 3.2980 - accuracy1000: 0.3611 - val_loss: 3.2820 - val_accuracy1000: 0.4037 - 8s/epoch - 32ms/step
Epoch 5/50
260/260 - 8s - loss: 3.2915 - accuracy1000: 0.3655 - val_loss: 3.2816 - val_accuracy1000: 0.4006 - 8s/epoch - 32ms/step
Epoch 6/50
260/260 - 9s - loss: 3.2868 - accuracy1000: 0.3694 - val_loss: 3.2750 - val_accuracy1000: 0.4013 - 9s/epoch - 33ms/step
Epoch 7/50
260/260 - 9s - loss: 3.2819 - accuracy1000: 0.3714 - val_loss: 3.2738 - val_accuracy1000: 0.4021 - 9s/epoch - 34ms/step
Epoch 8/50
260/260 - 8s - loss: 3.2777 - accuracy1000: 0.3723 - val_loss: 3.2743 - val_accuracy1000: 0.4017 - 8s/epoch - 32ms/step
Epoch 9/50
260/260 - 8s - loss: 3.2728 - accuracy1000: 0.3804 - val_loss: 3.2755 - val_accuracy1000: 0.4013 - 8s/epoch - 32ms/step
Epoch 10/50
260/260 - 8s - loss: 3.2670 - accuracy1000: 0.3813 - val_loss: 3.2789 - val_accuracy1000: 0.3978 - 8s/epoch - 32ms/step
Epoch 11/50
260/260 - 8s - loss: 3.2634 - accuracy1000: 0.3853 - val_loss: 3.2818 - val_accuracy1000: 0.3973 - 8s/epoch - 30ms/step
Epoch 12/50
260/260 - 8s - loss: 3.2591 - accuracy1000: 0.3862 - val_loss: 3.2834 - val_accuracy1000: 0.3971 - 8s/epoch - 31ms/step
Epoch 13/50
260/260 - 8s - loss: 3.2508 - accuracy1000: 0.3943 - val_loss: 3.2884 - val_accuracy1000: 0.4009 - 8s/epoch - 31ms/step
Epoch 14/50
260/260 - 8s - loss: 3.2471 - accuracy1000: 0.3953 - val_loss: 3.2925 - val_accuracy1000: 0.4000 - 8s/epoch - 31ms/step
Epoch 15/50
260/260 - 8s - loss: 3.2424 - accuracy1000: 0.3961 - val_loss: 3.2882 - val_accuracy1000: 0.3974 - 8s/epoch - 31ms/step
Epoch 16/50
260/260 - 8s - loss: 3.2356 - accuracy1000: 0.4040 - val_loss: 3.2888 - val_accuracy1000: 0.4006 - 8s/epoch - 31ms/step
Epoch 17/50
260/260 - 8s - loss: 3.2288 - accuracy1000: 0.4072 - val_loss: 3.2965 - val_accuracy1000: 0.3982 - 8s/epoch - 31ms/step
testing model: results/LILAK/W1/deepOF_L2/h1000
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1019044
{'0': {'precision': 0.2545171339563863, 'recall': 0.028710487937729515, 'f1-score': 0.051600271580376736, 'support': 56913}, '1': {'precision': 0.3771167684739032, 'recall': 0.9259696301586808, 'f1-score': 0.5359562880816722, 'support': 64406}, '2': {'precision': 0.31614918961140404, 'recall': 0.03347531221569763, 'f1-score': 0.060540338412639054, 'support': 48364}, 'accuracy': 0.3706381900367155, 'macro avg': {'precision': 0.3159276973472312, 'recall': 0.32938514343736935, 'f1-score': 0.21603229935822932, 'support': 169683}, 'weighted avg': {'precision': 0.318618574881137, 'recall': 0.3706381900367155, 'f1-score': 0.23799378767248947, 'support': 169683}}
[[ 1634 53783  1496]
 [ 2762 59638  2006]
 [ 2024 44721  1619]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1066612
{'0': {'precision': 0.39786028949024543, 'recall': 0.14807701316344216, 'f1-score': 0.21582684692066093, 'support': 21347}, '1': {'precision': 0.34665492311644464, 'recall': 0.8535670717932499, 'f1-score': 0.49306416463311187, 'support': 22133}, '2': {'precision': 0.43651960784313726, 'recall': 0.07729028338324002, 'f1-score': 0.13132765549533604, 'support': 23043}, 'accuracy': 0.3582820979210198, 'macro avg': {'precision': 0.3936782734832758, 'recall': 0.3596447894466441, 'f1-score': 0.28007288901636956, 'support': 66523}, 'weighted avg': {'precision': 0.39421490817632926, 'recall': 0.3582820979210198, 'f1-score': 0.27879722836641524, 'support': 66523}}
[[ 3161 16954  1232]
 [ 2174 18892  1067]
 [ 2610 18652  1781]]
Evaluating performance on  val set...
51/51 - 1s - 991ms/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.088986
{'0': {'precision': 0.36032944406314343, 'recall': 0.12414282336249705, 'f1-score': 0.1846640872317974, 'support': 4229}, '1': {'precision': 0.41292888190141497, 'recall': 0.8466059916571862, 'f1-score': 0.5551066078199789, 'support': 5274}, '2': {'precision': 0.2651646447140381, 'recall': 0.045753588516746414, 'f1-score': 0.07804131599081866, 'support': 3344}, 'accuracy': 0.40032692457383046, 'macro avg': {'precision': 0.3461409902261989, 'recall': 0.3388341345121432, 'f1-score': 0.27260400368086496, 'support': 12847}, 'weighted avg': {'precision': 0.35715191982679534, 'recall': 0.40032692457383046, 'f1-score': 0.3089862874771649, 'support': 12847}}
[[ 525 3497  207]
 [ 592 4465  217]
 [ 340 2851  153]]
training model: results/LILAK/W1/deepVOL_L2/h10
Epoch 1/50
260/260 - 11s - loss: 3.3492 - accuracy10: 0.3353 - val_loss: 3.3485 - val_accuracy10: 0.3590 - 11s/epoch - 42ms/step
Epoch 2/50
260/260 - 8s - loss: 3.2986 - accuracy10: 0.3442 - val_loss: 3.3132 - val_accuracy10: 0.4071 - 8s/epoch - 31ms/step
Epoch 3/50
260/260 - 8s - loss: 3.2740 - accuracy10: 0.3533 - val_loss: 3.3283 - val_accuracy10: 0.3700 - 8s/epoch - 30ms/step
Epoch 4/50
260/260 - 8s - loss: 3.2618 - accuracy10: 0.3566 - val_loss: 3.3011 - val_accuracy10: 0.4001 - 8s/epoch - 31ms/step
Epoch 5/50
260/260 - 7s - loss: 3.2459 - accuracy10: 0.3615 - val_loss: 3.2980 - val_accuracy10: 0.3835 - 7s/epoch - 28ms/step
Epoch 6/50
260/260 - 7s - loss: 3.2335 - accuracy10: 0.3661 - val_loss: 3.3040 - val_accuracy10: 0.3942 - 7s/epoch - 29ms/step
Epoch 7/50
260/260 - 7s - loss: 3.2235 - accuracy10: 0.3709 - val_loss: 3.3047 - val_accuracy10: 0.3834 - 7s/epoch - 28ms/step
Epoch 8/50
260/260 - 7s - loss: 3.2115 - accuracy10: 0.3751 - val_loss: 3.3271 - val_accuracy10: 0.4176 - 7s/epoch - 29ms/step
Epoch 9/50
260/260 - 8s - loss: 3.1987 - accuracy10: 0.3796 - val_loss: 3.2938 - val_accuracy10: 0.4277 - 8s/epoch - 30ms/step
Epoch 10/50
260/260 - 7s - loss: 3.1904 - accuracy10: 0.3880 - val_loss: 3.3298 - val_accuracy10: 0.4294 - 7s/epoch - 29ms/step
Epoch 11/50
260/260 - 7s - loss: 3.1812 - accuracy10: 0.3913 - val_loss: 3.3104 - val_accuracy10: 0.4320 - 7s/epoch - 29ms/step
Epoch 12/50
260/260 - 7s - loss: 3.1675 - accuracy10: 0.4033 - val_loss: 3.3172 - val_accuracy10: 0.4321 - 7s/epoch - 28ms/step
Epoch 13/50
260/260 - 7s - loss: 3.1601 - accuracy10: 0.4079 - val_loss: 3.3061 - val_accuracy10: 0.4293 - 7s/epoch - 29ms/step
Epoch 14/50
260/260 - 8s - loss: 3.1515 - accuracy10: 0.4125 - val_loss: 3.3053 - val_accuracy10: 0.4313 - 8s/epoch - 29ms/step
Epoch 15/50
260/260 - 8s - loss: 3.1451 - accuracy10: 0.4148 - val_loss: 3.2975 - val_accuracy10: 0.4402 - 8s/epoch - 30ms/step
Epoch 16/50
260/260 - 8s - loss: 3.1320 - accuracy10: 0.4244 - val_loss: 3.2834 - val_accuracy10: 0.4373 - 8s/epoch - 30ms/step
Epoch 17/50
260/260 - 8s - loss: 3.1224 - accuracy10: 0.4304 - val_loss: 3.3009 - val_accuracy10: 0.4382 - 8s/epoch - 32ms/step
Epoch 18/50
260/260 - 8s - loss: 3.1182 - accuracy10: 0.4351 - val_loss: 3.3122 - val_accuracy10: 0.4431 - 8s/epoch - 31ms/step
Epoch 19/50
260/260 - 8s - loss: 3.1063 - accuracy10: 0.4392 - val_loss: 3.3255 - val_accuracy10: 0.4369 - 8s/epoch - 30ms/step
Epoch 20/50
260/260 - 7s - loss: 3.1034 - accuracy10: 0.4414 - val_loss: 3.3074 - val_accuracy10: 0.4413 - 7s/epoch - 28ms/step
Epoch 21/50
260/260 - 8s - loss: 3.0915 - accuracy10: 0.4486 - val_loss: 3.3070 - val_accuracy10: 0.4460 - 8s/epoch - 29ms/step
Epoch 22/50
260/260 - 8s - loss: 3.0834 - accuracy10: 0.4474 - val_loss: 3.3257 - val_accuracy10: 0.4389 - 8s/epoch - 30ms/step
Epoch 23/50
260/260 - 8s - loss: 3.0781 - accuracy10: 0.4509 - val_loss: 3.3023 - val_accuracy10: 0.4217 - 8s/epoch - 30ms/step
Epoch 24/50
260/260 - 8s - loss: 3.0661 - accuracy10: 0.4562 - val_loss: 3.2975 - val_accuracy10: 0.4371 - 8s/epoch - 29ms/step
Epoch 25/50
260/260 - 8s - loss: 3.0586 - accuracy10: 0.4606 - val_loss: 3.2948 - val_accuracy10: 0.4201 - 8s/epoch - 29ms/step
Epoch 26/50
260/260 - 8s - loss: 3.0496 - accuracy10: 0.4637 - val_loss: 3.2884 - val_accuracy10: 0.4422 - 8s/epoch - 29ms/step
testing model: results/LILAK/W1/deepVOL_L2/h10
Evaluating performance on  test set...
663/663 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0771693
{'0': {'precision': 0.4021085759244689, 'recall': 0.24688423859486405, 'f1-score': 0.30593333971841774, 'support': 51753}, '1': {'precision': 0.41002483231559134, 'recall': 0.6974835392802381, 'f1-score': 0.5164485950100456, 'support': 66522}, '2': {'precision': 0.41419568554577035, 'recall': 0.19942427012623268, 'f1-score': 0.2692242047080757, 'support': 51413}, 'accuracy': 0.40915091226250533, 'macro avg': {'precision': 0.40877636459527683, 'recall': 0.38126401600044496, 'f1-score': 0.363868713145513, 'support': 169688}, 'weighted avg': {'precision': 0.4088741679204275, 'recall': 0.40915091226250533, 'f1-score': 0.37733832447999754, 'support': 169688}}
[[12777 32976  6000]
 [11623 46398  8501]
 [ 7375 33785 10253]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.014482
{'0': {'precision': 0.3911144081767227, 'recall': 0.29659957494686834, 'f1-score': 0.3373622467116957, 'support': 15998}, '1': {'precision': 0.5418168067974554, 'recall': 0.7215129883593495, 'f1-score': 0.6188848943711175, 'support': 33761}, '2': {'precision': 0.37623237570232165, 'recall': 0.21170365068002864, 'f1-score': 0.2709470550062984, 'support': 16764}, 'accuracy': 0.49085278775761765, 'macro avg': {'precision': 0.43638786355883324, 'recall': 0.4099387379954155, 'f1-score': 0.40906473202970384, 'support': 66523}, 'weighted avg': {'precision': 0.4638468659346966, 'recall': 0.49085278775761765, 'f1-score': 0.46350060237635987, 'support': 66523}}
[[ 4745  9571  1682]
 [ 5200 24359  4202]
 [ 2187 11028  3549]]
Evaluating performance on  val set...
51/51 - 1s - 907ms/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0461096
{'0': {'precision': 0.3004769475357711, 'recall': 0.35795454545454547, 'f1-score': 0.32670700086430426, 'support': 3168}, '1': {'precision': 0.5302238305857123, 'recall': 0.6036929650541737, 'f1-score': 0.5645782788639931, 'support': 6553}, '2': {'precision': 0.34925558312655086, 'recall': 0.1801023672424824, 'f1-score': 0.23765301815111858, 'support': 3126}, 'accuracy': 0.44002490853895854, 'macro avg': {'precision': 0.39331878708267815, 'recall': 0.38058329258373386, 'f1-score': 0.37631276595980534, 'support': 12847}, 'weighted avg': {'precision': 0.4295353533490382, 'recall': 0.44002490853895854, 'f1-score': 0.4263713376565937, 'support': 12847}}
[[1134 1711  323]
 [1871 3956  726]
 [ 769 1794  563]]
training model: results/LILAK/W1/deepVOL_L2/h20
Epoch 1/50
260/260 - 10s - loss: 3.3534 - accuracy20: 0.3440 - val_loss: 3.3485 - val_accuracy20: 0.3649 - 10s/epoch - 40ms/step
Epoch 2/50
260/260 - 8s - loss: 3.3062 - accuracy20: 0.3540 - val_loss: 3.3442 - val_accuracy20: 0.3697 - 8s/epoch - 30ms/step
Epoch 3/50
260/260 - 8s - loss: 3.2864 - accuracy20: 0.3627 - val_loss: 3.3330 - val_accuracy20: 0.3730 - 8s/epoch - 32ms/step
Epoch 4/50
260/260 - 8s - loss: 3.2718 - accuracy20: 0.3679 - val_loss: 3.3252 - val_accuracy20: 0.3783 - 8s/epoch - 32ms/step
Epoch 5/50
260/260 - 7s - loss: 3.2612 - accuracy20: 0.3761 - val_loss: 3.3196 - val_accuracy20: 0.3894 - 7s/epoch - 28ms/step
Epoch 6/50
260/260 - 8s - loss: 3.2517 - accuracy20: 0.3819 - val_loss: 3.3287 - val_accuracy20: 0.3938 - 8s/epoch - 29ms/step
Epoch 7/50
260/260 - 8s - loss: 3.2424 - accuracy20: 0.3877 - val_loss: 3.3484 - val_accuracy20: 0.3954 - 8s/epoch - 29ms/step
Epoch 8/50
260/260 - 7s - loss: 3.2353 - accuracy20: 0.3911 - val_loss: 3.3468 - val_accuracy20: 0.4006 - 7s/epoch - 29ms/step
Epoch 9/50
260/260 - 8s - loss: 3.2240 - accuracy20: 0.4010 - val_loss: 3.3393 - val_accuracy20: 0.4003 - 8s/epoch - 29ms/step
Epoch 10/50
260/260 - 8s - loss: 3.2159 - accuracy20: 0.4053 - val_loss: 3.3436 - val_accuracy20: 0.3974 - 8s/epoch - 31ms/step
Epoch 11/50
260/260 - 8s - loss: 3.2060 - accuracy20: 0.4112 - val_loss: 3.3433 - val_accuracy20: 0.3953 - 8s/epoch - 29ms/step
Epoch 12/50
260/260 - 8s - loss: 3.1985 - accuracy20: 0.4126 - val_loss: 3.3446 - val_accuracy20: 0.4021 - 8s/epoch - 29ms/step
Epoch 13/50
260/260 - 8s - loss: 3.1881 - accuracy20: 0.4209 - val_loss: 3.3556 - val_accuracy20: 0.3955 - 8s/epoch - 31ms/step
Epoch 14/50
260/260 - 8s - loss: 3.1800 - accuracy20: 0.4261 - val_loss: 3.3482 - val_accuracy20: 0.4013 - 8s/epoch - 31ms/step
Epoch 15/50
260/260 - 8s - loss: 3.1700 - accuracy20: 0.4297 - val_loss: 3.3748 - val_accuracy20: 0.3986 - 8s/epoch - 30ms/step
testing model: results/LILAK/W1/deepVOL_L2/h20
Evaluating performance on  test set...
663/663 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1320788
{'0': {'precision': 0.39794285714285715, 'recall': 0.028853643580437197, 'f1-score': 0.05380597706833143, 'support': 60339}, '1': {'precision': 0.2899405914157933, 'recall': 0.8792712550607288, 'f1-score': 0.43608252597761155, 'support': 49400}, '2': {'precision': 0.3956008514481068, 'recall': 0.10230362474770222, 'f1-score': 0.16256692996872185, 'support': 59949}, 'accuracy': 0.3023784828626656, 'macro avg': {'precision': 0.36116143333558576, 'recall': 0.3368095077962894, 'f1-score': 0.2174851443382216, 'support': 169688}, 'weighted avg': {'precision': 0.36567355803914015, 'recall': 0.3023784828626656, 'f1-score': 0.2035194033656768, 'support': 169688}}
[[ 1741 53941  4657]
 [ 1251 43436  4713]
 [ 1383 52433  6133]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0845206
{'0': {'precision': 0.3964535901926445, 'recall': 0.09254433031836068, 'f1-score': 0.15006007374570163, 'support': 19569}, '1': {'precision': 0.39950936180958907, 'recall': 0.8431551697883356, 'f1-score': 0.5421388882089442, 'support': 26268}, '2': {'precision': 0.36535215589995396, 'recall': 0.11510200135357246, 'f1-score': 0.17505422196081313, 'support': 20686}, 'accuracy': 0.395953279316928, 'macro avg': {'precision': 0.3871050359673958, 'recall': 0.35026716715342293, 'f1-score': 0.2890843946384863, 'support': 66523}, 'weighted avg': {'precision': 0.3879889199140236, 'recall': 0.395953279316928, 'f1-score': 0.3126527897732147, 'support': 66523}}
[[ 1811 16079  1679]
 [ 1663 22148  2457]
 [ 1094 17211  2381]]
Evaluating performance on  val set...
51/51 - 1s - 1s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0879664
{'0': {'precision': 0.35709294199860236, 'recall': 0.13055697496167604, 'f1-score': 0.1912067352666043, 'support': 3914}, '1': {'precision': 0.40273789010147426, 'recall': 0.8149941882991089, 'f1-score': 0.5390825217837006, 'support': 5162}, '2': {'precision': 0.3268041237113402, 'recall': 0.08406258286926545, 'f1-score': 0.13372706180130775, 'support': 3771}, 'accuracy': 0.39192029267533274, 'macro avg': {'precision': 0.36221165193713895, 'recall': 0.3432045820433501, 'f1-score': 0.28800543961720426, 'support': 12847}, 'weighted avg': {'precision': 0.36654262584274955, 'recall': 0.39192029267533274, 'f1-score': 0.31411316955971696, 'support': 12847}}
[[ 511 3140  263]
 [ 565 4207  390]
 [ 355 3099  317]]
training model: results/LILAK/W1/deepVOL_L2/h30
Epoch 1/50
260/260 - 10s - loss: 3.3530 - accuracy30: 0.3503 - val_loss: 3.3516 - val_accuracy30: 0.3433 - 10s/epoch - 40ms/step
Epoch 2/50
260/260 - 9s - loss: 3.2994 - accuracy30: 0.3614 - val_loss: 3.3175 - val_accuracy30: 0.3423 - 9s/epoch - 33ms/step
Epoch 3/50
260/260 - 7s - loss: 3.2846 - accuracy30: 0.3679 - val_loss: 3.3360 - val_accuracy30: 0.3489 - 7s/epoch - 28ms/step
Epoch 4/50
260/260 - 8s - loss: 3.2749 - accuracy30: 0.3776 - val_loss: 3.3063 - val_accuracy30: 0.3578 - 8s/epoch - 30ms/step
Epoch 5/50
260/260 - 8s - loss: 3.2638 - accuracy30: 0.3818 - val_loss: 3.3113 - val_accuracy30: 0.3462 - 8s/epoch - 30ms/step
Epoch 6/50
260/260 - 8s - loss: 3.2535 - accuracy30: 0.3930 - val_loss: 3.3186 - val_accuracy30: 0.3511 - 8s/epoch - 30ms/step
Epoch 7/50
260/260 - 8s - loss: 3.2474 - accuracy30: 0.3962 - val_loss: 3.3278 - val_accuracy30: 0.3476 - 8s/epoch - 31ms/step
Epoch 8/50
260/260 - 8s - loss: 3.2412 - accuracy30: 0.3995 - val_loss: 3.3146 - val_accuracy30: 0.3637 - 8s/epoch - 29ms/step
Epoch 9/50
260/260 - 8s - loss: 3.2322 - accuracy30: 0.4040 - val_loss: 3.3063 - val_accuracy30: 0.3562 - 8s/epoch - 31ms/step
Epoch 10/50
260/260 - 8s - loss: 3.2280 - accuracy30: 0.4052 - val_loss: 3.3216 - val_accuracy30: 0.3678 - 8s/epoch - 29ms/step
Epoch 11/50
260/260 - 8s - loss: 3.2159 - accuracy30: 0.4152 - val_loss: 3.3116 - val_accuracy30: 0.3641 - 8s/epoch - 29ms/step
Epoch 12/50
260/260 - 8s - loss: 3.2138 - accuracy30: 0.4180 - val_loss: 3.3184 - val_accuracy30: 0.3646 - 8s/epoch - 30ms/step
Epoch 13/50
260/260 - 8s - loss: 3.2053 - accuracy30: 0.4230 - val_loss: 3.3133 - val_accuracy30: 0.3651 - 8s/epoch - 30ms/step
Epoch 14/50
260/260 - 7s - loss: 3.1927 - accuracy30: 0.4278 - val_loss: 3.3170 - val_accuracy30: 0.3681 - 7s/epoch - 29ms/step
testing model: results/LILAK/W1/deepVOL_L2/h30
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1350765
{'0': {'precision': 0.4675742936612502, 'recall': 0.049017050075965685, 'f1-score': 0.08873208134237139, 'support': 65161}, '1': {'precision': 0.2347080557046768, 'recall': 0.748734480066487, 'f1-score': 0.3573854244928625, 'support': 39707}, '2': {'precision': 0.4242725690126834, 'recall': 0.23687133600740512, 'f1-score': 0.30401251373639976, 'support': 64820}, 'accuracy': 0.28451039554947904, 'macro avg': {'precision': 0.37551830612620346, 'recall': 0.34487428871661924, 'f1-score': 0.2500433398572112, 'support': 169688}, 'weighted avg': {'precision': 0.39654253241554177, 'recall': 0.28451039554947904, 'f1-score': 0.2338330662338043, 'support': 169688}}
[[ 3194 49598 12369]
 [ 1511 29730  8466]
 [ 2126 47340 15354]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0991849
{'0': {'precision': 0.43133213089409944, 'recall': 0.1531424389351386, 'f1-score': 0.22603294625978934, 'support': 21862}, '1': {'precision': 0.33369086968894335, 'recall': 0.7047619047619048, 'f1-score': 0.45292885475316796, 'support': 21630}, '2': {'precision': 0.4100015292858235, 'recall': 0.23281663844383657, 'f1-score': 0.29698967016533273, 'support': 23031}, 'accuracy': 0.36008598529831787, 'macro avg': {'precision': 0.39167484328962204, 'recall': 0.3635736607136266, 'f1-score': 0.32531715705943004, 'support': 66523}, 'weighted avg': {'precision': 0.3921991157638779, 'recall': 0.36008598529831787, 'f1-score': 0.3243743140420654, 'support': 66523}}
[[ 3348 14812  3702]
 [ 2372 15244  4014]
 [ 2042 15627  5362]]
Evaluating performance on  val set...
51/51 - 1s - 934ms/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1029721
{'0': {'precision': 0.4057701256398325, 'recall': 0.2011070110701107, 'f1-score': 0.26892829606784885, 'support': 4336}, '1': {'precision': 0.3395061728395062, 'recall': 0.6490050902360018, 'f1-score': 0.44580419580419584, 'support': 4322}, '2': {'precision': 0.35591133004926107, 'recall': 0.20697063738362378, 'f1-score': 0.2617358490566038, 'support': 4189}, 'accuracy': 0.3537012532108664, 'macro avg': {'precision': 0.3670625428428666, 'recall': 0.3523609128965788, 'f1-score': 0.3254894469762162, 'support': 12847}, 'weighted avg': {'precision': 0.3672201685500906, 'recall': 0.3537012532108664, 'f1-score': 0.3260878257736468, 'support': 12847}}
[[ 872 2694  770]
 [ 718 2805  799]
 [ 559 2763  867]]
training model: results/LILAK/W1/deepVOL_L2/h50
Epoch 1/50
260/260 - 10s - loss: 3.3453 - accuracy50: 0.3546 - val_loss: 3.3359 - val_accuracy50: 0.3660 - 10s/epoch - 38ms/step
Epoch 2/50
260/260 - 8s - loss: 3.3081 - accuracy50: 0.3601 - val_loss: 3.2959 - val_accuracy50: 0.3755 - 8s/epoch - 30ms/step
Epoch 3/50
260/260 - 8s - loss: 3.2898 - accuracy50: 0.3680 - val_loss: 3.2853 - val_accuracy50: 0.3813 - 8s/epoch - 29ms/step
Epoch 4/50
260/260 - 8s - loss: 3.2762 - accuracy50: 0.3775 - val_loss: 3.2863 - val_accuracy50: 0.3826 - 8s/epoch - 29ms/step
Epoch 5/50
260/260 - 8s - loss: 3.2679 - accuracy50: 0.3830 - val_loss: 3.2890 - val_accuracy50: 0.3845 - 8s/epoch - 30ms/step
Epoch 6/50
260/260 - 8s - loss: 3.2590 - accuracy50: 0.3906 - val_loss: 3.3175 - val_accuracy50: 0.3816 - 8s/epoch - 30ms/step
Epoch 7/50
260/260 - 8s - loss: 3.2533 - accuracy50: 0.3953 - val_loss: 3.2861 - val_accuracy50: 0.3844 - 8s/epoch - 30ms/step
Epoch 8/50
260/260 - 8s - loss: 3.2472 - accuracy50: 0.3979 - val_loss: 3.2810 - val_accuracy50: 0.3826 - 8s/epoch - 31ms/step
Epoch 9/50
260/260 - 8s - loss: 3.2400 - accuracy50: 0.4031 - val_loss: 3.2887 - val_accuracy50: 0.3840 - 8s/epoch - 30ms/step
Epoch 10/50
260/260 - 8s - loss: 3.2322 - accuracy50: 0.4053 - val_loss: 3.3042 - val_accuracy50: 0.3790 - 8s/epoch - 30ms/step
Epoch 11/50
260/260 - 8s - loss: 3.2277 - accuracy50: 0.4085 - val_loss: 3.3020 - val_accuracy50: 0.3870 - 8s/epoch - 31ms/step
Epoch 12/50
260/260 - 7s - loss: 3.2201 - accuracy50: 0.4136 - val_loss: 3.3005 - val_accuracy50: 0.3813 - 7s/epoch - 27ms/step
Epoch 13/50
260/260 - 7s - loss: 3.2146 - accuracy50: 0.4156 - val_loss: 3.3000 - val_accuracy50: 0.3809 - 7s/epoch - 28ms/step
Epoch 14/50
260/260 - 7s - loss: 3.2071 - accuracy50: 0.4189 - val_loss: 3.3056 - val_accuracy50: 0.3893 - 7s/epoch - 28ms/step
Epoch 15/50
260/260 - 7s - loss: 3.2017 - accuracy50: 0.4221 - val_loss: 3.3052 - val_accuracy50: 0.3893 - 7s/epoch - 28ms/step
Epoch 16/50
260/260 - 7s - loss: 3.1947 - accuracy50: 0.4279 - val_loss: 3.3262 - val_accuracy50: 0.3855 - 7s/epoch - 29ms/step
Epoch 17/50
260/260 - 7s - loss: 3.1906 - accuracy50: 0.4292 - val_loss: 3.3198 - val_accuracy50: 0.3846 - 7s/epoch - 29ms/step
Epoch 18/50
260/260 - 8s - loss: 3.1820 - accuracy50: 0.4334 - val_loss: 3.3237 - val_accuracy50: 0.3814 - 8s/epoch - 30ms/step
testing model: results/LILAK/W1/deepVOL_L2/h50
Evaluating performance on  test set...
663/663 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1288396
{'0': {'precision': 0.4279605007386673, 'recall': 0.0907083292132239, 'f1-score': 0.14968928051782046, 'support': 60678}, '1': {'precision': 0.2794608986183134, 'recall': 0.6629855922057548, 'f1-score': 0.3931863531197591, 'support': 48446}, '2': {'precision': 0.39556032939491587, 'recall': 0.2736278977610462, 'f1-score': 0.32348549175767866, 'support': 60564}, 'accuracy': 0.3193802743859318, 'macro avg': {'precision': 0.3676605762506322, 'recall': 0.3424406063933416, 'f1-score': 0.28878704179841935, 'support': 169688}, 'weighted avg': {'precision': 0.37399972742773413, 'recall': 0.3193802743859318, 'f1-score': 0.28123808135703293, 'support': 169688}}
[[ 5504 42451 12723]
 [ 3727 32119 12600]
 [ 3630 40362 16572]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0953803
{'0': {'precision': 0.4476433970653624, 'recall': 0.18472477064220183, 'f1-score': 0.26152747110014285, 'support': 21800}, '1': {'precision': 0.34521209334406255, 'recall': 0.6833386428798981, 'f1-score': 0.4586973788721208, 'support': 21973}, '2': {'precision': 0.41818700114025087, 'recall': 0.2579340659340659, 'f1-score': 0.31906910989070747, 'support': 22750}, 'accuracy': 0.3744569547374592, 'macro avg': {'precision': 0.4036808305165586, 'recall': 0.37533249315205525, 'f1-score': 0.3464313199543237, 'support': 66523}, 'weighted avg': {'precision': 0.4037359358269274, 'recall': 0.3744569547374592, 'f1-score': 0.3463325259828003, 'support': 66523}}
[[ 4027 13997  3776]
 [ 2570 15015  4388]
 [ 2399 14483  5868]]
Evaluating performance on  val set...
51/51 - 1s - 925ms/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0935718
{'0': {'precision': 0.4014760147601476, 'recall': 0.2660797260943996, 'f1-score': 0.32004706574496256, 'support': 4089}, '1': {'precision': 0.381201044386423, 'recall': 0.6293103448275862, 'f1-score': 0.47479674796747967, 'support': 4872}, '2': {'precision': 0.3510028653295129, 'recall': 0.18914050437467833, 'f1-score': 0.245819397993311, 'support': 3886}, 'accuracy': 0.3805557717755118, 'macro avg': {'precision': 0.37789330815869454, 'recall': 0.3615101917655547, 'f1-score': 0.34688773723525107, 'support': 12847}, 'weighted avg': {'precision': 0.37851981375226773, 'recall': 0.3805557717755118, 'f1-score': 0.35628056266293445, 'support': 12847}}
[[1088 2451  550]
 [ 997 3066  809]
 [ 625 2526  735]]
training model: results/LILAK/W1/deepVOL_L2/h100
Epoch 1/50
260/260 - 10s - loss: 3.3420 - accuracy100: 0.3595 - val_loss: 3.2125 - val_accuracy100: 0.4754 - 10s/epoch - 40ms/step
Epoch 2/50
260/260 - 8s - loss: 3.3006 - accuracy100: 0.3717 - val_loss: 3.1862 - val_accuracy100: 0.4724 - 8s/epoch - 31ms/step
Epoch 3/50
260/260 - 9s - loss: 3.2850 - accuracy100: 0.3742 - val_loss: 3.1664 - val_accuracy100: 0.4723 - 9s/epoch - 34ms/step
Epoch 4/50
260/260 - 8s - loss: 3.2801 - accuracy100: 0.3780 - val_loss: 3.1739 - val_accuracy100: 0.4715 - 8s/epoch - 30ms/step
Epoch 5/50
260/260 - 8s - loss: 3.2778 - accuracy100: 0.3818 - val_loss: 3.1777 - val_accuracy100: 0.4700 - 8s/epoch - 31ms/step
Epoch 6/50
260/260 - 8s - loss: 3.2700 - accuracy100: 0.3864 - val_loss: 3.1822 - val_accuracy100: 0.4610 - 8s/epoch - 29ms/step
Epoch 7/50
260/260 - 8s - loss: 3.2679 - accuracy100: 0.3887 - val_loss: 3.1841 - val_accuracy100: 0.4621 - 8s/epoch - 31ms/step
Epoch 8/50
260/260 - 7s - loss: 3.2617 - accuracy100: 0.3904 - val_loss: 3.1873 - val_accuracy100: 0.4565 - 7s/epoch - 28ms/step
Epoch 9/50
260/260 - 7s - loss: 3.2529 - accuracy100: 0.3966 - val_loss: 3.1852 - val_accuracy100: 0.4568 - 7s/epoch - 27ms/step
Epoch 10/50
260/260 - 7s - loss: 3.2497 - accuracy100: 0.4016 - val_loss: 3.1875 - val_accuracy100: 0.4602 - 7s/epoch - 29ms/step
Epoch 11/50
260/260 - 8s - loss: 3.2469 - accuracy100: 0.4013 - val_loss: 3.1820 - val_accuracy100: 0.4605 - 8s/epoch - 31ms/step
Epoch 12/50
260/260 - 8s - loss: 3.2408 - accuracy100: 0.4061 - val_loss: 3.1784 - val_accuracy100: 0.4602 - 8s/epoch - 30ms/step
Epoch 13/50
260/260 - 8s - loss: 3.2362 - accuracy100: 0.4104 - val_loss: 3.1729 - val_accuracy100: 0.4705 - 8s/epoch - 29ms/step
testing model: results/LILAK/W1/deepVOL_L2/h100
Evaluating performance on  test set...
663/663 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1295627
{'0': {'precision': 0.37037037037037035, 'recall': 0.0008948866178655165, 'f1-score': 0.0017854592201114127, 'support': 55873}, '1': {'precision': 0.3510913379713953, 'recall': 0.9808802429176816, 'f1-score': 0.5170959528217668, 'support': 59938}, '2': {'precision': 0.3026692087702574, 'recall': 0.011786105388199046, 'f1-score': 0.02268870031263957, 'support': 53877}, 'accuracy': 0.35050799113667436, 'macro avg': {'precision': 0.3413769723706743, 'recall': 0.3311870783079154, 'f1-score': 0.18052337078483927, 'support': 169688}, 'weighted avg': {'precision': 0.3420649974067014, 'recall': 0.35050799113667436, 'f1-score': 0.19044278493458835, 'support': 169688}}
[[   50 55463   360]
 [   43 58792  1103]
 [   42 53200   635]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.132636
{'0': {'precision': 0.4551282051282051, 'recall': 0.006483130164817605, 'f1-score': 0.012784154850326357, 'support': 21903}, '1': {'precision': 0.32997492803417217, 'recall': 0.9752538651541488, 'f1-score': 0.49310791433461315, 'support': 21862}, '2': {'precision': 0.43832185347526614, 'recall': 0.030758414623429122, 'f1-score': 0.05748306302607267, 'support': 22758}, 'accuracy': 0.3331629661921441, 'macro avg': {'precision': 0.4078083288792145, 'recall': 0.3374984699807985, 'f1-score': 0.18779171073700407, 'support': 66523}, 'weighted avg': {'precision': 0.4082484809012861, 'recall': 0.3331629661921441, 'f1-score': 0.18592871811580014, 'support': 66523}}
[[  142 21322   439]
 [   83 21321   458]
 [   87 21971   700]]
Evaluating performance on  val set...
51/51 - 1s - 957ms/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0567765
{'0': {'precision': 0.27884615384615385, 'recall': 0.00841311285175515, 'f1-score': 0.016333427203604617, 'support': 3447}, '1': {'precision': 0.4762929317077058, 'recall': 0.9763149297615158, 'f1-score': 0.6402442290182636, 'support': 6122}, '2': {'precision': 0.26804123711340205, 'recall': 0.01586333129957291, 'f1-score': 0.029953917050691243, 'support': 3278}, 'accuracy': 0.4715497781583249, 'macro avg': {'precision': 0.34106010755575394, 'recall': 0.33353045797094794, 'f1-score': 0.22884385775751984, 'support': 12847}, 'weighted avg': {'precision': 0.37017881182221524, 'recall': 0.4715497781583249, 'f1-score': 0.3171219299223788, 'support': 12847}}
[[  29 3374   44]
 [  47 5977   98]
 [  28 3198   52]]
training model: results/LILAK/W1/deepVOL_L2/h200
Epoch 1/50
260/260 - 10s - loss: 3.3451 - accuracy200: 0.3520 - val_loss: 3.3881 - val_accuracy200: 0.3874 - 10s/epoch - 39ms/step
Epoch 2/50
260/260 - 8s - loss: 3.3154 - accuracy200: 0.3577 - val_loss: 3.3074 - val_accuracy200: 0.3843 - 8s/epoch - 32ms/step
Epoch 3/50
260/260 - 7s - loss: 3.3005 - accuracy200: 0.3619 - val_loss: 3.3022 - val_accuracy200: 0.3868 - 7s/epoch - 29ms/step
Epoch 4/50
260/260 - 8s - loss: 3.2874 - accuracy200: 0.3715 - val_loss: 3.2927 - val_accuracy200: 0.3957 - 8s/epoch - 31ms/step
Epoch 5/50
260/260 - 8s - loss: 3.2771 - accuracy200: 0.3783 - val_loss: 3.2894 - val_accuracy200: 0.3967 - 8s/epoch - 30ms/step
Epoch 6/50
260/260 - 8s - loss: 3.2759 - accuracy200: 0.3813 - val_loss: 3.2785 - val_accuracy200: 0.3877 - 8s/epoch - 30ms/step
Epoch 7/50
260/260 - 8s - loss: 3.2694 - accuracy200: 0.3830 - val_loss: 3.2794 - val_accuracy200: 0.3943 - 8s/epoch - 29ms/step
Epoch 8/50
260/260 - 7s - loss: 3.2596 - accuracy200: 0.3919 - val_loss: 3.2847 - val_accuracy200: 0.3915 - 7s/epoch - 28ms/step
Epoch 9/50
260/260 - 8s - loss: 3.2505 - accuracy200: 0.3962 - val_loss: 3.2815 - val_accuracy200: 0.3978 - 8s/epoch - 29ms/step
Epoch 10/50
260/260 - 8s - loss: 3.2412 - accuracy200: 0.4020 - val_loss: 3.2795 - val_accuracy200: 0.4034 - 8s/epoch - 29ms/step
Epoch 11/50
260/260 - 8s - loss: 3.2405 - accuracy200: 0.4040 - val_loss: 3.2966 - val_accuracy200: 0.4024 - 8s/epoch - 30ms/step
Epoch 12/50
260/260 - 8s - loss: 3.2351 - accuracy200: 0.4067 - val_loss: 3.2880 - val_accuracy200: 0.3981 - 8s/epoch - 30ms/step
Epoch 13/50
260/260 - 8s - loss: 3.2272 - accuracy200: 0.4102 - val_loss: 3.2910 - val_accuracy200: 0.3960 - 8s/epoch - 30ms/step
Epoch 14/50
260/260 - 8s - loss: 3.2214 - accuracy200: 0.4131 - val_loss: 3.3008 - val_accuracy200: 0.3954 - 8s/epoch - 29ms/step
Epoch 15/50
260/260 - 8s - loss: 3.2075 - accuracy200: 0.4200 - val_loss: 3.3345 - val_accuracy200: 0.3914 - 8s/epoch - 31ms/step
Epoch 16/50
260/260 - 8s - loss: 3.2013 - accuracy200: 0.4224 - val_loss: 3.3580 - val_accuracy200: 0.3851 - 8s/epoch - 30ms/step
testing model: results/LILAK/W1/deepVOL_L2/h200
Evaluating performance on  test set...
663/663 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1263138
{'0': {'precision': 0.4134766649187205, 'recall': 0.02551078182377016, 'f1-score': 0.04805655863844829, 'support': 61817}, '1': {'precision': 0.3074782935942582, 'recall': 0.8757919721302375, 'f1-score': 0.4551572517868956, 'support': 52243}, '2': {'precision': 0.3374340949033392, 'recall': 0.1035449773495362, 'f1-score': 0.15846378167212302, 'support': 55628}, 'accuracy': 0.31287421620857103, 'macro avg': {'precision': 0.3527963511387726, 'recall': 0.334949243767848, 'f1-score': 0.2205591973658223, 'support': 169688}, 'weighted avg': {'precision': 0.355913554988027, 'recall': 0.31287421620857103, 'f1-score': 0.20958768939060277, 'support': 169688}}
[[ 1577 54141  6099]
 [ 1278 45754  5211]
 [  959 48909  5760]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1065193
{'0': {'precision': 0.44708798017348206, 'recall': 0.08275229357798165, 'f1-score': 0.1396555060963809, 'support': 21800}, '1': {'precision': 0.33647706231505353, 'recall': 0.8838181818181818, 'f1-score': 0.48739769636657604, 'support': 22000}, '2': {'precision': 0.3937460114869177, 'recall': 0.081459314351098, 'f1-score': 0.13499124854142358, 'support': 22723}, 'accuracy': 0.34723328773506906, 'macro avg': {'precision': 0.3924370179918178, 'recall': 0.34934326324908715, 'f1-score': 0.25401481700146017, 'support': 66523}, 'weighted avg': {'precision': 0.3922869377167343, 'recall': 0.34723328773506906, 'f1-score': 0.25306503755952897, 'support': 66523}}
[[ 1804 18603  1393]
 [ 1099 19444  1457]
 [ 1132 19740  1851]]
Evaluating performance on  val set...
51/51 - 1s - 979ms/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0917504
{'0': {'precision': 0.42164502164502166, 'recall': 0.11901270772238515, 'f1-score': 0.18562988374309128, 'support': 4092}, '1': {'precision': 0.39655661716015517, 'recall': 0.8266614080063104, 'f1-score': 0.5359928397903082, 'support': 5071}, '2': {'precision': 0.3157894736842105, 'recall': 0.09609120521172639, 'f1-score': 0.1473465140478668, 'support': 3684}, 'accuracy': 0.39176461430684206, 'macro avg': {'precision': 0.37799703749646246, 'recall': 0.3472551069801406, 'f1-score': 0.2896564125270888, 'support': 12847}, 'weighted avg': {'precision': 0.38138697402064353, 'recall': 0.39176461430684206, 'f1-score': 0.31294790477198753, 'support': 12847}}
[[ 487 3339  266]
 [ 378 4192  501]
 [ 290 3040  354]]
training model: results/LILAK/W1/deepVOL_L2/h300
Epoch 1/50
260/260 - 11s - loss: 3.3384 - accuracy300: 0.3624 - val_loss: 3.3130 - val_accuracy300: 0.4239 - 11s/epoch - 41ms/step
Epoch 2/50
260/260 - 8s - loss: 3.3170 - accuracy300: 0.3676 - val_loss: 3.2465 - val_accuracy300: 0.4322 - 8s/epoch - 30ms/step
Epoch 3/50
260/260 - 8s - loss: 3.2994 - accuracy300: 0.3650 - val_loss: 3.2438 - val_accuracy300: 0.4300 - 8s/epoch - 31ms/step
Epoch 4/50
260/260 - 7s - loss: 3.2911 - accuracy300: 0.3657 - val_loss: 3.2323 - val_accuracy300: 0.4224 - 7s/epoch - 29ms/step
Epoch 5/50
260/260 - 7s - loss: 3.2892 - accuracy300: 0.3656 - val_loss: 3.2433 - val_accuracy300: 0.4156 - 7s/epoch - 27ms/step
Epoch 6/50
260/260 - 7s - loss: 3.2781 - accuracy300: 0.3686 - val_loss: 3.2613 - val_accuracy300: 0.4117 - 7s/epoch - 28ms/step
Epoch 7/50
260/260 - 7s - loss: 3.2729 - accuracy300: 0.3757 - val_loss: 3.2674 - val_accuracy300: 0.4089 - 7s/epoch - 29ms/step
Epoch 8/50
260/260 - 8s - loss: 3.2768 - accuracy300: 0.3781 - val_loss: 3.2497 - val_accuracy300: 0.4059 - 8s/epoch - 31ms/step
Epoch 9/50
260/260 - 8s - loss: 3.2666 - accuracy300: 0.3830 - val_loss: 3.2633 - val_accuracy300: 0.3983 - 8s/epoch - 29ms/step
Epoch 10/50
260/260 - 8s - loss: 3.2577 - accuracy300: 0.3908 - val_loss: 3.2679 - val_accuracy300: 0.3960 - 8s/epoch - 30ms/step
Epoch 11/50
260/260 - 8s - loss: 3.2508 - accuracy300: 0.3947 - val_loss: 3.2788 - val_accuracy300: 0.3908 - 8s/epoch - 31ms/step
Epoch 12/50
260/260 - 8s - loss: 3.2462 - accuracy300: 0.3955 - val_loss: 3.2743 - val_accuracy300: 0.3951 - 8s/epoch - 29ms/step
Epoch 13/50
260/260 - 7s - loss: 3.2398 - accuracy300: 0.4020 - val_loss: 3.2822 - val_accuracy300: 0.3965 - 7s/epoch - 28ms/step
Epoch 14/50
260/260 - 7s - loss: 3.2298 - accuracy300: 0.4064 - val_loss: 3.3011 - val_accuracy300: 0.3954 - 7s/epoch - 28ms/step
testing model: results/LILAK/W1/deepVOL_L2/h300
Evaluating performance on  test set...
663/663 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1118819
{'0': {'precision': 0.3759742004837409, 'recall': 0.04791916424045213, 'f1-score': 0.08500425325069876, 'support': 58390}, '1': {'precision': 0.3460736895914435, 'recall': 0.8897238462704925, 'f1-score': 0.4983178963559926, 'support': 59351}, '2': {'precision': 0.3156314699792961, 'recall': 0.058694438562380886, 'f1-score': 0.09898225850958495, 'support': 51947}, 'accuracy': 0.3456520201782094, 'macro avg': {'precision': 0.34589312001816014, 'recall': 0.33211248302444185, 'f1-score': 0.22743480270542546, 'support': 169688}, 'weighted avg': {'precision': 0.3470431679800687, 'recall': 0.3456520201782094, 'f1-score': 0.23384620713739468, 'support': 169688}}
[[ 2798 52785  2807]
 [ 2741 52806  3804]
 [ 1903 46995  3049]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1097612
{'0': {'precision': 0.40188594521778176, 'recall': 0.08216662841404636, 'f1-score': 0.13643812645298983, 'support': 21785}, '1': {'precision': 0.33617644367163907, 'recall': 0.8383695453715537, 'f1-score': 0.4799132513750441, 'support': 21908}, '2': {'precision': 0.41364003228410007, 'recall': 0.13469119579500657, 'f1-score': 0.20321173671689136, 'support': 22830}, 'accuracy': 0.34923259624490777, 'macro avg': {'precision': 0.3839008070578403, 'recall': 0.3517424565268689, 'f1-score': 0.27318770484830845, 'support': 66523}, 'weighted avg': {'precision': 0.38427973455156333, 'recall': 0.34923259624490777, 'f1-score': 0.27247069502502114, 'support': 66523}}
[[ 1790 17875  2120]
 [ 1302 18367  2239]
 [ 1362 18393  3075]]
Evaluating performance on  val set...
51/51 - 1s - 923ms/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.07586
{'0': {'precision': 0.3824175824175824, 'recall': 0.13333333333333333, 'f1-score': 0.19772727272727272, 'support': 3915}, '1': {'precision': 0.43781568664824166, 'recall': 0.8262589928057554, 'f1-score': 0.5723540771195416, 'support': 5560}, '2': {'precision': 0.301314459049545, 'recall': 0.08837485172004746, 'f1-score': 0.1366659023159826, 'support': 3372}, 'accuracy': 0.4214213435043201, 'macro avg': {'precision': 0.373849242705123, 'recall': 0.34932239261971204, 'f1-score': 0.30224908405426565, 'support': 12847}, 'weighted avg': {'precision': 0.3851056595971141, 'recall': 0.4214213435043201, 'f1-score': 0.343833452488629, 'support': 12847}}
[[ 522 3105  288]
 [ 563 4594  403]
 [ 280 2794  298]]
training model: results/LILAK/W1/deepVOL_L2/h500
Epoch 1/50
260/260 - 10s - loss: 3.3388 - accuracy500: 0.3635 - val_loss: 3.3016 - val_accuracy500: 0.4195 - 10s/epoch - 39ms/step
Epoch 2/50
260/260 - 7s - loss: 3.3179 - accuracy500: 0.3610 - val_loss: 3.2804 - val_accuracy500: 0.4142 - 7s/epoch - 29ms/step
Epoch 3/50
260/260 - 8s - loss: 3.2943 - accuracy500: 0.3674 - val_loss: 3.2673 - val_accuracy500: 0.4219 - 8s/epoch - 29ms/step
Epoch 4/50
260/260 - 8s - loss: 3.2900 - accuracy500: 0.3681 - val_loss: 3.2478 - val_accuracy500: 0.4138 - 8s/epoch - 29ms/step
Epoch 5/50
260/260 - 7s - loss: 3.2787 - accuracy500: 0.3779 - val_loss: 3.2654 - val_accuracy500: 0.4085 - 7s/epoch - 29ms/step
Epoch 6/50
260/260 - 8s - loss: 3.2749 - accuracy500: 0.3774 - val_loss: 3.2955 - val_accuracy500: 0.3988 - 8s/epoch - 29ms/step
Epoch 7/50
260/260 - 8s - loss: 3.2618 - accuracy500: 0.3866 - val_loss: 3.3448 - val_accuracy500: 0.3943 - 8s/epoch - 29ms/step
Epoch 8/50
260/260 - 8s - loss: 3.2526 - accuracy500: 0.3935 - val_loss: 3.3590 - val_accuracy500: 0.3988 - 8s/epoch - 30ms/step
Epoch 9/50
260/260 - 8s - loss: 3.2474 - accuracy500: 0.3974 - val_loss: 3.4023 - val_accuracy500: 0.3985 - 8s/epoch - 29ms/step
Epoch 10/50
260/260 - 8s - loss: 3.2477 - accuracy500: 0.3963 - val_loss: 3.3448 - val_accuracy500: 0.3950 - 8s/epoch - 29ms/step
Epoch 11/50
260/260 - 8s - loss: 3.2380 - accuracy500: 0.4009 - val_loss: 3.3242 - val_accuracy500: 0.4068 - 8s/epoch - 30ms/step
Epoch 12/50
260/260 - 7s - loss: 3.2309 - accuracy500: 0.4032 - val_loss: 3.3145 - val_accuracy500: 0.4104 - 7s/epoch - 28ms/step
Epoch 13/50
260/260 - 7s - loss: 3.2203 - accuracy500: 0.4098 - val_loss: 3.3047 - val_accuracy500: 0.4117 - 7s/epoch - 28ms/step
Epoch 14/50
260/260 - 8s - loss: 3.2144 - accuracy500: 0.4138 - val_loss: 3.3074 - val_accuracy500: 0.4159 - 8s/epoch - 29ms/step
testing model: results/LILAK/W1/deepVOL_L2/h500
Evaluating performance on  test set...
663/663 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1142833
{'0': {'precision': 0.332871012482663, 'recall': 0.038567985001339164, 'f1-score': 0.06912663615707107, 'support': 56005}, '1': {'precision': 0.37458360574079264, 'recall': 0.9369986761155673, 'f1-score': 0.5352075085627863, 'support': 64205}, '2': {'precision': 0.27833461835003853, 'recall': 0.014592344072112858, 'f1-score': 0.027730834229528344, 'support': 49478}, 'accuracy': 0.37151713733440195, 'macro avg': {'precision': 0.3285964121911647, 'recall': 0.3300530017296731, 'f1-score': 0.21068832631646192, 'support': 169688}, 'weighted avg': {'precision': 0.33275200195300986, 'recall': 0.37151713733440195, 'f1-score': 0.23340779289790123, 'support': 169688}}
[[ 2160 53264   581]
 [ 2754 60160  1291]
 [ 1575 47181   722]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.121785
{'0': {'precision': 0.4408179315768777, 'recall': 0.051105539092774106, 'f1-score': 0.0915924503635918, 'support': 21935}, '1': {'precision': 0.33352911425448256, 'recall': 0.9330868592815738, 'f1-score': 0.49140645657556314, 'support': 21909}, '2': {'precision': 0.4313360625232601, 'recall': 0.05110454605582257, 'f1-score': 0.09138216510289364, 'support': 22679}, 'accuracy': 0.3415811072862018, 'macro avg': {'precision': 0.40189436945154017, 'recall': 0.3450989814767235, 'f1-score': 0.22479369068068286, 'support': 66523}, 'weighted avg': {'precision': 0.40225036837342404, 'recall': 0.3415811072862018, 'f1-score': 0.22319739906811065, 'support': 66523}}
[[ 1121 20083   731]
 [  669 20443   797]
 [  753 20767  1159]]
Evaluating performance on  val set...
51/51 - 1s - 1s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0806665
{'0': {'precision': 0.3194207836456559, 'recall': 0.09270704573547589, 'f1-score': 0.1437056907453535, 'support': 4045}, '1': {'precision': 0.4259373621526246, 'recall': 0.8782972530471166, 'f1-score': 0.5736692015209125, 'support': 5497}, '2': {'precision': 0.28106508875739644, 'recall': 0.028744326777609682, 'f1-score': 0.052154817458138894, 'support': 3305}, 'accuracy': 0.41239199813185956, 'macro avg': {'precision': 0.34214107818522566, 'recall': 0.33324954185340067, 'f1-score': 0.2565099032414683, 'support': 12847}, 'weighted avg': {'precision': 0.355129981158469, 'recall': 0.41239199813185956, 'f1-score': 0.30412709516031444, 'support': 12847}}
[[ 375 3561  109]
 [ 535 4828  134]
 [ 264 2946   95]]
training model: results/LILAK/W1/deepVOL_L2/h1000
Epoch 1/50
260/260 - 11s - loss: 3.3437 - accuracy1000: 0.3576 - val_loss: 3.3832 - val_accuracy1000: 0.4114 - 11s/epoch - 41ms/step
Epoch 2/50
260/260 - 9s - loss: 3.3098 - accuracy1000: 0.3694 - val_loss: 3.3401 - val_accuracy1000: 0.4111 - 9s/epoch - 34ms/step
Epoch 3/50
260/260 - 9s - loss: 3.2907 - accuracy1000: 0.3748 - val_loss: 3.3406 - val_accuracy1000: 0.4086 - 9s/epoch - 34ms/step
Epoch 4/50
260/260 - 8s - loss: 3.2889 - accuracy1000: 0.3723 - val_loss: 3.2748 - val_accuracy1000: 0.4210 - 8s/epoch - 32ms/step
Epoch 5/50
260/260 - 8s - loss: 3.2842 - accuracy1000: 0.3742 - val_loss: 3.2976 - val_accuracy1000: 0.3990 - 8s/epoch - 31ms/step
Epoch 6/50
260/260 - 8s - loss: 3.2818 - accuracy1000: 0.3714 - val_loss: 3.2595 - val_accuracy1000: 0.4166 - 8s/epoch - 32ms/step
Epoch 7/50
260/260 - 8s - loss: 3.2723 - accuracy1000: 0.3775 - val_loss: 3.2542 - val_accuracy1000: 0.4185 - 8s/epoch - 30ms/step
Epoch 8/50
260/260 - 9s - loss: 3.2617 - accuracy1000: 0.3853 - val_loss: 3.2620 - val_accuracy1000: 0.4239 - 9s/epoch - 34ms/step
Epoch 9/50
260/260 - 8s - loss: 3.2642 - accuracy1000: 0.3847 - val_loss: 3.2843 - val_accuracy1000: 0.4123 - 8s/epoch - 30ms/step
Epoch 10/50
260/260 - 7s - loss: 3.2514 - accuracy1000: 0.3936 - val_loss: 3.2962 - val_accuracy1000: 0.4113 - 7s/epoch - 29ms/step
Epoch 11/50
260/260 - 8s - loss: 3.2369 - accuracy1000: 0.4019 - val_loss: 3.3209 - val_accuracy1000: 0.4060 - 8s/epoch - 30ms/step
Epoch 12/50
260/260 - 7s - loss: 3.2298 - accuracy1000: 0.4055 - val_loss: 3.3383 - val_accuracy1000: 0.4010 - 7s/epoch - 29ms/step
Epoch 13/50
260/260 - 7s - loss: 3.2289 - accuracy1000: 0.4069 - val_loss: 3.3134 - val_accuracy1000: 0.4031 - 7s/epoch - 28ms/step
Epoch 14/50
260/260 - 7s - loss: 3.2229 - accuracy1000: 0.4078 - val_loss: 3.2992 - val_accuracy1000: 0.4029 - 7s/epoch - 28ms/step
Epoch 15/50
260/260 - 8s - loss: 3.2122 - accuracy1000: 0.4156 - val_loss: 3.3034 - val_accuracy1000: 0.4105 - 8s/epoch - 29ms/step
Epoch 16/50
260/260 - 7s - loss: 3.2025 - accuracy1000: 0.4222 - val_loss: 3.3080 - val_accuracy1000: 0.4101 - 7s/epoch - 28ms/step
Epoch 17/50
260/260 - 8s - loss: 3.1967 - accuracy1000: 0.4251 - val_loss: 3.3331 - val_accuracy1000: 0.3990 - 8s/epoch - 29ms/step
testing model: results/LILAK/W1/deepVOL_L2/h1000
Evaluating performance on  test set...
663/663 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1046857
{'0': {'precision': 0.403313005492842, 'recall': 0.1638379366083351, 'f1-score': 0.23301722953134174, 'support': 56916}, '1': {'precision': 0.38450471647968476, 'recall': 0.8423749340123591, 'f1-score': 0.5280014792683461, 'support': 64406}, '2': {'precision': 0.3737650933040615, 'recall': 0.042240416821734274, 'f1-score': 0.07590280873829691, 'support': 48366}, 'accuracy': 0.3867215124227995, 'macro avg': {'precision': 0.38719427175886273, 'recall': 0.3494844291474761, 'f1-score': 0.2789738391793282, 'support': 169688}, 'weighted avg': {'precision': 0.3877522057715655, 'recall': 0.3867215124227995, 'f1-score': 0.3001979347814778, 'support': 169688}}
[[ 9325 46081  1510]
 [ 8239 54254  1913]
 [ 5557 40766  2043]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1180673
{'0': {'precision': 0.41478239727692684, 'recall': 0.15992500585891728, 'f1-score': 0.2308446940225297, 'support': 21335}, '1': {'precision': 0.34438292292000583, 'recall': 0.8534031413612565, 'f1-score': 0.4907344926031663, 'support': 22156}, '2': {'precision': 0.40819333922782197, 'recall': 0.06013372698853769, 'f1-score': 0.10482497634815516, 'support': 23032}, 'accuracy': 0.35634291899042436, 'macro avg': {'precision': 0.3891195531415848, 'recall': 0.35782062473623716, 'f1-score': 0.275468054324617, 'support': 66523}, 'weighted avg': {'precision': 0.3890540035057661, 'recall': 0.35634291899042436, 'f1-score': 0.27377168528685014, 'support': 66523}}
[[ 3412 16834  1089]
 [ 2329 18908   919]
 [ 2485 19162  1385]]
Evaluating performance on  val set...
51/51 - 1s - 916ms/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0818993
{'0': {'precision': 0.4302285909245991, 'recall': 0.2973355340721528, 'f1-score': 0.3516452872281092, 'support': 4241}, '1': {'precision': 0.425531914893617, 'recall': 0.7365223993925588, 'f1-score': 0.5394133185041011, 'support': 5268}, '2': {'precision': 0.2656641604010025, 'recall': 0.06351108448172559, 'f1-score': 0.1025145067698259, 'support': 3338}, 'accuracy': 0.41667315326535376, 'macro avg': {'precision': 0.3738082220730729, 'recall': 0.36578967264881235, 'f1-score': 0.33119103750067874, 'support': 12847}, 'weighted avg': {'precision': 0.38554437216387843, 'recall': 0.41667315326535376, 'f1-score': 0.36390989714421224, 'support': 12847}}
[[1261 2732  248]
 [1050 3880  338]
 [ 620 2506  212]]
training model: results/LILAK/W1/deepVOL_L3/h10
Epoch 1/50
260/260 - 13s - loss: 3.3510 - accuracy10: 0.3508 - val_loss: 3.4583 - val_accuracy10: 0.4954 - 13s/epoch - 50ms/step
Epoch 2/50
260/260 - 11s - loss: 3.3169 - accuracy10: 0.3526 - val_loss: 3.3579 - val_accuracy10: 0.4867 - 11s/epoch - 42ms/step
Epoch 3/50
260/260 - 11s - loss: 3.2945 - accuracy10: 0.3548 - val_loss: 3.3093 - val_accuracy10: 0.4460 - 11s/epoch - 43ms/step
Epoch 4/50
260/260 - 10s - loss: 3.2977 - accuracy10: 0.3520 - val_loss: 3.3105 - val_accuracy10: 0.4687 - 10s/epoch - 40ms/step
Epoch 5/50
260/260 - 10s - loss: 3.2822 - accuracy10: 0.3429 - val_loss: 3.3103 - val_accuracy10: 0.4561 - 10s/epoch - 39ms/step
Epoch 6/50
260/260 - 11s - loss: 3.2703 - accuracy10: 0.3456 - val_loss: 3.3117 - val_accuracy10: 0.4496 - 11s/epoch - 41ms/step
Epoch 7/50
260/260 - 10s - loss: 3.2631 - accuracy10: 0.3505 - val_loss: 3.3589 - val_accuracy10: 0.4543 - 10s/epoch - 39ms/step
Epoch 8/50
260/260 - 10s - loss: 3.2610 - accuracy10: 0.3548 - val_loss: 3.3155 - val_accuracy10: 0.4390 - 10s/epoch - 40ms/step
Epoch 9/50
260/260 - 10s - loss: 3.2511 - accuracy10: 0.3596 - val_loss: 3.3336 - val_accuracy10: 0.4312 - 10s/epoch - 40ms/step
Epoch 10/50
260/260 - 10s - loss: 3.2407 - accuracy10: 0.3722 - val_loss: 3.3363 - val_accuracy10: 0.4493 - 10s/epoch - 39ms/step
Epoch 11/50
260/260 - 10s - loss: 3.2316 - accuracy10: 0.3738 - val_loss: 3.3536 - val_accuracy10: 0.4774 - 10s/epoch - 39ms/step
Epoch 12/50
260/260 - 10s - loss: 3.2264 - accuracy10: 0.3759 - val_loss: 3.3581 - val_accuracy10: 0.4619 - 10s/epoch - 40ms/step
Epoch 13/50
260/260 - 10s - loss: 3.2133 - accuracy10: 0.3851 - val_loss: 3.3447 - val_accuracy10: 0.4665 - 10s/epoch - 40ms/step
testing model: results/LILAK/W1/deepVOL_L3/h10
Evaluating performance on  test set...
663/663 - 14s - 14s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0959067
{'0': {'precision': 0.3435041462896024, 'recall': 0.06243116341081677, 'f1-score': 0.10565901993165357, 'support': 51753}, '1': {'precision': 0.3882552330157914, 'recall': 0.7266317909864406, 'f1-score': 0.5060936027641085, 'support': 66522}, '2': {'precision': 0.31106080930024593, 'recall': 0.2165016630035205, 'f1-score': 0.2553069486335539, 'support': 51413}, 'accuracy': 0.36949578049125453, 'macro avg': {'precision': 0.34760672953521327, 'recall': 0.3351882058002593, 'f1-score': 0.289019857109772, 'support': 169688}, 'weighted avg': {'precision': 0.3512178473560642, 'recall': 0.36949578049125453, 'f1-score': 0.3079806824978419, 'support': 169688}}
[[ 3231 38557  9965]
 [ 3497 48337 14688]
 [ 2678 37604 11131]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0639013
{'0': {'precision': 0.2836812144212524, 'recall': 0.13082885360670085, 'f1-score': 0.17907255304585903, 'support': 15998}, '1': {'precision': 0.5090286620879695, 'recall': 0.72225348775214, 'f1-score': 0.59717868338558, 'support': 33761}, '2': {'precision': 0.2852695249955524, 'recall': 0.19130279169649247, 'f1-score': 0.22902235235306717, 'support': 16764}, 'accuracy': 0.44622160756430107, 'macro avg': {'precision': 0.3593264671682581, 'recall': 0.3481283776851111, 'f1-score': 0.335091196261502, 'support': 66523}, 'weighted avg': {'precision': 0.3984472595356279, 'recall': 0.44622160756430107, 'f1-score': 0.40385254646145, 'support': 66523}}
[[ 2093 11565  2340]
 [ 3682 24384  5695]
 [ 1603 11954  3207]]
Evaluating performance on  val set...
51/51 - 1s - 1s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0664856
{'0': {'precision': 0.24585477415666096, 'recall': 0.13573232323232323, 'f1-score': 0.17490339637990643, 'support': 3168}, '1': {'precision': 0.5086759911662635, 'recall': 0.738135205249504, 'f1-score': 0.6022911219026272, 'support': 6553}, '2': {'precision': 0.302076777847703, 'recall': 0.15355086372360843, 'f1-score': 0.2036055143160127, 'support': 3126}, 'accuracy': 0.4473417918580213, 'macro avg': {'precision': 0.35220251439020916, 'recall': 0.34247279740181186, 'f1-score': 0.3269333441995155, 'support': 12847}, 'weighted avg': {'precision': 0.3935949017041135, 'recall': 0.4473417918580213, 'f1-score': 0.3998893531027723, 'support': 12847}}
[[ 430 2406  332]
 [ 939 4837  777]
 [ 380 2266  480]]
training model: results/LILAK/W1/deepVOL_L3/h20
Epoch 1/50
260/260 - 13s - loss: 3.3497 - accuracy20: 0.3434 - val_loss: 3.3999 - val_accuracy20: 0.3820 - 13s/epoch - 50ms/step
Epoch 2/50
260/260 - 11s - loss: 3.3090 - accuracy20: 0.3557 - val_loss: 3.4308 - val_accuracy20: 0.3967 - 11s/epoch - 41ms/step
Epoch 3/50
260/260 - 11s - loss: 3.2936 - accuracy20: 0.3617 - val_loss: 3.3805 - val_accuracy20: 0.3977 - 11s/epoch - 42ms/step
Epoch 4/50
260/260 - 11s - loss: 3.2863 - accuracy20: 0.3625 - val_loss: 3.3158 - val_accuracy20: 0.3915 - 11s/epoch - 42ms/step
Epoch 5/50
260/260 - 11s - loss: 3.2746 - accuracy20: 0.3654 - val_loss: 3.2999 - val_accuracy20: 0.3856 - 11s/epoch - 41ms/step
Epoch 6/50
260/260 - 10s - loss: 3.2621 - accuracy20: 0.3747 - val_loss: 3.3145 - val_accuracy20: 0.3827 - 10s/epoch - 40ms/step
Epoch 7/50
260/260 - 11s - loss: 3.2497 - accuracy20: 0.3823 - val_loss: 3.3335 - val_accuracy20: 0.3769 - 11s/epoch - 42ms/step
Epoch 8/50
260/260 - 11s - loss: 3.2462 - accuracy20: 0.3826 - val_loss: 3.3092 - val_accuracy20: 0.3746 - 11s/epoch - 41ms/step
Epoch 9/50
260/260 - 11s - loss: 3.2405 - accuracy20: 0.3893 - val_loss: 3.2990 - val_accuracy20: 0.3904 - 11s/epoch - 42ms/step
Epoch 10/50
260/260 - 10s - loss: 3.2248 - accuracy20: 0.3962 - val_loss: 3.3097 - val_accuracy20: 0.3921 - 10s/epoch - 40ms/step
Epoch 11/50
260/260 - 11s - loss: 3.2159 - accuracy20: 0.4048 - val_loss: 3.3133 - val_accuracy20: 0.3958 - 11s/epoch - 41ms/step
Epoch 12/50
260/260 - 11s - loss: 3.2052 - accuracy20: 0.4096 - val_loss: 3.3130 - val_accuracy20: 0.3925 - 11s/epoch - 41ms/step
Epoch 13/50
260/260 - 11s - loss: 3.1994 - accuracy20: 0.4126 - val_loss: 3.3144 - val_accuracy20: 0.3925 - 11s/epoch - 41ms/step
Epoch 14/50
260/260 - 11s - loss: 3.1931 - accuracy20: 0.4166 - val_loss: 3.2974 - val_accuracy20: 0.3966 - 11s/epoch - 42ms/step
Epoch 15/50
260/260 - 11s - loss: 3.1861 - accuracy20: 0.4219 - val_loss: 3.3000 - val_accuracy20: 0.4029 - 11s/epoch - 42ms/step
Epoch 16/50
260/260 - 11s - loss: 3.1780 - accuracy20: 0.4243 - val_loss: 3.2936 - val_accuracy20: 0.3932 - 11s/epoch - 41ms/step
Epoch 17/50
260/260 - 10s - loss: 3.1706 - accuracy20: 0.4278 - val_loss: 3.2985 - val_accuracy20: 0.3945 - 10s/epoch - 40ms/step
Epoch 18/50
260/260 - 10s - loss: 3.1654 - accuracy20: 0.4309 - val_loss: 3.3168 - val_accuracy20: 0.3925 - 10s/epoch - 40ms/step
Epoch 19/50
260/260 - 10s - loss: 3.1568 - accuracy20: 0.4354 - val_loss: 3.3188 - val_accuracy20: 0.4034 - 10s/epoch - 40ms/step
Epoch 20/50
260/260 - 11s - loss: 3.1521 - accuracy20: 0.4357 - val_loss: 3.3079 - val_accuracy20: 0.4035 - 11s/epoch - 43ms/step
Epoch 21/50
260/260 - 10s - loss: 3.1473 - accuracy20: 0.4394 - val_loss: 3.2943 - val_accuracy20: 0.4067 - 10s/epoch - 40ms/step
Epoch 22/50
260/260 - 11s - loss: 3.1350 - accuracy20: 0.4447 - val_loss: 3.3029 - val_accuracy20: 0.4041 - 11s/epoch - 41ms/step
Epoch 23/50
260/260 - 10s - loss: 3.1279 - accuracy20: 0.4464 - val_loss: 3.2887 - val_accuracy20: 0.4091 - 10s/epoch - 40ms/step
Epoch 24/50
260/260 - 11s - loss: 3.1215 - accuracy20: 0.4497 - val_loss: 3.2973 - val_accuracy20: 0.4033 - 11s/epoch - 41ms/step
Epoch 25/50
260/260 - 11s - loss: 3.1129 - accuracy20: 0.4540 - val_loss: 3.2871 - val_accuracy20: 0.4000 - 11s/epoch - 44ms/step
Epoch 26/50
260/260 - 11s - loss: 3.1091 - accuracy20: 0.4550 - val_loss: 3.2852 - val_accuracy20: 0.4083 - 11s/epoch - 41ms/step
Epoch 27/50
260/260 - 10s - loss: 3.0943 - accuracy20: 0.4615 - val_loss: 3.3205 - val_accuracy20: 0.4031 - 10s/epoch - 40ms/step
Epoch 28/50
260/260 - 10s - loss: 3.0953 - accuracy20: 0.4601 - val_loss: 3.3118 - val_accuracy20: 0.4041 - 10s/epoch - 40ms/step
Epoch 29/50
260/260 - 10s - loss: 3.0885 - accuracy20: 0.4626 - val_loss: 3.3161 - val_accuracy20: 0.4035 - 10s/epoch - 40ms/step
Epoch 30/50
260/260 - 11s - loss: 3.0739 - accuracy20: 0.4687 - val_loss: 3.3339 - val_accuracy20: 0.3939 - 11s/epoch - 42ms/step
Epoch 31/50
260/260 - 10s - loss: 3.0692 - accuracy20: 0.4701 - val_loss: 3.3354 - val_accuracy20: 0.3959 - 10s/epoch - 40ms/step
Epoch 32/50
260/260 - 10s - loss: 3.0631 - accuracy20: 0.4731 - val_loss: 3.3501 - val_accuracy20: 0.4011 - 10s/epoch - 40ms/step
Epoch 33/50
260/260 - 10s - loss: 3.0594 - accuracy20: 0.4742 - val_loss: 3.3380 - val_accuracy20: 0.3964 - 10s/epoch - 40ms/step
Epoch 34/50
260/260 - 10s - loss: 3.0486 - accuracy20: 0.4782 - val_loss: 3.3674 - val_accuracy20: 0.3911 - 10s/epoch - 39ms/step
Epoch 35/50
260/260 - 11s - loss: 3.0346 - accuracy20: 0.4817 - val_loss: 3.3667 - val_accuracy20: 0.3906 - 11s/epoch - 42ms/step
Epoch 36/50
260/260 - 10s - loss: 3.0298 - accuracy20: 0.4820 - val_loss: 3.3811 - val_accuracy20: 0.3944 - 10s/epoch - 40ms/step
testing model: results/LILAK/W1/deepVOL_L3/h20
Evaluating performance on  test set...
663/663 - 14s - 14s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.106575
{'0': {'precision': 0.44214477491332793, 'recall': 0.28111171878884306, 'f1-score': 0.3437012421227533, 'support': 60339}, '1': {'precision': 0.31344355850568667, 'recall': 0.6270647773279352, 'f1-score': 0.4179642172868824, 'support': 49400}, '2': {'precision': 0.43650183093824046, 'recall': 0.2366177917896879, 'f1-score': 0.30688185535339546, 'support': 59949}, 'accuracy': 0.3661072085238791, 'macro avg': {'precision': 0.397363388119085, 'recall': 0.38159809596882205, 'f1-score': 0.3561824382543437, 'support': 169688}, 'weighted avg': {'precision': 0.40268335784847953, 'recall': 0.3661072085238791, 'f1-score': 0.35231296219530844, 'support': 169688}}
[[16962 33995  9382]
 [ 9493 30977  8930]
 [11908 33856 14185]]
Evaluating performance on  train set...
260/260 - 6s - 6s/epoch - 24ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0514873
{'0': {'precision': 0.4379510400452809, 'recall': 0.3163166232306199, 'f1-score': 0.3673263507699611, 'support': 19569}, '1': {'precision': 0.4457741404158946, 'recall': 0.6593954621592812, 'f1-score': 0.5319390700816904, 'support': 26268}, '2': {'precision': 0.4333850587452893, 'recall': 0.2835250894324664, 'f1-score': 0.342792016131389, 'support': 20686}, 'accuracy': 0.44159162996256934, 'macro avg': {'precision': 0.43903674640215495, 'recall': 0.41974572494078916, 'f1-score': 0.41401914566101344, 'support': 66523}, 'weighted avg': {'precision': 0.4396203170075895, 'recall': 0.44159162996256934, 'f1-score': 0.4246979314946278, 'support': 66523}}
[[ 6190 10273  3106]
 [ 4385 17321  4562]
 [ 3559 11262  5865]]
Evaluating performance on  val set...
51/51 - 1s - 1s/epoch - 26ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0810126
{'0': {'precision': 0.36655535576676085, 'recall': 0.3645886561062851, 'f1-score': 0.3655693608300244, 'support': 3914}, '1': {'precision': 0.4369906868451688, 'recall': 0.5817512592018598, 'f1-score': 0.4990859232175503, 'support': 5162}, '2': {'precision': 0.39481268011527376, 'recall': 0.21797931583134447, 'f1-score': 0.2808815991799077, 'support': 3771}, 'accuracy': 0.40881139565657354, 'macro avg': {'precision': 0.3994529075757345, 'recall': 0.3881064103798298, 'f1-score': 0.38184562774249414, 'support': 12847}, 'weighted avg': {'precision': 0.4031511017887881, 'recall': 0.40881139565657354, 'f1-score': 0.3943585681050161, 'support': 12847}}
[[1427 1954  533]
 [1432 3003  727]
 [1034 1915  822]]
training model: results/LILAK/W1/deepVOL_L3/h30
Epoch 1/50
260/260 - 13s - loss: 3.3494 - accuracy30: 0.3420 - val_loss: 3.3757 - val_accuracy30: 0.3373 - 13s/epoch - 51ms/step
Epoch 2/50
260/260 - 11s - loss: 3.3121 - accuracy30: 0.3487 - val_loss: 3.3723 - val_accuracy30: 0.3373 - 11s/epoch - 42ms/step
Epoch 3/50
260/260 - 11s - loss: 3.2975 - accuracy30: 0.3553 - val_loss: 3.3410 - val_accuracy30: 0.3367 - 11s/epoch - 42ms/step
Epoch 4/50
260/260 - 10s - loss: 3.2911 - accuracy30: 0.3620 - val_loss: 3.3406 - val_accuracy30: 0.3334 - 10s/epoch - 40ms/step
Epoch 5/50
260/260 - 11s - loss: 3.2844 - accuracy30: 0.3648 - val_loss: 3.3323 - val_accuracy30: 0.3334 - 11s/epoch - 41ms/step
Epoch 6/50
260/260 - 10s - loss: 3.2746 - accuracy30: 0.3759 - val_loss: 3.3374 - val_accuracy30: 0.3388 - 10s/epoch - 40ms/step
Epoch 7/50
260/260 - 11s - loss: 3.2682 - accuracy30: 0.3820 - val_loss: 3.3146 - val_accuracy30: 0.3384 - 11s/epoch - 43ms/step
Epoch 8/50
260/260 - 10s - loss: 3.2604 - accuracy30: 0.3885 - val_loss: 3.3166 - val_accuracy30: 0.3458 - 10s/epoch - 40ms/step
Epoch 9/50
260/260 - 11s - loss: 3.2510 - accuracy30: 0.3947 - val_loss: 3.3299 - val_accuracy30: 0.3424 - 11s/epoch - 41ms/step
Epoch 10/50
260/260 - 11s - loss: 3.2473 - accuracy30: 0.3972 - val_loss: 3.3226 - val_accuracy30: 0.3472 - 11s/epoch - 42ms/step
Epoch 11/50
260/260 - 11s - loss: 3.2334 - accuracy30: 0.4075 - val_loss: 3.3588 - val_accuracy30: 0.3497 - 11s/epoch - 42ms/step
Epoch 12/50
260/260 - 11s - loss: 3.2239 - accuracy30: 0.4123 - val_loss: 3.3531 - val_accuracy30: 0.3483 - 11s/epoch - 42ms/step
Epoch 13/50
260/260 - 11s - loss: 3.2124 - accuracy30: 0.4185 - val_loss: 3.3629 - val_accuracy30: 0.3588 - 11s/epoch - 44ms/step
Epoch 14/50
260/260 - 11s - loss: 3.2019 - accuracy30: 0.4277 - val_loss: 3.3637 - val_accuracy30: 0.3517 - 11s/epoch - 41ms/step
Epoch 15/50
260/260 - 11s - loss: 3.1945 - accuracy30: 0.4295 - val_loss: 3.4104 - val_accuracy30: 0.3536 - 11s/epoch - 42ms/step
Epoch 16/50
260/260 - 11s - loss: 3.1815 - accuracy30: 0.4340 - val_loss: 3.3825 - val_accuracy30: 0.3463 - 11s/epoch - 41ms/step
Epoch 17/50
260/260 - 11s - loss: 3.1718 - accuracy30: 0.4391 - val_loss: 3.4136 - val_accuracy30: 0.3453 - 11s/epoch - 41ms/step
testing model: results/LILAK/W1/deepVOL_L3/h30
Evaluating performance on  test set...
663/663 - 14s - 14s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1246883
{'0': {'precision': 0.4231155298503896, 'recall': 0.13584813001642088, 'f1-score': 0.20566436653423484, 'support': 65161}, '1': {'precision': 0.23764469423456286, 'recall': 0.8039892210441484, 'f1-score': 0.36685397777547946, 'support': 39707}, '2': {'precision': 0.4174057649667406, 'recall': 0.09293427954335082, 'f1-score': 0.15202140009084944, 'support': 64820}, 'accuracy': 0.2758002923011645, 'macro avg': {'precision': 0.359388663017231, 'recall': 0.3442572102013067, 'f1-score': 0.24151324813352124, 'support': 169688}, 'weighted avg': {'precision': 0.37753424284390846, 'recall': 0.2758002923011645, 'f1-score': 0.22289138794232413, 'support': 169688}}
[[ 8852 51241  5068]
 [ 4443 31924  3340]
 [ 7626 51170  6024]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1034572
{'0': {'precision': 0.41082939406961755, 'recall': 0.1311865337114628, 'f1-score': 0.19886974309191138, 'support': 21862}, '1': {'precision': 0.33164450460007683, 'recall': 0.8382801664355063, 'f1-score': 0.4752630958153677, 'support': 21630}, '2': {'precision': 0.41240501129595397, 'recall': 0.08718683513525248, 'f1-score': 0.1439426523297491, 'support': 23031}, 'accuracy': 0.3458653398072847, 'macro avg': {'precision': 0.3849596366552161, 'recall': 0.35221784509407383, 'f1-score': 0.27269183041234274, 'support': 66523}, 'weighted avg': {'precision': 0.3856278679976363, 'recall': 0.3458653398072847, 'f1-score': 0.2697228674558908, 'support': 66523}}
[[ 2868 17680  1314]
 [ 1951 18132  1547]
 [ 2162 18861  2008]]
Evaluating performance on  val set...
51/51 - 1s - 1s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1056744
{'0': {'precision': 0.3776765375854214, 'recall': 0.191190036900369, 'f1-score': 0.2538661766957587, 'support': 4336}, '1': {'precision': 0.33651719284134324, 'recall': 0.7744099953725128, 'f1-score': 0.4691617605831231, 'support': 4322}, '2': {'precision': 0.3923512747875354, 'recall': 0.06612556696108857, 'f1-score': 0.11317671092951992, 'support': 4189}, 'accuracy': 0.3466178874445396, 'macro avg': {'precision': 0.3688483350714334, 'recall': 0.3439085330779901, 'f1-score': 0.27873488273613395, 'support': 12847}, 'weighted avg': {'precision': 0.36861463878848433, 'recall': 0.3466178874445396, 'f1-score': 0.28042174153318494, 'support': 12847}}
[[ 829 3297  210]
 [ 756 3347  219]
 [ 610 3302  277]]
training model: results/LILAK/W1/deepVOL_L3/h50
Epoch 1/50
260/260 - 13s - loss: 3.3497 - accuracy50: 0.3468 - val_loss: 3.3687 - val_accuracy50: 0.3732 - 13s/epoch - 50ms/step
Epoch 2/50
260/260 - 11s - loss: 3.3084 - accuracy50: 0.3554 - val_loss: 3.3681 - val_accuracy50: 0.3707 - 11s/epoch - 41ms/step
Epoch 3/50
260/260 - 11s - loss: 3.3153 - accuracy50: 0.3546 - val_loss: 3.3598 - val_accuracy50: 0.3805 - 11s/epoch - 44ms/step
Epoch 4/50
260/260 - 11s - loss: 3.2972 - accuracy50: 0.3621 - val_loss: 3.3105 - val_accuracy50: 0.3783 - 11s/epoch - 43ms/step
Epoch 5/50
260/260 - 11s - loss: 3.2830 - accuracy50: 0.3693 - val_loss: 3.2946 - val_accuracy50: 0.3740 - 11s/epoch - 41ms/step
Epoch 6/50
260/260 - 11s - loss: 3.2770 - accuracy50: 0.3763 - val_loss: 3.2825 - val_accuracy50: 0.3781 - 11s/epoch - 43ms/step
Epoch 7/50
260/260 - 11s - loss: 3.2691 - accuracy50: 0.3801 - val_loss: 3.2831 - val_accuracy50: 0.3756 - 11s/epoch - 41ms/step
Epoch 8/50
260/260 - 11s - loss: 3.2631 - accuracy50: 0.3834 - val_loss: 3.2800 - val_accuracy50: 0.3810 - 11s/epoch - 42ms/step
Epoch 9/50
260/260 - 11s - loss: 3.2576 - accuracy50: 0.3881 - val_loss: 3.2777 - val_accuracy50: 0.3731 - 11s/epoch - 41ms/step
Epoch 10/50
260/260 - 11s - loss: 3.2470 - accuracy50: 0.3939 - val_loss: 3.2820 - val_accuracy50: 0.3842 - 11s/epoch - 42ms/step
Epoch 11/50
260/260 - 11s - loss: 3.2400 - accuracy50: 0.4018 - val_loss: 3.2872 - val_accuracy50: 0.3813 - 11s/epoch - 42ms/step
Epoch 12/50
260/260 - 12s - loss: 3.2307 - accuracy50: 0.4057 - val_loss: 3.3050 - val_accuracy50: 0.3753 - 12s/epoch - 46ms/step
Epoch 13/50
260/260 - 11s - loss: 3.2261 - accuracy50: 0.4079 - val_loss: 3.2864 - val_accuracy50: 0.3836 - 11s/epoch - 42ms/step
Epoch 14/50
260/260 - 11s - loss: 3.2159 - accuracy50: 0.4144 - val_loss: 3.2945 - val_accuracy50: 0.3831 - 11s/epoch - 43ms/step
Epoch 15/50
260/260 - 11s - loss: 3.2093 - accuracy50: 0.4163 - val_loss: 3.3063 - val_accuracy50: 0.3771 - 11s/epoch - 41ms/step
Epoch 16/50
260/260 - 11s - loss: 3.2026 - accuracy50: 0.4201 - val_loss: 3.3039 - val_accuracy50: 0.3836 - 11s/epoch - 41ms/step
Epoch 17/50
260/260 - 11s - loss: 3.1936 - accuracy50: 0.4253 - val_loss: 3.3043 - val_accuracy50: 0.3821 - 11s/epoch - 40ms/step
Epoch 18/50
260/260 - 11s - loss: 3.1871 - accuracy50: 0.4296 - val_loss: 3.3315 - val_accuracy50: 0.3764 - 11s/epoch - 41ms/step
Epoch 19/50
260/260 - 11s - loss: 3.1788 - accuracy50: 0.4315 - val_loss: 3.3364 - val_accuracy50: 0.3772 - 11s/epoch - 41ms/step
testing model: results/LILAK/W1/deepVOL_L3/h50
Evaluating performance on  test set...
663/663 - 14s - 14s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1156654
{'0': {'precision': 0.39042485203812277, 'recall': 0.23156663040970368, 'f1-score': 0.290709342381578, 'support': 60678}, '1': {'precision': 0.2888868121691998, 'recall': 0.7018948932832432, 'f1-score': 0.4093094918538937, 'support': 48446}, '2': {'precision': 0.38813156578289143, 'recall': 0.10248662571824846, 'f1-score': 0.1621558075134542, 'support': 60564}, 'accuracy': 0.31977511668473907, 'macro avg': {'precision': 0.35581440999673797, 'recall': 0.34531604980373176, 'f1-score': 0.28739154724964194, 'support': 169688}, 'weighted avg': {'precision': 0.3606171905166735, 'recall': 0.31977511668473907, 'f1-score': 0.27868719912797585, 'support': 169688}}
[[14051 41326  5301]
 [ 9958 34004  4484]
 [11980 42377  6207]]
Evaluating performance on  train set...
260/260 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0983322
{'0': {'precision': 0.4216487737614498, 'recall': 0.19637614678899082, 'f1-score': 0.2679560604638062, 'support': 21800}, '1': {'precision': 0.3393258426966292, 'recall': 0.7696718700223001, 'f1-score': 0.4710010722292621, 'support': 21973}, '2': {'precision': 0.411791730474732, 'recall': 0.1181978021978022, 'f1-score': 0.18367486338797812, 'support': 22750}, 'accuracy': 0.359003652871939, 'macro avg': {'precision': 0.3909221156442704, 'recall': 0.36141527300303106, 'f1-score': 0.30754399869368215, 'support': 66523}, 'weighted avg': {'precision': 0.39108596843005866, 'recall': 0.359003652871939, 'f1-score': 0.306200138602905, 'support': 66523}}
[[ 4281 15781  1738]
 [ 2958 16912  2103]
 [ 2914 17147  2689]]
Evaluating performance on  val set...
51/51 - 1s - 1s/epoch - 24ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0920198
{'0': {'precision': 0.357008760951189, 'recall': 0.2790413303986305, 'f1-score': 0.31324639670555937, 'support': 4089}, '1': {'precision': 0.3828911253430924, 'recall': 0.687192118226601, 'f1-score': 0.49177438307873084, 'support': 4872}, '2': {'precision': 0.3627342888643881, 'recall': 0.08466289243437983, 'f1-score': 0.13728353849363653, 'support': 3886}, 'accuracy': 0.375029189694092, 'macro avg': {'precision': 0.3675447250528898, 'recall': 0.3502987803532038, 'f1-score': 0.31410143942597557, 'support': 12847}, 'weighted avg': {'precision': 0.3685560701119304, 'recall': 0.375029189694092, 'f1-score': 0.3277242267513723, 'support': 12847}}
[[1141 2701  247]
 [1193 3348  331]
 [ 862 2695  329]]
training model: results/LILAK/W1/deepVOL_L3/h100
Epoch 1/50
260/260 - 14s - loss: 3.3234 - accuracy100: 0.3664 - val_loss: 3.3026 - val_accuracy100: 0.4733 - 14s/epoch - 52ms/step
Epoch 2/50
260/260 - 11s - loss: 3.3158 - accuracy100: 0.3637 - val_loss: 3.2323 - val_accuracy100: 0.4762 - 11s/epoch - 42ms/step
Epoch 3/50
260/260 - 11s - loss: 3.2968 - accuracy100: 0.3652 - val_loss: 3.1773 - val_accuracy100: 0.4762 - 11s/epoch - 43ms/step
Epoch 4/50
260/260 - 11s - loss: 3.2876 - accuracy100: 0.3725 - val_loss: 3.1659 - val_accuracy100: 0.4767 - 11s/epoch - 43ms/step
Epoch 5/50
260/260 - 11s - loss: 3.2931 - accuracy100: 0.3631 - val_loss: 3.1740 - val_accuracy100: 0.4760 - 11s/epoch - 43ms/step
Epoch 6/50
260/260 - 11s - loss: 3.2894 - accuracy100: 0.3661 - val_loss: 3.1842 - val_accuracy100: 0.4743 - 11s/epoch - 42ms/step
Epoch 7/50
260/260 - 11s - loss: 3.2880 - accuracy100: 0.3683 - val_loss: 3.2017 - val_accuracy100: 0.4737 - 11s/epoch - 44ms/step
Epoch 8/50
260/260 - 12s - loss: 3.2863 - accuracy100: 0.3698 - val_loss: 3.2156 - val_accuracy100: 0.4727 - 12s/epoch - 44ms/step
Epoch 9/50
260/260 - 12s - loss: 3.2785 - accuracy100: 0.3786 - val_loss: 3.2080 - val_accuracy100: 0.4671 - 12s/epoch - 45ms/step
Epoch 10/50
260/260 - 11s - loss: 3.2722 - accuracy100: 0.3834 - val_loss: 3.2085 - val_accuracy100: 0.4630 - 11s/epoch - 42ms/step
Epoch 11/50
260/260 - 11s - loss: 3.2644 - accuracy100: 0.3902 - val_loss: 3.2037 - val_accuracy100: 0.4609 - 11s/epoch - 41ms/step
Epoch 12/50
260/260 - 11s - loss: 3.2605 - accuracy100: 0.3918 - val_loss: 3.2004 - val_accuracy100: 0.4563 - 11s/epoch - 41ms/step
Epoch 13/50
260/260 - 11s - loss: 3.2568 - accuracy100: 0.3958 - val_loss: 3.2005 - val_accuracy100: 0.4507 - 11s/epoch - 41ms/step
Epoch 14/50
260/260 - 11s - loss: 3.2523 - accuracy100: 0.3991 - val_loss: 3.1947 - val_accuracy100: 0.4506 - 11s/epoch - 42ms/step
testing model: results/LILAK/W1/deepVOL_L3/h100
Evaluating performance on  test set...
663/663 - 15s - 15s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1239709
{'0': {'precision': 0.1724137931034483, 'recall': 0.0001789773235731033, 'f1-score': 0.000357583451037886, 'support': 55873}, '1': {'precision': 0.3529063957854157, 'recall': 0.9957956555106944, 'f1-score': 0.5211271909719949, 'support': 59938}, '2': {'precision': 0.30218687872763417, 'recall': 0.002821240974813, 'f1-score': 0.005590290547995586, 'support': 53877}, 'accuracy': 0.3526943567017114, 'macro avg': {'precision': 0.2758356892054994, 'recall': 0.33293195793636016, 'f1-score': 0.1756916883236761, 'support': 169688}, 'weighted avg': {'precision': 0.2773720114437318, 'recall': 0.3526943567017114, 'f1-score': 0.18596771083691024, 'support': 169688}}
[[   10 55747   116]
 [   17 59686   235]
 [   31 53694   152]]
Evaluating performance on  train set...
260/260 - 6s - 6s/epoch - 24ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1334485
{'0': {'precision': 0.3333333333333333, 'recall': 0.00022827923115554947, 'f1-score': 0.00045624600784743136, 'support': 21903}, '1': {'precision': 0.3287428146755039, 'recall': 0.9914463452566097, 'f1-score': 0.49376388177003244, 'support': 21862}, '2': {'precision': 0.4330434782608696, 'recall': 0.010941207487476932, 'f1-score': 0.021343162045172073, 'support': 22758}, 'accuracy': 0.32964538580641284, 'macro avg': {'precision': 0.3650398754232356, 'recall': 0.3342052773250807, 'f1-score': 0.17185442994101732, 'support': 66523}, 'weighted avg': {'precision': 0.3659362760653719, 'recall': 0.32964538580641284, 'f1-score': 0.16972155226598856, 'support': 66523}}
[[    5 21754   144]
 [    5 21675   182]
 [    5 22504   249]]
Evaluating performance on  val set...
51/51 - 1s - 1s/epoch - 25ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0551448
{'0': {'precision': 0.1111111111111111, 'recall': 0.0002901073397156948, 'f1-score': 0.0005787037037037037, 'support': 3447}, '1': {'precision': 0.47643979057591623, 'recall': 0.9959163672002613, 'f1-score': 0.6445372376975528, 'support': 6122}, '2': {'precision': 0.2926829268292683, 'recall': 0.0036607687614399025, 'f1-score': 0.007231093702922567, 'support': 3278}, 'accuracy': 0.47559741573908304, 'macro avg': {'precision': 0.29341127617209856, 'recall': 0.33328908110047234, 'f1-score': 0.217449011701393, 'support': 12847}, 'weighted avg': {'precision': 0.3315310214098311, 'recall': 0.47559741573908304, 'f1-score': 0.30914262364826534, 'support': 12847}}
[[   1 3436   10]
 [   6 6097   19]
 [   2 3264   12]]
training model: results/LILAK/W1/deepVOL_L3/h200
Epoch 1/50
260/260 - 13s - loss: 3.3487 - accuracy200: 0.3495 - val_loss: 3.3750 - val_accuracy200: 0.3919 - 13s/epoch - 50ms/step
Epoch 2/50
260/260 - 11s - loss: 3.3190 - accuracy200: 0.3554 - val_loss: 3.3377 - val_accuracy200: 0.3936 - 11s/epoch - 42ms/step
Epoch 3/50
260/260 - 11s - loss: 3.3070 - accuracy200: 0.3541 - val_loss: 3.3398 - val_accuracy200: 0.3957 - 11s/epoch - 43ms/step
Epoch 4/50
260/260 - 11s - loss: 3.2987 - accuracy200: 0.3614 - val_loss: 3.3412 - val_accuracy200: 0.3940 - 11s/epoch - 44ms/step
Epoch 5/50
260/260 - 11s - loss: 3.2949 - accuracy200: 0.3628 - val_loss: 3.3004 - val_accuracy200: 0.3929 - 11s/epoch - 44ms/step
Epoch 6/50
260/260 - 11s - loss: 3.2842 - accuracy200: 0.3678 - val_loss: 3.3112 - val_accuracy200: 0.3953 - 11s/epoch - 43ms/step
Epoch 7/50
260/260 - 11s - loss: 3.2777 - accuracy200: 0.3740 - val_loss: 3.3034 - val_accuracy200: 0.3965 - 11s/epoch - 43ms/step
Epoch 8/50
260/260 - 11s - loss: 3.2727 - accuracy200: 0.3766 - val_loss: 3.3254 - val_accuracy200: 0.3966 - 11s/epoch - 44ms/step
Epoch 9/50
260/260 - 11s - loss: 3.2626 - accuracy200: 0.3892 - val_loss: 3.3459 - val_accuracy200: 0.3987 - 11s/epoch - 42ms/step
Epoch 10/50
260/260 - 11s - loss: 3.2663 - accuracy200: 0.3851 - val_loss: 3.2853 - val_accuracy200: 0.3983 - 11s/epoch - 44ms/step
Epoch 11/50
260/260 - 12s - loss: 3.2602 - accuracy200: 0.3875 - val_loss: 3.2794 - val_accuracy200: 0.4011 - 12s/epoch - 45ms/step
Epoch 12/50
260/260 - 12s - loss: 3.2539 - accuracy200: 0.3929 - val_loss: 3.2700 - val_accuracy200: 0.4043 - 12s/epoch - 45ms/step
Epoch 13/50
260/260 - 12s - loss: 3.2455 - accuracy200: 0.3976 - val_loss: 3.2903 - val_accuracy200: 0.4065 - 12s/epoch - 46ms/step
Epoch 14/50
260/260 - 11s - loss: 3.2338 - accuracy200: 0.4063 - val_loss: 3.2947 - val_accuracy200: 0.4012 - 11s/epoch - 44ms/step
Epoch 15/50
260/260 - 11s - loss: 3.2215 - accuracy200: 0.4131 - val_loss: 3.3325 - val_accuracy200: 0.3998 - 11s/epoch - 44ms/step
Epoch 16/50
260/260 - 12s - loss: 3.2150 - accuracy200: 0.4147 - val_loss: 3.3220 - val_accuracy200: 0.4006 - 12s/epoch - 45ms/step
Epoch 17/50
260/260 - 11s - loss: 3.2044 - accuracy200: 0.4189 - val_loss: 3.3272 - val_accuracy200: 0.3964 - 11s/epoch - 44ms/step
Epoch 18/50
260/260 - 11s - loss: 3.1922 - accuracy200: 0.4264 - val_loss: 3.3584 - val_accuracy200: 0.3961 - 11s/epoch - 43ms/step
Epoch 19/50
260/260 - 11s - loss: 3.1809 - accuracy200: 0.4289 - val_loss: 3.4051 - val_accuracy200: 0.3976 - 11s/epoch - 43ms/step
Epoch 20/50
260/260 - 11s - loss: 3.1848 - accuracy200: 0.4300 - val_loss: 3.3811 - val_accuracy200: 0.3911 - 11s/epoch - 43ms/step
Epoch 21/50
260/260 - 11s - loss: 3.1849 - accuracy200: 0.4323 - val_loss: 3.3456 - val_accuracy200: 0.3892 - 11s/epoch - 44ms/step
Epoch 22/50
260/260 - 11s - loss: 3.1794 - accuracy200: 0.4320 - val_loss: 3.3420 - val_accuracy200: 0.3841 - 11s/epoch - 44ms/step
testing model: results/LILAK/W1/deepVOL_L3/h200
Evaluating performance on  test set...
663/663 - 14s - 14s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1383399
{'0': {'precision': 0.40644885922706814, 'recall': 0.16945176893087663, 'f1-score': 0.23918528582356233, 'support': 61817}, '1': {'precision': 0.30904118518098667, 'recall': 0.8349252531439618, 'f1-score': 0.4511081464014975, 'support': 52243}, '2': {'precision': 0.30544536602957084, 'recall': 0.015226145106780758, 'f1-score': 0.0290063526309481, 'support': 55628}, 'accuracy': 0.3237765781905615, 'macro avg': {'precision': 0.34031180347920853, 'recall': 0.3398677223938731, 'f1-score': 0.23976659495200262, 'support': 169688}, 'weighted avg': {'precision': 0.34334780650218594, 'recall': 0.3237765781905615, 'f1-score': 0.2355294722688874, 'support': 169688}}
[[10475 50352   990]
 [ 7688 43619   936]
 [ 7609 47172   847]]
Evaluating performance on  train set...
260/260 - 6s - 6s/epoch - 23ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.108117
{'0': {'precision': 0.4394452331549634, 'recall': 0.18458715596330275, 'f1-score': 0.25997351164518523, 'support': 21800}, '1': {'precision': 0.34163823764244755, 'recall': 0.8557727272727272, 'f1-score': 0.48832805934533385, 'support': 22000}, '2': {'precision': 0.4561558901682905, 'recall': 0.045328521762091276, 'f1-score': 0.08246267163043915, 'support': 22723}, 'accuracy': 0.3589886204771282, 'macro avg': {'precision': 0.41241312032190053, 'recall': 0.36189613499937373, 'f1-score': 0.27692141420698607, 'support': 66523}, 'weighted avg': {'precision': 0.41280726370136817, 'recall': 0.3589886204771282, 'f1-score': 0.2748589081508779, 'support': 66523}}
[[ 4024 17220   556]
 [ 2501 18827   672]
 [ 2632 19061  1030]]
Evaluating performance on  val set...
51/51 - 1s - 1s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0910199
{'0': {'precision': 0.3974358974358974, 'recall': 0.26515151515151514, 'f1-score': 0.31808853708589857, 'support': 4092}, '1': {'precision': 0.4073475979006863, 'recall': 0.7958982449221061, 'f1-score': 0.5388877762200415, 'support': 5071}, '2': {'precision': 0.3349282296650718, 'recall': 0.019001085776330078, 'f1-score': 0.03596198304649371, 'support': 3684}, 'accuracy': 0.4040632054176072, 'macro avg': {'precision': 0.37990390833388515, 'recall': 0.36001694861665046, 'f1-score': 0.29764609878414455, 'support': 12847}, 'weighted avg': {'precision': 0.38342359767636, 'recall': 0.4040632054176072, 'f1-score': 0.3243404804631907, 'support': 12847}}
[[1085 2951   56]
 [ 952 4036   83]
 [ 693 2921   70]]
training model: results/LILAK/W1/deepVOL_L3/h300
Epoch 1/50
260/260 - 13s - loss: 3.3358 - accuracy300: 0.3586 - val_loss: 3.3959 - val_accuracy300: 0.4294 - 13s/epoch - 48ms/step
Epoch 2/50
260/260 - 11s - loss: 3.3008 - accuracy300: 0.3691 - val_loss: 3.3666 - val_accuracy300: 0.4337 - 11s/epoch - 42ms/step
Epoch 3/50
260/260 - 11s - loss: 3.2885 - accuracy300: 0.3687 - val_loss: 3.3294 - val_accuracy300: 0.4322 - 11s/epoch - 42ms/step
Epoch 4/50
260/260 - 11s - loss: 3.2906 - accuracy300: 0.3641 - val_loss: 3.2859 - val_accuracy300: 0.4287 - 11s/epoch - 42ms/step
Epoch 5/50
260/260 - 11s - loss: 3.2884 - accuracy300: 0.3661 - val_loss: 3.2697 - val_accuracy300: 0.4332 - 11s/epoch - 42ms/step
Epoch 6/50
260/260 - 11s - loss: 3.2778 - accuracy300: 0.3749 - val_loss: 3.2555 - val_accuracy300: 0.4324 - 11s/epoch - 42ms/step
Epoch 7/50
260/260 - 11s - loss: 3.2738 - accuracy300: 0.3793 - val_loss: 3.2771 - val_accuracy300: 0.4329 - 11s/epoch - 42ms/step
Epoch 8/50
260/260 - 11s - loss: 3.2767 - accuracy300: 0.3785 - val_loss: 3.2541 - val_accuracy300: 0.4276 - 11s/epoch - 41ms/step
Epoch 9/50
260/260 - 11s - loss: 3.2749 - accuracy300: 0.3785 - val_loss: 3.2524 - val_accuracy300: 0.4322 - 11s/epoch - 42ms/step
Epoch 10/50
260/260 - 11s - loss: 3.2664 - accuracy300: 0.3800 - val_loss: 3.2670 - val_accuracy300: 0.4323 - 11s/epoch - 41ms/step
Epoch 11/50
260/260 - 11s - loss: 3.2642 - accuracy300: 0.3807 - val_loss: 3.2608 - val_accuracy300: 0.4298 - 11s/epoch - 41ms/step
Epoch 12/50
260/260 - 10s - loss: 3.2594 - accuracy300: 0.3836 - val_loss: 3.2963 - val_accuracy300: 0.4286 - 10s/epoch - 39ms/step
Epoch 13/50
260/260 - 10s - loss: 3.2497 - accuracy300: 0.3909 - val_loss: 3.2976 - val_accuracy300: 0.4283 - 10s/epoch - 39ms/step
Epoch 14/50
260/260 - 11s - loss: 3.2373 - accuracy300: 0.3997 - val_loss: 3.2847 - val_accuracy300: 0.4298 - 11s/epoch - 42ms/step
Epoch 15/50
260/260 - 11s - loss: 3.2367 - accuracy300: 0.4018 - val_loss: 3.2844 - val_accuracy300: 0.4292 - 11s/epoch - 41ms/step
Epoch 16/50
260/260 - 11s - loss: 3.2371 - accuracy300: 0.4019 - val_loss: 3.3001 - val_accuracy300: 0.4271 - 11s/epoch - 41ms/step
Epoch 17/50
260/260 - 10s - loss: 3.2253 - accuracy300: 0.4071 - val_loss: 3.3255 - val_accuracy300: 0.4224 - 10s/epoch - 40ms/step
Epoch 18/50
260/260 - 10s - loss: 3.2172 - accuracy300: 0.4112 - val_loss: 3.3414 - val_accuracy300: 0.4177 - 10s/epoch - 40ms/step
Epoch 19/50
260/260 - 10s - loss: 3.2048 - accuracy300: 0.4188 - val_loss: 3.3559 - val_accuracy300: 0.4168 - 10s/epoch - 40ms/step
testing model: results/LILAK/W1/deepVOL_L3/h300
Evaluating performance on  test set...
663/663 - 14s - 14s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1194055
{'0': {'precision': 0.4524838012958963, 'recall': 0.007175886281897585, 'f1-score': 0.014127722705509474, 'support': 58390}, '1': {'precision': 0.3497558625693606, 'recall': 0.9908678876514296, 'f1-score': 0.5170158333846167, 'support': 59351}, '2': {'precision': 0.3392568659127625, 'recall': 0.004042581862282711, 'f1-score': 0.007989955484533727, 'support': 51947}, 'accuracy': 0.3502781575597567, 'macro avg': {'precision': 0.38049884325933975, 'recall': 0.3340287852652033, 'f1-score': 0.1797111705248866, 'support': 169688}, 'weighted avg': {'precision': 0.38189068036980683, 'recall': 0.3502781575597567, 'f1-score': 0.18814164038435335, 'support': 169688}}
[[  419 57787   184]
 [  317 58809   225]
 [  190 51547   210]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1316621
{'0': {'precision': 0.4177215189873418, 'recall': 0.02272205646086757, 'f1-score': 0.04309969525468002, 'support': 21785}, '1': {'precision': 0.3302779102136233, 'recall': 0.9802355303998539, 'f1-score': 0.49408137675574326, 'support': 21908}, '2': {'precision': 0.3785488958990536, 'recall': 0.005256241787122208, 'f1-score': 0.010368514278308205, 'support': 22830}, 'accuracy': 0.3320656013709544, 'macro avg': {'precision': 0.3755161083666729, 'recall': 0.3360712762159479, 'f1-score': 0.1825165287629105, 'support': 66523}, 'weighted avg': {'precision': 0.37548010524893183, 'recall': 0.3320656013709544, 'f1-score': 0.18038835957581295, 'support': 66523}}
[[  495 21181   109]
 [  345 21475    88]
 [  345 22365   120]]
Evaluating performance on  val set...
51/51 - 1s - 1s/epoch - 24ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0828993
{'0': {'precision': 0.4201388888888889, 'recall': 0.03090676883780332, 'f1-score': 0.05757792053295266, 'support': 3915}, '1': {'precision': 0.4338123143614032, 'recall': 0.9719424460431655, 'f1-score': 0.5998778931009602, 'support': 5560}, '2': {'precision': 0.21568627450980393, 'recall': 0.006524317912218268, 'f1-score': 0.012665515256188831, 'support': 3372}, 'accuracy': 0.4317739550089515, 'macro avg': {'precision': 0.35654582592003203, 'recall': 0.33645784426439573, 'f1-score': 0.22337377629670055, 'support': 12847}, 'weighted avg': {'precision': 0.37239311399520986, 'recall': 0.4317739550089515, 'f1-score': 0.2804893564234231, 'support': 12847}}
[[ 121 3765   29]
 [ 105 5404   51]
 [  62 3288   22]]
training model: results/LILAK/W1/deepVOL_L3/h500
Epoch 1/50
260/260 - 14s - loss: 3.3272 - accuracy500: 0.3658 - val_loss: 3.3622 - val_accuracy500: 0.4276 - 14s/epoch - 52ms/step
Epoch 2/50
260/260 - 11s - loss: 3.3069 - accuracy500: 0.3587 - val_loss: 3.2964 - val_accuracy500: 0.4278 - 11s/epoch - 44ms/step
Epoch 3/50
260/260 - 11s - loss: 3.3086 - accuracy500: 0.3489 - val_loss: 3.2346 - val_accuracy500: 0.4283 - 11s/epoch - 42ms/step
Epoch 4/50
260/260 - 11s - loss: 3.3025 - accuracy500: 0.3507 - val_loss: 3.2359 - val_accuracy500: 0.4266 - 11s/epoch - 43ms/step
Epoch 5/50
260/260 - 11s - loss: 3.2997 - accuracy500: 0.3531 - val_loss: 3.2407 - val_accuracy500: 0.4217 - 11s/epoch - 41ms/step
Epoch 6/50
260/260 - 11s - loss: 3.2932 - accuracy500: 0.3612 - val_loss: 3.2470 - val_accuracy500: 0.4159 - 11s/epoch - 43ms/step
Epoch 7/50
260/260 - 12s - loss: 3.2896 - accuracy500: 0.3658 - val_loss: 3.2415 - val_accuracy500: 0.4198 - 12s/epoch - 46ms/step
Epoch 8/50
260/260 - 11s - loss: 3.2888 - accuracy500: 0.3683 - val_loss: 3.2474 - val_accuracy500: 0.4126 - 11s/epoch - 44ms/step
Epoch 9/50
260/260 - 11s - loss: 3.2807 - accuracy500: 0.3761 - val_loss: 3.2516 - val_accuracy500: 0.4052 - 11s/epoch - 41ms/step
Epoch 10/50
260/260 - 11s - loss: 3.2730 - accuracy500: 0.3843 - val_loss: 3.2643 - val_accuracy500: 0.4055 - 11s/epoch - 43ms/step
Epoch 11/50
260/260 - 11s - loss: 3.2646 - accuracy500: 0.3899 - val_loss: 3.2690 - val_accuracy500: 0.4028 - 11s/epoch - 43ms/step
Epoch 12/50
260/260 - 11s - loss: 3.2523 - accuracy500: 0.3996 - val_loss: 3.2818 - val_accuracy500: 0.3935 - 11s/epoch - 42ms/step
Epoch 13/50
260/260 - 11s - loss: 3.2480 - accuracy500: 0.4032 - val_loss: 3.2773 - val_accuracy500: 0.4056 - 11s/epoch - 40ms/step
testing model: results/LILAK/W1/deepVOL_L3/h500
Evaluating performance on  test set...
663/663 - 15s - 15s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1027985
{'0': {'precision': 0.34980988593155893, 'recall': 0.0016427104722792608, 'f1-score': 0.0032700646904101796, 'support': 56005}, '1': {'precision': 0.37834343768263096, 'recall': 0.9982244373491161, 'f1-score': 0.5487149192650811, 'support': 64205}, '2': {'precision': 0.3076923076923077, 'recall': 0.00016168802295969925, 'f1-score': 0.0003232062055591467, 'support': 49478}, 'accuracy': 0.3782883881005139, 'macro avg': {'precision': 0.3452818771021659, 'recall': 0.33334294528145175, 'f1-score': 0.18410273005368347, 'support': 169688}, 'weighted avg': {'precision': 0.3483254153387999, 'recall': 0.3782883881005139, 'f1-score': 0.20879126963037814, 'support': 169688}}
[[   92 55904     9]
 [  105 64091     9]
 [   66 49404     8]]
Evaluating performance on  train set...
260/260 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1301115
{'0': {'precision': 0.4, 'recall': 0.001641212673808981, 'f1-score': 0.003269012485811578, 'support': 21935}, '1': {'precision': 0.3294337293162895, 'recall': 0.9986763430553653, 'f1-score': 0.4954373570636053, 'support': 21909}, '2': {'precision': 0.25, 'recall': 0.0001763746196922263, 'f1-score': 0.0003525005507821106, 'support': 22679}, 'accuracy': 0.32951009425311545, 'macro avg': {'precision': 0.3264779097720965, 'recall': 0.33349797678295556, 'f1-score': 0.16635295670006633, 'support': 66523}, 'weighted avg': {'precision': 0.3256214177891945, 'recall': 0.32951009425311545, 'f1-score': 0.16436777061729016, 'support': 66523}}
[[   36 21891     8]
 [   25 21880     4]
 [   29 22646     4]]
Evaluating performance on  val set...
51/51 - 1s - 1s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0770876
{'0': {'precision': 0.15, 'recall': 0.0007416563658838071, 'f1-score': 0.0014760147601476014, 'support': 4045}, '1': {'precision': 0.4278583684292622, 'recall': 0.9979989084955431, 'f1-score': 0.5989409902287244, 'support': 5497}, '2': {'precision': 0.8, 'recall': 0.001210287443267776, 'f1-score': 0.0024169184290030207, 'support': 3305}, 'accuracy': 0.42757063905970266, 'macro avg': {'precision': 0.45928612280975406, 'recall': 0.3333169507682316, 'f1-score': 0.20094464113929167, 'support': 12847}, 'weighted avg': {'precision': 0.4361086207873943, 'recall': 0.42757063905970266, 'f1-score': 0.2573625763524519, 'support': 12847}}
[[   3 4042    0]
 [  10 5486    1]
 [   7 3294    4]]
training model: results/LILAK/W1/deepVOL_L3/h1000
Epoch 1/50
260/260 - 13s - loss: 3.3373 - accuracy1000: 0.3657 - val_loss: 3.3737 - val_accuracy1000: 0.4050 - 13s/epoch - 50ms/step
Epoch 2/50
260/260 - 11s - loss: 3.3095 - accuracy1000: 0.3726 - val_loss: 3.4396 - val_accuracy1000: 0.4099 - 11s/epoch - 43ms/step
Epoch 3/50
260/260 - 11s - loss: 3.3072 - accuracy1000: 0.3632 - val_loss: 3.3501 - val_accuracy1000: 0.4098 - 11s/epoch - 43ms/step
Epoch 4/50
260/260 - 10s - loss: 3.2974 - accuracy1000: 0.3675 - val_loss: 3.3318 - val_accuracy1000: 0.4099 - 10s/epoch - 40ms/step
Epoch 5/50
260/260 - 10s - loss: 3.2903 - accuracy1000: 0.3703 - val_loss: 3.2976 - val_accuracy1000: 0.4106 - 10s/epoch - 40ms/step
Epoch 6/50
260/260 - 11s - loss: 3.2810 - accuracy1000: 0.3814 - val_loss: 3.2977 - val_accuracy1000: 0.4101 - 11s/epoch - 43ms/step
Epoch 7/50
260/260 - 11s - loss: 3.2825 - accuracy1000: 0.3747 - val_loss: 3.2743 - val_accuracy1000: 0.4107 - 11s/epoch - 42ms/step
Epoch 8/50
260/260 - 11s - loss: 3.2762 - accuracy1000: 0.3811 - val_loss: 3.3027 - val_accuracy1000: 0.4105 - 11s/epoch - 42ms/step
Epoch 9/50
260/260 - 11s - loss: 3.2795 - accuracy1000: 0.3790 - val_loss: 3.2605 - val_accuracy1000: 0.4090 - 11s/epoch - 41ms/step
Epoch 10/50
260/260 - 11s - loss: 3.2677 - accuracy1000: 0.3876 - val_loss: 3.2675 - val_accuracy1000: 0.4060 - 11s/epoch - 41ms/step
Epoch 11/50
260/260 - 11s - loss: 3.2630 - accuracy1000: 0.3928 - val_loss: 3.2643 - val_accuracy1000: 0.4041 - 11s/epoch - 40ms/step
Epoch 12/50
260/260 - 11s - loss: 3.2546 - accuracy1000: 0.3940 - val_loss: 3.2750 - val_accuracy1000: 0.4098 - 11s/epoch - 41ms/step
Epoch 13/50
260/260 - 11s - loss: 3.2411 - accuracy1000: 0.4058 - val_loss: 3.3112 - val_accuracy1000: 0.4143 - 11s/epoch - 41ms/step
Epoch 14/50
260/260 - 11s - loss: 3.2265 - accuracy1000: 0.4134 - val_loss: 3.3449 - val_accuracy1000: 0.4120 - 11s/epoch - 41ms/step
Epoch 15/50
260/260 - 11s - loss: 3.2108 - accuracy1000: 0.4231 - val_loss: 3.3737 - val_accuracy1000: 0.4098 - 11s/epoch - 41ms/step
Epoch 16/50
260/260 - 11s - loss: 3.2161 - accuracy1000: 0.4213 - val_loss: 3.3790 - val_accuracy1000: 0.4132 - 11s/epoch - 41ms/step
Epoch 17/50
260/260 - 11s - loss: 3.2073 - accuracy1000: 0.4274 - val_loss: 3.3967 - val_accuracy1000: 0.4116 - 11s/epoch - 42ms/step
Epoch 18/50
260/260 - 11s - loss: 3.2124 - accuracy1000: 0.4271 - val_loss: 3.4128 - val_accuracy1000: 0.4171 - 11s/epoch - 42ms/step
Epoch 19/50
260/260 - 11s - loss: 3.2200 - accuracy1000: 0.4233 - val_loss: 3.3703 - val_accuracy1000: 0.4026 - 11s/epoch - 41ms/step
testing model: results/LILAK/W1/deepVOL_L3/h1000
Evaluating performance on  test set...
663/663 - 14s - 14s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1090363
{'0': {'precision': 0.3477378778656928, 'recall': 0.15057277391243234, 'f1-score': 0.21014945868736282, 'support': 56916}, '1': {'precision': 0.37796291060061654, 'recall': 0.8509300375741391, 'f1-score': 0.523430448838864, 'support': 64406}, '2': {'precision': 0.6190476190476191, 'recall': 0.0005375677128561386, 'f1-score': 0.0010742026111386547, 'support': 48366}, 'accuracy': 0.373632784875772, 'macro avg': {'precision': 0.4482494691713095, 'recall': 0.3340134597331425, 'f1-score': 0.24488470337912183, 'support': 169688}, 'weighted avg': {'precision': 0.43654109553771764, 'recall': 0.373632784875772, 'f1-score': 0.26946444628999194, 'support': 169688}}
[[ 8570 48339     7]
 [ 9592 54805     9]
 [ 6483 41857    26]]
Evaluating performance on  train set...
260/260 - 6s - 6s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1226511
{'0': {'precision': 0.41795709617843446, 'recall': 0.13789547691586596, 'f1-score': 0.20737294706421372, 'support': 21335}, '1': {'precision': 0.339203340179804, 'recall': 0.9093699223686587, 'f1-score': 0.4941020673418839, 'support': 22156}, '2': {'precision': 0.27906976744186046, 'recall': 0.0010420284821118443, 'f1-score': 0.0020763041785621596, 'support': 23032}, 'accuracy': 0.3474587736572313, 'macro avg': {'precision': 0.3454100679333663, 'recall': 0.34943580925554546, 'f1-score': 0.2345171061948866, 'support': 66523}, 'weighted avg': {'precision': 0.3436411276657933, 'recall': 0.3474587736572313, 'f1-score': 0.23179124013472668, 'support': 66523}}
[[ 2942 18370    23]
 [ 1969 20148    39]
 [ 2128 20880    24]]
Evaluating performance on  val set...
51/51 - 1s - 1s/epoch - 23ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0846466
{'0': {'precision': 0.3863080684596577, 'recall': 0.22353218580523462, 'f1-score': 0.2831964152352502, 'support': 4241}, '1': {'precision': 0.41734860883797054, 'recall': 0.8228929384965832, 'f1-score': 0.5538166719897796, 'support': 5268}, '2': {'precision': 0.6666666666666666, 'recall': 0.0011983223487118035, 'f1-score': 0.002392344497607656, 'support': 3338}, 'accuracy': 0.4115357671051607, 'macro avg': {'precision': 0.4901077813214316, 'recall': 0.34920781555017655, 'f1-score': 0.27980181057421244, 'support': 12847}, 'weighted avg': {'precision': 0.4718812425491687, 'recall': 0.4115357671051607, 'f1-score': 0.3212055632433929, 'support': 12847}}
[[ 948 3293    0]
 [ 931 4335    2]
 [ 575 2759    4]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        15 (peak)  11.98 (ave)

============================================
