This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/CHTR_orderbooks/CHTR_orderbooks_2019-09-04.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-08-27.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-08-14.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-08-15.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-08-23.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-08-19.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-08-21.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-08-16.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-09-06.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-08-20.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-08-22.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-08-13.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-08-29.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-08-28.csv
training model: results/CHTR/W6/deepLOB_L1/h10
Epoch 1/50
448/448 - 63s - loss: 3.3200 - accuracy10: 0.3628 - val_loss: 3.3173 - val_accuracy10: 0.3496 - 63s/epoch - 141ms/step
Epoch 2/50
448/448 - 26s - loss: 3.2778 - accuracy10: 0.3807 - val_loss: 3.2882 - val_accuracy10: 0.3696 - 26s/epoch - 58ms/step
Epoch 3/50
448/448 - 26s - loss: 3.2600 - accuracy10: 0.3932 - val_loss: 3.2718 - val_accuracy10: 0.3846 - 26s/epoch - 59ms/step
Epoch 4/50
448/448 - 26s - loss: 3.2483 - accuracy10: 0.4007 - val_loss: 3.2821 - val_accuracy10: 0.3745 - 26s/epoch - 58ms/step
Epoch 5/50
448/448 - 24s - loss: 3.2406 - accuracy10: 0.4049 - val_loss: 3.2690 - val_accuracy10: 0.3825 - 24s/epoch - 53ms/step
Epoch 6/50
448/448 - 25s - loss: 3.2333 - accuracy10: 0.4092 - val_loss: 3.2640 - val_accuracy10: 0.3837 - 25s/epoch - 55ms/step
Epoch 7/50
448/448 - 25s - loss: 3.2285 - accuracy10: 0.4094 - val_loss: 3.2513 - val_accuracy10: 0.3921 - 25s/epoch - 56ms/step
Epoch 8/50
448/448 - 26s - loss: 3.2218 - accuracy10: 0.4143 - val_loss: 3.2411 - val_accuracy10: 0.3995 - 26s/epoch - 58ms/step
Epoch 9/50
448/448 - 26s - loss: 3.2166 - accuracy10: 0.4157 - val_loss: 3.2414 - val_accuracy10: 0.4016 - 26s/epoch - 57ms/step
Epoch 10/50
448/448 - 25s - loss: 3.2135 - accuracy10: 0.4173 - val_loss: 3.2416 - val_accuracy10: 0.4030 - 25s/epoch - 57ms/step
Epoch 11/50
448/448 - 27s - loss: 3.2077 - accuracy10: 0.4208 - val_loss: 3.2453 - val_accuracy10: 0.4026 - 27s/epoch - 61ms/step
Epoch 12/50
448/448 - 25s - loss: 3.2031 - accuracy10: 0.4218 - val_loss: 3.2366 - val_accuracy10: 0.4029 - 25s/epoch - 55ms/step
Epoch 13/50
448/448 - 26s - loss: 3.1991 - accuracy10: 0.4243 - val_loss: 3.2347 - val_accuracy10: 0.4065 - 26s/epoch - 59ms/step
Epoch 14/50
448/448 - 28s - loss: 3.1949 - accuracy10: 0.4261 - val_loss: 3.2324 - val_accuracy10: 0.4076 - 28s/epoch - 62ms/step
Epoch 15/50
448/448 - 27s - loss: 3.1913 - accuracy10: 0.4282 - val_loss: 3.2250 - val_accuracy10: 0.4100 - 27s/epoch - 59ms/step
Epoch 16/50
448/448 - 26s - loss: 3.1849 - accuracy10: 0.4312 - val_loss: 3.2239 - val_accuracy10: 0.4080 - 26s/epoch - 57ms/step
Epoch 17/50
448/448 - 26s - loss: 3.1818 - accuracy10: 0.4316 - val_loss: 3.2260 - val_accuracy10: 0.4091 - 26s/epoch - 58ms/step
Epoch 18/50
448/448 - 26s - loss: 3.1779 - accuracy10: 0.4336 - val_loss: 3.2202 - val_accuracy10: 0.4131 - 26s/epoch - 58ms/step
Epoch 19/50
448/448 - 26s - loss: 3.1743 - accuracy10: 0.4356 - val_loss: 3.2270 - val_accuracy10: 0.4072 - 26s/epoch - 59ms/step
Epoch 20/50
448/448 - 26s - loss: 3.1706 - accuracy10: 0.4352 - val_loss: 3.2254 - val_accuracy10: 0.4112 - 26s/epoch - 59ms/step
Epoch 21/50
448/448 - 24s - loss: 3.1671 - accuracy10: 0.4365 - val_loss: 3.2274 - val_accuracy10: 0.4087 - 24s/epoch - 55ms/step
Epoch 22/50
448/448 - 26s - loss: 3.1643 - accuracy10: 0.4401 - val_loss: 3.2249 - val_accuracy10: 0.4068 - 26s/epoch - 58ms/step
Epoch 23/50
448/448 - 25s - loss: 3.1613 - accuracy10: 0.4408 - val_loss: 3.2260 - val_accuracy10: 0.4096 - 25s/epoch - 55ms/step
Epoch 24/50
448/448 - 26s - loss: 3.1567 - accuracy10: 0.4430 - val_loss: 3.2287 - val_accuracy10: 0.4089 - 26s/epoch - 58ms/step
Epoch 25/50
448/448 - 26s - loss: 3.1541 - accuracy10: 0.4442 - val_loss: 3.2241 - val_accuracy10: 0.4117 - 26s/epoch - 58ms/step
Epoch 26/50
448/448 - 27s - loss: 3.1521 - accuracy10: 0.4450 - val_loss: 3.2264 - val_accuracy10: 0.4082 - 27s/epoch - 60ms/step
Epoch 27/50
448/448 - 26s - loss: 3.1495 - accuracy10: 0.4441 - val_loss: 3.2326 - val_accuracy10: 0.4055 - 26s/epoch - 58ms/step
Epoch 28/50
448/448 - 24s - loss: 3.1462 - accuracy10: 0.4466 - val_loss: 3.2385 - val_accuracy10: 0.4058 - 24s/epoch - 53ms/step
testing model: results/CHTR/W6/deepLOB_L1/h10
Evaluating performance on  test set...
1095/1095 - 28s - 28s/epoch - 26ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0830449
{'0': {'precision': 0.467783101240317, 'recall': 0.20810756972111555, 'f1-score': 0.2880619855789779, 'support': 100400}, '1': {'precision': 0.30437089759710223, 'recall': 0.36283502248380756, 'f1-score': 0.3310414915373324, 'support': 72719}, '2': {'precision': 0.44474774096385544, 'recall': 0.61839768159297, 'f1-score': 0.517391066302707, 'support': 106970}, 'accuracy': 0.4049748472806858, 'macro avg': {'precision': 0.4056339132670916, 'recall': 0.3964467579326311, 'f1-score': 0.3788315144730057, 'support': 280089}, 'weighted avg': {'precision': 0.4165591526900204, 'recall': 0.4049748472806858, 'f1-score': 0.3868047368430507, 'support': 280089}}
[[20894 33098 46408]
 [10156 26385 36178]
 [13616 27204 66150]]
Evaluating performance on  train set...
448/448 - 11s - 11s/epoch - 25ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0735631
{'0': {'precision': 0.44658256148195463, 'recall': 0.28065333567503825, 'f1-score': 0.34468839072490565, 'support': 39857}, '1': {'precision': 0.4202474317905667, 'recall': 0.4108087679516251, 'f1-score': 0.4154745003822213, 'support': 37044}, '2': {'precision': 0.3939854419930962, 'recall': 0.5576029524998009, 'f1-score': 0.4617278793408598, 'support': 37663}, 'accuracy': 0.41378618065011696, 'macro avg': {'precision': 0.42027181175520584, 'recall': 0.4163550187088214, 'f1-score': 0.4072969234826623, 'support': 114564}, 'weighted avg': {'precision': 0.42077581716788875, 'recall': 0.41378618065011696, 'f1-score': 0.4060537315465274, 'support': 114564}}
[[11186 11308 17363]
 [ 6886 15218 14940]
 [ 6976  9686 21001]]
Evaluating performance on  val set...
136/136 - 4s - 4s/epoch - 31ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.075978
{'0': {'precision': 0.44576719576719576, 'recall': 0.273250628395362, 'f1-score': 0.3388126476650078, 'support': 12333}, '1': {'precision': 0.38813949662773484, 'recall': 0.45576588757967934, 'f1-score': 0.4192430703624733, 'support': 10354}, '2': {'precision': 0.41448023912321486, 'recall': 0.5162998510673507, 'f1-score': 0.4598209351166132, 'support': 12086}, 'accuracy': 0.41207258505162053, 'macro avg': {'precision': 0.4161289771727151, 'recall': 0.4151054556807973, 'f1-score': 0.4059588843813648, 'support': 34773}, 'weighted avg': {'precision': 0.4177336250402199, 'recall': 0.41207258505162053, 'f1-score': 0.4048202615824053, 'support': 34773}}
[[3370 3921 5042]
 [1862 4719 3773]
 [2328 3518 6240]]
training model: results/CHTR/W6/deepLOB_L1/h20
Epoch 1/50
448/448 - 31s - loss: 3.3161 - accuracy20: 0.3661 - val_loss: 3.3314 - val_accuracy20: 0.3482 - 31s/epoch - 68ms/step
Epoch 2/50
448/448 - 31s - loss: 3.2839 - accuracy20: 0.3756 - val_loss: 3.3330 - val_accuracy20: 0.3334 - 31s/epoch - 69ms/step
Epoch 3/50
448/448 - 30s - loss: 3.2704 - accuracy20: 0.3839 - val_loss: 3.3120 - val_accuracy20: 0.3320 - 30s/epoch - 67ms/step
Epoch 4/50
448/448 - 30s - loss: 3.2565 - accuracy20: 0.3934 - val_loss: 3.2955 - val_accuracy20: 0.3483 - 30s/epoch - 68ms/step
Epoch 5/50
448/448 - 28s - loss: 3.2488 - accuracy20: 0.3976 - val_loss: 3.2996 - val_accuracy20: 0.3468 - 28s/epoch - 62ms/step
Epoch 6/50
448/448 - 27s - loss: 3.2455 - accuracy20: 0.3994 - val_loss: 3.2872 - val_accuracy20: 0.3666 - 27s/epoch - 60ms/step
Epoch 7/50
448/448 - 27s - loss: 3.2415 - accuracy20: 0.4044 - val_loss: 3.2881 - val_accuracy20: 0.3665 - 27s/epoch - 60ms/step
Epoch 8/50
448/448 - 27s - loss: 3.2377 - accuracy20: 0.4059 - val_loss: 3.2893 - val_accuracy20: 0.3614 - 27s/epoch - 60ms/step
Epoch 9/50
448/448 - 29s - loss: 3.2342 - accuracy20: 0.4072 - val_loss: 3.2842 - val_accuracy20: 0.3762 - 29s/epoch - 65ms/step
Epoch 10/50
448/448 - 32s - loss: 3.2323 - accuracy20: 0.4094 - val_loss: 3.2847 - val_accuracy20: 0.3733 - 32s/epoch - 72ms/step
Epoch 11/50
448/448 - 29s - loss: 3.2285 - accuracy20: 0.4112 - val_loss: 3.2815 - val_accuracy20: 0.3742 - 29s/epoch - 65ms/step
Epoch 12/50
448/448 - 29s - loss: 3.2272 - accuracy20: 0.4111 - val_loss: 3.2833 - val_accuracy20: 0.3750 - 29s/epoch - 64ms/step
Epoch 13/50
448/448 - 29s - loss: 3.2238 - accuracy20: 0.4137 - val_loss: 3.2897 - val_accuracy20: 0.3723 - 29s/epoch - 65ms/step
Epoch 14/50
448/448 - 29s - loss: 3.2208 - accuracy20: 0.4158 - val_loss: 3.2834 - val_accuracy20: 0.3791 - 29s/epoch - 65ms/step
Epoch 15/50
448/448 - 28s - loss: 3.2169 - accuracy20: 0.4184 - val_loss: 3.2803 - val_accuracy20: 0.3797 - 28s/epoch - 62ms/step
Epoch 16/50
448/448 - 27s - loss: 3.2140 - accuracy20: 0.4197 - val_loss: 3.2854 - val_accuracy20: 0.3795 - 27s/epoch - 60ms/step
Epoch 17/50
448/448 - 28s - loss: 3.2122 - accuracy20: 0.4198 - val_loss: 3.2838 - val_accuracy20: 0.3824 - 28s/epoch - 62ms/step
Epoch 18/50
448/448 - 26s - loss: 3.2103 - accuracy20: 0.4210 - val_loss: 3.2786 - val_accuracy20: 0.3855 - 26s/epoch - 59ms/step
Epoch 19/50
448/448 - 26s - loss: 3.2079 - accuracy20: 0.4222 - val_loss: 3.2981 - val_accuracy20: 0.3737 - 26s/epoch - 59ms/step
Epoch 20/50
448/448 - 27s - loss: 3.2048 - accuracy20: 0.4228 - val_loss: 3.2836 - val_accuracy20: 0.3843 - 27s/epoch - 61ms/step
Epoch 21/50
448/448 - 27s - loss: 3.2038 - accuracy20: 0.4236 - val_loss: 3.2886 - val_accuracy20: 0.3841 - 27s/epoch - 61ms/step
Epoch 22/50
448/448 - 27s - loss: 3.1994 - accuracy20: 0.4259 - val_loss: 3.2924 - val_accuracy20: 0.3812 - 27s/epoch - 59ms/step
Epoch 23/50
448/448 - 27s - loss: 3.1986 - accuracy20: 0.4260 - val_loss: 3.3016 - val_accuracy20: 0.3760 - 27s/epoch - 60ms/step
Epoch 24/50
448/448 - 28s - loss: 3.1948 - accuracy20: 0.4294 - val_loss: 3.3052 - val_accuracy20: 0.3771 - 28s/epoch - 63ms/step
Epoch 25/50
448/448 - 31s - loss: 3.1957 - accuracy20: 0.4272 - val_loss: 3.2976 - val_accuracy20: 0.3816 - 31s/epoch - 68ms/step
Epoch 26/50
448/448 - 30s - loss: 3.1909 - accuracy20: 0.4299 - val_loss: 3.2989 - val_accuracy20: 0.3806 - 30s/epoch - 68ms/step
Epoch 27/50
448/448 - 29s - loss: 3.1894 - accuracy20: 0.4302 - val_loss: 3.3061 - val_accuracy20: 0.3813 - 29s/epoch - 65ms/step
Epoch 28/50
448/448 - 30s - loss: 3.1864 - accuracy20: 0.4314 - val_loss: 3.2996 - val_accuracy20: 0.3814 - 30s/epoch - 67ms/step
testing model: results/CHTR/W6/deepLOB_L1/h20
Evaluating performance on  test set...
1095/1095 - 27s - 27s/epoch - 25ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1037797
{'0': {'precision': 0.46114918967394786, 'recall': 0.21289998225587034, 'f1-score': 0.2913100657561963, 'support': 101442}, '1': {'precision': 0.29121974647436366, 'recall': 0.5427323767935122, 'f1-score': 0.37904906232240954, 'support': 73738}, '2': {'precision': 0.44409082371600894, 'recall': 0.4056753948660268, 'f1-score': 0.42401478507345214, 'support': 104909}, 'accuracy': 0.37193891941490026, 'macro avg': {'precision': 0.39881991995477345, 'recall': 0.38710258463846975, 'f1-score': 0.36479130438401935, 'support': 280089}, 'weighted avg': {'precision': 0.41002317830994445, 'recall': 0.37193891941490026, 'f1-score': 0.36411412992027775, 'support': 280089}}
[[21597 49935 29910]
 [10353 40020 23365]
 [14883 47467 42559]]
Evaluating performance on  train set...
448/448 - 14s - 14s/epoch - 32ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.086131
{'0': {'precision': 0.42169443459766043, 'recall': 0.30181403019155145, 'f1-score': 0.35182255083179304, 'support': 39415}, '1': {'precision': 0.37264845716416517, 'recall': 0.5372849462365591, 'f1-score': 0.440072659217262, 'support': 37200}, '2': {'precision': 0.4122069745407867, 'recall': 0.35539803420379984, 'f1-score': 0.38170034527650426, 'support': 37949}, 'accuracy': 0.3960231835480605, 'macro avg': {'precision': 0.4021832887675374, 'recall': 0.3981656702106368, 'f1-score': 0.3911985184418531, 'support': 114564}, 'weighted avg': {'precision': 0.40262605376053595, 'recall': 0.3960231835480605, 'f1-score': 0.3903751192941529, 'support': 114564}}
[[11896 17542  9977]
 [ 7958 19987  9255]
 [ 8356 16106 13487]]
Evaluating performance on  val set...
136/136 - 4s - 4s/epoch - 32ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.095242
{'0': {'precision': 0.42830377217087184, 'recall': 0.28136538934930666, 'f1-score': 0.339622641509434, 'support': 12187}, '1': {'precision': 0.34407455229326894, 'recall': 0.5813335862657688, 'f1-score': 0.43228946254760897, 'support': 10543}, '2': {'precision': 0.4198123743578289, 'recall': 0.3121315286888649, 'f1-score': 0.35805115016430916, 'support': 12043}, 'accuracy': 0.3829695453368993, 'macro avg': {'precision': 0.3973968996073232, 'recall': 0.3916101681013135, 'f1-score': 0.376654418073784, 'support': 34773}, 'weighted avg': {'precision': 0.399825051064495, 'recall': 0.38296954533689936, 'f1-score': 0.37410113988277366, 'support': 34773}}
[[3429 5963 2795]
 [2014 6129 2400]
 [2563 5721 3759]]
training model: results/CHTR/W6/deepLOB_L1/h30
Epoch 1/50
448/448 - 34s - loss: 3.3192 - accuracy30: 0.3636 - val_loss: 3.3274 - val_accuracy30: 0.3413 - 34s/epoch - 76ms/step
Epoch 2/50
448/448 - 27s - loss: 3.2944 - accuracy30: 0.3686 - val_loss: 3.3505 - val_accuracy30: 0.3151 - 27s/epoch - 59ms/step
Epoch 3/50
448/448 - 26s - loss: 3.2801 - accuracy30: 0.3754 - val_loss: 3.3277 - val_accuracy30: 0.3305 - 26s/epoch - 58ms/step
Epoch 4/50
448/448 - 29s - loss: 3.2701 - accuracy30: 0.3818 - val_loss: 3.3221 - val_accuracy30: 0.3407 - 29s/epoch - 65ms/step
Epoch 5/50
448/448 - 29s - loss: 3.2658 - accuracy30: 0.3852 - val_loss: 3.3119 - val_accuracy30: 0.3490 - 29s/epoch - 64ms/step
Epoch 6/50
448/448 - 27s - loss: 3.2629 - accuracy30: 0.3865 - val_loss: 3.2940 - val_accuracy30: 0.3580 - 27s/epoch - 61ms/step
Epoch 7/50
448/448 - 30s - loss: 3.2560 - accuracy30: 0.3920 - val_loss: 3.3062 - val_accuracy30: 0.3529 - 30s/epoch - 68ms/step
Epoch 8/50
448/448 - 27s - loss: 3.2525 - accuracy30: 0.3948 - val_loss: 3.2958 - val_accuracy30: 0.3694 - 27s/epoch - 59ms/step
Epoch 9/50
448/448 - 29s - loss: 3.2492 - accuracy30: 0.3964 - val_loss: 3.2979 - val_accuracy30: 0.3728 - 29s/epoch - 64ms/step
Epoch 10/50
448/448 - 29s - loss: 3.2468 - accuracy30: 0.3983 - val_loss: 3.2949 - val_accuracy30: 0.3667 - 29s/epoch - 64ms/step
Epoch 11/50
448/448 - 28s - loss: 3.2481 - accuracy30: 0.3964 - val_loss: 3.3001 - val_accuracy30: 0.3630 - 28s/epoch - 63ms/step
Epoch 12/50
448/448 - 26s - loss: 3.2438 - accuracy30: 0.3997 - val_loss: 3.2994 - val_accuracy30: 0.3661 - 26s/epoch - 59ms/step
Epoch 13/50
448/448 - 29s - loss: 3.2425 - accuracy30: 0.4011 - val_loss: 3.2943 - val_accuracy30: 0.3689 - 29s/epoch - 66ms/step
Epoch 14/50
448/448 - 29s - loss: 3.2402 - accuracy30: 0.4032 - val_loss: 3.2949 - val_accuracy30: 0.3707 - 29s/epoch - 64ms/step
Epoch 15/50
448/448 - 27s - loss: 3.2372 - accuracy30: 0.4044 - val_loss: 3.3075 - val_accuracy30: 0.3599 - 27s/epoch - 61ms/step
Epoch 16/50
448/448 - 27s - loss: 3.2347 - accuracy30: 0.4063 - val_loss: 3.2951 - val_accuracy30: 0.3736 - 27s/epoch - 61ms/step
testing model: results/CHTR/W6/deepLOB_L1/h30
Evaluating performance on  test set...
1095/1095 - 28s - 28s/epoch - 26ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.107705
{'0': {'precision': 0.4438680364832333, 'recall': 0.12969219033277524, 'f1-score': 0.20073294896957805, 'support': 100939}, '1': {'precision': 0.274815201971179, 'recall': 0.7367978540257036, 'f1-score': 0.4003175915250919, 'support': 74931}, '2': {'precision': 0.4403130721715861, 'recall': 0.20998090559303006, 'f1-score': 0.28435550935550935, 'support': 104219}, 'accuracy': 0.32198336957181467, 'macro avg': {'precision': 0.3863321035419995, 'recall': 0.35882364998383637, 'f1-score': 0.2951353499500598, 'support': 280089}, 'weighted avg': {'precision': 0.39731928673433814, 'recall': 0.32198336957181467, 'f1-score': 0.2852422887586757, 'support': 280089}}
[[13091 72836 15012]
 [ 6917 55209 12805]
 [ 9485 72850 21884]]
Evaluating performance on  train set...
448/448 - 13s - 13s/epoch - 28ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0941689
{'0': {'precision': 0.3832399366899089, 'recall': 0.23186417867957246, 'f1-score': 0.2889254385964912, 'support': 38639}, '1': {'precision': 0.34066095976190125, 'recall': 0.6112139156180607, 'f1-score': 0.43748758266397975, 'support': 37828}, '2': {'precision': 0.3975810602161606, 'recall': 0.24332624616111506, 'f1-score': 0.3018904792144985, 'support': 38097}, 'accuracy': 0.36093362661918227, 'macro avg': {'precision': 0.3738273188893236, 'recall': 0.36213478015291606, 'f1-score': 0.34276783349165646, 'support': 114564}, 'weighted avg': {'precision': 0.37394972548697375, 'recall': 0.36093362661918227, 'f1-score': 0.34229070114152443, 'support': 114564}}
[[ 8959 22897  6783]
 [ 7444 23121  7263]
 [ 6974 21853  9270]]
Evaluating performance on  val set...
136/136 - 4s - 4s/epoch - 31ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0992987
{'0': {'precision': 0.42204750752760123, 'recall': 0.20991763041850403, 'f1-score': 0.28038006334389065, 'support': 12019}, '1': {'precision': 0.3213264722698685, 'recall': 0.6873000940733772, 'f1-score': 0.43791770311984896, 'support': 10630}, '2': {'precision': 0.4138329481677121, 'recall': 0.20677994061365887, 'f1-score': 0.2757672423275767, 'support': 12124}, 'accuracy': 0.3547580018980243, 'macro avg': {'precision': 0.3857356426550606, 'recall': 0.3679992217018467, 'f1-score': 0.3313550029304388, 'support': 34773}, 'weighted avg': {'precision': 0.38839329528048433, 'recall': 0.3547580018980243, 'f1-score': 0.32693052688792335, 'support': 34773}}
[[2523 7747 1749]
 [1522 7306 1802]
 [1933 7684 2507]]
training model: results/CHTR/W6/deepLOB_L1/h50
Epoch 1/50
448/448 - 36s - loss: 3.3261 - accuracy50: 0.3562 - val_loss: 3.3729 - val_accuracy50: 0.3352 - 36s/epoch - 79ms/step
Epoch 2/50
448/448 - 29s - loss: 3.2953 - accuracy50: 0.3656 - val_loss: 3.4028 - val_accuracy50: 0.3240 - 29s/epoch - 64ms/step
Epoch 3/50
448/448 - 30s - loss: 3.2878 - accuracy50: 0.3715 - val_loss: 3.3437 - val_accuracy50: 0.3369 - 30s/epoch - 67ms/step
Epoch 4/50
448/448 - 28s - loss: 3.2810 - accuracy50: 0.3718 - val_loss: 3.3384 - val_accuracy50: 0.3379 - 28s/epoch - 64ms/step
Epoch 5/50
448/448 - 30s - loss: 3.2744 - accuracy50: 0.3764 - val_loss: 3.3405 - val_accuracy50: 0.3392 - 30s/epoch - 66ms/step
Epoch 6/50
448/448 - 30s - loss: 3.2701 - accuracy50: 0.3802 - val_loss: 3.3301 - val_accuracy50: 0.3252 - 30s/epoch - 66ms/step
Epoch 7/50
448/448 - 27s - loss: 3.2684 - accuracy50: 0.3818 - val_loss: 3.3235 - val_accuracy50: 0.3328 - 27s/epoch - 59ms/step
Epoch 8/50
448/448 - 29s - loss: 3.2625 - accuracy50: 0.3858 - val_loss: 3.3195 - val_accuracy50: 0.3404 - 29s/epoch - 64ms/step
Epoch 9/50
448/448 - 28s - loss: 3.2606 - accuracy50: 0.3882 - val_loss: 3.3135 - val_accuracy50: 0.3384 - 28s/epoch - 62ms/step
Epoch 10/50
448/448 - 27s - loss: 3.2575 - accuracy50: 0.3892 - val_loss: 3.3151 - val_accuracy50: 0.3358 - 27s/epoch - 60ms/step
Epoch 11/50
448/448 - 29s - loss: 3.2577 - accuracy50: 0.3881 - val_loss: 3.3185 - val_accuracy50: 0.3342 - 29s/epoch - 66ms/step
Epoch 12/50
448/448 - 32s - loss: 3.2545 - accuracy50: 0.3916 - val_loss: 3.3095 - val_accuracy50: 0.3445 - 32s/epoch - 71ms/step
Epoch 13/50
448/448 - 30s - loss: 3.2527 - accuracy50: 0.3924 - val_loss: 3.3050 - val_accuracy50: 0.3496 - 30s/epoch - 66ms/step
Epoch 14/50
448/448 - 28s - loss: 3.2492 - accuracy50: 0.3945 - val_loss: 3.3090 - val_accuracy50: 0.3536 - 28s/epoch - 62ms/step
Epoch 15/50
448/448 - 29s - loss: 3.2463 - accuracy50: 0.3974 - val_loss: 3.3023 - val_accuracy50: 0.3560 - 29s/epoch - 65ms/step
Epoch 16/50
448/448 - 27s - loss: 3.2457 - accuracy50: 0.3978 - val_loss: 3.3037 - val_accuracy50: 0.3496 - 27s/epoch - 60ms/step
Epoch 17/50
448/448 - 30s - loss: 3.2431 - accuracy50: 0.3988 - val_loss: 3.3128 - val_accuracy50: 0.3507 - 30s/epoch - 67ms/step
Epoch 18/50
448/448 - 30s - loss: 3.2382 - accuracy50: 0.4010 - val_loss: 3.3056 - val_accuracy50: 0.3599 - 30s/epoch - 67ms/step
Epoch 19/50
448/448 - 31s - loss: 3.2385 - accuracy50: 0.4019 - val_loss: 3.2988 - val_accuracy50: 0.3621 - 31s/epoch - 68ms/step
Epoch 20/50
448/448 - 29s - loss: 3.2346 - accuracy50: 0.4033 - val_loss: 3.3104 - val_accuracy50: 0.3626 - 29s/epoch - 65ms/step
Epoch 21/50
448/448 - 31s - loss: 3.2340 - accuracy50: 0.4041 - val_loss: 3.2975 - val_accuracy50: 0.3621 - 31s/epoch - 69ms/step
Epoch 22/50
448/448 - 29s - loss: 3.2316 - accuracy50: 0.4056 - val_loss: 3.3036 - val_accuracy50: 0.3622 - 29s/epoch - 66ms/step
Epoch 23/50
448/448 - 27s - loss: 3.2303 - accuracy50: 0.4058 - val_loss: 3.3015 - val_accuracy50: 0.3615 - 27s/epoch - 60ms/step
Epoch 24/50
448/448 - 30s - loss: 3.2287 - accuracy50: 0.4058 - val_loss: 3.3037 - val_accuracy50: 0.3649 - 30s/epoch - 66ms/step
Epoch 25/50
448/448 - 31s - loss: 3.2261 - accuracy50: 0.4097 - val_loss: 3.3161 - val_accuracy50: 0.3549 - 31s/epoch - 68ms/step
Epoch 26/50
448/448 - 29s - loss: 3.2230 - accuracy50: 0.4098 - val_loss: 3.3156 - val_accuracy50: 0.3666 - 29s/epoch - 65ms/step
Epoch 27/50
448/448 - 28s - loss: 3.2208 - accuracy50: 0.4112 - val_loss: 3.3330 - val_accuracy50: 0.3616 - 28s/epoch - 62ms/step
Epoch 28/50
448/448 - 30s - loss: 3.2203 - accuracy50: 0.4120 - val_loss: 3.3335 - val_accuracy50: 0.3475 - 30s/epoch - 68ms/step
Epoch 29/50
448/448 - 28s - loss: 3.2168 - accuracy50: 0.4126 - val_loss: 3.3291 - val_accuracy50: 0.3549 - 28s/epoch - 62ms/step
Epoch 30/50
448/448 - 30s - loss: 3.2139 - accuracy50: 0.4154 - val_loss: 3.3353 - val_accuracy50: 0.3486 - 30s/epoch - 67ms/step
Epoch 31/50
448/448 - 29s - loss: 3.2152 - accuracy50: 0.4144 - val_loss: 3.3263 - val_accuracy50: 0.3561 - 29s/epoch - 64ms/step
testing model: results/CHTR/W6/deepLOB_L1/h50
Evaluating performance on  test set...
1095/1095 - 30s - 30s/epoch - 28ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.104851
{'0': {'precision': 0.3997252998809633, 'recall': 0.21791044776119403, 'f1-score': 0.2820572462363507, 'support': 100165}, '1': {'precision': 0.26814076139670223, 'recall': 0.23208500032793336, 'f1-score': 0.2488134496797193, 'support': 76235}, '2': {'precision': 0.3955548589341693, 'recall': 0.6084637714704549, 'f1-score': 0.4794349307911805, 'support': 103689}, 'accuracy': 0.3663514097304785, 'macro avg': {'precision': 0.3544736400706116, 'recall': 0.3528197398531941, 'f1-score': 0.3367685422357502, 'support': 280089}, 'weighted avg': {'precision': 0.3623665455468775, 'recall': 0.3663514097304785, 'f1-score': 0.3460781606718014, 'support': 280089}}
[[21827 25513 52825]
 [14958 17693 43584]
 [17820 22778 63091]]
Evaluating performance on  train set...
448/448 - 16s - 16s/epoch - 37ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1023551
{'0': {'precision': 0.35944261727540244, 'recall': 0.2174630187197277, 'f1-score': 0.2709818442816828, 'support': 38195}, '1': {'precision': 0.3556226597415147, 'recall': 0.387496709660437, 'f1-score': 0.37087611009636584, 'support': 37990}, '2': {'precision': 0.37004854078024807, 'recall': 0.4826858438208395, 'f1-score': 0.4189280868385346, 'support': 38379}, 'accuracy': 0.3626968332111309, 'macro avg': {'precision': 0.36170460593238846, 'recall': 0.3625485240670014, 'f1-score': 0.3535953470721944, 'support': 114564}, 'weighted avg': {'precision': 0.36172889002670366, 'recall': 0.3626968332111309, 'f1-score': 0.35366935520474085, 'support': 114564}}
[[ 8306 13686 16203]
 [ 7936 14721 15333]
 [ 6866 12988 18525]]
Evaluating performance on  val set...
136/136 - 5s - 5s/epoch - 33ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1000302
{'0': {'precision': 0.4057561137913825, 'recall': 0.20750382848392038, 'f1-score': 0.2745848578665916, 'support': 11754}, '1': {'precision': 0.3319460209358053, 'recall': 0.48139003200731595, 'f1-score': 0.3929384540738252, 'support': 10935}, '2': {'precision': 0.3818195908245505, 'recall': 0.4077292287322079, 'f1-score': 0.3943492876580759, 'support': 12084}, 'accuracy': 0.3632128375463722, 'macro avg': {'precision': 0.3731739085172461, 'recall': 0.3655410297411481, 'f1-score': 0.3539575331994976, 'support': 34773}, 'weighted avg': {'precision': 0.3742269874891671, 'recall': 0.3632128375463722, 'f1-score': 0.35342274772729954, 'support': 34773}}
[[2439 5393 3922]
 [1616 5264 4055]
 [1956 5201 4927]]
training model: results/CHTR/W6/deepLOB_L1/h100
Epoch 1/50
448/448 - 34s - loss: 3.3292 - accuracy100: 0.3582 - val_loss: 3.4182 - val_accuracy100: 0.3196 - 34s/epoch - 76ms/step
Epoch 2/50
448/448 - 26s - loss: 3.2994 - accuracy100: 0.3670 - val_loss: 3.3771 - val_accuracy100: 0.3284 - 26s/epoch - 58ms/step
Epoch 3/50
448/448 - 27s - loss: 3.2915 - accuracy100: 0.3688 - val_loss: 3.3552 - val_accuracy100: 0.3217 - 27s/epoch - 60ms/step
Epoch 4/50
448/448 - 27s - loss: 3.2873 - accuracy100: 0.3700 - val_loss: 3.3539 - val_accuracy100: 0.3209 - 27s/epoch - 60ms/step
Epoch 5/50
448/448 - 31s - loss: 3.2783 - accuracy100: 0.3775 - val_loss: 3.3578 - val_accuracy100: 0.3181 - 31s/epoch - 69ms/step
Epoch 6/50
448/448 - 28s - loss: 3.2740 - accuracy100: 0.3801 - val_loss: 3.3514 - val_accuracy100: 0.3231 - 28s/epoch - 62ms/step
Epoch 7/50
448/448 - 29s - loss: 3.2727 - accuracy100: 0.3836 - val_loss: 3.3384 - val_accuracy100: 0.3298 - 29s/epoch - 66ms/step
Epoch 8/50
448/448 - 30s - loss: 3.2692 - accuracy100: 0.3860 - val_loss: 3.3376 - val_accuracy100: 0.3311 - 30s/epoch - 67ms/step
Epoch 9/50
448/448 - 26s - loss: 3.2667 - accuracy100: 0.3872 - val_loss: 3.3381 - val_accuracy100: 0.3293 - 26s/epoch - 59ms/step
Epoch 10/50
448/448 - 29s - loss: 3.2644 - accuracy100: 0.3888 - val_loss: 3.3491 - val_accuracy100: 0.3238 - 29s/epoch - 64ms/step
Epoch 11/50
448/448 - 26s - loss: 3.2602 - accuracy100: 0.3925 - val_loss: 3.3545 - val_accuracy100: 0.3272 - 26s/epoch - 59ms/step
Epoch 12/50
448/448 - 29s - loss: 3.2582 - accuracy100: 0.3951 - val_loss: 3.3539 - val_accuracy100: 0.3311 - 29s/epoch - 65ms/step
Epoch 13/50
448/448 - 27s - loss: 3.2552 - accuracy100: 0.3964 - val_loss: 3.3520 - val_accuracy100: 0.3296 - 27s/epoch - 61ms/step
Epoch 14/50
448/448 - 27s - loss: 3.2519 - accuracy100: 0.3990 - val_loss: 3.3446 - val_accuracy100: 0.3366 - 27s/epoch - 59ms/step
Epoch 15/50
448/448 - 29s - loss: 3.2487 - accuracy100: 0.4005 - val_loss: 3.3423 - val_accuracy100: 0.3418 - 29s/epoch - 64ms/step
Epoch 16/50
448/448 - 27s - loss: 3.2499 - accuracy100: 0.3990 - val_loss: 3.3380 - val_accuracy100: 0.3395 - 27s/epoch - 59ms/step
Epoch 17/50
448/448 - 30s - loss: 3.2456 - accuracy100: 0.4017 - val_loss: 3.3301 - val_accuracy100: 0.3468 - 30s/epoch - 66ms/step
Epoch 18/50
448/448 - 29s - loss: 3.2442 - accuracy100: 0.4035 - val_loss: 3.3266 - val_accuracy100: 0.3398 - 29s/epoch - 65ms/step
Epoch 19/50
448/448 - 29s - loss: 3.2429 - accuracy100: 0.4022 - val_loss: 3.3342 - val_accuracy100: 0.3465 - 29s/epoch - 65ms/step
Epoch 20/50
448/448 - 31s - loss: 3.2408 - accuracy100: 0.4036 - val_loss: 3.3407 - val_accuracy100: 0.3399 - 31s/epoch - 69ms/step
Epoch 21/50
448/448 - 29s - loss: 3.2378 - accuracy100: 0.4083 - val_loss: 3.3331 - val_accuracy100: 0.3390 - 29s/epoch - 65ms/step
Epoch 22/50
448/448 - 31s - loss: 3.2368 - accuracy100: 0.4060 - val_loss: 3.3350 - val_accuracy100: 0.3415 - 31s/epoch - 69ms/step
Epoch 23/50
448/448 - 29s - loss: 3.2336 - accuracy100: 0.4085 - val_loss: 3.3399 - val_accuracy100: 0.3326 - 29s/epoch - 64ms/step
Epoch 24/50
448/448 - 30s - loss: 3.2311 - accuracy100: 0.4090 - val_loss: 3.3491 - val_accuracy100: 0.3350 - 30s/epoch - 68ms/step
Epoch 25/50
448/448 - 30s - loss: 3.2293 - accuracy100: 0.4105 - val_loss: 3.3396 - val_accuracy100: 0.3392 - 30s/epoch - 67ms/step
Epoch 26/50
448/448 - 31s - loss: 3.2262 - accuracy100: 0.4119 - val_loss: 3.3491 - val_accuracy100: 0.3393 - 31s/epoch - 68ms/step
Epoch 27/50
448/448 - 31s - loss: 3.2262 - accuracy100: 0.4114 - val_loss: 3.3484 - val_accuracy100: 0.3398 - 31s/epoch - 69ms/step
Epoch 28/50
448/448 - 28s - loss: 3.2215 - accuracy100: 0.4133 - val_loss: 3.3519 - val_accuracy100: 0.3442 - 28s/epoch - 63ms/step
testing model: results/CHTR/W6/deepLOB_L1/h100
Evaluating performance on  test set...
1095/1095 - 26s - 26s/epoch - 24ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1169202
{'0': {'precision': 0.3954358937441509, 'recall': 0.05550727566693613, 'f1-score': 0.0973496025733046, 'support': 98960}, '1': {'precision': 0.27362423441043865, 'recall': 0.7823900857259134, 'f1-score': 0.405450729473874, 'support': 76173}, '2': {'precision': 0.410625723260043, 'recall': 0.18932695605777658, 'f1-score': 0.25916216709706025, 'support': 104956}, 'accuracy': 0.30333572543013115, 'macro avg': {'precision': 0.3598952838048775, 'recall': 0.34240810581687536, 'f1-score': 0.25398749971474627, 'support': 280089}, 'weighted avg': {'precision': 0.3679999866583428, 'recall': 0.30333572543013115, 'f1-score': 0.24177579089756, 'support': 280089}}
[[ 5493 77738 15729]
 [ 3784 59597 12792]
 [ 4614 80471 19871]]
Evaluating performance on  train set...
448/448 - 14s - 14s/epoch - 32ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1034435
{'0': {'precision': 0.37806937767961546, 'recall': 0.07623588588195226, 'f1-score': 0.1268858463416761, 'support': 38171}, '1': {'precision': 0.3361222642560401, 'recall': 0.7646111609735494, 'f1-score': 0.46696653124395426, 'support': 37882}, '2': {'precision': 0.3790653844295172, 'recall': 0.20368206486458415, 'f1-score': 0.2649820958043375, 'support': 38511}, 'accuracy': 0.34669704270102303, 'macro avg': {'precision': 0.3644190087883909, 'recall': 0.348176370573362, 'f1-score': 0.28627815779665594, 'support': 114564}, 'weighted avg': {'precision': 0.364533857492066, 'recall': 0.34669704270102303, 'f1-score': 0.28575915007168423, 'support': 114564}}
[[ 2910 28827  6434]
 [ 2502 28965  6415]
 [ 2285 28382  7844]]
Evaluating performance on  val set...
136/136 - 5s - 5s/epoch - 35ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1090845
{'0': {'precision': 0.38349954669084313, 'recall': 0.07251842962454998, 'f1-score': 0.12197231833910036, 'support': 11666}, '1': {'precision': 0.319908122450596, 'recall': 0.7429412305711395, 'f1-score': 0.44723729376591737, 'support': 10873}, '2': {'precision': 0.38832695462001093, 'recall': 0.23222167729279058, 'f1-score': 0.29063938618925833, 'support': 12234}, 'accuracy': 0.3383372156558249, 'macro avg': {'precision': 0.3639115412538167, 'recall': 0.34922711249616006, 'f1-score': 0.2866163327647587, 'support': 34773}, 'weighted avg': {'precision': 0.36531385528777843, 'recall': 0.3383372156558249, 'f1-score': 0.28301907835102375, 'support': 34773}}
[[ 846 8470 2350]
 [ 670 8078 2125]
 [ 690 8703 2841]]
training model: results/CHTR/W6/deepLOB_L1/h200
Epoch 1/50
448/448 - 32s - loss: 3.3244 - accuracy200: 0.3614 - val_loss: 3.4507 - val_accuracy200: 0.3091 - 32s/epoch - 71ms/step
Epoch 2/50
448/448 - 28s - loss: 3.3028 - accuracy200: 0.3620 - val_loss: 3.4263 - val_accuracy200: 0.3029 - 28s/epoch - 62ms/step
Epoch 3/50
448/448 - 30s - loss: 3.2895 - accuracy200: 0.3680 - val_loss: 3.4433 - val_accuracy200: 0.2971 - 30s/epoch - 66ms/step
Epoch 4/50
448/448 - 30s - loss: 3.2817 - accuracy200: 0.3733 - val_loss: 3.4253 - val_accuracy200: 0.2966 - 30s/epoch - 66ms/step
Epoch 5/50
448/448 - 31s - loss: 3.2749 - accuracy200: 0.3809 - val_loss: 3.4189 - val_accuracy200: 0.2995 - 31s/epoch - 69ms/step
Epoch 6/50
448/448 - 29s - loss: 3.2715 - accuracy200: 0.3837 - val_loss: 3.4131 - val_accuracy200: 0.3019 - 29s/epoch - 65ms/step
Epoch 7/50
448/448 - 30s - loss: 3.2650 - accuracy200: 0.3888 - val_loss: 3.4001 - val_accuracy200: 0.3058 - 30s/epoch - 68ms/step
Epoch 8/50
448/448 - 27s - loss: 3.2642 - accuracy200: 0.3909 - val_loss: 3.3852 - val_accuracy200: 0.3171 - 27s/epoch - 61ms/step
Epoch 9/50
448/448 - 28s - loss: 3.2595 - accuracy200: 0.3948 - val_loss: 3.3880 - val_accuracy200: 0.3183 - 28s/epoch - 62ms/step
Epoch 10/50
448/448 - 28s - loss: 3.2530 - accuracy200: 0.3978 - val_loss: 3.3965 - val_accuracy200: 0.3242 - 28s/epoch - 63ms/step
Epoch 11/50
448/448 - 29s - loss: 3.2522 - accuracy200: 0.3993 - val_loss: 3.3900 - val_accuracy200: 0.3247 - 29s/epoch - 64ms/step
Epoch 12/50
448/448 - 27s - loss: 3.2475 - accuracy200: 0.4023 - val_loss: 3.3786 - val_accuracy200: 0.3260 - 27s/epoch - 61ms/step
Epoch 13/50
448/448 - 30s - loss: 3.2467 - accuracy200: 0.4027 - val_loss: 3.3771 - val_accuracy200: 0.3258 - 30s/epoch - 66ms/step
Epoch 14/50
448/448 - 29s - loss: 3.2450 - accuracy200: 0.4029 - val_loss: 3.3832 - val_accuracy200: 0.3357 - 29s/epoch - 66ms/step
Epoch 15/50
448/448 - 28s - loss: 3.2438 - accuracy200: 0.4027 - val_loss: 3.3679 - val_accuracy200: 0.3385 - 28s/epoch - 62ms/step
Epoch 16/50
448/448 - 32s - loss: 3.2402 - accuracy200: 0.4053 - val_loss: 3.3675 - val_accuracy200: 0.3370 - 32s/epoch - 71ms/step
Epoch 17/50
448/448 - 30s - loss: 3.2346 - accuracy200: 0.4088 - val_loss: 3.3489 - val_accuracy200: 0.3370 - 30s/epoch - 66ms/step
Epoch 18/50
448/448 - 30s - loss: 3.2351 - accuracy200: 0.4072 - val_loss: 3.3524 - val_accuracy200: 0.3312 - 30s/epoch - 67ms/step
Epoch 19/50
448/448 - 26s - loss: 3.2394 - accuracy200: 0.4019 - val_loss: 3.3653 - val_accuracy200: 0.3274 - 26s/epoch - 58ms/step
Epoch 20/50
448/448 - 28s - loss: 3.2325 - accuracy200: 0.4087 - val_loss: 3.3660 - val_accuracy200: 0.3393 - 28s/epoch - 62ms/step
Epoch 21/50
448/448 - 31s - loss: 3.2308 - accuracy200: 0.4092 - val_loss: 3.3886 - val_accuracy200: 0.3253 - 31s/epoch - 69ms/step
Epoch 22/50
448/448 - 29s - loss: 3.2337 - accuracy200: 0.4081 - val_loss: 3.3792 - val_accuracy200: 0.3328 - 29s/epoch - 64ms/step
Epoch 23/50
448/448 - 29s - loss: 3.2306 - accuracy200: 0.4087 - val_loss: 3.3931 - val_accuracy200: 0.3408 - 29s/epoch - 64ms/step
Epoch 24/50
448/448 - 30s - loss: 3.2272 - accuracy200: 0.4107 - val_loss: 3.3748 - val_accuracy200: 0.3373 - 30s/epoch - 66ms/step
Epoch 25/50
448/448 - 30s - loss: 3.2237 - accuracy200: 0.4130 - val_loss: 3.3865 - val_accuracy200: 0.3401 - 30s/epoch - 66ms/step
Epoch 26/50
448/448 - 28s - loss: 3.2205 - accuracy200: 0.4132 - val_loss: 3.3864 - val_accuracy200: 0.3477 - 28s/epoch - 63ms/step
Epoch 27/50
448/448 - 29s - loss: 3.2172 - accuracy200: 0.4155 - val_loss: 3.3739 - val_accuracy200: 0.3560 - 29s/epoch - 64ms/step
testing model: results/CHTR/W6/deepLOB_L1/h200
Evaluating performance on  test set...
1095/1095 - 27s - 27s/epoch - 25ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1247379
{'0': {'precision': 0.4013428336530556, 'recall': 0.05939911377901259, 'f1-score': 0.10348269252850721, 'support': 98621}, '1': {'precision': 0.2639515841936632, 'recall': 0.5056329959900706, 'f1-score': 0.34684330676247144, 'support': 73318}, '2': {'precision': 0.3835800484633286, 'recall': 0.44349514563106796, 'f1-score': 0.4113674081125934, 'support': 108150}, 'accuracy': 0.32451827811874084, 'macro avg': {'precision': 0.34962482210334916, 'recall': 0.3361757518000504, 'f1-score': 0.2872311358011907, 'support': 280089}, 'weighted avg': {'precision': 0.35851967085075814, 'recall': 0.32451827811874084, 'f1-score': 0.28606910436483324, 'support': 280089}}
[[ 5858 48951 43812]
 [ 2979 37072 33267]
 [ 5759 54427 47964]]
Evaluating performance on  train set...
448/448 - 16s - 16s/epoch - 36ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1167208
{'0': {'precision': 0.33371149809972206, 'recall': 0.1554334328515945, 'f1-score': 0.21208406936082771, 'support': 37849}, '1': {'precision': 0.34609827817721345, 'recall': 0.5375254085161426, 'f1-score': 0.4210765762971235, 'support': 37881}, '2': {'precision': 0.34803947299354365, 'recall': 0.3414791162383478, 'f1-score': 0.3447280856816055, 'support': 38834}, 'accuracy': 0.34483781990852275, 'macro avg': {'precision': 0.34261641642349305, 'recall': 0.34481265253536164, 'f1-score': 0.32596291044651887, 'support': 114564}, 'weighted avg': {'precision': 0.3426640154100649, 'recall': 0.34483781990852275, 'f1-score': 0.32615081707437565, 'support': 114564}}
[[ 5883 18476 13490]
 [ 6168 20362 11351]
 [ 5578 19995 13261]]
Evaluating performance on  val set...
136/136 - 4s - 4s/epoch - 30ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.117573
{'0': {'precision': 0.38553938553938555, 'recall': 0.1431143886125879, 'f1-score': 0.2087424176099056, 'support': 11662}, '1': {'precision': 0.30540295227631015, 'recall': 0.623524822003316, 'f1-score': 0.40999166292567174, 'support': 10253}, '2': {'precision': 0.3901797918199979, 'recall': 0.2886140923938404, 'f1-score': 0.33179847109839505, 'support': 12858}, 'accuracy': 0.33856727921088203, 'macro avg': {'precision': 0.36037404321189787, 'recall': 0.35175110100324813, 'f1-score': 0.3168441838779908, 'support': 34773}, 'weighted avg': {'precision': 0.3636266225827756, 'recall': 0.33856727921088203, 'f1-score': 0.31358419853123964, 'support': 34773}}
[[1669 6885 3108]
 [1168 6393 2692]
 [1492 7655 3711]]
training model: results/CHTR/W6/deepLOB_L1/h300
Epoch 1/50
448/448 - 34s - loss: 3.3269 - accuracy300: 0.3661 - val_loss: 3.4789 - val_accuracy300: 0.3056 - 34s/epoch - 76ms/step
Epoch 2/50
448/448 - 28s - loss: 3.2986 - accuracy300: 0.3701 - val_loss: 3.4787 - val_accuracy300: 0.3035 - 28s/epoch - 63ms/step
Epoch 3/50
448/448 - 27s - loss: 3.2841 - accuracy300: 0.3749 - val_loss: 3.4343 - val_accuracy300: 0.3022 - 27s/epoch - 61ms/step
Epoch 4/50
448/448 - 27s - loss: 3.2762 - accuracy300: 0.3820 - val_loss: 3.4693 - val_accuracy300: 0.3009 - 27s/epoch - 60ms/step
Epoch 5/50
448/448 - 26s - loss: 3.2605 - accuracy300: 0.3955 - val_loss: 3.4860 - val_accuracy300: 0.3104 - 26s/epoch - 58ms/step
Epoch 6/50
448/448 - 31s - loss: 3.2572 - accuracy300: 0.3984 - val_loss: 3.4558 - val_accuracy300: 0.3243 - 31s/epoch - 69ms/step
Epoch 7/50
448/448 - 27s - loss: 3.2509 - accuracy300: 0.4004 - val_loss: 3.4255 - val_accuracy300: 0.3370 - 27s/epoch - 61ms/step
Epoch 8/50
448/448 - 29s - loss: 3.2439 - accuracy300: 0.4065 - val_loss: 3.4497 - val_accuracy300: 0.3374 - 29s/epoch - 65ms/step
Epoch 9/50
448/448 - 29s - loss: 3.2379 - accuracy300: 0.4083 - val_loss: 3.3987 - val_accuracy300: 0.3492 - 29s/epoch - 64ms/step
Epoch 10/50
448/448 - 30s - loss: 3.2338 - accuracy300: 0.4112 - val_loss: 3.4119 - val_accuracy300: 0.3505 - 30s/epoch - 67ms/step
Epoch 11/50
448/448 - 30s - loss: 3.2323 - accuracy300: 0.4105 - val_loss: 3.3844 - val_accuracy300: 0.3593 - 30s/epoch - 66ms/step
Epoch 12/50
448/448 - 31s - loss: 3.2268 - accuracy300: 0.4143 - val_loss: 3.4124 - val_accuracy300: 0.3499 - 31s/epoch - 70ms/step
Epoch 13/50
448/448 - 31s - loss: 3.2262 - accuracy300: 0.4132 - val_loss: 3.4022 - val_accuracy300: 0.3487 - 31s/epoch - 69ms/step
Epoch 14/50
448/448 - 30s - loss: 3.2228 - accuracy300: 0.4150 - val_loss: 3.3821 - val_accuracy300: 0.3541 - 30s/epoch - 67ms/step
Epoch 15/50
448/448 - 32s - loss: 3.2217 - accuracy300: 0.4147 - val_loss: 3.3805 - val_accuracy300: 0.3596 - 32s/epoch - 72ms/step
Epoch 16/50
448/448 - 29s - loss: 3.2151 - accuracy300: 0.4188 - val_loss: 3.3738 - val_accuracy300: 0.3663 - 29s/epoch - 65ms/step
Epoch 17/50
448/448 - 31s - loss: 3.2142 - accuracy300: 0.4210 - val_loss: 3.3557 - val_accuracy300: 0.3677 - 31s/epoch - 69ms/step
Epoch 18/50
448/448 - 30s - loss: 3.2099 - accuracy300: 0.4225 - val_loss: 3.3552 - val_accuracy300: 0.3593 - 30s/epoch - 68ms/step
Epoch 19/50
448/448 - 31s - loss: 3.2026 - accuracy300: 0.4243 - val_loss: 3.3718 - val_accuracy300: 0.3543 - 31s/epoch - 68ms/step
Epoch 20/50
448/448 - 32s - loss: 3.2021 - accuracy300: 0.4260 - val_loss: 3.3627 - val_accuracy300: 0.3583 - 32s/epoch - 71ms/step
Epoch 21/50
448/448 - 31s - loss: 3.1971 - accuracy300: 0.4284 - val_loss: 3.3917 - val_accuracy300: 0.3522 - 31s/epoch - 70ms/step
Epoch 22/50
448/448 - 31s - loss: 3.1937 - accuracy300: 0.4288 - val_loss: 3.3639 - val_accuracy300: 0.3653 - 31s/epoch - 70ms/step
Epoch 23/50
448/448 - 31s - loss: 3.1928 - accuracy300: 0.4299 - val_loss: 3.3662 - val_accuracy300: 0.3614 - 31s/epoch - 69ms/step
Epoch 24/50
448/448 - 30s - loss: 3.1868 - accuracy300: 0.4331 - val_loss: 3.3815 - val_accuracy300: 0.3626 - 30s/epoch - 68ms/step
Epoch 25/50
448/448 - 31s - loss: 3.1867 - accuracy300: 0.4333 - val_loss: 3.3793 - val_accuracy300: 0.3654 - 31s/epoch - 69ms/step
Epoch 26/50
448/448 - 32s - loss: 3.1791 - accuracy300: 0.4357 - val_loss: 3.3815 - val_accuracy300: 0.3647 - 32s/epoch - 71ms/step
Epoch 27/50
448/448 - 30s - loss: 3.1794 - accuracy300: 0.4338 - val_loss: 3.3696 - val_accuracy300: 0.3651 - 30s/epoch - 67ms/step
Epoch 28/50
448/448 - 31s - loss: 3.1763 - accuracy300: 0.4361 - val_loss: 3.3832 - val_accuracy300: 0.3628 - 31s/epoch - 70ms/step
testing model: results/CHTR/W6/deepLOB_L1/h300
Evaluating performance on  test set...
1095/1095 - 31s - 31s/epoch - 28ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1246188
{'0': {'precision': 0.3728964641689852, 'recall': 0.13897138025106456, 'f1-score': 0.20248170257703987, 'support': 99337}, '1': {'precision': 0.21885596343800678, 'recall': 0.08305011258898726, 'f1-score': 0.12040839087102433, 'support': 71499}, '2': {'precision': 0.392616330764671, 'recall': 0.7759969977941109, 'f1-score': 0.5214198512249799, 'support': 109253}, 'accuracy': 0.37317781133853883, 'macro avg': {'precision': 0.328122919457221, 'recall': 0.33267283021138755, 'f1-score': 0.28143664822434805, 'support': 280089}, 'weighted avg': {'precision': 0.34126620672729424, 'recall': 0.37317781133853883, 'f1-score': 0.3059373536042669, 'support': 280089}}
[[13805 11211 74321]
 [ 8726  5938 56835]
 [14490  9983 84780]]
Evaluating performance on  train set...
448/448 - 16s - 16s/epoch - 35ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1327906
{'0': {'precision': 0.32978303747534515, 'recall': 0.29103178641244676, 'f1-score': 0.30919798571794355, 'support': 37343}, '1': {'precision': 0.3706392275706533, 'recall': 0.2780847632392988, 'f1-score': 0.31775955045996285, 'support': 37823}, '2': {'precision': 0.35242621780541417, 'recall': 0.4761663028580131, 'f1-score': 0.40505673169309825, 'support': 39398}, 'accuracy': 0.3504242170315282, 'macro avg': {'precision': 0.35094949428380423, 'recall': 0.34842761750325285, 'f1-score': 0.3440047559570016, 'support': 114564}, 'weighted avg': {'precision': 0.3510584791203549, 'recall': 0.3504242170315282, 'f1-score': 0.34498991806289087, 'support': 114564}}
[[10868  7874 18601]
 [11435 10518 15870]
 [10652  9986 18760]]
Evaluating performance on  val set...
136/136 - 4s - 4s/epoch - 30ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1182263
{'0': {'precision': 0.3719841555635578, 'recall': 0.2657804459691252, 'f1-score': 0.3100395177830023, 'support': 11660}, '1': {'precision': 0.3145952836201402, 'recall': 0.48914874640769, 'f1-score': 0.38291765253481247, 'support': 10091}, '2': {'precision': 0.41610863095238093, 'recall': 0.3435724159115343, 'f1-score': 0.3763775553125263, 'support': 13022}, 'accuracy': 0.3597331262761338, 'macro avg': {'precision': 0.36756269004535963, 'recall': 0.3661672027627832, 'f1-score': 0.35644490854344707, 'support': 34773}, 'weighted avg': {'precision': 0.3718541067248677, 'recall': 0.3597331262761338, 'f1-score': 0.35603115446922373, 'support': 34773}}
[[3099 5171 3390]
 [2267 4936 2888]
 [2965 5583 4474]]
training model: results/CHTR/W6/deepLOB_L1/h500
Epoch 1/50
448/448 - 36s - loss: 3.3244 - accuracy500: 0.3701 - val_loss: 3.5047 - val_accuracy500: 0.3110 - 36s/epoch - 80ms/step
Epoch 2/50
448/448 - 31s - loss: 3.3056 - accuracy500: 0.3692 - val_loss: 3.4707 - val_accuracy500: 0.3035 - 31s/epoch - 69ms/step
Epoch 3/50
448/448 - 30s - loss: 3.2860 - accuracy500: 0.3785 - val_loss: 3.5068 - val_accuracy500: 0.2930 - 30s/epoch - 67ms/step
Epoch 4/50
448/448 - 32s - loss: 3.2832 - accuracy500: 0.3778 - val_loss: 3.3985 - val_accuracy500: 0.3093 - 32s/epoch - 71ms/step
Epoch 5/50
448/448 - 31s - loss: 3.2618 - accuracy500: 0.3932 - val_loss: 3.3769 - val_accuracy500: 0.3377 - 31s/epoch - 70ms/step
Epoch 6/50
448/448 - 29s - loss: 3.2451 - accuracy500: 0.4049 - val_loss: 3.4175 - val_accuracy500: 0.3439 - 29s/epoch - 66ms/step
Epoch 7/50
448/448 - 31s - loss: 3.2373 - accuracy500: 0.4078 - val_loss: 3.3802 - val_accuracy500: 0.3577 - 31s/epoch - 68ms/step
Epoch 8/50
448/448 - 30s - loss: 3.2259 - accuracy500: 0.4174 - val_loss: 3.4318 - val_accuracy500: 0.3653 - 30s/epoch - 66ms/step
Epoch 9/50
448/448 - 31s - loss: 3.2200 - accuracy500: 0.4214 - val_loss: 3.4392 - val_accuracy500: 0.3646 - 31s/epoch - 70ms/step
Epoch 10/50
448/448 - 32s - loss: 3.2184 - accuracy500: 0.4199 - val_loss: 3.4350 - val_accuracy500: 0.3615 - 32s/epoch - 72ms/step
Epoch 11/50
448/448 - 32s - loss: 3.2131 - accuracy500: 0.4238 - val_loss: 3.4586 - val_accuracy500: 0.3680 - 32s/epoch - 72ms/step
Epoch 12/50
448/448 - 32s - loss: 3.2040 - accuracy500: 0.4275 - val_loss: 3.4387 - val_accuracy500: 0.3660 - 32s/epoch - 71ms/step
Epoch 13/50
448/448 - 33s - loss: 3.2021 - accuracy500: 0.4271 - val_loss: 3.4504 - val_accuracy500: 0.3686 - 33s/epoch - 73ms/step
Epoch 14/50
448/448 - 33s - loss: 3.2009 - accuracy500: 0.4306 - val_loss: 3.4527 - val_accuracy500: 0.3674 - 33s/epoch - 73ms/step
Epoch 15/50
448/448 - 31s - loss: 3.1905 - accuracy500: 0.4336 - val_loss: 3.4460 - val_accuracy500: 0.3665 - 31s/epoch - 70ms/step
testing model: results/CHTR/W6/deepLOB_L1/h500
Evaluating performance on  test set...
1095/1095 - 33s - 33s/epoch - 30ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1219122
{'0': {'precision': 0.4019834979474048, 'recall': 0.09922247303737146, 'f1-score': 0.15915930414071677, 'support': 99675}, '1': {'precision': 0.2419323759110436, 'recall': 0.3082077051926298, 'f1-score': 0.27107794888077474, 'support': 69252}, '2': {'precision': 0.3990063552608766, 'recall': 0.6003760277792771, 'f1-score': 0.479403789171231, 'support': 111162}, 'accuracy': 0.349792387419713, 'macro avg': {'precision': 0.347640743039775, 'recall': 0.33593540200309285, 'f1-score': 0.30321368073090754, 'support': 280089}, 'weighted avg': {'precision': 0.36122928968295337, 'recall': 0.349792387419713, 'f1-score': 0.31393013566391303, 'support': 280089}}
[[ 9890 31638 58147]
 [ 5531 21344 42377]
 [ 9182 35241 66739]]
Evaluating performance on  train set...
448/448 - 15s - 15s/epoch - 34ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1225513
{'0': {'precision': 0.32705937028000465, 'recall': 0.15470007968565383, 'f1-score': 0.21004719532896823, 'support': 36393}, '1': {'precision': 0.3416031198857899, 'recall': 0.519390105090399, 'f1-score': 0.41214094417896335, 'support': 37777}, '2': {'precision': 0.3577370214471838, 'recall': 0.3534683368817151, 'f1-score': 0.3555898687520235, 'support': 40394}, 'accuracy': 0.34503858105513074, 'macro avg': {'precision': 0.3421331705376594, 'recall': 0.34251950721925595, 'f1-score': 0.32592600275331834, 'support': 114564}, 'weighted avg': {'precision': 0.34267171159232607, 'recall': 0.34503858105513074, 'f1-score': 0.3280035018524587, 'support': 114564}}
[[ 5630 17084 13679]
 [ 6201 19621 11955]
 [ 5383 20733 14278]]
Evaluating performance on  val set...
136/136 - 5s - 5s/epoch - 37ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1251508
{'0': {'precision': 0.3686981170277384, 'recall': 0.15792212297285577, 'f1-score': 0.22112932604735885, 'support': 11531}, '1': {'precision': 0.2925552539744087, 'recall': 0.6012551050901485, 'f1-score': 0.3935965570082488, 'support': 10039}, '2': {'precision': 0.4308845903064551, 'recall': 0.3003105354843596, 'f1-score': 0.3539388529346128, 'support': 13203}, 'accuracy': 0.33997641848560667, 'macro avg': {'precision': 0.3640459871028674, 'recall': 0.3531625878491213, 'f1-score': 0.3228882453300735, 'support': 34773}, 'weighted avg': {'precision': 0.37032724895499575, 'recall': 0.33997641848560667, 'f1-score': 0.32134738934672297, 'support': 34773}}
[[1821 6985 2725]
 [1491 6036 2512]
 [1627 7611 3965]]
training model: results/CHTR/W6/deepLOB_L1/h1000
Epoch 1/50
448/448 - 35s - loss: 3.3261 - accuracy1000: 0.3729 - val_loss: 3.4514 - val_accuracy1000: 0.3460 - 35s/epoch - 78ms/step
Epoch 2/50
448/448 - 30s - loss: 3.2827 - accuracy1000: 0.3912 - val_loss: 3.4719 - val_accuracy1000: 0.3322 - 30s/epoch - 68ms/step
Epoch 3/50
448/448 - 29s - loss: 3.2745 - accuracy1000: 0.3875 - val_loss: 3.4094 - val_accuracy1000: 0.3693 - 29s/epoch - 66ms/step
Epoch 4/50
448/448 - 29s - loss: 3.2285 - accuracy1000: 0.4057 - val_loss: 3.4009 - val_accuracy1000: 0.3744 - 29s/epoch - 64ms/step
Epoch 5/50
448/448 - 28s - loss: 3.2050 - accuracy1000: 0.4177 - val_loss: 3.4176 - val_accuracy1000: 0.3783 - 28s/epoch - 62ms/step
Epoch 6/50
448/448 - 28s - loss: 3.1815 - accuracy1000: 0.4271 - val_loss: 3.4427 - val_accuracy1000: 0.3750 - 28s/epoch - 62ms/step
Epoch 7/50
448/448 - 29s - loss: 3.1724 - accuracy1000: 0.4382 - val_loss: 3.4529 - val_accuracy1000: 0.3727 - 29s/epoch - 66ms/step
Epoch 8/50
448/448 - 28s - loss: 3.1651 - accuracy1000: 0.4442 - val_loss: 3.4737 - val_accuracy1000: 0.3650 - 28s/epoch - 63ms/step
Epoch 9/50
448/448 - 30s - loss: 3.1592 - accuracy1000: 0.4452 - val_loss: 3.4895 - val_accuracy1000: 0.3493 - 30s/epoch - 66ms/step
Epoch 10/50
448/448 - 30s - loss: 3.1516 - accuracy1000: 0.4475 - val_loss: 3.4714 - val_accuracy1000: 0.3570 - 30s/epoch - 68ms/step
Epoch 11/50
448/448 - 28s - loss: 3.1463 - accuracy1000: 0.4504 - val_loss: 3.4928 - val_accuracy1000: 0.3536 - 28s/epoch - 63ms/step
Epoch 12/50
448/448 - 30s - loss: 3.1336 - accuracy1000: 0.4555 - val_loss: 3.4992 - val_accuracy1000: 0.3703 - 30s/epoch - 67ms/step
Epoch 13/50
448/448 - 32s - loss: 3.1249 - accuracy1000: 0.4585 - val_loss: 3.4913 - val_accuracy1000: 0.3672 - 32s/epoch - 71ms/step
Epoch 14/50
448/448 - 33s - loss: 3.1170 - accuracy1000: 0.4612 - val_loss: 3.5007 - val_accuracy1000: 0.3787 - 33s/epoch - 73ms/step
testing model: results/CHTR/W6/deepLOB_L1/h1000
Evaluating performance on  test set...
1095/1095 - 32s - 32s/epoch - 29ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1949166
{'0': {'precision': 0.4843114019269411, 'recall': 0.09474851325471223, 'f1-score': 0.1584906296630388, 'support': 99210}, '1': {'precision': 0.26631647766981537, 'recall': 0.15540353877524174, 'f1-score': 0.19627488120160835, 'support': 76015}, '2': {'precision': 0.3800936562455217, 'recall': 0.7840917760146475, 'f1-score': 0.5119945701413818, 'support': 104864}, 'accuracy': 0.36929690205613214, 'macro avg': {'precision': 0.37690717861409273, 'recall': 0.3447479426815338, 'f1-score': 0.28892002700200964, 'support': 280089}, 'weighted avg': {'precision': 0.38612984588389127, 'recall': 0.36929690205613214, 'f1-score': 0.3010953270807358, 'support': 280089}}
[[ 9400 16140 73670]
 [ 3772 11813 60430]
 [ 6237 16404 82223]]
Evaluating performance on  train set...
448/448 - 12s - 12s/epoch - 27ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.162841
{'0': {'precision': 0.3163249480442942, 'recall': 0.29294496150752614, 'f1-score': 0.3041863656023027, 'support': 34812}, '1': {'precision': 0.3604551676933607, 'recall': 0.2242806569245921, 'f1-score': 0.2765116088276315, 'support': 37569}, '2': {'precision': 0.37184685066752615, 'recall': 0.5196406135172937, 'f1-score': 0.4334928608155678, 'support': 42183}, 'accuracy': 0.35389825774239725, 'macro avg': {'precision': 0.34954232213506037, 'recall': 0.34562207731647066, 'f1-score': 0.3380636117485007, 'support': 114564}, 'weighted avg': {'precision': 0.35124000548250844, 'recall': 0.35389825774239725, 'f1-score': 0.34272223158388104, 'support': 114564}}
[[10198  5824 18790]
 [10904  8426 18239]
 [11137  9126 21920]]
Evaluating performance on  val set...
136/136 - 4s - 4s/epoch - 27ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1238092
{'0': {'precision': 0.3973189140475386, 'recall': 0.31482638578952066, 'f1-score': 0.35129482071713153, 'support': 11203}, '1': {'precision': 0.2848473172141412, 'recall': 0.2902149376778879, 'f1-score': 0.28750607681088963, 'support': 10189}, '2': {'precision': 0.42275217531421205, 'recall': 0.49017263283760554, 'f1-score': 0.45397286821705424, 'support': 13381}, 'accuracy': 0.3750898685761942, 'macro avg': {'precision': 0.3683061355252973, 'recall': 0.36507131876833804, 'f1-score': 0.3642579219150251, 'support': 34773}, 'weighted avg': {'precision': 0.37415005800618095, 'recall': 0.3750898685761942, 'f1-score': 0.37211532633746247, 'support': 34773}}
[[3527 3485 4191]
 [2467 2957 4765]
 [2883 3939 6559]]
training model: results/CHTR/W6/deepOF_L1/h10
Epoch 1/50
448/448 - 29s - loss: 3.2864 - accuracy10: 0.3815 - val_loss: 3.2669 - val_accuracy10: 0.3870 - 29s/epoch - 66ms/step
Epoch 2/50
448/448 - 26s - loss: 3.2428 - accuracy10: 0.4071 - val_loss: 3.2432 - val_accuracy10: 0.3963 - 26s/epoch - 59ms/step
Epoch 3/50
448/448 - 27s - loss: 3.2257 - accuracy10: 0.4119 - val_loss: 3.2314 - val_accuracy10: 0.4091 - 27s/epoch - 59ms/step
Epoch 4/50
448/448 - 28s - loss: 3.2155 - accuracy10: 0.4173 - val_loss: 3.2309 - val_accuracy10: 0.4085 - 28s/epoch - 63ms/step
Epoch 5/50
448/448 - 25s - loss: 3.2072 - accuracy10: 0.4210 - val_loss: 3.2265 - val_accuracy10: 0.4089 - 25s/epoch - 57ms/step
Epoch 6/50
448/448 - 28s - loss: 3.2028 - accuracy10: 0.4228 - val_loss: 3.2254 - val_accuracy10: 0.4123 - 28s/epoch - 63ms/step
Epoch 7/50
448/448 - 26s - loss: 3.1983 - accuracy10: 0.4254 - val_loss: 3.2227 - val_accuracy10: 0.4113 - 26s/epoch - 59ms/step
Epoch 8/50
448/448 - 26s - loss: 3.1938 - accuracy10: 0.4270 - val_loss: 3.2221 - val_accuracy10: 0.4126 - 26s/epoch - 57ms/step
Epoch 9/50
448/448 - 26s - loss: 3.1898 - accuracy10: 0.4300 - val_loss: 3.2208 - val_accuracy10: 0.4140 - 26s/epoch - 59ms/step
Epoch 10/50
448/448 - 27s - loss: 3.1856 - accuracy10: 0.4305 - val_loss: 3.2205 - val_accuracy10: 0.4132 - 27s/epoch - 60ms/step
Epoch 11/50
448/448 - 27s - loss: 3.1812 - accuracy10: 0.4323 - val_loss: 3.2187 - val_accuracy10: 0.4132 - 27s/epoch - 60ms/step
Epoch 12/50
448/448 - 27s - loss: 3.1781 - accuracy10: 0.4348 - val_loss: 3.2173 - val_accuracy10: 0.4138 - 27s/epoch - 60ms/step
Epoch 13/50
448/448 - 28s - loss: 3.1751 - accuracy10: 0.4359 - val_loss: 3.2190 - val_accuracy10: 0.4151 - 28s/epoch - 62ms/step
Epoch 14/50
448/448 - 26s - loss: 3.1733 - accuracy10: 0.4355 - val_loss: 3.2153 - val_accuracy10: 0.4138 - 26s/epoch - 58ms/step
Epoch 15/50
448/448 - 27s - loss: 3.1686 - accuracy10: 0.4369 - val_loss: 3.2191 - val_accuracy10: 0.4141 - 27s/epoch - 61ms/step
Epoch 16/50
448/448 - 28s - loss: 3.1664 - accuracy10: 0.4388 - val_loss: 3.2193 - val_accuracy10: 0.4131 - 28s/epoch - 63ms/step
Epoch 17/50
448/448 - 28s - loss: 3.1632 - accuracy10: 0.4391 - val_loss: 3.2209 - val_accuracy10: 0.4135 - 28s/epoch - 62ms/step
Epoch 18/50
448/448 - 29s - loss: 3.1608 - accuracy10: 0.4417 - val_loss: 3.2212 - val_accuracy10: 0.4164 - 29s/epoch - 65ms/step
Epoch 19/50
448/448 - 28s - loss: 3.1572 - accuracy10: 0.4421 - val_loss: 3.2150 - val_accuracy10: 0.4140 - 28s/epoch - 63ms/step
Epoch 20/50
448/448 - 29s - loss: 3.1543 - accuracy10: 0.4436 - val_loss: 3.2184 - val_accuracy10: 0.4141 - 29s/epoch - 64ms/step
Epoch 21/50
448/448 - 28s - loss: 3.1508 - accuracy10: 0.4438 - val_loss: 3.2215 - val_accuracy10: 0.4136 - 28s/epoch - 62ms/step
Epoch 22/50
448/448 - 27s - loss: 3.1481 - accuracy10: 0.4463 - val_loss: 3.2217 - val_accuracy10: 0.4135 - 27s/epoch - 60ms/step
Epoch 23/50
448/448 - 25s - loss: 3.1462 - accuracy10: 0.4467 - val_loss: 3.2183 - val_accuracy10: 0.4128 - 25s/epoch - 56ms/step
Epoch 24/50
448/448 - 24s - loss: 3.1447 - accuracy10: 0.4469 - val_loss: 3.2206 - val_accuracy10: 0.4145 - 24s/epoch - 54ms/step
Epoch 25/50
448/448 - 26s - loss: 3.1403 - accuracy10: 0.4489 - val_loss: 3.2181 - val_accuracy10: 0.4132 - 26s/epoch - 58ms/step
Epoch 26/50
448/448 - 27s - loss: 3.1374 - accuracy10: 0.4507 - val_loss: 3.2179 - val_accuracy10: 0.4140 - 27s/epoch - 60ms/step
Epoch 27/50
448/448 - 27s - loss: 3.1358 - accuracy10: 0.4512 - val_loss: 3.2230 - val_accuracy10: 0.4147 - 27s/epoch - 60ms/step
Epoch 28/50
448/448 - 28s - loss: 3.1323 - accuracy10: 0.4525 - val_loss: 3.2298 - val_accuracy10: 0.4122 - 28s/epoch - 62ms/step
Epoch 29/50
448/448 - 27s - loss: 3.1293 - accuracy10: 0.4536 - val_loss: 3.2255 - val_accuracy10: 0.4135 - 27s/epoch - 60ms/step
testing model: results/CHTR/W6/deepOF_L1/h10
Evaluating performance on  test set...
1095/1095 - 29s - 29s/epoch - 26ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0807852
{'0': {'precision': 0.43860194865072044, 'recall': 0.39322496464072987, 'f1-score': 0.4146757768802945, 'support': 100398}, '1': {'precision': 0.3129952650818184, 'recall': 0.35088973844165133, 'f1-score': 0.3308609958506224, 'support': 72718}, '2': {'precision': 0.44682223102504814, 'recall': 0.45343467205145466, 'f1-score': 0.450104167149996, 'support': 106968}, 'accuracy': 0.4052284314705588, 'macro avg': {'precision': 0.39947314825252905, 'recall': 0.3991831250446119, 'f1-score': 0.3985469799603043, 'support': 280084}, 'weighted avg': {'precision': 0.40913021998808236, 'recall': 0.4052284314705588, 'f1-score': 0.40644560594391016, 'support': 280084}}
[[39479 26314 34605]
 [21759 25516 25443]
 [28773 29692 48503]]
Evaluating performance on  train set...
448/448 - 13s - 13s/epoch - 30ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0651104
{'0': {'precision': 0.43070192881288527, 'recall': 0.434579790835904, 'f1-score': 0.43263217027651213, 'support': 39873}, '1': {'precision': 0.43090165493627547, 'recall': 0.48986322106287505, 'f1-score': 0.45849462365591404, 'support': 36994}, '2': {'precision': 0.4253446940356313, 'recall': 0.36417657045840407, 'f1-score': 0.39239113346958027, 'support': 37696}, 'accuracy': 0.42926599338355315, 'macro avg': {'precision': 0.42898275926159735, 'recall': 0.4295398607857277, 'f1-score': 0.4278393091340021, 'support': 114563}, 'weighted avg': {'precision': 0.429003669741853, 'recall': 0.42926599338355315, 'f1-score': 0.42774254166032266, 'support': 114563}}
[[17328 12070 10475]
 [10800 18122  8072]
 [12104 11864 13728]]
Evaluating performance on  val set...
136/136 - 4s - 4s/epoch - 26ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0720986
{'0': {'precision': 0.4222957014643363, 'recall': 0.4330695947036977, 'f1-score': 0.4276147959183674, 'support': 12386}, '1': {'precision': 0.39293676982074377, 'recall': 0.4279747450218553, 'f1-score': 0.4097080156220941, 'support': 10295}, '2': {'precision': 0.43000552587953583, 'recall': 0.38612305656632484, 'f1-score': 0.406884531590414, 'support': 12092}, 'accuracy': 0.41523595893365545, 'macro avg': {'precision': 0.4150793323882053, 'recall': 0.4157224654306259, 'f1-score': 0.41473578104362513, 'support': 34773}, 'weighted avg': {'precision': 0.4162846295280009, 'recall': 0.41523595893365545, 'f1-score': 0.4151044959901545, 'support': 34773}}
[[5364 3467 3555]
 [3255 4406 2634]
 [4083 3340 4669]]
training model: results/CHTR/W6/deepOF_L1/h20
Epoch 1/50
448/448 - 31s - loss: 3.3050 - accuracy20: 0.3695 - val_loss: 3.2946 - val_accuracy20: 0.3600 - 31s/epoch - 70ms/step
Epoch 2/50
448/448 - 27s - loss: 3.2718 - accuracy20: 0.3877 - val_loss: 3.2838 - val_accuracy20: 0.3680 - 27s/epoch - 60ms/step
Epoch 3/50
448/448 - 26s - loss: 3.2569 - accuracy20: 0.3944 - val_loss: 3.2740 - val_accuracy20: 0.3811 - 26s/epoch - 57ms/step
Epoch 4/50
448/448 - 28s - loss: 3.2502 - accuracy20: 0.3980 - val_loss: 3.2670 - val_accuracy20: 0.3863 - 28s/epoch - 63ms/step
Epoch 5/50
448/448 - 29s - loss: 3.2440 - accuracy20: 0.4027 - val_loss: 3.2591 - val_accuracy20: 0.3900 - 29s/epoch - 64ms/step
Epoch 6/50
448/448 - 29s - loss: 3.2393 - accuracy20: 0.4057 - val_loss: 3.2596 - val_accuracy20: 0.3893 - 29s/epoch - 64ms/step
Epoch 7/50
448/448 - 28s - loss: 3.2346 - accuracy20: 0.4088 - val_loss: 3.2559 - val_accuracy20: 0.3903 - 28s/epoch - 62ms/step
Epoch 8/50
448/448 - 28s - loss: 3.2328 - accuracy20: 0.4080 - val_loss: 3.2521 - val_accuracy20: 0.3954 - 28s/epoch - 62ms/step
Epoch 9/50
448/448 - 27s - loss: 3.2294 - accuracy20: 0.4104 - val_loss: 3.2509 - val_accuracy20: 0.3956 - 27s/epoch - 60ms/step
Epoch 10/50
448/448 - 27s - loss: 3.2248 - accuracy20: 0.4127 - val_loss: 3.2470 - val_accuracy20: 0.3964 - 27s/epoch - 61ms/step
Epoch 11/50
448/448 - 28s - loss: 3.2207 - accuracy20: 0.4134 - val_loss: 3.2480 - val_accuracy20: 0.3963 - 28s/epoch - 62ms/step
Epoch 12/50
448/448 - 27s - loss: 3.2187 - accuracy20: 0.4155 - val_loss: 3.2503 - val_accuracy20: 0.3952 - 27s/epoch - 60ms/step
Epoch 13/50
448/448 - 26s - loss: 3.2150 - accuracy20: 0.4169 - val_loss: 3.2476 - val_accuracy20: 0.3960 - 26s/epoch - 59ms/step
Epoch 14/50
448/448 - 25s - loss: 3.2136 - accuracy20: 0.4172 - val_loss: 3.2469 - val_accuracy20: 0.3974 - 25s/epoch - 55ms/step
Epoch 15/50
448/448 - 27s - loss: 3.2099 - accuracy20: 0.4188 - val_loss: 3.2485 - val_accuracy20: 0.3941 - 27s/epoch - 61ms/step
Epoch 16/50
448/448 - 27s - loss: 3.2070 - accuracy20: 0.4210 - val_loss: 3.2449 - val_accuracy20: 0.3977 - 27s/epoch - 59ms/step
Epoch 17/50
448/448 - 28s - loss: 3.2041 - accuracy20: 0.4217 - val_loss: 3.2447 - val_accuracy20: 0.3952 - 28s/epoch - 63ms/step
Epoch 18/50
448/448 - 27s - loss: 3.2014 - accuracy20: 0.4233 - val_loss: 3.2435 - val_accuracy20: 0.3989 - 27s/epoch - 59ms/step
Epoch 19/50
448/448 - 28s - loss: 3.1989 - accuracy20: 0.4242 - val_loss: 3.2470 - val_accuracy20: 0.3971 - 28s/epoch - 62ms/step
Epoch 20/50
448/448 - 28s - loss: 3.1977 - accuracy20: 0.4248 - val_loss: 3.2448 - val_accuracy20: 0.3985 - 28s/epoch - 62ms/step
Epoch 21/50
448/448 - 26s - loss: 3.1942 - accuracy20: 0.4282 - val_loss: 3.2470 - val_accuracy20: 0.3968 - 26s/epoch - 58ms/step
Epoch 22/50
448/448 - 25s - loss: 3.1921 - accuracy20: 0.4267 - val_loss: 3.2469 - val_accuracy20: 0.3973 - 25s/epoch - 56ms/step
Epoch 23/50
448/448 - 27s - loss: 3.1893 - accuracy20: 0.4306 - val_loss: 3.2465 - val_accuracy20: 0.3969 - 27s/epoch - 61ms/step
Epoch 24/50
448/448 - 28s - loss: 3.1868 - accuracy20: 0.4306 - val_loss: 3.2511 - val_accuracy20: 0.3978 - 28s/epoch - 62ms/step
Epoch 25/50
448/448 - 28s - loss: 3.1847 - accuracy20: 0.4317 - val_loss: 3.2476 - val_accuracy20: 0.3985 - 28s/epoch - 63ms/step
Epoch 26/50
448/448 - 26s - loss: 3.1804 - accuracy20: 0.4335 - val_loss: 3.2563 - val_accuracy20: 0.3950 - 26s/epoch - 58ms/step
Epoch 27/50
448/448 - 27s - loss: 3.1793 - accuracy20: 0.4347 - val_loss: 3.2549 - val_accuracy20: 0.3951 - 27s/epoch - 60ms/step
Epoch 28/50
448/448 - 26s - loss: 3.1773 - accuracy20: 0.4352 - val_loss: 3.2559 - val_accuracy20: 0.3939 - 26s/epoch - 59ms/step
testing model: results/CHTR/W6/deepOF_L1/h20
Evaluating performance on  test set...
1095/1095 - 29s - 29s/epoch - 26ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0906862
{'0': {'precision': 0.4553202205492525, 'recall': 0.33865339116719245, 'f1-score': 0.3884152684184343, 'support': 101440}, '1': {'precision': 0.29698809855233854, 'recall': 0.46295618210667644, 'f1-score': 0.36184883480583635, 'support': 73737}, '2': {'precision': 0.4333273870579316, 'recall': 0.37048052084226984, 'f1-score': 0.3994470680733201, 'support': 104907}, 'accuracy': 0.38329929592550804, 'macro avg': {'precision': 0.3952119020531742, 'recall': 0.39069669803871293, 'f1-score': 0.3832370570991969, 'support': 280084}, 'weighted avg': {'precision': 0.40539899026562165, 'recall': 0.38329929592550804, 'f1-score': 0.3855532123606194, 'support': 280084}}
[[34353 37911 29176]
 [17950 34137 21650]
 [23145 42896 38866]]
Evaluating performance on  train set...
448/448 - 13s - 13s/epoch - 30ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0760894
{'0': {'precision': 0.42585738958795955, 'recall': 0.3950962687895821, 'f1-score': 0.4099005198300657, 'support': 39317}, '1': {'precision': 0.39538004211221667, 'recall': 0.5132238270050109, 'f1-score': 0.4466599036858246, 'support': 37319}, '2': {'precision': 0.42096208338955604, 'recall': 0.32902681467028766, 'f1-score': 0.3693596365304643, 'support': 37927}, 'accuracy': 0.4117036041304784, 'macro avg': {'precision': 0.41406650502991077, 'recall': 0.41244897015496024, 'f1-score': 0.4086400200154516, 'support': 114563}, 'weighted avg': {'precision': 0.41430873593334067, 'recall': 0.4117036041304784, 'f1-score': 0.4084535375164835, 'support': 114563}}
[[15534 14503  9280]
 [10281 19153  7885]
 [10662 14786 12479]]
Evaluating performance on  val set...
136/136 - 5s - 5s/epoch - 34ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0825762
{'0': {'precision': 0.41631799163179917, 'recall': 0.3750717036794231, 'f1-score': 0.39461999396473685, 'support': 12203}, '1': {'precision': 0.36148673612650556, 'recall': 0.46524013314312884, 'f1-score': 0.4068529607451763, 'support': 10515}, '2': {'precision': 0.425824712082764, 'recall': 0.3619245126503525, 'f1-score': 0.3912829021120129, 'support': 12055}, 'accuracy': 0.3977798866936991, 'macro avg': {'precision': 0.40120981328035626, 'recall': 0.4007454498243015, 'f1-score': 0.3975852856073086, 'support': 34773}, 'weighted avg': {'precision': 0.4030333415699184, 'recall': 0.3977798866936991, 'f1-score': 0.3971622251041764, 'support': 34773}}
[[4577 4386 3240]
 [2980 4892 2643]
 [3437 4255 4363]]
training model: results/CHTR/W6/deepOF_L1/h30
Epoch 1/50
448/448 - 33s - loss: 3.3124 - accuracy30: 0.3616 - val_loss: 3.3008 - val_accuracy30: 0.3550 - 33s/epoch - 75ms/step
Epoch 2/50
448/448 - 27s - loss: 3.2821 - accuracy30: 0.3778 - val_loss: 3.2916 - val_accuracy30: 0.3596 - 27s/epoch - 60ms/step
Epoch 3/50
448/448 - 27s - loss: 3.2714 - accuracy30: 0.3848 - val_loss: 3.2864 - val_accuracy30: 0.3639 - 27s/epoch - 60ms/step
Epoch 4/50
448/448 - 28s - loss: 3.2637 - accuracy30: 0.3883 - val_loss: 3.2784 - val_accuracy30: 0.3709 - 28s/epoch - 62ms/step
Epoch 5/50
448/448 - 25s - loss: 3.2600 - accuracy30: 0.3904 - val_loss: 3.2764 - val_accuracy30: 0.3738 - 25s/epoch - 56ms/step
Epoch 6/50
448/448 - 28s - loss: 3.2557 - accuracy30: 0.3935 - val_loss: 3.2722 - val_accuracy30: 0.3759 - 28s/epoch - 62ms/step
Epoch 7/50
448/448 - 28s - loss: 3.2528 - accuracy30: 0.3960 - val_loss: 3.2701 - val_accuracy30: 0.3788 - 28s/epoch - 62ms/step
Epoch 8/50
448/448 - 28s - loss: 3.2486 - accuracy30: 0.3971 - val_loss: 3.2670 - val_accuracy30: 0.3823 - 28s/epoch - 63ms/step
Epoch 9/50
448/448 - 27s - loss: 3.2459 - accuracy30: 0.4009 - val_loss: 3.2663 - val_accuracy30: 0.3845 - 27s/epoch - 61ms/step
Epoch 10/50
448/448 - 30s - loss: 3.2437 - accuracy30: 0.4003 - val_loss: 3.2660 - val_accuracy30: 0.3843 - 30s/epoch - 66ms/step
Epoch 11/50
448/448 - 27s - loss: 3.2407 - accuracy30: 0.4027 - val_loss: 3.2649 - val_accuracy30: 0.3849 - 27s/epoch - 60ms/step
Epoch 12/50
448/448 - 26s - loss: 3.2389 - accuracy30: 0.4040 - val_loss: 3.2641 - val_accuracy30: 0.3862 - 26s/epoch - 59ms/step
Epoch 13/50
448/448 - 30s - loss: 3.2350 - accuracy30: 0.4046 - val_loss: 3.2640 - val_accuracy30: 0.3871 - 30s/epoch - 67ms/step
Epoch 14/50
448/448 - 27s - loss: 3.2335 - accuracy30: 0.4066 - val_loss: 3.2665 - val_accuracy30: 0.3824 - 27s/epoch - 61ms/step
Epoch 15/50
448/448 - 27s - loss: 3.2310 - accuracy30: 0.4086 - val_loss: 3.2649 - val_accuracy30: 0.3843 - 27s/epoch - 60ms/step
Epoch 16/50
448/448 - 25s - loss: 3.2277 - accuracy30: 0.4103 - val_loss: 3.2686 - val_accuracy30: 0.3835 - 25s/epoch - 56ms/step
Epoch 17/50
448/448 - 25s - loss: 3.2259 - accuracy30: 0.4100 - val_loss: 3.2677 - val_accuracy30: 0.3832 - 25s/epoch - 56ms/step
Epoch 18/50
448/448 - 29s - loss: 3.2247 - accuracy30: 0.4112 - val_loss: 3.2696 - val_accuracy30: 0.3817 - 29s/epoch - 65ms/step
Epoch 19/50
448/448 - 28s - loss: 3.2221 - accuracy30: 0.4126 - val_loss: 3.2694 - val_accuracy30: 0.3808 - 28s/epoch - 62ms/step
Epoch 20/50
448/448 - 28s - loss: 3.2206 - accuracy30: 0.4137 - val_loss: 3.2767 - val_accuracy30: 0.3788 - 28s/epoch - 62ms/step
Epoch 21/50
448/448 - 29s - loss: 3.2175 - accuracy30: 0.4147 - val_loss: 3.2693 - val_accuracy30: 0.3848 - 29s/epoch - 66ms/step
Epoch 22/50
448/448 - 29s - loss: 3.2155 - accuracy30: 0.4170 - val_loss: 3.2657 - val_accuracy30: 0.3860 - 29s/epoch - 65ms/step
Epoch 23/50
448/448 - 28s - loss: 3.2125 - accuracy30: 0.4176 - val_loss: 3.2689 - val_accuracy30: 0.3856 - 28s/epoch - 62ms/step
testing model: results/CHTR/W6/deepOF_L1/h30
Evaluating performance on  test set...
1095/1095 - 27s - 27s/epoch - 25ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.092748
{'0': {'precision': 0.45802592496270034, 'recall': 0.33151371647661415, 'f1-score': 0.3846339528949274, 'support': 100937}, '1': {'precision': 0.2903577445248241, 'recall': 0.5083343342541805, 'f1-score': 0.3696012886072756, 'support': 74931}, '2': {'precision': 0.4348531195612046, 'recall': 0.3164677208873877, 'f1-score': 0.3663334444074198, 'support': 104216}, 'accuracy': 0.37322017680410163, 'macro avg': {'precision': 0.394412263016243, 'recall': 0.38543859053939417, 'f1-score': 0.37352289530320765, 'support': 280084}, 'weighted avg': {'precision': 0.40454724886512683, 'recall': 0.37322017680410163, 'f1-score': 0.3738028509388281, 'support': 280084}}
[[33462 43681 23794]
 [17772 38090 19069]
 [21823 49412 32981]]
Evaluating performance on  train set...
448/448 - 12s - 12s/epoch - 27ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0835655
{'0': {'precision': 0.4137286551694843, 'recall': 0.3778024876522459, 'f1-score': 0.39495025951557095, 'support': 38671}, '1': {'precision': 0.3738370033374974, 'recall': 0.530563641174914, 'f1-score': 0.43862047843540464, 'support': 37790}, '2': {'precision': 0.41823788890190106, 'recall': 0.281192588315574, 'f1-score': 0.3362890189739324, 'support': 38102}, 'accuracy': 0.39606155565060275, 'macro avg': {'precision': 0.40193451580296086, 'recall': 0.39651957238091123, 'f1-score': 0.38995325230830263, 'support': 114563}, 'weighted avg': {'precision': 0.40206961430063276, 'recall': 0.39606155565060275, 'f1-score': 0.38984553098945873, 'support': 114563}}
[[14610 16462  7599]
 [10436 20050  7304]
 [10267 17121 10714]]
Evaluating performance on  val set...
136/136 - 4s - 4s/epoch - 28ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0885304
{'0': {'precision': 0.4125514403292181, 'recall': 0.3665752513920053, 'f1-score': 0.3882068206820682, 'support': 12033}, '1': {'precision': 0.343782722513089, 'recall': 0.493842248754348, 'f1-score': 0.40537099201296445, 'support': 10637}, '2': {'precision': 0.424269969321668, 'recall': 0.3085185491200529, 'f1-score': 0.35725220053578266, 'support': 12103}, 'accuracy': 0.3852989388318523, 'macro avg': {'precision': 0.393534710721325, 'recall': 0.3896453497554688, 'f1-score': 0.3836100044102717, 'support': 34773}, 'weighted avg': {'precision': 0.3955939303354141, 'recall': 0.3852989388318523, 'f1-score': 0.3826833260976565, 'support': 34773}}
[[4411 4919 2703]
 [3020 5253 2364]
 [3261 5108 3734]]
training model: results/CHTR/W6/deepOF_L1/h50
Epoch 1/50
448/448 - 29s - loss: 3.3195 - accuracy50: 0.3542 - val_loss: 3.3212 - val_accuracy50: 0.3336 - 29s/epoch - 65ms/step
Epoch 2/50
448/448 - 29s - loss: 3.2911 - accuracy50: 0.3686 - val_loss: 3.3069 - val_accuracy50: 0.3405 - 29s/epoch - 65ms/step
Epoch 3/50
448/448 - 29s - loss: 3.2792 - accuracy50: 0.3756 - val_loss: 3.3032 - val_accuracy50: 0.3431 - 29s/epoch - 64ms/step
Epoch 4/50
448/448 - 27s - loss: 3.2760 - accuracy50: 0.3770 - val_loss: 3.2936 - val_accuracy50: 0.3495 - 27s/epoch - 60ms/step
Epoch 5/50
448/448 - 27s - loss: 3.2701 - accuracy50: 0.3812 - val_loss: 3.2872 - val_accuracy50: 0.3584 - 27s/epoch - 61ms/step
Epoch 6/50
448/448 - 28s - loss: 3.2676 - accuracy50: 0.3816 - val_loss: 3.2834 - val_accuracy50: 0.3622 - 28s/epoch - 63ms/step
Epoch 7/50
448/448 - 27s - loss: 3.2647 - accuracy50: 0.3839 - val_loss: 3.2802 - val_accuracy50: 0.3636 - 27s/epoch - 61ms/step
Epoch 8/50
448/448 - 30s - loss: 3.2622 - accuracy50: 0.3850 - val_loss: 3.2800 - val_accuracy50: 0.3642 - 30s/epoch - 66ms/step
Epoch 9/50
448/448 - 27s - loss: 3.2599 - accuracy50: 0.3874 - val_loss: 3.2777 - val_accuracy50: 0.3682 - 27s/epoch - 60ms/step
Epoch 10/50
448/448 - 28s - loss: 3.2570 - accuracy50: 0.3896 - val_loss: 3.2783 - val_accuracy50: 0.3671 - 28s/epoch - 62ms/step
Epoch 11/50
448/448 - 29s - loss: 3.2550 - accuracy50: 0.3905 - val_loss: 3.2763 - val_accuracy50: 0.3693 - 29s/epoch - 64ms/step
Epoch 12/50
448/448 - 26s - loss: 3.2534 - accuracy50: 0.3918 - val_loss: 3.2763 - val_accuracy50: 0.3721 - 26s/epoch - 58ms/step
Epoch 13/50
448/448 - 28s - loss: 3.2504 - accuracy50: 0.3944 - val_loss: 3.2788 - val_accuracy50: 0.3685 - 28s/epoch - 63ms/step
Epoch 14/50
448/448 - 31s - loss: 3.2495 - accuracy50: 0.3950 - val_loss: 3.2752 - val_accuracy50: 0.3744 - 31s/epoch - 70ms/step
Epoch 15/50
448/448 - 29s - loss: 3.2464 - accuracy50: 0.3970 - val_loss: 3.2767 - val_accuracy50: 0.3689 - 29s/epoch - 65ms/step
Epoch 16/50
448/448 - 28s - loss: 3.2449 - accuracy50: 0.3986 - val_loss: 3.2770 - val_accuracy50: 0.3729 - 28s/epoch - 63ms/step
Epoch 17/50
448/448 - 29s - loss: 3.2425 - accuracy50: 0.3998 - val_loss: 3.2793 - val_accuracy50: 0.3699 - 29s/epoch - 64ms/step
Epoch 18/50
448/448 - 30s - loss: 3.2414 - accuracy50: 0.4007 - val_loss: 3.2800 - val_accuracy50: 0.3693 - 30s/epoch - 66ms/step
Epoch 19/50
448/448 - 29s - loss: 3.2390 - accuracy50: 0.4032 - val_loss: 3.2806 - val_accuracy50: 0.3706 - 29s/epoch - 65ms/step
Epoch 20/50
448/448 - 29s - loss: 3.2370 - accuracy50: 0.4020 - val_loss: 3.2799 - val_accuracy50: 0.3746 - 29s/epoch - 66ms/step
Epoch 21/50
448/448 - 30s - loss: 3.2347 - accuracy50: 0.4031 - val_loss: 3.2811 - val_accuracy50: 0.3728 - 30s/epoch - 66ms/step
Epoch 22/50
448/448 - 29s - loss: 3.2323 - accuracy50: 0.4050 - val_loss: 3.2811 - val_accuracy50: 0.3719 - 29s/epoch - 65ms/step
Epoch 23/50
448/448 - 28s - loss: 3.2304 - accuracy50: 0.4071 - val_loss: 3.2857 - val_accuracy50: 0.3718 - 28s/epoch - 62ms/step
Epoch 24/50
448/448 - 30s - loss: 3.2272 - accuracy50: 0.4088 - val_loss: 3.2827 - val_accuracy50: 0.3739 - 30s/epoch - 66ms/step
testing model: results/CHTR/W6/deepOF_L1/h50
Evaluating performance on  test set...
1095/1095 - 34s - 34s/epoch - 31ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0916125
{'0': {'precision': 0.45316979351888814, 'recall': 0.3740303305611853, 'f1-score': 0.40981436713084, 'support': 100163}, '1': {'precision': 0.28719445218617307, 'recall': 0.45958496209040584, 'f1-score': 0.35349193857578143, 'support': 76234}, '2': {'precision': 0.44061841180604355, 'recall': 0.3204934080453673, 'f1-score': 0.37107634585106025, 'support': 103687}, 'accuracy': 0.3774974650462004, 'macro avg': {'precision': 0.39366088583703496, 'recall': 0.3847029002323195, 'f1-score': 0.3781275505192272, 'support': 280084}, 'weighted avg': {'precision': 0.40334767127406895, 'recall': 0.3774974650462004, 'f1-score': 0.3801435782571348, 'support': 280084}}
[[37464 41424 21275]
 [20285 35036 20913]
 [24922 45534 33231]]
Evaluating performance on  train set...
448/448 - 13s - 13s/epoch - 30ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0875891
{'0': {'precision': 0.400021142766531, 'recall': 0.3969265465607217, 'f1-score': 0.39846783641126216, 'support': 38133}, '1': {'precision': 0.3589315525876461, 'recall': 0.5357798646450869, 'f1-score': 0.4298778241973334, 'support': 38122}, '2': {'precision': 0.4355196770938446, 'recall': 0.22533152344157878, 'f1-score': 0.2969997247453895, 'support': 38308}, 'accuracy': 0.3857528172272025, 'macro avg': {'precision': 0.3981574574826739, 'recall': 0.3860126448824624, 'f1-score': 0.37511512845132833, 'support': 114563}, 'weighted avg': {'precision': 0.39821829626470473, 'recall': 0.3857528172272025, 'f1-score': 0.3749905455990833, 'support': 114563}}
[[15136 17692  5305]
 [11814 20425  5883]
 [10888 18788  8632]]
Evaluating performance on  val set...
136/136 - 4s - 4s/epoch - 33ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0923467
{'0': {'precision': 0.399322446143155, 'recall': 0.3899067005937235, 'f1-score': 0.39455840700369066, 'support': 11790}, '1': {'precision': 0.330316463489718, 'recall': 0.4922469951371686, 'f1-score': 0.3953428392468958, 'support': 10899}, '2': {'precision': 0.4266989599658071, 'recall': 0.247848394571334, 'f1-score': 0.31356331466261844, 'support': 12084}, 'accuracy': 0.3726166853593305, 'macro avg': {'precision': 0.3854459565328934, 'recall': 0.37666736343407536, 'f1-score': 0.3678215203044017, 'support': 34773}, 'weighted avg': {'precision': 0.3872073450041425, 'recall': 0.3726166853593305, 'f1-score': 0.36665758829863715, 'support': 34773}}
[[4597 5212 1981]
 [3491 5365 2043]
 [3424 5665 2995]]
training model: results/CHTR/W6/deepOF_L1/h100
Epoch 1/50
448/448 - 41s - loss: 3.3210 - accuracy100: 0.3538 - val_loss: 3.3441 - val_accuracy100: 0.3252 - 41s/epoch - 92ms/step
Epoch 2/50
448/448 - 30s - loss: 3.2951 - accuracy100: 0.3671 - val_loss: 3.3312 - val_accuracy100: 0.3217 - 30s/epoch - 66ms/step
Epoch 3/50
448/448 - 27s - loss: 3.2857 - accuracy100: 0.3707 - val_loss: 3.3207 - val_accuracy100: 0.3283 - 27s/epoch - 61ms/step
Epoch 4/50
448/448 - 30s - loss: 3.2799 - accuracy100: 0.3748 - val_loss: 3.3176 - val_accuracy100: 0.3291 - 30s/epoch - 67ms/step
Epoch 5/50
448/448 - 30s - loss: 3.2759 - accuracy100: 0.3763 - val_loss: 3.3156 - val_accuracy100: 0.3312 - 30s/epoch - 67ms/step
Epoch 6/50
448/448 - 31s - loss: 3.2730 - accuracy100: 0.3799 - val_loss: 3.3092 - val_accuracy100: 0.3334 - 31s/epoch - 68ms/step
Epoch 7/50
448/448 - 29s - loss: 3.2723 - accuracy100: 0.3799 - val_loss: 3.3065 - val_accuracy100: 0.3352 - 29s/epoch - 65ms/step
Epoch 8/50
448/448 - 29s - loss: 3.2692 - accuracy100: 0.3807 - val_loss: 3.3065 - val_accuracy100: 0.3355 - 29s/epoch - 65ms/step
Epoch 9/50
448/448 - 29s - loss: 3.2681 - accuracy100: 0.3825 - val_loss: 3.3048 - val_accuracy100: 0.3390 - 29s/epoch - 64ms/step
Epoch 10/50
448/448 - 30s - loss: 3.2657 - accuracy100: 0.3839 - val_loss: 3.3018 - val_accuracy100: 0.3400 - 30s/epoch - 66ms/step
Epoch 11/50
448/448 - 28s - loss: 3.2649 - accuracy100: 0.3858 - val_loss: 3.3014 - val_accuracy100: 0.3407 - 28s/epoch - 63ms/step
Epoch 12/50
448/448 - 29s - loss: 3.2613 - accuracy100: 0.3875 - val_loss: 3.3010 - val_accuracy100: 0.3421 - 29s/epoch - 65ms/step
Epoch 13/50
448/448 - 31s - loss: 3.2607 - accuracy100: 0.3884 - val_loss: 3.3031 - val_accuracy100: 0.3415 - 31s/epoch - 69ms/step
Epoch 14/50
448/448 - 29s - loss: 3.2597 - accuracy100: 0.3883 - val_loss: 3.3026 - val_accuracy100: 0.3433 - 29s/epoch - 65ms/step
Epoch 15/50
448/448 - 27s - loss: 3.2569 - accuracy100: 0.3904 - val_loss: 3.3041 - val_accuracy100: 0.3455 - 27s/epoch - 60ms/step
Epoch 16/50
448/448 - 27s - loss: 3.2560 - accuracy100: 0.3898 - val_loss: 3.3051 - val_accuracy100: 0.3429 - 27s/epoch - 60ms/step
Epoch 17/50
448/448 - 29s - loss: 3.2545 - accuracy100: 0.3920 - val_loss: 3.3068 - val_accuracy100: 0.3444 - 29s/epoch - 65ms/step
Epoch 18/50
448/448 - 29s - loss: 3.2526 - accuracy100: 0.3924 - val_loss: 3.3081 - val_accuracy100: 0.3420 - 29s/epoch - 65ms/step
Epoch 19/50
448/448 - 30s - loss: 3.2511 - accuracy100: 0.3947 - val_loss: 3.3089 - val_accuracy100: 0.3435 - 30s/epoch - 66ms/step
Epoch 20/50
448/448 - 30s - loss: 3.2489 - accuracy100: 0.3955 - val_loss: 3.3098 - val_accuracy100: 0.3435 - 30s/epoch - 66ms/step
Epoch 21/50
448/448 - 29s - loss: 3.2471 - accuracy100: 0.3987 - val_loss: 3.3092 - val_accuracy100: 0.3464 - 29s/epoch - 64ms/step
Epoch 22/50
448/448 - 31s - loss: 3.2461 - accuracy100: 0.3987 - val_loss: 3.3129 - val_accuracy100: 0.3475 - 31s/epoch - 69ms/step
testing model: results/CHTR/W6/deepOF_L1/h100
Evaluating performance on  test set...
1095/1095 - 30s - 30s/epoch - 27ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1034377
{'0': {'precision': 0.4558855841639534, 'recall': 0.2306308673288938, 'f1-score': 0.30630376722899977, 'support': 98959}, '1': {'precision': 0.2770719014594328, 'recall': 0.6933963502691348, 'f1-score': 0.39593391106180087, 'support': 76170}, '2': {'precision': 0.44280311683037643, 'recall': 0.16622361964651516, 'f1-score': 0.24171134849051637, 'support': 104955}, 'accuracy': 0.33234672455406233, 'macro avg': {'precision': 0.39192020081792095, 'recall': 0.3634169457481813, 'f1-score': 0.3146496755937723, 'support': 280084}, 'weighted avg': {'precision': 0.4023541129960219, 'recall': 0.33234672455406233, 'f1-score': 0.30647454009373654, 'support': 280084}}
[[22823 65110 11026]
 [12427 52816 10927]
 [14813 72696 17446]]
Evaluating performance on  train set...
448/448 - 14s - 14s/epoch - 31ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0943769
{'0': {'precision': 0.41033550040335975, 'recall': 0.2260594494261588, 'f1-score': 0.29151776683972763, 'support': 38251}, '1': {'precision': 0.3411510605580402, 'recall': 0.7675020466369135, 'f1-score': 0.472346373254888, 'support': 37867}, '2': {'precision': 0.4441498975780214, 'recall': 0.09587722720769931, 'f1-score': 0.15771008043813112, 'support': 38445}, 'accuracy': 0.3613383029424858, 'macro avg': {'precision': 0.39854548617980706, 'recall': 0.3631462410902572, 'f1-score': 0.3071914068442489, 'support': 114563}, 'weighted avg': {'precision': 0.39881509081001065, 'recall': 0.3613383029424858, 'f1-score': 0.3063846988807313, 'support': 114563}}
[[ 8647 27426  2178]
 [ 6369 29063  2435]
 [ 6057 28702  3686]]
Evaluating performance on  val set...
136/136 - 4s - 4s/epoch - 33ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1014653
{'0': {'precision': 0.40121765601217657, 'recall': 0.22599451303155008, 'f1-score': 0.2891301963365142, 'support': 11664}, '1': {'precision': 0.3171063149480416, 'recall': 0.7309074159373561, 'f1-score': 0.44231358885017424, 'support': 10855}, '2': {'precision': 0.4175306314797361, 'recall': 0.10845438224253305, 'f1-score': 0.17218371445228997, 'support': 12254}, 'accuracy': 0.34219078020303106, 'macro avg': {'precision': 0.3786182008133181, 'recall': 0.35511877040381307, 'f1-score': 0.3012091665463261, 'support': 34773}, 'weighted avg': {'precision': 0.3807095202208525, 'recall': 0.34219078020303106, 'f1-score': 0.29573714818784985, 'support': 34773}}
[[2636 8126  902]
 [1969 7934  952]
 [1965 8960 1329]]
training model: results/CHTR/W6/deepOF_L1/h200
Epoch 1/50
448/448 - 31s - loss: 3.3238 - accuracy200: 0.3515 - val_loss: 3.3979 - val_accuracy200: 0.3010 - 31s/epoch - 70ms/step
Epoch 2/50
448/448 - 30s - loss: 3.3004 - accuracy200: 0.3608 - val_loss: 3.3715 - val_accuracy200: 0.3043 - 30s/epoch - 68ms/step
Epoch 3/50
448/448 - 29s - loss: 3.2894 - accuracy200: 0.3651 - val_loss: 3.3560 - val_accuracy200: 0.3067 - 29s/epoch - 64ms/step
Epoch 4/50
448/448 - 30s - loss: 3.2860 - accuracy200: 0.3700 - val_loss: 3.3469 - val_accuracy200: 0.3093 - 30s/epoch - 67ms/step
Epoch 5/50
448/448 - 26s - loss: 3.2813 - accuracy200: 0.3721 - val_loss: 3.3445 - val_accuracy200: 0.3091 - 26s/epoch - 58ms/step
Epoch 6/50
448/448 - 28s - loss: 3.2790 - accuracy200: 0.3722 - val_loss: 3.3368 - val_accuracy200: 0.3104 - 28s/epoch - 63ms/step
Epoch 7/50
448/448 - 28s - loss: 3.2762 - accuracy200: 0.3760 - val_loss: 3.3308 - val_accuracy200: 0.3103 - 28s/epoch - 62ms/step
Epoch 8/50
448/448 - 28s - loss: 3.2756 - accuracy200: 0.3762 - val_loss: 3.3284 - val_accuracy200: 0.3130 - 28s/epoch - 63ms/step
Epoch 9/50
448/448 - 28s - loss: 3.2731 - accuracy200: 0.3776 - val_loss: 3.3256 - val_accuracy200: 0.3140 - 28s/epoch - 63ms/step
Epoch 10/50
448/448 - 26s - loss: 3.2723 - accuracy200: 0.3790 - val_loss: 3.3261 - val_accuracy200: 0.3132 - 26s/epoch - 59ms/step
Epoch 11/50
448/448 - 30s - loss: 3.2711 - accuracy200: 0.3804 - val_loss: 3.3249 - val_accuracy200: 0.3127 - 30s/epoch - 66ms/step
Epoch 12/50
448/448 - 29s - loss: 3.2691 - accuracy200: 0.3807 - val_loss: 3.3235 - val_accuracy200: 0.3137 - 29s/epoch - 64ms/step
Epoch 13/50
448/448 - 28s - loss: 3.2676 - accuracy200: 0.3805 - val_loss: 3.3260 - val_accuracy200: 0.3130 - 28s/epoch - 63ms/step
Epoch 14/50
448/448 - 27s - loss: 3.2661 - accuracy200: 0.3834 - val_loss: 3.3275 - val_accuracy200: 0.3132 - 27s/epoch - 59ms/step
Epoch 15/50
448/448 - 26s - loss: 3.2646 - accuracy200: 0.3835 - val_loss: 3.3262 - val_accuracy200: 0.3120 - 26s/epoch - 58ms/step
Epoch 16/50
448/448 - 29s - loss: 3.2631 - accuracy200: 0.3851 - val_loss: 3.3246 - val_accuracy200: 0.3148 - 29s/epoch - 65ms/step
Epoch 17/50
448/448 - 28s - loss: 3.2615 - accuracy200: 0.3860 - val_loss: 3.3263 - val_accuracy200: 0.3142 - 28s/epoch - 63ms/step
Epoch 18/50
448/448 - 26s - loss: 3.2602 - accuracy200: 0.3884 - val_loss: 3.3264 - val_accuracy200: 0.3171 - 26s/epoch - 59ms/step
Epoch 19/50
448/448 - 30s - loss: 3.2579 - accuracy200: 0.3886 - val_loss: 3.3280 - val_accuracy200: 0.3159 - 30s/epoch - 67ms/step
Epoch 20/50
448/448 - 31s - loss: 3.2574 - accuracy200: 0.3885 - val_loss: 3.3274 - val_accuracy200: 0.3169 - 31s/epoch - 69ms/step
Epoch 21/50
448/448 - 31s - loss: 3.2555 - accuracy200: 0.3904 - val_loss: 3.3257 - val_accuracy200: 0.3203 - 31s/epoch - 70ms/step
Epoch 22/50
448/448 - 28s - loss: 3.2529 - accuracy200: 0.3928 - val_loss: 3.3310 - val_accuracy200: 0.3137 - 28s/epoch - 62ms/step
testing model: results/CHTR/W6/deepOF_L1/h200
Evaluating performance on  test set...
1095/1095 - 29s - 29s/epoch - 27ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1116924
{'0': {'precision': 0.4350248274191595, 'recall': 0.10926900495847656, 'f1-score': 0.17466569414053001, 'support': 98619}, '1': {'precision': 0.26273838740909194, 'recall': 0.795790880696155, 'f1-score': 0.39504776865211827, 'support': 73317}, '2': {'precision': 0.4346126082771896, 'recall': 0.13361319673040647, 'f1-score': 0.20439050609635348, 'support': 108148}, 'accuracy': 0.29837834363976523, 'macro avg': {'precision': 0.37745860770181366, 'recall': 0.3462243607950127, 'f1-score': 0.25803465629633393, 'support': 280084}, 'weighted avg': {'precision': 0.38976659918054574, 'recall': 0.29837834363976523, 'f1-score': 0.2438321996187598, 'support': 280084}}
[[10776 78091  9752]
 [ 5926 58345  9046]
 [ 8069 85629 14450]]
Evaluating performance on  train set...
448/448 - 11s - 11s/epoch - 25ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0985588
{'0': {'precision': 0.4049889135254989, 'recall': 0.09650745006868858, 'f1-score': 0.15587130909711552, 'support': 37852}, '1': {'precision': 0.334528444303194, 'recall': 0.8898605093522138, 'f1-score': 0.4862566767720514, 'support': 37852}, '2': {'precision': 0.44057672502574663, 'recall': 0.05504516328263723, 'f1-score': 0.09786338472800477, 'support': 38859}, 'accuracy': 0.34457023646377977, 'macro avg': {'precision': 0.3933646942848132, 'recall': 0.34713770756784657, 'f1-score': 0.24666379019905724, 'support': 114563}, 'weighted avg': {'precision': 0.3937796844208616, 'recall': 0.34457023646377977, 'f1-score': 0.24535584602590055, 'support': 114563}}
[[ 3653 32889  1310]
 [ 2763 33683  1406]
 [ 2604 34116  2139]]
Evaluating performance on  val set...
136/136 - 4s - 4s/epoch - 29ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1095006
{'0': {'precision': 0.39207445211648156, 'recall': 0.11188212113424141, 'f1-score': 0.17408691015729139, 'support': 11673}, '1': {'precision': 0.29779374385738977, 'recall': 0.853272480093222, 'f1-score': 0.4415023238286647, 'support': 10298}, '2': {'precision': 0.42170542635658914, 'recall': 0.06374004061865333, 'f1-score': 0.11074167062495757, 'support': 12802}, 'accuracy': 0.3137204152647169, 'macro avg': {'precision': 0.3705245407768201, 'recall': 0.3429648806153722, 'f1-score': 0.24211030153697122, 'support': 34773}, 'weighted avg': {'precision': 0.37506220119104317, 'recall': 0.3137204152647169, 'f1-score': 0.2299606677708095, 'support': 34773}}
[[ 1306  9787   580]
 [  972  8787   539]
 [ 1053 10933   816]]
training model: results/CHTR/W6/deepOF_L1/h300
Epoch 1/50
448/448 - 32s - loss: 3.3204 - accuracy300: 0.3528 - val_loss: 3.4383 - val_accuracy300: 0.2930 - 32s/epoch - 70ms/step
Epoch 2/50
448/448 - 28s - loss: 3.2984 - accuracy300: 0.3631 - val_loss: 3.4034 - val_accuracy300: 0.2945 - 28s/epoch - 62ms/step
Epoch 3/50
448/448 - 27s - loss: 3.2885 - accuracy300: 0.3678 - val_loss: 3.3865 - val_accuracy300: 0.2958 - 27s/epoch - 61ms/step
Epoch 4/50
448/448 - 29s - loss: 3.2853 - accuracy300: 0.3692 - val_loss: 3.3823 - val_accuracy300: 0.2970 - 29s/epoch - 64ms/step
Epoch 5/50
448/448 - 31s - loss: 3.2811 - accuracy300: 0.3719 - val_loss: 3.3738 - val_accuracy300: 0.2970 - 31s/epoch - 69ms/step
Epoch 6/50
448/448 - 29s - loss: 3.2772 - accuracy300: 0.3744 - val_loss: 3.3656 - val_accuracy300: 0.2986 - 29s/epoch - 64ms/step
Epoch 7/50
448/448 - 29s - loss: 3.2758 - accuracy300: 0.3748 - val_loss: 3.3572 - val_accuracy300: 0.2988 - 29s/epoch - 65ms/step
Epoch 8/50
448/448 - 30s - loss: 3.2738 - accuracy300: 0.3763 - val_loss: 3.3558 - val_accuracy300: 0.3002 - 30s/epoch - 68ms/step
Epoch 9/50
448/448 - 28s - loss: 3.2720 - accuracy300: 0.3779 - val_loss: 3.3546 - val_accuracy300: 0.3000 - 28s/epoch - 62ms/step
Epoch 10/50
448/448 - 31s - loss: 3.2716 - accuracy300: 0.3791 - val_loss: 3.3531 - val_accuracy300: 0.3012 - 31s/epoch - 69ms/step
Epoch 11/50
448/448 - 30s - loss: 3.2698 - accuracy300: 0.3808 - val_loss: 3.3507 - val_accuracy300: 0.3013 - 30s/epoch - 66ms/step
Epoch 12/50
448/448 - 26s - loss: 3.2681 - accuracy300: 0.3816 - val_loss: 3.3522 - val_accuracy300: 0.3009 - 26s/epoch - 58ms/step
Epoch 13/50
448/448 - 30s - loss: 3.2660 - accuracy300: 0.3824 - val_loss: 3.3607 - val_accuracy300: 0.3001 - 30s/epoch - 66ms/step
Epoch 14/50
448/448 - 31s - loss: 3.2645 - accuracy300: 0.3847 - val_loss: 3.3574 - val_accuracy300: 0.2995 - 31s/epoch - 68ms/step
Epoch 15/50
448/448 - 30s - loss: 3.2639 - accuracy300: 0.3841 - val_loss: 3.3592 - val_accuracy300: 0.3002 - 30s/epoch - 67ms/step
Epoch 16/50
448/448 - 29s - loss: 3.2616 - accuracy300: 0.3855 - val_loss: 3.3691 - val_accuracy300: 0.2986 - 29s/epoch - 65ms/step
Epoch 17/50
448/448 - 30s - loss: 3.2604 - accuracy300: 0.3857 - val_loss: 3.3614 - val_accuracy300: 0.3000 - 30s/epoch - 66ms/step
Epoch 18/50
448/448 - 30s - loss: 3.2582 - accuracy300: 0.3884 - val_loss: 3.3572 - val_accuracy300: 0.3012 - 30s/epoch - 67ms/step
Epoch 19/50
448/448 - 29s - loss: 3.2567 - accuracy300: 0.3892 - val_loss: 3.3597 - val_accuracy300: 0.3019 - 29s/epoch - 64ms/step
Epoch 20/50
448/448 - 30s - loss: 3.2563 - accuracy300: 0.3898 - val_loss: 3.3586 - val_accuracy300: 0.3017 - 30s/epoch - 68ms/step
Epoch 21/50
448/448 - 29s - loss: 3.2546 - accuracy300: 0.3897 - val_loss: 3.3642 - val_accuracy300: 0.3011 - 29s/epoch - 64ms/step
testing model: results/CHTR/W6/deepOF_L1/h300
Evaluating performance on  test set...
1095/1095 - 32s - 32s/epoch - 29ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1216872
{'0': {'precision': 0.4134806944312684, 'recall': 0.08775356118185937, 'f1-score': 0.14478022206166904, 'support': 99335}, '1': {'precision': 0.25443771558652567, 'recall': 0.819155780581275, 'f1-score': 0.38827382294056034, 'support': 71498}, '2': {'precision': 0.42198778456413105, 'recall': 0.11130332903131321, 'f1-score': 0.17614636372196107, 'support': 109251}, 'accuracy': 0.2836470487425201, 'macro avg': {'precision': 0.3633020648606417, 'recall': 0.3394042235981492, 'f1-score': 0.23640013624139686, 'support': 280084}, 'weighted avg': {'precision': 0.3761995687784784, 'recall': 0.2836470487425201, 'f1-score': 0.21917250372776756, 'support': 280084}}
[[ 8717 81887  8731]
 [ 5005 58568  7925]
 [ 7360 89731 12160]]
Evaluating performance on  train set...
448/448 - 14s - 14s/epoch - 31ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1039089
{'0': {'precision': 0.40708850620744896, 'recall': 0.05442668594222686, 'f1-score': 0.0960162467234987, 'support': 37353}, '1': {'precision': 0.3340805063195766, 'recall': 0.9370987768472776, 'f1-score': 0.4925606293089682, 'support': 37853}, '2': {'precision': 0.448835151872604, 'recall': 0.03867164672104073, 'f1-score': 0.07120800973144942, 'support': 39357}, 'accuracy': 0.3406597243438108, 'macro avg': {'precision': 0.3966680547998765, 'recall': 0.3433990365035151, 'f1-score': 0.21992829525463878, 'support': 114563}, 'weighted avg': {'precision': 0.3973074330310122, 'recall': 0.3406597243438108, 'f1-score': 0.2185166764496031, 'support': 114563}}
[[ 2033 34371   949]
 [ 1461 35472   920]
 [ 1500 36335  1522]]
Evaluating performance on  val set...
136/136 - 4s - 4s/epoch - 29ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1193668
{'0': {'precision': 0.3707539353769677, 'recall': 0.07677790168997169, 'f1-score': 0.12721199630445598, 'support': 11657}, '1': {'precision': 0.29014439383661206, 'recall': 0.889394989602931, 'f1-score': 0.43754871395167577, 'support': 10099}, '2': {'precision': 0.4144079885877318, 'recall': 0.0446339402320043, 'f1-score': 0.08058811290658159, 'support': 13017}, 'accuracy': 0.30075058234837376, 'macro avg': {'precision': 0.35843543926710386, 'recall': 0.33693561050830234, 'f1-score': 0.2151162743875711, 'support': 34773}, 'weighted avg': {'precision': 0.3636843426075336, 'recall': 0.30075058234837376, 'f1-score': 0.19988871161027202, 'support': 34773}}
[[  895 10341   421]
 [  717  8982   400]
 [  802 11634   581]]
training model: results/CHTR/W6/deepOF_L1/h500
Epoch 1/50
448/448 - 29s - loss: 3.3274 - accuracy500: 0.3490 - val_loss: 3.4057 - val_accuracy500: 0.2932 - 29s/epoch - 65ms/step
Epoch 2/50
448/448 - 29s - loss: 3.3045 - accuracy500: 0.3573 - val_loss: 3.3906 - val_accuracy500: 0.2914 - 29s/epoch - 65ms/step
Epoch 3/50
448/448 - 29s - loss: 3.2945 - accuracy500: 0.3617 - val_loss: 3.3656 - val_accuracy500: 0.2916 - 29s/epoch - 66ms/step
Epoch 4/50
448/448 - 31s - loss: 3.2885 - accuracy500: 0.3638 - val_loss: 3.3601 - val_accuracy500: 0.2925 - 31s/epoch - 68ms/step
Epoch 5/50
448/448 - 28s - loss: 3.2847 - accuracy500: 0.3654 - val_loss: 3.3543 - val_accuracy500: 0.2934 - 28s/epoch - 62ms/step
Epoch 6/50
448/448 - 31s - loss: 3.2818 - accuracy500: 0.3679 - val_loss: 3.3471 - val_accuracy500: 0.2957 - 31s/epoch - 70ms/step
Epoch 7/50
448/448 - 30s - loss: 3.2789 - accuracy500: 0.3697 - val_loss: 3.3435 - val_accuracy500: 0.2943 - 30s/epoch - 68ms/step
Epoch 8/50
448/448 - 30s - loss: 3.2773 - accuracy500: 0.3704 - val_loss: 3.3382 - val_accuracy500: 0.2951 - 30s/epoch - 66ms/step
Epoch 9/50
448/448 - 27s - loss: 3.2755 - accuracy500: 0.3717 - val_loss: 3.3358 - val_accuracy500: 0.2975 - 27s/epoch - 61ms/step
Epoch 10/50
448/448 - 29s - loss: 3.2747 - accuracy500: 0.3726 - val_loss: 3.3367 - val_accuracy500: 0.2981 - 29s/epoch - 65ms/step
Epoch 11/50
448/448 - 30s - loss: 3.2731 - accuracy500: 0.3737 - val_loss: 3.3370 - val_accuracy500: 0.2949 - 30s/epoch - 67ms/step
Epoch 12/50
448/448 - 29s - loss: 3.2715 - accuracy500: 0.3749 - val_loss: 3.3366 - val_accuracy500: 0.2984 - 29s/epoch - 66ms/step
Epoch 13/50
448/448 - 30s - loss: 3.2706 - accuracy500: 0.3758 - val_loss: 3.3396 - val_accuracy500: 0.2993 - 30s/epoch - 67ms/step
Epoch 14/50
448/448 - 29s - loss: 3.2688 - accuracy500: 0.3764 - val_loss: 3.3459 - val_accuracy500: 0.2966 - 29s/epoch - 65ms/step
Epoch 15/50
448/448 - 31s - loss: 3.2670 - accuracy500: 0.3768 - val_loss: 3.3435 - val_accuracy500: 0.2977 - 31s/epoch - 69ms/step
Epoch 16/50
448/448 - 31s - loss: 3.2664 - accuracy500: 0.3785 - val_loss: 3.3511 - val_accuracy500: 0.2970 - 31s/epoch - 69ms/step
Epoch 17/50
448/448 - 30s - loss: 3.2639 - accuracy500: 0.3815 - val_loss: 3.3500 - val_accuracy500: 0.3005 - 30s/epoch - 67ms/step
Epoch 18/50
448/448 - 30s - loss: 3.2627 - accuracy500: 0.3814 - val_loss: 3.3527 - val_accuracy500: 0.2981 - 30s/epoch - 67ms/step
Epoch 19/50
448/448 - 30s - loss: 3.2617 - accuracy500: 0.3808 - val_loss: 3.3592 - val_accuracy500: 0.2969 - 30s/epoch - 68ms/step
testing model: results/CHTR/W6/deepOF_L1/h500
Evaluating performance on  test set...
1095/1095 - 31s - 31s/epoch - 28ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1203256
{'0': {'precision': 0.4132313575525813, 'recall': 0.10841451546557242, 'f1-score': 0.17176509859087769, 'support': 99673}, '1': {'precision': 0.2485115413442024, 'recall': 0.8522620611976722, 'f1-score': 0.384814748406657, 'support': 69251}, '2': {'precision': 0.40669099756690996, 'recall': 0.06014753508456279, 'f1-score': 0.1047962382445141, 'support': 111160}, 'accuracy': 0.27317519030005283, 'macro avg': {'precision': 0.35614463215456454, 'recall': 0.3402747039159358, 'f1-score': 0.22045869508068294, 'support': 280084}, 'weighted avg': {'precision': 0.369908502950913, 'recall': 0.27317519030005283, 'f1-score': 0.1978631362627574, 'support': 280084}}
[[10806 83271  5596]
 [ 6073 59020  4158]
 [ 9271 95203  6686]]
Evaluating performance on  train set...
448/448 - 15s - 15s/epoch - 35ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1019084
{'0': {'precision': 0.379012987012987, 'recall': 0.10022253358608753, 'f1-score': 0.15852598644185642, 'support': 36399}, '1': {'precision': 0.3336794569125124, 'recall': 0.9015668837012334, 'f1-score': 0.4870839738319094, 'support': 37782}, '2': {'precision': 0.40770577933450086, 'recall': 0.028824723886880295, 'f1-score': 0.05384277355043134, 'support': 40382}, 'accuracy': 0.3393329434459642, 'macro avg': {'precision': 0.37346607442000007, 'recall': 0.3435380470580671, 'f1-score': 0.2331509112747324, 'support': 114563}, 'weighted avg': {'precision': 0.37417618023655175, 'recall': 0.3393329434459642, 'f1-score': 0.22998239362907616, 'support': 114563}}
[[ 3648 31919   832]
 [ 2860 34063   859]
 [ 3117 36101  1164]]
Evaluating performance on  val set...
136/136 - 5s - 5s/epoch - 36ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1136202
{'0': {'precision': 0.352112676056338, 'recall': 0.1062722304155461, 'f1-score': 0.16326802612288419, 'support': 11527}, '1': {'precision': 0.2886139763191934, 'recall': 0.8672513454255532, 'f1-score': 0.43309692671394795, 'support': 10034}, '2': {'precision': 0.38232720909886264, 'recall': 0.033075991522858006, 'f1-score': 0.060884709160571225, 'support': 13212}, 'accuracy': 0.298047335576453, 'macro avg': {'precision': 0.341017953824798, 'recall': 0.3355331891213191, 'f1-score': 0.2190832206658011, 'support': 34773}, 'weighted avg': {'precision': 0.34526967882846943, 'recall': 0.298047335576453, 'f1-score': 0.20222856461035016, 'support': 34773}}
[[ 1225  9924   378]
 [ 1004  8702   328]
 [ 1250 11525   437]]
training model: results/CHTR/W6/deepOF_L1/h1000
Epoch 1/50
448/448 - 37s - loss: 3.3317 - accuracy1000: 0.3494 - val_loss: 3.3519 - val_accuracy1000: 0.3212 - 37s/epoch - 83ms/step
Epoch 2/50
448/448 - 29s - loss: 3.3118 - accuracy1000: 0.3512 - val_loss: 3.3347 - val_accuracy1000: 0.3155 - 29s/epoch - 65ms/step
Epoch 3/50
448/448 - 31s - loss: 3.2987 - accuracy1000: 0.3531 - val_loss: 3.3260 - val_accuracy1000: 0.3116 - 31s/epoch - 68ms/step
Epoch 4/50
448/448 - 29s - loss: 3.2926 - accuracy1000: 0.3515 - val_loss: 3.3159 - val_accuracy1000: 0.3202 - 29s/epoch - 64ms/step
Epoch 5/50
448/448 - 27s - loss: 3.2879 - accuracy1000: 0.3543 - val_loss: 3.3127 - val_accuracy1000: 0.3279 - 27s/epoch - 60ms/step
Epoch 6/50
448/448 - 29s - loss: 3.2847 - accuracy1000: 0.3565 - val_loss: 3.3085 - val_accuracy1000: 0.3300 - 29s/epoch - 65ms/step
Epoch 7/50
448/448 - 30s - loss: 3.2824 - accuracy1000: 0.3545 - val_loss: 3.3067 - val_accuracy1000: 0.3321 - 30s/epoch - 68ms/step
Epoch 8/50
448/448 - 30s - loss: 3.2810 - accuracy1000: 0.3572 - val_loss: 3.3051 - val_accuracy1000: 0.3349 - 30s/epoch - 66ms/step
Epoch 9/50
448/448 - 31s - loss: 3.2790 - accuracy1000: 0.3589 - val_loss: 3.3066 - val_accuracy1000: 0.3353 - 31s/epoch - 68ms/step
Epoch 10/50
448/448 - 31s - loss: 3.2782 - accuracy1000: 0.3574 - val_loss: 3.3047 - val_accuracy1000: 0.3417 - 31s/epoch - 69ms/step
Epoch 11/50
448/448 - 28s - loss: 3.2757 - accuracy1000: 0.3608 - val_loss: 3.3036 - val_accuracy1000: 0.3418 - 28s/epoch - 63ms/step
Epoch 12/50
448/448 - 29s - loss: 3.2749 - accuracy1000: 0.3601 - val_loss: 3.3056 - val_accuracy1000: 0.3452 - 29s/epoch - 64ms/step
Epoch 13/50
448/448 - 29s - loss: 3.2741 - accuracy1000: 0.3615 - val_loss: 3.3031 - val_accuracy1000: 0.3445 - 29s/epoch - 65ms/step
Epoch 14/50
448/448 - 30s - loss: 3.2730 - accuracy1000: 0.3624 - val_loss: 3.3045 - val_accuracy1000: 0.3434 - 30s/epoch - 68ms/step
Epoch 15/50
448/448 - 30s - loss: 3.2726 - accuracy1000: 0.3634 - val_loss: 3.3039 - val_accuracy1000: 0.3527 - 30s/epoch - 67ms/step
Epoch 16/50
448/448 - 25s - loss: 3.2716 - accuracy1000: 0.3638 - val_loss: 3.3037 - val_accuracy1000: 0.3563 - 25s/epoch - 56ms/step
Epoch 17/50
448/448 - 29s - loss: 3.2694 - accuracy1000: 0.3643 - val_loss: 3.3047 - val_accuracy1000: 0.3526 - 29s/epoch - 64ms/step
Epoch 18/50
448/448 - 26s - loss: 3.2678 - accuracy1000: 0.3672 - val_loss: 3.3026 - val_accuracy1000: 0.3548 - 26s/epoch - 59ms/step
Epoch 19/50
448/448 - 28s - loss: 3.2668 - accuracy1000: 0.3673 - val_loss: 3.3023 - val_accuracy1000: 0.3550 - 28s/epoch - 63ms/step
Epoch 20/50
448/448 - 28s - loss: 3.2652 - accuracy1000: 0.3687 - val_loss: 3.3052 - val_accuracy1000: 0.3528 - 28s/epoch - 62ms/step
Epoch 21/50
448/448 - 30s - loss: 3.2650 - accuracy1000: 0.3697 - val_loss: 3.3060 - val_accuracy1000: 0.3472 - 30s/epoch - 67ms/step
Epoch 22/50
448/448 - 28s - loss: 3.2630 - accuracy1000: 0.3706 - val_loss: 3.3081 - val_accuracy1000: 0.3503 - 28s/epoch - 63ms/step
Epoch 23/50
448/448 - 28s - loss: 3.2610 - accuracy1000: 0.3722 - val_loss: 3.3095 - val_accuracy1000: 0.3560 - 28s/epoch - 63ms/step
Epoch 24/50
448/448 - 28s - loss: 3.2594 - accuracy1000: 0.3729 - val_loss: 3.3127 - val_accuracy1000: 0.3487 - 28s/epoch - 64ms/step
Epoch 25/50
448/448 - 28s - loss: 3.2579 - accuracy1000: 0.3745 - val_loss: 3.3147 - val_accuracy1000: 0.3490 - 28s/epoch - 62ms/step
Epoch 26/50
448/448 - 28s - loss: 3.2562 - accuracy1000: 0.3755 - val_loss: 3.3183 - val_accuracy1000: 0.3492 - 28s/epoch - 63ms/step
Epoch 27/50
448/448 - 27s - loss: 3.2541 - accuracy1000: 0.3776 - val_loss: 3.3208 - val_accuracy1000: 0.3489 - 27s/epoch - 61ms/step
Epoch 28/50
448/448 - 26s - loss: 3.2527 - accuracy1000: 0.3782 - val_loss: 3.3208 - val_accuracy1000: 0.3416 - 26s/epoch - 57ms/step
Epoch 29/50
448/448 - 30s - loss: 3.2525 - accuracy1000: 0.3778 - val_loss: 3.3243 - val_accuracy1000: 0.3404 - 30s/epoch - 67ms/step
testing model: results/CHTR/W6/deepOF_L1/h1000
Evaluating performance on  test set...
1095/1095 - 31s - 31s/epoch - 28ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0995213
{'0': {'precision': 0.37506193609347455, 'recall': 0.3280884606080155, 'f1-score': 0.35000618309488096, 'support': 99208}, '1': {'precision': 0.27609514551309317, 'recall': 0.2391301487903385, 'f1-score': 0.256286614639511, 'support': 76013}, '2': {'precision': 0.38272466951712236, 'recall': 0.46521652060307256, 'f1-score': 0.41995799042732684, 'support': 104863}, 'accuracy': 0.3552862712614787, 'macro avg': {'precision': 0.3446272503745633, 'recall': 0.34414504333380885, 'f1-score': 0.3420835960539062, 'support': 280084}, 'weighted avg': {'precision': 0.351071899399545, 'recall': 0.3552862712614787, 'f1-score': 0.35076113809161136, 'support': 280084}}
[[32549 22782 43877]
 [23032 18177 34804]
 [31202 24877 48784]]
Evaluating performance on  train set...
448/448 - 13s - 13s/epoch - 29ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0948775
{'0': {'precision': 0.3379775145067698, 'recall': 0.3211844448273881, 'f1-score': 0.32936706623862394, 'support': 34818}, '1': {'precision': 0.33592179158288843, 'recall': 0.25800095851749294, 'f1-score': 0.29184988856093, 'support': 37558}, '2': {'precision': 0.38435083319082636, 'recall': 0.4794842012942376, 'f1-score': 0.4266790415119811, 'support': 42187}, 'accuracy': 0.35876330054205985, 'macro avg': {'precision': 0.3527500464268282, 'recall': 0.3528898682130395, 'f1-score': 0.34929866543717836, 'support': 114563}, 'weighted avg': {'precision': 0.35438021305472295, 'recall': 0.35876330054205985, 'f1-score': 0.3529019783973339, 'support': 114563}}
[[11183  8678 14957]
 [10424  9690 17444]
 [11481 10478 20228]]
Evaluating performance on  val set...
136/136 - 5s - 5s/epoch - 33ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.099271
{'0': {'precision': 0.34072077468303885, 'recall': 0.3045146324054247, 'f1-score': 0.32160188457008243, 'support': 11208}, '1': {'precision': 0.28595357741086386, 'recall': 0.23521306957976576, 'f1-score': 0.25811328905448455, 'support': 10161}, '2': {'precision': 0.3954140748871814, 'recall': 0.483736198149806, 'f1-score': 0.4351385813032683, 'support': 13404}, 'accuracy': 0.3533488626232997, 'macro avg': {'precision': 0.340696142327028, 'recall': 0.3411546333783322, 'f1-score': 0.3382845849759451, 'support': 34773}, 'weighted avg': {'precision': 0.3457999885689203, 'recall': 0.3533488626232997, 'f1-score': 0.3468150748032413, 'support': 34773}}
[[3413 2700 5095]
 [2952 2390 4819]
 [3652 3268 6484]]
training model: results/CHTR/W6/deepLOB_L2/h10
Epoch 1/50
448/448 - 57s - loss: 3.3308 - accuracy10: 0.3500 - val_loss: 3.3221 - val_accuracy10: 0.3274 - 57s/epoch - 127ms/step
Epoch 2/50
448/448 - 45s - loss: 3.2911 - accuracy10: 0.3623 - val_loss: 3.3315 - val_accuracy10: 0.3219 - 45s/epoch - 101ms/step
Epoch 3/50
448/448 - 49s - loss: 3.2729 - accuracy10: 0.3746 - val_loss: 3.3088 - val_accuracy10: 0.3385 - 49s/epoch - 110ms/step
Epoch 4/50
448/448 - 49s - loss: 3.2621 - accuracy10: 0.3828 - val_loss: 3.3031 - val_accuracy10: 0.3390 - 49s/epoch - 109ms/step
Epoch 5/50
448/448 - 48s - loss: 3.2496 - accuracy10: 0.3913 - val_loss: 3.2937 - val_accuracy10: 0.3559 - 48s/epoch - 107ms/step
Epoch 6/50
448/448 - 47s - loss: 3.2384 - accuracy10: 0.3994 - val_loss: 3.2815 - val_accuracy10: 0.3705 - 47s/epoch - 106ms/step
Epoch 7/50
448/448 - 48s - loss: 3.2281 - accuracy10: 0.4056 - val_loss: 3.2761 - val_accuracy10: 0.3798 - 48s/epoch - 107ms/step
Epoch 8/50
448/448 - 49s - loss: 3.2171 - accuracy10: 0.4124 - val_loss: 3.2626 - val_accuracy10: 0.3904 - 49s/epoch - 110ms/step
Epoch 9/50
448/448 - 51s - loss: 3.2069 - accuracy10: 0.4188 - val_loss: 3.2419 - val_accuracy10: 0.4028 - 51s/epoch - 113ms/step
Epoch 10/50
448/448 - 50s - loss: 3.1976 - accuracy10: 0.4232 - val_loss: 3.2493 - val_accuracy10: 0.3986 - 50s/epoch - 111ms/step
Epoch 11/50
448/448 - 50s - loss: 3.1891 - accuracy10: 0.4288 - val_loss: 3.2434 - val_accuracy10: 0.4042 - 50s/epoch - 112ms/step
Epoch 12/50
448/448 - 51s - loss: 3.1809 - accuracy10: 0.4308 - val_loss: 3.2389 - val_accuracy10: 0.4020 - 51s/epoch - 114ms/step
Epoch 13/50
448/448 - 50s - loss: 3.1753 - accuracy10: 0.4326 - val_loss: 3.2384 - val_accuracy10: 0.4073 - 50s/epoch - 112ms/step
Epoch 14/50
448/448 - 49s - loss: 3.1678 - accuracy10: 0.4375 - val_loss: 3.2343 - val_accuracy10: 0.4092 - 49s/epoch - 109ms/step
Epoch 15/50
448/448 - 48s - loss: 3.1585 - accuracy10: 0.4409 - val_loss: 3.2265 - val_accuracy10: 0.4124 - 48s/epoch - 107ms/step
Epoch 16/50
448/448 - 50s - loss: 3.1529 - accuracy10: 0.4450 - val_loss: 3.2262 - val_accuracy10: 0.4127 - 50s/epoch - 113ms/step
Epoch 17/50
448/448 - 52s - loss: 3.1451 - accuracy10: 0.4467 - val_loss: 3.2270 - val_accuracy10: 0.4133 - 52s/epoch - 116ms/step
Epoch 18/50
448/448 - 50s - loss: 3.1383 - accuracy10: 0.4490 - val_loss: 3.2256 - val_accuracy10: 0.4130 - 50s/epoch - 111ms/step
Epoch 19/50
448/448 - 50s - loss: 3.1320 - accuracy10: 0.4514 - val_loss: 3.2373 - val_accuracy10: 0.4107 - 50s/epoch - 111ms/step
Epoch 20/50
448/448 - 49s - loss: 3.1242 - accuracy10: 0.4540 - val_loss: 3.2309 - val_accuracy10: 0.4153 - 49s/epoch - 109ms/step
Epoch 21/50
448/448 - 50s - loss: 3.1171 - accuracy10: 0.4561 - val_loss: 3.2316 - val_accuracy10: 0.4146 - 50s/epoch - 112ms/step
Epoch 22/50
448/448 - 51s - loss: 3.1103 - accuracy10: 0.4587 - val_loss: 3.2430 - val_accuracy10: 0.4112 - 51s/epoch - 114ms/step
Epoch 23/50
448/448 - 51s - loss: 3.1030 - accuracy10: 0.4618 - val_loss: 3.2483 - val_accuracy10: 0.4101 - 51s/epoch - 114ms/step
Epoch 24/50
448/448 - 51s - loss: 3.0958 - accuracy10: 0.4654 - val_loss: 3.2525 - val_accuracy10: 0.4141 - 51s/epoch - 113ms/step
Epoch 25/50
448/448 - 49s - loss: 3.0871 - accuracy10: 0.4681 - val_loss: 3.2606 - val_accuracy10: 0.4112 - 49s/epoch - 110ms/step
Epoch 26/50
448/448 - 52s - loss: 3.0801 - accuracy10: 0.4717 - val_loss: 3.2658 - val_accuracy10: 0.4110 - 52s/epoch - 116ms/step
Epoch 27/50
448/448 - 49s - loss: 3.0744 - accuracy10: 0.4733 - val_loss: 3.2789 - val_accuracy10: 0.4083 - 49s/epoch - 109ms/step
Epoch 28/50
448/448 - 49s - loss: 3.0667 - accuracy10: 0.4761 - val_loss: 3.2781 - val_accuracy10: 0.4099 - 49s/epoch - 110ms/step
testing model: results/CHTR/W6/deepLOB_L2/h10
Evaluating performance on  test set...
1095/1095 - 60s - 60s/epoch - 55ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0901762
{'0': {'precision': 0.4671117868711575, 'recall': 0.21113545816733068, 'f1-score': 0.29081979133083186, 'support': 100400}, '1': {'precision': 0.3126089685473185, 'recall': 0.36984832024642805, 'f1-score': 0.33882824261588756, 'support': 72719}, '2': {'precision': 0.4406284891776639, 'recall': 0.6124146957090774, 'f1-score': 0.5125095836397491, 'support': 106970}, 'accuracy': 0.4055960783893691, 'macro avg': {'precision': 0.4067830815320466, 'recall': 0.39779949137427867, 'f1-score': 0.3807192058621562, 'support': 280089}, 'weighted avg': {'precision': 0.41688414922753614, 'recall': 0.4055960783893691, 'f1-score': 0.3879506449248068, 'support': 280089}}
[[21198 31244 47958]
 [10618 26895 35206]
 [13565 27895 65510]]
Evaluating performance on  train set...
448/448 - 26s - 26s/epoch - 57ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0622686
{'0': {'precision': 0.44253410014754146, 'recall': 0.36874325714429085, 'f1-score': 0.40228280505830183, 'support': 39857}, '1': {'precision': 0.43244024925722396, 'recall': 0.4439855307202246, 'f1-score': 0.43813684617126414, 'support': 37044}, '2': {'precision': 0.416943674976916, 'recall': 0.47956880758303905, 'f1-score': 0.44606892804662707, 'support': 37663}, 'accuracy': 0.42950665130407456, 'macro avg': {'precision': 0.4306393414605605, 'recall': 0.43076586514918486, 'f1-score': 0.4288295264253977, 'support': 114564}, 'weighted avg': {'precision': 0.43085740593660093, 'recall': 0.42950665130407456, 'f1-score': 0.4282708453597741, 'support': 114564}}
[[14697 11301 13859]
 [ 9198 16447 11399]
 [ 9316 10285 18062]]
Evaluating performance on  val set...
136/136 - 7s - 7s/epoch - 51ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0770041
{'0': {'precision': 0.432916837361737, 'recall': 0.34273899294575527, 'f1-score': 0.3825858713852559, 'support': 12333}, '1': {'precision': 0.39383252685967357, 'recall': 0.4637821131929689, 'f1-score': 0.42595467246196833, 'support': 10354}, '2': {'precision': 0.41463795255930086, 'recall': 0.4396822770147278, 'f1-score': 0.42679302867239577, 'support': 12086}, 'accuracy': 0.4124751962729704, 'macro avg': {'precision': 0.41379577226023717, 'recall': 0.41540112771781734, 'f1-score': 0.41177785750654, 'support': 34773}, 'weighted avg': {'precision': 0.41492593773672315, 'recall': 0.4124751962729704, 'f1-score': 0.4108643710637609, 'support': 34773}}
[[4227 3784 4322]
 [2372 4802 3180]
 [3165 3607 5314]]
training model: results/CHTR/W6/deepLOB_L2/h20
Epoch 1/50
448/448 - 54s - loss: 3.3302 - accuracy20: 0.3516 - val_loss: 3.3476 - val_accuracy20: 0.3202 - 54s/epoch - 120ms/step
Epoch 2/50
448/448 - 46s - loss: 3.2923 - accuracy20: 0.3632 - val_loss: 3.3166 - val_accuracy20: 0.3372 - 46s/epoch - 103ms/step
Epoch 3/50
448/448 - 48s - loss: 3.2721 - accuracy20: 0.3783 - val_loss: 3.3206 - val_accuracy20: 0.3337 - 48s/epoch - 107ms/step
Epoch 4/50
448/448 - 50s - loss: 3.2617 - accuracy20: 0.3873 - val_loss: 3.3045 - val_accuracy20: 0.3406 - 50s/epoch - 111ms/step
Epoch 5/50
448/448 - 49s - loss: 3.2531 - accuracy20: 0.3917 - val_loss: 3.3000 - val_accuracy20: 0.3455 - 49s/epoch - 110ms/step
Epoch 6/50
448/448 - 51s - loss: 3.2464 - accuracy20: 0.3980 - val_loss: 3.2835 - val_accuracy20: 0.3654 - 51s/epoch - 113ms/step
Epoch 7/50
448/448 - 51s - loss: 3.2340 - accuracy20: 0.4064 - val_loss: 3.2758 - val_accuracy20: 0.3817 - 51s/epoch - 114ms/step
Epoch 8/50
448/448 - 53s - loss: 3.2263 - accuracy20: 0.4101 - val_loss: 3.2704 - val_accuracy20: 0.3902 - 53s/epoch - 118ms/step
Epoch 9/50
448/448 - 49s - loss: 3.2178 - accuracy20: 0.4142 - val_loss: 3.2654 - val_accuracy20: 0.3918 - 49s/epoch - 110ms/step
Epoch 10/50
448/448 - 50s - loss: 3.2096 - accuracy20: 0.4194 - val_loss: 3.2568 - val_accuracy20: 0.3982 - 50s/epoch - 112ms/step
Epoch 11/50
448/448 - 48s - loss: 3.2015 - accuracy20: 0.4249 - val_loss: 3.2564 - val_accuracy20: 0.3986 - 48s/epoch - 107ms/step
Epoch 12/50
448/448 - 50s - loss: 3.1967 - accuracy20: 0.4254 - val_loss: 3.2521 - val_accuracy20: 0.4043 - 50s/epoch - 111ms/step
Epoch 13/50
448/448 - 46s - loss: 3.1885 - accuracy20: 0.4323 - val_loss: 3.2496 - val_accuracy20: 0.4055 - 46s/epoch - 103ms/step
Epoch 14/50
448/448 - 52s - loss: 3.1835 - accuracy20: 0.4326 - val_loss: 3.2541 - val_accuracy20: 0.4014 - 52s/epoch - 115ms/step
Epoch 15/50
448/448 - 48s - loss: 3.1765 - accuracy20: 0.4370 - val_loss: 3.2450 - val_accuracy20: 0.4054 - 48s/epoch - 108ms/step
Epoch 16/50
448/448 - 51s - loss: 3.1732 - accuracy20: 0.4379 - val_loss: 3.2482 - val_accuracy20: 0.4027 - 51s/epoch - 114ms/step
Epoch 17/50
448/448 - 50s - loss: 3.1684 - accuracy20: 0.4394 - val_loss: 3.2466 - val_accuracy20: 0.4060 - 50s/epoch - 112ms/step
Epoch 18/50
448/448 - 51s - loss: 3.1625 - accuracy20: 0.4420 - val_loss: 3.2445 - val_accuracy20: 0.4001 - 51s/epoch - 113ms/step
Epoch 19/50
448/448 - 46s - loss: 3.1577 - accuracy20: 0.4420 - val_loss: 3.2480 - val_accuracy20: 0.4025 - 46s/epoch - 104ms/step
Epoch 20/50
448/448 - 49s - loss: 3.1509 - accuracy20: 0.4462 - val_loss: 3.2490 - val_accuracy20: 0.4013 - 49s/epoch - 108ms/step
Epoch 21/50
448/448 - 47s - loss: 3.1434 - accuracy20: 0.4482 - val_loss: 3.2457 - val_accuracy20: 0.4047 - 47s/epoch - 106ms/step
Epoch 22/50
448/448 - 46s - loss: 3.1370 - accuracy20: 0.4519 - val_loss: 3.2546 - val_accuracy20: 0.4006 - 46s/epoch - 103ms/step
Epoch 23/50
448/448 - 47s - loss: 3.1314 - accuracy20: 0.4535 - val_loss: 3.2568 - val_accuracy20: 0.4041 - 47s/epoch - 105ms/step
Epoch 24/50
448/448 - 48s - loss: 3.1246 - accuracy20: 0.4562 - val_loss: 3.2633 - val_accuracy20: 0.4006 - 48s/epoch - 107ms/step
Epoch 25/50
448/448 - 48s - loss: 3.1189 - accuracy20: 0.4578 - val_loss: 3.2652 - val_accuracy20: 0.4004 - 48s/epoch - 106ms/step
Epoch 26/50
448/448 - 46s - loss: 3.1105 - accuracy20: 0.4614 - val_loss: 3.2653 - val_accuracy20: 0.3989 - 46s/epoch - 102ms/step
Epoch 27/50
448/448 - 46s - loss: 3.1085 - accuracy20: 0.4634 - val_loss: 3.2692 - val_accuracy20: 0.4005 - 46s/epoch - 103ms/step
Epoch 28/50
448/448 - 48s - loss: 3.1004 - accuracy20: 0.4646 - val_loss: 3.2786 - val_accuracy20: 0.3948 - 48s/epoch - 107ms/step
testing model: results/CHTR/W6/deepLOB_L2/h20
Evaluating performance on  test set...
1095/1095 - 53s - 53s/epoch - 48ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0824867
{'0': {'precision': 0.4165714084729965, 'recall': 0.467015634549792, 'f1-score': 0.44035358417608567, 'support': 101442}, '1': {'precision': 0.306310818546079, 'recall': 0.17417071252271557, 'f1-score': 0.2220704442100531, 'support': 73738}, '2': {'precision': 0.43515891831076464, 'recall': 0.5161520937193187, 'f1-score': 0.4722076880145109, 'support': 104909}, 'accuracy': 0.4083237827976108, 'macro avg': {'precision': 0.38601371510994675, 'recall': 0.3857794802639421, 'f1-score': 0.37821057213354986, 'support': 280089}, 'weighted avg': {'precision': 0.3945055711482154, 'recall': 0.4083237827976108, 'f1-score': 0.3948181293912496, 'support': 280089}}
[[47375 15254 38813]
 [29422 12843 31473]
 [36929 13831 54149]]
Evaluating performance on  train set...
448/448 - 23s - 23s/epoch - 51ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.08106
{'0': {'precision': 0.3910599427057997, 'recall': 0.550678675631105, 'f1-score': 0.4573421268884722, 'support': 39415}, '1': {'precision': 0.42928530529384207, 'recall': 0.22169354838709676, 'f1-score': 0.29238978213469, 'support': 37200}, '2': {'precision': 0.4078544542032622, 'recall': 0.42828533031173416, 'f1-score': 0.4178202804663299, 'support': 37949}, 'accuracy': 0.4033116860444817, 'macro avg': {'precision': 0.4093999007343014, 'recall': 0.40021918477664525, 'f1-score': 0.38918406316316406, 'support': 114564}, 'weighted avg': {'precision': 0.4090352089769877, 'recall': 0.4033116860444817, 'f1-score': 0.390689061573761, 'support': 114564}}
[[21705  5635 12075]
 [17431  8247 11522]
 [16367  5329 16253]]
Evaluating performance on  val set...
136/136 - 7s - 7s/epoch - 49ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.081529
{'0': {'precision': 0.3995078995078995, 'recall': 0.5062771806022811, 'f1-score': 0.4465998335203214, 'support': 12187}, '1': {'precision': 0.40617081532270083, 'recall': 0.2584653324480698, 'f1-score': 0.3159054022722003, 'support': 10543}, '2': {'precision': 0.40419968304278925, 'recall': 0.4235655567549614, 'f1-score': 0.4136560840124883, 'support': 12043}, 'accuracy': 0.4024961895723694, 'macro avg': {'precision': 0.4032927992911299, 'recall': 0.3961026899351041, 'f1-score': 0.3920537732683367, 'support': 34773}, 'weighted avg': {'precision': 0.40315297673868566, 'recall': 0.4024961895723694, 'f1-score': 0.39556446228482917, 'support': 34773}}
[[6170 2128 3889]
 [4188 2725 3630]
 [5086 1856 5101]]
training model: results/CHTR/W6/deepLOB_L2/h30
Epoch 1/50
448/448 - 53s - loss: 3.3319 - accuracy30: 0.3486 - val_loss: 3.3477 - val_accuracy30: 0.3281 - 53s/epoch - 118ms/step
Epoch 2/50
448/448 - 48s - loss: 3.2920 - accuracy30: 0.3670 - val_loss: 3.3222 - val_accuracy30: 0.3348 - 48s/epoch - 107ms/step
Epoch 3/50
448/448 - 48s - loss: 3.2784 - accuracy30: 0.3759 - val_loss: 3.3330 - val_accuracy30: 0.3262 - 48s/epoch - 107ms/step
Epoch 4/50
448/448 - 49s - loss: 3.2667 - accuracy30: 0.3835 - val_loss: 3.3290 - val_accuracy30: 0.3247 - 49s/epoch - 110ms/step
Epoch 5/50
448/448 - 48s - loss: 3.2585 - accuracy30: 0.3895 - val_loss: 3.3270 - val_accuracy30: 0.3283 - 48s/epoch - 108ms/step
Epoch 6/50
448/448 - 50s - loss: 3.2532 - accuracy30: 0.3911 - val_loss: 3.3186 - val_accuracy30: 0.3375 - 50s/epoch - 111ms/step
Epoch 7/50
448/448 - 49s - loss: 3.2456 - accuracy30: 0.3973 - val_loss: 3.3129 - val_accuracy30: 0.3482 - 49s/epoch - 109ms/step
Epoch 8/50
448/448 - 50s - loss: 3.2412 - accuracy30: 0.4000 - val_loss: 3.3208 - val_accuracy30: 0.3512 - 50s/epoch - 112ms/step
Epoch 9/50
448/448 - 48s - loss: 3.2344 - accuracy30: 0.4028 - val_loss: 3.3400 - val_accuracy30: 0.3431 - 48s/epoch - 108ms/step
Epoch 10/50
448/448 - 51s - loss: 3.2275 - accuracy30: 0.4092 - val_loss: 3.3012 - val_accuracy30: 0.3624 - 51s/epoch - 113ms/step
Epoch 11/50
448/448 - 47s - loss: 3.2229 - accuracy30: 0.4117 - val_loss: 3.3339 - val_accuracy30: 0.3517 - 47s/epoch - 105ms/step
Epoch 12/50
448/448 - 50s - loss: 3.2159 - accuracy30: 0.4139 - val_loss: 3.3208 - val_accuracy30: 0.3631 - 50s/epoch - 111ms/step
Epoch 13/50
448/448 - 46s - loss: 3.2104 - accuracy30: 0.4177 - val_loss: 3.2963 - val_accuracy30: 0.3717 - 46s/epoch - 102ms/step
Epoch 14/50
448/448 - 47s - loss: 3.2034 - accuracy30: 0.4208 - val_loss: 3.3080 - val_accuracy30: 0.3690 - 47s/epoch - 105ms/step
Epoch 15/50
448/448 - 49s - loss: 3.1979 - accuracy30: 0.4243 - val_loss: 3.3049 - val_accuracy30: 0.3708 - 49s/epoch - 109ms/step
Epoch 16/50
448/448 - 48s - loss: 3.1942 - accuracy30: 0.4283 - val_loss: 3.3189 - val_accuracy30: 0.3673 - 48s/epoch - 107ms/step
Epoch 17/50
448/448 - 50s - loss: 3.1875 - accuracy30: 0.4287 - val_loss: 3.3069 - val_accuracy30: 0.3757 - 50s/epoch - 111ms/step
Epoch 18/50
448/448 - 49s - loss: 3.1816 - accuracy30: 0.4313 - val_loss: 3.3129 - val_accuracy30: 0.3712 - 49s/epoch - 109ms/step
Epoch 19/50
448/448 - 48s - loss: 3.1783 - accuracy30: 0.4357 - val_loss: 3.3247 - val_accuracy30: 0.3735 - 48s/epoch - 107ms/step
Epoch 20/50
448/448 - 49s - loss: 3.1695 - accuracy30: 0.4380 - val_loss: 3.3162 - val_accuracy30: 0.3722 - 49s/epoch - 108ms/step
Epoch 21/50
448/448 - 48s - loss: 3.1631 - accuracy30: 0.4402 - val_loss: 3.3125 - val_accuracy30: 0.3773 - 48s/epoch - 108ms/step
Epoch 22/50
448/448 - 48s - loss: 3.1553 - accuracy30: 0.4441 - val_loss: 3.3137 - val_accuracy30: 0.3785 - 48s/epoch - 107ms/step
Epoch 23/50
448/448 - 51s - loss: 3.1509 - accuracy30: 0.4462 - val_loss: 3.3299 - val_accuracy30: 0.3735 - 51s/epoch - 114ms/step
testing model: results/CHTR/W6/deepLOB_L2/h30
Evaluating performance on  test set...
1095/1095 - 56s - 56s/epoch - 51ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.144705
{'0': {'precision': 0.4823097463284379, 'recall': 0.08589346040678034, 'f1-score': 0.14581844174410294, 'support': 100939}, '1': {'precision': 0.2767834117899025, 'recall': 0.845110835301811, 'f1-score': 0.4169959172922429, 'support': 74931}, '2': {'precision': 0.44409434641699674, 'recall': 0.14199905967242057, 'f1-score': 0.21519088575936252, 'support': 104219}, 'accuracy': 0.3098800738336743, 'macro avg': {'precision': 0.4010625015117791, 'recall': 0.357667785127004, 'f1-score': 0.25933508159856944, 'support': 280089}, 'weighted avg': {'precision': 0.41310651258245906, 'recall': 0.3098800738336743, 'f1-score': 0.24417834221546744, 'support': 280089}}
[[ 8670 81545 10724]
 [ 3805 63325  7801]
 [ 5501 83919 14799]]
Evaluating performance on  train set...
448/448 - 25s - 25s/epoch - 56ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0933764
{'0': {'precision': 0.4009887284951552, 'recall': 0.26240327130619323, 'f1-score': 0.31722044928352416, 'support': 38639}, '1': {'precision': 0.3517220359646449, 'recall': 0.5796235592682669, 'f1-score': 0.4377888925494424, 'support': 37828}, '2': {'precision': 0.41276911655530807, 'recall': 0.29188650024936347, 'f1-score': 0.34195919245967676, 'support': 38097}, 'accuracy': 0.3769508746202996, 'macro avg': {'precision': 0.3884932936717027, 'recall': 0.3779711102746079, 'f1-score': 0.3656561780975478, 'support': 114564}, 'weighted avg': {'precision': 0.38863874943439874, 'recall': 0.3769508746202996, 'f1-score': 0.36525765966937873, 'support': 114564}}
[[10139 20694  7806]
 [ 7888 21926  8014]
 [ 7258 19719 11120]]
Evaluating performance on  val set...
136/136 - 8s - 8s/epoch - 56ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.100165
{'0': {'precision': 0.4190965583173996, 'recall': 0.29178800232964475, 'f1-score': 0.3440427723549321, 'support': 12019}, '1': {'precision': 0.33318815331010454, 'recall': 0.5037629350893698, 'f1-score': 0.40109355104486555, 'support': 10630}, '2': {'precision': 0.3913674634665634, 'recall': 0.33355328274496865, 'f1-score': 0.3601549628178296, 'support': 12124}, 'accuracy': 0.3711500301958416, 'macro avg': {'precision': 0.38121739169802255, 'recall': 0.3763680733879944, 'f1-score': 0.36843042873920906, 'support': 34773}, 'weighted avg': {'precision': 0.38316655828291646, 'recall': 0.3711500301958416, 'f1-score': 0.36710071888373785, 'support': 34773}}
[[3507 5370 3142]
 [2128 5355 3147]
 [2733 5347 4044]]
training model: results/CHTR/W6/deepLOB_L2/h50
Epoch 1/50
448/448 - 52s - loss: 3.3300 - accuracy50: 0.3491 - val_loss: 3.3453 - val_accuracy50: 0.3262 - 52s/epoch - 117ms/step
Epoch 2/50
448/448 - 45s - loss: 3.2939 - accuracy50: 0.3653 - val_loss: 3.3476 - val_accuracy50: 0.3232 - 45s/epoch - 100ms/step
Epoch 3/50
448/448 - 48s - loss: 3.2810 - accuracy50: 0.3717 - val_loss: 3.3390 - val_accuracy50: 0.3369 - 48s/epoch - 106ms/step
Epoch 4/50
448/448 - 48s - loss: 3.2708 - accuracy50: 0.3777 - val_loss: 3.3272 - val_accuracy50: 0.3390 - 48s/epoch - 107ms/step
Epoch 5/50
448/448 - 49s - loss: 3.2590 - accuracy50: 0.3867 - val_loss: 3.3242 - val_accuracy50: 0.3425 - 49s/epoch - 108ms/step
Epoch 6/50
448/448 - 49s - loss: 3.2544 - accuracy50: 0.3875 - val_loss: 3.3453 - val_accuracy50: 0.3367 - 49s/epoch - 109ms/step
Epoch 7/50
448/448 - 50s - loss: 3.2491 - accuracy50: 0.3953 - val_loss: 3.3442 - val_accuracy50: 0.3328 - 50s/epoch - 111ms/step
Epoch 8/50
448/448 - 48s - loss: 3.2442 - accuracy50: 0.3963 - val_loss: 3.3412 - val_accuracy50: 0.3394 - 48s/epoch - 108ms/step
Epoch 9/50
448/448 - 48s - loss: 3.2396 - accuracy50: 0.3979 - val_loss: 3.3276 - val_accuracy50: 0.3506 - 48s/epoch - 107ms/step
Epoch 10/50
448/448 - 49s - loss: 3.2349 - accuracy50: 0.4002 - val_loss: 3.3329 - val_accuracy50: 0.3487 - 49s/epoch - 110ms/step
Epoch 11/50
448/448 - 48s - loss: 3.2304 - accuracy50: 0.4037 - val_loss: 3.3398 - val_accuracy50: 0.3437 - 48s/epoch - 108ms/step
Epoch 12/50
448/448 - 45s - loss: 3.2257 - accuracy50: 0.4046 - val_loss: 3.3561 - val_accuracy50: 0.3400 - 45s/epoch - 101ms/step
Epoch 13/50
448/448 - 49s - loss: 3.2212 - accuracy50: 0.4079 - val_loss: 3.3517 - val_accuracy50: 0.3467 - 49s/epoch - 109ms/step
Epoch 14/50
448/448 - 46s - loss: 3.2156 - accuracy50: 0.4116 - val_loss: 3.3609 - val_accuracy50: 0.3420 - 46s/epoch - 104ms/step
Epoch 15/50
448/448 - 51s - loss: 3.2116 - accuracy50: 0.4140 - val_loss: 3.3599 - val_accuracy50: 0.3483 - 51s/epoch - 114ms/step
testing model: results/CHTR/W6/deepLOB_L2/h50
Evaluating performance on  test set...
1095/1095 - 56s - 56s/epoch - 51ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1241517
{'0': {'precision': 0.431539553490773, 'recall': 0.033384914890430786, 'f1-score': 0.06197527660915173, 'support': 100165}, '1': {'precision': 0.27283886311420136, 'recall': 0.8863514133927985, 'f1-score': 0.4172414431882035, 'support': 76235}, '2': {'precision': 0.40553462177383415, 'recall': 0.09652904358225077, 'f1-score': 0.1559398613383189, 'support': 103689}, 'accuracy': 0.2889224496499327, 'macro avg': {'precision': 0.36997101279293615, 'recall': 0.33875512395516005, 'f1-score': 0.21171886037855805, 'support': 280089}, 'weighted avg': {'precision': 0.3787171559826395, 'recall': 0.2889224496499327, 'f1-score': 0.19345780550224154, 'support': 280089}}
[[ 3344 88841  7980]
 [ 1972 67571  6692]
 [ 2433 91247 10009]]
Evaluating performance on  train set...
448/448 - 27s - 27s/epoch - 60ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1052115
{'0': {'precision': 0.3676900584795322, 'recall': 0.11852336693284461, 'f1-score': 0.17926228047597362, 'support': 38195}, '1': {'precision': 0.3301576630988519, 'recall': 0.827375625164517, 'f1-score': 0.4719767555352008, 'support': 37990}, '2': {'precision': 0.3945240459639665, 'recall': 0.07246150238411632, 'f1-score': 0.1224355023333627, 'support': 38379}, 'accuracy': 0.3381516008519256, 'macro avg': {'precision': 0.36412392251411685, 'recall': 0.33945349816049264, 'f1-score': 0.2578915127815124, 'support': 114564}, 'weighted avg': {'precision': 0.36423352680425075, 'recall': 0.3381516008519256, 'f1-score': 0.2572908757516691, 'support': 114564}}
[[ 4527 31637  2031]
 [ 4321 31432  2237]
 [ 3464 32134  2781]]
Evaluating performance on  val set...
136/136 - 8s - 8s/epoch - 61ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1083254
{'0': {'precision': 0.41425908667287975, 'recall': 0.15126765356474392, 'f1-score': 0.22161286301882088, 'support': 11754}, '1': {'precision': 0.3242231638418079, 'recall': 0.8396890717878372, 'f1-score': 0.4678130174500063, 'support': 10935}, '2': {'precision': 0.41647385469689957, 'recall': 0.07447864945382324, 'f1-score': 0.12636012636012636, 'support': 12084}, 'accuracy': 0.3410692203721278, 'macro avg': {'precision': 0.38498536840386244, 'recall': 0.3551451249354682, 'f1-score': 0.2719286689429845, 'support': 34773}, 'weighted avg': {'precision': 0.3867153153745876, 'recall': 0.3410692203721278, 'f1-score': 0.26593358941347617, 'support': 34773}}
[[1778 9351  625]
 [1117 9182  636]
 [1397 9787  900]]
training model: results/CHTR/W6/deepLOB_L2/h100
Epoch 1/50
448/448 - 58s - loss: 3.3294 - accuracy100: 0.3522 - val_loss: 3.3717 - val_accuracy100: 0.3254 - 58s/epoch - 129ms/step
Epoch 2/50
448/448 - 51s - loss: 3.2950 - accuracy100: 0.3655 - val_loss: 3.4021 - val_accuracy100: 0.3239 - 51s/epoch - 115ms/step
Epoch 3/50
448/448 - 53s - loss: 3.2841 - accuracy100: 0.3754 - val_loss: 3.3869 - val_accuracy100: 0.3240 - 53s/epoch - 119ms/step
Epoch 4/50
448/448 - 52s - loss: 3.2757 - accuracy100: 0.3808 - val_loss: 3.3996 - val_accuracy100: 0.3230 - 52s/epoch - 116ms/step
Epoch 5/50
448/448 - 51s - loss: 3.2646 - accuracy100: 0.3878 - val_loss: 3.3734 - val_accuracy100: 0.3209 - 51s/epoch - 114ms/step
Epoch 6/50
448/448 - 53s - loss: 3.2620 - accuracy100: 0.3876 - val_loss: 3.3601 - val_accuracy100: 0.3325 - 53s/epoch - 118ms/step
Epoch 7/50
448/448 - 52s - loss: 3.2517 - accuracy100: 0.3957 - val_loss: 3.3423 - val_accuracy100: 0.3393 - 52s/epoch - 115ms/step
Epoch 8/50
448/448 - 48s - loss: 3.2453 - accuracy100: 0.3997 - val_loss: 3.3481 - val_accuracy100: 0.3479 - 48s/epoch - 108ms/step
Epoch 9/50
448/448 - 50s - loss: 3.2406 - accuracy100: 0.4034 - val_loss: 3.3521 - val_accuracy100: 0.3420 - 50s/epoch - 112ms/step
Epoch 10/50
448/448 - 49s - loss: 3.2334 - accuracy100: 0.4053 - val_loss: 3.3659 - val_accuracy100: 0.3407 - 49s/epoch - 110ms/step
Epoch 11/50
448/448 - 50s - loss: 3.2267 - accuracy100: 0.4104 - val_loss: 3.3726 - val_accuracy100: 0.3348 - 50s/epoch - 111ms/step
Epoch 12/50
448/448 - 51s - loss: 3.2210 - accuracy100: 0.4153 - val_loss: 3.3655 - val_accuracy100: 0.3402 - 51s/epoch - 114ms/step
Epoch 13/50
448/448 - 49s - loss: 3.2150 - accuracy100: 0.4178 - val_loss: 3.3853 - val_accuracy100: 0.3416 - 49s/epoch - 110ms/step
Epoch 14/50
448/448 - 50s - loss: 3.2081 - accuracy100: 0.4192 - val_loss: 3.3795 - val_accuracy100: 0.3431 - 50s/epoch - 111ms/step
Epoch 15/50
448/448 - 51s - loss: 3.2031 - accuracy100: 0.4235 - val_loss: 3.4123 - val_accuracy100: 0.3397 - 51s/epoch - 115ms/step
Epoch 16/50
448/448 - 53s - loss: 3.1953 - accuracy100: 0.4262 - val_loss: 3.3906 - val_accuracy100: 0.3445 - 53s/epoch - 119ms/step
Epoch 17/50
448/448 - 52s - loss: 3.1880 - accuracy100: 0.4287 - val_loss: 3.4119 - val_accuracy100: 0.3461 - 52s/epoch - 116ms/step
testing model: results/CHTR/W6/deepLOB_L2/h100
Evaluating performance on  test set...
1095/1095 - 61s - 61s/epoch - 56ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1228064
{'0': {'precision': 0.4079263977353149, 'recall': 0.05824575586095392, 'f1-score': 0.10193651074365549, 'support': 98960}, '1': {'precision': 0.2760070252972326, 'recall': 0.8231656886298294, 'f1-score': 0.41340093356892327, 'support': 76173}, '2': {'precision': 0.4125064466219701, 'recall': 0.15241625061930714, 'f1-score': 0.22258863471920742, 'support': 104956}, 'accuracy': 0.30156128944728283, 'macro avg': {'precision': 0.3654799565515059, 'recall': 0.3446092317033635, 'f1-score': 0.24597535967726206, 'support': 280089}, 'weighted avg': {'precision': 0.37376586038547877, 'recall': 0.30156128944728283, 'f1-score': 0.23185358640120415, 'support': 280089}}
[[ 5764 80550 12646]
 [ 3333 62703 10137]
 [ 5033 83926 15997]]
Evaluating performance on  train set...
448/448 - 24s - 24s/epoch - 54ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1092564
{'0': {'precision': 0.3480264253594626, 'recall': 0.1642346283828037, 'f1-score': 0.22315961839669657, 'support': 38171}, '1': {'precision': 0.3306759713761902, 'recall': 0.7380022174119635, 'f1-score': 0.45671297997990634, 'support': 37882}, '2': {'precision': 0.3839746793270032, 'recall': 0.11970605800939992, 'f1-score': 0.18251281746738723, 'support': 38511}, 'accuracy': 0.33898956042037637, 'macro avg': {'precision': 0.35422569202088533, 'recall': 0.34064763460138897, 'f1-score': 0.2874618052813301, 'support': 114564}, 'weighted avg': {'precision': 0.3543733869769832, 'recall': 0.33898956042037637, 'f1-score': 0.28672338618506393, 'support': 114564}}
[[ 6269 28096  3806]
 [ 6335 27957  3590]
 [ 5409 28492  4610]]
Evaluating performance on  val set...
136/136 - 7s - 7s/epoch - 55ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.115197
{'0': {'precision': 0.39603590127150334, 'recall': 0.18155323161323506, 'f1-score': 0.24897143528858584, 'support': 11666}, '1': {'precision': 0.3234162895927602, 'recall': 0.7888347282258806, 'f1-score': 0.45874896370978524, 'support': 10873}, '2': {'precision': 0.3759036144578313, 'recall': 0.08925944090240313, 'f1-score': 0.1442631613712927, 'support': 12234}, 'accuracy': 0.3389698904322319, 'macro avg': {'precision': 0.3651186017740316, 'recall': 0.353215800247173, 'f1-score': 0.2839945201232213, 'support': 34773}, 'weighted avg': {'precision': 0.36624579300757915, 'recall': 0.3389698904322319, 'f1-score': 0.27772679270438366, 'support': 34773}}
[[2118 8626  922]
 [1405 8577  891]
 [1825 9317 1092]]
training model: results/CHTR/W6/deepLOB_L2/h200
Epoch 1/50
448/448 - 54s - loss: 3.3249 - accuracy200: 0.3578 - val_loss: 3.4302 - val_accuracy200: 0.3097 - 54s/epoch - 121ms/step
Epoch 2/50
448/448 - 48s - loss: 3.2942 - accuracy200: 0.3647 - val_loss: 3.4476 - val_accuracy200: 0.2969 - 48s/epoch - 108ms/step
Epoch 3/50
448/448 - 51s - loss: 3.2845 - accuracy200: 0.3685 - val_loss: 3.4275 - val_accuracy200: 0.2977 - 51s/epoch - 113ms/step
Epoch 4/50
448/448 - 54s - loss: 3.2745 - accuracy200: 0.3784 - val_loss: 3.4040 - val_accuracy200: 0.2991 - 54s/epoch - 120ms/step
Epoch 5/50
448/448 - 50s - loss: 3.2679 - accuracy200: 0.3825 - val_loss: 3.3972 - val_accuracy200: 0.2982 - 50s/epoch - 111ms/step
Epoch 6/50
448/448 - 53s - loss: 3.2568 - accuracy200: 0.3903 - val_loss: 3.4021 - val_accuracy200: 0.3032 - 53s/epoch - 118ms/step
Epoch 7/50
448/448 - 50s - loss: 3.2466 - accuracy200: 0.3961 - val_loss: 3.4099 - val_accuracy200: 0.3052 - 50s/epoch - 111ms/step
Epoch 8/50
448/448 - 53s - loss: 3.2388 - accuracy200: 0.4019 - val_loss: 3.4099 - val_accuracy200: 0.3083 - 53s/epoch - 117ms/step
Epoch 9/50
448/448 - 51s - loss: 3.2327 - accuracy200: 0.4034 - val_loss: 3.4066 - val_accuracy200: 0.3158 - 51s/epoch - 115ms/step
Epoch 10/50
448/448 - 48s - loss: 3.2275 - accuracy200: 0.4081 - val_loss: 3.3992 - val_accuracy200: 0.3176 - 48s/epoch - 107ms/step
Epoch 11/50
448/448 - 49s - loss: 3.2198 - accuracy200: 0.4106 - val_loss: 3.4093 - val_accuracy200: 0.3197 - 49s/epoch - 110ms/step
Epoch 12/50
448/448 - 51s - loss: 3.2119 - accuracy200: 0.4171 - val_loss: 3.4082 - val_accuracy200: 0.3253 - 51s/epoch - 114ms/step
Epoch 13/50
448/448 - 49s - loss: 3.2051 - accuracy200: 0.4204 - val_loss: 3.4222 - val_accuracy200: 0.3280 - 49s/epoch - 110ms/step
Epoch 14/50
448/448 - 47s - loss: 3.1983 - accuracy200: 0.4226 - val_loss: 3.4186 - val_accuracy200: 0.3393 - 47s/epoch - 105ms/step
Epoch 15/50
448/448 - 47s - loss: 3.1927 - accuracy200: 0.4254 - val_loss: 3.4378 - val_accuracy200: 0.3278 - 47s/epoch - 105ms/step
testing model: results/CHTR/W6/deepLOB_L2/h200
Evaluating performance on  test set...
1095/1095 - 54s - 54s/epoch - 49ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1584411
{'0': {'precision': 0.4029126213592233, 'recall': 0.005049634459192261, 'f1-score': 0.00997426319637081, 'support': 98621}, '1': {'precision': 0.2621119350726303, 'recall': 0.9955126981096047, 'f1-score': 0.4149660444080584, 'support': 73318}, '2': {'precision': 0.36597938144329895, 'recall': 0.0013129912159038372, 'f1-score': 0.002616595109546887, 'support': 108150}, 'accuracy': 0.26287715690369845, 'macro avg': {'precision': 0.3436679792917175, 'recall': 0.3339584412615669, 'f1-score': 0.14251896757132534, 'support': 280089}, 'weighted avg': {'precision': 0.35179474591938936, 'recall': 0.26287715690369845, 'f1-score': 0.11314666772239113, 'support': 280089}}
[[   498  97959    164]
 [   247  72989     82]
 [   491 107517    142]]
Evaluating performance on  train set...
448/448 - 24s - 24s/epoch - 55ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1230335
{'0': {'precision': 0.3378590078328982, 'recall': 0.01709424291262649, 'f1-score': 0.032541997786942965, 'support': 37849}, '1': {'precision': 0.3309921454038549, 'recall': 0.9778252950027718, 'f1-score': 0.49457240136190667, 'support': 37881}, '2': {'precision': 0.5635135135135135, 'recall': 0.010738013081320493, 'f1-score': 0.0210744428159903, 'support': 38834}, 'accuracy': 0.33260884745644353, 'macro avg': {'precision': 0.4107882222500889, 'recall': 0.3352191836655729, 'f1-score': 0.18272961398827994, 'support': 114564}, 'weighted avg': {'precision': 0.4120790373179583, 'recall': 0.33260884745644353, 'f1-score': 0.18142683672483992, 'support': 114564}}
[[  647 37049   153]
 [  670 37041   170]
 [  598 37819   417]]
Evaluating performance on  val set...
136/136 - 7s - 7s/epoch - 51ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1352628
{'0': {'precision': 0.37272727272727274, 'recall': 0.021094151946492883, 'f1-score': 0.039928583022236654, 'support': 11662}, '1': {'precision': 0.29508244994110716, 'recall': 0.9773724763483859, 'f1-score': 0.45330558885395694, 'support': 10253}, '2': {'precision': 0.38562091503267976, 'recall': 0.004588582983356665, 'f1-score': 0.009069249096917992, 'support': 12858}, 'accuracy': 0.29695453368993185, 'macro avg': {'precision': 0.3511435459003532, 'recall': 0.3343517370927451, 'f1-score': 0.1674344736577039, 'support': 34773}, 'weighted avg': {'precision': 0.3546009702723902, 'recall': 0.29695453368993185, 'f1-score': 0.15040409923254006, 'support': 34773}}
[[  246 11363    53]
 [  191 10021    41]
 [  223 12576    59]]
training model: results/CHTR/W6/deepLOB_L2/h300
Epoch 1/50
448/448 - 51s - loss: 3.3171 - accuracy300: 0.3641 - val_loss: 3.4094 - val_accuracy300: 0.3009 - 51s/epoch - 113ms/step
Epoch 2/50
448/448 - 46s - loss: 3.2971 - accuracy300: 0.3684 - val_loss: 3.4647 - val_accuracy300: 0.2989 - 46s/epoch - 103ms/step
Epoch 3/50
448/448 - 45s - loss: 3.2779 - accuracy300: 0.3808 - val_loss: 3.4386 - val_accuracy300: 0.3184 - 45s/epoch - 101ms/step
Epoch 4/50
448/448 - 47s - loss: 3.2662 - accuracy300: 0.3879 - val_loss: 3.4678 - val_accuracy300: 0.3095 - 47s/epoch - 105ms/step
Epoch 5/50
448/448 - 46s - loss: 3.2504 - accuracy300: 0.3979 - val_loss: 3.4555 - val_accuracy300: 0.3167 - 46s/epoch - 103ms/step
Epoch 6/50
448/448 - 47s - loss: 3.2340 - accuracy300: 0.4074 - val_loss: 3.4266 - val_accuracy300: 0.3348 - 47s/epoch - 105ms/step
Epoch 7/50
448/448 - 48s - loss: 3.2274 - accuracy300: 0.4128 - val_loss: 3.4137 - val_accuracy300: 0.3424 - 48s/epoch - 106ms/step
Epoch 8/50
448/448 - 50s - loss: 3.2141 - accuracy300: 0.4172 - val_loss: 3.4440 - val_accuracy300: 0.3373 - 50s/epoch - 112ms/step
Epoch 9/50
448/448 - 48s - loss: 3.2065 - accuracy300: 0.4225 - val_loss: 3.4598 - val_accuracy300: 0.3380 - 48s/epoch - 107ms/step
Epoch 10/50
448/448 - 46s - loss: 3.1962 - accuracy300: 0.4282 - val_loss: 3.4181 - val_accuracy300: 0.3569 - 46s/epoch - 104ms/step
Epoch 11/50
448/448 - 49s - loss: 3.1860 - accuracy300: 0.4308 - val_loss: 3.4196 - val_accuracy300: 0.3634 - 49s/epoch - 110ms/step
testing model: results/CHTR/W6/deepLOB_L2/h300
Evaluating performance on  test set...
1095/1095 - 52s - 52s/epoch - 47ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1497537
{'0': {'precision': 0.43759177679882527, 'recall': 0.014999446329162346, 'f1-score': 0.029004691362831167, 'support': 99337}, '1': {'precision': 0.25547701239273085, 'recall': 0.8456621770933859, 'f1-score': 0.3924067884609144, 'support': 71499}, '2': {'precision': 0.4007197660760253, 'recall': 0.14676027202914335, 'f1-score': 0.21483794032130557, 'support': 109253}, 'accuracy': 0.27844006726433385, 'macro avg': {'precision': 0.36459618508919384, 'recall': 0.3358072984838972, 'f1-score': 0.21208314004835038, 'support': 280089}, 'weighted avg': {'precision': 0.3767204061710269, 'recall': 0.2784400672643338, 'f1-score': 0.19425833034499776, 'support': 280089}}
[[ 1490 84126 13721]
 [  777 60464 10258]
 [ 1138 92081 16034]]
Evaluating performance on  train set...
448/448 - 24s - 24s/epoch - 54ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.125899
{'0': {'precision': 0.314004059147579, 'recall': 0.0290014192753662, 'f1-score': 0.05309864679348891, 'support': 37343}, '1': {'precision': 0.32966893742264325, 'recall': 0.894349998678053, 'f1-score': 0.48175629486157, 'support': 37823}, '2': {'precision': 0.359746061603574, 'recall': 0.07766891720391898, 'f1-score': 0.12775551102204408, 'support': 39398}, 'accuracy': 0.33143046681330957, 'macro avg': {'precision': 0.33447301939126545, 'recall': 0.33367344505244606, 'f1-score': 0.2208701508923677, 'support': 114564}, 'weighted avg': {'precision': 0.3349062282736487, 'recall': 0.33143046681330957, 'f1-score': 0.22029296053738445, 'support': 114564}}
[[ 1083 33540  2720]
 [ 1270 33827  2726]
 [ 1096 35242  3060]]
Evaluating performance on  val set...
136/136 - 8s - 8s/epoch - 55ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.137886
{'0': {'precision': 0.38146341463414635, 'recall': 0.03353344768439108, 'f1-score': 0.06164761529365392, 'support': 11660}, '1': {'precision': 0.2933414275672567, 'recall': 0.9098206322465563, 'f1-score': 0.44364444659208974, 'support': 10091}, '2': {'precision': 0.38857142857142857, 'recall': 0.0731070496083551, 'f1-score': 0.12306101344364012, 'support': 13022}, 'accuracy': 0.3026486066775947, 'macro avg': {'precision': 0.3544587569242772, 'recall': 0.3388203765131008, 'f1-score': 0.2094510251097946, 'support': 34773}, 'weighted avg': {'precision': 0.3585525811138664, 'recall': 0.3026486066775947, 'f1-score': 0.19550018180622508, 'support': 34773}}
[[  391 10396   873]
 [  285  9181   625]
 [  349 11721   952]]
training model: results/CHTR/W6/deepLOB_L2/h500
Epoch 1/50
448/448 - 58s - loss: 3.3237 - accuracy500: 0.3626 - val_loss: 3.4980 - val_accuracy500: 0.3275 - 58s/epoch - 129ms/step
Epoch 2/50
448/448 - 47s - loss: 3.3039 - accuracy500: 0.3642 - val_loss: 3.4901 - val_accuracy500: 0.3032 - 47s/epoch - 106ms/step
Epoch 3/50
448/448 - 50s - loss: 3.2888 - accuracy500: 0.3673 - val_loss: 3.3665 - val_accuracy500: 0.2944 - 50s/epoch - 111ms/step
Epoch 4/50
448/448 - 51s - loss: 3.2746 - accuracy500: 0.3771 - val_loss: 3.3672 - val_accuracy500: 0.3022 - 51s/epoch - 114ms/step
Epoch 5/50
448/448 - 51s - loss: 3.2513 - accuracy500: 0.3956 - val_loss: 3.3988 - val_accuracy500: 0.3060 - 51s/epoch - 113ms/step
Epoch 6/50
448/448 - 47s - loss: 3.2374 - accuracy500: 0.4055 - val_loss: 3.4120 - val_accuracy500: 0.3032 - 47s/epoch - 105ms/step
Epoch 7/50
448/448 - 49s - loss: 3.2226 - accuracy500: 0.4139 - val_loss: 3.4335 - val_accuracy500: 0.3329 - 49s/epoch - 109ms/step
Epoch 8/50
448/448 - 49s - loss: 3.2135 - accuracy500: 0.4171 - val_loss: 3.4257 - val_accuracy500: 0.3370 - 49s/epoch - 109ms/step
Epoch 9/50
448/448 - 48s - loss: 3.2027 - accuracy500: 0.4224 - val_loss: 3.4522 - val_accuracy500: 0.3389 - 48s/epoch - 106ms/step
Epoch 10/50
448/448 - 48s - loss: 3.2020 - accuracy500: 0.4232 - val_loss: 3.4138 - val_accuracy500: 0.3536 - 48s/epoch - 107ms/step
Epoch 11/50
448/448 - 51s - loss: 3.1882 - accuracy500: 0.4295 - val_loss: 3.4158 - val_accuracy500: 0.3585 - 51s/epoch - 114ms/step
Epoch 12/50
448/448 - 50s - loss: 3.1737 - accuracy500: 0.4358 - val_loss: 3.4237 - val_accuracy500: 0.3603 - 50s/epoch - 111ms/step
Epoch 13/50
448/448 - 49s - loss: 3.1640 - accuracy500: 0.4403 - val_loss: 3.4181 - val_accuracy500: 0.3589 - 49s/epoch - 110ms/step
testing model: results/CHTR/W6/deepLOB_L2/h500
Evaluating performance on  test set...
1095/1095 - 52s - 52s/epoch - 47ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1406006
{'0': {'precision': 0.3472516718316751, 'recall': 0.021359418108853775, 'f1-score': 0.04024346445381169, 'support': 99675}, '1': {'precision': 0.24777412398323612, 'recall': 0.9672500433200485, 'f1-score': 0.39449344071614717, 'support': 69252}, '2': {'precision': 0.4334716459197787, 'recall': 0.01409654378294741, 'f1-score': 0.027305122106345347, 'support': 111162}, 'accuracy': 0.25234836069963473, 'macro avg': {'precision': 0.34283248057822996, 'recall': 0.3342353350706166, 'f1-score': 0.15401400909210142, 'support': 280089}, 'weighted avg': {'precision': 0.35687491878525657, 'recall': 0.25234836069963473, 'f1-score': 0.12269678230667348, 'support': 280089}}
[[  2129  96351   1195]
 [  1415  66984    853]
 [  2587 107008   1567]]
Evaluating performance on  train set...
448/448 - 25s - 25s/epoch - 57ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1107272
{'0': {'precision': 0.37869137232194555, 'recall': 0.017970488830269558, 'f1-score': 0.034312696747114374, 'support': 36393}, '1': {'precision': 0.3314124426672939, 'recall': 0.9697434947190089, 'f1-score': 0.49399929879446586, 'support': 37777}, '2': {'precision': 0.3738033072236728, 'recall': 0.021265534485319603, 'f1-score': 0.04024173147193854, 'support': 40394}, 'accuracy': 0.3329754547676408, 'macro avg': {'precision': 0.3613023740709707, 'recall': 0.33632650601153263, 'f1-score': 0.18951790900450627, 'support': 114564}, 'weighted avg': {'precision': 0.3613778652242237, 'recall': 0.3329754547676408, 'f1-score': 0.18798294389471173, 'support': 114564}}
[[  654 34963   776]
 [  480 36634   663]
 [  593 38942   859]]
Evaluating performance on  val set...
136/136 - 7s - 7s/epoch - 55ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1253556
{'0': {'precision': 0.3611940298507463, 'recall': 0.010493452432573065, 'f1-score': 0.020394404180010116, 'support': 11531}, '1': {'precision': 0.2910037262672266, 'recall': 0.9801773084968622, 'f1-score': 0.44877203384033015, 'support': 10039}, '2': {'precision': 0.45032051282051283, 'recall': 0.021283041732939482, 'f1-score': 0.04064511463079482, 'support': 13203}, 'accuracy': 0.29453886636183246, 'macro avg': {'precision': 0.3675060896461619, 'recall': 0.33731793422079154, 'f1-score': 0.16993718421704504, 'support': 34773}, 'weighted avg': {'precision': 0.37477055465375075, 'recall': 0.29453886636183246, 'f1-score': 0.1517564711354544, 'support': 34773}}
[[  121 11192   218]
 [   74  9840   125]
 [  140 12782   281]]
training model: results/CHTR/W6/deepLOB_L2/h1000
Epoch 1/50
448/448 - 55s - loss: 3.3438 - accuracy1000: 0.3638 - val_loss: 3.5216 - val_accuracy1000: 0.3164 - 55s/epoch - 123ms/step
Epoch 2/50
448/448 - 51s - loss: 3.3139 - accuracy1000: 0.3580 - val_loss: 3.3629 - val_accuracy1000: 0.3235 - 51s/epoch - 113ms/step
Epoch 3/50
448/448 - 51s - loss: 3.2928 - accuracy1000: 0.3696 - val_loss: 3.3559 - val_accuracy1000: 0.3395 - 51s/epoch - 114ms/step
Epoch 4/50
448/448 - 48s - loss: 3.2743 - accuracy1000: 0.3811 - val_loss: 3.3995 - val_accuracy1000: 0.3476 - 48s/epoch - 107ms/step
Epoch 5/50
448/448 - 49s - loss: 3.2539 - accuracy1000: 0.3946 - val_loss: 3.3086 - val_accuracy1000: 0.3826 - 49s/epoch - 109ms/step
Epoch 6/50
448/448 - 48s - loss: 3.2249 - accuracy1000: 0.4103 - val_loss: 3.3541 - val_accuracy1000: 0.3563 - 48s/epoch - 107ms/step
Epoch 7/50
448/448 - 48s - loss: 3.2006 - accuracy1000: 0.4242 - val_loss: 3.3720 - val_accuracy1000: 0.3580 - 48s/epoch - 108ms/step
Epoch 8/50
448/448 - 48s - loss: 3.1818 - accuracy1000: 0.4324 - val_loss: 3.3846 - val_accuracy1000: 0.3626 - 48s/epoch - 107ms/step
Epoch 9/50
448/448 - 49s - loss: 3.1709 - accuracy1000: 0.4367 - val_loss: 3.3946 - val_accuracy1000: 0.3570 - 49s/epoch - 109ms/step
Epoch 10/50
448/448 - 47s - loss: 3.1594 - accuracy1000: 0.4400 - val_loss: 3.3981 - val_accuracy1000: 0.3739 - 47s/epoch - 105ms/step
Epoch 11/50
448/448 - 50s - loss: 3.1501 - accuracy1000: 0.4475 - val_loss: 3.4424 - val_accuracy1000: 0.3373 - 50s/epoch - 111ms/step
Epoch 12/50
448/448 - 48s - loss: 3.1437 - accuracy1000: 0.4485 - val_loss: 3.4503 - val_accuracy1000: 0.3665 - 48s/epoch - 106ms/step
Epoch 13/50
448/448 - 46s - loss: 3.1243 - accuracy1000: 0.4569 - val_loss: 3.4796 - val_accuracy1000: 0.3684 - 46s/epoch - 102ms/step
Epoch 14/50
448/448 - 48s - loss: 3.1200 - accuracy1000: 0.4589 - val_loss: 3.4742 - val_accuracy1000: 0.3674 - 48s/epoch - 108ms/step
Epoch 15/50
448/448 - 50s - loss: 3.1054 - accuracy1000: 0.4631 - val_loss: 3.5089 - val_accuracy1000: 0.3652 - 50s/epoch - 113ms/step
testing model: results/CHTR/W6/deepLOB_L2/h1000
Evaluating performance on  test set...
1095/1095 - 56s - 56s/epoch - 51ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1111751
{'0': {'precision': 0.4612410986775178, 'recall': 0.13710311460538252, 'f1-score': 0.21137529137529137, 'support': 99210}, '1': {'precision': 0.22352281488750264, 'recall': 0.04195224626718411, 'f1-score': 0.07064531135774571, 'support': 76015}, '2': {'precision': 0.3820938340977946, 'recall': 0.8611248855660665, 'f1-score': 0.529320390625916, 'support': 104864}, 'accuracy': 0.3823498959259378, 'macro avg': {'precision': 0.3556192492209383, 'recall': 0.34672674881287774, 'f1-score': 0.2704469977863177, 'support': 280089}, 'weighted avg': {'precision': 0.36709297399148555, 'recall': 0.3823498959259378, 'f1-score': 0.2922188998596794, 'support': 280089}}
[[13602  5939 79669]
 [ 6464  3189 66362]
 [ 9424  5139 90301]]
Evaluating performance on  train set...
448/448 - 22s - 22s/epoch - 50ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.109636
{'0': {'precision': 0.31805084020427377, 'recall': 0.32023440193036884, 'f1-score': 0.319138886105664, 'support': 34812}, '1': {'precision': 0.38345246378645076, 'recall': 0.16135643748835476, 'f1-score': 0.22713477462625054, 'support': 37569}, '2': {'precision': 0.37247268617355267, 'recall': 0.5625014816395231, 'f1-score': 0.44817588561390914, 'support': 42183}, 'accuracy': 0.3573373834712475, 'macro avg': {'precision': 0.35799199672142573, 'recall': 0.3480307736860822, 'f1-score': 0.33148318211527456, 'support': 114564}, 'weighted avg': {'precision': 0.35953638823752065, 'recall': 0.3573373834712475, 'f1-score': 0.3364799817909248, 'support': 114564}}
[[11148  3464 20200]
 [11731  6062 19776]
 [12172  6283 23728]]
Evaluating performance on  val set...
136/136 - 7s - 7s/epoch - 54ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0967956
{'0': {'precision': 0.3930978149887686, 'recall': 0.343657948763724, 'f1-score': 0.36671905510311, 'support': 11203}, '1': {'precision': 0.28353228083686305, 'recall': 0.21680243399744822, 'f1-score': 0.2457174638487208, 'support': 10189}, '2': {'precision': 0.42349313474517103, 'recall': 0.543980270532845, 'f1-score': 0.4762340933625568, 'support': 13381}, 'accuracy': 0.3835734621689242, 'macro avg': {'precision': 0.36670774352360097, 'recall': 0.36814688443133914, 'f1-score': 0.3628902041047959, 'support': 34773}, 'weighted avg': {'precision': 0.37268992801285783, 'recall': 0.3835734621689242, 'f1-score': 0.37340629847177775, 'support': 34773}}
[[3850 2710 4643]
 [2714 2209 5266]
 [3230 2872 7279]]
training model: results/CHTR/W6/deepOF_L2/h10
Epoch 1/50
448/448 - 39s - loss: 3.3183 - accuracy10: 0.3558 - val_loss: 3.2945 - val_accuracy10: 0.3609 - 39s/epoch - 88ms/step
Epoch 2/50
448/448 - 37s - loss: 3.2637 - accuracy10: 0.3923 - val_loss: 3.2647 - val_accuracy10: 0.3833 - 37s/epoch - 83ms/step
Epoch 3/50
448/448 - 36s - loss: 3.2366 - accuracy10: 0.4079 - val_loss: 3.2404 - val_accuracy10: 0.4022 - 36s/epoch - 80ms/step
Epoch 4/50
448/448 - 37s - loss: 3.2136 - accuracy10: 0.4202 - val_loss: 3.2238 - val_accuracy10: 0.4121 - 37s/epoch - 82ms/step
Epoch 5/50
448/448 - 35s - loss: 3.1982 - accuracy10: 0.4261 - val_loss: 3.2186 - val_accuracy10: 0.4133 - 35s/epoch - 79ms/step
Epoch 6/50
448/448 - 37s - loss: 3.1855 - accuracy10: 0.4330 - val_loss: 3.2062 - val_accuracy10: 0.4188 - 37s/epoch - 83ms/step
Epoch 7/50
448/448 - 36s - loss: 3.1741 - accuracy10: 0.4382 - val_loss: 3.2032 - val_accuracy10: 0.4178 - 36s/epoch - 79ms/step
Epoch 8/50
448/448 - 34s - loss: 3.1637 - accuracy10: 0.4420 - val_loss: 3.2017 - val_accuracy10: 0.4198 - 34s/epoch - 77ms/step
Epoch 9/50
448/448 - 35s - loss: 3.1561 - accuracy10: 0.4457 - val_loss: 3.2010 - val_accuracy10: 0.4198 - 35s/epoch - 79ms/step
Epoch 10/50
448/448 - 36s - loss: 3.1472 - accuracy10: 0.4497 - val_loss: 3.1950 - val_accuracy10: 0.4212 - 36s/epoch - 81ms/step
Epoch 11/50
448/448 - 35s - loss: 3.1388 - accuracy10: 0.4529 - val_loss: 3.1947 - val_accuracy10: 0.4240 - 35s/epoch - 78ms/step
Epoch 12/50
448/448 - 37s - loss: 3.1305 - accuracy10: 0.4547 - val_loss: 3.1925 - val_accuracy10: 0.4248 - 37s/epoch - 82ms/step
Epoch 13/50
448/448 - 34s - loss: 3.1215 - accuracy10: 0.4583 - val_loss: 3.1908 - val_accuracy10: 0.4258 - 34s/epoch - 77ms/step
Epoch 14/50
448/448 - 34s - loss: 3.1160 - accuracy10: 0.4613 - val_loss: 3.1917 - val_accuracy10: 0.4267 - 34s/epoch - 76ms/step
Epoch 15/50
448/448 - 38s - loss: 3.1076 - accuracy10: 0.4642 - val_loss: 3.1928 - val_accuracy10: 0.4259 - 38s/epoch - 84ms/step
Epoch 16/50
448/448 - 37s - loss: 3.1011 - accuracy10: 0.4666 - val_loss: 3.1974 - val_accuracy10: 0.4257 - 37s/epoch - 83ms/step
Epoch 17/50
448/448 - 36s - loss: 3.0958 - accuracy10: 0.4680 - val_loss: 3.1951 - val_accuracy10: 0.4279 - 36s/epoch - 80ms/step
Epoch 18/50
448/448 - 38s - loss: 3.0884 - accuracy10: 0.4705 - val_loss: 3.1968 - val_accuracy10: 0.4253 - 38s/epoch - 84ms/step
Epoch 19/50
448/448 - 38s - loss: 3.0772 - accuracy10: 0.4755 - val_loss: 3.1992 - val_accuracy10: 0.4284 - 38s/epoch - 85ms/step
Epoch 20/50
448/448 - 37s - loss: 3.0734 - accuracy10: 0.4755 - val_loss: 3.1990 - val_accuracy10: 0.4239 - 37s/epoch - 83ms/step
Epoch 21/50
448/448 - 35s - loss: 3.0639 - accuracy10: 0.4792 - val_loss: 3.2073 - val_accuracy10: 0.4247 - 35s/epoch - 78ms/step
Epoch 22/50
448/448 - 36s - loss: 3.0586 - accuracy10: 0.4822 - val_loss: 3.2055 - val_accuracy10: 0.4277 - 36s/epoch - 81ms/step
Epoch 23/50
448/448 - 36s - loss: 3.0521 - accuracy10: 0.4837 - val_loss: 3.2105 - val_accuracy10: 0.4250 - 36s/epoch - 79ms/step
testing model: results/CHTR/W6/deepOF_L2/h10
Evaluating performance on  test set...
1095/1095 - 40s - 40s/epoch - 37ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0742967
{'0': {'precision': 0.44733698897877194, 'recall': 0.3282734715830993, 'f1-score': 0.378666544113423, 'support': 100398}, '1': {'precision': 0.3244227379128977, 'recall': 0.30875436618168817, 'f1-score': 0.3163946901158366, 'support': 72718}, '2': {'precision': 0.44336088395212897, 'recall': 0.5686747438486276, 'f1-score': 0.4982594094278576, 'support': 106968}, 'accuracy': 0.41501835163736595, 'macro avg': {'precision': 0.4050402036145995, 'recall': 0.401900860537805, 'f1-score': 0.3977735478857058, 'support': 280084}, 'weighted avg': {'precision': 0.41390632349449513, 'recall': 0.41501835163736595, 'f1-score': 0.4081731383421471, 'support': 280084}}
[[32958 23098 44342]
 [18236 22452 32030]
 [22482 23656 60830]]
Evaluating performance on  train set...
448/448 - 18s - 18s/epoch - 41ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.047347
{'0': {'precision': 0.4618054498401583, 'recall': 0.3804077947483259, 'f1-score': 0.41717318958167166, 'support': 39873}, '1': {'precision': 0.4529373225595108, 'recall': 0.504568308374331, 'f1-score': 0.47736078255865994, 'support': 36994}, '2': {'precision': 0.4382452415631866, 'recall': 0.47092529711375214, 'f1-score': 0.45399792846821735, 'support': 37696}, 'accuracy': 0.4502849960283861, 'macro avg': {'precision': 0.4509960046542852, 'recall': 0.4519671334121363, 'f1-score': 0.449510633536183, 'support': 114563}, 'weighted avg': {'precision': 0.45118951701866267, 'recall': 0.4502849960283861, 'f1-score': 0.44872548108641513, 'support': 114563}}
[[15168 11630 13075]
 [ 8648 18666  9680]
 [ 9029 10915 17752]]
Evaluating performance on  val set...
136/136 - 6s - 6s/epoch - 44ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0660887
{'0': {'precision': 0.44025338324215374, 'recall': 0.3703374777975133, 'f1-score': 0.4022802017101513, 'support': 12386}, '1': {'precision': 0.41094593315026984, 'recall': 0.42156386595434675, 'f1-score': 0.416187188339087, 'support': 10295}, '2': {'precision': 0.4277532081490611, 'recall': 0.48792590142242803, 'f1-score': 0.45586246861116475, 'support': 12092}, 'accuracy': 0.426394041353924, 'macro avg': {'precision': 0.4263175081804949, 'recall': 0.4266090817247627, 'f1-score': 0.4247766195534677, 'support': 34773}, 'weighted avg': {'precision': 0.4272297063686708, 'recall': 0.426394041353924, 'f1-score': 0.42503030088801763, 'support': 34773}}
[[4587 3208 4591]
 [2653 4340 3302]
 [3179 3013 5900]]
training model: results/CHTR/W6/deepOF_L2/h20
Epoch 1/50
448/448 - 43s - loss: 3.3267 - accuracy20: 0.3487 - val_loss: 3.3147 - val_accuracy20: 0.3420 - 43s/epoch - 95ms/step
Epoch 2/50
448/448 - 37s - loss: 3.2836 - accuracy20: 0.3758 - val_loss: 3.2927 - val_accuracy20: 0.3593 - 37s/epoch - 82ms/step
Epoch 3/50
448/448 - 37s - loss: 3.2640 - accuracy20: 0.3899 - val_loss: 3.2806 - val_accuracy20: 0.3692 - 37s/epoch - 82ms/step
Epoch 4/50
448/448 - 35s - loss: 3.2495 - accuracy20: 0.4007 - val_loss: 3.2699 - val_accuracy20: 0.3783 - 35s/epoch - 78ms/step
Epoch 5/50
448/448 - 35s - loss: 3.2385 - accuracy20: 0.4074 - val_loss: 3.2614 - val_accuracy20: 0.3847 - 35s/epoch - 78ms/step
Epoch 6/50
448/448 - 37s - loss: 3.2294 - accuracy20: 0.4110 - val_loss: 3.2530 - val_accuracy20: 0.3894 - 37s/epoch - 82ms/step
Epoch 7/50
448/448 - 35s - loss: 3.2198 - accuracy20: 0.4147 - val_loss: 3.2469 - val_accuracy20: 0.3958 - 35s/epoch - 78ms/step
Epoch 8/50
448/448 - 36s - loss: 3.2126 - accuracy20: 0.4193 - val_loss: 3.2468 - val_accuracy20: 0.3938 - 36s/epoch - 81ms/step
Epoch 9/50
448/448 - 35s - loss: 3.2048 - accuracy20: 0.4251 - val_loss: 3.2449 - val_accuracy20: 0.3967 - 35s/epoch - 77ms/step
Epoch 10/50
448/448 - 36s - loss: 3.1981 - accuracy20: 0.4277 - val_loss: 3.2436 - val_accuracy20: 0.3969 - 36s/epoch - 81ms/step
Epoch 11/50
448/448 - 35s - loss: 3.1908 - accuracy20: 0.4297 - val_loss: 3.2434 - val_accuracy20: 0.3994 - 35s/epoch - 79ms/step
Epoch 12/50
448/448 - 34s - loss: 3.1846 - accuracy20: 0.4327 - val_loss: 3.2436 - val_accuracy20: 0.3962 - 34s/epoch - 76ms/step
Epoch 13/50
448/448 - 35s - loss: 3.1791 - accuracy20: 0.4348 - val_loss: 3.2454 - val_accuracy20: 0.3982 - 35s/epoch - 77ms/step
Epoch 14/50
448/448 - 34s - loss: 3.1707 - accuracy20: 0.4377 - val_loss: 3.2450 - val_accuracy20: 0.3998 - 34s/epoch - 76ms/step
Epoch 15/50
448/448 - 34s - loss: 3.1641 - accuracy20: 0.4409 - val_loss: 3.2486 - val_accuracy20: 0.3977 - 34s/epoch - 77ms/step
Epoch 16/50
448/448 - 37s - loss: 3.1575 - accuracy20: 0.4433 - val_loss: 3.2479 - val_accuracy20: 0.4001 - 37s/epoch - 82ms/step
Epoch 17/50
448/448 - 38s - loss: 3.1511 - accuracy20: 0.4474 - val_loss: 3.2503 - val_accuracy20: 0.3969 - 38s/epoch - 85ms/step
Epoch 18/50
448/448 - 38s - loss: 3.1442 - accuracy20: 0.4491 - val_loss: 3.2530 - val_accuracy20: 0.3973 - 38s/epoch - 85ms/step
Epoch 19/50
448/448 - 37s - loss: 3.1336 - accuracy20: 0.4534 - val_loss: 3.2616 - val_accuracy20: 0.3973 - 37s/epoch - 81ms/step
Epoch 20/50
448/448 - 36s - loss: 3.1292 - accuracy20: 0.4552 - val_loss: 3.2626 - val_accuracy20: 0.3938 - 36s/epoch - 81ms/step
Epoch 21/50
448/448 - 36s - loss: 3.1226 - accuracy20: 0.4583 - val_loss: 3.2700 - val_accuracy20: 0.3943 - 36s/epoch - 79ms/step
testing model: results/CHTR/W6/deepOF_L2/h20
Evaluating performance on  test set...
1095/1095 - 39s - 39s/epoch - 35ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.084496
{'0': {'precision': 0.4558399076390225, 'recall': 0.28024447949526815, 'f1-score': 0.34709775097067225, 'support': 101440}, '1': {'precision': 0.2945190719057539, 'recall': 0.2780151077478064, 'f1-score': 0.2860292168380516, 'support': 73737}, '2': {'precision': 0.42115248286804174, 'recall': 0.5946123709571335, 'f1-score': 0.4930717487016939, 'support': 104907}, 'accuracy': 0.39740577826652007, 'macro avg': {'precision': 0.39050382080427265, 'recall': 0.3842906527334027, 'f1-score': 0.37539957217013925, 'support': 280084}, 'weighted avg': {'precision': 0.40037701745281656, 'recall': 0.39740577826652007, 'f1-score': 0.38569575613566287, 'support': 280084}}
[[28428 25190 47822]
 [15323 20500 37914]
 [18613 23915 62379]]
Evaluating performance on  train set...
448/448 - 18s - 18s/epoch - 39ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0688769
{'0': {'precision': 0.4459430375206256, 'recall': 0.3161990996261159, 'f1-score': 0.37002753181040254, 'support': 39317}, '1': {'precision': 0.40641699172510204, 'recall': 0.4829979367078432, 'f1-score': 0.4414105546712379, 'support': 37319}, '2': {'precision': 0.41470213067510747, 'recall': 0.46288923458222375, 'f1-score': 0.4374727451688865, 'support': 37927}, 'accuracy': 0.41909691610729466, 'macro avg': {'precision': 0.42235405330694503, 'recall': 0.42069542363872764, 'f1-score': 0.4163036105501756, 'support': 114563}, 'weighted avg': {'precision': 0.42272483987415066, 'recall': 0.41909691610729466, 'f1-score': 0.4156088943549478, 'support': 114563}}
[[12432 13492 13393]
 [ 7909 18025 11385]
 [ 7537 12834 17556]]
Evaluating performance on  val set...
136/136 - 5s - 5s/epoch - 38ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.08253
{'0': {'precision': 0.4261888663511382, 'recall': 0.309923789232156, 'f1-score': 0.3588746026474356, 'support': 12203}, '1': {'precision': 0.36209383218800373, 'recall': 0.40589633856395624, 'f1-score': 0.38274594206797596, 'support': 10515}, '2': {'precision': 0.4087301587301587, 'recall': 0.4784736623807549, 'f1-score': 0.4408606259792869, 'support': 12055}, 'accuracy': 0.39737727547234925, 'macro avg': {'precision': 0.39900428575643354, 'recall': 0.3980979300589557, 'f1-score': 0.3941603902315662, 'support': 34773}, 'weighted avg': {'precision': 0.40075465001673316, 'recall': 0.39737727547234925, 'f1-score': 0.39451572205825575, 'support': 34773}}
[[3782 3883 4538]
 [2441 4268 3806]
 [2651 3636 5768]]
training model: results/CHTR/W6/deepOF_L2/h30
Epoch 1/50
448/448 - 44s - loss: 3.3309 - accuracy30: 0.3457 - val_loss: 3.3231 - val_accuracy30: 0.3378 - 44s/epoch - 99ms/step
Epoch 2/50
448/448 - 36s - loss: 3.2908 - accuracy30: 0.3683 - val_loss: 3.3064 - val_accuracy30: 0.3450 - 36s/epoch - 79ms/step
Epoch 3/50
448/448 - 37s - loss: 3.2753 - accuracy30: 0.3805 - val_loss: 3.2990 - val_accuracy30: 0.3464 - 37s/epoch - 83ms/step
Epoch 4/50
448/448 - 35s - loss: 3.2664 - accuracy30: 0.3857 - val_loss: 3.2867 - val_accuracy30: 0.3563 - 35s/epoch - 79ms/step
Epoch 5/50
448/448 - 36s - loss: 3.2558 - accuracy30: 0.3925 - val_loss: 3.2813 - val_accuracy30: 0.3630 - 36s/epoch - 81ms/step
Epoch 6/50
448/448 - 38s - loss: 3.2494 - accuracy30: 0.3959 - val_loss: 3.2740 - val_accuracy30: 0.3722 - 38s/epoch - 84ms/step
Epoch 7/50
448/448 - 38s - loss: 3.2419 - accuracy30: 0.4001 - val_loss: 3.2708 - val_accuracy30: 0.3758 - 38s/epoch - 84ms/step
Epoch 8/50
448/448 - 38s - loss: 3.2350 - accuracy30: 0.4052 - val_loss: 3.2681 - val_accuracy30: 0.3797 - 38s/epoch - 85ms/step
Epoch 9/50
448/448 - 38s - loss: 3.2294 - accuracy30: 0.4081 - val_loss: 3.2682 - val_accuracy30: 0.3813 - 38s/epoch - 85ms/step
Epoch 10/50
448/448 - 39s - loss: 3.2233 - accuracy30: 0.4131 - val_loss: 3.2696 - val_accuracy30: 0.3841 - 39s/epoch - 86ms/step
Epoch 11/50
448/448 - 39s - loss: 3.2167 - accuracy30: 0.4159 - val_loss: 3.2628 - val_accuracy30: 0.3881 - 39s/epoch - 88ms/step
Epoch 12/50
448/448 - 35s - loss: 3.2112 - accuracy30: 0.4184 - val_loss: 3.2674 - val_accuracy30: 0.3852 - 35s/epoch - 78ms/step
Epoch 13/50
448/448 - 34s - loss: 3.2055 - accuracy30: 0.4219 - val_loss: 3.2675 - val_accuracy30: 0.3854 - 34s/epoch - 77ms/step
Epoch 14/50
448/448 - 36s - loss: 3.1989 - accuracy30: 0.4236 - val_loss: 3.2724 - val_accuracy30: 0.3847 - 36s/epoch - 80ms/step
Epoch 15/50
448/448 - 37s - loss: 3.1927 - accuracy30: 0.4277 - val_loss: 3.2721 - val_accuracy30: 0.3821 - 37s/epoch - 83ms/step
Epoch 16/50
448/448 - 36s - loss: 3.1848 - accuracy30: 0.4329 - val_loss: 3.2765 - val_accuracy30: 0.3864 - 36s/epoch - 80ms/step
Epoch 17/50
448/448 - 38s - loss: 3.1782 - accuracy30: 0.4340 - val_loss: 3.2788 - val_accuracy30: 0.3844 - 38s/epoch - 84ms/step
Epoch 18/50
448/448 - 39s - loss: 3.1720 - accuracy30: 0.4381 - val_loss: 3.2792 - val_accuracy30: 0.3854 - 39s/epoch - 88ms/step
Epoch 19/50
448/448 - 38s - loss: 3.1639 - accuracy30: 0.4405 - val_loss: 3.2920 - val_accuracy30: 0.3785 - 38s/epoch - 84ms/step
Epoch 20/50
448/448 - 37s - loss: 3.1580 - accuracy30: 0.4442 - val_loss: 3.2987 - val_accuracy30: 0.3758 - 37s/epoch - 83ms/step
Epoch 21/50
448/448 - 39s - loss: 3.1513 - accuracy30: 0.4458 - val_loss: 3.2982 - val_accuracy30: 0.3794 - 39s/epoch - 87ms/step
testing model: results/CHTR/W6/deepOF_L2/h30
Evaluating performance on  test set...
1095/1095 - 41s - 41s/epoch - 37ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0908862
{'0': {'precision': 0.4375231738969225, 'recall': 0.3273328908130814, 'f1-score': 0.37449065756887095, 'support': 100937}, '1': {'precision': 0.27881730022824436, 'recall': 0.3211621358316318, 'f1-score': 0.29849542923059746, 'support': 74931}, '2': {'precision': 0.42441462239021793, 'recall': 0.48159591617409997, 'f1-score': 0.45120081987477134, 'support': 104216}, 'accuracy': 0.38308150412019254, 'macro avg': {'precision': 0.3802516988384616, 'recall': 0.37669698093960435, 'f1-score': 0.3747289688914132, 'support': 280084}, 'weighted avg': {'precision': 0.3901869796705817, 'recall': 0.38308150412019254, 'f1-score': 0.38270257906476696, 'support': 280084}}
[[33040 31589 36308]
 [19107 24065 31759]
 [23369 30657 50190]]
Evaluating performance on  train set...
448/448 - 18s - 18s/epoch - 41ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0753094
{'0': {'precision': 0.4317128179426137, 'recall': 0.3563910941015231, 'f1-score': 0.390452581627594, 'support': 38671}, '1': {'precision': 0.3849776744755031, 'recall': 0.4996559936491135, 'f1-score': 0.4348837477112291, 'support': 37790}, '2': {'precision': 0.42626220528697306, 'recall': 0.37580704424964567, 'f1-score': 0.3994476525232237, 'support': 38102}, 'accuracy': 0.4101062297600447, 'macro avg': {'precision': 0.4143175659016966, 'recall': 0.4106180440000941, 'f1-score': 0.40826132728734893, 'support': 114563}, 'weighted avg': {'precision': 0.4144838669285225, 'recall': 0.4101062297600447, 'f1-score': 0.4081003733017458, 'support': 114563}}
[[13782 15240  9649]
 [ 9284 18882  9624]
 [ 8858 14925 14319]]
Evaluating performance on  val set...
136/136 - 4s - 4s/epoch - 32ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0884523
{'0': {'precision': 0.41166858900422915, 'recall': 0.3559378376132303, 'f1-score': 0.38178009537817004, 'support': 12033}, '1': {'precision': 0.3463682883983808, 'recall': 0.42634201372567454, 'f1-score': 0.38221660345554154, 'support': 10637}, '2': {'precision': 0.4198297268534941, 'recall': 0.39114269189457157, 'f1-score': 0.4049788271525728, 'support': 12103}, 'accuracy': 0.3897276622667012, 'macro avg': {'precision': 0.39262220141870136, 'recall': 0.39114084774449215, 'f1-score': 0.3896585086620948, 'support': 34773}, 'weighted avg': {'precision': 0.3945338854654274, 'recall': 0.3897276622667012, 'f1-score': 0.3899881127216433, 'support': 34773}}
[[4283 4319 3431]
 [2991 4535 3111]
 [3130 4239 4734]]
training model: results/CHTR/W6/deepOF_L2/h50
Epoch 1/50
448/448 - 39s - loss: 3.3313 - accuracy50: 0.3445 - val_loss: 3.3285 - val_accuracy50: 0.3344 - 39s/epoch - 86ms/step
Epoch 2/50
448/448 - 39s - loss: 3.2952 - accuracy50: 0.3673 - val_loss: 3.3192 - val_accuracy50: 0.3382 - 39s/epoch - 88ms/step
Epoch 3/50
448/448 - 38s - loss: 3.2817 - accuracy50: 0.3734 - val_loss: 3.3120 - val_accuracy50: 0.3424 - 38s/epoch - 85ms/step
Epoch 4/50
448/448 - 36s - loss: 3.2741 - accuracy50: 0.3790 - val_loss: 3.3044 - val_accuracy50: 0.3453 - 36s/epoch - 80ms/step
Epoch 5/50
448/448 - 37s - loss: 3.2636 - accuracy50: 0.3851 - val_loss: 3.3009 - val_accuracy50: 0.3477 - 37s/epoch - 82ms/step
Epoch 6/50
448/448 - 39s - loss: 3.2585 - accuracy50: 0.3899 - val_loss: 3.2939 - val_accuracy50: 0.3573 - 39s/epoch - 87ms/step
Epoch 7/50
448/448 - 36s - loss: 3.2529 - accuracy50: 0.3922 - val_loss: 3.2957 - val_accuracy50: 0.3573 - 36s/epoch - 80ms/step
Epoch 8/50
448/448 - 38s - loss: 3.2450 - accuracy50: 0.3973 - val_loss: 3.2941 - val_accuracy50: 0.3594 - 38s/epoch - 85ms/step
Epoch 9/50
448/448 - 37s - loss: 3.2403 - accuracy50: 0.4007 - val_loss: 3.2962 - val_accuracy50: 0.3585 - 37s/epoch - 83ms/step
Epoch 10/50
448/448 - 35s - loss: 3.2346 - accuracy50: 0.4038 - val_loss: 3.2930 - val_accuracy50: 0.3632 - 35s/epoch - 78ms/step
Epoch 11/50
448/448 - 37s - loss: 3.2302 - accuracy50: 0.4073 - val_loss: 3.2988 - val_accuracy50: 0.3614 - 37s/epoch - 82ms/step
Epoch 12/50
448/448 - 38s - loss: 3.2242 - accuracy50: 0.4094 - val_loss: 3.2976 - val_accuracy50: 0.3652 - 38s/epoch - 86ms/step
Epoch 13/50
448/448 - 38s - loss: 3.2186 - accuracy50: 0.4119 - val_loss: 3.2988 - val_accuracy50: 0.3638 - 38s/epoch - 85ms/step
Epoch 14/50
448/448 - 39s - loss: 3.2120 - accuracy50: 0.4161 - val_loss: 3.3020 - val_accuracy50: 0.3666 - 39s/epoch - 86ms/step
Epoch 15/50
448/448 - 39s - loss: 3.2037 - accuracy50: 0.4200 - val_loss: 3.3083 - val_accuracy50: 0.3627 - 39s/epoch - 87ms/step
Epoch 16/50
448/448 - 37s - loss: 3.1987 - accuracy50: 0.4219 - val_loss: 3.3101 - val_accuracy50: 0.3665 - 37s/epoch - 84ms/step
Epoch 17/50
448/448 - 41s - loss: 3.1917 - accuracy50: 0.4259 - val_loss: 3.3161 - val_accuracy50: 0.3658 - 41s/epoch - 91ms/step
Epoch 18/50
448/448 - 39s - loss: 3.1852 - accuracy50: 0.4294 - val_loss: 3.3269 - val_accuracy50: 0.3622 - 39s/epoch - 86ms/step
Epoch 19/50
448/448 - 39s - loss: 3.1814 - accuracy50: 0.4288 - val_loss: 3.3287 - val_accuracy50: 0.3632 - 39s/epoch - 86ms/step
Epoch 20/50
448/448 - 37s - loss: 3.1744 - accuracy50: 0.4346 - val_loss: 3.3301 - val_accuracy50: 0.3665 - 37s/epoch - 82ms/step
testing model: results/CHTR/W6/deepOF_L2/h50
Evaluating performance on  test set...
1095/1095 - 39s - 39s/epoch - 35ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0981778
{'0': {'precision': 0.453832574560996, 'recall': 0.2438325529387099, 'f1-score': 0.31722713634415306, 'support': 100163}, '1': {'precision': 0.27345527192754193, 'recall': 0.4273290133011517, 'f1-score': 0.33349883551301407, 'support': 76234}, '2': {'precision': 0.4162015344695626, 'recall': 0.43005391225515255, 'f1-score': 0.4230143483932171, 'support': 103687}, 'accuracy': 0.36271618514445664, 'macro avg': {'precision': 0.38116312698603355, 'recall': 0.3670718261650047, 'f1-score': 0.35791344008346143, 'support': 280084}, 'weighted avg': {'precision': 0.3908060077349038, 'recall': 0.36271618514445664, 'f1-score': 0.3608183995729353, 'support': 280084}}
[[24423 43573 32167]
 [13277 32577 30380]
 [16115 42981 44591]]
Evaluating performance on  train set...
448/448 - 18s - 18s/epoch - 41ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0829604
{'0': {'precision': 0.42578078376765466, 'recall': 0.28064930637505575, 'f1-score': 0.338306884997155, 'support': 38133}, '1': {'precision': 0.35728636905883093, 'recall': 0.5970830491579665, 'f1-score': 0.4470588235294118, 'support': 38122}, '2': {'precision': 0.43055987558320374, 'recall': 0.289077999373499, 'f1-score': 0.3459111638658087, 'support': 38308}, 'accuracy': 0.3887642607124464, 'macro avg': {'precision': 0.4045423428032298, 'recall': 0.3889367849688405, 'f1-score': 0.37709229079745854, 'support': 114563}, 'weighted avg': {'precision': 0.40458662310269544, 'recall': 0.3887642607124464, 'f1-score': 0.37703794228115667, 'support': 114563}}
[[10702 20478  6953]
 [ 7667 22762  7693]
 [ 6766 20468 11074]]
Evaluating performance on  val set...
136/136 - 6s - 6s/epoch - 45ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0977092
{'0': {'precision': 0.39055952674389943, 'recall': 0.2687871077184054, 'f1-score': 0.3184284565916399, 'support': 11790}, '1': {'precision': 0.326822270043591, 'recall': 0.5434443526929076, 'f1-score': 0.40817311005444146, 'support': 10899}, '2': {'precision': 0.4096766635426429, 'recall': 0.2893909301555776, 'f1-score': 0.3391852570320078, 'support': 12084}, 'accuracy': 0.3620337618267046, 'macro avg': {'precision': 0.3756861534433778, 'recall': 0.3672074635222969, 'f1-score': 0.35526227455936304, 'support': 34773}, 'weighted avg': {'precision': 0.3772255929532962, 'recall': 0.3620337618267046, 'f1-score': 0.35377059430229124, 'support': 34773}}
[[3169 6034 2587]
 [2524 5923 2452]
 [2421 6166 3497]]
training model: results/CHTR/W6/deepOF_L2/h100
Epoch 1/50
448/448 - 40s - loss: 3.3304 - accuracy100: 0.3470 - val_loss: 3.3571 - val_accuracy100: 0.3215 - 40s/epoch - 90ms/step
Epoch 2/50
448/448 - 38s - loss: 3.2984 - accuracy100: 0.3653 - val_loss: 3.3428 - val_accuracy100: 0.3243 - 38s/epoch - 85ms/step
Epoch 3/50
448/448 - 39s - loss: 3.2841 - accuracy100: 0.3730 - val_loss: 3.3352 - val_accuracy100: 0.3251 - 39s/epoch - 87ms/step
Epoch 4/50
448/448 - 38s - loss: 3.2772 - accuracy100: 0.3773 - val_loss: 3.3310 - val_accuracy100: 0.3297 - 38s/epoch - 84ms/step
Epoch 5/50
448/448 - 35s - loss: 3.2710 - accuracy100: 0.3813 - val_loss: 3.3221 - val_accuracy100: 0.3305 - 35s/epoch - 79ms/step
Epoch 6/50
448/448 - 38s - loss: 3.2661 - accuracy100: 0.3849 - val_loss: 3.3173 - val_accuracy100: 0.3354 - 38s/epoch - 85ms/step
Epoch 7/50
448/448 - 37s - loss: 3.2599 - accuracy100: 0.3899 - val_loss: 3.3160 - val_accuracy100: 0.3351 - 37s/epoch - 83ms/step
Epoch 8/50
448/448 - 36s - loss: 3.2562 - accuracy100: 0.3921 - val_loss: 3.3121 - val_accuracy100: 0.3389 - 36s/epoch - 81ms/step
Epoch 9/50
448/448 - 36s - loss: 3.2516 - accuracy100: 0.3949 - val_loss: 3.3113 - val_accuracy100: 0.3397 - 36s/epoch - 79ms/step
Epoch 10/50
448/448 - 36s - loss: 3.2457 - accuracy100: 0.3985 - val_loss: 3.3106 - val_accuracy100: 0.3425 - 36s/epoch - 81ms/step
Epoch 11/50
448/448 - 37s - loss: 3.2423 - accuracy100: 0.4024 - val_loss: 3.3112 - val_accuracy100: 0.3481 - 37s/epoch - 82ms/step
Epoch 12/50
448/448 - 37s - loss: 3.2364 - accuracy100: 0.4032 - val_loss: 3.3132 - val_accuracy100: 0.3497 - 37s/epoch - 83ms/step
Epoch 13/50
448/448 - 37s - loss: 3.2314 - accuracy100: 0.4066 - val_loss: 3.3142 - val_accuracy100: 0.3495 - 37s/epoch - 82ms/step
Epoch 14/50
448/448 - 37s - loss: 3.2250 - accuracy100: 0.4101 - val_loss: 3.3151 - val_accuracy100: 0.3498 - 37s/epoch - 83ms/step
Epoch 15/50
448/448 - 32s - loss: 3.2206 - accuracy100: 0.4122 - val_loss: 3.3196 - val_accuracy100: 0.3519 - 32s/epoch - 72ms/step
Epoch 16/50
448/448 - 33s - loss: 3.2146 - accuracy100: 0.4170 - val_loss: 3.3219 - val_accuracy100: 0.3527 - 33s/epoch - 73ms/step
Epoch 17/50
448/448 - 34s - loss: 3.2068 - accuracy100: 0.4205 - val_loss: 3.3341 - val_accuracy100: 0.3532 - 34s/epoch - 76ms/step
Epoch 18/50
448/448 - 34s - loss: 3.2006 - accuracy100: 0.4236 - val_loss: 3.3365 - val_accuracy100: 0.3488 - 34s/epoch - 75ms/step
Epoch 19/50
448/448 - 35s - loss: 3.1943 - accuracy100: 0.4271 - val_loss: 3.3461 - val_accuracy100: 0.3530 - 35s/epoch - 79ms/step
Epoch 20/50
448/448 - 33s - loss: 3.1874 - accuracy100: 0.4312 - val_loss: 3.3483 - val_accuracy100: 0.3563 - 33s/epoch - 74ms/step
testing model: results/CHTR/W6/deepOF_L2/h100
Evaluating performance on  test set...
1095/1095 - 38s - 38s/epoch - 35ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1064287
{'0': {'precision': 0.4490384066655253, 'recall': 0.15902545498640852, 'f1-score': 0.23487183314055446, 'support': 98959}, '1': {'precision': 0.2732883282355709, 'recall': 0.5947223316266247, 'f1-score': 0.37449003633297373, 'support': 76170}, '2': {'precision': 0.42158705331802876, 'recall': 0.31845076461340577, 'f1-score': 0.36283205054441636, 'support': 104955}, 'accuracy': 0.33725596606732267, 'macro avg': {'precision': 0.3813045960730417, 'recall': 0.3573995170754796, 'f1-score': 0.3240646400059815, 'support': 280084}, 'weighted avg': {'precision': 0.3909556876790923, 'recall': 0.33725596606732267, 'f1-score': 0.3207917113013523, 'support': 280084}}
[[15737 59338 23884]
 [ 8898 45300 21972]
 [10411 61121 33423]]
Evaluating performance on  train set...
448/448 - 17s - 17s/epoch - 39ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0894396
{'0': {'precision': 0.4266502159161012, 'recall': 0.18080573056913546, 'f1-score': 0.25397991223077065, 'support': 38251}, '1': {'precision': 0.34394800771369183, 'recall': 0.7253545303298387, 'f1-score': 0.46662985771926097, 'support': 37867}, '2': {'precision': 0.43222492565558257, 'recall': 0.20793341136688775, 'f1-score': 0.2807867931155602, 'support': 38445}, 'accuracy': 0.3699012770266142, 'macro avg': {'precision': 0.40094104976179185, 'recall': 0.37136455742195396, 'f1-score': 0.33379885435519724, 'support': 114563}, 'weighted avg': {'precision': 0.40118505873563043, 'recall': 0.3699012770266142, 'f1-score': 0.3332638522587762, 'support': 114563}}
[[ 6916 26421  4914]
 [ 4813 27467  5587]
 [ 4481 25970  7994]]
Evaluating performance on  val set...
136/136 - 6s - 6s/epoch - 41ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.105157
{'0': {'precision': 0.38890002003606494, 'recall': 0.16640946502057613, 'f1-score': 0.2330831582107475, 'support': 11664}, '1': {'precision': 0.318340277187314, 'recall': 0.6898203592814371, 'f1-score': 0.43564010821188587, 'support': 10855}, '2': {'precision': 0.40159744408945686, 'recall': 0.20515749959196997, 'f1-score': 0.2715782650966836, 'support': 12254}, 'accuracy': 0.34345612975584505, 'macro avg': {'precision': 0.36961258043761197, 'recall': 0.3537957746313278, 'f1-score': 0.3134338438397723, 'support': 34773}, 'weighted avg': {'precision': 0.37134813281687395, 'recall': 0.34345612975584505, 'f1-score': 0.3098805220287275, 'support': 34773}}
[[1941 7850 1873]
 [1494 7488 1873]
 [1556 8184 2514]]
training model: results/CHTR/W6/deepOF_L2/h200
Epoch 1/50
448/448 - 42s - loss: 3.3291 - accuracy200: 0.3470 - val_loss: 3.4130 - val_accuracy200: 0.3017 - 42s/epoch - 94ms/step
Epoch 2/50
448/448 - 36s - loss: 3.2994 - accuracy200: 0.3599 - val_loss: 3.3954 - val_accuracy200: 0.3043 - 36s/epoch - 81ms/step
Epoch 3/50
448/448 - 34s - loss: 3.2875 - accuracy200: 0.3675 - val_loss: 3.3873 - val_accuracy200: 0.3046 - 34s/epoch - 75ms/step
Epoch 4/50
448/448 - 36s - loss: 3.2795 - accuracy200: 0.3728 - val_loss: 3.3742 - val_accuracy200: 0.3071 - 36s/epoch - 81ms/step
Epoch 5/50
448/448 - 35s - loss: 3.2738 - accuracy200: 0.3769 - val_loss: 3.3658 - val_accuracy200: 0.3079 - 35s/epoch - 79ms/step
Epoch 6/50
448/448 - 37s - loss: 3.2696 - accuracy200: 0.3821 - val_loss: 3.3564 - val_accuracy200: 0.3070 - 37s/epoch - 83ms/step
Epoch 7/50
448/448 - 33s - loss: 3.2643 - accuracy200: 0.3856 - val_loss: 3.3507 - val_accuracy200: 0.3103 - 33s/epoch - 74ms/step
Epoch 8/50
448/448 - 36s - loss: 3.2598 - accuracy200: 0.3893 - val_loss: 3.3510 - val_accuracy200: 0.3098 - 36s/epoch - 81ms/step
Epoch 9/50
448/448 - 36s - loss: 3.2554 - accuracy200: 0.3909 - val_loss: 3.3493 - val_accuracy200: 0.3114 - 36s/epoch - 80ms/step
Epoch 10/50
448/448 - 37s - loss: 3.2520 - accuracy200: 0.3927 - val_loss: 3.3486 - val_accuracy200: 0.3152 - 37s/epoch - 82ms/step
Epoch 11/50
448/448 - 36s - loss: 3.2478 - accuracy200: 0.3967 - val_loss: 3.3457 - val_accuracy200: 0.3198 - 36s/epoch - 80ms/step
Epoch 12/50
448/448 - 37s - loss: 3.2427 - accuracy200: 0.3996 - val_loss: 3.3505 - val_accuracy200: 0.3191 - 37s/epoch - 84ms/step
Epoch 13/50
448/448 - 35s - loss: 3.2379 - accuracy200: 0.4031 - val_loss: 3.3492 - val_accuracy200: 0.3215 - 35s/epoch - 79ms/step
Epoch 14/50
448/448 - 35s - loss: 3.2326 - accuracy200: 0.4059 - val_loss: 3.3478 - val_accuracy200: 0.3247 - 35s/epoch - 78ms/step
Epoch 15/50
448/448 - 35s - loss: 3.2290 - accuracy200: 0.4065 - val_loss: 3.3526 - val_accuracy200: 0.3247 - 35s/epoch - 77ms/step
Epoch 16/50
448/448 - 35s - loss: 3.2242 - accuracy200: 0.4109 - val_loss: 3.3530 - val_accuracy200: 0.3305 - 35s/epoch - 78ms/step
Epoch 17/50
448/448 - 36s - loss: 3.2172 - accuracy200: 0.4152 - val_loss: 3.3607 - val_accuracy200: 0.3284 - 36s/epoch - 81ms/step
Epoch 18/50
448/448 - 35s - loss: 3.2109 - accuracy200: 0.4162 - val_loss: 3.3654 - val_accuracy200: 0.3292 - 35s/epoch - 79ms/step
Epoch 19/50
448/448 - 38s - loss: 3.2041 - accuracy200: 0.4217 - val_loss: 3.3682 - val_accuracy200: 0.3303 - 38s/epoch - 84ms/step
Epoch 20/50
448/448 - 34s - loss: 3.1976 - accuracy200: 0.4238 - val_loss: 3.3767 - val_accuracy200: 0.3341 - 34s/epoch - 76ms/step
Epoch 21/50
448/448 - 36s - loss: 3.1933 - accuracy200: 0.4253 - val_loss: 3.3839 - val_accuracy200: 0.3317 - 36s/epoch - 79ms/step
testing model: results/CHTR/W6/deepOF_L2/h200
Evaluating performance on  test set...
1095/1095 - 40s - 40s/epoch - 36ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1201425
{'0': {'precision': 0.43894656419936184, 'recall': 0.09903771078595403, 'f1-score': 0.16161164887896087, 'support': 98619}, '1': {'precision': 0.26004338806986427, 'recall': 0.6719587544498548, 'f1-score': 0.37497431213608856, 'support': 73317}, '2': {'precision': 0.4198596080725358, 'recall': 0.26546954173909826, 'f1-score': 0.3252741774675972, 'support': 108148}, 'accuracy': 0.313273874980363, 'macro avg': {'precision': 0.37294985344725395, 'recall': 0.34548866899163566, 'f1-score': 0.28728671282754886, 'support': 280084}, 'weighted avg': {'precision': 0.38474546633054263, 'recall': 0.313273874980363, 'f1-score': 0.2806576690865653, 'support': 280084}}
[[ 9767 67891 20961]
 [ 5342 49266 18709]
 [ 7142 72296 28710]]
Evaluating performance on  train set...
448/448 - 19s - 19s/epoch - 42ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0955032
{'0': {'precision': 0.4263096168881939, 'recall': 0.11523829652330128, 'f1-score': 0.18143249313701024, 'support': 37852}, '1': {'precision': 0.34140524066651207, 'recall': 0.8168128500475537, 'f1-score': 0.48154003099374665, 'support': 37852}, '2': {'precision': 0.43238925199709516, 'recall': 0.15322061813222163, 'f1-score': 0.22626308689125768, 'support': 38859}, 'accuracy': 0.3599242338276756, 'macro avg': {'precision': 0.4000347031839337, 'recall': 0.3617572549010255, 'f1-score': 0.2964118703406715, 'support': 114563}, 'weighted avg': {'precision': 0.40031909719120357, 'recall': 0.3599242338276756, 'f1-score': 0.29579526790416444, 'support': 114563}}
[[ 4362 29713  3777]
 [ 2895 30918  4039]
 [ 2975 29930  5954]]
Evaluating performance on  val set...
136/136 - 6s - 6s/epoch - 47ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1167765
{'0': {'precision': 0.3739754098360656, 'recall': 0.09380621948085326, 'f1-score': 0.14998972673104582, 'support': 11673}, '1': {'precision': 0.29895917915405623, 'recall': 0.7865604971839192, 'f1-score': 0.4332477535301668, 'support': 10298}, '2': {'precision': 0.40665123131972214, 'recall': 0.15091391970004686, 'f1-score': 0.22013331054520593, 'support': 12802}, 'accuracy': 0.3199896471400224, 'macro avg': {'precision': 0.35986194010328126, 'recall': 0.3437602121216064, 'f1-score': 0.2677902636021395, 'support': 34773}, 'weighted avg': {'precision': 0.36378930921404384, 'recall': 0.3199896471400224, 'f1-score': 0.2597004022541881, 'support': 34773}}
[[1095 9094 1484]
 [ 863 8100 1335]
 [ 970 9900 1932]]
training model: results/CHTR/W6/deepOF_L2/h300
Epoch 1/50
448/448 - 41s - loss: 3.3268 - accuracy300: 0.3496 - val_loss: 3.4556 - val_accuracy300: 0.2961 - 41s/epoch - 92ms/step
Epoch 2/50
448/448 - 35s - loss: 3.2981 - accuracy300: 0.3620 - val_loss: 3.4338 - val_accuracy300: 0.2985 - 35s/epoch - 78ms/step
Epoch 3/50
448/448 - 35s - loss: 3.2855 - accuracy300: 0.3694 - val_loss: 3.4175 - val_accuracy300: 0.2986 - 35s/epoch - 77ms/step
Epoch 4/50
448/448 - 37s - loss: 3.2783 - accuracy300: 0.3751 - val_loss: 3.4021 - val_accuracy300: 0.2982 - 37s/epoch - 82ms/step
Epoch 5/50
448/448 - 38s - loss: 3.2740 - accuracy300: 0.3787 - val_loss: 3.4003 - val_accuracy300: 0.2994 - 38s/epoch - 85ms/step
Epoch 6/50
448/448 - 37s - loss: 3.2691 - accuracy300: 0.3814 - val_loss: 3.3845 - val_accuracy300: 0.3002 - 37s/epoch - 84ms/step
Epoch 7/50
448/448 - 37s - loss: 3.2654 - accuracy300: 0.3849 - val_loss: 3.3777 - val_accuracy300: 0.3008 - 37s/epoch - 83ms/step
Epoch 8/50
448/448 - 36s - loss: 3.2589 - accuracy300: 0.3878 - val_loss: 3.3788 - val_accuracy300: 0.3015 - 36s/epoch - 80ms/step
Epoch 9/50
448/448 - 38s - loss: 3.2567 - accuracy300: 0.3900 - val_loss: 3.3766 - val_accuracy300: 0.3021 - 38s/epoch - 85ms/step
Epoch 10/50
448/448 - 36s - loss: 3.2515 - accuracy300: 0.3943 - val_loss: 3.3758 - val_accuracy300: 0.3044 - 36s/epoch - 80ms/step
Epoch 11/50
448/448 - 37s - loss: 3.2472 - accuracy300: 0.3963 - val_loss: 3.3725 - val_accuracy300: 0.3060 - 37s/epoch - 83ms/step
Epoch 12/50
448/448 - 36s - loss: 3.2435 - accuracy300: 0.3990 - val_loss: 3.3706 - val_accuracy300: 0.3087 - 36s/epoch - 80ms/step
Epoch 13/50
448/448 - 35s - loss: 3.2377 - accuracy300: 0.4015 - val_loss: 3.3746 - val_accuracy300: 0.3069 - 35s/epoch - 77ms/step
Epoch 14/50
448/448 - 37s - loss: 3.2329 - accuracy300: 0.4042 - val_loss: 3.3813 - val_accuracy300: 0.3087 - 37s/epoch - 82ms/step
Epoch 15/50
448/448 - 36s - loss: 3.2295 - accuracy300: 0.4059 - val_loss: 3.3802 - val_accuracy300: 0.3085 - 36s/epoch - 81ms/step
Epoch 16/50
448/448 - 37s - loss: 3.2230 - accuracy300: 0.4085 - val_loss: 3.3818 - val_accuracy300: 0.3111 - 37s/epoch - 83ms/step
Epoch 17/50
448/448 - 37s - loss: 3.2178 - accuracy300: 0.4114 - val_loss: 3.3917 - val_accuracy300: 0.3083 - 37s/epoch - 82ms/step
Epoch 18/50
448/448 - 36s - loss: 3.2130 - accuracy300: 0.4133 - val_loss: 3.3917 - val_accuracy300: 0.3127 - 36s/epoch - 81ms/step
Epoch 19/50
448/448 - 34s - loss: 3.2070 - accuracy300: 0.4176 - val_loss: 3.4007 - val_accuracy300: 0.3106 - 34s/epoch - 75ms/step
Epoch 20/50
448/448 - 37s - loss: 3.2013 - accuracy300: 0.4207 - val_loss: 3.4098 - val_accuracy300: 0.3143 - 37s/epoch - 83ms/step
Epoch 21/50
448/448 - 36s - loss: 3.1951 - accuracy300: 0.4219 - val_loss: 3.4136 - val_accuracy300: 0.3149 - 36s/epoch - 81ms/step
Epoch 22/50
448/448 - 38s - loss: 3.1885 - accuracy300: 0.4264 - val_loss: 3.4164 - val_accuracy300: 0.3143 - 38s/epoch - 85ms/step
testing model: results/CHTR/W6/deepOF_L2/h300
Evaluating performance on  test set...
1095/1095 - 40s - 40s/epoch - 37ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1289005
{'0': {'precision': 0.4264350626941217, 'recall': 0.11195449740776162, 'f1-score': 0.17734862136603569, 'support': 99335}, '1': {'precision': 0.2570351459044165, 'recall': 0.7533497440487846, 'f1-score': 0.3832942541086557, 'support': 71498}, '2': {'precision': 0.41910011248593926, 'recall': 0.1705156016878564, 'f1-score': 0.2424057097871842, 'support': 109251}, 'accuracy': 0.29852829865326114, 'macro avg': {'precision': 0.3675234403614925, 'recall': 0.34527328104813426, 'f1-score': 0.26768286175395856, 'support': 280084}, 'weighted avg': {'precision': 0.38033065867309773, 'recall': 0.29852829865326114, 'f1-score': 0.25529756817103255, 'support': 280084}}
[[11121 74037 14177]
 [ 5991 53863 11644]
 [ 8967 81655 18629]]
Evaluating performance on  train set...
448/448 - 17s - 17s/epoch - 38ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0985744
{'0': {'precision': 0.4200413833875259, 'recall': 0.1141273793269617, 'f1-score': 0.17948717948717952, 'support': 37353}, '1': {'precision': 0.34052322809345137, 'recall': 0.8679100731778194, 'f1-score': 0.4891350470107421, 'support': 37853}, '2': {'precision': 0.4581653225806452, 'recall': 0.09238509032700663, 'f1-score': 0.15376482777578077, 'support': 39357}, 'accuracy': 0.35571694177003044, 'macro avg': {'precision': 0.40624331135387415, 'recall': 0.3581408476105959, 'f1-score': 0.27412901809123413, 'support': 114563}, 'weighted avg': {'precision': 0.40686473073769125, 'recall': 0.35571694177003044, 'f1-score': 0.2729619150742704, 'support': 114563}}
[[ 4263 30940  2150]
 [ 2850 32853  2150]
 [ 3036 32685  3636]]
Evaluating performance on  val set...
136/136 - 5s - 5s/epoch - 39ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1256361
{'0': {'precision': 0.36264509321139643, 'recall': 0.08844471133224673, 'f1-score': 0.14220689655172414, 'support': 11657}, '1': {'precision': 0.29317282771791026, 'recall': 0.8512724032082385, 'f1-score': 0.43614133881236844, 'support': 10099}, '2': {'precision': 0.38718342287029933, 'recall': 0.07751402012752555, 'f1-score': 0.12916853357229727, 'support': 13017}, 'accuracy': 0.305898254392776, 'macro avg': {'precision': 0.34766711459986865, 'recall': 0.33907704488933693, 'f1-score': 0.2358389229787966, 'support': 34773}, 'weighted avg': {'precision': 0.35165423904152965, 'recall': 0.305898254392776, 'f1-score': 0.22269243307394102, 'support': 34773}}
[[ 1031  9772   854]
 [  759  8597   743]
 [ 1053 10955  1009]]
training model: results/CHTR/W6/deepOF_L2/h500
Epoch 1/50
448/448 - 41s - loss: 3.3297 - accuracy500: 0.3482 - val_loss: 3.4276 - val_accuracy500: 0.2987 - 41s/epoch - 92ms/step
Epoch 2/50
448/448 - 38s - loss: 3.3055 - accuracy500: 0.3570 - val_loss: 3.4007 - val_accuracy500: 0.2970 - 38s/epoch - 84ms/step
Epoch 3/50
448/448 - 38s - loss: 3.2913 - accuracy500: 0.3643 - val_loss: 3.3863 - val_accuracy500: 0.2968 - 38s/epoch - 85ms/step
Epoch 4/50
448/448 - 34s - loss: 3.2839 - accuracy500: 0.3697 - val_loss: 3.3714 - val_accuracy500: 0.2982 - 34s/epoch - 76ms/step
Epoch 5/50
448/448 - 35s - loss: 3.2783 - accuracy500: 0.3746 - val_loss: 3.3638 - val_accuracy500: 0.2997 - 35s/epoch - 78ms/step
Epoch 6/50
448/448 - 37s - loss: 3.2732 - accuracy500: 0.3762 - val_loss: 3.3558 - val_accuracy500: 0.3010 - 37s/epoch - 82ms/step
Epoch 7/50
448/448 - 35s - loss: 3.2697 - accuracy500: 0.3781 - val_loss: 3.3513 - val_accuracy500: 0.3016 - 35s/epoch - 79ms/step
Epoch 8/50
448/448 - 38s - loss: 3.2646 - accuracy500: 0.3822 - val_loss: 3.3487 - val_accuracy500: 0.3053 - 38s/epoch - 86ms/step
Epoch 9/50
448/448 - 39s - loss: 3.2615 - accuracy500: 0.3828 - val_loss: 3.3482 - val_accuracy500: 0.3064 - 39s/epoch - 86ms/step
Epoch 10/50
448/448 - 38s - loss: 3.2576 - accuracy500: 0.3871 - val_loss: 3.3464 - val_accuracy500: 0.3088 - 38s/epoch - 85ms/step
Epoch 11/50
448/448 - 36s - loss: 3.2511 - accuracy500: 0.3920 - val_loss: 3.3510 - val_accuracy500: 0.3128 - 36s/epoch - 81ms/step
Epoch 12/50
448/448 - 35s - loss: 3.2478 - accuracy500: 0.3932 - val_loss: 3.3504 - val_accuracy500: 0.3101 - 35s/epoch - 79ms/step
Epoch 13/50
448/448 - 33s - loss: 3.2434 - accuracy500: 0.3963 - val_loss: 3.3502 - val_accuracy500: 0.3141 - 33s/epoch - 74ms/step
Epoch 14/50
448/448 - 36s - loss: 3.2368 - accuracy500: 0.4022 - val_loss: 3.3582 - val_accuracy500: 0.3166 - 36s/epoch - 79ms/step
Epoch 15/50
448/448 - 37s - loss: 3.2327 - accuracy500: 0.4032 - val_loss: 3.3606 - val_accuracy500: 0.3153 - 37s/epoch - 82ms/step
Epoch 16/50
448/448 - 35s - loss: 3.2260 - accuracy500: 0.4070 - val_loss: 3.3682 - val_accuracy500: 0.3171 - 35s/epoch - 78ms/step
Epoch 17/50
448/448 - 37s - loss: 3.2222 - accuracy500: 0.4094 - val_loss: 3.3704 - val_accuracy500: 0.3219 - 37s/epoch - 82ms/step
Epoch 18/50
448/448 - 37s - loss: 3.2154 - accuracy500: 0.4123 - val_loss: 3.3725 - val_accuracy500: 0.3213 - 37s/epoch - 83ms/step
Epoch 19/50
448/448 - 33s - loss: 3.2101 - accuracy500: 0.4142 - val_loss: 3.3844 - val_accuracy500: 0.3225 - 33s/epoch - 74ms/step
Epoch 20/50
448/448 - 37s - loss: 3.2049 - accuracy500: 0.4161 - val_loss: 3.3931 - val_accuracy500: 0.3210 - 37s/epoch - 82ms/step
testing model: results/CHTR/W6/deepOF_L2/h500
Evaluating performance on  test set...
1095/1095 - 41s - 41s/epoch - 38ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1220611
{'0': {'precision': 0.41606520971079597, 'recall': 0.16541089362214442, 'f1-score': 0.2367138313986461, 'support': 99673}, '1': {'precision': 0.2521199576252569, 'recall': 0.7457509638849981, 'f1-score': 0.3768397241781896, 'support': 69251}, '2': {'precision': 0.4134871838063955, 'recall': 0.13249370277078085, 'f1-score': 0.2006826589634757, 'support': 111160}, 'accuracy': 0.2958362491252624, 'macro avg': {'precision': 0.36055745038081605, 'recall': 0.3478851867593078, 'f1-score': 0.2714120715134371, 'support': 280084}, 'weighted avg': {'precision': 0.3745064415851307, 'recall': 0.2958362491252624, 'f1-score': 0.2570599885264457, 'support': 280084}}
[[16487 71199 11987]
 [ 8703 51644  8904]
 [14436 81996 14728]]
Evaluating performance on  train set...
448/448 - 19s - 19s/epoch - 42ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.096406
{'0': {'precision': 0.38825049296253483, 'recall': 0.15687244155059205, 'f1-score': 0.2234571283215278, 'support': 36399}, '1': {'precision': 0.3408466252140218, 'recall': 0.8008840188449526, 'f1-score': 0.4781839156750265, 'support': 37782}, '2': {'precision': 0.41913357400722023, 'recall': 0.11500173344559457, 'f1-score': 0.18048268625393496, 'support': 40382}, 'accuracy': 0.35450363555423653, 'macro avg': {'precision': 0.3827435640612589, 'recall': 0.35758606461371306, 'f1-score': 0.29404124341682975, 'support': 114563}, 'weighted avg': {'precision': 0.383502953595306, 'recall': 0.35450363555423653, 'f1-score': 0.29231612782587346, 'support': 114563}}
[[ 5710 27527  3162]
 [ 4249 30259  3274]
 [ 4748 30990  4644]]
Evaluating performance on  val set...
136/136 - 6s - 6s/epoch - 47ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.115731
{'0': {'precision': 0.36175771971496434, 'recall': 0.13212457707989936, 'f1-score': 0.1935565863887653, 'support': 11527}, '1': {'precision': 0.293810067385941, 'recall': 0.7951963324696033, 'f1-score': 0.42908230485870236, 'support': 10034}, '2': {'precision': 0.3831473869641809, 'recall': 0.09877384196185286, 'f1-score': 0.1570586111445421, 'support': 13212}, 'accuracy': 0.31078710493773903, 'macro avg': {'precision': 0.3462383913550287, 'recall': 0.34203158383711846, 'f1-score': 0.25989916746400327, 'support': 34773}, 'weighted avg': {'precision': 0.3502779377067174, 'recall': 0.31078710493773903, 'f1-score': 0.2476518272423204, 'support': 34773}}
[[ 1523  8805  1199]
 [ 1153  7979   902]
 [ 1534 10373  1305]]
training model: results/CHTR/W6/deepOF_L2/h1000
Epoch 1/50
448/448 - 42s - loss: 3.3371 - accuracy1000: 0.3466 - val_loss: 3.3586 - val_accuracy1000: 0.3412 - 42s/epoch - 93ms/step
Epoch 2/50
448/448 - 35s - loss: 3.3076 - accuracy1000: 0.3539 - val_loss: 3.3412 - val_accuracy1000: 0.3433 - 35s/epoch - 78ms/step
Epoch 3/50
448/448 - 37s - loss: 3.2952 - accuracy1000: 0.3575 - val_loss: 3.3365 - val_accuracy1000: 0.3456 - 37s/epoch - 83ms/step
Epoch 4/50
448/448 - 36s - loss: 3.2864 - accuracy1000: 0.3609 - val_loss: 3.3323 - val_accuracy1000: 0.3512 - 36s/epoch - 81ms/step
Epoch 5/50
448/448 - 35s - loss: 3.2804 - accuracy1000: 0.3638 - val_loss: 3.3281 - val_accuracy1000: 0.3518 - 35s/epoch - 78ms/step
Epoch 6/50
448/448 - 35s - loss: 3.2751 - accuracy1000: 0.3694 - val_loss: 3.3293 - val_accuracy1000: 0.3528 - 35s/epoch - 78ms/step
Epoch 7/50
448/448 - 36s - loss: 3.2721 - accuracy1000: 0.3686 - val_loss: 3.3272 - val_accuracy1000: 0.3525 - 36s/epoch - 80ms/step
Epoch 8/50
448/448 - 37s - loss: 3.2676 - accuracy1000: 0.3741 - val_loss: 3.3253 - val_accuracy1000: 0.3554 - 37s/epoch - 82ms/step
Epoch 9/50
448/448 - 35s - loss: 3.2638 - accuracy1000: 0.3758 - val_loss: 3.3270 - val_accuracy1000: 0.3525 - 35s/epoch - 79ms/step
Epoch 10/50
448/448 - 35s - loss: 3.2597 - accuracy1000: 0.3801 - val_loss: 3.3293 - val_accuracy1000: 0.3527 - 35s/epoch - 79ms/step
Epoch 11/50
448/448 - 36s - loss: 3.2555 - accuracy1000: 0.3827 - val_loss: 3.3289 - val_accuracy1000: 0.3523 - 36s/epoch - 80ms/step
Epoch 12/50
448/448 - 38s - loss: 3.2517 - accuracy1000: 0.3858 - val_loss: 3.3304 - val_accuracy1000: 0.3519 - 38s/epoch - 85ms/step
Epoch 13/50
448/448 - 35s - loss: 3.2484 - accuracy1000: 0.3874 - val_loss: 3.3338 - val_accuracy1000: 0.3515 - 35s/epoch - 79ms/step
Epoch 14/50
448/448 - 36s - loss: 3.2444 - accuracy1000: 0.3898 - val_loss: 3.3325 - val_accuracy1000: 0.3523 - 36s/epoch - 80ms/step
Epoch 15/50
448/448 - 35s - loss: 3.2397 - accuracy1000: 0.3933 - val_loss: 3.3353 - val_accuracy1000: 0.3498 - 35s/epoch - 79ms/step
Epoch 16/50
448/448 - 35s - loss: 3.2357 - accuracy1000: 0.3958 - val_loss: 3.3351 - val_accuracy1000: 0.3547 - 35s/epoch - 78ms/step
Epoch 17/50
448/448 - 36s - loss: 3.2299 - accuracy1000: 0.3980 - val_loss: 3.3372 - val_accuracy1000: 0.3538 - 36s/epoch - 80ms/step
Epoch 18/50
448/448 - 35s - loss: 3.2234 - accuracy1000: 0.4018 - val_loss: 3.3442 - val_accuracy1000: 0.3490 - 35s/epoch - 78ms/step
testing model: results/CHTR/W6/deepOF_L2/h1000
Evaluating performance on  test set...
1095/1095 - 41s - 41s/epoch - 38ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1069696
{'0': {'precision': 0.40562434903367667, 'recall': 0.14131924844770583, 'f1-score': 0.2096103818437341, 'support': 99208}, '1': {'precision': 0.26766908260921796, 'recall': 0.3517556207490824, 'f1-score': 0.30400500270032116, 'support': 76013}, '2': {'precision': 0.37277858653555634, 'recall': 0.517694515701439, 'f1-score': 0.4334447145805637, 'support': 104863}, 'accuracy': 0.3393446251838734, 'macro avg': {'precision': 0.34869067272615034, 'recall': 0.3369231282994091, 'f1-score': 0.31568669970820634, 'support': 280084}, 'weighted avg': {'precision': 0.35588677437906313, 'recall': 0.3393446251838734, 'f1-score': 0.3190316909829706, 'support': 280084}}
[[14020 34912 50276]
 [ 8210 26738 41065]
 [12334 38242 54287]]
Evaluating performance on  train set...
448/448 - 19s - 19s/epoch - 43ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0926673
{'0': {'precision': 0.36369839645172297, 'recall': 0.1224653914641852, 'f1-score': 0.18323234927592283, 'support': 34818}, '1': {'precision': 0.34882504706784745, 'recall': 0.2663879865807551, 'f1-score': 0.30208333333333326, 'support': 37558}, '2': {'precision': 0.3800989791927937, 'recall': 0.6681442150425486, 'f1-score': 0.4845458296087465, 'support': 42187}, 'accuracy': 0.3705908539406266, 'macro avg': {'precision': 0.36420747423745475, 'recall': 0.35233253102916295, 'f1-score': 0.32328717073933416, 'support': 114563}, 'weighted avg': {'precision': 0.3648617574665179, 'recall': 0.3705908539406266, 'f1-score': 0.33315262941897994, 'support': 114563}}
[[ 4264  8610 21944]
 [ 3527 10005 24026]
 [ 3933 10067 28187]]
Evaluating performance on  val set...
136/136 - 5s - 5s/epoch - 35ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1020261
{'0': {'precision': 0.34144116752812403, 'recall': 0.10019628836545325, 'f1-score': 0.15492860591846588, 'support': 11208}, '1': {'precision': 0.2808771730485172, 'recall': 0.24328314142308827, 'f1-score': 0.2607319902963822, 'support': 10161}, '2': {'precision': 0.38209231583123926, 'recall': 0.646598030438675, 'f1-score': 0.4803391803142406, 'support': 13404}, 'accuracy': 0.35262991401374627, 'macro avg': {'precision': 0.3348035521359602, 'recall': 0.33002582007573883, 'f1-score': 0.2986665921763629, 'support': 34773}, 'weighted avg': {'precision': 0.33941365319078387, 'recall': 0.35262991401374627, 'f1-score': 0.3112818549296231, 'support': 34773}}
[[1123 2858 7227]
 [ 900 2472 6789]
 [1266 3471 8667]]
training model: results/CHTR/W6/deepVOL_L2/h10
Epoch 1/50
448/448 - 45s - loss: 3.3205 - accuracy10: 0.3567 - val_loss: 3.3154 - val_accuracy10: 0.3383 - 45s/epoch - 99ms/step
Epoch 2/50
448/448 - 34s - loss: 3.2841 - accuracy10: 0.3708 - val_loss: 3.3059 - val_accuracy10: 0.3434 - 34s/epoch - 75ms/step
Epoch 3/50
448/448 - 34s - loss: 3.2736 - accuracy10: 0.3751 - val_loss: 3.2908 - val_accuracy10: 0.3546 - 34s/epoch - 75ms/step
Epoch 4/50
448/448 - 34s - loss: 3.2620 - accuracy10: 0.3819 - val_loss: 3.2835 - val_accuracy10: 0.3629 - 34s/epoch - 75ms/step
Epoch 5/50
448/448 - 32s - loss: 3.2513 - accuracy10: 0.3885 - val_loss: 3.2856 - val_accuracy10: 0.3643 - 32s/epoch - 72ms/step
Epoch 6/50
448/448 - 32s - loss: 3.2438 - accuracy10: 0.3924 - val_loss: 3.2862 - val_accuracy10: 0.3681 - 32s/epoch - 71ms/step
Epoch 7/50
448/448 - 32s - loss: 3.2379 - accuracy10: 0.3971 - val_loss: 3.2680 - val_accuracy10: 0.3721 - 32s/epoch - 71ms/step
Epoch 8/50
448/448 - 32s - loss: 3.2329 - accuracy10: 0.3983 - val_loss: 3.2598 - val_accuracy10: 0.3763 - 32s/epoch - 71ms/step
Epoch 9/50
448/448 - 33s - loss: 3.2293 - accuracy10: 0.4011 - val_loss: 3.2623 - val_accuracy10: 0.3751 - 33s/epoch - 73ms/step
Epoch 10/50
448/448 - 32s - loss: 3.2232 - accuracy10: 0.4024 - val_loss: 3.2577 - val_accuracy10: 0.3819 - 32s/epoch - 71ms/step
Epoch 11/50
448/448 - 34s - loss: 3.2192 - accuracy10: 0.4059 - val_loss: 3.2498 - val_accuracy10: 0.3844 - 34s/epoch - 75ms/step
Epoch 12/50
448/448 - 32s - loss: 3.2151 - accuracy10: 0.4064 - val_loss: 3.2474 - val_accuracy10: 0.3848 - 32s/epoch - 72ms/step
Epoch 13/50
448/448 - 32s - loss: 3.2122 - accuracy10: 0.4087 - val_loss: 3.2453 - val_accuracy10: 0.3861 - 32s/epoch - 71ms/step
Epoch 14/50
448/448 - 31s - loss: 3.2084 - accuracy10: 0.4106 - val_loss: 3.2523 - val_accuracy10: 0.3840 - 31s/epoch - 70ms/step
Epoch 15/50
448/448 - 30s - loss: 3.2059 - accuracy10: 0.4106 - val_loss: 3.2418 - val_accuracy10: 0.3897 - 30s/epoch - 67ms/step
Epoch 16/50
448/448 - 32s - loss: 3.2026 - accuracy10: 0.4124 - val_loss: 3.2401 - val_accuracy10: 0.3899 - 32s/epoch - 72ms/step
Epoch 17/50
448/448 - 31s - loss: 3.1999 - accuracy10: 0.4127 - val_loss: 3.2411 - val_accuracy10: 0.3891 - 31s/epoch - 69ms/step
Epoch 18/50
448/448 - 32s - loss: 3.1955 - accuracy10: 0.4143 - val_loss: 3.2412 - val_accuracy10: 0.3908 - 32s/epoch - 71ms/step
Epoch 19/50
448/448 - 33s - loss: 3.1948 - accuracy10: 0.4155 - val_loss: 3.2370 - val_accuracy10: 0.3894 - 33s/epoch - 73ms/step
Epoch 20/50
448/448 - 33s - loss: 3.1919 - accuracy10: 0.4156 - val_loss: 3.2384 - val_accuracy10: 0.3887 - 33s/epoch - 74ms/step
Epoch 21/50
448/448 - 31s - loss: 3.1885 - accuracy10: 0.4173 - val_loss: 3.2389 - val_accuracy10: 0.3904 - 31s/epoch - 69ms/step
Epoch 22/50
448/448 - 32s - loss: 3.1863 - accuracy10: 0.4200 - val_loss: 3.2394 - val_accuracy10: 0.3913 - 32s/epoch - 72ms/step
Epoch 23/50
448/448 - 30s - loss: 3.1836 - accuracy10: 0.4206 - val_loss: 3.2435 - val_accuracy10: 0.3890 - 30s/epoch - 66ms/step
Epoch 24/50
448/448 - 30s - loss: 3.1820 - accuracy10: 0.4210 - val_loss: 3.2388 - val_accuracy10: 0.3925 - 30s/epoch - 66ms/step
Epoch 25/50
448/448 - 33s - loss: 3.1777 - accuracy10: 0.4229 - val_loss: 3.2347 - val_accuracy10: 0.3940 - 33s/epoch - 73ms/step
Epoch 26/50
448/448 - 33s - loss: 3.1746 - accuracy10: 0.4247 - val_loss: 3.2384 - val_accuracy10: 0.3929 - 33s/epoch - 75ms/step
Epoch 27/50
448/448 - 31s - loss: 3.1712 - accuracy10: 0.4271 - val_loss: 3.2340 - val_accuracy10: 0.3923 - 31s/epoch - 69ms/step
Epoch 28/50
448/448 - 33s - loss: 3.1698 - accuracy10: 0.4269 - val_loss: 3.2363 - val_accuracy10: 0.3928 - 33s/epoch - 74ms/step
Epoch 29/50
448/448 - 33s - loss: 3.1679 - accuracy10: 0.4279 - val_loss: 3.2358 - val_accuracy10: 0.3928 - 33s/epoch - 74ms/step
Epoch 30/50
448/448 - 32s - loss: 3.1642 - accuracy10: 0.4273 - val_loss: 3.2422 - val_accuracy10: 0.3932 - 32s/epoch - 71ms/step
Epoch 31/50
448/448 - 32s - loss: 3.1615 - accuracy10: 0.4300 - val_loss: 3.2428 - val_accuracy10: 0.3911 - 32s/epoch - 72ms/step
Epoch 32/50
448/448 - 33s - loss: 3.1564 - accuracy10: 0.4319 - val_loss: 3.2481 - val_accuracy10: 0.3903 - 33s/epoch - 73ms/step
Epoch 33/50
448/448 - 32s - loss: 3.1540 - accuracy10: 0.4321 - val_loss: 3.2509 - val_accuracy10: 0.3911 - 32s/epoch - 70ms/step
Epoch 34/50
448/448 - 32s - loss: 3.1521 - accuracy10: 0.4327 - val_loss: 3.2490 - val_accuracy10: 0.3913 - 32s/epoch - 72ms/step
Epoch 35/50
448/448 - 31s - loss: 3.1497 - accuracy10: 0.4324 - val_loss: 3.2421 - val_accuracy10: 0.3906 - 31s/epoch - 69ms/step
Epoch 36/50
448/448 - 32s - loss: 3.1485 - accuracy10: 0.4330 - val_loss: 3.2458 - val_accuracy10: 0.3917 - 32s/epoch - 72ms/step
Epoch 37/50
448/448 - 33s - loss: 3.1445 - accuracy10: 0.4342 - val_loss: 3.2444 - val_accuracy10: 0.3900 - 33s/epoch - 73ms/step
testing model: results/CHTR/W6/deepVOL_L2/h10
Evaluating performance on  test set...
1095/1095 - 38s - 38s/epoch - 35ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0935404
{'0': {'precision': 0.4337253019758419, 'recall': 0.21601593625498008, 'f1-score': 0.28839658519720224, 'support': 100400}, '1': {'precision': 0.3034977382068531, 'recall': 0.6098543709346939, 'f1-score': 0.40529697224481587, 'support': 72719}, '2': {'precision': 0.4376265453419404, 'recall': 0.3434981770589885, 'f1-score': 0.3848909559424297, 'support': 106970}, 'accuracy': 0.3669547893705215, 'macro avg': {'precision': 0.3916165285082118, 'recall': 0.38978949474955416, 'f1-score': 0.3595281711281493, 'support': 280089}, 'weighted avg': {'precision': 0.401404496064701, 'recall': 0.3669547893705215, 'f1-score': 0.3555998030470014, 'support': 280089}}
[[21688 48834 29878]
 [11031 44348 17340]
 [17285 52941 36744]]
Evaluating performance on  train set...
448/448 - 16s - 16s/epoch - 36ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0653678
{'0': {'precision': 0.47803390228165876, 'recall': 0.20448101964523172, 'f1-score': 0.2864372825361122, 'support': 39857}, '1': {'precision': 0.39156295889760745, 'recall': 0.7126120289385596, 'f1-score': 0.505413503604216, 'support': 37044}, '2': {'precision': 0.43418167320087714, 'recall': 0.34697182911610863, 'f1-score': 0.3857085934387036, 'support': 37663}, 'accuracy': 0.41562794595160785, 'macro avg': {'precision': 0.4345928447933811, 'recall': 0.42135495923329996, 'f1-score': 0.3925197931930106, 'support': 114564}, 'weighted avg': {'precision': 0.4356572732307503, 'recall': 0.41562794595160785, 'f1-score': 0.3898782458035535, 'support': 114564}}
[[ 8150 21472 10235]
 [ 3851 26398  6795]
 [ 5048 19547 13068]]
Evaluating performance on  val set...
136/136 - 5s - 5s/epoch - 36ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0805424
{'0': {'precision': 0.4522883083194367, 'recall': 0.1979242682234655, 'f1-score': 0.2753525098702764, 'support': 12333}, '1': {'precision': 0.3609561345139991, 'recall': 0.6810894340351555, 'f1-score': 0.471847713358536, 'support': 10354}, '2': {'precision': 0.4301250127045431, 'recall': 0.35015720668542116, 'f1-score': 0.38604332953249715, 'support': 12086}, 'accuracy': 0.3947027866448106, 'macro avg': {'precision': 0.41445648517932626, 'recall': 0.40972363631468073, 'f1-score': 0.37774785092043656, 'support': 34773}, 'weighted avg': {'precision': 0.4173899987579061, 'recall': 0.3947027866448106, 'f1-score': 0.37233351764513156, 'support': 34773}}
[[2441 6388 3504]
 [1199 7052 2103]
 [1757 6097 4232]]
training model: results/CHTR/W6/deepVOL_L2/h20
Epoch 1/50
448/448 - 36s - loss: 3.3185 - accuracy20: 0.3590 - val_loss: 3.3286 - val_accuracy20: 0.3424 - 36s/epoch - 81ms/step
Epoch 2/50
448/448 - 34s - loss: 3.2946 - accuracy20: 0.3656 - val_loss: 3.3328 - val_accuracy20: 0.3356 - 34s/epoch - 75ms/step
Epoch 3/50
448/448 - 32s - loss: 3.2811 - accuracy20: 0.3706 - val_loss: 3.3243 - val_accuracy20: 0.3373 - 32s/epoch - 72ms/step
Epoch 4/50
448/448 - 32s - loss: 3.2753 - accuracy20: 0.3746 - val_loss: 3.3186 - val_accuracy20: 0.3349 - 32s/epoch - 71ms/step
Epoch 5/50
448/448 - 30s - loss: 3.2666 - accuracy20: 0.3806 - val_loss: 3.3087 - val_accuracy20: 0.3427 - 30s/epoch - 68ms/step
Epoch 6/50
448/448 - 32s - loss: 3.2585 - accuracy20: 0.3872 - val_loss: 3.3130 - val_accuracy20: 0.3462 - 32s/epoch - 72ms/step
Epoch 7/50
448/448 - 34s - loss: 3.2583 - accuracy20: 0.3864 - val_loss: 3.3037 - val_accuracy20: 0.3480 - 34s/epoch - 75ms/step
Epoch 8/50
448/448 - 33s - loss: 3.2526 - accuracy20: 0.3916 - val_loss: 3.2865 - val_accuracy20: 0.3617 - 33s/epoch - 74ms/step
Epoch 9/50
448/448 - 33s - loss: 3.2459 - accuracy20: 0.3953 - val_loss: 3.2929 - val_accuracy20: 0.3564 - 33s/epoch - 73ms/step
Epoch 10/50
448/448 - 32s - loss: 3.2446 - accuracy20: 0.3947 - val_loss: 3.2965 - val_accuracy20: 0.3556 - 32s/epoch - 71ms/step
Epoch 11/50
448/448 - 32s - loss: 3.2417 - accuracy20: 0.3971 - val_loss: 3.2721 - val_accuracy20: 0.3713 - 32s/epoch - 71ms/step
Epoch 12/50
448/448 - 32s - loss: 3.2389 - accuracy20: 0.3973 - val_loss: 3.2795 - val_accuracy20: 0.3749 - 32s/epoch - 72ms/step
Epoch 13/50
448/448 - 31s - loss: 3.2357 - accuracy20: 0.4006 - val_loss: 3.2887 - val_accuracy20: 0.3699 - 31s/epoch - 70ms/step
Epoch 14/50
448/448 - 31s - loss: 3.2319 - accuracy20: 0.4027 - val_loss: 3.2824 - val_accuracy20: 0.3655 - 31s/epoch - 68ms/step
Epoch 15/50
448/448 - 32s - loss: 3.2312 - accuracy20: 0.4009 - val_loss: 3.2651 - val_accuracy20: 0.3752 - 32s/epoch - 70ms/step
Epoch 16/50
448/448 - 32s - loss: 3.2271 - accuracy20: 0.4050 - val_loss: 3.2741 - val_accuracy20: 0.3718 - 32s/epoch - 72ms/step
Epoch 17/50
448/448 - 33s - loss: 3.2246 - accuracy20: 0.4055 - val_loss: 3.2723 - val_accuracy20: 0.3737 - 33s/epoch - 73ms/step
Epoch 18/50
448/448 - 32s - loss: 3.2215 - accuracy20: 0.4087 - val_loss: 3.2881 - val_accuracy20: 0.3708 - 32s/epoch - 71ms/step
Epoch 19/50
448/448 - 31s - loss: 3.2190 - accuracy20: 0.4090 - val_loss: 3.2781 - val_accuracy20: 0.3751 - 31s/epoch - 70ms/step
Epoch 20/50
448/448 - 33s - loss: 3.2170 - accuracy20: 0.4095 - val_loss: 3.2723 - val_accuracy20: 0.3776 - 33s/epoch - 74ms/step
Epoch 21/50
448/448 - 32s - loss: 3.2136 - accuracy20: 0.4120 - val_loss: 3.2819 - val_accuracy20: 0.3753 - 32s/epoch - 71ms/step
Epoch 22/50
448/448 - 33s - loss: 3.2121 - accuracy20: 0.4107 - val_loss: 3.2797 - val_accuracy20: 0.3744 - 33s/epoch - 74ms/step
Epoch 23/50
448/448 - 33s - loss: 3.2097 - accuracy20: 0.4115 - val_loss: 3.2736 - val_accuracy20: 0.3778 - 33s/epoch - 73ms/step
Epoch 24/50
448/448 - 33s - loss: 3.2073 - accuracy20: 0.4109 - val_loss: 3.2844 - val_accuracy20: 0.3752 - 33s/epoch - 73ms/step
Epoch 25/50
448/448 - 32s - loss: 3.2047 - accuracy20: 0.4156 - val_loss: 3.2870 - val_accuracy20: 0.3774 - 32s/epoch - 71ms/step
testing model: results/CHTR/W6/deepVOL_L2/h20
Evaluating performance on  test set...
1095/1095 - 41s - 41s/epoch - 37ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0976605
{'0': {'precision': 0.43363215480917616, 'recall': 0.24652510794345536, 'f1-score': 0.3143426369938345, 'support': 101442}, '1': {'precision': 0.2966244833719338, 'recall': 0.6287531530554125, 'f1-score': 0.40308641975308646, 'support': 73738}, '2': {'precision': 0.44039264323310545, 'recall': 0.27754530116577225, 'f1-score': 0.3404999269112703, 'support': 104909}, 'accuracy': 0.3587716761457965, 'macro avg': {'precision': 0.39021642713807186, 'recall': 0.3842745207215467, 'f1-score': 0.35264299455273046, 'support': 280089}, 'weighted avg': {'precision': 0.40009483061446166, 'recall': 0.3587716761457965, 'f1-score': 0.3475032544441806, 'support': 280089}}
[[25008 53869 22565]
 [12941 46363 14434]
 [19722 56070 29117]]
Evaluating performance on  train set...
448/448 - 17s - 17s/epoch - 38ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0811715
{'0': {'precision': 0.4441046031503288, 'recall': 0.22103260180134465, 'f1-score': 0.29516194606315216, 'support': 39415}, '1': {'precision': 0.3686655465032546, 'recall': 0.7018817204301075, 'f1-score': 0.48341556890662174, 'support': 37200}, '2': {'precision': 0.4262560106118388, 'recall': 0.27096893198766764, 'f1-score': 0.3313195753387141, 'support': 37949}, 'accuracy': 0.393710065989316, 'macro avg': {'precision': 0.41300872008847406, 'recall': 0.3979610847397066, 'f1-score': 0.369965696769496, 'support': 114564}, 'weighted avg': {'precision': 0.41369654175657233, 'recall': 0.393710065989316, 'f1-score': 0.36826676645311207, 'support': 114564}}
[[ 8712 23089  7614]
 [ 4863 26110  6227]
 [ 6042 21624 10283]]
Evaluating performance on  val set...
136/136 - 4s - 4s/epoch - 32ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0901989
{'0': {'precision': 0.4296190020723737, 'recall': 0.22113727742676623, 'f1-score': 0.29198266522210187, 'support': 12187}, '1': {'precision': 0.34386858158412986, 'recall': 0.6790287394479749, 'f1-score': 0.4565397614948026, 'support': 10543}, '2': {'precision': 0.4239031376122901, 'recall': 0.2703645271111849, 'f1-score': 0.33015615493814643, 'support': 12043}, 'accuracy': 0.37701665084979724, 'macro avg': {'precision': 0.39913024042293127, 'recall': 0.3901768479953087, 'f1-score': 0.35955952721835027, 'support': 34773}, 'weighted avg': {'precision': 0.4016403163420559, 'recall': 0.37701665084979724, 'f1-score': 0.35509625342712897, 'support': 34773}}
[[2695 6963 2529]
 [1488 7159 1896]
 [2090 6697 3256]]
training model: results/CHTR/W6/deepVOL_L2/h30
Epoch 1/50
448/448 - 39s - loss: 3.3178 - accuracy30: 0.3590 - val_loss: 3.3574 - val_accuracy30: 0.3290 - 39s/epoch - 87ms/step
Epoch 2/50
448/448 - 33s - loss: 3.2943 - accuracy30: 0.3648 - val_loss: 3.3402 - val_accuracy30: 0.3238 - 33s/epoch - 73ms/step
Epoch 3/50
448/448 - 32s - loss: 3.2848 - accuracy30: 0.3660 - val_loss: 3.3647 - val_accuracy30: 0.3225 - 32s/epoch - 72ms/step
Epoch 4/50
448/448 - 32s - loss: 3.2770 - accuracy30: 0.3735 - val_loss: 3.3257 - val_accuracy30: 0.3319 - 32s/epoch - 71ms/step
Epoch 5/50
448/448 - 33s - loss: 3.2751 - accuracy30: 0.3748 - val_loss: 3.3237 - val_accuracy30: 0.3319 - 33s/epoch - 74ms/step
Epoch 6/50
448/448 - 33s - loss: 3.2699 - accuracy30: 0.3804 - val_loss: 3.3081 - val_accuracy30: 0.3487 - 33s/epoch - 73ms/step
Epoch 7/50
448/448 - 33s - loss: 3.2668 - accuracy30: 0.3820 - val_loss: 3.3215 - val_accuracy30: 0.3435 - 33s/epoch - 74ms/step
Epoch 8/50
448/448 - 32s - loss: 3.2622 - accuracy30: 0.3859 - val_loss: 3.3036 - val_accuracy30: 0.3522 - 32s/epoch - 72ms/step
Epoch 9/50
448/448 - 32s - loss: 3.2600 - accuracy30: 0.3868 - val_loss: 3.3013 - val_accuracy30: 0.3517 - 32s/epoch - 72ms/step
Epoch 10/50
448/448 - 33s - loss: 3.2568 - accuracy30: 0.3872 - val_loss: 3.2980 - val_accuracy30: 0.3577 - 33s/epoch - 74ms/step
Epoch 11/50
448/448 - 35s - loss: 3.2554 - accuracy30: 0.3885 - val_loss: 3.2952 - val_accuracy30: 0.3584 - 35s/epoch - 78ms/step
Epoch 12/50
448/448 - 31s - loss: 3.2509 - accuracy30: 0.3926 - val_loss: 3.3017 - val_accuracy30: 0.3575 - 31s/epoch - 69ms/step
Epoch 13/50
448/448 - 31s - loss: 3.2490 - accuracy30: 0.3922 - val_loss: 3.3032 - val_accuracy30: 0.3622 - 31s/epoch - 69ms/step
Epoch 14/50
448/448 - 32s - loss: 3.2474 - accuracy30: 0.3937 - val_loss: 3.2945 - val_accuracy30: 0.3626 - 32s/epoch - 70ms/step
Epoch 15/50
448/448 - 32s - loss: 3.2451 - accuracy30: 0.3937 - val_loss: 3.3142 - val_accuracy30: 0.3549 - 32s/epoch - 71ms/step
Epoch 16/50
448/448 - 33s - loss: 3.2421 - accuracy30: 0.3956 - val_loss: 3.3041 - val_accuracy30: 0.3573 - 33s/epoch - 74ms/step
Epoch 17/50
448/448 - 33s - loss: 3.2383 - accuracy30: 0.3999 - val_loss: 3.3114 - val_accuracy30: 0.3570 - 33s/epoch - 73ms/step
Epoch 18/50
448/448 - 34s - loss: 3.2356 - accuracy30: 0.4005 - val_loss: 3.3182 - val_accuracy30: 0.3555 - 34s/epoch - 75ms/step
Epoch 19/50
448/448 - 32s - loss: 3.2338 - accuracy30: 0.4016 - val_loss: 3.3302 - val_accuracy30: 0.3523 - 32s/epoch - 72ms/step
Epoch 20/50
448/448 - 33s - loss: 3.2319 - accuracy30: 0.4018 - val_loss: 3.3206 - val_accuracy30: 0.3567 - 33s/epoch - 74ms/step
Epoch 21/50
448/448 - 33s - loss: 3.2282 - accuracy30: 0.4033 - val_loss: 3.3248 - val_accuracy30: 0.3584 - 33s/epoch - 73ms/step
Epoch 22/50
448/448 - 34s - loss: 3.2263 - accuracy30: 0.4038 - val_loss: 3.3122 - val_accuracy30: 0.3590 - 34s/epoch - 76ms/step
Epoch 23/50
448/448 - 32s - loss: 3.2246 - accuracy30: 0.4050 - val_loss: 3.3227 - val_accuracy30: 0.3575 - 32s/epoch - 72ms/step
Epoch 24/50
448/448 - 33s - loss: 3.2253 - accuracy30: 0.4055 - val_loss: 3.3194 - val_accuracy30: 0.3617 - 33s/epoch - 75ms/step
testing model: results/CHTR/W6/deepVOL_L2/h30
Evaluating performance on  test set...
1095/1095 - 37s - 37s/epoch - 34ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1091703
{'0': {'precision': 0.41950280542245155, 'recall': 0.20295425950326434, 'f1-score': 0.2735606551247554, 'support': 100939}, '1': {'precision': 0.2882114881026606, 'recall': 0.6785976431650452, 'f1-score': 0.4045878968956504, 'support': 74931}, '2': {'precision': 0.43236243593718654, 'recall': 0.22746332242681278, 'f1-score': 0.29809868718877325, 'support': 104219}, 'accuracy': 0.33932071591529833, 'macro avg': {'precision': 0.3800255764874329, 'recall': 0.36967174169837413, 'f1-score': 0.32541574640305965, 'support': 280089}, 'weighted avg': {'precision': 0.38916397788736773, 'recall': 0.33932071591529833, 'f1-score': 0.3177442232649351, 'support': 280089}}
[[20486 61735 18718]
 [11678 50848 12405]
 [16670 63843 23706]]
Evaluating performance on  train set...
448/448 - 16s - 16s/epoch - 35ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0892075
{'0': {'precision': 0.4338413159167876, 'recall': 0.1856673309350656, 'f1-score': 0.26004531037607614, 'support': 38639}, '1': {'precision': 0.35935229128885804, 'recall': 0.7386063233583589, 'f1-score': 0.48347883265991226, 'support': 37828}, '2': {'precision': 0.42604921832618237, 'recall': 0.2267632621991233, 'f1-score': 0.29598793983622845, 'support': 38097}, 'accuracy': 0.3819088020669669, 'macro avg': {'precision': 0.40641427517727596, 'recall': 0.3836789721641826, 'f1-score': 0.3465040276240723, 'support': 114564}, 'weighted avg': {'precision': 0.4066545350298195, 'recall': 0.3819088020669669, 'f1-score': 0.3457733718569635, 'support': 114564}}
[[ 7174 25339  6126]
 [ 4376 27940  5512]
 [ 4986 24472  8639]]
Evaluating performance on  val set...
136/136 - 6s - 6s/epoch - 40ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0993619
{'0': {'precision': 0.4205020920502092, 'recall': 0.18395873200765456, 'f1-score': 0.2559472130578226, 'support': 12019}, '1': {'precision': 0.3318156194440831, 'recall': 0.7198494825964252, 'f1-score': 0.4542459410525066, 'support': 10630}, '2': {'precision': 0.4220638363805392, 'recall': 0.22467832398548335, 'f1-score': 0.293250080740661, 'support': 12124}, 'accuracy': 0.36197624593794037, 'macro avg': {'precision': 0.39146051595827713, 'recall': 0.37616217952985437, 'f1-score': 0.3344810782836634, 'support': 34773}, 'weighted avg': {'precision': 0.3939354278123753, 'recall': 0.36197624593794037, 'f1-score': 0.32957259615304657, 'support': 34773}}
[[2211 7736 2072]
 [1320 7652 1658]
 [1727 7673 2724]]
training model: results/CHTR/W6/deepVOL_L2/h50
Epoch 1/50
448/448 - 38s - loss: 3.3279 - accuracy50: 0.3523 - val_loss: 3.3565 - val_accuracy50: 0.3240 - 38s/epoch - 86ms/step
Epoch 2/50
448/448 - 32s - loss: 3.3022 - accuracy50: 0.3611 - val_loss: 3.3979 - val_accuracy50: 0.3214 - 32s/epoch - 71ms/step
Epoch 3/50
448/448 - 32s - loss: 3.2890 - accuracy50: 0.3684 - val_loss: 3.3817 - val_accuracy50: 0.3194 - 32s/epoch - 71ms/step
Epoch 4/50
448/448 - 32s - loss: 3.2817 - accuracy50: 0.3729 - val_loss: 3.3505 - val_accuracy50: 0.3249 - 32s/epoch - 72ms/step
Epoch 5/50
448/448 - 34s - loss: 3.2773 - accuracy50: 0.3739 - val_loss: 3.3622 - val_accuracy50: 0.3233 - 34s/epoch - 76ms/step
Epoch 6/50
448/448 - 33s - loss: 3.2724 - accuracy50: 0.3783 - val_loss: 3.3696 - val_accuracy50: 0.3253 - 33s/epoch - 73ms/step
Epoch 7/50
448/448 - 32s - loss: 3.2715 - accuracy50: 0.3780 - val_loss: 3.3425 - val_accuracy50: 0.3316 - 32s/epoch - 72ms/step
Epoch 8/50
448/448 - 33s - loss: 3.2678 - accuracy50: 0.3804 - val_loss: 3.3287 - val_accuracy50: 0.3360 - 33s/epoch - 74ms/step
Epoch 9/50
448/448 - 33s - loss: 3.2644 - accuracy50: 0.3817 - val_loss: 3.3484 - val_accuracy50: 0.3240 - 33s/epoch - 73ms/step
Epoch 10/50
448/448 - 32s - loss: 3.2618 - accuracy50: 0.3854 - val_loss: 3.3347 - val_accuracy50: 0.3313 - 32s/epoch - 72ms/step
Epoch 11/50
448/448 - 34s - loss: 3.2594 - accuracy50: 0.3862 - val_loss: 3.3382 - val_accuracy50: 0.3306 - 34s/epoch - 75ms/step
Epoch 12/50
448/448 - 33s - loss: 3.2557 - accuracy50: 0.3897 - val_loss: 3.3276 - val_accuracy50: 0.3376 - 33s/epoch - 75ms/step
Epoch 13/50
448/448 - 31s - loss: 3.2542 - accuracy50: 0.3887 - val_loss: 3.3341 - val_accuracy50: 0.3375 - 31s/epoch - 68ms/step
Epoch 14/50
448/448 - 32s - loss: 3.2532 - accuracy50: 0.3905 - val_loss: 3.3368 - val_accuracy50: 0.3396 - 32s/epoch - 71ms/step
Epoch 15/50
448/448 - 34s - loss: 3.2521 - accuracy50: 0.3888 - val_loss: 3.3256 - val_accuracy50: 0.3395 - 34s/epoch - 75ms/step
Epoch 16/50
448/448 - 36s - loss: 3.2489 - accuracy50: 0.3910 - val_loss: 3.3575 - val_accuracy50: 0.3362 - 36s/epoch - 79ms/step
Epoch 17/50
448/448 - 34s - loss: 3.2468 - accuracy50: 0.3943 - val_loss: 3.3521 - val_accuracy50: 0.3395 - 34s/epoch - 76ms/step
Epoch 18/50
448/448 - 33s - loss: 3.2451 - accuracy50: 0.3940 - val_loss: 3.3694 - val_accuracy50: 0.3362 - 33s/epoch - 74ms/step
Epoch 19/50
448/448 - 33s - loss: 3.2433 - accuracy50: 0.3942 - val_loss: 3.3512 - val_accuracy50: 0.3417 - 33s/epoch - 73ms/step
Epoch 20/50
448/448 - 32s - loss: 3.2425 - accuracy50: 0.3944 - val_loss: 3.3495 - val_accuracy50: 0.3408 - 32s/epoch - 71ms/step
Epoch 21/50
448/448 - 32s - loss: 3.2399 - accuracy50: 0.3967 - val_loss: 3.3443 - val_accuracy50: 0.3426 - 32s/epoch - 71ms/step
Epoch 22/50
448/448 - 32s - loss: 3.2405 - accuracy50: 0.3978 - val_loss: 3.3315 - val_accuracy50: 0.3425 - 32s/epoch - 72ms/step
Epoch 23/50
448/448 - 34s - loss: 3.2354 - accuracy50: 0.3977 - val_loss: 3.3409 - val_accuracy50: 0.3431 - 34s/epoch - 76ms/step
Epoch 24/50
448/448 - 35s - loss: 3.2348 - accuracy50: 0.3996 - val_loss: 3.3362 - val_accuracy50: 0.3480 - 35s/epoch - 78ms/step
Epoch 25/50
448/448 - 32s - loss: 3.2313 - accuracy50: 0.4003 - val_loss: 3.3387 - val_accuracy50: 0.3434 - 32s/epoch - 72ms/step
testing model: results/CHTR/W6/deepVOL_L2/h50
Evaluating performance on  test set...
1095/1095 - 41s - 41s/epoch - 38ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1234025
{'0': {'precision': 0.4149354737173434, 'recall': 0.10528627764189089, 'f1-score': 0.16795534356311861, 'support': 100165}, '1': {'precision': 0.28072802259380464, 'recall': 0.8214337246671476, 'f1-score': 0.41844940779472445, 'support': 76235}, '2': {'precision': 0.42138404581843497, 'recall': 0.12843213841391082, 'f1-score': 0.1968630813351861, 'support': 103689}, 'accuracy': 0.3087768530717022, 'macro avg': {'precision': 0.37234918070986106, 'recall': 0.35171738024098315, 'f1-score': 0.261089277564343, 'support': 280089}, 'weighted avg': {'precision': 0.38079397210959415, 'recall': 0.3087768530717022, 'f1-score': 0.2468368041293828, 'support': 280089}}
[[10546 78604 11015]
 [ 6342 62622  7271]
 [ 8528 81844 13317]]
Evaluating performance on  train set...
448/448 - 17s - 17s/epoch - 38ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0982827
{'0': {'precision': 0.4511374559436078, 'recall': 0.11059039141248854, 'f1-score': 0.17763572900458388, 'support': 38195}, '1': {'precision': 0.3454517830399583, 'recall': 0.8379047117662543, 'f1-score': 0.489211286653962, 'support': 37990}, '2': {'precision': 0.42841823056300266, 'recall': 0.14573073816410015, 'f1-score': 0.21748259905898817, 'support': 38379}, 'accuracy': 0.3635435215250864, 'macro avg': {'precision': 0.40833582318218964, 'recall': 0.364741947114281, 'f1-score': 0.294776538239178, 'support': 114564}, 'weighted avg': {'precision': 0.4084806015697042, 'recall': 0.3635435215250864, 'f1-score': 0.2943044771359153, 'support': 114564}}
[[ 4224 30155  3816]
 [ 2512 31832  3646]
 [ 2627 30159  5593]]
Evaluating performance on  val set...
136/136 - 5s - 5s/epoch - 37ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1096134
{'0': {'precision': 0.42094385118842575, 'recall': 0.10396460779309172, 'f1-score': 0.16674626458347547, 'support': 11754}, '1': {'precision': 0.322493128190483, 'recall': 0.8261545496113397, 'f1-score': 0.4639005853959125, 'support': 10935}, '2': {'precision': 0.39875550946331345, 'recall': 0.12727573651108903, 'f1-score': 0.19296154569976787, 'support': 12084}, 'accuracy': 0.33917119604290685, 'macro avg': {'precision': 0.38073082961407406, 'recall': 0.3524649646385068, 'f1-score': 0.274536131893052, 'support': 34773}, 'weighted avg': {'precision': 0.38227354441625305, 'recall': 0.33917119604290685, 'f1-score': 0.26930192429340205, 'support': 34773}}
[[1222 9286 1246]
 [ 828 9034 1073]
 [ 853 9693 1538]]
training model: results/CHTR/W6/deepVOL_L2/h100
Epoch 1/50
448/448 - 39s - loss: 3.3264 - accuracy100: 0.3598 - val_loss: 3.5213 - val_accuracy100: 0.3140 - 39s/epoch - 88ms/step
Epoch 2/50
448/448 - 32s - loss: 3.3072 - accuracy100: 0.3588 - val_loss: 3.5025 - val_accuracy100: 0.3152 - 32s/epoch - 72ms/step
Epoch 3/50
448/448 - 33s - loss: 3.2987 - accuracy100: 0.3565 - val_loss: 3.4269 - val_accuracy100: 0.3142 - 33s/epoch - 73ms/step
Epoch 4/50
448/448 - 35s - loss: 3.2916 - accuracy100: 0.3600 - val_loss: 3.3827 - val_accuracy100: 0.3136 - 35s/epoch - 78ms/step
Epoch 5/50
448/448 - 32s - loss: 3.2874 - accuracy100: 0.3645 - val_loss: 3.3539 - val_accuracy100: 0.3141 - 32s/epoch - 72ms/step
Epoch 6/50
448/448 - 31s - loss: 3.2840 - accuracy100: 0.3661 - val_loss: 3.3525 - val_accuracy100: 0.3141 - 31s/epoch - 69ms/step
Epoch 7/50
448/448 - 31s - loss: 3.2833 - accuracy100: 0.3653 - val_loss: 3.3589 - val_accuracy100: 0.3143 - 31s/epoch - 70ms/step
Epoch 8/50
448/448 - 32s - loss: 3.2810 - accuracy100: 0.3683 - val_loss: 3.3584 - val_accuracy100: 0.3140 - 32s/epoch - 71ms/step
Epoch 9/50
448/448 - 32s - loss: 3.2777 - accuracy100: 0.3724 - val_loss: 3.3592 - val_accuracy100: 0.3155 - 32s/epoch - 72ms/step
Epoch 10/50
448/448 - 34s - loss: 3.2748 - accuracy100: 0.3764 - val_loss: 3.3623 - val_accuracy100: 0.3175 - 34s/epoch - 75ms/step
Epoch 11/50
448/448 - 31s - loss: 3.2719 - accuracy100: 0.3768 - val_loss: 3.3721 - val_accuracy100: 0.3184 - 31s/epoch - 70ms/step
Epoch 12/50
448/448 - 33s - loss: 3.2691 - accuracy100: 0.3798 - val_loss: 3.3761 - val_accuracy100: 0.3185 - 33s/epoch - 73ms/step
Epoch 13/50
448/448 - 33s - loss: 3.2682 - accuracy100: 0.3813 - val_loss: 3.3884 - val_accuracy100: 0.3180 - 33s/epoch - 73ms/step
Epoch 14/50
448/448 - 36s - loss: 3.2651 - accuracy100: 0.3819 - val_loss: 3.4240 - val_accuracy100: 0.3192 - 36s/epoch - 79ms/step
Epoch 15/50
448/448 - 33s - loss: 3.2658 - accuracy100: 0.3821 - val_loss: 3.3759 - val_accuracy100: 0.3194 - 33s/epoch - 74ms/step
Epoch 16/50
448/448 - 33s - loss: 3.2622 - accuracy100: 0.3843 - val_loss: 3.3796 - val_accuracy100: 0.3225 - 33s/epoch - 75ms/step
testing model: results/CHTR/W6/deepVOL_L2/h100
Evaluating performance on  test set...
1095/1095 - 38s - 38s/epoch - 35ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1342168
{'0': {'precision': 0.35396449704142013, 'recall': 0.030224333063864187, 'f1-score': 0.05569313844148589, 'support': 98960}, '1': {'precision': 0.27141959308444374, 'recall': 0.9581479001746025, 'f1-score': 0.42301071654195915, 'support': 76173}, '2': {'precision': 0.3845872899926954, 'recall': 0.010032775639315523, 'f1-score': 0.01955540698646164, 'support': 104956}, 'accuracy': 0.2750161555791195, 'macro avg': {'precision': 0.3366571267061864, 'recall': 0.3328016696259274, 'f1-score': 0.16608642065663556, 'support': 280089}, 'weighted avg': {'precision': 0.3429906740347305, 'recall': 0.2750161555791195, 'f1-score': 0.14204715496499745, 'support': 280089}}
[[  2991  95018    951]
 [  2454  72985    734]
 [  3005 100898   1053]]
Evaluating performance on  train set...
448/448 - 16s - 16s/epoch - 36ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1109604
{'0': {'precision': 0.408009286128845, 'recall': 0.03683424589347934, 'f1-score': 0.06756854170170844, 'support': 38171}, '1': {'precision': 0.33215004141521715, 'recall': 0.9632807137954701, 'f1-score': 0.49397272327320724, 'support': 37882}, '2': {'precision': 0.41115537848605577, 'recall': 0.01339876918283088, 'f1-score': 0.025951818136096164, 'support': 38511}, 'accuracy': 0.33529730107188993, 'macro avg': {'precision': 0.383771568676706, 'recall': 0.33783790962392674, 'f1-score': 0.19583102770367058, 'support': 114564}, 'weighted avg': {'precision': 0.3839830584703039, 'recall': 0.33529730107188993, 'f1-score': 0.19457477022948527, 'support': 114564}}
[[ 1406 36398   367]
 [ 1019 36491   372]
 [ 1021 36974   516]]
Evaluating performance on  val set...
136/136 - 5s - 5s/epoch - 34ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1189562
{'0': {'precision': 0.3731041456016178, 'recall': 0.031630378878793074, 'f1-score': 0.05831687080205453, 'support': 11666}, '1': {'precision': 0.3127638552052457, 'recall': 0.9607284098224961, 'f1-score': 0.4719009757860499, 'support': 10873}, '2': {'precision': 0.33766233766233766, 'recall': 0.010626123916952755, 'f1-score': 0.020603851335288054, 'support': 12234}, 'accuracy': 0.31475570126247376, 'macro avg': {'precision': 0.34117677948973374, 'recall': 0.3343283042060807, 'f1-score': 0.18360723264113085, 'support': 34773}, 'weighted avg': {'precision': 0.3417673309520648, 'recall': 0.31475570126247376, 'f1-score': 0.17437009868962708, 'support': 34773}}
[[  369 11163   134]
 [  306 10446   121]
 [  314 11790   130]]
training model: results/CHTR/W6/deepVOL_L2/h200
Epoch 1/50
448/448 - 35s - loss: 3.3325 - accuracy200: 0.3542 - val_loss: 3.5938 - val_accuracy200: 0.2964 - 35s/epoch - 78ms/step
Epoch 2/50
448/448 - 31s - loss: 3.3031 - accuracy200: 0.3573 - val_loss: 3.4653 - val_accuracy200: 0.2954 - 31s/epoch - 70ms/step
Epoch 3/50
448/448 - 31s - loss: 3.2961 - accuracy200: 0.3535 - val_loss: 3.3855 - val_accuracy200: 0.2958 - 31s/epoch - 70ms/step
Epoch 4/50
448/448 - 31s - loss: 3.2925 - accuracy200: 0.3545 - val_loss: 3.3913 - val_accuracy200: 0.2971 - 31s/epoch - 69ms/step
Epoch 5/50
448/448 - 32s - loss: 3.2888 - accuracy200: 0.3561 - val_loss: 3.4288 - val_accuracy200: 0.2973 - 32s/epoch - 71ms/step
Epoch 6/50
448/448 - 32s - loss: 3.2880 - accuracy200: 0.3569 - val_loss: 3.3739 - val_accuracy200: 0.2978 - 32s/epoch - 71ms/step
Epoch 7/50
448/448 - 32s - loss: 3.2858 - accuracy200: 0.3594 - val_loss: 3.3655 - val_accuracy200: 0.2964 - 32s/epoch - 72ms/step
Epoch 8/50
448/448 - 32s - loss: 3.2832 - accuracy200: 0.3620 - val_loss: 3.3656 - val_accuracy200: 0.2963 - 32s/epoch - 71ms/step
Epoch 9/50
448/448 - 31s - loss: 3.2821 - accuracy200: 0.3640 - val_loss: 3.3769 - val_accuracy200: 0.2966 - 31s/epoch - 68ms/step
Epoch 10/50
448/448 - 32s - loss: 3.2797 - accuracy200: 0.3658 - val_loss: 3.3911 - val_accuracy200: 0.2965 - 32s/epoch - 72ms/step
Epoch 11/50
448/448 - 31s - loss: 3.2782 - accuracy200: 0.3669 - val_loss: 3.3892 - val_accuracy200: 0.2961 - 31s/epoch - 70ms/step
Epoch 12/50
448/448 - 31s - loss: 3.2761 - accuracy200: 0.3692 - val_loss: 3.4086 - val_accuracy200: 0.2959 - 31s/epoch - 68ms/step
Epoch 13/50
448/448 - 32s - loss: 3.2749 - accuracy200: 0.3706 - val_loss: 3.3933 - val_accuracy200: 0.2959 - 32s/epoch - 72ms/step
Epoch 14/50
448/448 - 33s - loss: 3.2723 - accuracy200: 0.3729 - val_loss: 3.4217 - val_accuracy200: 0.2954 - 33s/epoch - 74ms/step
Epoch 15/50
448/448 - 32s - loss: 3.2707 - accuracy200: 0.3734 - val_loss: 3.4345 - val_accuracy200: 0.2965 - 32s/epoch - 71ms/step
Epoch 16/50
448/448 - 33s - loss: 3.2684 - accuracy200: 0.3768 - val_loss: 3.4364 - val_accuracy200: 0.2969 - 33s/epoch - 73ms/step
Epoch 17/50
448/448 - 31s - loss: 3.2687 - accuracy200: 0.3753 - val_loss: 3.4385 - val_accuracy200: 0.2958 - 31s/epoch - 70ms/step
testing model: results/CHTR/W6/deepVOL_L2/h200
Evaluating performance on  test set...
1095/1095 - 38s - 38s/epoch - 35ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1344591
{'0': {'precision': 0.3838383838383838, 'recall': 0.0057797020918465645, 'f1-score': 0.011387928795476794, 'support': 98621}, '1': {'precision': 0.26192503951556445, 'recall': 0.9899478981968957, 'f1-score': 0.4142467410907929, 'support': 73318}, '2': {'precision': 0.4205607476635514, 'recall': 0.005825242718446602, 'f1-score': 0.011491317671092953, 'support': 108150}, 'accuracy': 0.26341984155036435, 'macro avg': {'precision': 0.3554413903391665, 'recall': 0.3338509476690629, 'f1-score': 0.14570866251912087, 'support': 280089}, 'weighted avg': {'precision': 0.36610502432991116, 'recall': 0.26341984155036435, 'f1-score': 0.11688291041476878, 'support': 280089}}
[[   570  97546    505]
 [   374  72581    363]
 [   541 106979    630]]
Evaluating performance on  train set...
448/448 - 17s - 17s/epoch - 37ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1108654
{'0': {'precision': 0.41797432239657634, 'recall': 0.007741287748685566, 'f1-score': 0.015201037613488975, 'support': 37849}, '1': {'precision': 0.33118968216759404, 'recall': 0.9883582798764552, 'f1-score': 0.4961306053217428, 'support': 37881}, '2': {'precision': 0.3737745098039216, 'recall': 0.007853942421589329, 'f1-score': 0.015384615384615384, 'support': 38834}, 'accuracy': 0.33202402150762894, 'macro avg': {'precision': 0.3743128381226973, 'recall': 0.3346511700155767, 'f1-score': 0.1755720861066157, 'support': 114564}, 'weighted avg': {'precision': 0.37429616452204995, 'recall': 0.33202402150762894, 'f1-score': 0.17428436233609193, 'support': 114564}}
[[  293 37282   274]
 [  204 37440   237]
 [  204 38325   305]]
Evaluating performance on  val set...
136/136 - 5s - 5s/epoch - 38ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1245662
{'0': {'precision': 0.35046728971962615, 'recall': 0.006431143886125879, 'f1-score': 0.012630515325025262, 'support': 11662}, '1': {'precision': 0.2950251797514045, 'recall': 0.9884911733151273, 'f1-score': 0.45442317177061387, 'support': 10253}, '2': {'precision': 0.3737864077669903, 'recall': 0.0059884896562451394, 'f1-score': 0.011788120024494796, 'support': 12858}, 'accuracy': 0.29583297385902857, 'macro avg': {'precision': 0.339759625746007, 'recall': 0.33363693561916613, 'f1-score': 0.1596139357067113, 'support': 34773}, 'weighted avg': {'precision': 0.34274259718084127, 'recall': 0.29583297385902857, 'f1-score': 0.14258388684207582, 'support': 34773}}
[[   75 11517    70]
 [   59 10135    59]
 [   80 12701    77]]
training model: results/CHTR/W6/deepVOL_L2/h300
Epoch 1/50
448/448 - 38s - loss: 3.3280 - accuracy300: 0.3554 - val_loss: 3.5232 - val_accuracy300: 0.2984 - 38s/epoch - 85ms/step
Epoch 2/50
448/448 - 32s - loss: 3.3099 - accuracy300: 0.3557 - val_loss: 3.5638 - val_accuracy300: 0.2924 - 32s/epoch - 71ms/step
Epoch 3/50
448/448 - 32s - loss: 3.3056 - accuracy300: 0.3524 - val_loss: 3.5469 - val_accuracy300: 0.2905 - 32s/epoch - 73ms/step
Epoch 4/50
448/448 - 32s - loss: 3.2955 - accuracy300: 0.3569 - val_loss: 3.3909 - val_accuracy300: 0.2905 - 32s/epoch - 70ms/step
Epoch 5/50
448/448 - 32s - loss: 3.2907 - accuracy300: 0.3565 - val_loss: 3.3608 - val_accuracy300: 0.2907 - 32s/epoch - 71ms/step
Epoch 6/50
448/448 - 33s - loss: 3.2908 - accuracy300: 0.3554 - val_loss: 3.3680 - val_accuracy300: 0.2904 - 33s/epoch - 73ms/step
Epoch 7/50
448/448 - 32s - loss: 3.2863 - accuracy300: 0.3595 - val_loss: 3.4069 - val_accuracy300: 0.2901 - 32s/epoch - 71ms/step
Epoch 8/50
448/448 - 33s - loss: 3.2852 - accuracy300: 0.3619 - val_loss: 3.3756 - val_accuracy300: 0.2910 - 33s/epoch - 74ms/step
Epoch 9/50
448/448 - 31s - loss: 3.2822 - accuracy300: 0.3649 - val_loss: 3.4231 - val_accuracy300: 0.2906 - 31s/epoch - 68ms/step
Epoch 10/50
448/448 - 31s - loss: 3.2790 - accuracy300: 0.3667 - val_loss: 3.4513 - val_accuracy300: 0.2901 - 31s/epoch - 70ms/step
Epoch 11/50
448/448 - 31s - loss: 3.2779 - accuracy300: 0.3694 - val_loss: 3.4375 - val_accuracy300: 0.2908 - 31s/epoch - 70ms/step
Epoch 12/50
448/448 - 31s - loss: 3.2756 - accuracy300: 0.3710 - val_loss: 3.4472 - val_accuracy300: 0.2910 - 31s/epoch - 70ms/step
Epoch 13/50
448/448 - 32s - loss: 3.2739 - accuracy300: 0.3726 - val_loss: 3.4428 - val_accuracy300: 0.2914 - 32s/epoch - 71ms/step
Epoch 14/50
448/448 - 31s - loss: 3.2726 - accuracy300: 0.3739 - val_loss: 3.4445 - val_accuracy300: 0.2915 - 31s/epoch - 70ms/step
Epoch 15/50
448/448 - 31s - loss: 3.2719 - accuracy300: 0.3744 - val_loss: 3.4582 - val_accuracy300: 0.2912 - 31s/epoch - 69ms/step
testing model: results/CHTR/W6/deepVOL_L2/h300
Evaluating performance on  test set...
1095/1095 - 37s - 37s/epoch - 34ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1329598
{'0': {'precision': 0.3444976076555024, 'recall': 0.001449610920402267, 'f1-score': 0.0028870733296576614, 'support': 99337}, '1': {'precision': 0.2556055256769241, 'recall': 0.9984055721059035, 'f1-score': 0.4070107219116419, 'support': 71499}, '2': {'precision': 0.48346055979643765, 'recall': 0.0017390826796518173, 'f1-score': 0.0034656987030990643, 'support': 109253}, 'accuracy': 0.2560578958830943, 'macro avg': {'precision': 0.3611878977096214, 'recall': 0.33386475523531917, 'f1-score': 0.13778783131479952, 'support': 280089}, 'weighted avg': {'precision': 0.37601053547797036, 'recall': 0.2560578958830943, 'f1-score': 0.10627440131429071, 'support': 280089}}
[[   144  99045    148]
 [    59  71385     55]
 [   215 108848    190]]
Evaluating performance on  train set...
448/448 - 16s - 16s/epoch - 36ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.110028
{'0': {'precision': 0.4074074074074074, 'recall': 0.002061966098063894, 'f1-score': 0.0041031652989449, 'support': 37343}, '1': {'precision': 0.3304495542985237, 'recall': 0.9977526901620707, 'f1-score': 0.4964709751685578, 'support': 37823}, '2': {'precision': 0.35260115606936415, 'recall': 0.00154830194426113, 'f1-score': 0.0030830658815799447, 'support': 39398}, 'accuracy': 0.3306099647358682, 'macro avg': {'precision': 0.36348603925843176, 'recall': 0.33378765273479855, 'f1-score': 0.1678857354496942, 'support': 114564}, 'weighted avg': {'precision': 0.36315237468898326, 'recall': 0.3306099647358682, 'f1-score': 0.1663062814248922, 'support': 114564}}
[[   77 37191    75]
 [   48 37738    37]
 [   64 39273    61]]
Evaluating performance on  val set...
136/136 - 5s - 5s/epoch - 38ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.121709
{'0': {'precision': 0.35802469135802467, 'recall': 0.0024871355060034307, 'f1-score': 0.00493995400732476, 'support': 11660}, '1': {'precision': 0.29020989115685536, 'recall': 0.9961351699534239, 'f1-score': 0.44947236630298687, 'support': 10091}, '2': {'precision': 0.2909090909090909, 'recall': 0.0012286899093841193, 'f1-score': 0.002447044429150417, 'support': 13022}, 'accuracy': 0.2903689644264228, 'macro avg': {'precision': 0.31304789114132364, 'recall': 0.3332836651229371, 'f1-score': 0.152286454913154, 'support': 34773}, 'weighted avg': {'precision': 0.31321122982534083, 'recall': 0.2903689644264228, 'f1-score': 0.1330081075732679, 'support': 34773}}
[[   29 11608    23]
 [   23 10052    16]
 [   29 12977    16]]
training model: results/CHTR/W6/deepVOL_L2/h500
Epoch 1/50
448/448 - 35s - loss: 3.3370 - accuracy500: 0.3541 - val_loss: 3.5812 - val_accuracy500: 0.2928 - 35s/epoch - 79ms/step
Epoch 2/50
448/448 - 32s - loss: 3.3141 - accuracy500: 0.3561 - val_loss: 3.5697 - val_accuracy500: 0.2890 - 32s/epoch - 70ms/step
Epoch 3/50
448/448 - 33s - loss: 3.3040 - accuracy500: 0.3585 - val_loss: 3.4414 - val_accuracy500: 0.2894 - 33s/epoch - 75ms/step
Epoch 4/50
448/448 - 33s - loss: 3.2975 - accuracy500: 0.3544 - val_loss: 3.4116 - val_accuracy500: 0.2893 - 33s/epoch - 73ms/step
Epoch 5/50
448/448 - 32s - loss: 3.2917 - accuracy500: 0.3602 - val_loss: 3.3946 - val_accuracy500: 0.2891 - 32s/epoch - 71ms/step
Epoch 6/50
448/448 - 33s - loss: 3.2899 - accuracy500: 0.3570 - val_loss: 3.3689 - val_accuracy500: 0.2890 - 33s/epoch - 75ms/step
Epoch 7/50
448/448 - 31s - loss: 3.2849 - accuracy500: 0.3608 - val_loss: 3.3942 - val_accuracy500: 0.2890 - 31s/epoch - 68ms/step
Epoch 8/50
448/448 - 33s - loss: 3.2823 - accuracy500: 0.3636 - val_loss: 3.4014 - val_accuracy500: 0.2885 - 33s/epoch - 74ms/step
Epoch 9/50
448/448 - 32s - loss: 3.2787 - accuracy500: 0.3662 - val_loss: 3.4005 - val_accuracy500: 0.2893 - 32s/epoch - 70ms/step
Epoch 10/50
448/448 - 31s - loss: 3.2760 - accuracy500: 0.3677 - val_loss: 3.4140 - val_accuracy500: 0.2894 - 31s/epoch - 68ms/step
Epoch 11/50
448/448 - 31s - loss: 3.2747 - accuracy500: 0.3681 - val_loss: 3.4078 - val_accuracy500: 0.2892 - 31s/epoch - 69ms/step
Epoch 12/50
448/448 - 31s - loss: 3.2730 - accuracy500: 0.3705 - val_loss: 3.4167 - val_accuracy500: 0.2897 - 31s/epoch - 69ms/step
Epoch 13/50
448/448 - 32s - loss: 3.2721 - accuracy500: 0.3696 - val_loss: 3.4302 - val_accuracy500: 0.2896 - 32s/epoch - 71ms/step
Epoch 14/50
448/448 - 32s - loss: 3.2712 - accuracy500: 0.3703 - val_loss: 3.4300 - val_accuracy500: 0.2897 - 32s/epoch - 72ms/step
Epoch 15/50
448/448 - 34s - loss: 3.2687 - accuracy500: 0.3731 - val_loss: 3.4359 - val_accuracy500: 0.2893 - 34s/epoch - 75ms/step
Epoch 16/50
448/448 - 32s - loss: 3.2680 - accuracy500: 0.3737 - val_loss: 3.4252 - val_accuracy500: 0.2893 - 32s/epoch - 70ms/step
testing model: results/CHTR/W6/deepVOL_L2/h500
Evaluating performance on  test set...
1095/1095 - 36s - 36s/epoch - 33ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1394387
{'0': {'precision': 0.3921971252566735, 'recall': 0.0019162277401555054, 'f1-score': 0.003813821608993431, 'support': 99675}, '1': {'precision': 0.24730901533610433, 'recall': 0.9966354762317334, 'f1-score': 0.396282856585097, 'support': 69252}, '2': {'precision': 0.4386973180076628, 'recall': 0.0020600564941256902, 'f1-score': 0.004100855986533433, 'support': 111162}, 'accuracy': 0.2479176261831061, 'macro avg': {'precision': 0.3594011528668135, 'recall': 0.3335372534886716, 'f1-score': 0.13473251139354128, 'support': 280089}, 'weighted avg': {'precision': 0.3748285853938664, 'recall': 0.2479176261831061, 'f1-score': 0.10096570163870264, 'support': 280089}}
[[   191  99326    158]
 [    98  69019    135]
 [   198 110735    229]]
Evaluating performance on  train set...
448/448 - 16s - 16s/epoch - 36ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1117296
{'0': {'precision': 0.367816091954023, 'recall': 0.002637869920039568, 'f1-score': 0.005238173187100998, 'support': 36393}, '1': {'precision': 0.32978555522435166, 'recall': 0.9957381475500966, 'f1-score': 0.4954721777672403, 'support': 37777}, '2': {'precision': 0.3900414937759336, 'recall': 0.00232707827895232, 'f1-score': 0.004626553463762766, 'support': 40394}, 'accuracy': 0.32999895255053946, 'macro avg': {'precision': 0.36254771365143607, 'recall': 0.33356769858302954, 'f1-score': 0.16844563480603467, 'support': 114564}, 'weighted avg': {'precision': 0.36311211247667813, 'recall': 0.32999895255053946, 'f1-score': 0.16667513614160148, 'support': 114564}}
[[   96 36230    67]
 [   81 37616    80]
 [   84 40216    94]]
Evaluating performance on  val set...
136/136 - 5s - 5s/epoch - 39ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1234221
{'0': {'precision': 0.26229508196721313, 'recall': 0.0013875639580261904, 'f1-score': 0.0027605244996549345, 'support': 11531}, '1': {'precision': 0.2885931229609955, 'recall': 0.9957167048510808, 'f1-score': 0.44748858447488593, 'support': 10039}, '2': {'precision': 0.4, 'recall': 0.0022722108611679163, 'f1-score': 0.004518752824220515, 'support': 13203}, 'accuracy': 0.28878727748540534, 'macro avg': {'precision': 0.3169627349760696, 'recall': 0.33312549322342494, 'f1-score': 0.15158928726625379, 'support': 34773}, 'weighted avg': {'precision': 0.32217269006324933, 'recall': 0.28878727748540534, 'f1-score': 0.1318215454831934, 'support': 34773}}
[[   16 11492    23]
 [   21  9996    22]
 [   24 13149    30]]
training model: results/CHTR/W6/deepVOL_L2/h1000
Epoch 1/50
448/448 - 36s - loss: 3.3405 - accuracy1000: 0.3617 - val_loss: 3.5654 - val_accuracy1000: 0.3079 - 36s/epoch - 80ms/step
Epoch 2/50
448/448 - 32s - loss: 3.3117 - accuracy1000: 0.3646 - val_loss: 3.4377 - val_accuracy1000: 0.2961 - 32s/epoch - 72ms/step
Epoch 3/50
448/448 - 31s - loss: 3.3019 - accuracy1000: 0.3498 - val_loss: 3.3585 - val_accuracy1000: 0.3114 - 31s/epoch - 69ms/step
Epoch 4/50
448/448 - 34s - loss: 3.2911 - accuracy1000: 0.3487 - val_loss: 3.3440 - val_accuracy1000: 0.2995 - 34s/epoch - 75ms/step
Epoch 5/50
448/448 - 33s - loss: 3.2866 - accuracy1000: 0.3528 - val_loss: 3.3346 - val_accuracy1000: 0.2964 - 33s/epoch - 73ms/step
Epoch 6/50
448/448 - 33s - loss: 3.2834 - accuracy1000: 0.3573 - val_loss: 3.3476 - val_accuracy1000: 0.2953 - 33s/epoch - 74ms/step
Epoch 7/50
448/448 - 31s - loss: 3.2791 - accuracy1000: 0.3582 - val_loss: 3.3606 - val_accuracy1000: 0.2946 - 31s/epoch - 70ms/step
Epoch 8/50
448/448 - 31s - loss: 3.2782 - accuracy1000: 0.3596 - val_loss: 3.3564 - val_accuracy1000: 0.2949 - 31s/epoch - 68ms/step
Epoch 9/50
448/448 - 32s - loss: 3.2762 - accuracy1000: 0.3612 - val_loss: 3.3621 - val_accuracy1000: 0.2933 - 32s/epoch - 71ms/step
Epoch 10/50
448/448 - 30s - loss: 3.2743 - accuracy1000: 0.3638 - val_loss: 3.3625 - val_accuracy1000: 0.2945 - 30s/epoch - 67ms/step
Epoch 11/50
448/448 - 31s - loss: 3.2739 - accuracy1000: 0.3625 - val_loss: 3.3710 - val_accuracy1000: 0.2932 - 31s/epoch - 70ms/step
Epoch 12/50
448/448 - 32s - loss: 3.2716 - accuracy1000: 0.3654 - val_loss: 3.3719 - val_accuracy1000: 0.2936 - 32s/epoch - 70ms/step
Epoch 13/50
448/448 - 28s - loss: 3.2714 - accuracy1000: 0.3659 - val_loss: 3.3602 - val_accuracy1000: 0.2944 - 28s/epoch - 63ms/step
Epoch 14/50
448/448 - 32s - loss: 3.2717 - accuracy1000: 0.3644 - val_loss: 3.3679 - val_accuracy1000: 0.2936 - 32s/epoch - 72ms/step
Epoch 15/50
448/448 - 31s - loss: 3.2704 - accuracy1000: 0.3655 - val_loss: 3.3741 - val_accuracy1000: 0.2937 - 31s/epoch - 69ms/step
testing model: results/CHTR/W6/deepVOL_L2/h1000
Evaluating performance on  test set...
1095/1095 - 36s - 36s/epoch - 33ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1146941
{'0': {'precision': 0.26666666666666666, 'recall': 4.031851627860095e-05, 'f1-score': 8.062484252960444e-05, 'support': 99210}, '1': {'precision': 0.27181421963946867, 'recall': 0.9648358876537525, 'f1-score': 0.42413955626751176, 'support': 76015}, '2': {'precision': 0.3874146341463415, 'recall': 0.03786809581934696, 'f1-score': 0.06899247702277742, 'support': 104864}, 'accuracy': 0.27604440017280224, 'macro avg': {'precision': 0.3086318401508256, 'recall': 0.334248100663126, 'f1-score': 0.16440421937760627, 'support': 280089}, 'weighted avg': {'precision': 0.31327116059901017, 'recall': 0.27604440017280224, 'f1-score': 0.14096874304531345, 'support': 280089}}
[[     4  95594   3612]
 [     6  73342   2667]
 [     5 100888   3971]]
Evaluating performance on  train set...
448/448 - 16s - 16s/epoch - 37ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100523
{'0': {'precision': 0.5, 'recall': 8.617718028266115e-05, 'f1-score': 0.00017232465965879716, 'support': 34812}, '1': {'precision': 0.32817828894855233, 'recall': 0.9630546461178099, 'f1-score': 0.4895377392316175, 'support': 37569}, '2': {'precision': 0.3765661252900232, 'recall': 0.03847521513405874, 'f1-score': 0.06981696169315811, 'support': 42183}, 'accuracy': 0.33000768129604413, 'macro avg': {'precision': 0.4015814714128585, 'recall': 0.3338720128107171, 'f1-score': 0.18650900852814478, 'support': 114564}, 'weighted avg': {'precision': 0.39820553577578655, 'recall': 0.33000768129604413, 'f1-score': 0.18629352315166342, 'support': 114564}}
[[    3 33510  1299]
 [    0 36181  1388]
 [    3 40557  1623]]
Evaluating performance on  val set...
136/136 - 5s - 5s/epoch - 37ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.106134
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 11203}, '1': {'precision': 0.29343663994256314, 'recall': 0.9627048778094023, 'f1-score': 0.44977875598963707, 'support': 10189}, '2': {'precision': 0.4099702380952381, 'recall': 0.04117778940288469, 'f1-score': 0.07483870967741936, 'support': 13381}, 'accuracy': 0.29793230379892444, 'macro avg': {'precision': 0.23446895934593373, 'recall': 0.33462755573742897, 'f1-score': 0.1748724885556855, 'support': 34773}, 'weighted avg': {'precision': 0.24374191701398085, 'recall': 0.29793230379892444, 'f1-score': 0.16059047303862078, 'support': 34773}}
[[    0 10790   413]
 [    0  9809   380]
 [    1 12829   551]]
training model: results/CHTR/W6/deepVOL_L3/h10
Epoch 1/50
448/448 - 49s - loss: 3.3148 - accuracy10: 0.3568 - val_loss: 3.3239 - val_accuracy10: 0.3512 - 49s/epoch - 110ms/step
Epoch 2/50
448/448 - 44s - loss: 3.2968 - accuracy10: 0.3595 - val_loss: 3.3086 - val_accuracy10: 0.3461 - 44s/epoch - 97ms/step
Epoch 3/50
448/448 - 43s - loss: 3.2920 - accuracy10: 0.3617 - val_loss: 3.2912 - val_accuracy10: 0.3529 - 43s/epoch - 96ms/step
Epoch 4/50
448/448 - 45s - loss: 3.2833 - accuracy10: 0.3650 - val_loss: 3.2932 - val_accuracy10: 0.3476 - 45s/epoch - 100ms/step
Epoch 5/50
448/448 - 44s - loss: 3.2773 - accuracy10: 0.3688 - val_loss: 3.3012 - val_accuracy10: 0.3339 - 44s/epoch - 99ms/step
Epoch 6/50
448/448 - 43s - loss: 3.2690 - accuracy10: 0.3754 - val_loss: 3.2955 - val_accuracy10: 0.3482 - 43s/epoch - 95ms/step
Epoch 7/50
448/448 - 43s - loss: 3.2576 - accuracy10: 0.3825 - val_loss: 3.2767 - val_accuracy10: 0.3576 - 43s/epoch - 96ms/step
Epoch 8/50
448/448 - 42s - loss: 3.2500 - accuracy10: 0.3880 - val_loss: 3.2775 - val_accuracy10: 0.3621 - 42s/epoch - 95ms/step
Epoch 9/50
448/448 - 41s - loss: 3.2409 - accuracy10: 0.3940 - val_loss: 3.2702 - val_accuracy10: 0.3724 - 41s/epoch - 92ms/step
Epoch 10/50
448/448 - 40s - loss: 3.2348 - accuracy10: 0.3974 - val_loss: 3.2533 - val_accuracy10: 0.3797 - 40s/epoch - 89ms/step
Epoch 11/50
448/448 - 44s - loss: 3.2291 - accuracy10: 0.4005 - val_loss: 3.2576 - val_accuracy10: 0.3777 - 44s/epoch - 99ms/step
Epoch 12/50
448/448 - 44s - loss: 3.2244 - accuracy10: 0.4028 - val_loss: 3.2520 - val_accuracy10: 0.3813 - 44s/epoch - 98ms/step
Epoch 13/50
448/448 - 43s - loss: 3.2196 - accuracy10: 0.4065 - val_loss: 3.2470 - val_accuracy10: 0.3839 - 43s/epoch - 96ms/step
Epoch 14/50
448/448 - 43s - loss: 3.2155 - accuracy10: 0.4077 - val_loss: 3.2539 - val_accuracy10: 0.3791 - 43s/epoch - 95ms/step
Epoch 15/50
448/448 - 42s - loss: 3.2140 - accuracy10: 0.4070 - val_loss: 3.2503 - val_accuracy10: 0.3858 - 42s/epoch - 95ms/step
Epoch 16/50
448/448 - 44s - loss: 3.2084 - accuracy10: 0.4111 - val_loss: 3.2447 - val_accuracy10: 0.3855 - 44s/epoch - 98ms/step
Epoch 17/50
448/448 - 43s - loss: 3.2060 - accuracy10: 0.4101 - val_loss: 3.2478 - val_accuracy10: 0.3871 - 43s/epoch - 96ms/step
Epoch 18/50
448/448 - 45s - loss: 3.2018 - accuracy10: 0.4115 - val_loss: 3.2517 - val_accuracy10: 0.3846 - 45s/epoch - 100ms/step
Epoch 19/50
448/448 - 45s - loss: 3.1968 - accuracy10: 0.4144 - val_loss: 3.2458 - val_accuracy10: 0.3888 - 45s/epoch - 100ms/step
Epoch 20/50
448/448 - 47s - loss: 3.1940 - accuracy10: 0.4159 - val_loss: 3.2474 - val_accuracy10: 0.3914 - 47s/epoch - 104ms/step
Epoch 21/50
448/448 - 41s - loss: 3.1905 - accuracy10: 0.4181 - val_loss: 3.2484 - val_accuracy10: 0.3894 - 41s/epoch - 92ms/step
Epoch 22/50
448/448 - 45s - loss: 3.1883 - accuracy10: 0.4208 - val_loss: 3.2483 - val_accuracy10: 0.3892 - 45s/epoch - 99ms/step
Epoch 23/50
448/448 - 43s - loss: 3.1853 - accuracy10: 0.4200 - val_loss: 3.2440 - val_accuracy10: 0.3908 - 43s/epoch - 96ms/step
Epoch 24/50
448/448 - 43s - loss: 3.1831 - accuracy10: 0.4211 - val_loss: 3.2423 - val_accuracy10: 0.3914 - 43s/epoch - 96ms/step
Epoch 25/50
448/448 - 44s - loss: 3.1794 - accuracy10: 0.4233 - val_loss: 3.2488 - val_accuracy10: 0.3913 - 44s/epoch - 99ms/step
Epoch 26/50
448/448 - 43s - loss: 3.1771 - accuracy10: 0.4229 - val_loss: 3.2415 - val_accuracy10: 0.3963 - 43s/epoch - 95ms/step
Epoch 27/50
448/448 - 45s - loss: 3.1748 - accuracy10: 0.4241 - val_loss: 3.2401 - val_accuracy10: 0.3923 - 45s/epoch - 101ms/step
Epoch 28/50
448/448 - 44s - loss: 3.1731 - accuracy10: 0.4279 - val_loss: 3.2404 - val_accuracy10: 0.3934 - 44s/epoch - 99ms/step
Epoch 29/50
448/448 - 45s - loss: 3.1705 - accuracy10: 0.4266 - val_loss: 3.2445 - val_accuracy10: 0.3952 - 45s/epoch - 100ms/step
Epoch 30/50
448/448 - 44s - loss: 3.1691 - accuracy10: 0.4274 - val_loss: 3.2338 - val_accuracy10: 0.3923 - 44s/epoch - 98ms/step
Epoch 31/50
448/448 - 43s - loss: 3.1671 - accuracy10: 0.4273 - val_loss: 3.2338 - val_accuracy10: 0.3963 - 43s/epoch - 96ms/step
Epoch 32/50
448/448 - 44s - loss: 3.1640 - accuracy10: 0.4297 - val_loss: 3.2400 - val_accuracy10: 0.3929 - 44s/epoch - 97ms/step
Epoch 33/50
448/448 - 44s - loss: 3.1620 - accuracy10: 0.4301 - val_loss: 3.2378 - val_accuracy10: 0.3956 - 44s/epoch - 98ms/step
Epoch 34/50
448/448 - 44s - loss: 3.1610 - accuracy10: 0.4309 - val_loss: 3.2409 - val_accuracy10: 0.3948 - 44s/epoch - 97ms/step
Epoch 35/50
448/448 - 42s - loss: 3.1569 - accuracy10: 0.4309 - val_loss: 3.2442 - val_accuracy10: 0.3936 - 42s/epoch - 94ms/step
Epoch 36/50
448/448 - 42s - loss: 3.1533 - accuracy10: 0.4326 - val_loss: 3.2461 - val_accuracy10: 0.3942 - 42s/epoch - 93ms/step
Epoch 37/50
448/448 - 43s - loss: 3.1519 - accuracy10: 0.4315 - val_loss: 3.2527 - val_accuracy10: 0.3910 - 43s/epoch - 96ms/step
Epoch 38/50
448/448 - 43s - loss: 3.1494 - accuracy10: 0.4339 - val_loss: 3.2451 - val_accuracy10: 0.3939 - 43s/epoch - 95ms/step
Epoch 39/50
448/448 - 42s - loss: 3.1448 - accuracy10: 0.4351 - val_loss: 3.2491 - val_accuracy10: 0.3936 - 42s/epoch - 95ms/step
Epoch 40/50
448/448 - 43s - loss: 3.1428 - accuracy10: 0.4366 - val_loss: 3.2466 - val_accuracy10: 0.3924 - 43s/epoch - 96ms/step
testing model: results/CHTR/W6/deepVOL_L3/h10
Evaluating performance on  test set...
1095/1095 - 52s - 52s/epoch - 47ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0926291
{'0': {'precision': 0.43438658349154685, 'recall': 0.19142430278884462, 'f1-score': 0.2657420978402146, 'support': 100400}, '1': {'precision': 0.3025900760070588, 'recall': 0.5989218773635501, 'f1-score': 0.40205305257716256, 'support': 72719}, '2': {'precision': 0.4355409037003188, 'recall': 0.3742264186220436, 'f1-score': 0.4025623362714387, 'support': 106970}, 'accuracy': 0.367036906126267, 'macro avg': {'precision': 0.3908391877329748, 'recall': 0.3881908662581461, 'f1-score': 0.356785828896272, 'support': 280089}, 'weighted avg': {'precision': 0.40060934627397615, 'recall': 0.367036906126267, 'f1-score': 0.3533858725779021, 'support': 280089}}
[[19219 48436 32745]
 [10031 43553 19135]
 [14994 51945 40031]]
Evaluating performance on  train set...
448/448 - 21s - 21s/epoch - 48ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0653033
{'0': {'precision': 0.47914480587618047, 'recall': 0.18330531650651077, 'f1-score': 0.2651665003175755, 'support': 39857}, '1': {'precision': 0.3923051529065754, 'recall': 0.705755318000216, 'f1-score': 0.5042918041008428, 'support': 37044}, '2': {'precision': 0.4265471016710534, 'recall': 0.3700448716246714, 'f1-score': 0.39629213642890654, 'support': 37663}, 'accuracy': 0.41362906323103243, 'macro avg': {'precision': 0.43266568681793643, 'recall': 0.4197018353771327, 'f1-score': 0.38858348028244166, 'support': 114564}, 'weighted avg': {'precision': 0.4337738740120369, 'recall': 0.41362906323103243, 'f1-score': 0.38559475514639097, 'support': 114564}}
[[ 7306 21193 11358]
 [ 3521 26144  7379]
 [ 4421 19305 13937]]
Evaluating performance on  val set...
136/136 - 7s - 7s/epoch - 49ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0808918
{'0': {'precision': 0.45656824989302525, 'recall': 0.17303170355955566, 'f1-score': 0.2509554889163286, 'support': 12333}, '1': {'precision': 0.35797563653474146, 'recall': 0.6612903225806451, 'f1-score': 0.4645025609714732, 'support': 10354}, '2': {'precision': 0.4268137076193948, 'recall': 0.3874731093827569, 'f1-score': 0.40619307832422585, 'support': 12086}, 'accuracy': 0.39294855203750034, 'macro avg': {'precision': 0.41378586468238715, 'recall': 0.4072650451743192, 'f1-score': 0.3738837094040092, 'support': 34773}, 'weighted avg': {'precision': 0.4168695952865556, 'recall': 0.39294855203750034, 'f1-score': 0.3684969115615652, 'support': 34773}}
[[2134 6341 3858]
 [1076 6847 2431]
 [1464 5939 4683]]
training model: results/CHTR/W6/deepVOL_L3/h20
Epoch 1/50
448/448 - 52s - loss: 3.3183 - accuracy20: 0.3553 - val_loss: 3.3212 - val_accuracy20: 0.3456 - 52s/epoch - 115ms/step
Epoch 2/50
448/448 - 45s - loss: 3.2995 - accuracy20: 0.3596 - val_loss: 3.3004 - val_accuracy20: 0.3484 - 45s/epoch - 100ms/step
Epoch 3/50
448/448 - 44s - loss: 3.2962 - accuracy20: 0.3563 - val_loss: 3.3187 - val_accuracy20: 0.3152 - 44s/epoch - 98ms/step
Epoch 4/50
448/448 - 43s - loss: 3.2892 - accuracy20: 0.3585 - val_loss: 3.3337 - val_accuracy20: 0.3156 - 43s/epoch - 95ms/step
Epoch 5/50
448/448 - 42s - loss: 3.2817 - accuracy20: 0.3666 - val_loss: 3.3120 - val_accuracy20: 0.3209 - 42s/epoch - 95ms/step
Epoch 6/50
448/448 - 39s - loss: 3.2753 - accuracy20: 0.3728 - val_loss: 3.3178 - val_accuracy20: 0.3193 - 39s/epoch - 87ms/step
Epoch 7/50
448/448 - 43s - loss: 3.2699 - accuracy20: 0.3771 - val_loss: 3.3082 - val_accuracy20: 0.3327 - 43s/epoch - 97ms/step
Epoch 8/50
448/448 - 42s - loss: 3.2636 - accuracy20: 0.3820 - val_loss: 3.3060 - val_accuracy20: 0.3480 - 42s/epoch - 94ms/step
Epoch 9/50
448/448 - 41s - loss: 3.2585 - accuracy20: 0.3858 - val_loss: 3.2864 - val_accuracy20: 0.3587 - 41s/epoch - 91ms/step
Epoch 10/50
448/448 - 43s - loss: 3.2542 - accuracy20: 0.3876 - val_loss: 3.2840 - val_accuracy20: 0.3640 - 43s/epoch - 96ms/step
Epoch 11/50
448/448 - 44s - loss: 3.2465 - accuracy20: 0.3947 - val_loss: 3.2708 - val_accuracy20: 0.3719 - 44s/epoch - 98ms/step
Epoch 12/50
448/448 - 43s - loss: 3.2451 - accuracy20: 0.3967 - val_loss: 3.2707 - val_accuracy20: 0.3757 - 43s/epoch - 95ms/step
Epoch 13/50
448/448 - 43s - loss: 3.2421 - accuracy20: 0.3964 - val_loss: 3.2800 - val_accuracy20: 0.3635 - 43s/epoch - 97ms/step
Epoch 14/50
448/448 - 43s - loss: 3.2367 - accuracy20: 0.3992 - val_loss: 3.2673 - val_accuracy20: 0.3779 - 43s/epoch - 95ms/step
Epoch 15/50
448/448 - 44s - loss: 3.2332 - accuracy20: 0.3998 - val_loss: 3.2619 - val_accuracy20: 0.3791 - 44s/epoch - 99ms/step
Epoch 16/50
448/448 - 43s - loss: 3.2327 - accuracy20: 0.4008 - val_loss: 3.2602 - val_accuracy20: 0.3809 - 43s/epoch - 95ms/step
Epoch 17/50
448/448 - 41s - loss: 3.2284 - accuracy20: 0.4018 - val_loss: 3.2670 - val_accuracy20: 0.3770 - 41s/epoch - 91ms/step
Epoch 18/50
448/448 - 44s - loss: 3.2238 - accuracy20: 0.4045 - val_loss: 3.2605 - val_accuracy20: 0.3844 - 44s/epoch - 98ms/step
Epoch 19/50
448/448 - 43s - loss: 3.2229 - accuracy20: 0.4049 - val_loss: 3.2592 - val_accuracy20: 0.3811 - 43s/epoch - 96ms/step
Epoch 20/50
448/448 - 44s - loss: 3.2190 - accuracy20: 0.4076 - val_loss: 3.2480 - val_accuracy20: 0.3888 - 44s/epoch - 98ms/step
Epoch 21/50
448/448 - 44s - loss: 3.2186 - accuracy20: 0.4086 - val_loss: 3.2498 - val_accuracy20: 0.3848 - 44s/epoch - 98ms/step
Epoch 22/50
448/448 - 43s - loss: 3.2139 - accuracy20: 0.4088 - val_loss: 3.2525 - val_accuracy20: 0.3842 - 43s/epoch - 95ms/step
Epoch 23/50
448/448 - 42s - loss: 3.2130 - accuracy20: 0.4086 - val_loss: 3.2531 - val_accuracy20: 0.3860 - 42s/epoch - 94ms/step
Epoch 24/50
448/448 - 42s - loss: 3.2106 - accuracy20: 0.4087 - val_loss: 3.2595 - val_accuracy20: 0.3829 - 42s/epoch - 94ms/step
Epoch 25/50
448/448 - 44s - loss: 3.2062 - accuracy20: 0.4129 - val_loss: 3.2552 - val_accuracy20: 0.3845 - 44s/epoch - 98ms/step
Epoch 26/50
448/448 - 45s - loss: 3.2036 - accuracy20: 0.4146 - val_loss: 3.2675 - val_accuracy20: 0.3797 - 45s/epoch - 100ms/step
Epoch 27/50
448/448 - 43s - loss: 3.2004 - accuracy20: 0.4153 - val_loss: 3.2510 - val_accuracy20: 0.3886 - 43s/epoch - 97ms/step
Epoch 28/50
448/448 - 42s - loss: 3.1996 - accuracy20: 0.4152 - val_loss: 3.2670 - val_accuracy20: 0.3816 - 42s/epoch - 95ms/step
Epoch 29/50
448/448 - 43s - loss: 3.1973 - accuracy20: 0.4167 - val_loss: 3.2676 - val_accuracy20: 0.3830 - 43s/epoch - 95ms/step
Epoch 30/50
448/448 - 42s - loss: 3.1976 - accuracy20: 0.4155 - val_loss: 3.2694 - val_accuracy20: 0.3804 - 42s/epoch - 94ms/step
testing model: results/CHTR/W6/deepVOL_L3/h20
Evaluating performance on  test set...
1095/1095 - 50s - 50s/epoch - 46ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0878421
{'0': {'precision': 0.4385667416227375, 'recall': 0.23455767827921373, 'f1-score': 0.3056469016545062, 'support': 101442}, '1': {'precision': 0.30726394312133043, 'recall': 0.4407361197754211, 'f1-score': 0.3620917290133532, 'support': 73738}, '2': {'precision': 0.41473023170589507, 'recall': 0.47464945810178344, 'f1-score': 0.4426714079342149, 'support': 104909}, 'accuracy': 0.37876532102296057, 'macro avg': {'precision': 0.3868536388166543, 'recall': 0.38331441871880606, 'f1-score': 0.3701366795340248, 'support': 280089}, 'weighted avg': {'precision': 0.3950710307066973, 'recall': 0.37876532102296057, 'f1-score': 0.37183026697440313, 'support': 280089}}
[[23794 35769 41879]
 [12847 32499 28392]
 [17613 37501 49795]]
Evaluating performance on  train set...
448/448 - 24s - 24s/epoch - 52ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0775763
{'0': {'precision': 0.4493362019205541, 'recall': 0.21725231510846124, 'f1-score': 0.2928923245313997, 'support': 39415}, '1': {'precision': 0.3871103201423744, 'recall': 0.5204032258064516, 'f1-score': 0.44396793908885557, 'support': 37200}, '2': {'precision': 0.3901490175392325, 'recall': 0.4677593612479907, 'f1-score': 0.42544369480029237, 'support': 37949}, 'accuracy': 0.39866799343598336, 'macro avg': {'precision': 0.40886517986738696, 'recall': 0.4018049673876345, 'f1-score': 0.38743465280684924, 'support': 114564}, 'weighted avg': {'precision': 0.4095252904454392, 'recall': 0.39866799343598336, 'f1-score': 0.385855251907116, 'support': 114564}}
[[ 8563 15943 14909]
 [ 5003 19359 12838]
 [ 5491 14707 17751]]
Evaluating performance on  val set...
136/136 - 8s - 8s/epoch - 60ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0837438
{'0': {'precision': 0.4351365100898762, 'recall': 0.21055222778370394, 'f1-score': 0.2837867728378677, 'support': 12187}, '1': {'precision': 0.35744197600965294, 'recall': 0.4776629042966897, 'f1-score': 0.40889899317960376, 'support': 10543}, '2': {'precision': 0.3948062487319943, 'recall': 0.48476293282404714, 'f1-score': 0.43518449496831907, 'support': 12043}, 'accuracy': 0.386506772495902, 'macro avg': {'precision': 0.3957949116105078, 'recall': 0.39099268830148026, 'f1-score': 0.37595675366193015, 'support': 34773}, 'weighted avg': {'precision': 0.3976122582179996, 'recall': 0.386506772495902, 'f1-score': 0.3741540378618791, 'support': 34773}}
[[2566 4660 4961]
 [1519 5036 3988]
 [1812 4393 5838]]
training model: results/CHTR/W6/deepVOL_L3/h30
Epoch 1/50
448/448 - 49s - loss: 3.3251 - accuracy30: 0.3533 - val_loss: 3.3183 - val_accuracy30: 0.3355 - 49s/epoch - 110ms/step
Epoch 2/50
448/448 - 44s - loss: 3.3043 - accuracy30: 0.3495 - val_loss: 3.3272 - val_accuracy30: 0.3372 - 44s/epoch - 99ms/step
Epoch 3/50
448/448 - 43s - loss: 3.2955 - accuracy30: 0.3562 - val_loss: 3.3587 - val_accuracy30: 0.3100 - 43s/epoch - 96ms/step
Epoch 4/50
448/448 - 41s - loss: 3.2903 - accuracy30: 0.3592 - val_loss: 3.3653 - val_accuracy30: 0.3143 - 41s/epoch - 93ms/step
Epoch 5/50
448/448 - 45s - loss: 3.2853 - accuracy30: 0.3655 - val_loss: 3.3384 - val_accuracy30: 0.3124 - 45s/epoch - 100ms/step
Epoch 6/50
448/448 - 43s - loss: 3.2843 - accuracy30: 0.3675 - val_loss: 3.3416 - val_accuracy30: 0.3226 - 43s/epoch - 95ms/step
Epoch 7/50
448/448 - 42s - loss: 3.2799 - accuracy30: 0.3701 - val_loss: 3.3174 - val_accuracy30: 0.3321 - 42s/epoch - 94ms/step
Epoch 8/50
448/448 - 43s - loss: 3.2740 - accuracy30: 0.3752 - val_loss: 3.3334 - val_accuracy30: 0.3198 - 43s/epoch - 96ms/step
Epoch 9/50
448/448 - 44s - loss: 3.2722 - accuracy30: 0.3751 - val_loss: 3.3167 - val_accuracy30: 0.3401 - 44s/epoch - 99ms/step
Epoch 10/50
448/448 - 45s - loss: 3.2690 - accuracy30: 0.3784 - val_loss: 3.3230 - val_accuracy30: 0.3492 - 45s/epoch - 101ms/step
Epoch 11/50
448/448 - 43s - loss: 3.2647 - accuracy30: 0.3815 - val_loss: 3.3349 - val_accuracy30: 0.3303 - 43s/epoch - 97ms/step
Epoch 12/50
448/448 - 42s - loss: 3.2610 - accuracy30: 0.3835 - val_loss: 3.3328 - val_accuracy30: 0.3427 - 42s/epoch - 95ms/step
Epoch 13/50
448/448 - 43s - loss: 3.2575 - accuracy30: 0.3886 - val_loss: 3.3374 - val_accuracy30: 0.3419 - 43s/epoch - 96ms/step
Epoch 14/50
448/448 - 43s - loss: 3.2542 - accuracy30: 0.3914 - val_loss: 3.3262 - val_accuracy30: 0.3523 - 43s/epoch - 96ms/step
Epoch 15/50
448/448 - 42s - loss: 3.2514 - accuracy30: 0.3912 - val_loss: 3.3333 - val_accuracy30: 0.3492 - 42s/epoch - 93ms/step
Epoch 16/50
448/448 - 43s - loss: 3.2460 - accuracy30: 0.3936 - val_loss: 3.3375 - val_accuracy30: 0.3422 - 43s/epoch - 96ms/step
Epoch 17/50
448/448 - 44s - loss: 3.2455 - accuracy30: 0.3956 - val_loss: 3.3421 - val_accuracy30: 0.3507 - 44s/epoch - 98ms/step
Epoch 18/50
448/448 - 44s - loss: 3.2426 - accuracy30: 0.3971 - val_loss: 3.3259 - val_accuracy30: 0.3573 - 44s/epoch - 98ms/step
Epoch 19/50
448/448 - 43s - loss: 3.2412 - accuracy30: 0.3971 - val_loss: 3.3222 - val_accuracy30: 0.3582 - 43s/epoch - 97ms/step
testing model: results/CHTR/W6/deepVOL_L3/h30
Evaluating performance on  test set...
1095/1095 - 56s - 56s/epoch - 51ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1129243
{'0': {'precision': 0.4287497000239981, 'recall': 0.08849899444218785, 'f1-score': 0.14671440537388933, 'support': 100939}, '1': {'precision': 0.2796245740793957, 'recall': 0.7272157051153728, 'f1-score': 0.40393175761574185, 'support': 74931}, '2': {'precision': 0.41562859184244044, 'recall': 0.256757405079688, 'f1-score': 0.317423977319233, 'support': 104219}, 'accuracy': 0.3219797992780866, 'macro avg': {'precision': 0.37466762198194475, 'recall': 0.3574907015457496, 'f1-score': 0.28935671343628805, 'support': 280089}, 'weighted avg': {'precision': 0.3839726342137422, 'recall': 0.3219797992780866, 'f1-score': 0.27904639377545465, 'support': 280089}}
[[ 8933 69721 22285]
 [ 5102 54491 15338]
 [ 6800 70660 26759]]
Evaluating performance on  train set...
448/448 - 23s - 23s/epoch - 51ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1019021
{'0': {'precision': 0.4275277234181344, 'recall': 0.08481068350630193, 'f1-score': 0.14154284727021424, 'support': 38639}, '1': {'precision': 0.3415746694164746, 'recall': 0.7443163794015015, 'f1-score': 0.46825990786475746, 'support': 37828}, '2': {'precision': 0.3862029506722792, 'recall': 0.24805102763997164, 'f1-score': 0.30208100246140074, 'support': 38097}, 'accuracy': 0.35685730246848923, 'macro avg': {'precision': 0.38510178116896276, 'recall': 0.359059363515925, 'f1-score': 0.3039612525321242, 'support': 114564}, 'weighted avg': {'precision': 0.38540470053072096, 'recall': 0.35685730246848923, 'f1-score': 0.30280707570575255, 'support': 114564}}
[[ 3277 27634  7728]
 [ 2381 28156  7291]
 [ 2007 26640  9450]]
Evaluating performance on  val set...
136/136 - 7s - 7s/epoch - 53ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1073451
{'0': {'precision': 0.44409519533004044, 'recall': 0.08228637989849405, 'f1-score': 0.1388459918573635, 'support': 12019}, '1': {'precision': 0.3153487259241536, 'recall': 0.7439322671683913, 'f1-score': 0.4429383594253228, 'support': 10630}, '2': {'precision': 0.38612933458294285, 'recall': 0.23787528868360278, 'f1-score': 0.2943908538763844, 'support': 12124}, 'accuracy': 0.3387973427659391, 'macro avg': {'precision': 0.3818577519457123, 'recall': 0.35469797858349605, 'f1-score': 0.2920584017196902, 'support': 34773}, 'weighted avg': {'precision': 0.3845273390771319, 'recall': 0.3387973427659391, 'f1-score': 0.2860385773221211, 'support': 34773}}
[[ 989 8565 2465]
 [ 602 7908 2120]
 [ 636 8604 2884]]
training model: results/CHTR/W6/deepVOL_L3/h50
Epoch 1/50
448/448 - 51s - loss: 3.3234 - accuracy50: 0.3540 - val_loss: 3.3245 - val_accuracy50: 0.3322 - 51s/epoch - 115ms/step
Epoch 2/50
448/448 - 44s - loss: 3.3015 - accuracy50: 0.3605 - val_loss: 3.3912 - val_accuracy50: 0.3159 - 44s/epoch - 99ms/step
Epoch 3/50
448/448 - 44s - loss: 3.3009 - accuracy50: 0.3548 - val_loss: 3.3448 - val_accuracy50: 0.3219 - 44s/epoch - 97ms/step
Epoch 4/50
448/448 - 43s - loss: 3.2952 - accuracy50: 0.3557 - val_loss: 3.3620 - val_accuracy50: 0.3158 - 43s/epoch - 97ms/step
Epoch 5/50
448/448 - 44s - loss: 3.2916 - accuracy50: 0.3578 - val_loss: 3.3514 - val_accuracy50: 0.3192 - 44s/epoch - 98ms/step
Epoch 6/50
448/448 - 43s - loss: 3.2861 - accuracy50: 0.3611 - val_loss: 3.3273 - val_accuracy50: 0.3179 - 43s/epoch - 95ms/step
Epoch 7/50
448/448 - 46s - loss: 3.2859 - accuracy50: 0.3627 - val_loss: 3.3623 - val_accuracy50: 0.3206 - 46s/epoch - 102ms/step
Epoch 8/50
448/448 - 45s - loss: 3.2820 - accuracy50: 0.3682 - val_loss: 3.3705 - val_accuracy50: 0.3219 - 45s/epoch - 101ms/step
Epoch 9/50
448/448 - 45s - loss: 3.2790 - accuracy50: 0.3707 - val_loss: 3.3207 - val_accuracy50: 0.3208 - 45s/epoch - 100ms/step
Epoch 10/50
448/448 - 43s - loss: 3.2793 - accuracy50: 0.3696 - val_loss: 3.3063 - val_accuracy50: 0.3335 - 43s/epoch - 95ms/step
Epoch 11/50
448/448 - 44s - loss: 3.2748 - accuracy50: 0.3732 - val_loss: 3.3089 - val_accuracy50: 0.3310 - 44s/epoch - 99ms/step
Epoch 12/50
448/448 - 44s - loss: 3.2734 - accuracy50: 0.3767 - val_loss: 3.3173 - val_accuracy50: 0.3290 - 44s/epoch - 97ms/step
Epoch 13/50
448/448 - 46s - loss: 3.2722 - accuracy50: 0.3769 - val_loss: 3.3683 - val_accuracy50: 0.3274 - 46s/epoch - 103ms/step
Epoch 14/50
448/448 - 44s - loss: 3.2692 - accuracy50: 0.3778 - val_loss: 3.3108 - val_accuracy50: 0.3337 - 44s/epoch - 98ms/step
Epoch 15/50
448/448 - 45s - loss: 3.2671 - accuracy50: 0.3794 - val_loss: 3.3212 - val_accuracy50: 0.3343 - 45s/epoch - 101ms/step
Epoch 16/50
448/448 - 46s - loss: 3.2627 - accuracy50: 0.3825 - val_loss: 3.3276 - val_accuracy50: 0.3347 - 46s/epoch - 102ms/step
Epoch 17/50
448/448 - 45s - loss: 3.2621 - accuracy50: 0.3849 - val_loss: 3.3086 - val_accuracy50: 0.3350 - 45s/epoch - 100ms/step
Epoch 18/50
448/448 - 45s - loss: 3.2606 - accuracy50: 0.3844 - val_loss: 3.3159 - val_accuracy50: 0.3382 - 45s/epoch - 101ms/step
Epoch 19/50
448/448 - 44s - loss: 3.2584 - accuracy50: 0.3857 - val_loss: 3.3124 - val_accuracy50: 0.3364 - 44s/epoch - 98ms/step
Epoch 20/50
448/448 - 46s - loss: 3.2560 - accuracy50: 0.3877 - val_loss: 3.3144 - val_accuracy50: 0.3362 - 46s/epoch - 102ms/step
testing model: results/CHTR/W6/deepVOL_L3/h50
Evaluating performance on  test set...
1095/1095 - 52s - 52s/epoch - 48ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1102141
{'0': {'precision': 0.4011730445838973, 'recall': 0.09764887934907403, 'f1-score': 0.15706646540234132, 'support': 100165}, '1': {'precision': 0.2794039359040335, 'recall': 0.8261428477733325, 'f1-score': 0.4175808146608453, 'support': 76235}, '2': {'precision': 0.4264589384737259, 'recall': 0.12460338126512938, 'f1-score': 0.19285740941150128, 'support': 103689}, 'accuracy': 0.305909907208066, 'macro avg': {'precision': 0.36901197298721894, 'recall': 0.3494650361291787, 'f1-score': 0.2558348964915626, 'support': 280089}, 'weighted avg': {'precision': 0.37739060775607836, 'recall': 0.305909907208066, 'f1-score': 0.24122342482983702, 'support': 280089}}
[[ 9781 80137 10247]
 [ 6125 62981  7129]
 [ 8475 82294 12920]]
Evaluating performance on  train set...
448/448 - 22s - 22s/epoch - 48ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0971341
{'0': {'precision': 0.4163019693654267, 'recall': 0.09962036915826679, 'f1-score': 0.16076898700749973, 'support': 38195}, '1': {'precision': 0.3381027634220305, 'recall': 0.8334824953935246, 'f1-score': 0.4810622749578402, 'support': 37990}, '2': {'precision': 0.4007815154604145, 'recall': 0.12293181166783919, 'f1-score': 0.1881517816195091, 'support': 38379}, 'accuracy': 0.3507820955972208, 'macro avg': {'precision': 0.38506208274929055, 'recall': 0.3520115587398769, 'f1-score': 0.276661014528283, 'support': 114564}, 'weighted avg': {'precision': 0.3851713582292052, 'recall': 0.3507820955972208, 'f1-score': 0.2761531066580683, 'support': 114564}}
[[ 3805 30855  3535]
 [ 2807 31664  3519]
 [ 2528 31133  4718]]
Evaluating performance on  val set...
136/136 - 7s - 7s/epoch - 50ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.102441
{'0': {'precision': 0.39724919093851135, 'recall': 0.08354602688446486, 'f1-score': 0.13805707858849992, 'support': 11754}, '1': {'precision': 0.319189338489159, 'recall': 0.8454503886602652, 'f1-score': 0.46342013584300357, 'support': 10935}, '2': {'precision': 0.38627509739286786, 'recall': 0.10666997682886462, 'f1-score': 0.16717463199533106, 'support': 12084}, 'accuracy': 0.33117648750467316, 'macro avg': {'precision': 0.3675712089401794, 'recall': 0.34522213079119823, 'f1-score': 0.2562172821422782, 'support': 34773}, 'weighted avg': {'precision': 0.368888237528129, 'recall': 0.33117648750467316, 'f1-score': 0.25049205821194753, 'support': 34773}}
[[  982  9647  1125]
 [  767  9245   923]
 [  723 10072  1289]]
training model: results/CHTR/W6/deepVOL_L3/h100
Epoch 1/50
448/448 - 48s - loss: 3.3255 - accuracy100: 0.3555 - val_loss: 3.4902 - val_accuracy100: 0.3135 - 48s/epoch - 107ms/step
Epoch 2/50
448/448 - 43s - loss: 3.3028 - accuracy100: 0.3528 - val_loss: 3.4404 - val_accuracy100: 0.3130 - 43s/epoch - 96ms/step
Epoch 3/50
448/448 - 46s - loss: 3.2942 - accuracy100: 0.3575 - val_loss: 3.3927 - val_accuracy100: 0.3131 - 46s/epoch - 102ms/step
Epoch 4/50
448/448 - 43s - loss: 3.2938 - accuracy100: 0.3558 - val_loss: 3.3802 - val_accuracy100: 0.3128 - 43s/epoch - 95ms/step
Epoch 5/50
448/448 - 43s - loss: 3.2910 - accuracy100: 0.3605 - val_loss: 3.3811 - val_accuracy100: 0.3128 - 43s/epoch - 95ms/step
Epoch 6/50
448/448 - 44s - loss: 3.2892 - accuracy100: 0.3621 - val_loss: 3.3729 - val_accuracy100: 0.3133 - 44s/epoch - 98ms/step
Epoch 7/50
448/448 - 43s - loss: 3.2882 - accuracy100: 0.3610 - val_loss: 3.3618 - val_accuracy100: 0.3137 - 43s/epoch - 96ms/step
Epoch 8/50
448/448 - 44s - loss: 3.2865 - accuracy100: 0.3633 - val_loss: 3.3579 - val_accuracy100: 0.3141 - 44s/epoch - 97ms/step
Epoch 9/50
448/448 - 45s - loss: 3.2837 - accuracy100: 0.3679 - val_loss: 3.3530 - val_accuracy100: 0.3146 - 45s/epoch - 101ms/step
Epoch 10/50
448/448 - 42s - loss: 3.2831 - accuracy100: 0.3677 - val_loss: 3.3520 - val_accuracy100: 0.3139 - 42s/epoch - 95ms/step
Epoch 11/50
448/448 - 42s - loss: 3.2807 - accuracy100: 0.3693 - val_loss: 3.3806 - val_accuracy100: 0.3131 - 42s/epoch - 94ms/step
Epoch 12/50
448/448 - 43s - loss: 3.2792 - accuracy100: 0.3697 - val_loss: 3.3566 - val_accuracy100: 0.3162 - 43s/epoch - 96ms/step
Epoch 13/50
448/448 - 42s - loss: 3.2778 - accuracy100: 0.3720 - val_loss: 3.3672 - val_accuracy100: 0.3149 - 42s/epoch - 95ms/step
Epoch 14/50
448/448 - 41s - loss: 3.2763 - accuracy100: 0.3736 - val_loss: 3.3603 - val_accuracy100: 0.3160 - 41s/epoch - 91ms/step
Epoch 15/50
448/448 - 45s - loss: 3.2737 - accuracy100: 0.3752 - val_loss: 3.3973 - val_accuracy100: 0.3150 - 45s/epoch - 100ms/step
Epoch 16/50
448/448 - 41s - loss: 3.2726 - accuracy100: 0.3751 - val_loss: 3.4038 - val_accuracy100: 0.3166 - 41s/epoch - 91ms/step
Epoch 17/50
448/448 - 40s - loss: 3.2703 - accuracy100: 0.3773 - val_loss: 3.3771 - val_accuracy100: 0.3178 - 40s/epoch - 88ms/step
Epoch 18/50
448/448 - 41s - loss: 3.2696 - accuracy100: 0.3783 - val_loss: 3.4465 - val_accuracy100: 0.3150 - 41s/epoch - 92ms/step
Epoch 19/50
448/448 - 43s - loss: 3.2675 - accuracy100: 0.3791 - val_loss: 3.3978 - val_accuracy100: 0.3160 - 43s/epoch - 97ms/step
Epoch 20/50
448/448 - 45s - loss: 3.2666 - accuracy100: 0.3785 - val_loss: 3.4050 - val_accuracy100: 0.3158 - 45s/epoch - 101ms/step
testing model: results/CHTR/W6/deepVOL_L3/h100
Evaluating performance on  test set...
1095/1095 - 51s - 51s/epoch - 47ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1330092
{'0': {'precision': 0.3769633507853403, 'recall': 0.006548100242522231, 'f1-score': 0.012872595079410801, 'support': 98960}, '1': {'precision': 0.2719188485462173, 'recall': 0.9871082929646988, 'f1-score': 0.42638215104921284, 'support': 76173}, '2': {'precision': 0.46378378378378377, 'recall': 0.008174854224627463, 'f1-score': 0.016066513117240604, 'support': 104956}, 'accuracy': 0.2738308180614019, 'macro avg': {'precision': 0.37088866103844714, 'recall': 0.3339437491439495, 'f1-score': 0.15177375308195476, 'support': 280089}, 'weighted avg': {'precision': 0.3809291277231134, 'recall': 0.2738308180614019, 'f1-score': 0.12652748430557176, 'support': 280089}}
[[   648  97789    523]
 [   513  75191    469]
 [   558 103540    858]]
Evaluating performance on  train set...
448/448 - 21s - 21s/epoch - 47ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1112828
{'0': {'precision': 0.451338199513382, 'recall': 0.009719420502475701, 'f1-score': 0.01902905649732003, 'support': 38171}, '1': {'precision': 0.331011931064958, 'recall': 0.9887017580909139, 'f1-score': 0.4959743630488903, 'support': 37882}, '2': {'precision': 0.3918918918918919, 'recall': 0.006024252810885202, 'f1-score': 0.011866097230391531, 'support': 38511}, 'accuracy': 0.33218986767221814, 'macro avg': {'precision': 0.3914140074900773, 'recall': 0.3348151438014249, 'f1-score': 0.17562317225886728, 'support': 114564}, 'weighted avg': {'precision': 0.39156779647076473, 'recall': 0.33218986767221814, 'f1-score': 0.17432905805503365, 'support': 114564}}
[[  371 37632   168]
 [  236 37454   192]
 [  215 38064   232]]
Evaluating performance on  val set...
136/136 - 7s - 7s/epoch - 51ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.11839
{'0': {'precision': 0.4016393442622951, 'recall': 0.008400480027430138, 'f1-score': 0.016456759026028545, 'support': 11666}, '1': {'precision': 0.31272547422320496, 'recall': 0.9885956037892026, 'f1-score': 0.4751464250193392, 'support': 10873}, '2': {'precision': 0.42038216560509556, 'recall': 0.005394801373222168, 'f1-score': 0.010652893228956501, 'support': 12234}, 'accuracy': 0.3138354470422454, 'macro avg': {'precision': 0.3782489946968652, 'recall': 0.33413029506328495, 'f1-score': 0.16741869242477472, 'support': 34773}, 'weighted avg': {'precision': 0.38043148665359855, 'recall': 0.3138354470422454, 'f1-score': 0.15784025323659095, 'support': 34773}}
[[   98 11526    42]
 [   75 10749    49]
 [   71 12097    66]]
training model: results/CHTR/W6/deepVOL_L3/h200
Epoch 1/50
448/448 - 46s - loss: 3.3232 - accuracy200: 0.3560 - val_loss: 3.5214 - val_accuracy200: 0.2952 - 46s/epoch - 103ms/step
Epoch 2/50
448/448 - 44s - loss: 3.3039 - accuracy200: 0.3501 - val_loss: 3.4456 - val_accuracy200: 0.2949 - 44s/epoch - 98ms/step
Epoch 3/50
448/448 - 42s - loss: 3.2952 - accuracy200: 0.3554 - val_loss: 3.4234 - val_accuracy200: 0.2950 - 42s/epoch - 95ms/step
Epoch 4/50
448/448 - 42s - loss: 3.2939 - accuracy200: 0.3534 - val_loss: 3.3943 - val_accuracy200: 0.2950 - 42s/epoch - 94ms/step
Epoch 5/50
448/448 - 43s - loss: 3.2919 - accuracy200: 0.3558 - val_loss: 3.3686 - val_accuracy200: 0.2950 - 43s/epoch - 95ms/step
Epoch 6/50
448/448 - 42s - loss: 3.2921 - accuracy200: 0.3563 - val_loss: 3.3714 - val_accuracy200: 0.2953 - 42s/epoch - 94ms/step
Epoch 7/50
448/448 - 45s - loss: 3.2914 - accuracy200: 0.3563 - val_loss: 3.3802 - val_accuracy200: 0.2951 - 45s/epoch - 100ms/step
Epoch 8/50
448/448 - 43s - loss: 3.2911 - accuracy200: 0.3558 - val_loss: 3.3772 - val_accuracy200: 0.2949 - 43s/epoch - 96ms/step
Epoch 9/50
448/448 - 42s - loss: 3.2904 - accuracy200: 0.3569 - val_loss: 3.3583 - val_accuracy200: 0.2951 - 42s/epoch - 93ms/step
Epoch 10/50
448/448 - 41s - loss: 3.2892 - accuracy200: 0.3571 - val_loss: 3.3523 - val_accuracy200: 0.2951 - 41s/epoch - 92ms/step
Epoch 11/50
448/448 - 41s - loss: 3.2891 - accuracy200: 0.3581 - val_loss: 3.3483 - val_accuracy200: 0.2952 - 41s/epoch - 92ms/step
Epoch 12/50
448/448 - 43s - loss: 3.2887 - accuracy200: 0.3586 - val_loss: 3.3501 - val_accuracy200: 0.2949 - 43s/epoch - 95ms/step
Epoch 13/50
448/448 - 42s - loss: 3.2872 - accuracy200: 0.3608 - val_loss: 3.3484 - val_accuracy200: 0.2946 - 42s/epoch - 95ms/step
Epoch 14/50
448/448 - 44s - loss: 3.2864 - accuracy200: 0.3615 - val_loss: 3.3436 - val_accuracy200: 0.2946 - 44s/epoch - 98ms/step
Epoch 15/50
448/448 - 43s - loss: 3.2847 - accuracy200: 0.3638 - val_loss: 3.3404 - val_accuracy200: 0.2949 - 43s/epoch - 96ms/step
Epoch 16/50
448/448 - 43s - loss: 3.2840 - accuracy200: 0.3645 - val_loss: 3.3572 - val_accuracy200: 0.2950 - 43s/epoch - 96ms/step
Epoch 17/50
448/448 - 41s - loss: 3.2839 - accuracy200: 0.3632 - val_loss: 3.3484 - val_accuracy200: 0.2950 - 41s/epoch - 92ms/step
Epoch 18/50
448/448 - 41s - loss: 3.2822 - accuracy200: 0.3655 - val_loss: 3.3533 - val_accuracy200: 0.2956 - 41s/epoch - 90ms/step
Epoch 19/50
448/448 - 42s - loss: 3.2807 - accuracy200: 0.3673 - val_loss: 3.3504 - val_accuracy200: 0.2953 - 42s/epoch - 93ms/step
Epoch 20/50
448/448 - 42s - loss: 3.2786 - accuracy200: 0.3704 - val_loss: 3.3575 - val_accuracy200: 0.2951 - 42s/epoch - 94ms/step
Epoch 21/50
448/448 - 43s - loss: 3.2798 - accuracy200: 0.3679 - val_loss: 3.3399 - val_accuracy200: 0.2971 - 43s/epoch - 95ms/step
Epoch 22/50
448/448 - 43s - loss: 3.2780 - accuracy200: 0.3683 - val_loss: 3.3433 - val_accuracy200: 0.2966 - 43s/epoch - 95ms/step
Epoch 23/50
448/448 - 43s - loss: 3.2759 - accuracy200: 0.3713 - val_loss: 3.3431 - val_accuracy200: 0.2949 - 43s/epoch - 96ms/step
Epoch 24/50
448/448 - 40s - loss: 3.2747 - accuracy200: 0.3738 - val_loss: 3.3514 - val_accuracy200: 0.2947 - 40s/epoch - 90ms/step
Epoch 25/50
448/448 - 41s - loss: 3.2727 - accuracy200: 0.3747 - val_loss: 3.3584 - val_accuracy200: 0.2961 - 41s/epoch - 92ms/step
Epoch 26/50
448/448 - 42s - loss: 3.2711 - accuracy200: 0.3777 - val_loss: 3.3576 - val_accuracy200: 0.2955 - 42s/epoch - 94ms/step
Epoch 27/50
448/448 - 41s - loss: 3.2694 - accuracy200: 0.3781 - val_loss: 3.3610 - val_accuracy200: 0.2963 - 41s/epoch - 92ms/step
Epoch 28/50
448/448 - 42s - loss: 3.2650 - accuracy200: 0.3812 - val_loss: 3.3664 - val_accuracy200: 0.2976 - 42s/epoch - 93ms/step
Epoch 29/50
448/448 - 42s - loss: 3.2645 - accuracy200: 0.3804 - val_loss: 3.3790 - val_accuracy200: 0.2966 - 42s/epoch - 94ms/step
Epoch 30/50
448/448 - 43s - loss: 3.2634 - accuracy200: 0.3804 - val_loss: 3.3641 - val_accuracy200: 0.2984 - 43s/epoch - 96ms/step
Epoch 31/50
448/448 - 41s - loss: 3.2609 - accuracy200: 0.3829 - val_loss: 3.3704 - val_accuracy200: 0.2992 - 41s/epoch - 91ms/step
testing model: results/CHTR/W6/deepVOL_L3/h200
Evaluating performance on  test set...
1095/1095 - 55s - 55s/epoch - 50ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.121045
{'0': {'precision': 0.3546031746031746, 'recall': 0.011326188134373003, 'f1-score': 0.021951243478004537, 'support': 98621}, '1': {'precision': 0.26030384020256014, 'recall': 0.9590959927984942, 'f1-score': 0.40947417457636986, 'support': 73318}, '2': {'precision': 0.4047373841400618, 'recall': 0.025436893203883496, 'f1-score': 0.04786553803057061, 'support': 108150}, 'accuracy': 0.2648693808039587, 'macro avg': {'precision': 0.33988146631526545, 'recall': 0.33195302471225024, 'f1-score': 0.159763652028315, 'support': 280089}, 'weighted avg': {'precision': 0.34927692531037874, 'recall': 0.2648693808039587, 'f1-score': 0.13339809507920977, 'support': 280089}}
[[  1117  95459   2045]
 [   998  70319   2001]
 [  1035 104364   2751]]
Evaluating performance on  train set...
448/448 - 24s - 24s/epoch - 54ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1023922
{'0': {'precision': 0.420916720464816, 'recall': 0.01722634679912283, 'f1-score': 0.03309812680846744, 'support': 37849}, '1': {'precision': 0.33079641206849686, 'recall': 0.963807713629524, 'f1-score': 0.4925430519861585, 'support': 37881}, '2': {'precision': 0.39773156899810963, 'recall': 0.02708966369676057, 'f1-score': 0.05072446298126763, 'support': 38834}, 'accuracy': 0.33356028071645544, 'macro avg': {'precision': 0.3831482338438075, 'recall': 0.33604124137513575, 'f1-score': 0.19212188059196453, 'support': 114564}, 'weighted avg': {'precision': 0.38325899574833405, 'recall': 0.33356028071645544, 'f1-score': 0.190990085448098, 'support': 114564}}
[[  652 36506   691]
 [  469 36510   902]
 [  428 37354  1052]]
Evaluating performance on  val set...
136/136 - 7s - 7s/epoch - 52ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1144781
{'0': {'precision': 0.31932773109243695, 'recall': 0.009775338706911336, 'f1-score': 0.01896996422331309, 'support': 11662}, '1': {'precision': 0.29460309921035444, 'recall': 0.9679118306837023, 'f1-score': 0.4517171533262022, 'support': 10253}, '2': {'precision': 0.33287671232876714, 'recall': 0.0188987400839944, 'f1-score': 0.035766853105681486, 'support': 12858}, 'accuracy': 0.29566042619273575, 'macro avg': {'precision': 0.3156025142105195, 'recall': 0.3321953031582027, 'f1-score': 0.16881799021839894, 'support': 34773}, 'weighted avg': {'precision': 0.31704754675544394, 'recall': 0.29566042619273575, 'f1-score': 0.15277870454256695, 'support': 34773}}
[[  114 11273   275]
 [  117  9924   212]
 [  126 12489   243]]
training model: results/CHTR/W6/deepVOL_L3/h300
Epoch 1/50
448/448 - 49s - loss: 3.3191 - accuracy300: 0.3620 - val_loss: 3.4003 - val_accuracy300: 0.3070 - 49s/epoch - 109ms/step
Epoch 2/50
448/448 - 43s - loss: 3.3040 - accuracy300: 0.3519 - val_loss: 3.4923 - val_accuracy300: 0.2902 - 43s/epoch - 95ms/step
Epoch 3/50
448/448 - 43s - loss: 3.2948 - accuracy300: 0.3531 - val_loss: 3.4157 - val_accuracy300: 0.2902 - 43s/epoch - 96ms/step
Epoch 4/50
448/448 - 41s - loss: 3.2934 - accuracy300: 0.3532 - val_loss: 3.3775 - val_accuracy300: 0.2902 - 41s/epoch - 92ms/step
Epoch 5/50
448/448 - 41s - loss: 3.2915 - accuracy300: 0.3557 - val_loss: 3.3875 - val_accuracy300: 0.2901 - 41s/epoch - 92ms/step
Epoch 6/50
448/448 - 41s - loss: 3.2917 - accuracy300: 0.3543 - val_loss: 3.4197 - val_accuracy300: 0.2903 - 41s/epoch - 92ms/step
Epoch 7/50
448/448 - 40s - loss: 3.2912 - accuracy300: 0.3557 - val_loss: 3.3805 - val_accuracy300: 0.2902 - 40s/epoch - 90ms/step
Epoch 8/50
448/448 - 40s - loss: 3.2894 - accuracy300: 0.3589 - val_loss: 3.3616 - val_accuracy300: 0.2901 - 40s/epoch - 90ms/step
Epoch 9/50
448/448 - 43s - loss: 3.2893 - accuracy300: 0.3558 - val_loss: 3.3585 - val_accuracy300: 0.2901 - 43s/epoch - 96ms/step
Epoch 10/50
448/448 - 43s - loss: 3.2887 - accuracy300: 0.3595 - val_loss: 3.3498 - val_accuracy300: 0.2902 - 43s/epoch - 95ms/step
Epoch 11/50
448/448 - 42s - loss: 3.2881 - accuracy300: 0.3591 - val_loss: 3.3598 - val_accuracy300: 0.2902 - 42s/epoch - 93ms/step
Epoch 12/50
448/448 - 41s - loss: 3.2883 - accuracy300: 0.3604 - val_loss: 3.3442 - val_accuracy300: 0.2903 - 41s/epoch - 93ms/step
Epoch 13/50
448/448 - 43s - loss: 3.2871 - accuracy300: 0.3603 - val_loss: 3.3580 - val_accuracy300: 0.2902 - 43s/epoch - 96ms/step
Epoch 14/50
448/448 - 43s - loss: 3.2857 - accuracy300: 0.3626 - val_loss: 3.3633 - val_accuracy300: 0.2905 - 43s/epoch - 95ms/step
Epoch 15/50
448/448 - 42s - loss: 3.2839 - accuracy300: 0.3636 - val_loss: 3.3828 - val_accuracy300: 0.2902 - 42s/epoch - 93ms/step
Epoch 16/50
448/448 - 44s - loss: 3.2822 - accuracy300: 0.3673 - val_loss: 3.3825 - val_accuracy300: 0.2901 - 44s/epoch - 98ms/step
Epoch 17/50
448/448 - 44s - loss: 3.2799 - accuracy300: 0.3666 - val_loss: 3.3976 - val_accuracy300: 0.2906 - 44s/epoch - 98ms/step
Epoch 18/50
448/448 - 42s - loss: 3.2792 - accuracy300: 0.3708 - val_loss: 3.3813 - val_accuracy300: 0.2910 - 42s/epoch - 95ms/step
Epoch 19/50
448/448 - 40s - loss: 3.2781 - accuracy300: 0.3715 - val_loss: 3.3939 - val_accuracy300: 0.2915 - 40s/epoch - 90ms/step
Epoch 20/50
448/448 - 41s - loss: 3.2771 - accuracy300: 0.3715 - val_loss: 3.3935 - val_accuracy300: 0.2908 - 41s/epoch - 92ms/step
Epoch 21/50
448/448 - 42s - loss: 3.2753 - accuracy300: 0.3723 - val_loss: 3.3956 - val_accuracy300: 0.2910 - 42s/epoch - 93ms/step
Epoch 22/50
448/448 - 41s - loss: 3.2724 - accuracy300: 0.3759 - val_loss: 3.3926 - val_accuracy300: 0.2919 - 41s/epoch - 91ms/step
testing model: results/CHTR/W6/deepVOL_L3/h300
Evaluating performance on  test set...
1095/1095 - 50s - 50s/epoch - 46ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1268902
{'0': {'precision': 0.39436619718309857, 'recall': 0.00028186879007821857, 'f1-score': 0.0005633349428617413, 'support': 99337}, '1': {'precision': 0.25530630038305413, 'recall': 0.9993006895201332, 'f1-score': 0.4067054688278237, 'support': 71499}, '2': {'precision': 0.46296296296296297, 'recall': 0.0006864800051257174, 'f1-score': 0.00137092720376548, 'support': 109253}, 'accuracy': 0.2554616568305074, 'macro avg': {'precision': 0.3708784868430386, 'recall': 0.333423012771779, 'f1-score': 0.13621324365815032, 'support': 280089}, 'weighted avg': {'precision': 0.38562525730484964, 'recall': 0.2554616568305074, 'f1-score': 0.10455523861605638, 'support': 280089}}
[[    28  99258     51]
 [    14  71449     36]
 [    29 109149     75]]
Evaluating performance on  train set...
448/448 - 20s - 20s/epoch - 45ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1069735
{'0': {'precision': 0.34146341463414637, 'recall': 0.00037490292692070803, 'f1-score': 0.000748983522362508, 'support': 37343}, '1': {'precision': 0.33013501114169613, 'recall': 0.9988366866721308, 'f1-score': 0.4962497865465197, 'support': 37823}, '2': {'precision': 0.4090909090909091, 'recall': 0.0009137519671049292, 'f1-score': 0.0018234310895000761, 'support': 39398}, 'accuracy': 0.33019971369714746, 'macro avg': {'precision': 0.3602297782889172, 'recall': 0.3333751138553855, 'f1-score': 0.1662740670527941, 'support': 114564}, 'weighted avg': {'precision': 0.3609801373508165, 'recall': 0.33019971369714746, 'f1-score': 0.16470675348528963, 'support': 114564}}
[[   14 37307    22]
 [   14 37779    30]
 [   13 39349    36]]
Evaluating performance on  val set...
136/136 - 7s - 7s/epoch - 49ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.11616
{'0': {'precision': 0.4, 'recall': 0.00017152658662092623, 'f1-score': 0.0003429061294470638, 'support': 11660}, '1': {'precision': 0.2903021582733813, 'recall': 0.9997027053810326, 'f1-score': 0.4499453625030664, 'support': 10091}, '2': {'precision': 0.3888888888888889, 'recall': 0.0005375518353555521, 'f1-score': 0.0010736196319018404, 'support': 13022}, 'accuracy': 0.2903689644264228, 'macro avg': {'precision': 0.35973034905409, 'recall': 0.33347059460100303, 'f1-score': 0.15045396275480508, 'support': 34773}, 'weighted avg': {'precision': 0.36400512438523575, 'recall': 0.2903689644264228, 'f1-score': 0.13108956987704312, 'support': 34773}}
[[    2 11650     8]
 [    0 10088     3]
 [    3 13012     7]]
training model: results/CHTR/W6/deepVOL_L3/h500
Epoch 1/50
448/448 - 49s - loss: 3.3338 - accuracy500: 0.3583 - val_loss: 3.6845 - val_accuracy500: 0.2888 - 49s/epoch - 110ms/step
Epoch 2/50
448/448 - 43s - loss: 3.3041 - accuracy500: 0.3495 - val_loss: 3.3744 - val_accuracy500: 0.2885 - 43s/epoch - 95ms/step
Epoch 3/50
448/448 - 43s - loss: 3.2966 - accuracy500: 0.3500 - val_loss: 3.3647 - val_accuracy500: 0.2887 - 43s/epoch - 96ms/step
Epoch 4/50
448/448 - 43s - loss: 3.2955 - accuracy500: 0.3508 - val_loss: 3.3598 - val_accuracy500: 0.2887 - 43s/epoch - 95ms/step
Epoch 5/50
448/448 - 41s - loss: 3.2946 - accuracy500: 0.3514 - val_loss: 3.3692 - val_accuracy500: 0.2887 - 41s/epoch - 93ms/step
Epoch 6/50
448/448 - 42s - loss: 3.2935 - accuracy500: 0.3535 - val_loss: 3.3613 - val_accuracy500: 0.2887 - 42s/epoch - 95ms/step
Epoch 7/50
448/448 - 42s - loss: 3.2940 - accuracy500: 0.3524 - val_loss: 3.3557 - val_accuracy500: 0.2888 - 42s/epoch - 94ms/step
Epoch 8/50
448/448 - 43s - loss: 3.2921 - accuracy500: 0.3534 - val_loss: 3.3684 - val_accuracy500: 0.2887 - 43s/epoch - 96ms/step
Epoch 9/50
448/448 - 43s - loss: 3.2929 - accuracy500: 0.3547 - val_loss: 3.3555 - val_accuracy500: 0.2887 - 43s/epoch - 95ms/step
Epoch 10/50
448/448 - 42s - loss: 3.2919 - accuracy500: 0.3535 - val_loss: 3.3660 - val_accuracy500: 0.2887 - 42s/epoch - 94ms/step
Epoch 11/50
448/448 - 41s - loss: 3.2910 - accuracy500: 0.3535 - val_loss: 3.3676 - val_accuracy500: 0.2887 - 41s/epoch - 90ms/step
Epoch 12/50
448/448 - 41s - loss: 3.2900 - accuracy500: 0.3552 - val_loss: 3.3876 - val_accuracy500: 0.2887 - 41s/epoch - 90ms/step
Epoch 13/50
448/448 - 43s - loss: 3.2891 - accuracy500: 0.3546 - val_loss: 3.3802 - val_accuracy500: 0.2887 - 43s/epoch - 96ms/step
Epoch 14/50
448/448 - 43s - loss: 3.2880 - accuracy500: 0.3557 - val_loss: 3.3714 - val_accuracy500: 0.2886 - 43s/epoch - 95ms/step
Epoch 15/50
448/448 - 42s - loss: 3.2869 - accuracy500: 0.3582 - val_loss: 3.3678 - val_accuracy500: 0.2888 - 42s/epoch - 95ms/step
Epoch 16/50
448/448 - 42s - loss: 3.2859 - accuracy500: 0.3577 - val_loss: 3.3668 - val_accuracy500: 0.2887 - 42s/epoch - 93ms/step
Epoch 17/50
448/448 - 43s - loss: 3.2846 - accuracy500: 0.3590 - val_loss: 3.3722 - val_accuracy500: 0.2884 - 43s/epoch - 96ms/step
Epoch 18/50
448/448 - 43s - loss: 3.2830 - accuracy500: 0.3605 - val_loss: 3.3904 - val_accuracy500: 0.2887 - 43s/epoch - 95ms/step
Epoch 19/50
448/448 - 43s - loss: 3.2822 - accuracy500: 0.3605 - val_loss: 3.3754 - val_accuracy500: 0.2882 - 43s/epoch - 95ms/step
testing model: results/CHTR/W6/deepVOL_L3/h500
Evaluating performance on  test set...
1095/1095 - 50s - 50s/epoch - 45ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1325693
{'0': {'precision': 0.3142857142857143, 'recall': 0.00011035866566340607, 'f1-score': 0.00022063985558118545, 'support': 99675}, '1': {'precision': 0.247235832750025, 'recall': 0.9996678796280252, 'f1-score': 0.39642791699115854, 'support': 69252}, '2': {'precision': 0.40476190476190477, 'recall': 0.00015292995807919971, 'f1-score': 0.00030574439768353654, 'support': 111162}, 'accuracy': 0.24726783272459826, 'macro avg': {'precision': 0.322094483932548, 'recall': 0.33331038941725594, 'f1-score': 0.13231810041480777, 'support': 280089}, 'weighted avg': {'precision': 0.33361591250701084, 'recall': 0.24726783272459826, 'f1-score': 0.09821665807586896, 'support': 280089}}
[[    11  99652     12]
 [    10  69229     13]
 [    14 111131     17]]
Evaluating performance on  train set...
448/448 - 20s - 20s/epoch - 45ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1081057
{'0': {'precision': 0.3333333333333333, 'recall': 0.00019234468166955183, 'f1-score': 0.00038446751249519417, 'support': 36393}, '1': {'precision': 0.3297652205041342, 'recall': 0.9997882309341662, 'f1-score': 0.49594905127700084, 'support': 37777}, '2': {'precision': 0.5, 'recall': 0.00012378075951874042, 'f1-score': 0.00024750024750024756, 'support': 40394}, 'accuracy': 0.329780733912922, 'macro avg': {'precision': 0.3876995179458225, 'recall': 0.3333681187917848, 'f1-score': 0.16552700634566545, 'support': 114564}, 'weighted avg': {'precision': 0.39092158736588, 'recall': 0.329780733912922, 'f1-score': 0.16374652387548466, 'support': 114564}}
[[    7 36384     2]
 [    5 37769     3]
 [    9 40380     5]]
Evaluating performance on  val set...
136/136 - 6s - 6s/epoch - 47ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1190615
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 11531}, '1': {'precision': 0.2887054560096638, 'recall': 0.9999003884849088, 'f1-score': 0.44804499196572045, 'support': 10039}, '2': {'precision': 0.6666666666666666, 'recall': 0.0001514807240778611, 'f1-score': 0.00030289262456459186, 'support': 13203}, 'accuracy': 0.2887297615966411, 'macro avg': {'precision': 0.31845737422544346, 'recall': 0.3333506230696622, 'f1-score': 0.14944929486342834, 'support': 34773}, 'weighted avg': {'precision': 0.3364769813614302, 'recall': 0.2887297615966411, 'f1-score': 0.12946604450769258, 'support': 34773}}
[[    0 11531     0]
 [    0 10038     1]
 [    1 13200     2]]
training model: results/CHTR/W6/deepVOL_L3/h1000
Epoch 1/50
448/448 - 46s - loss: 3.3325 - accuracy1000: 0.3485 - val_loss: 3.3498 - val_accuracy1000: 0.3209 - 46s/epoch - 102ms/step
Epoch 2/50
448/448 - 38s - loss: 3.2988 - accuracy1000: 0.3426 - val_loss: 3.3278 - val_accuracy1000: 0.3332 - 38s/epoch - 86ms/step
Epoch 3/50
448/448 - 40s - loss: 3.2950 - accuracy1000: 0.3445 - val_loss: 3.3237 - val_accuracy1000: 0.3442 - 40s/epoch - 89ms/step
Epoch 4/50
448/448 - 42s - loss: 3.2945 - accuracy1000: 0.3461 - val_loss: 3.3219 - val_accuracy1000: 0.3376 - 42s/epoch - 94ms/step
Epoch 5/50
448/448 - 43s - loss: 3.2942 - accuracy1000: 0.3481 - val_loss: 3.3235 - val_accuracy1000: 0.3320 - 43s/epoch - 96ms/step
Epoch 6/50
448/448 - 43s - loss: 3.2938 - accuracy1000: 0.3493 - val_loss: 3.3231 - val_accuracy1000: 0.3320 - 43s/epoch - 96ms/step
Epoch 7/50
448/448 - 42s - loss: 3.2934 - accuracy1000: 0.3489 - val_loss: 3.3236 - val_accuracy1000: 0.3341 - 42s/epoch - 95ms/step
Epoch 8/50
448/448 - 44s - loss: 3.2929 - accuracy1000: 0.3494 - val_loss: 3.3245 - val_accuracy1000: 0.3300 - 44s/epoch - 98ms/step
Epoch 9/50
448/448 - 44s - loss: 3.2929 - accuracy1000: 0.3494 - val_loss: 3.3290 - val_accuracy1000: 0.3182 - 44s/epoch - 97ms/step
Epoch 10/50
448/448 - 44s - loss: 3.2919 - accuracy1000: 0.3502 - val_loss: 3.3325 - val_accuracy1000: 0.3096 - 44s/epoch - 98ms/step
Epoch 11/50
448/448 - 41s - loss: 3.2908 - accuracy1000: 0.3522 - val_loss: 3.3294 - val_accuracy1000: 0.3182 - 41s/epoch - 92ms/step
Epoch 12/50
448/448 - 42s - loss: 3.2901 - accuracy1000: 0.3530 - val_loss: 3.3260 - val_accuracy1000: 0.3289 - 42s/epoch - 94ms/step
Epoch 13/50
448/448 - 43s - loss: 3.2884 - accuracy1000: 0.3543 - val_loss: 3.3277 - val_accuracy1000: 0.3403 - 43s/epoch - 96ms/step
Epoch 14/50
448/448 - 42s - loss: 3.2879 - accuracy1000: 0.3563 - val_loss: 3.3343 - val_accuracy1000: 0.3234 - 42s/epoch - 94ms/step
testing model: results/CHTR/W6/deepVOL_L3/h1000
Evaluating performance on  test set...
1095/1095 - 48s - 48s/epoch - 44ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1096303
{'0': {'precision': 0.6666666666666666, 'recall': 4.031851627860095e-05, 'f1-score': 8.063215610385422e-05, 'support': 99210}, '1': {'precision': 0.28166932272834505, 'recall': 0.7696244162336381, 'f1-score': 0.4124053631095884, 'support': 76015}, '2': {'precision': 0.4054875521538504, 'recall': 0.2798863289594141, 'f1-score': 0.33117813660110806, 'support': 104864}, 'accuracy': 0.3136752960666074, 'macro avg': {'precision': 0.45127451384962064, 'recall': 0.3498503545697769, 'f1-score': 0.24788804395560013, 'support': 280089}, 'weighted avg': {'precision': 0.4643957464814988, 'recall': 0.3136752960666074, 'f1-score': 0.23594520780723635, 'support': 280089}}
[[    4 73686 25520]
 [    0 58503 17512]
 [    2 75512 29350]]
Evaluating performance on  train set...
448/448 - 24s - 24s/epoch - 53ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0979115
{'0': {'precision': 1.0, 'recall': 2.872572676088705e-05, 'f1-score': 5.7449803234423925e-05, 'support': 34812}, '1': {'precision': 0.3340179104477612, 'recall': 0.7446032633288083, 'f1-score': 0.4611643683182354, 'support': 37569}, '2': {'precision': 0.38211144646740014, 'recall': 0.27911717990659746, 'f1-score': 0.32259301879555047, 'support': 42183}, 'accuracy': 0.3469589050661639, 'macro avg': {'precision': 0.5720431189717204, 'recall': 0.3412497229873889, 'f1-score': 0.2612716123056734, 'support': 114564}, 'weighted avg': {'precision': 0.5540948816726571, 'recall': 0.3469589050661639, 'f1-score': 0.2700274554637642, 'support': 114564}}
[[    1 25367  9444]
 [    0 27974  9595]
 [    0 30409 11774]]
Evaluating performance on  val set...
136/136 - 7s - 7s/epoch - 53ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1015227
{'0': {'precision': 0.5, 'recall': 8.926180487369455e-05, 'f1-score': 0.000178491744756805, 'support': 11203}, '1': {'precision': 0.3011500612575584, 'recall': 0.7478653449798802, 'f1-score': 0.42939253916375525, 'support': 10189}, '2': {'precision': 0.433248838191804, 'recall': 0.3065540692026007, 'f1-score': 0.3590529126001138, 'support': 13381}, 'accuracy': 0.3371293819917752, 'macro avg': {'precision': 0.41146629981645416, 'recall': 0.3515028919957848, 'f1-score': 0.2628746478362086, 'support': 34773}, 'weighted avg': {'precision': 0.4160475276219421, 'recall': 0.3371293819917752, 'f1-score': 0.2640430002604933, 'support': 34773}}
[[   1 8405 2797]
 [   0 7620 2569]
 [   1 9278 4102]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        15 (peak)  15.53 (ave)

============================================
