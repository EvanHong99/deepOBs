This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/AAPL_orderbooks/AAPL_orderbooks_2019-09-04.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-08-27.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-08-14.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-08-15.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-08-23.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-08-19.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-08-21.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-08-16.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-09-06.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-08-20.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-08-22.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-08-13.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-08-29.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-08-28.csv
training model: results/AAPL/W6/deepLOB_L1/h10
Epoch 1/50
5452/5452 - 94s - loss: 3.0299 - accuracy10: 0.4811 - val_loss: 3.2739 - val_accuracy10: 0.4231 - 94s/epoch - 17ms/step
Epoch 2/50
5452/5452 - 86s - loss: 2.9899 - accuracy10: 0.4936 - val_loss: 3.2555 - val_accuracy10: 0.4296 - 86s/epoch - 16ms/step
Epoch 3/50
5452/5452 - 87s - loss: 2.9693 - accuracy10: 0.5004 - val_loss: 3.2137 - val_accuracy10: 0.4341 - 87s/epoch - 16ms/step
Epoch 4/50
5452/5452 - 86s - loss: 2.9562 - accuracy10: 0.5043 - val_loss: 3.2435 - val_accuracy10: 0.4313 - 86s/epoch - 16ms/step
Epoch 5/50
5452/5452 - 87s - loss: 2.9462 - accuracy10: 0.5070 - val_loss: 3.2376 - val_accuracy10: 0.4294 - 87s/epoch - 16ms/step
Epoch 6/50
5452/5452 - 85s - loss: 2.9374 - accuracy10: 0.5096 - val_loss: 3.2431 - val_accuracy10: 0.4280 - 85s/epoch - 16ms/step
Epoch 7/50
5452/5452 - 87s - loss: 2.9319 - accuracy10: 0.5111 - val_loss: 3.2640 - val_accuracy10: 0.4237 - 87s/epoch - 16ms/step
Epoch 8/50
5452/5452 - 85s - loss: 2.9267 - accuracy10: 0.5126 - val_loss: 3.2784 - val_accuracy10: 0.4273 - 85s/epoch - 16ms/step
Epoch 9/50
5452/5452 - 87s - loss: 2.9218 - accuracy10: 0.5138 - val_loss: 3.3231 - val_accuracy10: 0.4276 - 87s/epoch - 16ms/step
Epoch 10/50
5452/5452 - 86s - loss: 2.9173 - accuracy10: 0.5152 - val_loss: 3.3375 - val_accuracy10: 0.4273 - 86s/epoch - 16ms/step
Epoch 11/50
5452/5452 - 86s - loss: 2.9135 - accuracy10: 0.5162 - val_loss: 3.3561 - val_accuracy10: 0.4252 - 86s/epoch - 16ms/step
Epoch 12/50
5452/5452 - 89s - loss: 2.9098 - accuracy10: 0.5174 - val_loss: 3.3546 - val_accuracy10: 0.4277 - 89s/epoch - 16ms/step
Epoch 13/50
5452/5452 - 88s - loss: 2.9068 - accuracy10: 0.5180 - val_loss: 3.3730 - val_accuracy10: 0.4273 - 88s/epoch - 16ms/step
testing model: results/AAPL/W6/deepLOB_L1/h10
Evaluating performance on  test set...
29350/29350 - 166s - 166s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1374061
{'0': {'precision': 0.48562887401513977, 'recall': 0.2265588965986422, 'f1-score': 0.30897340952229474, 'support': 2469455}, '1': {'precision': 0.3511989269611427, 'recall': 0.851319476437808, 'f1-score': 0.49726055880890957, 'support': 2535248}, '2': {'precision': 0.5724050046339203, 'recall': 0.049238629872591436, 'f1-score': 0.09067715519282248, 'support': 2508701}, 'accuracy': 0.3781652098037055, 'macro avg': {'precision': 0.4697442685367343, 'recall': 0.3757056676363473, 'f1-score': 0.29897037450800895, 'support': 7513404}, 'weighted avg': {'precision': 0.46924244134769816, 'recall': 0.3781652098037055, 'f1-score': 0.2996187398042801, 'support': 7513404}}
[[ 559477 1868121   41857]
 [ 326524 2158306   50418]
 [ 266066 2119110  123525]]
Evaluating performance on  train set...
5452/5452 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1200823
{'0': {'precision': 0.5384615384615384, 'recall': 0.14959655355111046, 'f1-score': 0.23414299260125274, 'support': 460532}, '1': {'precision': 0.3547442443714091, 'recall': 0.9102010602928527, 'f1-score': 0.5105178637669928, 'support': 475529}, '2': {'precision': 0.5643096649022543, 'recall': 0.05824593939235635, 'f1-score': 0.1055929665195439, 'support': 459414}, 'accuracy': 0.378709758326018, 'macro avg': {'precision': 0.4858384825784006, 'recall': 0.37268118441210657, 'f1-score': 0.2834179409625965, 'support': 1395475}, 'weighted avg': {'precision': 0.48436676071148915, 'recall': 0.378709758326018, 'f1-score': 0.2860010226113002, 'support': 1395475}}
[[ 68894 380728  10910]
 [ 32952 432827   9750]
 [ 26100 406555  26759]]
Evaluating performance on  val set...
1969/1969 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.067462
{'0': {'precision': 0.5698236153241208, 'recall': 0.10165143498476832, 'f1-score': 0.1725258091399221, 'support': 149688}, '1': {'precision': 0.4216741030032618, 'recall': 0.9371205803060572, 'f1-score': 0.581632361327834, 'support': 206236}, '2': {'precision': 0.5432325886990802, 'recall': 0.06976555802320793, 'f1-score': 0.12365102534038427, 'support': 148139}, 'accuracy': 0.43411041873734035, 'macro avg': {'precision': 0.511576769008821, 'recall': 0.36951252443801114, 'f1-score': 0.2926030652693801, 'support': 504063}, 'weighted avg': {'precision': 0.501393814056796, 'recall': 0.43411041873734035, 'f1-score': 0.32554683488421693, 'support': 504063}}
[[ 15216 131012   3460]
 [  7738 193268   5230]
 [  3749 134055  10335]]
training model: results/AAPL/W6/deepLOB_L1/h20
Epoch 1/50
5452/5452 - 86s - loss: 3.1095 - accuracy20: 0.4545 - val_loss: 3.3127 - val_accuracy20: 0.3881 - 86s/epoch - 16ms/step
Epoch 2/50
5452/5452 - 86s - loss: 3.0772 - accuracy20: 0.4659 - val_loss: 3.3121 - val_accuracy20: 0.3984 - 86s/epoch - 16ms/step
Epoch 3/50
5452/5452 - 85s - loss: 3.0670 - accuracy20: 0.4699 - val_loss: 3.2642 - val_accuracy20: 0.4068 - 85s/epoch - 16ms/step
Epoch 4/50
5452/5452 - 84s - loss: 3.0555 - accuracy20: 0.4736 - val_loss: 3.2674 - val_accuracy20: 0.4040 - 84s/epoch - 15ms/step
Epoch 5/50
5452/5452 - 84s - loss: 3.0480 - accuracy20: 0.4766 - val_loss: 3.2629 - val_accuracy20: 0.4048 - 84s/epoch - 15ms/step
Epoch 6/50
5452/5452 - 86s - loss: 3.0415 - accuracy20: 0.4788 - val_loss: 3.2644 - val_accuracy20: 0.4098 - 86s/epoch - 16ms/step
Epoch 7/50
5452/5452 - 86s - loss: 3.0361 - accuracy20: 0.4802 - val_loss: 3.2697 - val_accuracy20: 0.4083 - 86s/epoch - 16ms/step
Epoch 8/50
5452/5452 - 88s - loss: 3.0317 - accuracy20: 0.4819 - val_loss: 3.2658 - val_accuracy20: 0.4098 - 88s/epoch - 16ms/step
Epoch 9/50
5452/5452 - 88s - loss: 3.0266 - accuracy20: 0.4837 - val_loss: 3.2910 - val_accuracy20: 0.4074 - 88s/epoch - 16ms/step
Epoch 10/50
5452/5452 - 86s - loss: 3.0219 - accuracy20: 0.4852 - val_loss: 3.3024 - val_accuracy20: 0.4049 - 86s/epoch - 16ms/step
Epoch 11/50
5452/5452 - 86s - loss: 3.0181 - accuracy20: 0.4863 - val_loss: 3.3303 - val_accuracy20: 0.4062 - 86s/epoch - 16ms/step
Epoch 12/50
5452/5452 - 85s - loss: 3.0156 - accuracy20: 0.4873 - val_loss: 3.3285 - val_accuracy20: 0.4068 - 85s/epoch - 16ms/step
Epoch 13/50
5452/5452 - 85s - loss: 3.0132 - accuracy20: 0.4877 - val_loss: 3.3147 - val_accuracy20: 0.4059 - 85s/epoch - 16ms/step
Epoch 14/50
5452/5452 - 85s - loss: 3.0108 - accuracy20: 0.4881 - val_loss: 3.3318 - val_accuracy20: 0.4046 - 85s/epoch - 16ms/step
Epoch 15/50
5452/5452 - 86s - loss: 3.0082 - accuracy20: 0.4892 - val_loss: 3.3502 - val_accuracy20: 0.4039 - 86s/epoch - 16ms/step
testing model: results/AAPL/W6/deepLOB_L1/h20
Evaluating performance on  test set...
29350/29350 - 204s - 204s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0927491
{'0': {'precision': 0.43794411518292115, 'recall': 0.09724526720722916, 'f1-score': 0.15915111137892599, 'support': 2322149}, '1': {'precision': 0.38904840938596524, 'recall': 0.9246223556087905, 'f1-score': 0.5476605955126669, 'support': 2896177}, '2': {'precision': 0.4922978960957399, 'recall': 0.02459132107928358, 'f1-score': 0.04684274783564245, 'support': 2295078}, 'accuracy': 0.39397947987356996, 'macro avg': {'precision': 0.43976347355487544, 'recall': 0.3488196479651011, 'f1-score': 0.2512181515757451, 'support': 7513404}, 'weighted avg': {'precision': 0.4356995331348801, 'recall': 0.39397947987356996, 'f1-score': 0.2746028796913731, 'support': 7513404}}
[[ 225818 2077432   18899]
 [ 179001 2677870   39306]
 [ 110813 2127826   56439]]
Evaluating performance on  train set...
5452/5452 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1118361
{'0': {'precision': 0.5440975507200673, 'recall': 0.0779487885581023, 'f1-score': 0.1363620111815946, 'support': 464818}, '1': {'precision': 0.3404151171143496, 'recall': 0.9407254010414322, 'f1-score': 0.4999250949130047, 'support': 466473}, '2': {'precision': 0.529169388472941, 'recall': 0.04537424814297778, 'f1-score': 0.0835816867928871, 'support': 464184}, 'accuracy': 0.35551837188054247, 'macro avg': {'precision': 0.47122735210245265, 'recall': 0.35468281258083745, 'f1-score': 0.2399562642958288, 'support': 1395475}, 'weighted avg': {'precision': 0.47104588736824804, 'recall': 0.35551837188054247, 'f1-score': 0.2403356260879127, 'support': 1395475}}
[[ 36232 419979   8607]
 [ 17517 438823  10133]
 [ 12842 430280  21062]]
Evaluating performance on  val set...
1969/1969 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0871103
{'0': {'precision': 0.5880357693493679, 'recall': 0.06134752229356736, 'f1-score': 0.11110399030534662, 'support': 155426}, '1': {'precision': 0.3942512214922662, 'recall': 0.9458362239523113, 'f1-score': 0.556526498166128, 'support': 194595}, '2': {'precision': 0.5001666587305367, 'recall': 0.06818919515456824, 'f1-score': 0.12001622458481633, 'support': 154042}, 'accuracy': 0.40489780047335355, 'macro avg': {'precision': 0.4941512165240569, 'recall': 0.3584576471334823, 'f1-score': 0.26254890435209693, 'support': 504063}, 'weighted avg': {'precision': 0.486371815382902, 'recall': 0.40489780047335355, 'f1-score': 0.28578424120661655, 'support': 504063}}
[[  9535 141550   4341]
 [  4384 184055   6156]
 [  2296 141242  10504]]
training model: results/AAPL/W6/deepLOB_L1/h30
Epoch 1/50
5452/5452 - 89s - loss: 3.1515 - accuracy30: 0.4370 - val_loss: 3.3132 - val_accuracy30: 0.3899 - 89s/epoch - 16ms/step
Epoch 2/50
5452/5452 - 85s - loss: 3.1282 - accuracy30: 0.4467 - val_loss: 3.3208 - val_accuracy30: 0.3848 - 85s/epoch - 16ms/step
Epoch 3/50
5452/5452 - 85s - loss: 3.1143 - accuracy30: 0.4529 - val_loss: 3.3361 - val_accuracy30: 0.3791 - 85s/epoch - 16ms/step
Epoch 4/50
5452/5452 - 85s - loss: 3.1066 - accuracy30: 0.4566 - val_loss: 3.3446 - val_accuracy30: 0.3768 - 85s/epoch - 16ms/step
Epoch 5/50
5452/5452 - 87s - loss: 3.0997 - accuracy30: 0.4591 - val_loss: 3.3427 - val_accuracy30: 0.3778 - 87s/epoch - 16ms/step
Epoch 6/50
5452/5452 - 86s - loss: 3.0948 - accuracy30: 0.4614 - val_loss: 3.3469 - val_accuracy30: 0.3654 - 86s/epoch - 16ms/step
Epoch 7/50
5452/5452 - 86s - loss: 3.0909 - accuracy30: 0.4629 - val_loss: 3.3721 - val_accuracy30: 0.3614 - 86s/epoch - 16ms/step
Epoch 8/50
5452/5452 - 84s - loss: 3.0879 - accuracy30: 0.4642 - val_loss: 3.3799 - val_accuracy30: 0.3537 - 84s/epoch - 15ms/step
Epoch 9/50
5452/5452 - 86s - loss: 3.0844 - accuracy30: 0.4653 - val_loss: 3.4114 - val_accuracy30: 0.3477 - 86s/epoch - 16ms/step
Epoch 10/50
5452/5452 - 86s - loss: 3.0816 - accuracy30: 0.4664 - val_loss: 3.4139 - val_accuracy30: 0.3463 - 86s/epoch - 16ms/step
Epoch 11/50
5452/5452 - 86s - loss: 3.0792 - accuracy30: 0.4674 - val_loss: 3.3963 - val_accuracy30: 0.3541 - 86s/epoch - 16ms/step
testing model: results/AAPL/W6/deepLOB_L1/h30
Evaluating performance on  test set...
29350/29350 - 203s - 203s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0814238
{'0': {'precision': 0.3564180448971704, 'recall': 0.20663435296626306, 'f1-score': 0.2616034044870206, 'support': 2213509}, '1': {'precision': 0.4178377858224218, 'recall': 0.7920202467516662, 'f1-score': 0.5470658165159206, 'support': 3113981}, '2': {'precision': 0.4085954198473282, 'recall': 0.061216955470343296, 'f1-score': 0.10648066733136681, 'support': 2185914}, 'accuracy': 0.4069444422261867, 'macro avg': {'precision': 0.3942837501889735, 'recall': 0.3532905183960908, 'f1-score': 0.30504996277810265, 'support': 7513404}, 'weighted avg': {'precision': 0.3970541082118749, 'recall': 0.4069444422261867, 'f1-score': 0.33478455705186366, 'support': 7513404}}
[[ 457387 1695077   61045]
 [ 515005 2466336  132640]
 [ 310896 1741203  133815]]
Evaluating performance on  train set...
5452/5452 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1177467
{'0': {'precision': 0.4493992655709651, 'recall': 0.13473053252186332, 'f1-score': 0.20730941158282873, 'support': 467793}, '1': {'precision': 0.33785542573205285, 'recall': 0.8474498644457034, 'f1-score': 0.48310850733811517, 'support': 460701}, '2': {'precision': 0.45348440447994864, 'recall': 0.09676410817570737, 'f1-score': 0.1594952570041915, 'support': 466981}, 'accuracy': 0.35732205879718376, 'macro avg': {'precision': 0.41357969859432214, 'recall': 0.3596481683810913, 'f1-score': 0.28330439197504514, 'support': 1395475}, 'weighted avg': {'precision': 0.4139413202084394, 'recall': 0.35732205879718376, 'f1-score': 0.2823610015391301, 'support': 1395475}}
[[ 63026 379865  24902]
 [ 40725 390421  29555]
 [ 36494 385300  45187]]
Evaluating performance on  val set...
1969/1969 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1051891
{'0': {'precision': 0.45444807455412134, 'recall': 0.10603400336159657, 'f1-score': 0.17194822301593335, 'support': 160043}, '1': {'precision': 0.37949685292475893, 'recall': 0.8464209244044713, 'f1-score': 0.5240385334177228, 'support': 186347}, '2': {'precision': 0.43278470360295124, 'recall': 0.14025229430530275, 'f1-score': 0.21185036164199836, 'support': 157673}, 'accuracy': 0.3904511936007999, 'macro avg': {'precision': 0.42224321036061047, 'recall': 0.3642357406904569, 'f1-score': 0.30261237269188485, 'support': 504063}, 'weighted avg': {'precision': 0.41996297252332226, 'recall': 0.3904511936007999, 'f1-score': 0.31459400930857895, 'support': 504063}}
[[ 16970 130182  12891]
 [ 12527 157728  16092]
 [  7845 127714  22114]]
training model: results/AAPL/W6/deepLOB_L1/h50
Epoch 1/50
5452/5452 - 88s - loss: 3.1283 - accuracy50: 0.4438 - val_loss: 3.3110 - val_accuracy50: 0.3790 - 88s/epoch - 16ms/step
Epoch 2/50
5452/5452 - 87s - loss: 3.1172 - accuracy50: 0.4503 - val_loss: 3.3003 - val_accuracy50: 0.3916 - 87s/epoch - 16ms/step
Epoch 3/50
5452/5452 - 86s - loss: 3.1042 - accuracy50: 0.4567 - val_loss: 3.3328 - val_accuracy50: 0.3692 - 86s/epoch - 16ms/step
Epoch 4/50
5452/5452 - 85s - loss: 3.0945 - accuracy50: 0.4604 - val_loss: 3.3815 - val_accuracy50: 0.3947 - 85s/epoch - 16ms/step
Epoch 5/50
5452/5452 - 87s - loss: 3.0877 - accuracy50: 0.4638 - val_loss: 3.3770 - val_accuracy50: 0.3950 - 87s/epoch - 16ms/step
Epoch 6/50
5452/5452 - 85s - loss: 3.0830 - accuracy50: 0.4665 - val_loss: 3.4203 - val_accuracy50: 0.3931 - 85s/epoch - 16ms/step
Epoch 7/50
5452/5452 - 86s - loss: 3.0788 - accuracy50: 0.4681 - val_loss: 3.4293 - val_accuracy50: 0.3873 - 86s/epoch - 16ms/step
Epoch 8/50
5452/5452 - 85s - loss: 3.0754 - accuracy50: 0.4696 - val_loss: 3.4570 - val_accuracy50: 0.3836 - 85s/epoch - 16ms/step
Epoch 9/50
5452/5452 - 86s - loss: 3.0725 - accuracy50: 0.4708 - val_loss: 3.4103 - val_accuracy50: 0.3883 - 86s/epoch - 16ms/step
Epoch 10/50
5452/5452 - 85s - loss: 3.0700 - accuracy50: 0.4717 - val_loss: 3.4102 - val_accuracy50: 0.3852 - 85s/epoch - 16ms/step
Epoch 11/50
5452/5452 - 86s - loss: 3.0683 - accuracy50: 0.4725 - val_loss: 3.4493 - val_accuracy50: 0.3787 - 86s/epoch - 16ms/step
Epoch 12/50
5452/5452 - 85s - loss: 3.0671 - accuracy50: 0.4727 - val_loss: 3.4339 - val_accuracy50: 0.3866 - 85s/epoch - 16ms/step
testing model: results/AAPL/W6/deepLOB_L1/h50
Evaluating performance on  test set...
29350/29350 - 194s - 194s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1000742
{'0': {'precision': 0.3093927606577959, 'recall': 0.012473544561060035, 'f1-score': 0.02398029445368806, 'support': 2212683}, '1': {'precision': 0.41391449660449237, 'recall': 0.9105261043854083, 'f1-score': 0.5691156762489035, 'support': 3112025}, '2': {'precision': 0.29385861023847354, 'recall': 0.07765537105198712, 'f1-score': 0.12284705590688823, 'support': 2188696}, 'accuracy': 0.40343152051986025, 'macro avg': {'precision': 0.33905528916692057, 'recall': 0.3335516733328185, 'f1-score': 0.23864767553649327, 'support': 7513404}, 'weighted avg': {'precision': 0.34816010531586955, 'recall': 0.40343152051986025, 'f1-score': 0.27857384776944594, 'support': 7513404}}
[[  27600 2017341  167742]
 [  37764 2833580  240681]
 [  23843 1994889  169964]]
Evaluating performance on  train set...
5452/5452 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1140742
{'0': {'precision': 0.4273318033952263, 'recall': 0.11796123131526859, 'f1-score': 0.18488622630376314, 'support': 468832}, '1': {'precision': 0.3570234529357352, 'recall': 0.7961968276464719, 'f1-score': 0.4929863711368512, 'support': 460037}, '2': {'precision': 0.37998842298578694, 'recall': 0.19555470782630313, 'f1-score': 0.25822052616461283, 'support': 466606}, 'accuracy': 0.3674956556011394, 'macro avg': {'precision': 0.38811455977224946, 'recall': 0.3699042555960146, 'f1-score': 0.3120310412017424, 'support': 1395475}, 'weighted avg': {'precision': 0.38832347434622166, 'recall': 0.3674956556011394, 'f1-score': 0.31097640394897424, 'support': 1395475}}
[[ 55304 329810  83718]
 [ 28591 366280  65166]
 [ 45522 329837  91247]]
Evaluating performance on  val set...
1969/1969 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1009986
{'0': {'precision': 0.4348701734629794, 'recall': 0.12242944501009018, 'f1-score': 0.19106746971902683, 'support': 164021}, '1': {'precision': 0.3941670415354626, 'recall': 0.7289067092580885, 'f1-score': 0.5116511732922253, 'support': 180318}, '2': {'precision': 0.36844643029348423, 'recall': 0.28704515288873306, 'f1-score': 0.32269144144144146, 'support': 159724}, 'accuracy': 0.39154629480838704, 'macro avg': {'precision': 0.39916121509730873, 'recall': 0.3794604357189706, 'f1-score': 0.34180336148423124, 'support': 504063}, 'weighted avg': {'precision': 0.39926158228110253, 'recall': 0.39154629480838704, 'f1-score': 0.3474576818954868, 'support': 504063}}
[[ 20081 102133  41807]
 [ 12102 131435  36781]
 [ 13994  99882  45848]]
training model: results/AAPL/W6/deepLOB_L1/h100
Epoch 1/50
5452/5452 - 89s - loss: 3.2175 - accuracy100: 0.4117 - val_loss: 3.3327 - val_accuracy100: 0.3716 - 89s/epoch - 16ms/step
Epoch 2/50
5452/5452 - 86s - loss: 3.2037 - accuracy100: 0.4184 - val_loss: 3.3561 - val_accuracy100: 0.3735 - 86s/epoch - 16ms/step
Epoch 3/50
5452/5452 - 87s - loss: 3.1962 - accuracy100: 0.4225 - val_loss: 3.3904 - val_accuracy100: 0.3739 - 87s/epoch - 16ms/step
Epoch 4/50
5452/5452 - 87s - loss: 3.1905 - accuracy100: 0.4256 - val_loss: 3.3763 - val_accuracy100: 0.3735 - 87s/epoch - 16ms/step
Epoch 5/50
5452/5452 - 86s - loss: 3.1863 - accuracy100: 0.4279 - val_loss: 3.3929 - val_accuracy100: 0.3687 - 86s/epoch - 16ms/step
Epoch 6/50
5452/5452 - 85s - loss: 3.1834 - accuracy100: 0.4297 - val_loss: 3.4757 - val_accuracy100: 0.3681 - 85s/epoch - 16ms/step
Epoch 7/50
5452/5452 - 86s - loss: 3.1807 - accuracy100: 0.4309 - val_loss: 3.4948 - val_accuracy100: 0.3669 - 86s/epoch - 16ms/step
Epoch 8/50
5452/5452 - 86s - loss: 3.1777 - accuracy100: 0.4324 - val_loss: 3.5205 - val_accuracy100: 0.3583 - 86s/epoch - 16ms/step
Epoch 9/50
5452/5452 - 85s - loss: 3.1754 - accuracy100: 0.4335 - val_loss: 3.4260 - val_accuracy100: 0.3672 - 85s/epoch - 16ms/step
Epoch 10/50
5452/5452 - 87s - loss: 3.1735 - accuracy100: 0.4349 - val_loss: 3.4721 - val_accuracy100: 0.3628 - 87s/epoch - 16ms/step
Epoch 11/50
5452/5452 - 85s - loss: 3.1719 - accuracy100: 0.4357 - val_loss: 3.4968 - val_accuracy100: 0.3612 - 85s/epoch - 16ms/step
testing model: results/AAPL/W6/deepLOB_L1/h100
Evaluating performance on  test set...
29350/29350 - 154s - 154s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0987097
{'0': {'precision': 0.2968099115805316, 'recall': 0.004895507250616814, 'f1-score': 0.009632144360062883, 'support': 2255946}, '1': {'precision': 0.40263342724391366, 'recall': 0.9930477836794458, 'f1-score': 0.5729592537758736, 'support': 3025510}, '2': {'precision': 0.2959949051797339, 'recall': 0.0018741476055893775, 'f1-score': 0.003724711497364297, 'support': 2231948}, 'accuracy': 0.4019087753034444, 'macro avg': {'precision': 0.33181274800139304, 'recall': 0.333272479511884, 'f1-score': 0.19543870321110027, 'support': 7513404}, 'weighted avg': {'precision': 0.33918099304619903, 'recall': 0.4019087753034444, 'f1-score': 0.23471876553012044, 'support': 7513404}}
[[  11044 2240785    4117]
 [  15202 3004476    5832]
 [  10963 2216802    4183]]
Evaluating performance on  train set...
5452/5452 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1331898
{'0': {'precision': 0.33808392715756136, 'recall': 0.0036413640191448765, 'f1-score': 0.007205124581581795, 'support': 469055}, '1': {'precision': 0.32915298156312106, 'recall': 0.9943922222560856, 'f1-score': 0.4945915921183418, 'support': 459362}, '2': {'precision': 0.3273205561818865, 'recall': 0.0018648647491317995, 'f1-score': 0.0037086002482335186, 'support': 467058}, 'accuracy': 0.3291818198104588, 'macro avg': {'precision': 0.331519154967523, 'recall': 0.3332994836747874, 'f1-score': 0.16850177231605237, 'support': 1395475}, 'weighted avg': {'precision': 0.33154159888130413, 'recall': 0.3291818198104588, 'f1-score': 0.1664725731840549, 'support': 1395475}}
[[  1708 466462    885]
 [  1671 456786    905]
 [  1673 464514    871]]
Evaluating performance on  val set...
1969/1969 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1121997
{'0': {'precision': 0.24569916188795765, 'recall': 0.003480162449234614, 'f1-score': 0.006863113537091001, 'support': 160050}, '1': {'precision': 0.37226708528475977, 'recall': 0.9883472436340439, 'f1-score': 0.5408279772112093, 'support': 188110}, '2': {'precision': 0.296421052631579, 'recall': 0.004515628307344951, 'f1-score': 0.008895740406120876, 'support': 155903}, 'accuracy': 0.37134048720100465, 'macro avg': {'precision': 0.3047957666014321, 'recall': 0.3321143447968745, 'f1-score': 0.1855289437181404, 'support': 504063}, 'weighted avg': {'precision': 0.308620635994915, 'recall': 0.37134048720100465, 'f1-score': 0.20676079127281208, 'support': 504063}}
[[   557 158849    644]
 [  1165 185918   1027]
 [   545 154654    704]]
training model: results/AAPL/W6/deepLOB_L1/h200
Epoch 1/50
5452/5452 - 87s - loss: 3.1726 - accuracy200: 0.4329 - val_loss: 3.3161 - val_accuracy200: 0.3735 - 87s/epoch - 16ms/step
Epoch 2/50
5452/5452 - 83s - loss: 3.1555 - accuracy200: 0.4438 - val_loss: 3.3973 - val_accuracy200: 0.3675 - 83s/epoch - 15ms/step
Epoch 3/50
5452/5452 - 83s - loss: 3.1475 - accuracy200: 0.4475 - val_loss: 3.3307 - val_accuracy200: 0.3831 - 83s/epoch - 15ms/step
Epoch 4/50
5452/5452 - 85s - loss: 3.1411 - accuracy200: 0.4504 - val_loss: 3.4073 - val_accuracy200: 0.3762 - 85s/epoch - 16ms/step
Epoch 5/50
5452/5452 - 84s - loss: 3.1383 - accuracy200: 0.4516 - val_loss: 3.4498 - val_accuracy200: 0.3763 - 84s/epoch - 15ms/step
Epoch 6/50
5452/5452 - 85s - loss: 3.1354 - accuracy200: 0.4529 - val_loss: 3.4819 - val_accuracy200: 0.3760 - 85s/epoch - 16ms/step
Epoch 7/50
5452/5452 - 84s - loss: 3.1320 - accuracy200: 0.4545 - val_loss: 3.5182 - val_accuracy200: 0.3763 - 84s/epoch - 15ms/step
Epoch 8/50
5452/5452 - 85s - loss: 3.1298 - accuracy200: 0.4551 - val_loss: 3.5159 - val_accuracy200: 0.3761 - 85s/epoch - 16ms/step
Epoch 9/50
5452/5452 - 83s - loss: 3.1277 - accuracy200: 0.4557 - val_loss: 3.5493 - val_accuracy200: 0.3755 - 83s/epoch - 15ms/step
Epoch 10/50
5452/5452 - 85s - loss: 3.1256 - accuracy200: 0.4571 - val_loss: 3.5258 - val_accuracy200: 0.3745 - 85s/epoch - 16ms/step
Epoch 11/50
5452/5452 - 83s - loss: 3.1240 - accuracy200: 0.4577 - val_loss: 3.4977 - val_accuracy200: 0.3676 - 83s/epoch - 15ms/step
testing model: results/AAPL/W6/deepLOB_L1/h200
Evaluating performance on  test set...
29350/29350 - 168s - 168s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0968491
{'0': {'precision': 0.29450074941117693, 'recall': 0.022374847264498125, 'f1-score': 0.04158988168533305, 'support': 2212976}, '1': {'precision': 0.4085903103272401, 'recall': 0.9737714638504856, 'f1-score': 0.5756432100983827, 'support': 3069405}, '2': {'precision': 0.2969159778242539, 'recall': 0.004008923260764232, 'f1-score': 0.007911032724114232, 'support': 2231023}, 'accuracy': 0.4055895303912847, 'macro avg': {'precision': 0.33333567918755697, 'recall': 0.33338507812524937, 'f1-score': 0.20838137483594332, 'support': 7513404}, 'weighted avg': {'precision': 0.34182623581699206, 'recall': 0.4055895303912847, 'f1-score': 0.24976285758968364, 'support': 7513404}}
[[  49515 2154711    8750]
 [  68077 2988899   12429]
 [  50540 2171539    8944]]
Evaluating performance on  train set...
5452/5452 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1280186
{'0': {'precision': 0.3191747572815534, 'recall': 0.0163759841801165, 'f1-score': 0.03115356415644996, 'support': 465743}, '1': {'precision': 0.33562064265317854, 'recall': 0.9599898441551176, 'f1-score': 0.49735998854034935, 'support': 464757}, '2': {'precision': 0.3747483122112993, 'recall': 0.034023334587881066, 'f1-score': 0.062382933417456966, 'support': 464975}, 'accuracy': 0.3365226894068328, 'macro avg': {'precision': 0.34318123738201045, 'recall': 0.3367963876410384, 'f1-score': 0.19696549537141875, 'support': 1395475}, 'weighted avg': {'precision': 0.34316920652007005, 'recall': 0.3365226894068328, 'f1-score': 0.19682731334545345, 'support': 1395475}}
[[  7627 441761  16355]
 [  8555 446162  10040]
 [  7714 441441  15820]]
Evaluating performance on  val set...
1969/1969 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1050932
{'0': {'precision': 0.27218334854477233, 'recall': 0.016840572981044945, 'f1-score': 0.03171864474881528, 'support': 159377}, '1': {'precision': 0.37685494148026427, 'recall': 0.9478170565846767, 'f1-score': 0.5392875246324996, 'support': 189698}, '2': {'precision': 0.32612001403672947, 'recall': 0.035976978862879705, 'f1-score': 0.06480480689887613, 'support': 154988}, 'accuracy': 0.3730863007203465, 'macro avg': {'precision': 0.32505276802058874, 'recall': 0.33354486947620043, 'f1-score': 0.211936992093397, 'support': 504063}, 'weighted avg': {'precision': 0.3281595414967335, 'recall': 0.3730863007203465, 'f1-score': 0.23290928852843962, 'support': 504063}}
[[  2684 150599   6094]
 [  4471 179799   5428]
 [  2706 146706   5576]]
training model: results/AAPL/W6/deepLOB_L1/h300
Epoch 1/50
5452/5452 - 85s - loss: 3.1937 - accuracy300: 0.4246 - val_loss: 3.3346 - val_accuracy300: 0.3591 - 85s/epoch - 16ms/step
Epoch 2/50
5452/5452 - 83s - loss: 3.1672 - accuracy300: 0.4394 - val_loss: 3.4529 - val_accuracy300: 0.3214 - 83s/epoch - 15ms/step
Epoch 3/50
5452/5452 - 85s - loss: 3.1557 - accuracy300: 0.4461 - val_loss: 3.4189 - val_accuracy300: 0.3503 - 85s/epoch - 16ms/step
Epoch 4/50
5452/5452 - 85s - loss: 3.1481 - accuracy300: 0.4494 - val_loss: 3.4465 - val_accuracy300: 0.3518 - 85s/epoch - 16ms/step
Epoch 5/50
5452/5452 - 85s - loss: 3.1437 - accuracy300: 0.4514 - val_loss: 3.5593 - val_accuracy300: 0.3513 - 85s/epoch - 16ms/step
Epoch 6/50
5452/5452 - 87s - loss: 3.1399 - accuracy300: 0.4529 - val_loss: 3.6304 - val_accuracy300: 0.3479 - 87s/epoch - 16ms/step
Epoch 7/50
5452/5452 - 85s - loss: 3.1370 - accuracy300: 0.4538 - val_loss: 3.6007 - val_accuracy300: 0.3447 - 85s/epoch - 16ms/step
Epoch 8/50
5452/5452 - 83s - loss: 3.1338 - accuracy300: 0.4549 - val_loss: 3.6250 - val_accuracy300: 0.3415 - 83s/epoch - 15ms/step
Epoch 9/50
5452/5452 - 85s - loss: 3.1306 - accuracy300: 0.4562 - val_loss: 3.6072 - val_accuracy300: 0.3427 - 85s/epoch - 16ms/step
Epoch 10/50
5452/5452 - 85s - loss: 3.1279 - accuracy300: 0.4573 - val_loss: 3.6624 - val_accuracy300: 0.3334 - 85s/epoch - 16ms/step
Epoch 11/50
5452/5452 - 85s - loss: 3.1253 - accuracy300: 0.4578 - val_loss: 3.7221 - val_accuracy300: 0.3345 - 85s/epoch - 16ms/step
testing model: results/AAPL/W6/deepLOB_L1/h300
Evaluating performance on  test set...
29350/29350 - 164s - 164s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0916446
{'0': {'precision': 0.2922437052374934, 'recall': 0.014788140820947515, 'f1-score': 0.028151744664720688, 'support': 2204672}, '1': {'precision': 0.4125097276581556, 'recall': 0.9803758971269674, 'f1-score': 0.5806860048381264, 'support': 3099199}, '2': {'precision': 0.3004938339724667, 'recall': 0.00492954846114541, 'f1-score': 0.009699970611546992, 'support': 2209533}, 'accuracy': 0.41018358656076526, 'macro avg': {'precision': 0.33508242228937185, 'recall': 0.3333645288030201, 'f1-score': 0.20617924003813137, 'support': 7513404}, 'weighted avg': {'precision': 0.34427834467845325, 'recall': 0.41018358656076526, 'f1-score': 0.25063995678749856, 'support': 7513404}}
[[  32603 2161559   10510]
 [  45974 3038380   14845]
 [  32984 2165657   10892]]
Evaluating performance on  train set...
5452/5452 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1319803
{'0': {'precision': 0.3336032857060219, 'recall': 0.012188910141925666, 'f1-score': 0.023518520784141007, 'support': 473135}, '1': {'precision': 0.3238816594322095, 'recall': 0.9584161052970357, 'f1-score': 0.4841518205027869, 'support': 450535}, '2': {'precision': 0.345137267978215, 'recall': 0.032907663123536206, 'f1-score': 0.06008630197952747, 'support': 471805}, 'accuracy': 0.3246872928572708, 'macro avg': {'precision': 0.3342074043721488, 'recall': 0.33450422618749914, 'f1-score': 0.1892522144221518, 'support': 1395475}, 'weighted avg': {'precision': 0.3343642148610838, 'recall': 0.3246872928572708, 'f1-score': 0.1845993611400266, 'support': 1395475}}
[[  5767 451061  16307]
 [  5583 431800  13152]
 [  5937 450342  15526]]
Evaluating performance on  val set...
1969/1969 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1141233
{'0': {'precision': 0.3127808736293367, 'recall': 0.010631472825588855, 'f1-score': 0.02056397286501052, 'support': 163665}, '1': {'precision': 0.3603550185449713, 'recall': 0.9609035525137379, 'f1-score': 0.52414633300514, 'support': 180886}, '2': {'precision': 0.3351073705056006, 'recall': 0.03394728923215808, 'f1-score': 0.06164933312840481, 'support': 159512}, 'accuracy': 0.3590205986156492, 'macro avg': {'precision': 0.33608108755996957, 'recall': 0.3351607715238283, 'f1-score': 0.20211987966618514, 'support': 504063}, 'weighted avg': {'precision': 0.3369184138712035, 'recall': 0.3590205986156492, 'f1-score': 0.214279057651321, 'support': 504063}}
[[  1740 156088   5837]
 [  2165 173814   4907]
 [  1658 152439   5415]]
training model: results/AAPL/W6/deepLOB_L1/h500
Epoch 1/50
5452/5452 - 89s - loss: 3.1803 - accuracy500: 0.4346 - val_loss: 3.3614 - val_accuracy500: 0.3706 - 89s/epoch - 16ms/step
Epoch 2/50
5452/5452 - 84s - loss: 3.1447 - accuracy500: 0.4507 - val_loss: 3.3866 - val_accuracy500: 0.3709 - 84s/epoch - 15ms/step
Epoch 3/50
5452/5452 - 84s - loss: 3.1326 - accuracy500: 0.4562 - val_loss: 3.4927 - val_accuracy500: 0.3294 - 84s/epoch - 15ms/step
Epoch 4/50
5452/5452 - 84s - loss: 3.1214 - accuracy500: 0.4606 - val_loss: 3.6118 - val_accuracy500: 0.3204 - 84s/epoch - 15ms/step
Epoch 5/50
5452/5452 - 84s - loss: 3.1137 - accuracy500: 0.4628 - val_loss: 3.6142 - val_accuracy500: 0.3305 - 84s/epoch - 15ms/step
Epoch 6/50
5452/5452 - 84s - loss: 3.1072 - accuracy500: 0.4654 - val_loss: 3.4855 - val_accuracy500: 0.3340 - 84s/epoch - 15ms/step
Epoch 7/50
5452/5452 - 83s - loss: 3.1025 - accuracy500: 0.4669 - val_loss: 3.5511 - val_accuracy500: 0.3346 - 83s/epoch - 15ms/step
Epoch 8/50
5452/5452 - 84s - loss: 3.0980 - accuracy500: 0.4681 - val_loss: 3.6465 - val_accuracy500: 0.3216 - 84s/epoch - 15ms/step
Epoch 9/50
5452/5452 - 84s - loss: 3.0944 - accuracy500: 0.4692 - val_loss: 3.5040 - val_accuracy500: 0.3336 - 84s/epoch - 15ms/step
Epoch 10/50
5452/5452 - 86s - loss: 3.0908 - accuracy500: 0.4704 - val_loss: 3.6428 - val_accuracy500: 0.3241 - 86s/epoch - 16ms/step
Epoch 11/50
5452/5452 - 82s - loss: 3.0882 - accuracy500: 0.4709 - val_loss: 3.7260 - val_accuracy500: 0.3239 - 82s/epoch - 15ms/step
testing model: results/AAPL/W6/deepLOB_L1/h500
Evaluating performance on  test set...
29350/29350 - 146s - 146s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1094172
{'0': {'precision': 0.2856582217764793, 'recall': 0.0028580353504638035, 'f1-score': 0.0056594474371584064, 'support': 2292134}, '1': {'precision': 0.3875697630035318, 'recall': 0.9841671605058653, 'f1-score': 0.5561320492522327, 'support': 2912554}, '2': {'precision': 0.30167763227485245, 'recall': 0.01235318679300529, 'f1-score': 0.02373448665850551, 'support': 2308716}, 'accuracy': 0.3861779560902089, 'macro avg': {'precision': 0.32496853901828787, 'recall': 0.33312612754977816, 'f1-score': 0.19517532778263222, 'support': 7513404}, 'weighted avg': {'precision': 0.33008643785206615, 'recall': 0.3861779560902089, 'f1-score': 0.22460299294034888, 'support': 7513404}}
[[   6551 2256498   29085]
 [   9181 2866440   36933]
 [   7201 2272995   28520]]
Evaluating performance on  train set...
5452/5452 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1377863
{'0': {'precision': 0.38491128475456726, 'recall': 0.07490552034191826, 'f1-score': 0.12540637815082545, 'support': 468884}, '1': {'precision': 0.33578601944943604, 'recall': 0.9153866260074058, 'f1-score': 0.4913375184797852, 'support': 459100}, '2': {'precision': 0.3320740389178927, 'recall': 0.037416763103460815, 'f1-score': 0.06725545306690557, 'support': 467491}, 'accuracy': 0.3388580949139182, 'macro avg': {'precision': 0.350923781040632, 'recall': 0.34256963648426164, 'f1-score': 0.22799978323250544, 'support': 1395475}, 'weighted avg': {'precision': 0.35104873172064077, 'recall': 0.3388580949139182, 'f1-score': 0.22631392031863112, 'support': 1395475}}
[[ 35122 415863  17899]
 [ 21562 420254  17284]
 [ 34563 415436  17492]]
Evaluating performance on  val set...
1969/1969 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1214633
{'0': {'precision': 0.3356103114580792, 'recall': 0.025670850801786448, 'f1-score': 0.047693614464096895, 'support': 160766}, '1': {'precision': 0.37375444087294873, 'recall': 0.9420910956531009, 'f1-score': 0.5351855076194009, 'support': 187605}, '2': {'precision': 0.31870168378693214, 'recall': 0.038659661382730005, 'f1-score': 0.068954851126717, 'support': 155692}, 'accuracy': 0.37076119453322304, 'macro avg': {'precision': 0.34268881203932006, 'recall': 0.3354738692792058, 'f1-score': 0.2172779910700716, 'support': 504063}, 'weighted avg': {'precision': 0.34458437092981264, 'recall': 0.37076119453322304, 'f1-score': 0.23569813190314212, 'support': 504063}}
[[  4127 150147   6492]
 [  4489 176741   6375]
 [  3681 145992   6019]]
training model: results/AAPL/W6/deepLOB_L1/h1000
Epoch 1/50
5452/5452 - 87s - loss: 3.1587 - accuracy1000: 0.4443 - val_loss: 3.3123 - val_accuracy1000: 0.3775 - 87s/epoch - 16ms/step
Epoch 2/50
5452/5452 - 86s - loss: 3.1084 - accuracy1000: 0.4650 - val_loss: 3.5115 - val_accuracy1000: 0.3746 - 86s/epoch - 16ms/step
Epoch 3/50
5452/5452 - 85s - loss: 3.0823 - accuracy1000: 0.4735 - val_loss: 3.5662 - val_accuracy1000: 0.3809 - 85s/epoch - 16ms/step
Epoch 4/50
5452/5452 - 88s - loss: 3.0679 - accuracy1000: 0.4796 - val_loss: 3.5173 - val_accuracy1000: 0.3757 - 88s/epoch - 16ms/step
Epoch 5/50
5452/5452 - 85s - loss: 3.0492 - accuracy1000: 0.4853 - val_loss: 3.5989 - val_accuracy1000: 0.3798 - 85s/epoch - 16ms/step
Epoch 6/50
5452/5452 - 85s - loss: 3.0335 - accuracy1000: 0.4899 - val_loss: 3.7139 - val_accuracy1000: 0.3574 - 85s/epoch - 16ms/step
Epoch 7/50
5452/5452 - 86s - loss: 3.0222 - accuracy1000: 0.4929 - val_loss: 3.7695 - val_accuracy1000: 0.3393 - 86s/epoch - 16ms/step
Epoch 8/50
5452/5452 - 83s - loss: 3.0124 - accuracy1000: 0.4953 - val_loss: 3.7967 - val_accuracy1000: 0.3468 - 83s/epoch - 15ms/step
Epoch 9/50
5452/5452 - 86s - loss: 3.0059 - accuracy1000: 0.4970 - val_loss: 3.6010 - val_accuracy1000: 0.3749 - 86s/epoch - 16ms/step
Epoch 10/50
5452/5452 - 85s - loss: 2.9995 - accuracy1000: 0.4988 - val_loss: 3.8060 - val_accuracy1000: 0.3614 - 85s/epoch - 16ms/step
Epoch 11/50
5452/5452 - 83s - loss: 2.9945 - accuracy1000: 0.4993 - val_loss: 3.8371 - val_accuracy1000: 0.3521 - 83s/epoch - 15ms/step
testing model: results/AAPL/W6/deepLOB_L1/h1000
Evaluating performance on  test set...
29350/29350 - 150s - 150s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1028708
{'0': {'precision': 0.2982464740850312, 'recall': 0.06268613923483558, 'f1-score': 0.10359784242730259, 'support': 2232200}, '1': {'precision': 0.40119484728723803, 'recall': 0.9298201581250451, 'f1-score': 0.560533209357807, 'support': 3016094}, '2': {'precision': 0.30085286663089933, 'recall': 0.007179342283597706, 'f1-score': 0.014024025046967379, 'support': 2265110}, 'accuracy': 0.3940444304605476, 'macro avg': {'precision': 0.3334313960010562, 'recall': 0.33322854654782613, 'f1-score': 0.22605169227735902, 'support': 7513404}, 'weighted avg': {'precision': 0.3403586427564494, 'recall': 0.3940444304605476, 'f1-score': 0.26002034667444834, 'support': 7513404}}
[[ 139928 2075570   16702]
 [ 190580 2804425   21089]
 [ 138661 2110187   16262]]
Evaluating performance on  train set...
5452/5452 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1277883
{'0': {'precision': 0.3027655714150874, 'recall': 0.061986292545927704, 'f1-score': 0.10290456135723236, 'support': 465732}, '1': {'precision': 0.3287722830041705, 'recall': 0.8860355972726468, 'f1-score': 0.47958850262300357, 'support': 463013}, '2': {'precision': 0.34808456950604066, 'recall': 0.03901399095836994, 'f1-score': 0.07016387883832137, 'support': 466730}, 'accuracy': 0.32771923538580056, 'macro avg': {'precision': 0.32654080797509955, 'recall': 0.32901196025898144, 'f1-score': 0.21755231427285246, 'support': 1395475}, 'weighted avg': {'precision': 0.3265518675020733, 'recall': 0.32771923538580056, 'f1-score': 0.21693634476090293, 'support': 1395475}}
[[ 28869 418382  18481]
 [ 37145 410246  15622]
 [ 29337 419184  18209]]
Evaluating performance on  val set...
1969/1969 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1042398
{'0': {'precision': 0.352812437825086, 'recall': 0.07727408551009736, 'f1-score': 0.12678034307191846, 'support': 160636}, '1': {'precision': 0.3820268831514506, 'recall': 0.9110832513409719, 'f1-score': 0.5383273791105235, 'support': 189042}, '2': {'precision': 0.3248891352549889, 'recall': 0.037963532726625, 'f1-score': 0.06798318109322894, 'support': 154385}, 'accuracy': 0.3779428365105155, 'macro avg': {'precision': 0.35324281874384184, 'recall': 0.34210695652589806, 'f1-score': 0.24436363442522366, 'support': 504063}, 'weighted avg': {'precision': 0.35521653831669553, 'recall': 0.3779428365105155, 'f1-score': 0.26311702109575674, 'support': 504063}}
[[ 12413 141747   6476]
 [ 11106 172233   5703]
 [ 11664 136860   5861]]
training model: results/AAPL/W6/deepOF_L1/h10
Epoch 1/50
5452/5452 - 79s - loss: 3.0790 - accuracy10: 0.4766 - val_loss: 3.2922 - val_accuracy10: 0.4221 - 79s/epoch - 15ms/step
Epoch 2/50
5452/5452 - 74s - loss: 3.0740 - accuracy10: 0.4772 - val_loss: 3.2779 - val_accuracy10: 0.4238 - 74s/epoch - 14ms/step
Epoch 3/50
5452/5452 - 75s - loss: 3.0688 - accuracy10: 0.4790 - val_loss: 3.2683 - val_accuracy10: 0.4275 - 75s/epoch - 14ms/step
Epoch 4/50
5452/5452 - 75s - loss: 3.0616 - accuracy10: 0.4808 - val_loss: 3.2601 - val_accuracy10: 0.4282 - 75s/epoch - 14ms/step
Epoch 5/50
5452/5452 - 74s - loss: 3.0575 - accuracy10: 0.4820 - val_loss: 3.2755 - val_accuracy10: 0.4283 - 74s/epoch - 14ms/step
Epoch 6/50
5452/5452 - 75s - loss: 3.0564 - accuracy10: 0.4825 - val_loss: 3.2614 - val_accuracy10: 0.4292 - 75s/epoch - 14ms/step
Epoch 7/50
5452/5452 - 76s - loss: 3.0522 - accuracy10: 0.4833 - val_loss: 3.2653 - val_accuracy10: 0.4281 - 76s/epoch - 14ms/step
Epoch 8/50
5452/5452 - 76s - loss: 3.0478 - accuracy10: 0.4843 - val_loss: 3.2612 - val_accuracy10: 0.4297 - 76s/epoch - 14ms/step
Epoch 9/50
5452/5452 - 73s - loss: 3.0436 - accuracy10: 0.4852 - val_loss: 3.2544 - val_accuracy10: 0.4299 - 73s/epoch - 13ms/step
Epoch 10/50
5452/5452 - 75s - loss: 3.0396 - accuracy10: 0.4860 - val_loss: 3.2457 - val_accuracy10: 0.4308 - 75s/epoch - 14ms/step
Epoch 11/50
5452/5452 - 76s - loss: 3.0347 - accuracy10: 0.4870 - val_loss: 3.2538 - val_accuracy10: 0.4303 - 76s/epoch - 14ms/step
Epoch 12/50
5452/5452 - 74s - loss: 3.0311 - accuracy10: 0.4881 - val_loss: 3.2488 - val_accuracy10: 0.4321 - 74s/epoch - 14ms/step
Epoch 13/50
5452/5452 - 75s - loss: 3.0274 - accuracy10: 0.4889 - val_loss: 3.2396 - val_accuracy10: 0.4330 - 75s/epoch - 14ms/step
Epoch 14/50
5452/5452 - 75s - loss: 3.0230 - accuracy10: 0.4898 - val_loss: 3.2387 - val_accuracy10: 0.4339 - 75s/epoch - 14ms/step
Epoch 15/50
5452/5452 - 77s - loss: 3.0199 - accuracy10: 0.4902 - val_loss: 3.2380 - val_accuracy10: 0.4357 - 77s/epoch - 14ms/step
Epoch 16/50
5452/5452 - 74s - loss: 3.0170 - accuracy10: 0.4910 - val_loss: 3.2395 - val_accuracy10: 0.4354 - 74s/epoch - 14ms/step
Epoch 17/50
5452/5452 - 75s - loss: 3.0134 - accuracy10: 0.4920 - val_loss: 3.2404 - val_accuracy10: 0.4358 - 75s/epoch - 14ms/step
Epoch 18/50
5452/5452 - 75s - loss: 3.0106 - accuracy10: 0.4926 - val_loss: 3.2390 - val_accuracy10: 0.4360 - 75s/epoch - 14ms/step
Epoch 19/50
5452/5452 - 74s - loss: 3.0066 - accuracy10: 0.4940 - val_loss: 3.2390 - val_accuracy10: 0.4373 - 74s/epoch - 14ms/step
Epoch 20/50
5452/5452 - 74s - loss: 3.0036 - accuracy10: 0.4944 - val_loss: 3.2436 - val_accuracy10: 0.4368 - 74s/epoch - 14ms/step
Epoch 21/50
5452/5452 - 79s - loss: 3.0005 - accuracy10: 0.4954 - val_loss: 3.2445 - val_accuracy10: 0.4370 - 79s/epoch - 14ms/step
Epoch 22/50
5452/5452 - 76s - loss: 2.9969 - accuracy10: 0.4966 - val_loss: 3.2465 - val_accuracy10: 0.4362 - 76s/epoch - 14ms/step
Epoch 23/50
5452/5452 - 74s - loss: 2.9940 - accuracy10: 0.4973 - val_loss: 3.2427 - val_accuracy10: 0.4375 - 74s/epoch - 14ms/step
Epoch 24/50
5452/5452 - 74s - loss: 2.9914 - accuracy10: 0.4982 - val_loss: 3.2398 - val_accuracy10: 0.4373 - 74s/epoch - 14ms/step
Epoch 25/50
5452/5452 - 75s - loss: 2.9891 - accuracy10: 0.4989 - val_loss: 3.2304 - val_accuracy10: 0.4385 - 75s/epoch - 14ms/step
Epoch 26/50
5452/5452 - 76s - loss: 2.9868 - accuracy10: 0.4997 - val_loss: 3.2297 - val_accuracy10: 0.4388 - 76s/epoch - 14ms/step
Epoch 27/50
5452/5452 - 76s - loss: 2.9846 - accuracy10: 0.5001 - val_loss: 3.2257 - val_accuracy10: 0.4396 - 76s/epoch - 14ms/step
Epoch 28/50
5452/5452 - 76s - loss: 2.9820 - accuracy10: 0.5011 - val_loss: 3.2243 - val_accuracy10: 0.4400 - 76s/epoch - 14ms/step
Epoch 29/50
5452/5452 - 75s - loss: 2.9796 - accuracy10: 0.5015 - val_loss: 3.2246 - val_accuracy10: 0.4403 - 75s/epoch - 14ms/step
Epoch 30/50
5452/5452 - 76s - loss: 2.9772 - accuracy10: 0.5021 - val_loss: 3.2217 - val_accuracy10: 0.4408 - 76s/epoch - 14ms/step
Epoch 31/50
5452/5452 - 76s - loss: 2.9750 - accuracy10: 0.5028 - val_loss: 3.2210 - val_accuracy10: 0.4417 - 76s/epoch - 14ms/step
Epoch 32/50
5452/5452 - 77s - loss: 2.9731 - accuracy10: 0.5033 - val_loss: 3.2196 - val_accuracy10: 0.4410 - 77s/epoch - 14ms/step
Epoch 33/50
5452/5452 - 76s - loss: 2.9708 - accuracy10: 0.5044 - val_loss: 3.2211 - val_accuracy10: 0.4418 - 76s/epoch - 14ms/step
Epoch 34/50
5452/5452 - 76s - loss: 2.9684 - accuracy10: 0.5052 - val_loss: 3.2204 - val_accuracy10: 0.4423 - 76s/epoch - 14ms/step
Epoch 35/50
5452/5452 - 77s - loss: 2.9669 - accuracy10: 0.5054 - val_loss: 3.2206 - val_accuracy10: 0.4413 - 77s/epoch - 14ms/step
Epoch 36/50
5452/5452 - 75s - loss: 2.9652 - accuracy10: 0.5057 - val_loss: 3.2177 - val_accuracy10: 0.4423 - 75s/epoch - 14ms/step
Epoch 37/50
5452/5452 - 76s - loss: 2.9635 - accuracy10: 0.5061 - val_loss: 3.2198 - val_accuracy10: 0.4429 - 76s/epoch - 14ms/step
Epoch 38/50
5452/5452 - 75s - loss: 2.9622 - accuracy10: 0.5065 - val_loss: 3.2121 - val_accuracy10: 0.4427 - 75s/epoch - 14ms/step
Epoch 39/50
5452/5452 - 73s - loss: 2.9605 - accuracy10: 0.5069 - val_loss: 3.2119 - val_accuracy10: 0.4438 - 73s/epoch - 13ms/step
Epoch 40/50
5452/5452 - 75s - loss: 2.9592 - accuracy10: 0.5071 - val_loss: 3.2108 - val_accuracy10: 0.4438 - 75s/epoch - 14ms/step
Epoch 41/50
5452/5452 - 75s - loss: 2.9575 - accuracy10: 0.5079 - val_loss: 3.2103 - val_accuracy10: 0.4437 - 75s/epoch - 14ms/step
Epoch 42/50
5452/5452 - 75s - loss: 2.9563 - accuracy10: 0.5083 - val_loss: 3.2099 - val_accuracy10: 0.4439 - 75s/epoch - 14ms/step
Epoch 43/50
5452/5452 - 75s - loss: 2.9548 - accuracy10: 0.5084 - val_loss: 3.2089 - val_accuracy10: 0.4450 - 75s/epoch - 14ms/step
Epoch 44/50
5452/5452 - 75s - loss: 2.9536 - accuracy10: 0.5093 - val_loss: 3.2115 - val_accuracy10: 0.4435 - 75s/epoch - 14ms/step
Epoch 45/50
5452/5452 - 76s - loss: 2.9516 - accuracy10: 0.5092 - val_loss: 3.2043 - val_accuracy10: 0.4447 - 76s/epoch - 14ms/step
Epoch 46/50
5452/5452 - 75s - loss: 2.9508 - accuracy10: 0.5094 - val_loss: 3.2146 - val_accuracy10: 0.4443 - 75s/epoch - 14ms/step
Epoch 47/50
5452/5452 - 75s - loss: 2.9522 - accuracy10: 0.5088 - val_loss: 3.2028 - val_accuracy10: 0.4463 - 75s/epoch - 14ms/step
Epoch 48/50
5452/5452 - 77s - loss: 2.9490 - accuracy10: 0.5101 - val_loss: 3.2047 - val_accuracy10: 0.4460 - 77s/epoch - 14ms/step
Epoch 49/50
5452/5452 - 75s - loss: 2.9475 - accuracy10: 0.5104 - val_loss: 3.2073 - val_accuracy10: 0.4461 - 75s/epoch - 14ms/step
Epoch 50/50
5452/5452 - 76s - loss: 2.9463 - accuracy10: 0.5109 - val_loss: 3.2080 - val_accuracy10: 0.4452 - 76s/epoch - 14ms/step
testing model: results/AAPL/W6/deepOF_L1/h10
Evaluating performance on  test set...
29350/29350 - 156s - 156s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.163931
{'0': {'precision': 0.48440040455249583, 'recall': 0.13789814991417126, 'f1-score': 0.2146812623169712, 'support': 2469453}, '1': {'precision': 0.3488929421561208, 'recall': 0.8696265097641374, 'f1-score': 0.4979921347836207, 'support': 2535247}, '2': {'precision': 0.4885875517590968, 'recall': 0.09566831253968691, 'f1-score': 0.16000642684447602, 'support': 2508699}, 'accuracy': 0.3707049232976979, 'macro avg': {'precision': 0.4406269661559045, 'recall': 0.3677309907393318, 'f1-score': 0.29089327464835596, 'support': 7513399}, 'weighted avg': {'precision': 0.4400741820920661, 'recall': 0.3707049232976979, 'f1-score': 0.29202313307525823, 'support': 7513399}}
[[ 340533 2006790  122130]
 [ 201444 2204718  129085]
 [ 161022 2107674  240003]]
Evaluating performance on  train set...
5452/5452 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1040514
{'0': {'precision': 0.5350010771570887, 'recall': 0.17792251495315944, 'f1-score': 0.26703769717784376, 'support': 460605}, '1': {'precision': 0.3631237909644445, 'recall': 0.8559479065228319, 'f1-score': 0.5099208673703045, 'support': 475453}, '2': {'precision': 0.5475716495014972, 'recall': 0.14489078502007988, 'f1-score': 0.2291476972489539, 'support': 459415}, 'accuracy': 0.3980585794207412, 'macro avg': {'precision': 0.48189883920767684, 'recall': 0.392920402165357, 'f1-score': 0.33536875393236737, 'support': 1395473}, 'weighted avg': {'precision': 0.48057905547802726, 'recall': 0.3980585794207412, 'f1-score': 0.3373165901411509, 'support': 1395473}}
[[ 81952 352432  26221]
 [ 39712 406963  28778]
 [ 31517 361333  66565]]
Evaluating performance on  val set...
1969/1969 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0646771
{'0': {'precision': 0.5127887876783924, 'recall': 0.1606184726611831, 'f1-score': 0.244616762323442, 'support': 149659}, '1': {'precision': 0.43091685099224275, 'recall': 0.8719450694390566, 'f1-score': 0.5767853333782403, 'support': 206224}, '2': {'precision': 0.5243119955887513, 'recall': 0.14117385054562387, 'f1-score': 0.22245144276014614, 'support': 148179}, 'accuracy': 0.445923318956795, 'macro avg': {'precision': 0.4893392114197955, 'recall': 0.3912457975486212, 'f1-score': 0.3479511794872761, 'support': 504062}, 'weighted avg': {'precision': 0.48268046599134706, 'recall': 0.445923318956795, 'f1-score': 0.3739990536083139, 'support': 504062}}
[[ 24038 118608   7013]
 [ 14442 179816  11966]
 [  8397 118863  20919]]
training model: results/AAPL/W6/deepOF_L1/h20
Epoch 1/50
5452/5452 - 78s - loss: 3.1299 - accuracy20: 0.4585 - val_loss: 3.2891 - val_accuracy20: 0.4054 - 78s/epoch - 14ms/step
Epoch 2/50
5452/5452 - 76s - loss: 3.1197 - accuracy20: 0.4616 - val_loss: 3.2605 - val_accuracy20: 0.4016 - 76s/epoch - 14ms/step
Epoch 3/50
5452/5452 - 75s - loss: 3.1151 - accuracy20: 0.4635 - val_loss: 3.2409 - val_accuracy20: 0.4078 - 75s/epoch - 14ms/step
Epoch 4/50
5452/5452 - 76s - loss: 3.1098 - accuracy20: 0.4653 - val_loss: 3.2508 - val_accuracy20: 0.4093 - 76s/epoch - 14ms/step
Epoch 5/50
5452/5452 - 76s - loss: 3.1047 - accuracy20: 0.4665 - val_loss: 3.2505 - val_accuracy20: 0.4103 - 76s/epoch - 14ms/step
Epoch 6/50
5452/5452 - 76s - loss: 3.1029 - accuracy20: 0.4671 - val_loss: 3.2476 - val_accuracy20: 0.4117 - 76s/epoch - 14ms/step
Epoch 7/50
5452/5452 - 74s - loss: 3.1002 - accuracy20: 0.4673 - val_loss: 3.2495 - val_accuracy20: 0.4117 - 74s/epoch - 14ms/step
Epoch 8/50
5452/5452 - 79s - loss: 3.0984 - accuracy20: 0.4681 - val_loss: 3.2464 - val_accuracy20: 0.4141 - 79s/epoch - 14ms/step
Epoch 9/50
5452/5452 - 76s - loss: 3.0948 - accuracy20: 0.4690 - val_loss: 3.2425 - val_accuracy20: 0.4149 - 76s/epoch - 14ms/step
Epoch 10/50
5452/5452 - 78s - loss: 3.0921 - accuracy20: 0.4697 - val_loss: 3.2377 - val_accuracy20: 0.4161 - 78s/epoch - 14ms/step
Epoch 11/50
5452/5452 - 80s - loss: 3.0897 - accuracy20: 0.4706 - val_loss: 3.2357 - val_accuracy20: 0.4164 - 80s/epoch - 15ms/step
Epoch 12/50
5452/5452 - 79s - loss: 3.0877 - accuracy20: 0.4711 - val_loss: 3.2229 - val_accuracy20: 0.4186 - 79s/epoch - 15ms/step
Epoch 13/50
5452/5452 - 79s - loss: 3.0857 - accuracy20: 0.4724 - val_loss: 3.2277 - val_accuracy20: 0.4190 - 79s/epoch - 14ms/step
Epoch 14/50
5452/5452 - 79s - loss: 3.0824 - accuracy20: 0.4731 - val_loss: 3.2273 - val_accuracy20: 0.4189 - 79s/epoch - 15ms/step
Epoch 15/50
5452/5452 - 77s - loss: 3.0801 - accuracy20: 0.4734 - val_loss: 3.2208 - val_accuracy20: 0.4203 - 77s/epoch - 14ms/step
Epoch 16/50
5452/5452 - 77s - loss: 3.0779 - accuracy20: 0.4742 - val_loss: 3.2160 - val_accuracy20: 0.4214 - 77s/epoch - 14ms/step
Epoch 17/50
5452/5452 - 80s - loss: 3.0760 - accuracy20: 0.4748 - val_loss: 3.2147 - val_accuracy20: 0.4217 - 80s/epoch - 15ms/step
Epoch 18/50
5452/5452 - 79s - loss: 3.0744 - accuracy20: 0.4752 - val_loss: 3.2139 - val_accuracy20: 0.4219 - 79s/epoch - 15ms/step
Epoch 19/50
5452/5452 - 75s - loss: 3.0720 - accuracy20: 0.4758 - val_loss: 3.2136 - val_accuracy20: 0.4213 - 75s/epoch - 14ms/step
Epoch 20/50
5452/5452 - 78s - loss: 3.0699 - accuracy20: 0.4767 - val_loss: 3.2108 - val_accuracy20: 0.4223 - 78s/epoch - 14ms/step
Epoch 21/50
5452/5452 - 79s - loss: 3.0680 - accuracy20: 0.4770 - val_loss: 3.2107 - val_accuracy20: 0.4228 - 79s/epoch - 14ms/step
Epoch 22/50
5452/5452 - 80s - loss: 3.0656 - accuracy20: 0.4780 - val_loss: 3.2110 - val_accuracy20: 0.4224 - 80s/epoch - 15ms/step
Epoch 23/50
5452/5452 - 79s - loss: 3.0640 - accuracy20: 0.4785 - val_loss: 3.2121 - val_accuracy20: 0.4220 - 79s/epoch - 14ms/step
Epoch 24/50
5452/5452 - 78s - loss: 3.0613 - accuracy20: 0.4794 - val_loss: 3.2129 - val_accuracy20: 0.4219 - 78s/epoch - 14ms/step
Epoch 25/50
5452/5452 - 79s - loss: 3.0597 - accuracy20: 0.4801 - val_loss: 3.2134 - val_accuracy20: 0.4224 - 79s/epoch - 14ms/step
Epoch 26/50
5452/5452 - 80s - loss: 3.0578 - accuracy20: 0.4806 - val_loss: 3.2131 - val_accuracy20: 0.4234 - 80s/epoch - 15ms/step
Epoch 27/50
5452/5452 - 80s - loss: 3.0564 - accuracy20: 0.4807 - val_loss: 3.2118 - val_accuracy20: 0.4233 - 80s/epoch - 15ms/step
Epoch 28/50
5452/5452 - 78s - loss: 3.0545 - accuracy20: 0.4814 - val_loss: 3.2178 - val_accuracy20: 0.4223 - 78s/epoch - 14ms/step
Epoch 29/50
5452/5452 - 77s - loss: 3.0528 - accuracy20: 0.4820 - val_loss: 3.2131 - val_accuracy20: 0.4226 - 77s/epoch - 14ms/step
Epoch 30/50
5452/5452 - 80s - loss: 3.0513 - accuracy20: 0.4824 - val_loss: 3.2165 - val_accuracy20: 0.4224 - 80s/epoch - 15ms/step
Epoch 31/50
5452/5452 - 79s - loss: 3.0501 - accuracy20: 0.4831 - val_loss: 3.2148 - val_accuracy20: 0.4230 - 79s/epoch - 14ms/step
testing model: results/AAPL/W6/deepOF_L1/h20
Evaluating performance on  test set...
29350/29350 - 169s - 169s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1080902
{'0': {'precision': 0.48639496770461776, 'recall': 0.1216722620608161, 'f1-score': 0.19465208147608226, 'support': 2322148}, '1': {'precision': 0.3965811614209825, 'recall': 0.8654525365352577, 'f1-score': 0.5439191879736776, 'support': 2896175}, '2': {'precision': 0.46603923977028466, 'recall': 0.12432093752015184, 'f1-score': 0.19628165122972696, 'support': 2295076}, 'accuracy': 0.40918484430282487, 'macro avg': {'precision': 0.4496717896319616, 'recall': 0.3704819120387419, 'f1-score': 0.3116176402264956, 'support': 7513399}, 'weighted avg': {'precision': 0.4455566676145886, 'recall': 0.40918484430282487, 'f1-score': 0.3297811553602975, 'support': 7513399}}
[[ 282541 1908859  130748]
 [ 193511 2506502  196162]
 [ 104836 1904914  285326]]
Evaluating performance on  train set...
5452/5452 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0959477
{'0': {'precision': 0.5198143749959773, 'recall': 0.17377701750422275, 'f1-score': 0.26047552700157395, 'support': 464745}, '1': {'precision': 0.34924937085732516, 'recall': 0.8191509205400387, 'f1-score': 0.48970878515214433, 'support': 466411}, '2': {'precision': 0.5134341837886656, 'recall': 0.1616180325079633, 'f1-score': 0.2458483080360507, 'support': 464317}, 'accuracy': 0.38543561932047415, 'macro avg': {'precision': 0.4608326432139893, 'recall': 0.3848486568507416, 'f1-score': 0.3320108733965897, 'support': 1395473}, 'weighted avg': {'precision': 0.46068329514984746, 'recall': 0.38543561932047415, 'f1-score': 0.33222556927315555, 'support': 1395473}}
[[ 80762 352650  31333]
 [ 44568 382061  39782]
 [ 30037 359238  75042]]
Evaluating performance on  val set...
1969/1969 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0698906
{'0': {'precision': 0.4961988904869529, 'recall': 0.17091515042334715, 'f1-score': 0.2542531045868926, 'support': 155428}, '1': {'precision': 0.40239903778971114, 'recall': 0.8294490708117088, 'f1-score': 0.5419004269432978, 'support': 194417}, '2': {'precision': 0.5045700166730278, 'recall': 0.16287439127982, 'f1-score': 0.2462573162481985, 'support': 154217}, 'accuracy': 0.4224519999523868, 'macro avg': {'precision': 0.46772264831656396, 'recall': 0.3877462041716253, 'f1-score': 0.3474702825927963, 'support': 504062}, 'weighted avg': {'precision': 0.46258136725607707, 'recall': 0.4224519999523868, 'f1-score': 0.3627525411251296, 'support': 504062}}
[[ 26565 119662   9201]
 [ 17696 161259  15462]
 [  9276 119823  25118]]
training model: results/AAPL/W6/deepOF_L1/h30
Epoch 1/50
5452/5452 - 82s - loss: 3.1565 - accuracy30: 0.4481 - val_loss: 3.2673 - val_accuracy30: 0.3940 - 82s/epoch - 15ms/step
Epoch 2/50
5452/5452 - 78s - loss: 3.1445 - accuracy30: 0.4518 - val_loss: 3.2421 - val_accuracy30: 0.3960 - 78s/epoch - 14ms/step
Epoch 3/50
5452/5452 - 78s - loss: 3.1417 - accuracy30: 0.4523 - val_loss: 3.2411 - val_accuracy30: 0.3942 - 78s/epoch - 14ms/step
Epoch 4/50
5452/5452 - 77s - loss: 3.1404 - accuracy30: 0.4526 - val_loss: 3.2365 - val_accuracy30: 0.3987 - 77s/epoch - 14ms/step
Epoch 5/50
5452/5452 - 77s - loss: 3.1385 - accuracy30: 0.4532 - val_loss: 3.2364 - val_accuracy30: 0.3998 - 77s/epoch - 14ms/step
Epoch 6/50
5452/5452 - 78s - loss: 3.1365 - accuracy30: 0.4542 - val_loss: 3.2470 - val_accuracy30: 0.3994 - 78s/epoch - 14ms/step
Epoch 7/50
5452/5452 - 78s - loss: 3.1330 - accuracy30: 0.4555 - val_loss: 3.2453 - val_accuracy30: 0.4009 - 78s/epoch - 14ms/step
Epoch 8/50
5452/5452 - 78s - loss: 3.1291 - accuracy30: 0.4569 - val_loss: 3.2420 - val_accuracy30: 0.4024 - 78s/epoch - 14ms/step
Epoch 9/50
5452/5452 - 80s - loss: 3.1269 - accuracy30: 0.4577 - val_loss: 3.2388 - val_accuracy30: 0.4018 - 80s/epoch - 15ms/step
Epoch 10/50
5452/5452 - 83s - loss: 3.1253 - accuracy30: 0.4580 - val_loss: 3.2366 - val_accuracy30: 0.4041 - 83s/epoch - 15ms/step
Epoch 11/50
5452/5452 - 77s - loss: 3.1236 - accuracy30: 0.4585 - val_loss: 3.2405 - val_accuracy30: 0.4027 - 77s/epoch - 14ms/step
Epoch 12/50
5452/5452 - 80s - loss: 3.1222 - accuracy30: 0.4587 - val_loss: 3.2349 - val_accuracy30: 0.4049 - 80s/epoch - 15ms/step
Epoch 13/50
5452/5452 - 78s - loss: 3.1210 - accuracy30: 0.4594 - val_loss: 3.2307 - val_accuracy30: 0.4063 - 78s/epoch - 14ms/step
Epoch 14/50
5452/5452 - 78s - loss: 3.1199 - accuracy30: 0.4596 - val_loss: 3.2272 - val_accuracy30: 0.4083 - 78s/epoch - 14ms/step
Epoch 15/50
5452/5452 - 78s - loss: 3.1183 - accuracy30: 0.4606 - val_loss: 3.2304 - val_accuracy30: 0.4074 - 78s/epoch - 14ms/step
Epoch 16/50
5452/5452 - 76s - loss: 3.1165 - accuracy30: 0.4614 - val_loss: 3.2276 - val_accuracy30: 0.4082 - 76s/epoch - 14ms/step
Epoch 17/50
5452/5452 - 78s - loss: 3.1142 - accuracy30: 0.4621 - val_loss: 3.2277 - val_accuracy30: 0.4090 - 78s/epoch - 14ms/step
Epoch 18/50
5452/5452 - 77s - loss: 3.1129 - accuracy30: 0.4627 - val_loss: 3.2229 - val_accuracy30: 0.4100 - 77s/epoch - 14ms/step
Epoch 19/50
5452/5452 - 77s - loss: 3.1112 - accuracy30: 0.4633 - val_loss: 3.2232 - val_accuracy30: 0.4103 - 77s/epoch - 14ms/step
Epoch 20/50
5452/5452 - 77s - loss: 3.1096 - accuracy30: 0.4641 - val_loss: 3.2210 - val_accuracy30: 0.4115 - 77s/epoch - 14ms/step
Epoch 21/50
5452/5452 - 78s - loss: 3.1079 - accuracy30: 0.4643 - val_loss: 3.2199 - val_accuracy30: 0.4110 - 78s/epoch - 14ms/step
Epoch 22/50
5452/5452 - 76s - loss: 3.1064 - accuracy30: 0.4648 - val_loss: 3.2214 - val_accuracy30: 0.4110 - 76s/epoch - 14ms/step
Epoch 23/50
5452/5452 - 76s - loss: 3.1052 - accuracy30: 0.4648 - val_loss: 3.2219 - val_accuracy30: 0.4119 - 76s/epoch - 14ms/step
Epoch 24/50
5452/5452 - 79s - loss: 3.1039 - accuracy30: 0.4655 - val_loss: 3.2181 - val_accuracy30: 0.4128 - 79s/epoch - 14ms/step
Epoch 25/50
5452/5452 - 78s - loss: 3.1023 - accuracy30: 0.4660 - val_loss: 3.2166 - val_accuracy30: 0.4137 - 78s/epoch - 14ms/step
Epoch 26/50
5452/5452 - 79s - loss: 3.1005 - accuracy30: 0.4667 - val_loss: 3.2207 - val_accuracy30: 0.4123 - 79s/epoch - 15ms/step
Epoch 27/50
5452/5452 - 78s - loss: 3.0995 - accuracy30: 0.4670 - val_loss: 3.2196 - val_accuracy30: 0.4133 - 78s/epoch - 14ms/step
Epoch 28/50
5452/5452 - 80s - loss: 3.0977 - accuracy30: 0.4675 - val_loss: 3.2190 - val_accuracy30: 0.4140 - 80s/epoch - 15ms/step
Epoch 29/50
5452/5452 - 78s - loss: 3.0964 - accuracy30: 0.4680 - val_loss: 3.2182 - val_accuracy30: 0.4134 - 78s/epoch - 14ms/step
Epoch 30/50
5452/5452 - 81s - loss: 3.0945 - accuracy30: 0.4690 - val_loss: 3.2237 - val_accuracy30: 0.4126 - 81s/epoch - 15ms/step
Epoch 31/50
5452/5452 - 78s - loss: 3.0934 - accuracy30: 0.4694 - val_loss: 3.2182 - val_accuracy30: 0.4146 - 78s/epoch - 14ms/step
Epoch 32/50
5452/5452 - 77s - loss: 3.0926 - accuracy30: 0.4696 - val_loss: 3.2263 - val_accuracy30: 0.4110 - 77s/epoch - 14ms/step
Epoch 33/50
5452/5452 - 78s - loss: 3.0909 - accuracy30: 0.4700 - val_loss: 3.2230 - val_accuracy30: 0.4127 - 78s/epoch - 14ms/step
Epoch 34/50
5452/5452 - 78s - loss: 3.0898 - accuracy30: 0.4705 - val_loss: 3.2210 - val_accuracy30: 0.4128 - 78s/epoch - 14ms/step
Epoch 35/50
5452/5452 - 77s - loss: 3.0884 - accuracy30: 0.4710 - val_loss: 3.2199 - val_accuracy30: 0.4128 - 77s/epoch - 14ms/step
testing model: results/AAPL/W6/deepOF_L1/h30
Evaluating performance on  test set...
29350/29350 - 175s - 175s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0795122
{'0': {'precision': 0.46324805976813854, 'recall': 0.1256083671748045, 'f1-score': 0.19762994754580546, 'support': 2213507}, '1': {'precision': 0.4264138278234603, 'recall': 0.8396620014656494, 'f1-score': 0.5655956457583015, 'support': 3113978}, '2': {'precision': 0.4329602432550723, 'recall': 0.15477095622243145, 'f1-score': 0.22802829223446378, 'support': 2185914}, 'accuracy': 0.43003705779501394, 'macro avg': {'precision': 0.4408740436155571, 'recall': 0.37334710828762846, 'f1-score': 0.3304179618461902, 'support': 7513399}, 'weighted avg': {'precision': 0.43917006922511426, 'recall': 0.43003705779501394, 'f1-score': 0.358979724952824, 'support': 7513399}}
[[ 278035 1775725  159747]
 [ 215950 2614689  283339]
 [ 106201 1741397  338316]]
Evaluating performance on  train set...
5452/5452 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0916005
{'0': {'precision': 0.5131888253779724, 'recall': 0.17727735086204685, 'f1-score': 0.26352269983862975, 'support': 467956}, '1': {'precision': 0.34662991915946545, 'recall': 0.7562600570250967, 'f1-score': 0.4753735514706936, 'support': 460499}, '2': {'precision': 0.4821954636511629, 'recall': 0.2365733226556578, 'f1-score': 0.3174166301560738, 'support': 467018}, 'accuracy': 0.3881830748427236, 'macro avg': {'precision': 0.4473380693962003, 'recall': 0.3900369101809338, 'f1-score': 0.3521042938217991, 'support': 1395473}, 'weighted avg': {'precision': 0.44785279410997414, 'recall': 0.3881830748427236, 'f1-score': 0.3514688950532314, 'support': 1395473}}
[[ 82958 332281  52717]
 [ 46316 348257  65926]
 [ 32378 324156 110484]]
Evaluating performance on  val set...
1969/1969 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0731133
{'0': {'precision': 0.5034774545033036, 'recall': 0.16282527881040892, 'f1-score': 0.2460709008247685, 'support': 160055}, '1': {'precision': 0.3879061132475799, 'recall': 0.7851747666110148, 'f1-score': 0.5192721101598183, 'support': 186277}, '2': {'precision': 0.4790697674418605, 'recall': 0.22855512584796805, 'f1-score': 0.30946862391621593, 'support': 157730}, 'accuracy': 0.41338367105633833, 'macro avg': {'precision': 0.4568177783975813, 'recall': 0.3921850570897973, 'f1-score': 0.3582705449669343, 'support': 504062}, 'weighted avg': {'precision': 0.45313026067537393, 'recall': 0.41338367105633833, 'f1-score': 0.36687116851905827, 'support': 504062}}
[[ 26061 118387  15607]
 [ 16424 146260  23593]
 [  9277 112403  36050]]
training model: results/AAPL/W6/deepOF_L1/h50
Epoch 1/50
5452/5452 - 81s - loss: 3.1284 - accuracy50: 0.4573 - val_loss: 3.2435 - val_accuracy50: 0.3925 - 81s/epoch - 15ms/step
Epoch 2/50
5452/5452 - 78s - loss: 3.1215 - accuracy50: 0.4598 - val_loss: 3.2356 - val_accuracy50: 0.3980 - 78s/epoch - 14ms/step
Epoch 3/50
5452/5452 - 83s - loss: 3.1231 - accuracy50: 0.4593 - val_loss: 3.2331 - val_accuracy50: 0.3982 - 83s/epoch - 15ms/step
Epoch 4/50
5452/5452 - 80s - loss: 3.1235 - accuracy50: 0.4593 - val_loss: 3.2305 - val_accuracy50: 0.4010 - 80s/epoch - 15ms/step
Epoch 5/50
5452/5452 - 77s - loss: 3.1184 - accuracy50: 0.4604 - val_loss: 3.2286 - val_accuracy50: 0.4030 - 77s/epoch - 14ms/step
Epoch 6/50
5452/5452 - 79s - loss: 3.1150 - accuracy50: 0.4616 - val_loss: 3.2285 - val_accuracy50: 0.4023 - 79s/epoch - 14ms/step
Epoch 7/50
5452/5452 - 78s - loss: 3.1155 - accuracy50: 0.4612 - val_loss: 3.2292 - val_accuracy50: 0.4013 - 78s/epoch - 14ms/step
Epoch 8/50
5452/5452 - 79s - loss: 3.1165 - accuracy50: 0.4612 - val_loss: 3.2288 - val_accuracy50: 0.4026 - 79s/epoch - 14ms/step
Epoch 9/50
5452/5452 - 77s - loss: 3.1169 - accuracy50: 0.4608 - val_loss: 3.2290 - val_accuracy50: 0.4017 - 77s/epoch - 14ms/step
Epoch 10/50
5452/5452 - 77s - loss: 3.1150 - accuracy50: 0.4616 - val_loss: 3.2300 - val_accuracy50: 0.4011 - 77s/epoch - 14ms/step
Epoch 11/50
5452/5452 - 77s - loss: 3.1154 - accuracy50: 0.4613 - val_loss: 3.2293 - val_accuracy50: 0.4012 - 77s/epoch - 14ms/step
Epoch 12/50
5452/5452 - 78s - loss: 3.1145 - accuracy50: 0.4612 - val_loss: 3.2287 - val_accuracy50: 0.4027 - 78s/epoch - 14ms/step
Epoch 13/50
5452/5452 - 77s - loss: 3.1126 - accuracy50: 0.4616 - val_loss: 3.2294 - val_accuracy50: 0.4018 - 77s/epoch - 14ms/step
Epoch 14/50
5452/5452 - 79s - loss: 3.1117 - accuracy50: 0.4617 - val_loss: 3.2294 - val_accuracy50: 0.4030 - 79s/epoch - 14ms/step
Epoch 15/50
5452/5452 - 77s - loss: 3.1110 - accuracy50: 0.4620 - val_loss: 3.2294 - val_accuracy50: 0.4013 - 77s/epoch - 14ms/step
Epoch 16/50
5452/5452 - 82s - loss: 3.1084 - accuracy50: 0.4627 - val_loss: 3.2291 - val_accuracy50: 0.4018 - 82s/epoch - 15ms/step
testing model: results/AAPL/W6/deepOF_L1/h50
Evaluating performance on  test set...
29350/29350 - 201s - 201s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0830233
{'0': {'precision': 0.35917071081638413, 'recall': 0.3975997432977204, 'f1-score': 0.37740950811254065, 'support': 2212680}, '1': {'precision': 0.41955784834129517, 'recall': 0.2437239418063801, 'f1-score': 0.3083343885885279, 'support': 3112025}, '2': {'precision': 0.3477350760707332, 'recall': 0.5173349952071875, 'f1-score': 0.4159097161844333, 'support': 2188694}, 'accuracy': 0.368744425791842, 'macro avg': {'precision': 0.37548787840947084, 'recall': 0.38621956010376274, 'f1-score': 0.3672178709618339, 'support': 7513399}, 'weighted avg': {'precision': 0.38085160071747465, 'recall': 0.368744425791842, 'f1-score': 0.3600141422560205, 'support': 7513399}}
[[ 879761  543643  789276]
 [1018934  758475 1334616]
 [ 550728  505678 1132288]]
Evaluating performance on  train set...
5452/5452 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0816462
{'0': {'precision': 0.42351800900450226, 'recall': 0.4331726597692867, 'f1-score': 0.4282909318558599, 'support': 469067}, '1': {'precision': 0.33811553512459813, 'recall': 0.2527507182642473, 'f1-score': 0.28926662800220043, 'support': 459789}, '2': {'precision': 0.41349072040950474, 'recall': 0.5068825182108667, 'f1-score': 0.45544830906246236, 'support': 466617}, 'accuracy': 0.3983731680942591, 'macro avg': {'precision': 0.391708088179535, 'recall': 0.39760196541480025, 'f1-score': 0.3910019563068409, 'support': 1395473}, 'weighted avg': {'precision': 0.39202616259464756, 'recall': 0.3983731680942591, 'f1-score': 0.3915652110683155, 'support': 1395473}}
[[203187 116501 149379]
 [157468 116212 186109]
 [119105 110992 236520]]
Evaluating performance on  val set...
1969/1969 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0758605
{'0': {'precision': 0.41132401427216475, 'recall': 0.4437953803420886, 'f1-score': 0.42694318128545306, 'support': 164168}, '1': {'precision': 0.3792451486840336, 'recall': 0.26615294078457935, 'f1-score': 0.3127905497323273, 'support': 180122}, '2': {'precision': 0.4097194863483356, 'recall': 0.5142265227949828, 'f1-score': 0.45606263721318796, 'support': 159772}, 'accuracy': 0.40264094496311964, 'macro avg': {'precision': 0.40009621643484466, 'recall': 0.40805828130721694, 'f1-score': 0.39859878941032273, 'support': 504062}, 'weighted avg': {'precision': 0.3993523360601365, 'recall': 0.40264094496311964, 'f1-score': 0.39538173331253296, 'support': 504062}}
[[72857 40941 50370]
 [64186 47940 67996]
 [40085 37528 82159]]
training model: results/AAPL/W6/deepOF_L1/h100
Epoch 1/50
5452/5452 - 80s - loss: 3.2165 - accuracy100: 0.4186 - val_loss: 3.2855 - val_accuracy100: 0.3743 - 80s/epoch - 15ms/step
Epoch 2/50
5452/5452 - 80s - loss: 3.2115 - accuracy100: 0.4207 - val_loss: 3.2828 - val_accuracy100: 0.3742 - 80s/epoch - 15ms/step
Epoch 3/50
5452/5452 - 79s - loss: 3.2093 - accuracy100: 0.4218 - val_loss: 3.2757 - val_accuracy100: 0.3742 - 79s/epoch - 14ms/step
Epoch 4/50
5452/5452 - 80s - loss: 3.2092 - accuracy100: 0.4215 - val_loss: 3.2763 - val_accuracy100: 0.3740 - 80s/epoch - 15ms/step
Epoch 5/50
5452/5452 - 83s - loss: 3.2077 - accuracy100: 0.4221 - val_loss: 3.2719 - val_accuracy100: 0.3740 - 83s/epoch - 15ms/step
Epoch 6/50
5452/5452 - 76s - loss: 3.2068 - accuracy100: 0.4225 - val_loss: 3.2697 - val_accuracy100: 0.3740 - 76s/epoch - 14ms/step
Epoch 7/50
5452/5452 - 78s - loss: 3.2052 - accuracy100: 0.4233 - val_loss: 3.2710 - val_accuracy100: 0.3741 - 78s/epoch - 14ms/step
Epoch 8/50
5452/5452 - 79s - loss: 3.2044 - accuracy100: 0.4237 - val_loss: 3.2720 - val_accuracy100: 0.3746 - 79s/epoch - 15ms/step
Epoch 9/50
5452/5452 - 78s - loss: 3.2041 - accuracy100: 0.4239 - val_loss: 3.2706 - val_accuracy100: 0.3748 - 78s/epoch - 14ms/step
Epoch 10/50
5452/5452 - 78s - loss: 3.2039 - accuracy100: 0.4238 - val_loss: 3.2699 - val_accuracy100: 0.3754 - 78s/epoch - 14ms/step
Epoch 11/50
5452/5452 - 77s - loss: 3.2032 - accuracy100: 0.4240 - val_loss: 3.2709 - val_accuracy100: 0.3748 - 77s/epoch - 14ms/step
Epoch 12/50
5452/5452 - 77s - loss: 3.2019 - accuracy100: 0.4248 - val_loss: 3.2719 - val_accuracy100: 0.3749 - 77s/epoch - 14ms/step
Epoch 13/50
5452/5452 - 77s - loss: 3.2010 - accuracy100: 0.4254 - val_loss: 3.2714 - val_accuracy100: 0.3748 - 77s/epoch - 14ms/step
Epoch 14/50
5452/5452 - 77s - loss: 3.2002 - accuracy100: 0.4258 - val_loss: 3.2724 - val_accuracy100: 0.3745 - 77s/epoch - 14ms/step
Epoch 15/50
5452/5452 - 78s - loss: 3.1988 - accuracy100: 0.4263 - val_loss: 3.2729 - val_accuracy100: 0.3748 - 78s/epoch - 14ms/step
Epoch 16/50
5452/5452 - 80s - loss: 3.1986 - accuracy100: 0.4271 - val_loss: 3.2732 - val_accuracy100: 0.3749 - 80s/epoch - 15ms/step
testing model: results/AAPL/W6/deepOF_L1/h100
Evaluating performance on  test set...
29350/29350 - 153s - 153s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0836841
{'0': {'precision': 0.4402471800732229, 'recall': 0.00922142093129126, 'f1-score': 0.018064463467286327, 'support': 2255943}, '1': {'precision': 0.4027985008838519, 'recall': 0.9891833112433936, 'f1-score': 0.5724809784105724, 'support': 3025510}, '2': {'precision': 0.42874917053749173, 'recall': 0.006947748735856513, 'f1-score': 0.013673915861372047, 'support': 2231946}, 'accuracy': 0.40315894310950345, 'macro avg': {'precision': 0.4239316171648555, 'recall': 0.3351174936368471, 'f1-score': 0.20140645257974357, 'support': 7513399}, 'weighted avg': {'precision': 0.42175165098372946, 'recall': 0.40315894310950345, 'f1-score': 0.24001370973508493, 'support': 7513399}}
[[  20803 2228711    6429]
 [  18494 2992784   14232]
 [   7956 2208483   15507]]
Evaluating performance on  train set...
5452/5452 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1093217
{'0': {'precision': 0.4703269367448472, 'recall': 0.011284333661589357, 'f1-score': 0.022039874938072697, 'support': 469146}, '1': {'precision': 0.32873518766351634, 'recall': 0.9850634102562985, 'f1-score': 0.49295988828697423, 'support': 459074}, '2': {'precision': 0.4559953434225844, 'recall': 0.008383038739184124, 'f1-score': 0.016463413352723482, 'support': 467253}, 'accuracy': 0.3306606433804165, 'macro avg': {'precision': 0.4183524892769827, 'recall': 0.33491026088569065, 'f1-score': 0.17715439219259013, 'support': 1395473}, 'weighted avg': {'precision': 0.41894824966715366, 'recall': 0.3306606433804165, 'f1-score': 0.17509300875219483, 'support': 1395473}}
[[  5294 462124   1728]
 [  3912 452217   2945]
 [  2050 461286   3917]]
Evaluating performance on  val set...
1969/1969 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0907763
{'0': {'precision': 0.4240573552841211, 'recall': 0.009985806023998449, 'f1-score': 0.01951213552198322, 'support': 159927}, '1': {'precision': 0.3732091085653165, 'recall': 0.9861711000961595, 'f1-score': 0.5414938878978773, 'support': 188229}, '2': {'precision': 0.4396847155586018, 'recall': 0.008229317665772966, 'f1-score': 0.01615624842593059, 'support': 155906}, 'accuracy': 0.37397383655185273, 'macro avg': {'precision': 0.4123170598026798, 'recall': 0.33479540792864365, 'f1-score': 0.19238742394859706, 'support': 504062}, 'weighted avg': {'precision': 0.4099029151543737, 'recall': 0.37397383655185273, 'f1-score': 0.21339483315514146, 'support': 504062}}
[[  1597 157803    527]
 [  1495 185626   1108]
 [   674 153949   1283]]
training model: results/AAPL/W6/deepOF_L1/h200
Epoch 1/50
5452/5452 - 79s - loss: 3.1859 - accuracy200: 0.4279 - val_loss: 3.3127 - val_accuracy200: 0.3765 - 79s/epoch - 15ms/step
Epoch 2/50
5452/5452 - 77s - loss: 3.1880 - accuracy200: 0.4253 - val_loss: 3.2988 - val_accuracy200: 0.3766 - 77s/epoch - 14ms/step
Epoch 3/50
5452/5452 - 77s - loss: 3.1914 - accuracy200: 0.4257 - val_loss: 3.2990 - val_accuracy200: 0.3765 - 77s/epoch - 14ms/step
Epoch 4/50
5452/5452 - 76s - loss: 3.1900 - accuracy200: 0.4259 - val_loss: 3.2982 - val_accuracy200: 0.3765 - 76s/epoch - 14ms/step
Epoch 5/50
5452/5452 - 77s - loss: 3.1898 - accuracy200: 0.4276 - val_loss: 3.3011 - val_accuracy200: 0.3766 - 77s/epoch - 14ms/step
Epoch 6/50
5452/5452 - 78s - loss: 3.1890 - accuracy200: 0.4280 - val_loss: 3.2994 - val_accuracy200: 0.3766 - 78s/epoch - 14ms/step
Epoch 7/50
5452/5452 - 79s - loss: 3.1878 - accuracy200: 0.4279 - val_loss: 3.2999 - val_accuracy200: 0.3766 - 79s/epoch - 15ms/step
Epoch 8/50
5452/5452 - 80s - loss: 3.1884 - accuracy200: 0.4280 - val_loss: 3.2992 - val_accuracy200: 0.3766 - 80s/epoch - 15ms/step
Epoch 9/50
5452/5452 - 80s - loss: 3.1881 - accuracy200: 0.4285 - val_loss: 3.2995 - val_accuracy200: 0.3766 - 80s/epoch - 15ms/step
Epoch 10/50
5452/5452 - 78s - loss: 3.1857 - accuracy200: 0.4287 - val_loss: 3.2981 - val_accuracy200: 0.3766 - 78s/epoch - 14ms/step
Epoch 11/50
5452/5452 - 78s - loss: 3.1852 - accuracy200: 0.4289 - val_loss: 3.2985 - val_accuracy200: 0.3766 - 78s/epoch - 14ms/step
Epoch 12/50
5452/5452 - 78s - loss: 3.1849 - accuracy200: 0.4290 - val_loss: 3.2976 - val_accuracy200: 0.3766 - 78s/epoch - 14ms/step
Epoch 13/50
5452/5452 - 78s - loss: 3.1856 - accuracy200: 0.4291 - val_loss: 3.2992 - val_accuracy200: 0.3766 - 78s/epoch - 14ms/step
Epoch 14/50
5452/5452 - 79s - loss: 3.1845 - accuracy200: 0.4296 - val_loss: 3.2980 - val_accuracy200: 0.3766 - 79s/epoch - 14ms/step
Epoch 15/50
5452/5452 - 79s - loss: 3.1839 - accuracy200: 0.4301 - val_loss: 3.2983 - val_accuracy200: 0.3766 - 79s/epoch - 14ms/step
Epoch 16/50
5452/5452 - 81s - loss: 3.1819 - accuracy200: 0.4306 - val_loss: 3.2992 - val_accuracy200: 0.3766 - 81s/epoch - 15ms/step
Epoch 17/50
5452/5452 - 81s - loss: 3.1812 - accuracy200: 0.4310 - val_loss: 3.2995 - val_accuracy200: 0.3766 - 81s/epoch - 15ms/step
Epoch 18/50
5452/5452 - 79s - loss: 3.1808 - accuracy200: 0.4312 - val_loss: 3.3042 - val_accuracy200: 0.3767 - 79s/epoch - 14ms/step
Epoch 19/50
5452/5452 - 80s - loss: 3.1816 - accuracy200: 0.4315 - val_loss: 3.3060 - val_accuracy200: 0.3766 - 80s/epoch - 15ms/step
Epoch 20/50
5452/5452 - 79s - loss: 3.1800 - accuracy200: 0.4319 - val_loss: 3.3067 - val_accuracy200: 0.3766 - 79s/epoch - 14ms/step
Epoch 21/50
5452/5452 - 79s - loss: 3.1777 - accuracy200: 0.4326 - val_loss: 3.3082 - val_accuracy200: 0.3766 - 79s/epoch - 15ms/step
Epoch 22/50
5452/5452 - 82s - loss: 3.1766 - accuracy200: 0.4332 - val_loss: 3.3065 - val_accuracy200: 0.3766 - 82s/epoch - 15ms/step
testing model: results/AAPL/W6/deepOF_L1/h200
Evaluating performance on  test set...
29350/29350 - 154s - 154s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0857096
{'0': {'precision': 0.44870466321243524, 'recall': 0.000586992357802344, 'f1-score': 0.0011724509233615133, 'support': 2212976}, '1': {'precision': 0.40861610203557214, 'recall': 0.9988352780118082, 'f1-score': 0.5799705533885832, 'support': 3069402}, '2': {'precision': 0.4563029661016949, 'recall': 0.0015445842957103498, 'f1-score': 0.003078747041083762, 'support': 2231021}, 'accuracy': 0.4086794804854634, 'macro avg': {'precision': 0.43787457711656746, 'recall': 0.3336556182217736, 'f1-score': 0.1947405837843428, 'support': 7513399}, 'weighted avg': {'precision': 0.4345837657939583, 'recall': 0.4086794804854634, 'f1-score': 0.2381912808795256, 'support': 7513399}}
[[   1299 2210243    1434]
 [    903 3065827    2672]
 [    693 2226882    3446]]
Evaluating performance on  train set...
5452/5452 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1195806
{'0': {'precision': 0.463743676222597, 'recall': 0.0005906890226352033, 'f1-score': 0.0011798751906571046, 'support': 465558}, '1': {'precision': 0.3332249201080686, 'recall': 0.9982213102942473, 'f1-score': 0.4996555005791896, 'support': 464949}, '2': {'precision': 0.4512372634643377, 'recall': 0.002000146247252487, 'f1-score': 0.00398263911936569, 'support': 464966}, 'accuracy': 0.33345467809122786, 'macro avg': {'precision': 0.4160686199316677, 'recall': 0.3336040485213783, 'f1-score': 0.16827267162973747, 'support': 1395473}, 'weighted avg': {'precision': 0.41608985429178885, 'recall': 0.33345467809122786, 'f1-score': 0.1681977490453635, 'support': 1395473}}
[[   275 464804    479]
 [   175 464122    652]
 [   143 463893    930]]
Evaluating performance on  val set...
1969/1969 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0992848
{'0': {'precision': 0.4230769230769231, 'recall': 0.000483288874941158, 'f1-score': 0.0009654748694414665, 'support': 159325}, '1': {'precision': 0.37646051080862464, 'recall': 0.9982450962825553, 'f1-score': 0.5467350346433988, 'support': 189754}, '2': {'precision': 0.4225941422594142, 'recall': 0.001955053134859952, 'f1-score': 0.003892100192678227, 'support': 154983}, 'accuracy': 0.37654296495272405, 'macro avg': {'precision': 0.4073771920483206, 'recall': 0.33356114609745213, 'f1-score': 0.18386420323517283, 'support': 504062}, 'weighted avg': {'precision': 0.4053797479020464, 'recall': 0.37654296495272405, 'f1-score': 0.20732011818280116, 'support': 504062}}
[[    77 159102    146]
 [    65 189421    268]
 [    40 154640    303]]
training model: results/AAPL/W6/deepOF_L1/h300
Epoch 1/50
5452/5452 - 79s - loss: 3.2146 - accuracy300: 0.4116 - val_loss: 3.3206 - val_accuracy300: 0.3589 - 79s/epoch - 14ms/step
Epoch 2/50
5452/5452 - 76s - loss: 3.2138 - accuracy300: 0.4112 - val_loss: 3.3121 - val_accuracy300: 0.3590 - 76s/epoch - 14ms/step
Epoch 3/50
5452/5452 - 75s - loss: 3.2157 - accuracy300: 0.4107 - val_loss: 3.3105 - val_accuracy300: 0.3589 - 75s/epoch - 14ms/step
Epoch 4/50
5452/5452 - 76s - loss: 3.2159 - accuracy300: 0.4111 - val_loss: 3.3111 - val_accuracy300: 0.3589 - 76s/epoch - 14ms/step
Epoch 5/50
5452/5452 - 77s - loss: 3.2156 - accuracy300: 0.4118 - val_loss: 3.3118 - val_accuracy300: 0.3589 - 77s/epoch - 14ms/step
Epoch 6/50
5452/5452 - 76s - loss: 3.2146 - accuracy300: 0.4123 - val_loss: 3.3117 - val_accuracy300: 0.3590 - 76s/epoch - 14ms/step
Epoch 7/50
5452/5452 - 78s - loss: 3.2140 - accuracy300: 0.4130 - val_loss: 3.3132 - val_accuracy300: 0.3589 - 78s/epoch - 14ms/step
Epoch 8/50
5452/5452 - 76s - loss: 3.2133 - accuracy300: 0.4135 - val_loss: 3.3139 - val_accuracy300: 0.3590 - 76s/epoch - 14ms/step
Epoch 9/50
5452/5452 - 76s - loss: 3.2124 - accuracy300: 0.4135 - val_loss: 3.3152 - val_accuracy300: 0.3589 - 76s/epoch - 14ms/step
Epoch 10/50
5452/5452 - 75s - loss: 3.2122 - accuracy300: 0.4138 - val_loss: 3.3145 - val_accuracy300: 0.3591 - 75s/epoch - 14ms/step
Epoch 11/50
5452/5452 - 77s - loss: 3.2119 - accuracy300: 0.4143 - val_loss: 3.3154 - val_accuracy300: 0.3590 - 77s/epoch - 14ms/step
Epoch 12/50
5452/5452 - 77s - loss: 3.2116 - accuracy300: 0.4144 - val_loss: 3.3147 - val_accuracy300: 0.3590 - 77s/epoch - 14ms/step
Epoch 13/50
5452/5452 - 78s - loss: 3.2104 - accuracy300: 0.4149 - val_loss: 3.3159 - val_accuracy300: 0.3590 - 78s/epoch - 14ms/step
testing model: results/AAPL/W6/deepOF_L1/h300
Evaluating performance on  test set...
29350/29350 - 172s - 172s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.084099
{'0': {'precision': 0.4010647737355812, 'recall': 0.0008200770092226913, 'f1-score': 0.001636807157772186, 'support': 2204671}, '1': {'precision': 0.412523931845887, 'recall': 0.9989878026508794, 'f1-score': 0.5839219981583055, 'support': 3099198}, '2': {'precision': 0.4035982814178303, 'recall': 0.0006802351631342412, 'f1-score': 0.0013581812119169332, 'support': 2209530}, 'accuracy': 0.41251263243173963, 'macro avg': {'precision': 0.4057289956664328, 'recall': 0.3334960382744121, 'f1-score': 0.1956389955093315, 'support': 7513399}, 'weighted avg': {'precision': 0.4065366062745297, 'recall': 0.41251263243173963, 'f1-score': 0.24174138126495393, 'support': 7513399}}
[[   1808 2202076     787]
 [   1703 3096061    1434]
 [    997 2207030    1503]]
Evaluating performance on  train set...
5452/5452 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1209381
{'0': {'precision': 0.46331236897274636, 'recall': 0.0009343779199309998, 'f1-score': 0.0018649946413049898, 'support': 473042}, '1': {'precision': 0.3229171226001158, 'recall': 0.9987195249148939, 'f1-score': 0.4880367624134145, 'support': 450614}, '2': {'precision': 0.43006993006993005, 'recall': 0.0007820828838299595, 'f1-score': 0.0015613264928333423, 'support': 471817}, 'accuracy': 0.32307898468834584, 'macro avg': {'precision': 0.40543314054759744, 'recall': 0.3334786619062183, 'f1-score': 0.16382102784918426, 'support': 1395473}, 'weighted avg': {'precision': 0.4067377083775456, 'recall': 0.32307898468834584, 'f1-score': 0.15875268015586091, 'support': 1395473}}
[[   442 472405    195]
 [   283 450037    294]
 [   229 471219    369]]
Evaluating performance on  val set...
1969/1969 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1062028
{'0': {'precision': 0.40418118466898956, 'recall': 0.00070887313615253, 'f1-score': 0.0014152641114642496, 'support': 163640}, '1': {'precision': 0.3588765816813936, 'recall': 0.9986901083838591, 'f1-score': 0.5280130911853659, 'support': 180931}, '2': {'precision': 0.3442028985507246, 'recall': 0.0005956448953232471, 'f1-score': 0.00118923181883618, 'support': 159491}, 'accuracy': 0.3588943423626459, 'macro avg': {'precision': 0.36908688830036923, 'recall': 0.33333154213844496, 'f1-score': 0.17687252903855544, 'support': 504062}, 'weighted avg': {'precision': 0.3689414642488092, 'recall': 0.3588943423626459, 'f1-score': 0.19036388815756286, 'support': 504062}}
[[   116 163465     59]
 [   115 180694    122]
 [    56 159340     95]]
training model: results/AAPL/W6/deepOF_L1/h500
Epoch 1/50
5452/5452 - 81s - loss: 3.2204 - accuracy500: 0.4105 - val_loss: 3.3043 - val_accuracy500: 0.3720 - 81s/epoch - 15ms/step
Epoch 2/50
5452/5452 - 76s - loss: 3.2196 - accuracy500: 0.4084 - val_loss: 3.3016 - val_accuracy500: 0.3722 - 76s/epoch - 14ms/step
Epoch 3/50
5452/5452 - 75s - loss: 3.2198 - accuracy500: 0.4097 - val_loss: 3.3014 - val_accuracy500: 0.3722 - 75s/epoch - 14ms/step
Epoch 4/50
5452/5452 - 77s - loss: 3.2198 - accuracy500: 0.4095 - val_loss: 3.3001 - val_accuracy500: 0.3722 - 77s/epoch - 14ms/step
Epoch 5/50
5452/5452 - 77s - loss: 3.2203 - accuracy500: 0.4096 - val_loss: 3.2990 - val_accuracy500: 0.3722 - 77s/epoch - 14ms/step
Epoch 6/50
5452/5452 - 78s - loss: 3.2200 - accuracy500: 0.4105 - val_loss: 3.3005 - val_accuracy500: 0.3722 - 78s/epoch - 14ms/step
Epoch 7/50
5452/5452 - 77s - loss: 3.2194 - accuracy500: 0.4101 - val_loss: 3.3008 - val_accuracy500: 0.3722 - 77s/epoch - 14ms/step
Epoch 8/50
5452/5452 - 75s - loss: 3.2186 - accuracy500: 0.4109 - val_loss: 3.3009 - val_accuracy500: 0.3722 - 75s/epoch - 14ms/step
Epoch 9/50
5452/5452 - 76s - loss: 3.2179 - accuracy500: 0.4113 - val_loss: 3.3014 - val_accuracy500: 0.3722 - 76s/epoch - 14ms/step
Epoch 10/50
5452/5452 - 76s - loss: 3.2172 - accuracy500: 0.4119 - val_loss: 3.3012 - val_accuracy500: 0.3722 - 76s/epoch - 14ms/step
Epoch 11/50
5452/5452 - 75s - loss: 3.2160 - accuracy500: 0.4126 - val_loss: 3.3014 - val_accuracy500: 0.3722 - 75s/epoch - 14ms/step
Epoch 12/50
5452/5452 - 76s - loss: 3.2157 - accuracy500: 0.4128 - val_loss: 3.3012 - val_accuracy500: 0.3722 - 76s/epoch - 14ms/step
Epoch 13/50
5452/5452 - 78s - loss: 3.2155 - accuracy500: 0.4132 - val_loss: 3.3012 - val_accuracy500: 0.3722 - 78s/epoch - 14ms/step
Epoch 14/50
5452/5452 - 79s - loss: 3.2146 - accuracy500: 0.4136 - val_loss: 3.3019 - val_accuracy500: 0.3722 - 79s/epoch - 14ms/step
Epoch 15/50
5452/5452 - 75s - loss: 3.2140 - accuracy500: 0.4142 - val_loss: 3.3028 - val_accuracy500: 0.3722 - 75s/epoch - 14ms/step
testing model: results/AAPL/W6/deepOF_L1/h500
Evaluating performance on  test set...
29350/29350 - 156s - 156s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0943012
{'0': {'precision': 0.3992779783393502, 'recall': 0.00024125999669303658, 'f1-score': 0.0004822286112426412, 'support': 2292133}, '1': {'precision': 0.3876688918166984, 'recall': 0.999649791540131, 'f1-score': 0.5586793164977215, 'support': 2912551}, '2': {'precision': 0.4165159734779988, 'recall': 0.0002993006932427779, 'f1-score': 0.0005981715514457832, 'support': 2308715}, 'accuracy': 0.38767740139981915, 'macro avg': {'precision': 0.4011542812113491, 'recall': 0.33339678407668893, 'f1-score': 0.18658657222013666, 'support': 7513399}, 'weighted avg': {'precision': 0.40007462994615145, 'recall': 0.38767740139981915, 'f1-score': 0.21690161026873786, 'support': 7513399}}
[[    553 2291155     425]
 [    477 2911531     543]
 [    355 2307669     691]]
Evaluating performance on  train set...
5452/5452 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1169091
{'0': {'precision': 0.41007194244604317, 'recall': 0.0002432, 'f1-score': 0.0004861117033524651, 'support': 468750}, '1': {'precision': 0.32901611982758866, 'recall': 0.9995426062297031, 'f1-score': 0.4950712730328648, 'support': 459123}, '2': {'precision': 0.4296675191815857, 'recall': 0.0003592814371257485, 'f1-score': 0.000717962524920351, 'support': 467600}, 'accuracy': 0.329060469102591, 'macro avg': {'precision': 0.38958519381840584, 'recall': 0.333381695888943, 'f1-score': 0.16542511575371252, 'support': 1395473}, 'weighted avg': {'precision': 0.3899700123001263, 'recall': 0.329060469102591, 'f1-score': 0.16328670796659428, 'support': 1395473}}
[[   114 468534    102]
 [    89 458913    121]
 [    75 467357    168]]
Evaluating performance on  val set...
1969/1969 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1005807
{'0': {'precision': 0.38144329896907214, 'recall': 0.00023017966455979696, 'f1-score': 0.0004600816955875679, 'support': 160744}, '1': {'precision': 0.37219784341861617, 'recall': 0.99954695178501, 'f1-score': 0.5424175417334929, 'support': 187618}, '2': {'precision': 0.35714285714285715, 'recall': 0.0002569043031470777, 'f1-score': 0.0005134392729699895, 'support': 155700}, 'accuracy': 0.3721962774420607, 'macro avg': {'precision': 0.3702613331768485, 'recall': 0.33334467858423894, 'f1-score': 0.1811303542340168, 'support': 504062}, 'weighted avg': {'precision': 0.37049585069523455, 'recall': 0.3721962774420607, 'f1-score': 0.2021997139475529, 'support': 504062}}
[[    37 160684     23]
 [    36 187533     49]
 [    24 155636     40]]
training model: results/AAPL/W6/deepOF_L1/h1000
Epoch 1/50
5452/5452 - 80s - loss: 3.2111 - accuracy1000: 0.4126 - val_loss: 3.2876 - val_accuracy1000: 0.3743 - 80s/epoch - 15ms/step
Epoch 2/50
5452/5452 - 78s - loss: 3.2098 - accuracy1000: 0.4108 - val_loss: 3.2851 - val_accuracy1000: 0.3748 - 78s/epoch - 14ms/step
Epoch 3/50
5452/5452 - 75s - loss: 3.2097 - accuracy1000: 0.4119 - val_loss: 3.2848 - val_accuracy1000: 0.3749 - 75s/epoch - 14ms/step
Epoch 4/50
5452/5452 - 74s - loss: 3.2077 - accuracy1000: 0.4139 - val_loss: 3.2856 - val_accuracy1000: 0.3748 - 74s/epoch - 14ms/step
Epoch 5/50
5452/5452 - 75s - loss: 3.2080 - accuracy1000: 0.4151 - val_loss: 3.2865 - val_accuracy1000: 0.3747 - 75s/epoch - 14ms/step
Epoch 6/50
5452/5452 - 75s - loss: 3.2072 - accuracy1000: 0.4162 - val_loss: 3.2874 - val_accuracy1000: 0.3747 - 75s/epoch - 14ms/step
Epoch 7/50
5452/5452 - 75s - loss: 3.2065 - accuracy1000: 0.4166 - val_loss: 3.2869 - val_accuracy1000: 0.3749 - 75s/epoch - 14ms/step
Epoch 8/50
5452/5452 - 76s - loss: 3.2056 - accuracy1000: 0.4173 - val_loss: 3.2873 - val_accuracy1000: 0.3749 - 76s/epoch - 14ms/step
Epoch 9/50
5452/5452 - 75s - loss: 3.2051 - accuracy1000: 0.4176 - val_loss: 3.2871 - val_accuracy1000: 0.3748 - 75s/epoch - 14ms/step
Epoch 10/50
5452/5452 - 76s - loss: 3.2044 - accuracy1000: 0.4184 - val_loss: 3.2874 - val_accuracy1000: 0.3748 - 76s/epoch - 14ms/step
Epoch 11/50
5452/5452 - 74s - loss: 3.2036 - accuracy1000: 0.4189 - val_loss: 3.2873 - val_accuracy1000: 0.3745 - 74s/epoch - 14ms/step
Epoch 12/50
5452/5452 - 75s - loss: 3.2029 - accuracy1000: 0.4198 - val_loss: 3.2875 - val_accuracy1000: 0.3745 - 75s/epoch - 14ms/step
Epoch 13/50
5452/5452 - 77s - loss: 3.2023 - accuracy1000: 0.4197 - val_loss: 3.2874 - val_accuracy1000: 0.3744 - 77s/epoch - 14ms/step
testing model: results/AAPL/W6/deepOF_L1/h1000
Evaluating performance on  test set...
29350/29350 - 182s - 182s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0892552
{'0': {'precision': 0.3186975266621284, 'recall': 0.0012584009124638584, 'f1-score': 0.0025069031312639108, 'support': 2232198}, '1': {'precision': 0.4015170037674995, 'recall': 0.9980388542266919, 'f1-score': 0.5726524855777678, 'support': 3016094}, '2': {'precision': 0.3422721268163805, 'recall': 0.0011438753224461361, 'f1-score': 0.002280130436485255, 'support': 2265107}, 'accuracy': 0.4013601567013811, 'macro avg': {'precision': 0.3541622190820028, 'recall': 0.33348037682053394, 'f1-score': 0.19247983971517232, 'support': 7513399}, 'weighted avg': {'precision': 0.35905081015103196, 'recall': 0.4013601567013811, 'f1-score': 0.23131133717304098, 'support': 7513399}}
[[   2809 2227095    2294]
 [   3230 3010179    2685]
 [   2775 2259741    2591]]
Evaluating performance on  train set...
5452/5452 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1035266
{'0': {'precision': 0.3598502573701451, 'recall': 0.0016513592039117241, 'f1-score': 0.0032876314090642855, 'support': 465677}, '1': {'precision': 0.33184084072211817, 'recall': 0.9970174911939322, 'f1-score': 0.4979479219811262, 'support': 463033}, '2': {'precision': 0.36727103672710365, 'recall': 0.0016925077608979289, 'f1-score': 0.0033694877952033845, 'support': 466763}, 'accuracy': 0.3319383463528137, 'macro avg': {'precision': 0.3529873782731223, 'recall': 0.3334537860529139, 'f1-score': 0.16820168039513128, 'support': 1395473}, 'weighted avg': {'precision': 0.3530385605592474, 'recall': 0.3319383463528137, 'f1-score': 0.16744863334662738, 'support': 1395473}}
[[   769 464249    659]
 [   679 461652    702]
 [   689 465284    790]]
Evaluating performance on  val set...
1969/1969 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0949557
{'0': {'precision': 0.3458755426917511, 'recall': 0.0014877802816199999, 'f1-score': 0.0029628160388761138, 'support': 160642}, '1': {'precision': 0.3750184004169435, 'recall': 0.9972440424237615, 'f1-score': 0.5450631802483842, 'support': 189045}, '2': {'precision': 0.3443609022556391, 'recall': 0.0014834008097165993, 'f1-score': 0.0029540763673890614, 'support': 154375}, 'accuracy': 0.3749380036582801, 'macro avg': {'precision': 0.35508494845477784, 'recall': 0.3334050745050327, 'f1-score': 0.18366002421821648, 'support': 504062}, 'weighted avg': {'precision': 0.35634149513675634, 'recall': 0.3749380036582801, 'f1-score': 0.20627116732344158, 'support': 504062}}
[[   239 160220    183]
 [   268 188524    253]
 [   184 153962    229]]
training model: results/AAPL/W6/deepLOB_L2/h10
Epoch 1/50
5452/5452 - 224s - loss: 3.0353 - accuracy10: 0.4805 - val_loss: 3.2048 - val_accuracy10: 0.4464 - 224s/epoch - 41ms/step
Epoch 2/50
5452/5452 - 220s - loss: 2.9391 - accuracy10: 0.5096 - val_loss: 3.0823 - val_accuracy10: 0.4747 - 220s/epoch - 40ms/step
Epoch 3/50
5452/5452 - 220s - loss: 2.8939 - accuracy10: 0.5248 - val_loss: 3.0478 - val_accuracy10: 0.4851 - 220s/epoch - 40ms/step
Epoch 4/50
5452/5452 - 221s - loss: 2.8709 - accuracy10: 0.5313 - val_loss: 2.9921 - val_accuracy10: 0.4985 - 221s/epoch - 41ms/step
Epoch 5/50
5452/5452 - 220s - loss: 2.8544 - accuracy10: 0.5358 - val_loss: 2.9930 - val_accuracy10: 0.4995 - 220s/epoch - 40ms/step
Epoch 6/50
5452/5452 - 221s - loss: 2.8426 - accuracy10: 0.5383 - val_loss: 2.9881 - val_accuracy10: 0.5014 - 221s/epoch - 41ms/step
Epoch 7/50
5452/5452 - 219s - loss: 2.8329 - accuracy10: 0.5407 - val_loss: 2.9401 - val_accuracy10: 0.5130 - 219s/epoch - 40ms/step
Epoch 8/50
5452/5452 - 220s - loss: 2.8250 - accuracy10: 0.5426 - val_loss: 2.9277 - val_accuracy10: 0.5141 - 220s/epoch - 40ms/step
Epoch 9/50
5452/5452 - 222s - loss: 2.8185 - accuracy10: 0.5441 - val_loss: 2.9109 - val_accuracy10: 0.5182 - 222s/epoch - 41ms/step
Epoch 10/50
5452/5452 - 219s - loss: 2.8132 - accuracy10: 0.5449 - val_loss: 2.9093 - val_accuracy10: 0.5182 - 219s/epoch - 40ms/step
Epoch 11/50
5452/5452 - 219s - loss: 2.8084 - accuracy10: 0.5465 - val_loss: 2.9076 - val_accuracy10: 0.5185 - 219s/epoch - 40ms/step
Epoch 12/50
5452/5452 - 220s - loss: 2.8041 - accuracy10: 0.5472 - val_loss: 2.9039 - val_accuracy10: 0.5211 - 220s/epoch - 40ms/step
Epoch 13/50
5452/5452 - 219s - loss: 2.7998 - accuracy10: 0.5484 - val_loss: 2.9020 - val_accuracy10: 0.5203 - 219s/epoch - 40ms/step
Epoch 14/50
5452/5452 - 218s - loss: 2.7965 - accuracy10: 0.5490 - val_loss: 2.8974 - val_accuracy10: 0.5228 - 218s/epoch - 40ms/step
Epoch 15/50
5452/5452 - 219s - loss: 2.7933 - accuracy10: 0.5498 - val_loss: 2.9014 - val_accuracy10: 0.5221 - 219s/epoch - 40ms/step
Epoch 16/50
5452/5452 - 219s - loss: 2.7907 - accuracy10: 0.5504 - val_loss: 2.9028 - val_accuracy10: 0.5230 - 219s/epoch - 40ms/step
Epoch 17/50
5452/5452 - 221s - loss: 2.7873 - accuracy10: 0.5511 - val_loss: 2.8960 - val_accuracy10: 0.5235 - 221s/epoch - 40ms/step
Epoch 18/50
5452/5452 - 222s - loss: 2.7849 - accuracy10: 0.5517 - val_loss: 2.8972 - val_accuracy10: 0.5243 - 222s/epoch - 41ms/step
Epoch 19/50
5452/5452 - 222s - loss: 2.7821 - accuracy10: 0.5521 - val_loss: 2.8954 - val_accuracy10: 0.5254 - 222s/epoch - 41ms/step
Epoch 20/50
5452/5452 - 223s - loss: 2.7806 - accuracy10: 0.5527 - val_loss: 2.8948 - val_accuracy10: 0.5247 - 223s/epoch - 41ms/step
Epoch 21/50
5452/5452 - 222s - loss: 2.7780 - accuracy10: 0.5530 - val_loss: 2.8947 - val_accuracy10: 0.5259 - 222s/epoch - 41ms/step
Epoch 22/50
5452/5452 - 222s - loss: 2.7758 - accuracy10: 0.5533 - val_loss: 2.8932 - val_accuracy10: 0.5259 - 222s/epoch - 41ms/step
Epoch 23/50
5452/5452 - 224s - loss: 2.7736 - accuracy10: 0.5542 - val_loss: 2.8974 - val_accuracy10: 0.5259 - 224s/epoch - 41ms/step
Epoch 24/50
5452/5452 - 223s - loss: 2.7715 - accuracy10: 0.5542 - val_loss: 2.8969 - val_accuracy10: 0.5255 - 223s/epoch - 41ms/step
Epoch 25/50
5452/5452 - 223s - loss: 2.7694 - accuracy10: 0.5550 - val_loss: 2.9015 - val_accuracy10: 0.5250 - 223s/epoch - 41ms/step
Epoch 26/50
5452/5452 - 223s - loss: 2.7676 - accuracy10: 0.5556 - val_loss: 2.9058 - val_accuracy10: 0.5244 - 223s/epoch - 41ms/step
Epoch 27/50
5452/5452 - 224s - loss: 2.7659 - accuracy10: 0.5558 - val_loss: 2.9017 - val_accuracy10: 0.5257 - 224s/epoch - 41ms/step
Epoch 28/50
5452/5452 - 225s - loss: 2.7636 - accuracy10: 0.5564 - val_loss: 2.9042 - val_accuracy10: 0.5252 - 225s/epoch - 41ms/step
Epoch 29/50
5452/5452 - 222s - loss: 2.7622 - accuracy10: 0.5566 - val_loss: 2.9036 - val_accuracy10: 0.5247 - 222s/epoch - 41ms/step
Epoch 30/50
5452/5452 - 223s - loss: 2.7608 - accuracy10: 0.5569 - val_loss: 2.9005 - val_accuracy10: 0.5258 - 223s/epoch - 41ms/step
Epoch 31/50
5452/5452 - 223s - loss: 2.7589 - accuracy10: 0.5572 - val_loss: 2.9032 - val_accuracy10: 0.5251 - 223s/epoch - 41ms/step
Epoch 32/50
5452/5452 - 223s - loss: 2.7569 - accuracy10: 0.5579 - val_loss: 2.8924 - val_accuracy10: 0.5275 - 223s/epoch - 41ms/step
Epoch 33/50
5452/5452 - 224s - loss: 2.7556 - accuracy10: 0.5578 - val_loss: 2.9078 - val_accuracy10: 0.5265 - 224s/epoch - 41ms/step
Epoch 34/50
5452/5452 - 223s - loss: 2.7541 - accuracy10: 0.5583 - val_loss: 2.8951 - val_accuracy10: 0.5279 - 223s/epoch - 41ms/step
Epoch 35/50
5452/5452 - 223s - loss: 2.7525 - accuracy10: 0.5588 - val_loss: 2.9073 - val_accuracy10: 0.5258 - 223s/epoch - 41ms/step
Epoch 36/50
5452/5452 - 223s - loss: 2.7510 - accuracy10: 0.5591 - val_loss: 2.9044 - val_accuracy10: 0.5278 - 223s/epoch - 41ms/step
Epoch 37/50
5452/5452 - 224s - loss: 2.7495 - accuracy10: 0.5594 - val_loss: 2.9111 - val_accuracy10: 0.5259 - 224s/epoch - 41ms/step
Epoch 38/50
5452/5452 - 226s - loss: 2.7480 - accuracy10: 0.5601 - val_loss: 2.9027 - val_accuracy10: 0.5262 - 226s/epoch - 41ms/step
Epoch 39/50
5452/5452 - 223s - loss: 2.7469 - accuracy10: 0.5599 - val_loss: 2.9090 - val_accuracy10: 0.5263 - 223s/epoch - 41ms/step
Epoch 40/50
5452/5452 - 224s - loss: 2.7457 - accuracy10: 0.5602 - val_loss: 2.9133 - val_accuracy10: 0.5256 - 224s/epoch - 41ms/step
Epoch 41/50
5452/5452 - 223s - loss: 2.7436 - accuracy10: 0.5608 - val_loss: 2.8977 - val_accuracy10: 0.5282 - 223s/epoch - 41ms/step
Epoch 42/50
5452/5452 - 225s - loss: 2.7428 - accuracy10: 0.5608 - val_loss: 2.9066 - val_accuracy10: 0.5270 - 225s/epoch - 41ms/step
testing model: results/AAPL/W6/deepLOB_L2/h10
Evaluating performance on  test set...
29350/29350 - 427s - 427s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1054019
{'0': {'precision': 0.4520765602682761, 'recall': 0.5471628355244376, 'f1-score': 0.49509555694466933, 'support': 2469455}, '1': {'precision': 0.42982577722502807, 'recall': 0.58835900866503, 'f1-score': 0.4967504360531672, 'support': 2535248}, '2': {'precision': 0.5361851840609515, 'recall': 0.22531780391525336, 'f1-score': 0.3172989996679687, 'support': 2508701}, 'accuracy': 0.4536006582369323, 'macro avg': {'precision': 0.4726958405180852, 'recall': 0.45361321603490695, 'f1-score': 0.4363816642219351, 'support': 7513404}, 'weighted avg': {'precision': 0.4726520724340641, 'recall': 0.4536006582369323, 'f1-score': 0.43628827437520346, 'support': 7513404}}
[[1351194  880493  237768]
 [ 792419 1491636  251193]
 [ 845248 1098198  565255]]
Evaluating performance on  train set...
5452/5452 - 77s - 77s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98305917
{'0': {'precision': 0.505778251776802, 'recall': 0.5272424066080099, 'f1-score': 0.5162873375518813, 'support': 460532}, '1': {'precision': 0.5008149672734711, 'recall': 0.6590681115137037, 'f1-score': 0.5691455987854587, 'support': 475529}, '2': {'precision': 0.549727734481556, 'recall': 0.3465392870047495, 'f1-score': 0.4251015659107021, 'support': 459414}, 'accuracy': 0.5126734624411042, 'macro avg': {'precision': 0.5187736511772764, 'recall': 0.5109499350421544, 'f1-score': 0.5035115007493474, 'support': 1395475}, 'weighted avg': {'precision': 0.5185558521857935, 'recall': 0.5126734624411042, 'f1-score': 0.5042796813870493, 'support': 1395475}}
[[242812 150227  67493]
 [ 99214 313406  62909]
 [138050 162159 159205]]
Evaluating performance on  val set...
1969/1969 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9626166
{'0': {'precision': 0.5192099016615802, 'recall': 0.4091577147132703, 'f1-score': 0.45766080822572935, 'support': 149688}, '1': {'precision': 0.534148529038667, 'recall': 0.7248104113733781, 'f1-score': 0.6150421632341536, 'support': 206236}, '2': {'precision': 0.5194066935210632, 'recall': 0.37254200446877594, 'f1-score': 0.43388327417243533, 'support': 148139}, 'accuracy': 0.5275451679651155, 'macro avg': {'precision': 0.5242550414071036, 'recall': 0.5021700435184747, 'f1-score': 0.5021954152107728, 'support': 504063}, 'weighted avg': {'precision': 0.5253798353901278, 'recall': 0.5275451679651155, 'f1-score': 0.5150649839228079, 'support': 504063}}
[[ 61246  65355  23087]
 [ 28777 149482  27977]
 [ 27937  65014  55188]]
training model: results/AAPL/W6/deepLOB_L2/h20
Epoch 1/50
5452/5452 - 221s - loss: 3.1121 - accuracy20: 0.4565 - val_loss: 3.2689 - val_accuracy20: 0.3955 - 221s/epoch - 41ms/step
Epoch 2/50
5452/5452 - 220s - loss: 3.0455 - accuracy20: 0.4784 - val_loss: 3.1293 - val_accuracy20: 0.4481 - 220s/epoch - 40ms/step
Epoch 3/50
5452/5452 - 222s - loss: 3.0100 - accuracy20: 0.4913 - val_loss: 3.0840 - val_accuracy20: 0.4677 - 222s/epoch - 41ms/step
Epoch 4/50
5452/5452 - 220s - loss: 2.9928 - accuracy20: 0.4971 - val_loss: 3.0701 - val_accuracy20: 0.4719 - 220s/epoch - 40ms/step
Epoch 5/50
5452/5452 - 222s - loss: 2.9810 - accuracy20: 0.5012 - val_loss: 3.0724 - val_accuracy20: 0.4725 - 222s/epoch - 41ms/step
Epoch 6/50
5452/5452 - 222s - loss: 2.9726 - accuracy20: 0.5034 - val_loss: 3.0639 - val_accuracy20: 0.4761 - 222s/epoch - 41ms/step
Epoch 7/50
5452/5452 - 220s - loss: 2.9648 - accuracy20: 0.5056 - val_loss: 3.0561 - val_accuracy20: 0.4803 - 220s/epoch - 40ms/step
Epoch 8/50
5452/5452 - 220s - loss: 2.9582 - accuracy20: 0.5075 - val_loss: 3.0479 - val_accuracy20: 0.4801 - 220s/epoch - 40ms/step
Epoch 9/50
5452/5452 - 223s - loss: 2.9524 - accuracy20: 0.5088 - val_loss: 3.0431 - val_accuracy20: 0.4822 - 223s/epoch - 41ms/step
Epoch 10/50
5452/5452 - 223s - loss: 2.9474 - accuracy20: 0.5106 - val_loss: 3.0446 - val_accuracy20: 0.4819 - 223s/epoch - 41ms/step
Epoch 11/50
5452/5452 - 221s - loss: 2.9427 - accuracy20: 0.5115 - val_loss: 3.0401 - val_accuracy20: 0.4841 - 221s/epoch - 41ms/step
Epoch 12/50
5452/5452 - 220s - loss: 2.9387 - accuracy20: 0.5124 - val_loss: 3.0405 - val_accuracy20: 0.4842 - 220s/epoch - 40ms/step
Epoch 13/50
5452/5452 - 220s - loss: 2.9346 - accuracy20: 0.5131 - val_loss: 3.0424 - val_accuracy20: 0.4844 - 220s/epoch - 40ms/step
Epoch 14/50
5452/5452 - 221s - loss: 2.9317 - accuracy20: 0.5141 - val_loss: 3.0409 - val_accuracy20: 0.4841 - 221s/epoch - 40ms/step
Epoch 15/50
5452/5452 - 219s - loss: 2.9285 - accuracy20: 0.5150 - val_loss: 3.0429 - val_accuracy20: 0.4851 - 219s/epoch - 40ms/step
Epoch 16/50
5452/5452 - 223s - loss: 2.9262 - accuracy20: 0.5154 - val_loss: 3.0488 - val_accuracy20: 0.4839 - 223s/epoch - 41ms/step
Epoch 17/50
5452/5452 - 224s - loss: 2.9235 - accuracy20: 0.5161 - val_loss: 3.0347 - val_accuracy20: 0.4855 - 224s/epoch - 41ms/step
Epoch 18/50
5452/5452 - 220s - loss: 2.9213 - accuracy20: 0.5165 - val_loss: 3.0367 - val_accuracy20: 0.4866 - 220s/epoch - 40ms/step
Epoch 19/50
5452/5452 - 221s - loss: 2.9193 - accuracy20: 0.5173 - val_loss: 3.0309 - val_accuracy20: 0.4855 - 221s/epoch - 40ms/step
Epoch 20/50
5452/5452 - 220s - loss: 2.9175 - accuracy20: 0.5173 - val_loss: 3.0359 - val_accuracy20: 0.4850 - 220s/epoch - 40ms/step
Epoch 21/50
5452/5452 - 220s - loss: 2.9153 - accuracy20: 0.5181 - val_loss: 3.0336 - val_accuracy20: 0.4858 - 220s/epoch - 40ms/step
Epoch 22/50
5452/5452 - 220s - loss: 2.9132 - accuracy20: 0.5188 - val_loss: 3.0301 - val_accuracy20: 0.4864 - 220s/epoch - 40ms/step
Epoch 23/50
5452/5452 - 220s - loss: 2.9113 - accuracy20: 0.5189 - val_loss: 3.0280 - val_accuracy20: 0.4852 - 220s/epoch - 40ms/step
Epoch 24/50
5452/5452 - 221s - loss: 2.9093 - accuracy20: 0.5194 - val_loss: 3.0330 - val_accuracy20: 0.4841 - 221s/epoch - 40ms/step
Epoch 25/50
5452/5452 - 220s - loss: 2.9073 - accuracy20: 0.5205 - val_loss: 3.0291 - val_accuracy20: 0.4852 - 220s/epoch - 40ms/step
Epoch 26/50
5452/5452 - 221s - loss: 2.9059 - accuracy20: 0.5206 - val_loss: 3.0324 - val_accuracy20: 0.4857 - 221s/epoch - 41ms/step
Epoch 27/50
5452/5452 - 220s - loss: 2.9045 - accuracy20: 0.5210 - val_loss: 3.0380 - val_accuracy20: 0.4844 - 220s/epoch - 40ms/step
Epoch 28/50
5452/5452 - 221s - loss: 2.9030 - accuracy20: 0.5213 - val_loss: 3.0356 - val_accuracy20: 0.4843 - 221s/epoch - 40ms/step
Epoch 29/50
5452/5452 - 221s - loss: 2.9016 - accuracy20: 0.5215 - val_loss: 3.0302 - val_accuracy20: 0.4852 - 221s/epoch - 41ms/step
Epoch 30/50
5452/5452 - 220s - loss: 2.8999 - accuracy20: 0.5222 - val_loss: 3.0544 - val_accuracy20: 0.4827 - 220s/epoch - 40ms/step
Epoch 31/50
5452/5452 - 220s - loss: 2.8982 - accuracy20: 0.5227 - val_loss: 3.0443 - val_accuracy20: 0.4835 - 220s/epoch - 40ms/step
Epoch 32/50
5452/5452 - 221s - loss: 2.8967 - accuracy20: 0.5229 - val_loss: 3.0660 - val_accuracy20: 0.4816 - 221s/epoch - 41ms/step
Epoch 33/50
5452/5452 - 225s - loss: 2.8955 - accuracy20: 0.5232 - val_loss: 3.0642 - val_accuracy20: 0.4821 - 225s/epoch - 41ms/step
testing model: results/AAPL/W6/deepLOB_L2/h20
Evaluating performance on  test set...
29350/29350 - 391s - 391s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0884386
{'0': {'precision': 0.4011133383607586, 'recall': 0.5627886065881216, 'f1-score': 0.46839207652378606, 'support': 2322149}, '1': {'precision': 0.4432733198499931, 'recall': 0.5336666232761327, 'f1-score': 0.48428806183474127, 'support': 2896177}, '2': {'precision': 0.46968586980141913, 'recall': 0.15727352185851637, 'f1-score': 0.23564253727908616, 'support': 2295078}, 'accuracy': 0.42769256118797816, 'macro avg': {'precision': 0.4380241760040569, 'recall': 0.4179095839075902, 'f1-score': 0.39610755854587115, 'support': 7513404}, 'weighted avg': {'precision': 0.4383111353943422, 'recall': 0.42769256118797816, 'f1-score': 0.4034227550310617, 'support': 7513404}}
[[1306879  871996  143274]
 [1086310 1545593  264274]
 [ 864940 1069183  360955]]
Evaluating performance on  train set...
5452/5452 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0264132
{'0': {'precision': 0.48660011393424185, 'recall': 0.4980056710368359, 'f1-score': 0.4922368321724642, 'support': 464818}, '1': {'precision': 0.44782710561280953, 'recall': 0.6228334758924954, 'f1-score': 0.5210273313612598, 'support': 466473}, '2': {'precision': 0.5252623654961697, 'recall': 0.3066542577943229, 'f1-score': 0.3872357789928996, 'support': 464184}, 'accuracy': 0.4760823375553127, 'macro avg': {'precision': 0.486563195014407, 'recall': 0.47583113490788476, 'f1-score': 0.46683331417554125, 'support': 1395475}, 'weighted avg': {'precision': 0.48649967291473123, 'recall': 0.4760823375553127, 'f1-score': 0.4669337501817385, 'support': 1395475}}
[[231482 171857  61479]
 [108765 290535  67173]
 [135466 186374 142344]]
Evaluating performance on  val set...
1969/1969 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0090892
{'0': {'precision': 0.5102531610444627, 'recall': 0.354927746966402, 'f1-score': 0.4186477143800348, 'support': 155426}, '1': {'precision': 0.47110339984302063, 'recall': 0.7032452015724967, 'f1-score': 0.5642297440210771, 'support': 194595}, '2': {'precision': 0.4996017673942313, 'recall': 0.3420560626322691, 'f1-score': 0.4060838201519799, 'support': 154042}, 'accuracy': 0.4854631266329804, 'macro avg': {'precision': 0.4936527760939049, 'recall': 0.46674300372372257, 'f1-score': 0.4629870928510306, 'support': 504063}, 'weighted avg': {'precision': 0.4918842076365284, 'recall': 0.4854631266329804, 'f1-score': 0.47101054931003483, 'support': 504063}}
[[ 55165  76928  23333]
 [ 28305 136848  29442]
 [ 24643  76708  52691]]
training model: results/AAPL/W6/deepLOB_L2/h30
Epoch 1/50
5452/5452 - 232s - loss: 3.1551 - accuracy30: 0.4364 - val_loss: 3.3075 - val_accuracy30: 0.3800 - 232s/epoch - 42ms/step
Epoch 2/50
5452/5452 - 228s - loss: 3.1080 - accuracy30: 0.4570 - val_loss: 3.3171 - val_accuracy30: 0.3777 - 228s/epoch - 42ms/step
Epoch 3/50
5452/5452 - 223s - loss: 3.0824 - accuracy30: 0.4673 - val_loss: 3.2883 - val_accuracy30: 0.4005 - 223s/epoch - 41ms/step
Epoch 4/50
5452/5452 - 228s - loss: 3.0661 - accuracy30: 0.4738 - val_loss: 3.2405 - val_accuracy30: 0.4079 - 228s/epoch - 42ms/step
Epoch 5/50
5452/5452 - 220s - loss: 3.0541 - accuracy30: 0.4785 - val_loss: 3.2459 - val_accuracy30: 0.4131 - 220s/epoch - 40ms/step
Epoch 6/50
5452/5452 - 223s - loss: 3.0457 - accuracy30: 0.4820 - val_loss: 3.2302 - val_accuracy30: 0.4163 - 223s/epoch - 41ms/step
Epoch 7/50
5452/5452 - 227s - loss: 3.0396 - accuracy30: 0.4836 - val_loss: 3.2300 - val_accuracy30: 0.4167 - 227s/epoch - 42ms/step
Epoch 8/50
5452/5452 - 224s - loss: 3.0342 - accuracy30: 0.4853 - val_loss: 3.2458 - val_accuracy30: 0.4222 - 224s/epoch - 41ms/step
Epoch 9/50
5452/5452 - 222s - loss: 3.0297 - accuracy30: 0.4870 - val_loss: 3.2669 - val_accuracy30: 0.4236 - 222s/epoch - 41ms/step
Epoch 10/50
5452/5452 - 220s - loss: 3.0261 - accuracy30: 0.4875 - val_loss: 3.2615 - val_accuracy30: 0.4194 - 220s/epoch - 40ms/step
Epoch 11/50
5452/5452 - 221s - loss: 3.0225 - accuracy30: 0.4892 - val_loss: 3.2346 - val_accuracy30: 0.4273 - 221s/epoch - 41ms/step
Epoch 12/50
5452/5452 - 221s - loss: 3.0194 - accuracy30: 0.4903 - val_loss: 3.2288 - val_accuracy30: 0.4280 - 221s/epoch - 41ms/step
Epoch 13/50
5452/5452 - 222s - loss: 3.0162 - accuracy30: 0.4913 - val_loss: 3.2422 - val_accuracy30: 0.4227 - 222s/epoch - 41ms/step
Epoch 14/50
5452/5452 - 223s - loss: 3.0133 - accuracy30: 0.4917 - val_loss: 3.2581 - val_accuracy30: 0.4222 - 223s/epoch - 41ms/step
Epoch 15/50
5452/5452 - 220s - loss: 3.0104 - accuracy30: 0.4926 - val_loss: 3.2498 - val_accuracy30: 0.4291 - 220s/epoch - 40ms/step
Epoch 16/50
5452/5452 - 224s - loss: 3.0080 - accuracy30: 0.4930 - val_loss: 3.2479 - val_accuracy30: 0.4279 - 224s/epoch - 41ms/step
Epoch 17/50
5452/5452 - 228s - loss: 3.0056 - accuracy30: 0.4942 - val_loss: 3.2481 - val_accuracy30: 0.4279 - 228s/epoch - 42ms/step
Epoch 18/50
5452/5452 - 225s - loss: 3.0030 - accuracy30: 0.4947 - val_loss: 3.2673 - val_accuracy30: 0.4304 - 225s/epoch - 41ms/step
Epoch 19/50
5452/5452 - 224s - loss: 3.0017 - accuracy30: 0.4952 - val_loss: 3.2349 - val_accuracy30: 0.4301 - 224s/epoch - 41ms/step
Epoch 20/50
5452/5452 - 222s - loss: 2.9992 - accuracy30: 0.4956 - val_loss: 3.2521 - val_accuracy30: 0.4301 - 222s/epoch - 41ms/step
Epoch 21/50
5452/5452 - 219s - loss: 2.9969 - accuracy30: 0.4964 - val_loss: 3.2660 - val_accuracy30: 0.4286 - 219s/epoch - 40ms/step
Epoch 22/50
5452/5452 - 219s - loss: 2.9956 - accuracy30: 0.4971 - val_loss: 3.2681 - val_accuracy30: 0.4278 - 219s/epoch - 40ms/step
testing model: results/AAPL/W6/deepLOB_L2/h30
Evaluating performance on  test set...
29350/29350 - 396s - 396s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1377114
{'0': {'precision': 0.33766913442230884, 'recall': 0.5054363908165722, 'f1-score': 0.4048609894810284, 'support': 2213509}, '1': {'precision': 0.4424842610221106, 'recall': 0.5888700027392588, 'f1-score': 0.5052884680960756, 'support': 3113981}, '2': {'precision': 0.48374935229688926, 'recall': 0.012385665675776815, 'f1-score': 0.02415293229212434, 'support': 2185914}, 'accuracy': 0.3965701831020933, 'macro avg': {'precision': 0.42130091591376956, 'recall': 0.3688973530772026, 'f1-score': 0.31143412995640946, 'support': 7513404}, 'weighted avg': {'precision': 0.42361035442318634, 'recall': 0.3965701831020933, 'f1-score': 0.3357224456416631, 'support': 7513404}}
[[1118788 1086536    8185]
 [1259543 1833730   20708]
 [ 934936 1223904   27074]]
Evaluating performance on  train set...
5452/5452 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.09979
{'0': {'precision': 0.4383697131288099, 'recall': 0.42351852208134794, 'f1-score': 0.43081616721283666, 'support': 467793}, '1': {'precision': 0.4051779473646673, 'recall': 0.7028788737163584, 'f1-score': 0.5140368506021916, 'support': 460701}, '2': {'precision': 0.4758232697996993, 'recall': 0.14706594058430641, 'f1-score': 0.2246864949927533, 'support': 466981}, 'accuracy': 0.4232343825579104, 'macro avg': {'precision': 0.43979031009772546, 'recall': 0.42448777879400423, 'f1-score': 0.38984650426926054, 'support': 1395475}, 'weighted avg': {'precision': 0.4399452481032253, 'recall': 0.4232343825579104, 'f1-score': 0.38931145490710023, 'support': 1395475}}
[[198119 226843  42831]
 [104059 323817  32825]
 [149767 248537  68677]]
Evaluating performance on  val set...
1969/1969 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0776829
{'0': {'precision': 0.47701087973482315, 'recall': 0.22299631973907014, 'f1-score': 0.30391593325413757, 'support': 160043}, '1': {'precision': 0.4146314380890015, 'recall': 0.7815043977096492, 'f1-score': 0.541805173956475, 'support': 186347}, '2': {'precision': 0.4435941806062937, 'recall': 0.21948589802946605, 'f1-score': 0.29366789993550796, 'support': 157673}, 'accuracy': 0.4283730406715034, 'macro avg': {'precision': 0.44507883281003946, 'recall': 0.40799553849272846, 'f1-score': 0.3797963357153735, 'support': 504063}, 'weighted avg': {'precision': 0.44349694791664457, 'recall': 0.4283730406715034, 'f1-score': 0.38865555544364594, 'support': 504063}}
[[ 35689 102614  21740]
 [ 19048 145631  21668]
 [ 20081 102985  34607]]
training model: results/AAPL/W6/deepLOB_L2/h50
Epoch 1/50
5452/5452 - 225s - loss: 3.1269 - accuracy50: 0.4456 - val_loss: 3.2630 - val_accuracy50: 0.4037 - 225s/epoch - 41ms/step
Epoch 2/50
5452/5452 - 221s - loss: 3.0914 - accuracy50: 0.4616 - val_loss: 3.2645 - val_accuracy50: 0.4296 - 221s/epoch - 41ms/step
Epoch 3/50
5452/5452 - 220s - loss: 3.0727 - accuracy50: 0.4708 - val_loss: 3.3096 - val_accuracy50: 0.4276 - 220s/epoch - 40ms/step
Epoch 4/50
5452/5452 - 221s - loss: 3.0608 - accuracy50: 0.4755 - val_loss: 3.3769 - val_accuracy50: 0.4297 - 221s/epoch - 40ms/step
Epoch 5/50
5452/5452 - 221s - loss: 3.0527 - accuracy50: 0.4789 - val_loss: 3.4081 - val_accuracy50: 0.4292 - 221s/epoch - 41ms/step
Epoch 6/50
5452/5452 - 219s - loss: 3.0468 - accuracy50: 0.4812 - val_loss: 3.4160 - val_accuracy50: 0.4256 - 219s/epoch - 40ms/step
Epoch 7/50
5452/5452 - 220s - loss: 3.0423 - accuracy50: 0.4835 - val_loss: 3.3659 - val_accuracy50: 0.4352 - 220s/epoch - 40ms/step
Epoch 8/50
5452/5452 - 219s - loss: 3.0380 - accuracy50: 0.4847 - val_loss: 3.3865 - val_accuracy50: 0.4309 - 219s/epoch - 40ms/step
Epoch 9/50
5452/5452 - 220s - loss: 3.0347 - accuracy50: 0.4859 - val_loss: 3.4084 - val_accuracy50: 0.4334 - 220s/epoch - 40ms/step
Epoch 10/50
5452/5452 - 219s - loss: 3.0317 - accuracy50: 0.4870 - val_loss: 3.4386 - val_accuracy50: 0.4305 - 219s/epoch - 40ms/step
Epoch 11/50
5452/5452 - 221s - loss: 3.0284 - accuracy50: 0.4880 - val_loss: 3.4030 - val_accuracy50: 0.4213 - 221s/epoch - 41ms/step
testing model: results/AAPL/W6/deepLOB_L2/h50
Evaluating performance on  test set...
29350/29350 - 390s - 390s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1001803
{'0': {'precision': 0.3255909771545671, 'recall': 0.4746378039692084, 'f1-score': 0.3862340121579038, 'support': 2212683}, '1': {'precision': 0.4399660679802058, 'recall': 0.5914695415364594, 'f1-score': 0.5045909334888956, 'support': 3112025}, '2': {'precision': 0.32114636839326005, 'recall': 0.015282615767562055, 'f1-score': 0.02917677598762414, 'support': 2188696}, 'accuracy': 0.3892163924633894, 'macro avg': {'precision': 0.362234471176011, 'recall': 0.3604633204244099, 'f1-score': 0.3066672405448078, 'support': 7513404}, 'weighted avg': {'precision': 0.3716699906894736, 'recall': 0.3892163924633894, 'f1-score': 0.3312442836045255, 'support': 7513404}}
[[1050223 1137104   25356]
 [1226007 1840668   45350]
 [ 949360 1205887   33449]]
Evaluating performance on  train set...
5452/5452 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0973469
{'0': {'precision': 0.40796748633938723, 'recall': 0.4033790355607126, 'f1-score': 0.40566028629619977, 'support': 468832}, '1': {'precision': 0.39177744352751465, 'recall': 0.6913183070057408, 'f1-score': 0.5001273781180119, 'support': 460037}, '2': {'precision': 0.4135365254808613, 'recall': 0.10648384289957695, 'f1-score': 0.16935859089398472, 'support': 466606}, 'accuracy': 0.39902900446084666, 'macro avg': {'precision': 0.40442715178258776, 'recall': 0.40039372848867677, 'f1-score': 0.3583820851027321, 'support': 1395475}, 'weighted avg': {'precision': 0.4044923458693689, 'recall': 0.39902900446084666, 'f1-score': 0.35779025540032916, 'support': 1395475}}
[[189117 238728  40987]
 [112529 318032  29476]
 [161913 255007  49686]]
Evaluating performance on  val set...
1969/1969 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0881059
{'0': {'precision': 0.4000942507068803, 'recall': 0.2743368227239195, 'f1-score': 0.32549089107263635, 'support': 164021}, '1': {'precision': 0.404771048263742, 'recall': 0.6897481116693841, 'f1-score': 0.5101602172325816, 'support': 180318}, '2': {'precision': 0.4014846964791822, 'recall': 0.2119656407302597, 'f1-score': 0.2774502050800857, 'support': 159724}, 'accuracy': 0.40317777738100197, 'macro avg': {'precision': 0.4021166651499348, 'recall': 0.3920168583745211, 'f1-score': 0.3710337711284346, 'support': 504063}, 'weighted avg': {'precision': 0.4022078721041924, 'recall': 0.40317777738100197, 'f1-score': 0.37632968111482323, 'support': 504063}}
[[ 44997  90098  28926]
 [ 34399 124374  21545]
 [ 33070  92798  33856]]
training model: results/AAPL/W6/deepLOB_L2/h100
Epoch 1/50
5452/5452 - 223s - loss: 3.2212 - accuracy100: 0.4111 - val_loss: 3.3426 - val_accuracy100: 0.3549 - 223s/epoch - 41ms/step
Epoch 2/50
5452/5452 - 220s - loss: 3.1954 - accuracy100: 0.4238 - val_loss: 3.3952 - val_accuracy100: 0.3455 - 220s/epoch - 40ms/step
Epoch 3/50
5452/5452 - 220s - loss: 3.1813 - accuracy100: 0.4308 - val_loss: 3.4022 - val_accuracy100: 0.3563 - 220s/epoch - 40ms/step
Epoch 4/50
5452/5452 - 219s - loss: 3.1735 - accuracy100: 0.4344 - val_loss: 3.4053 - val_accuracy100: 0.3621 - 219s/epoch - 40ms/step
Epoch 5/50
5452/5452 - 219s - loss: 3.1686 - accuracy100: 0.4367 - val_loss: 3.4130 - val_accuracy100: 0.3627 - 219s/epoch - 40ms/step
Epoch 6/50
5452/5452 - 219s - loss: 3.1641 - accuracy100: 0.4388 - val_loss: 3.4091 - val_accuracy100: 0.3553 - 219s/epoch - 40ms/step
Epoch 7/50
5452/5452 - 219s - loss: 3.1600 - accuracy100: 0.4408 - val_loss: 3.4108 - val_accuracy100: 0.3517 - 219s/epoch - 40ms/step
Epoch 8/50
5452/5452 - 220s - loss: 3.1567 - accuracy100: 0.4426 - val_loss: 3.4271 - val_accuracy100: 0.3448 - 220s/epoch - 40ms/step
Epoch 9/50
5452/5452 - 218s - loss: 3.1537 - accuracy100: 0.4436 - val_loss: 3.4370 - val_accuracy100: 0.3479 - 218s/epoch - 40ms/step
Epoch 10/50
5452/5452 - 224s - loss: 3.1513 - accuracy100: 0.4452 - val_loss: 3.4170 - val_accuracy100: 0.3519 - 224s/epoch - 41ms/step
Epoch 11/50
5452/5452 - 221s - loss: 3.1487 - accuracy100: 0.4457 - val_loss: 3.4299 - val_accuracy100: 0.3492 - 221s/epoch - 40ms/step
testing model: results/AAPL/W6/deepLOB_L2/h100
Evaluating performance on  test set...
29350/29350 - 390s - 390s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.10486
{'0': {'precision': 0.2985520848904623, 'recall': 0.254084095984567, 'f1-score': 0.2745290273017968, 'support': 2255946}, '1': {'precision': 0.4021315759554087, 'recall': 0.6464804280931149, 'f1-score': 0.4958367677839051, 'support': 3025510}, '2': {'precision': 0.2973759454354554, 'recall': 0.09720342947057907, 'f1-score': 0.1465153202458479, 'support': 2231948}, 'accuracy': 0.3654915934242322, 'macro avg': {'precision': 0.33268653542710885, 'recall': 0.3325893178494203, 'f1-score': 0.3056270384438499, 'support': 7513404}, 'weighted avg': {'precision': 0.33991225984013657, 'recall': 0.3654915934242322, 'f1-score': 0.32561756779155515, 'support': 7513404}}
[[ 573200 1463211  219535]
 [ 776507 1955933  293070]
 [ 570226 1444769  216953]]
Evaluating performance on  train set...
5452/5452 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1278293
{'0': {'precision': 0.3292871422458117, 'recall': 0.21982709916747503, 'f1-score': 0.26364727706475033, 'support': 469055}, '1': {'precision': 0.3245651468311189, 'recall': 0.6639404217153356, 'f1-score': 0.4359953596984233, 'support': 459362}, '2': {'precision': 0.3322257738896366, 'recall': 0.1014734786686022, 'f1-score': 0.1554630531691908, 'support': 467058}, 'accuracy': 0.3264078539565381, 'macro avg': {'precision': 0.3286926876555224, 'recall': 0.3284136665171376, 'f1-score': 0.2850352299774548, 'support': 1395475}, 'weighted avg': {'precision': 0.32871630160776194, 'recall': 0.3264078539565381, 'f1-score': 0.2841720823751694, 'support': 1395475}}
[[103111 318920  47024]
 [106135 304989  48238]
 [103888 315776  47394]]
Evaluating performance on  val set...
1969/1969 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1147932
{'0': {'precision': 0.31141598605120674, 'recall': 0.16962199312714776, 'f1-score': 0.2196209136579486, 'support': 160050}, '1': {'precision': 0.3726641735747696, 'recall': 0.6844452713837648, 'f1-score': 0.4825767712772537, 'support': 188110}, '2': {'precision': 0.3150464292216978, 'recall': 0.1442820215133769, 'f1-score': 0.19792170768405032, 'support': 155903}, 'accuracy': 0.3539101263135759, 'macro avg': {'precision': 0.33304219628255805, 'recall': 0.3327830953414298, 'f1-score': 0.30003979753975085, 'support': 504063}, 'weighted avg': {'precision': 0.3353959122442946, 'recall': 0.3539101263135759, 'f1-score': 0.3110413413977724, 'support': 504063}}
[[ 27148 110070  22832]
 [ 33286 128751  26073]
 [ 26742 106667  22494]]
training model: results/AAPL/W6/deepLOB_L2/h200
Epoch 1/50
5452/5452 - 222s - loss: 3.1696 - accuracy200: 0.4346 - val_loss: 3.4943 - val_accuracy200: 0.3499 - 222s/epoch - 41ms/step
Epoch 2/50
5452/5452 - 220s - loss: 3.1475 - accuracy200: 0.4462 - val_loss: 3.4535 - val_accuracy200: 0.3341 - 220s/epoch - 40ms/step
Epoch 3/50
5452/5452 - 221s - loss: 3.1390 - accuracy200: 0.4509 - val_loss: 3.4852 - val_accuracy200: 0.3382 - 221s/epoch - 40ms/step
Epoch 4/50
5452/5452 - 219s - loss: 3.1335 - accuracy200: 0.4534 - val_loss: 3.5101 - val_accuracy200: 0.3397 - 219s/epoch - 40ms/step
Epoch 5/50
5452/5452 - 219s - loss: 3.1277 - accuracy200: 0.4554 - val_loss: 3.5398 - val_accuracy200: 0.3510 - 219s/epoch - 40ms/step
Epoch 6/50
5452/5452 - 218s - loss: 3.1235 - accuracy200: 0.4572 - val_loss: 3.5759 - val_accuracy200: 0.3425 - 218s/epoch - 40ms/step
Epoch 7/50
5452/5452 - 219s - loss: 3.1208 - accuracy200: 0.4578 - val_loss: 3.5907 - val_accuracy200: 0.3374 - 219s/epoch - 40ms/step
Epoch 8/50
5452/5452 - 220s - loss: 3.1178 - accuracy200: 0.4591 - val_loss: 3.5909 - val_accuracy200: 0.3392 - 220s/epoch - 40ms/step
Epoch 9/50
5452/5452 - 218s - loss: 3.1146 - accuracy200: 0.4605 - val_loss: 3.5605 - val_accuracy200: 0.3423 - 218s/epoch - 40ms/step
Epoch 10/50
5452/5452 - 223s - loss: 3.1115 - accuracy200: 0.4616 - val_loss: 3.6189 - val_accuracy200: 0.3201 - 223s/epoch - 41ms/step
Epoch 11/50
5452/5452 - 222s - loss: 3.1080 - accuracy200: 0.4629 - val_loss: 3.6836 - val_accuracy200: 0.3125 - 222s/epoch - 41ms/step
Epoch 12/50
5452/5452 - 223s - loss: 3.1060 - accuracy200: 0.4634 - val_loss: 3.6074 - val_accuracy200: 0.3202 - 223s/epoch - 41ms/step
testing model: results/AAPL/W6/deepLOB_L2/h200
Evaluating performance on  test set...
29350/29350 - 387s - 387s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.144064
{'0': {'precision': 0.29472762849013223, 'recall': 0.547306884484965, 'f1-score': 0.38313503219872663, 'support': 2212976}, '1': {'precision': 0.40876501883326244, 'recall': 0.3888460467093785, 'f1-score': 0.39855681164167933, 'support': 3069405}, '2': {'precision': 0.29695656395181896, 'recall': 0.06443411833943442, 'f1-score': 0.10589168631593371, 'support': 2231023}, 'accuracy': 0.3391880697484123, 'macro avg': {'precision': 0.33348307042507125, 'recall': 0.33352901651125927, 'f1-score': 0.2958611767187799, 'support': 7513404}, 'weighted avg': {'precision': 0.34197648431988587, 'recall': 0.3391880697484123, 'f1-score': 0.3071108234206056, 'support': 7513404}}
[[1211177  859571  142228]
 [1677770 1193526  198109]
 [1220532  866737  143754]]
Evaluating performance on  train set...
5452/5452 - 78s - 78s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1645688
{'0': {'precision': 0.3243707261240111, 'recall': 0.4283735880088375, 'f1-score': 0.36918738324804296, 'support': 465743}, '1': {'precision': 0.3174731976344805, 'recall': 0.4882551526926975, 'f1-score': 0.38476472752614194, 'support': 464757}, '2': {'precision': 0.32305887372013653, 'recall': 0.04560030109145653, 'f1-score': 0.07991978997638555, 'support': 464975}, 'accuracy': 0.3207760798294488, 'macro avg': {'precision': 0.3216342658262094, 'recall': 0.3207430139309972, 'f1-score': 0.2779573002501901, 'support': 1395475}, 'weighted avg': {'precision': 0.32163642187656816, 'recall': 0.3207760798294488, 'f1-score': 0.27799082337643477, 'support': 1395475}}
[[199512 245416  20815]
 [214223 226920  23614]
 [201339 242433  21203]]
Evaluating performance on  val set...
1969/1969 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1505113
{'0': {'precision': 0.30263137191140294, 'recall': 0.3620346725060705, 'f1-score': 0.3296784920494346, 'support': 159377}, '1': {'precision': 0.3590266477159591, 'recall': 0.5512867821484676, 'f1-score': 0.4348538400765105, 'support': 189698}, '2': {'precision': 0.29737793851717903, 'recall': 0.042441995509329755, 'f1-score': 0.07428235878672901, 'support': 154988}, 'accuracy': 0.3349898722977088, 'macro avg': {'precision': 0.319678652714847, 'recall': 0.3185878167212893, 'f1-score': 0.27960489697089136, 'support': 504063}, 'weighted avg': {'precision': 0.3222397381169541, 'recall': 0.3349898722977088, 'f1-score': 0.2907314105693816, 'support': 504063}}
[[ 57700  95056   6621]
 [ 76199 104578   8921]
 [ 56762  91648   6578]]
training model: results/AAPL/W6/deepLOB_L2/h300
Epoch 1/50
5452/5452 - 222s - loss: 3.1987 - accuracy300: 0.4217 - val_loss: 3.3263 - val_accuracy300: 0.3585 - 222s/epoch - 41ms/step
Epoch 2/50
5452/5452 - 218s - loss: 3.1710 - accuracy300: 0.4370 - val_loss: 3.3708 - val_accuracy300: 0.3584 - 218s/epoch - 40ms/step
Epoch 3/50
5452/5452 - 219s - loss: 3.1591 - accuracy300: 0.4432 - val_loss: 3.4092 - val_accuracy300: 0.3554 - 219s/epoch - 40ms/step
Epoch 4/50
5452/5452 - 219s - loss: 3.1524 - accuracy300: 0.4465 - val_loss: 3.4169 - val_accuracy300: 0.3570 - 219s/epoch - 40ms/step
Epoch 5/50
5452/5452 - 219s - loss: 3.1453 - accuracy300: 0.4498 - val_loss: 3.4074 - val_accuracy300: 0.3591 - 219s/epoch - 40ms/step
Epoch 6/50
5452/5452 - 219s - loss: 3.1397 - accuracy300: 0.4515 - val_loss: 3.4097 - val_accuracy300: 0.3558 - 219s/epoch - 40ms/step
Epoch 7/50
5452/5452 - 219s - loss: 3.1348 - accuracy300: 0.4532 - val_loss: 3.4220 - val_accuracy300: 0.3574 - 219s/epoch - 40ms/step
Epoch 8/50
5452/5452 - 221s - loss: 3.1315 - accuracy300: 0.4548 - val_loss: 3.4622 - val_accuracy300: 0.3580 - 221s/epoch - 40ms/step
Epoch 9/50
5452/5452 - 223s - loss: 3.1281 - accuracy300: 0.4559 - val_loss: 3.4836 - val_accuracy300: 0.3581 - 223s/epoch - 41ms/step
Epoch 10/50
5452/5452 - 220s - loss: 3.1246 - accuracy300: 0.4573 - val_loss: 3.5124 - val_accuracy300: 0.3576 - 220s/epoch - 40ms/step
Epoch 11/50
5452/5452 - 222s - loss: 3.1215 - accuracy300: 0.4584 - val_loss: 3.5124 - val_accuracy300: 0.3584 - 222s/epoch - 41ms/step
testing model: results/AAPL/W6/deepLOB_L2/h300
Evaluating performance on  test set...
29350/29350 - 393s - 393s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0907797
{'0': {'precision': 0.29510445241612154, 'recall': 0.0012686694437993497, 'f1-score': 0.0025264774292617937, 'support': 2204672}, '1': {'precision': 0.41247099653267927, 'recall': 0.9959873502798626, 'f1-score': 0.5833554053388773, 'support': 3099199}, '2': {'precision': 0.2933425115547251, 'recall': 0.0027001180792502306, 'f1-score': 0.00535098218686193, 'support': 2209533}, 'accuracy': 0.4120004727550921, 'macro avg': {'precision': 0.333639320167842, 'recall': 0.33331871260097073, 'f1-score': 0.197077621651667, 'support': 7513404}, 'weighted avg': {'precision': 0.34299875035114374, 'recall': 0.4120004727550921, 'f1-score': 0.24294284117319556, 'support': 7513404}}
[[   2797 2195993    5882]
 [   3946 3086763    8490]
 [   2735 2200832    5966]]
Evaluating performance on  train set...
5452/5452 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1249278
{'0': {'precision': 0.3820173655129524, 'recall': 0.03375569340674438, 'f1-score': 0.062030286906098166, 'support': 473135}, '1': {'precision': 0.3258585887356396, 'recall': 0.9649416804465801, 'f1-score': 0.48719316490649267, 'support': 450535}, '2': {'precision': 0.36229583738671856, 'recall': 0.014997721516304406, 'f1-score': 0.0288031001188596, 'support': 471805}, 'accuracy': 0.3280510220534227, 'macro avg': {'precision': 0.3567239305451035, 'recall': 0.33789836512320964, 'f1-score': 0.19267551731048346, 'support': 1395475}, 'weighted avg': {'precision': 0.357218490525608, 'recall': 0.3280510220534227, 'f1-score': 0.18806192801593866, 'support': 1395475}}
[[ 15971 449969   7195]
 [ 10535 434740   5260]
 [ 15301 449428   7076]]
Evaluating performance on  val set...
1969/1969 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1117586
{'0': {'precision': 0.33136931416450627, 'recall': 0.008590718846424098, 'f1-score': 0.016747266360149605, 'support': 163665}, '1': {'precision': 0.3590478609528648, 'recall': 0.9846533175591257, 'f1-score': 0.5262147166399783, 'support': 180886}, '2': {'precision': 0.31532730175625334, 'recall': 0.007428908169918251, 'f1-score': 0.014515832669810743, 'support': 159512}, 'accuracy': 0.35848891904384966, 'macro avg': {'precision': 0.33524815895787485, 'recall': 0.3335576481918227, 'f1-score': 0.1858259385566462, 'support': 504063}, 'weighted avg': {'precision': 0.3362253899548217, 'recall': 0.35848891904384966, 'f1-score': 0.1988665426420901, 'support': 504063}}
[[  1406 160989   1270]
 [  1473 178110   1303]
 [  1364 156963   1185]]
training model: results/AAPL/W6/deepLOB_L2/h500
Epoch 1/50
5452/5452 - 222s - loss: 3.2006 - accuracy500: 0.4249 - val_loss: 3.3082 - val_accuracy500: 0.3731 - 222s/epoch - 41ms/step
Epoch 2/50
5452/5452 - 220s - loss: 3.1574 - accuracy500: 0.4461 - val_loss: 3.3954 - val_accuracy500: 0.3631 - 220s/epoch - 40ms/step
Epoch 3/50
5452/5452 - 220s - loss: 3.1306 - accuracy500: 0.4575 - val_loss: 3.6081 - val_accuracy500: 0.3237 - 220s/epoch - 40ms/step
Epoch 4/50
5452/5452 - 219s - loss: 3.1169 - accuracy500: 0.4628 - val_loss: 3.6841 - val_accuracy500: 0.3195 - 219s/epoch - 40ms/step
Epoch 5/50
5452/5452 - 221s - loss: 3.1080 - accuracy500: 0.4660 - val_loss: 3.7488 - val_accuracy500: 0.3204 - 221s/epoch - 41ms/step
Epoch 6/50
5452/5452 - 221s - loss: 3.1021 - accuracy500: 0.4679 - val_loss: 3.7816 - val_accuracy500: 0.3211 - 221s/epoch - 40ms/step
Epoch 7/50
5452/5452 - 218s - loss: 3.0964 - accuracy500: 0.4695 - val_loss: 3.8818 - val_accuracy500: 0.3236 - 218s/epoch - 40ms/step
Epoch 8/50
5452/5452 - 223s - loss: 3.0908 - accuracy500: 0.4714 - val_loss: 3.9573 - val_accuracy500: 0.3209 - 223s/epoch - 41ms/step
Epoch 9/50
5452/5452 - 219s - loss: 3.0865 - accuracy500: 0.4727 - val_loss: 3.8850 - val_accuracy500: 0.3275 - 219s/epoch - 40ms/step
Epoch 10/50
5452/5452 - 219s - loss: 3.0823 - accuracy500: 0.4735 - val_loss: 3.9545 - val_accuracy500: 0.3253 - 219s/epoch - 40ms/step
Epoch 11/50
5452/5452 - 218s - loss: 3.0787 - accuracy500: 0.4748 - val_loss: 4.0637 - val_accuracy500: 0.3365 - 218s/epoch - 40ms/step
testing model: results/AAPL/W6/deepLOB_L2/h500
Evaluating performance on  test set...
29350/29350 - 381s - 381s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.098459
{'0': {'precision': 0.305088271727516, 'recall': 0.014075965890301353, 'f1-score': 0.026910358995232052, 'support': 2292134}, '1': {'precision': 0.3876748235775037, 'recall': 0.9833520683221667, 'f1-score': 0.5561099375274202, 'support': 2912554}, '2': {'precision': 0.31109543484833213, 'recall': 0.002674213718794343, 'f1-score': 0.005302843557526062, 'support': 2308716}, 'accuracy': 0.38631011988707115, 'macro avg': {'precision': 0.3346195100511173, 'recall': 0.33336741597708747, 'f1-score': 0.19610771336005947, 'support': 7513404}, 'weighted avg': {'precision': 0.33894863988401697, 'recall': 0.38631011988707115, 'f1-score': 0.22541382462026166, 'support': 7513404}}
[[  32264 2253840    6030]
 [  40846 2864066    7642]
 [  32643 2269899    6174]]
Evaluating performance on  train set...
5452/5452 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1138192
{'0': {'precision': 0.38825283979412195, 'recall': 0.07384342395987067, 'f1-score': 0.12408634867389526, 'support': 468884}, '1': {'precision': 0.33910994527982, 'recall': 0.8996754519712481, 'f1-score': 0.49256133300340166, 'support': 459100}, '2': {'precision': 0.3534282574959504, 'recall': 0.06674139181289052, 'f1-score': 0.11227985576819272, 'support': 467491}, 'accuracy': 0.34315627295365375, 'macro avg': {'precision': 0.3602636808566308, 'recall': 0.3467534225813364, 'f1-score': 0.24297584581516318, 'support': 1395475}, 'weighted avg': {'precision': 0.3604188179200859, 'recall': 0.34315627295365375, 'f1-score': 0.24135640806635772, 'support': 1395475}}
[[ 34624 401390  32870]
 [ 21849 413041  24210]
 [ 32706 403584  31201]]
Evaluating performance on  val set...
1969/1969 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1031859
{'0': {'precision': 0.32341456846640637, 'recall': 0.029881940211238696, 'f1-score': 0.0547090308620886, 'support': 160766}, '1': {'precision': 0.3785726288826011, 'recall': 0.8886170411236374, 'f1-score': 0.530948282314198, 'support': 187605}, '2': {'precision': 0.3402256023911397, 'recall': 0.1067427998869563, 'f1-score': 0.1625020167303057, 'support': 155692}, 'accuracy': 0.37323112388729185, 'macro avg': {'precision': 0.347404266580049, 'recall': 0.3417472604072775, 'f1-score': 0.24938644330219742, 'support': 504063}, 'weighted avg': {'precision': 0.3491360981525563, 'recall': 0.37323112388729185, 'f1-score': 0.2652528920946477, 'support': 504063}}
[[  4804 139220  16742]
 [  5410 166709  15486]
 [  4640 134433  16619]]
training model: results/AAPL/W6/deepLOB_L2/h1000
Epoch 1/50
5452/5452 - 225s - loss: 3.1235 - accuracy1000: 0.4584 - val_loss: 3.3932 - val_accuracy1000: 0.3281 - 225s/epoch - 41ms/step
Epoch 2/50
5452/5452 - 220s - loss: 3.0646 - accuracy1000: 0.4804 - val_loss: 3.3952 - val_accuracy1000: 0.3550 - 220s/epoch - 40ms/step
Epoch 3/50
5452/5452 - 223s - loss: 3.0438 - accuracy1000: 0.4873 - val_loss: 3.4803 - val_accuracy1000: 0.3539 - 223s/epoch - 41ms/step
Epoch 4/50
5452/5452 - 222s - loss: 3.0299 - accuracy1000: 0.4907 - val_loss: 3.4888 - val_accuracy1000: 0.3571 - 222s/epoch - 41ms/step
Epoch 5/50
5452/5452 - 221s - loss: 3.0192 - accuracy1000: 0.4943 - val_loss: 3.5614 - val_accuracy1000: 0.3415 - 221s/epoch - 41ms/step
Epoch 6/50
5452/5452 - 222s - loss: 3.0114 - accuracy1000: 0.4968 - val_loss: 3.6234 - val_accuracy1000: 0.3343 - 222s/epoch - 41ms/step
Epoch 7/50
5452/5452 - 223s - loss: 3.0036 - accuracy1000: 0.4984 - val_loss: 3.6282 - val_accuracy1000: 0.3291 - 223s/epoch - 41ms/step
Epoch 8/50
5452/5452 - 224s - loss: 2.9985 - accuracy1000: 0.4996 - val_loss: 3.6099 - val_accuracy1000: 0.3267 - 224s/epoch - 41ms/step
Epoch 9/50
5452/5452 - 221s - loss: 2.9941 - accuracy1000: 0.5013 - val_loss: 3.6339 - val_accuracy1000: 0.3156 - 221s/epoch - 40ms/step
Epoch 10/50
5452/5452 - 221s - loss: 2.9881 - accuracy1000: 0.5024 - val_loss: 3.5376 - val_accuracy1000: 0.3252 - 221s/epoch - 41ms/step
Epoch 11/50
5452/5452 - 222s - loss: 2.9834 - accuracy1000: 0.5042 - val_loss: 3.6217 - val_accuracy1000: 0.3313 - 222s/epoch - 41ms/step
testing model: results/AAPL/W6/deepLOB_L2/h1000
Evaluating performance on  test set...
29350/29350 - 386s - 386s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1347877
{'0': {'precision': 0.2971068285431081, 'recall': 0.6824110742764985, 'f1-score': 0.41397709925946136, 'support': 2232200}, '1': {'precision': 0.4012596580688886, 'recall': 0.30191267248301945, 'f1-score': 0.34456809650662956, 'support': 3016094}, '2': {'precision': 0.3042642283370364, 'recall': 0.015718883409635735, 'f1-score': 0.02989341471708093, 'support': 2265110}, 'accuracy': 0.32867658919978215, 'macro avg': {'precision': 0.3342102383163444, 'recall': 0.3333475433897179, 'f1-score': 0.2628128701610573, 'support': 7513404}, 'weighted avg': {'precision': 0.3410745190949478, 'recall': 0.32867658919978215, 'f1-score': 0.27032238943118764, 'support': 7513404}}
[[1523278  674430   34492]
 [2058574  910597   46923]
 [1545186  684319   35605]]
Evaluating performance on  train set...
5452/5452 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1409043
{'0': {'precision': 0.32618652340713933, 'recall': 0.5631951422706621, 'f1-score': 0.4131109793387811, 'support': 465732}, '1': {'precision': 0.32515820415288577, 'recall': 0.3282629213434612, 'f1-score': 0.32670318674787496, 'support': 463013}, '2': {'precision': 0.3518231562636192, 'recall': 0.09340089559274098, 'f1-score': 0.14761375872787977, 'support': 466730}, 'accuracy': 0.3281183826295706, 'macro avg': {'precision': 0.3343892946078814, 'recall': 0.32828631973562145, 'f1-score': 0.2958093082715119, 'support': 1395475}, 'weighted avg': {'precision': 0.3344197489899947, 'recall': 0.3281183826295706, 'f1-score': 0.295643128573544, 'support': 1395475}}
[[262298 157666  45768]
 [276478 151990  34545]
 [265359 157778  43593]]
Evaluating performance on  val set...
1969/1969 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.131061
{'0': {'precision': 0.3051977747114004, 'recall': 0.4777820662865111, 'f1-score': 0.3724694194982395, 'support': 160636}, '1': {'precision': 0.35655372546677216, 'recall': 0.3789210863194422, 'f1-score': 0.36739728627004453, 'support': 189042}, '2': {'precision': 0.3249240650815454, 'recall': 0.10878647537001651, 'f1-score': 0.16299969913720314, 'support': 154385}, 'accuracy': 0.32768919758046117, 'macro avg': {'precision': 0.3288918550865727, 'recall': 0.3218298759919899, 'f1-score': 0.300955468301829, 'support': 504063}, 'weighted avg': {'precision': 0.3304999194462685, 'recall': 0.32768919758046117, 'f1-score': 0.30641055584892773, 'support': 504063}}
[[ 76749  66122  17765]
 [100281  71632  17129]
 [ 74443  63147  16795]]
training model: results/AAPL/W6/deepOF_L2/h10
Epoch 1/50
5452/5452 - 153s - loss: 2.9553 - accuracy10: 0.5107 - val_loss: 3.0690 - val_accuracy10: 0.4694 - 153s/epoch - 28ms/step
Epoch 2/50
5452/5452 - 121s - loss: 2.8663 - accuracy10: 0.5333 - val_loss: 3.0041 - val_accuracy10: 0.4860 - 121s/epoch - 22ms/step
Epoch 3/50
5452/5452 - 119s - loss: 2.8366 - accuracy10: 0.5402 - val_loss: 2.9943 - val_accuracy10: 0.4905 - 119s/epoch - 22ms/step
Epoch 4/50
5452/5452 - 119s - loss: 2.8220 - accuracy10: 0.5437 - val_loss: 2.9653 - val_accuracy10: 0.4979 - 119s/epoch - 22ms/step
Epoch 5/50
5452/5452 - 119s - loss: 2.8124 - accuracy10: 0.5458 - val_loss: 2.9647 - val_accuracy10: 0.4993 - 119s/epoch - 22ms/step
Epoch 6/50
5452/5452 - 119s - loss: 2.8055 - accuracy10: 0.5477 - val_loss: 2.9550 - val_accuracy10: 0.5022 - 119s/epoch - 22ms/step
Epoch 7/50
5452/5452 - 119s - loss: 2.7989 - accuracy10: 0.5491 - val_loss: 2.9372 - val_accuracy10: 0.5061 - 119s/epoch - 22ms/step
Epoch 8/50
5452/5452 - 124s - loss: 2.7944 - accuracy10: 0.5501 - val_loss: 2.9342 - val_accuracy10: 0.5087 - 124s/epoch - 23ms/step
Epoch 9/50
5452/5452 - 122s - loss: 2.7897 - accuracy10: 0.5513 - val_loss: 2.9301 - val_accuracy10: 0.5108 - 122s/epoch - 22ms/step
Epoch 10/50
5452/5452 - 123s - loss: 2.7856 - accuracy10: 0.5523 - val_loss: 2.9139 - val_accuracy10: 0.5148 - 123s/epoch - 23ms/step
Epoch 11/50
5452/5452 - 121s - loss: 2.7824 - accuracy10: 0.5526 - val_loss: 2.9162 - val_accuracy10: 0.5164 - 121s/epoch - 22ms/step
Epoch 12/50
5452/5452 - 119s - loss: 2.7787 - accuracy10: 0.5539 - val_loss: 2.9178 - val_accuracy10: 0.5163 - 119s/epoch - 22ms/step
Epoch 13/50
5452/5452 - 119s - loss: 2.7759 - accuracy10: 0.5545 - val_loss: 2.9011 - val_accuracy10: 0.5194 - 119s/epoch - 22ms/step
Epoch 14/50
5452/5452 - 118s - loss: 2.7733 - accuracy10: 0.5550 - val_loss: 2.8885 - val_accuracy10: 0.5229 - 118s/epoch - 22ms/step
Epoch 15/50
5452/5452 - 119s - loss: 2.7705 - accuracy10: 0.5558 - val_loss: 2.8958 - val_accuracy10: 0.5227 - 119s/epoch - 22ms/step
Epoch 16/50
5452/5452 - 119s - loss: 2.7681 - accuracy10: 0.5562 - val_loss: 2.8921 - val_accuracy10: 0.5234 - 119s/epoch - 22ms/step
Epoch 17/50
5452/5452 - 118s - loss: 2.7660 - accuracy10: 0.5564 - val_loss: 2.8851 - val_accuracy10: 0.5249 - 118s/epoch - 22ms/step
Epoch 18/50
5452/5452 - 119s - loss: 2.7635 - accuracy10: 0.5571 - val_loss: 2.8833 - val_accuracy10: 0.5254 - 119s/epoch - 22ms/step
Epoch 19/50
5452/5452 - 119s - loss: 2.7619 - accuracy10: 0.5576 - val_loss: 2.8734 - val_accuracy10: 0.5273 - 119s/epoch - 22ms/step
Epoch 20/50
5452/5452 - 118s - loss: 2.7593 - accuracy10: 0.5581 - val_loss: 2.8701 - val_accuracy10: 0.5285 - 118s/epoch - 22ms/step
Epoch 21/50
5452/5452 - 118s - loss: 2.7579 - accuracy10: 0.5585 - val_loss: 2.8755 - val_accuracy10: 0.5284 - 118s/epoch - 22ms/step
Epoch 22/50
5452/5452 - 118s - loss: 2.7554 - accuracy10: 0.5586 - val_loss: 2.8738 - val_accuracy10: 0.5293 - 118s/epoch - 22ms/step
Epoch 23/50
5452/5452 - 118s - loss: 2.7538 - accuracy10: 0.5594 - val_loss: 2.8696 - val_accuracy10: 0.5306 - 118s/epoch - 22ms/step
Epoch 24/50
5452/5452 - 118s - loss: 2.7523 - accuracy10: 0.5595 - val_loss: 2.8631 - val_accuracy10: 0.5319 - 118s/epoch - 22ms/step
Epoch 25/50
5452/5452 - 119s - loss: 2.7505 - accuracy10: 0.5598 - val_loss: 2.8625 - val_accuracy10: 0.5318 - 119s/epoch - 22ms/step
Epoch 26/50
5452/5452 - 119s - loss: 2.7487 - accuracy10: 0.5604 - val_loss: 2.8705 - val_accuracy10: 0.5303 - 119s/epoch - 22ms/step
Epoch 27/50
5452/5452 - 119s - loss: 2.7465 - accuracy10: 0.5607 - val_loss: 2.8577 - val_accuracy10: 0.5332 - 119s/epoch - 22ms/step
Epoch 28/50
5452/5452 - 119s - loss: 2.7454 - accuracy10: 0.5607 - val_loss: 2.8566 - val_accuracy10: 0.5339 - 119s/epoch - 22ms/step
Epoch 29/50
5452/5452 - 119s - loss: 2.7435 - accuracy10: 0.5614 - val_loss: 2.8853 - val_accuracy10: 0.5293 - 119s/epoch - 22ms/step
Epoch 30/50
5452/5452 - 119s - loss: 2.7424 - accuracy10: 0.5617 - val_loss: 2.8622 - val_accuracy10: 0.5331 - 119s/epoch - 22ms/step
Epoch 31/50
5452/5452 - 118s - loss: 2.7405 - accuracy10: 0.5620 - val_loss: 2.8657 - val_accuracy10: 0.5331 - 118s/epoch - 22ms/step
Epoch 32/50
5452/5452 - 118s - loss: 2.7392 - accuracy10: 0.5624 - val_loss: 2.8767 - val_accuracy10: 0.5311 - 118s/epoch - 22ms/step
Epoch 33/50
5452/5452 - 119s - loss: 2.7383 - accuracy10: 0.5623 - val_loss: 2.8629 - val_accuracy10: 0.5340 - 119s/epoch - 22ms/step
Epoch 34/50
5452/5452 - 119s - loss: 2.7358 - accuracy10: 0.5629 - val_loss: 2.8582 - val_accuracy10: 0.5341 - 119s/epoch - 22ms/step
Epoch 35/50
5452/5452 - 119s - loss: 2.7346 - accuracy10: 0.5633 - val_loss: 2.8574 - val_accuracy10: 0.5344 - 119s/epoch - 22ms/step
Epoch 36/50
5452/5452 - 119s - loss: 2.7335 - accuracy10: 0.5637 - val_loss: 2.8567 - val_accuracy10: 0.5349 - 119s/epoch - 22ms/step
Epoch 37/50
5452/5452 - 119s - loss: 2.7320 - accuracy10: 0.5637 - val_loss: 2.8617 - val_accuracy10: 0.5347 - 119s/epoch - 22ms/step
Epoch 38/50
5452/5452 - 118s - loss: 2.7303 - accuracy10: 0.5642 - val_loss: 2.8644 - val_accuracy10: 0.5342 - 118s/epoch - 22ms/step
testing model: results/AAPL/W6/deepOF_L2/h10
Evaluating performance on  test set...
29350/29350 - 224s - 224s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0098461
{'0': {'precision': 0.5075155767961601, 'recall': 0.47458161787246, 'f1-score': 0.49049638842042864, 'support': 2469453}, '1': {'precision': 0.46364716220066626, 'recall': 0.6270801227651586, 'f1-score': 0.5331193661330677, 'support': 2535247}, '2': {'precision': 0.5432476308069452, 'recall': 0.38443073481513723, 'f1-score': 0.45024459691404295, 'support': 2508699}, 'accuracy': 0.4959381233447072, 'macro avg': {'precision': 0.5048034566012571, 'recall': 0.4953641584842519, 'f1-score': 0.49128678382251306, 'support': 7513399}, 'weighted avg': {'precision': 0.5046438674229218, 'recall': 0.4959381233447072, 'f1-score': 0.4914387245424363, 'support': 7513399}}
[[1171957  878040  419456]
 [ 554033 1589803  391411]
 [ 583214  961064  964421]]
Evaluating performance on  train set...
5452/5452 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96970433
{'0': {'precision': 0.5331857053433174, 'recall': 0.4919030405662118, 'f1-score': 0.5117130993611858, 'support': 460605}, '1': {'precision': 0.49817340730221765, 'recall': 0.6559449619625914, 'f1-score': 0.5662752546115143, 'support': 475453}, '2': {'precision': 0.5519445460403714, 'recall': 0.41388722614629475, 'f1-score': 0.47304883464337744, 'support': 459415}, 'accuracy': 0.5221097076045184, 'macro avg': {'precision': 0.5277678862286355, 'recall': 0.520578409558366, 'f1-score': 0.5170123962053591, 'support': 1395473}, 'weighted avg': {'precision': 0.5274323805984474, 'recall': 0.5221097076045184, 'f1-score': 0.517574049178848, 'support': 1395473}}
[[226573 152428  81604]
 [ 90830 311871  72752]
 [107539 161730 190146]]
Evaluating performance on  val set...
1969/1969 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9507724
{'0': {'precision': 0.5283672157095514, 'recall': 0.42825356310011425, 'f1-score': 0.473071770476194, 'support': 149659}, '1': {'precision': 0.5309632224168126, 'recall': 0.7350744821165335, 'f1-score': 0.6165653903409228, 'support': 206224}, '2': {'precision': 0.5473884433477277, 'recall': 0.35928842818483053, 'f1-score': 0.4338267349524729, 'support': 148179}, 'accuracy': 0.5335077827727541, 'macro avg': {'precision': 0.5355729604913639, 'recall': 0.5075388244671594, 'f1-score': 0.5078212985898632, 'support': 504062}, 'weighted avg': {'precision': 0.5350209713534911, 'recall': 0.5335077827727541, 'f1-score': 0.5202416387545296, 'support': 504062}}
[[ 64092  65382  20185]
 [ 30798 151590  23836]
 [ 26412  68528  53239]]
training model: results/AAPL/W6/deepOF_L2/h20
Epoch 1/50
5452/5452 - 121s - loss: 3.0552 - accuracy20: 0.4806 - val_loss: 3.2016 - val_accuracy20: 0.4294 - 121s/epoch - 22ms/step
Epoch 2/50
5452/5452 - 119s - loss: 2.9938 - accuracy20: 0.4989 - val_loss: 3.1580 - val_accuracy20: 0.4395 - 119s/epoch - 22ms/step
Epoch 3/50
5452/5452 - 118s - loss: 2.9704 - accuracy20: 0.5048 - val_loss: 3.1218 - val_accuracy20: 0.4461 - 118s/epoch - 22ms/step
Epoch 4/50
5452/5452 - 119s - loss: 2.9570 - accuracy20: 0.5081 - val_loss: 3.0885 - val_accuracy20: 0.4534 - 119s/epoch - 22ms/step
Epoch 5/50
5452/5452 - 119s - loss: 2.9491 - accuracy20: 0.5100 - val_loss: 3.0709 - val_accuracy20: 0.4580 - 119s/epoch - 22ms/step
Epoch 6/50
5452/5452 - 120s - loss: 2.9426 - accuracy20: 0.5116 - val_loss: 3.0624 - val_accuracy20: 0.4615 - 120s/epoch - 22ms/step
Epoch 7/50
5452/5452 - 118s - loss: 2.9380 - accuracy20: 0.5126 - val_loss: 3.0471 - val_accuracy20: 0.4666 - 118s/epoch - 22ms/step
Epoch 8/50
5452/5452 - 118s - loss: 2.9340 - accuracy20: 0.5136 - val_loss: 3.0727 - val_accuracy20: 0.4615 - 118s/epoch - 22ms/step
Epoch 9/50
5452/5452 - 118s - loss: 2.9304 - accuracy20: 0.5146 - val_loss: 3.0352 - val_accuracy20: 0.4717 - 118s/epoch - 22ms/step
Epoch 10/50
5452/5452 - 118s - loss: 2.9271 - accuracy20: 0.5154 - val_loss: 3.0467 - val_accuracy20: 0.4693 - 118s/epoch - 22ms/step
Epoch 11/50
5452/5452 - 118s - loss: 2.9245 - accuracy20: 0.5159 - val_loss: 3.0263 - val_accuracy20: 0.4737 - 118s/epoch - 22ms/step
Epoch 12/50
5452/5452 - 118s - loss: 2.9216 - accuracy20: 0.5166 - val_loss: 3.0219 - val_accuracy20: 0.4773 - 118s/epoch - 22ms/step
Epoch 13/50
5452/5452 - 118s - loss: 2.9195 - accuracy20: 0.5172 - val_loss: 3.0195 - val_accuracy20: 0.4782 - 118s/epoch - 22ms/step
Epoch 14/50
5452/5452 - 119s - loss: 2.9167 - accuracy20: 0.5176 - val_loss: 3.0352 - val_accuracy20: 0.4767 - 119s/epoch - 22ms/step
Epoch 15/50
5452/5452 - 120s - loss: 2.9150 - accuracy20: 0.5182 - val_loss: 3.0375 - val_accuracy20: 0.4771 - 120s/epoch - 22ms/step
Epoch 16/50
5452/5452 - 117s - loss: 2.9128 - accuracy20: 0.5189 - val_loss: 3.0096 - val_accuracy20: 0.4832 - 117s/epoch - 21ms/step
Epoch 17/50
5452/5452 - 118s - loss: 2.9107 - accuracy20: 0.5194 - val_loss: 3.0169 - val_accuracy20: 0.4826 - 118s/epoch - 22ms/step
Epoch 18/50
5452/5452 - 123s - loss: 2.9090 - accuracy20: 0.5199 - val_loss: 3.0013 - val_accuracy20: 0.4870 - 123s/epoch - 23ms/step
Epoch 19/50
5452/5452 - 120s - loss: 2.9074 - accuracy20: 0.5200 - val_loss: 3.0018 - val_accuracy20: 0.4876 - 120s/epoch - 22ms/step
Epoch 20/50
5452/5452 - 123s - loss: 2.9050 - accuracy20: 0.5210 - val_loss: 3.0027 - val_accuracy20: 0.4882 - 123s/epoch - 23ms/step
Epoch 21/50
5452/5452 - 119s - loss: 2.9035 - accuracy20: 0.5213 - val_loss: 2.9936 - val_accuracy20: 0.4897 - 119s/epoch - 22ms/step
Epoch 22/50
5452/5452 - 117s - loss: 2.9017 - accuracy20: 0.5218 - val_loss: 3.0021 - val_accuracy20: 0.4883 - 117s/epoch - 21ms/step
Epoch 23/50
5452/5452 - 117s - loss: 2.9007 - accuracy20: 0.5221 - val_loss: 2.9924 - val_accuracy20: 0.4907 - 117s/epoch - 22ms/step
Epoch 24/50
5452/5452 - 118s - loss: 2.8985 - accuracy20: 0.5224 - val_loss: 2.9923 - val_accuracy20: 0.4911 - 118s/epoch - 22ms/step
Epoch 25/50
5452/5452 - 118s - loss: 2.8970 - accuracy20: 0.5228 - val_loss: 2.9946 - val_accuracy20: 0.4911 - 118s/epoch - 22ms/step
Epoch 26/50
5452/5452 - 119s - loss: 2.8954 - accuracy20: 0.5235 - val_loss: 2.9981 - val_accuracy20: 0.4898 - 119s/epoch - 22ms/step
Epoch 27/50
5452/5452 - 118s - loss: 2.8939 - accuracy20: 0.5237 - val_loss: 2.9863 - val_accuracy20: 0.4937 - 118s/epoch - 22ms/step
Epoch 28/50
5452/5452 - 118s - loss: 2.8923 - accuracy20: 0.5239 - val_loss: 2.9881 - val_accuracy20: 0.4936 - 118s/epoch - 22ms/step
Epoch 29/50
5452/5452 - 118s - loss: 2.8912 - accuracy20: 0.5244 - val_loss: 2.9886 - val_accuracy20: 0.4935 - 118s/epoch - 22ms/step
Epoch 30/50
5452/5452 - 118s - loss: 2.8898 - accuracy20: 0.5245 - val_loss: 2.9903 - val_accuracy20: 0.4932 - 118s/epoch - 22ms/step
Epoch 31/50
5452/5452 - 117s - loss: 2.8884 - accuracy20: 0.5253 - val_loss: 2.9860 - val_accuracy20: 0.4939 - 117s/epoch - 22ms/step
Epoch 32/50
5452/5452 - 118s - loss: 2.8870 - accuracy20: 0.5255 - val_loss: 2.9887 - val_accuracy20: 0.4939 - 118s/epoch - 22ms/step
Epoch 33/50
5452/5452 - 118s - loss: 2.8854 - accuracy20: 0.5259 - val_loss: 2.9869 - val_accuracy20: 0.4950 - 118s/epoch - 22ms/step
Epoch 34/50
5452/5452 - 118s - loss: 2.8848 - accuracy20: 0.5261 - val_loss: 2.9871 - val_accuracy20: 0.4945 - 118s/epoch - 22ms/step
Epoch 35/50
5452/5452 - 119s - loss: 2.8835 - accuracy20: 0.5265 - val_loss: 2.9876 - val_accuracy20: 0.4945 - 119s/epoch - 22ms/step
Epoch 36/50
5452/5452 - 118s - loss: 2.8818 - accuracy20: 0.5271 - val_loss: 2.9895 - val_accuracy20: 0.4935 - 118s/epoch - 22ms/step
Epoch 37/50
5452/5452 - 118s - loss: 2.8805 - accuracy20: 0.5274 - val_loss: 2.9901 - val_accuracy20: 0.4941 - 118s/epoch - 22ms/step
Epoch 38/50
5452/5452 - 119s - loss: 2.8790 - accuracy20: 0.5272 - val_loss: 2.9927 - val_accuracy20: 0.4935 - 119s/epoch - 22ms/step
Epoch 39/50
5452/5452 - 119s - loss: 2.8781 - accuracy20: 0.5275 - val_loss: 2.9859 - val_accuracy20: 0.4960 - 119s/epoch - 22ms/step
Epoch 40/50
5452/5452 - 119s - loss: 2.8766 - accuracy20: 0.5283 - val_loss: 2.9870 - val_accuracy20: 0.4960 - 119s/epoch - 22ms/step
Epoch 41/50
5452/5452 - 119s - loss: 2.8757 - accuracy20: 0.5288 - val_loss: 2.9994 - val_accuracy20: 0.4924 - 119s/epoch - 22ms/step
Epoch 42/50
5452/5452 - 120s - loss: 2.8742 - accuracy20: 0.5287 - val_loss: 2.9916 - val_accuracy20: 0.4945 - 120s/epoch - 22ms/step
Epoch 43/50
5452/5452 - 121s - loss: 2.8734 - accuracy20: 0.5290 - val_loss: 2.9914 - val_accuracy20: 0.4948 - 121s/epoch - 22ms/step
Epoch 44/50
5452/5452 - 118s - loss: 2.8717 - accuracy20: 0.5294 - val_loss: 2.9937 - val_accuracy20: 0.4946 - 118s/epoch - 22ms/step
Epoch 45/50
5452/5452 - 118s - loss: 2.8713 - accuracy20: 0.5295 - val_loss: 3.0013 - val_accuracy20: 0.4940 - 118s/epoch - 22ms/step
Epoch 46/50
5452/5452 - 118s - loss: 2.8699 - accuracy20: 0.5299 - val_loss: 2.9953 - val_accuracy20: 0.4948 - 118s/epoch - 22ms/step
Epoch 47/50
5452/5452 - 117s - loss: 2.8683 - accuracy20: 0.5306 - val_loss: 3.0036 - val_accuracy20: 0.4932 - 117s/epoch - 22ms/step
Epoch 48/50
5452/5452 - 118s - loss: 2.8670 - accuracy20: 0.5305 - val_loss: 2.9923 - val_accuracy20: 0.4954 - 118s/epoch - 22ms/step
Epoch 49/50
5452/5452 - 118s - loss: 2.8665 - accuracy20: 0.5307 - val_loss: 2.9912 - val_accuracy20: 0.4948 - 118s/epoch - 22ms/step
testing model: results/AAPL/W6/deepOF_L2/h20
Evaluating performance on  test set...
29350/29350 - 220s - 220s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0401464
{'0': {'precision': 0.45603636297174793, 'recall': 0.3868198753912326, 'f1-score': 0.41858604366794316, 'support': 2322148}, '1': {'precision': 0.4614072159122611, 'recall': 0.556796119019051, 'f1-score': 0.5046334819256182, 'support': 2896175}, '2': {'precision': 0.4532138025017718, 'recall': 0.4045787590476307, 'f1-score': 0.4275175281730736, 'support': 2295076}, 'accuracy': 0.45776498759083606, 'macro avg': {'precision': 0.45688579379526023, 'recall': 0.44939825115263804, 'f1-score': 0.4502456845888783, 'support': 7513399}, 'weighted avg': {'precision': 0.45724446322328516, 'recall': 0.45776498759083606, 'f1-score': 0.4544828295604558, 'support': 7513399}}
[[ 898253  950533  473362]
 [ 636709 1612579  646887]
 [ 434734  931803  928539]]
Evaluating performance on  train set...
5452/5452 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0034404
{'0': {'precision': 0.5295699952482645, 'recall': 0.4172589269384286, 'f1-score': 0.4667533971094934, 'support': 464745}, '1': {'precision': 0.46094135935745745, 'recall': 0.5721606051315257, 'f1-score': 0.5105642931006609, 'support': 466411}, '2': {'precision': 0.5025169815761834, 'recall': 0.48739115733432115, 'f1-score': 0.49483850794504614, 'support': 464317}, 'accuracy': 0.4923671042005112, 'macro avg': {'precision': 0.49767611206063517, 'recall': 0.49227022980142515, 'f1-score': 0.4907187327184001, 'support': 1395473}, 'weighted avg': {'precision': 0.4976307711689402, 'recall': 0.4923671042005112, 'f1-score': 0.49074116198775886, 'support': 1395473}}
[[193919 158208 112618]
 [ 88130 266862 111419]
 [ 84133 153880 226304]]
Evaluating performance on  val set...
1969/1969 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9952585
{'0': {'precision': 0.523343241825494, 'recall': 0.3658735877705433, 'f1-score': 0.4306654196123277, 'support': 155428}, '1': {'precision': 0.48600901344266234, 'recall': 0.6451030516878667, 'f1-score': 0.554367524465386, 'support': 194417}, '2': {'precision': 0.49225291607811156, 'recall': 0.43838876388465603, 'f1-score': 0.4637620515916161, 'support': 154217}, 'accuracy': 0.4957584582848935, 'macro avg': {'precision': 0.5005350571154226, 'recall': 0.4831218011143554, 'f1-score': 0.48293166522310993, 'support': 504062}, 'weighted avg': {'precision': 0.49943137097371565, 'recall': 0.4957584582848935, 'f1-score': 0.48850325585700977, 'support': 504062}}
[[ 56867  67771  30790]
 [ 30053 125419  38945]
 [ 21741  64869  67607]]
training model: results/AAPL/W6/deepOF_L2/h30
Epoch 1/50
5452/5452 - 124s - loss: 3.1129 - accuracy30: 0.4611 - val_loss: 3.1875 - val_accuracy30: 0.4183 - 124s/epoch - 23ms/step
Epoch 2/50
5452/5452 - 120s - loss: 3.0633 - accuracy30: 0.4763 - val_loss: 3.1599 - val_accuracy30: 0.4272 - 120s/epoch - 22ms/step
Epoch 3/50
5452/5452 - 118s - loss: 3.0424 - accuracy30: 0.4827 - val_loss: 3.1568 - val_accuracy30: 0.4282 - 118s/epoch - 22ms/step
Epoch 4/50
5452/5452 - 118s - loss: 3.0312 - accuracy30: 0.4859 - val_loss: 3.1316 - val_accuracy30: 0.4363 - 118s/epoch - 22ms/step
Epoch 5/50
5452/5452 - 118s - loss: 3.0242 - accuracy30: 0.4881 - val_loss: 3.1291 - val_accuracy30: 0.4367 - 118s/epoch - 22ms/step
Epoch 6/50
5452/5452 - 118s - loss: 3.0191 - accuracy30: 0.4892 - val_loss: 3.1079 - val_accuracy30: 0.4458 - 118s/epoch - 22ms/step
Epoch 7/50
5452/5452 - 117s - loss: 3.0146 - accuracy30: 0.4901 - val_loss: 3.1046 - val_accuracy30: 0.4466 - 117s/epoch - 22ms/step
Epoch 8/50
5452/5452 - 118s - loss: 3.0108 - accuracy30: 0.4916 - val_loss: 3.0997 - val_accuracy30: 0.4489 - 118s/epoch - 22ms/step
Epoch 9/50
5452/5452 - 118s - loss: 3.0076 - accuracy30: 0.4924 - val_loss: 3.0975 - val_accuracy30: 0.4503 - 118s/epoch - 22ms/step
Epoch 10/50
5452/5452 - 119s - loss: 3.0048 - accuracy30: 0.4929 - val_loss: 3.0931 - val_accuracy30: 0.4529 - 119s/epoch - 22ms/step
Epoch 11/50
5452/5452 - 118s - loss: 3.0020 - accuracy30: 0.4939 - val_loss: 3.0896 - val_accuracy30: 0.4543 - 118s/epoch - 22ms/step
Epoch 12/50
5452/5452 - 118s - loss: 2.9998 - accuracy30: 0.4946 - val_loss: 3.0859 - val_accuracy30: 0.4571 - 118s/epoch - 22ms/step
Epoch 13/50
5452/5452 - 118s - loss: 2.9976 - accuracy30: 0.4955 - val_loss: 3.1039 - val_accuracy30: 0.4527 - 118s/epoch - 22ms/step
Epoch 14/50
5452/5452 - 117s - loss: 2.9955 - accuracy30: 0.4957 - val_loss: 3.0856 - val_accuracy30: 0.4573 - 117s/epoch - 22ms/step
Epoch 15/50
5452/5452 - 117s - loss: 2.9933 - accuracy30: 0.4965 - val_loss: 3.0832 - val_accuracy30: 0.4590 - 117s/epoch - 22ms/step
Epoch 16/50
5452/5452 - 117s - loss: 2.9919 - accuracy30: 0.4972 - val_loss: 3.0801 - val_accuracy30: 0.4603 - 117s/epoch - 21ms/step
Epoch 17/50
5452/5452 - 117s - loss: 2.9896 - accuracy30: 0.4975 - val_loss: 3.0829 - val_accuracy30: 0.4610 - 117s/epoch - 21ms/step
Epoch 18/50
5452/5452 - 117s - loss: 2.9881 - accuracy30: 0.4983 - val_loss: 3.0788 - val_accuracy30: 0.4616 - 117s/epoch - 22ms/step
Epoch 19/50
5452/5452 - 117s - loss: 2.9861 - accuracy30: 0.4987 - val_loss: 3.0794 - val_accuracy30: 0.4616 - 117s/epoch - 21ms/step
Epoch 20/50
5452/5452 - 117s - loss: 2.9848 - accuracy30: 0.4987 - val_loss: 3.0772 - val_accuracy30: 0.4628 - 117s/epoch - 21ms/step
Epoch 21/50
5452/5452 - 117s - loss: 2.9827 - accuracy30: 0.4997 - val_loss: 3.0755 - val_accuracy30: 0.4636 - 117s/epoch - 22ms/step
Epoch 22/50
5452/5452 - 117s - loss: 2.9814 - accuracy30: 0.5002 - val_loss: 3.0782 - val_accuracy30: 0.4632 - 117s/epoch - 21ms/step
Epoch 23/50
5452/5452 - 118s - loss: 2.9793 - accuracy30: 0.5005 - val_loss: 3.0768 - val_accuracy30: 0.4629 - 118s/epoch - 22ms/step
Epoch 24/50
5452/5452 - 117s - loss: 2.9778 - accuracy30: 0.5011 - val_loss: 3.0762 - val_accuracy30: 0.4634 - 117s/epoch - 22ms/step
Epoch 25/50
5452/5452 - 118s - loss: 2.9766 - accuracy30: 0.5016 - val_loss: 3.0781 - val_accuracy30: 0.4637 - 118s/epoch - 22ms/step
Epoch 26/50
5452/5452 - 118s - loss: 2.9748 - accuracy30: 0.5022 - val_loss: 3.0727 - val_accuracy30: 0.4664 - 118s/epoch - 22ms/step
Epoch 27/50
5452/5452 - 118s - loss: 2.9733 - accuracy30: 0.5024 - val_loss: 3.0753 - val_accuracy30: 0.4661 - 118s/epoch - 22ms/step
Epoch 28/50
5452/5452 - 118s - loss: 2.9718 - accuracy30: 0.5031 - val_loss: 3.0754 - val_accuracy30: 0.4658 - 118s/epoch - 22ms/step
Epoch 29/50
5452/5452 - 118s - loss: 2.9706 - accuracy30: 0.5033 - val_loss: 3.0784 - val_accuracy30: 0.4651 - 118s/epoch - 22ms/step
Epoch 30/50
5452/5452 - 118s - loss: 2.9690 - accuracy30: 0.5036 - val_loss: 3.0720 - val_accuracy30: 0.4671 - 118s/epoch - 22ms/step
Epoch 31/50
5452/5452 - 118s - loss: 2.9672 - accuracy30: 0.5043 - val_loss: 3.0754 - val_accuracy30: 0.4658 - 118s/epoch - 22ms/step
Epoch 32/50
5452/5452 - 118s - loss: 2.9660 - accuracy30: 0.5045 - val_loss: 3.0742 - val_accuracy30: 0.4673 - 118s/epoch - 22ms/step
Epoch 33/50
5452/5452 - 118s - loss: 2.9646 - accuracy30: 0.5052 - val_loss: 3.0787 - val_accuracy30: 0.4654 - 118s/epoch - 22ms/step
Epoch 34/50
5452/5452 - 119s - loss: 2.9630 - accuracy30: 0.5056 - val_loss: 3.0804 - val_accuracy30: 0.4656 - 119s/epoch - 22ms/step
Epoch 35/50
5452/5452 - 118s - loss: 2.9617 - accuracy30: 0.5061 - val_loss: 3.0844 - val_accuracy30: 0.4637 - 118s/epoch - 22ms/step
Epoch 36/50
5452/5452 - 117s - loss: 2.9597 - accuracy30: 0.5061 - val_loss: 3.0852 - val_accuracy30: 0.4659 - 117s/epoch - 22ms/step
Epoch 37/50
5452/5452 - 117s - loss: 2.9584 - accuracy30: 0.5070 - val_loss: 3.0812 - val_accuracy30: 0.4662 - 117s/epoch - 21ms/step
Epoch 38/50
5452/5452 - 117s - loss: 2.9570 - accuracy30: 0.5074 - val_loss: 3.0803 - val_accuracy30: 0.4669 - 117s/epoch - 21ms/step
Epoch 39/50
5452/5452 - 118s - loss: 2.9555 - accuracy30: 0.5077 - val_loss: 3.0857 - val_accuracy30: 0.4661 - 118s/epoch - 22ms/step
Epoch 40/50
5452/5452 - 118s - loss: 2.9539 - accuracy30: 0.5084 - val_loss: 3.0880 - val_accuracy30: 0.4649 - 118s/epoch - 22ms/step
testing model: results/AAPL/W6/deepOF_L2/h30
Evaluating performance on  test set...
29350/29350 - 220s - 220s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0512656
{'0': {'precision': 0.4075586277315384, 'recall': 0.4111376200752923, 'f1-score': 0.4093403009860446, 'support': 2213507}, '1': {'precision': 0.4664882821066451, 'recall': 0.5089095041776146, 'f1-score': 0.4867764181748399, 'support': 3113978}, '2': {'precision': 0.42139511569856936, 'recall': 0.36305774152139564, 'f1-score': 0.39005724202689807, 'support': 2185914}, 'accuracy': 0.4376716849457882, 'macro avg': {'precision': 0.431814008512251, 'recall': 0.4277016219247675, 'f1-score': 0.42872465372926083, 'support': 7513399}, 'weighted avg': {'precision': 0.4360079380942185, 'recall': 0.4376716849457882, 'f1-score': 0.43582408772353937, 'support': 7513399}}
[[ 910056  909042  394409]
 [ 833968 1584733  695277]
 [ 488921  903380  793613]]
Evaluating performance on  train set...
5452/5452 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0302156
{'0': {'precision': 0.4982873672949518, 'recall': 0.44392421509714586, 'f1-score': 0.46953748511060533, 'support': 467956}, '1': {'precision': 0.42230742026466134, 'recall': 0.5212128582255336, 'f1-score': 0.46657620950811, 'support': 460499}, '2': {'precision': 0.4935937126726504, 'recall': 0.43356572980056446, 'f1-score': 0.4616364962837992, 'support': 467018}, 'accuracy': 0.46596243710913793, 'macro avg': {'precision': 0.47139616674408785, 'recall': 0.466234267707748, 'f1-score': 0.4659167303008382, 'support': 1395473}, 'weighted avg': {'precision': 0.4716435620605261, 'recall': 0.46596243710913793, 'f1-score': 0.46591608329660333, 'support': 1395473}}
[[207737 162950  97269]
 [110011 240018 110470]
 [ 99154 165381 202483]]
Evaluating performance on  val set...
1969/1969 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0244838
{'0': {'precision': 0.4877492704280156, 'recall': 0.4009871606635219, 'f1-score': 0.4401331783472032, 'support': 160055}, '1': {'precision': 0.449206416209371, 'recall': 0.5712836259978419, 'f1-score': 0.5029432128872787, 'support': 186277}, '2': {'precision': 0.47773237545914526, 'recall': 0.41063843276485135, 'f1-score': 0.44165177901727876, 'support': 157730}, 'accuracy': 0.46694057477056394, 'macro avg': {'precision': 0.4715626873655106, 'recall': 0.4609697398087384, 'f1-score': 0.4615760567505869, 'support': 504062}, 'weighted avg': {'precision': 0.4703712254678195, 'recall': 0.46694057477056394, 'f1-score': 0.4638199345155172, 'support': 504062}}
[[ 64180  65984  29891]
 [ 38943 106417  40917]
 [ 28461  64499  64770]]
training model: results/AAPL/W6/deepOF_L2/h50
Epoch 1/50
5452/5452 - 126s - loss: 3.1038 - accuracy50: 0.4654 - val_loss: 3.2142 - val_accuracy50: 0.4045 - 126s/epoch - 23ms/step
Epoch 2/50
5452/5452 - 119s - loss: 3.0599 - accuracy50: 0.4791 - val_loss: 3.1958 - val_accuracy50: 0.4143 - 119s/epoch - 22ms/step
Epoch 3/50
5452/5452 - 118s - loss: 3.0426 - accuracy50: 0.4845 - val_loss: 3.1968 - val_accuracy50: 0.4141 - 118s/epoch - 22ms/step
Epoch 4/50
5452/5452 - 122s - loss: 3.0351 - accuracy50: 0.4868 - val_loss: 3.1896 - val_accuracy50: 0.4173 - 122s/epoch - 22ms/step
Epoch 5/50
5452/5452 - 120s - loss: 3.0300 - accuracy50: 0.4881 - val_loss: 3.1802 - val_accuracy50: 0.4198 - 120s/epoch - 22ms/step
Epoch 6/50
5452/5452 - 119s - loss: 3.0258 - accuracy50: 0.4896 - val_loss: 3.1794 - val_accuracy50: 0.4194 - 119s/epoch - 22ms/step
Epoch 7/50
5452/5452 - 119s - loss: 3.0228 - accuracy50: 0.4904 - val_loss: 3.1678 - val_accuracy50: 0.4276 - 119s/epoch - 22ms/step
Epoch 8/50
5452/5452 - 120s - loss: 3.0204 - accuracy50: 0.4911 - val_loss: 3.1660 - val_accuracy50: 0.4276 - 120s/epoch - 22ms/step
Epoch 9/50
5452/5452 - 120s - loss: 3.0175 - accuracy50: 0.4924 - val_loss: 3.1649 - val_accuracy50: 0.4279 - 120s/epoch - 22ms/step
Epoch 10/50
5452/5452 - 121s - loss: 3.0158 - accuracy50: 0.4928 - val_loss: 3.1568 - val_accuracy50: 0.4330 - 121s/epoch - 22ms/step
Epoch 11/50
5452/5452 - 124s - loss: 3.0135 - accuracy50: 0.4932 - val_loss: 3.1553 - val_accuracy50: 0.4353 - 124s/epoch - 23ms/step
Epoch 12/50
5452/5452 - 127s - loss: 3.0116 - accuracy50: 0.4939 - val_loss: 3.1512 - val_accuracy50: 0.4360 - 127s/epoch - 23ms/step
Epoch 13/50
5452/5452 - 125s - loss: 3.0096 - accuracy50: 0.4944 - val_loss: 3.1509 - val_accuracy50: 0.4363 - 125s/epoch - 23ms/step
Epoch 14/50
5452/5452 - 121s - loss: 3.0076 - accuracy50: 0.4949 - val_loss: 3.1506 - val_accuracy50: 0.4365 - 121s/epoch - 22ms/step
Epoch 15/50
5452/5452 - 121s - loss: 3.0057 - accuracy50: 0.4956 - val_loss: 3.1476 - val_accuracy50: 0.4379 - 121s/epoch - 22ms/step
Epoch 16/50
5452/5452 - 121s - loss: 3.0042 - accuracy50: 0.4963 - val_loss: 3.1441 - val_accuracy50: 0.4413 - 121s/epoch - 22ms/step
Epoch 17/50
5452/5452 - 121s - loss: 3.0024 - accuracy50: 0.4966 - val_loss: 3.1453 - val_accuracy50: 0.4392 - 121s/epoch - 22ms/step
Epoch 18/50
5452/5452 - 122s - loss: 3.0006 - accuracy50: 0.4970 - val_loss: 3.1406 - val_accuracy50: 0.4421 - 122s/epoch - 22ms/step
Epoch 19/50
5452/5452 - 121s - loss: 2.9991 - accuracy50: 0.4976 - val_loss: 3.1398 - val_accuracy50: 0.4429 - 121s/epoch - 22ms/step
Epoch 20/50
5452/5452 - 121s - loss: 2.9968 - accuracy50: 0.4983 - val_loss: 3.1366 - val_accuracy50: 0.4452 - 121s/epoch - 22ms/step
Epoch 21/50
5452/5452 - 125s - loss: 2.9955 - accuracy50: 0.4986 - val_loss: 3.1363 - val_accuracy50: 0.4461 - 125s/epoch - 23ms/step
Epoch 22/50
5452/5452 - 127s - loss: 2.9940 - accuracy50: 0.4992 - val_loss: 3.1406 - val_accuracy50: 0.4432 - 127s/epoch - 23ms/step
Epoch 23/50
5452/5452 - 123s - loss: 2.9919 - accuracy50: 0.4998 - val_loss: 3.1381 - val_accuracy50: 0.4450 - 123s/epoch - 23ms/step
Epoch 24/50
5452/5452 - 124s - loss: 2.9906 - accuracy50: 0.5002 - val_loss: 3.1363 - val_accuracy50: 0.4453 - 124s/epoch - 23ms/step
Epoch 25/50
5452/5452 - 125s - loss: 2.9891 - accuracy50: 0.5006 - val_loss: 3.1386 - val_accuracy50: 0.4437 - 125s/epoch - 23ms/step
Epoch 26/50
5452/5452 - 120s - loss: 2.9867 - accuracy50: 0.5011 - val_loss: 3.1425 - val_accuracy50: 0.4413 - 120s/epoch - 22ms/step
Epoch 27/50
5452/5452 - 122s - loss: 2.9851 - accuracy50: 0.5017 - val_loss: 3.1379 - val_accuracy50: 0.4442 - 122s/epoch - 22ms/step
Epoch 28/50
5452/5452 - 120s - loss: 2.9840 - accuracy50: 0.5018 - val_loss: 3.1401 - val_accuracy50: 0.4428 - 120s/epoch - 22ms/step
Epoch 29/50
5452/5452 - 121s - loss: 2.9825 - accuracy50: 0.5023 - val_loss: 3.1368 - val_accuracy50: 0.4451 - 121s/epoch - 22ms/step
Epoch 30/50
5452/5452 - 122s - loss: 2.9802 - accuracy50: 0.5032 - val_loss: 3.1434 - val_accuracy50: 0.4423 - 122s/epoch - 22ms/step
Epoch 31/50
5452/5452 - 124s - loss: 2.9784 - accuracy50: 0.5036 - val_loss: 3.1388 - val_accuracy50: 0.4443 - 124s/epoch - 23ms/step
Epoch 32/50
5452/5452 - 125s - loss: 2.9767 - accuracy50: 0.5039 - val_loss: 3.1478 - val_accuracy50: 0.4399 - 125s/epoch - 23ms/step
Epoch 33/50
5452/5452 - 121s - loss: 2.9748 - accuracy50: 0.5046 - val_loss: 3.1461 - val_accuracy50: 0.4410 - 121s/epoch - 22ms/step
Epoch 34/50
5452/5452 - 123s - loss: 2.9732 - accuracy50: 0.5049 - val_loss: 3.1458 - val_accuracy50: 0.4403 - 123s/epoch - 22ms/step
testing model: results/AAPL/W6/deepOF_L2/h50
Evaluating performance on  test set...
29350/29350 - 231s - 231s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0807846
{'0': {'precision': 0.36572908354065936, 'recall': 0.528169007719146, 'f1-score': 0.4321896847893819, 'support': 2212680}, '1': {'precision': 0.4710818989801595, 'recall': 0.21413966790112549, 'f1-score': 0.29443708802387986, 'support': 3112025}, '2': {'precision': 0.367573147394221, 'recall': 0.48758803194964667, 'f1-score': 0.41915903543001687, 'support': 2188694}, 'accuracy': 0.3862776354616599, 'macro avg': {'precision': 0.4014613766383466, 'recall': 0.4099655691899727, 'f1-score': 0.3819286027477595, 'support': 7513399}, 'weighted avg': {'precision': 0.40990305685952844, 'recall': 0.3862776354616599, 'f1-score': 0.37133711606274994, 'support': 7513399}}
[[1168669  381471  662540]
 [1272022  666408 1173595]
 [ 754759  366754 1067181]]
Evaluating performance on  train set...
5452/5452 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0462658
{'0': {'precision': 0.4378655895835091, 'recall': 0.5310989688040302, 'f1-score': 0.4799968401105576, 'support': 469067}, '1': {'precision': 0.49469540011633106, 'recall': 0.22382005659117551, 'f1-score': 0.3081986655006768, 'support': 459789}, '2': {'precision': 0.43364451529663606, 'recall': 0.5747968890974825, 'f1-score': 0.4943420951987754, 'support': 466617}, 'accuracy': 0.4444664998892848, 'macro avg': {'precision': 0.45540183499882536, 'recall': 0.4432386381642294, 'f1-score': 0.4275125336033366, 'support': 1395473}, 'weighted avg': {'precision': 0.45517878499077086, 'recall': 0.4444664998892848, 'f1-score': 0.4281884776325996, 'support': 1395473}}
[[249121  52502 167444]
 [174031 102910 182848]
 [145792  52615 268210]]
Evaluating performance on  val set...
1969/1969 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0448059
{'0': {'precision': 0.4316481949896298, 'recall': 0.5311753813167, 'f1-score': 0.4762677196748127, 'support': 164168}, '1': {'precision': 0.5141435650059036, 'recall': 0.2828471813548595, 'f1-score': 0.3649328648737702, 'support': 180122}, '2': {'precision': 0.4265681202266568, 'recall': 0.5418471321633328, 'f1-score': 0.47734628723926315, 'support': 159772}, 'accuracy': 0.44582015704417316, 'macro avg': {'precision': 0.4574532934073967, 'recall': 0.451956564944964, 'f1-score': 0.43951562392928195, 'support': 504062}, 'weighted avg': {'precision': 0.45951694393924614, 'recall': 0.44582015704417316, 'f1-score': 0.43682508797560504, 'support': 504062}}
[[87202 23988 52978]
 [65775 50947 63400]
 [49044 24156 86572]]
training model: results/AAPL/W6/deepOF_L2/h100
Epoch 1/50
5452/5452 - 126s - loss: 3.2049 - accuracy100: 0.4229 - val_loss: 3.2712 - val_accuracy100: 0.3767 - 126s/epoch - 23ms/step
Epoch 2/50
5452/5452 - 123s - loss: 3.1799 - accuracy100: 0.4335 - val_loss: 3.2611 - val_accuracy100: 0.3791 - 123s/epoch - 23ms/step
Epoch 3/50
5452/5452 - 124s - loss: 3.1669 - accuracy100: 0.4389 - val_loss: 3.2541 - val_accuracy100: 0.3794 - 124s/epoch - 23ms/step
Epoch 4/50
5452/5452 - 123s - loss: 3.1602 - accuracy100: 0.4410 - val_loss: 3.2486 - val_accuracy100: 0.3799 - 123s/epoch - 23ms/step
Epoch 5/50
5452/5452 - 123s - loss: 3.1563 - accuracy100: 0.4423 - val_loss: 3.2424 - val_accuracy100: 0.3819 - 123s/epoch - 22ms/step
Epoch 6/50
5452/5452 - 122s - loss: 3.1530 - accuracy100: 0.4435 - val_loss: 3.2380 - val_accuracy100: 0.3832 - 122s/epoch - 22ms/step
Epoch 7/50
5452/5452 - 124s - loss: 3.1504 - accuracy100: 0.4443 - val_loss: 3.2353 - val_accuracy100: 0.3836 - 124s/epoch - 23ms/step
Epoch 8/50
5452/5452 - 124s - loss: 3.1483 - accuracy100: 0.4452 - val_loss: 3.2321 - val_accuracy100: 0.3867 - 124s/epoch - 23ms/step
Epoch 9/50
5452/5452 - 124s - loss: 3.1463 - accuracy100: 0.4457 - val_loss: 3.2302 - val_accuracy100: 0.3868 - 124s/epoch - 23ms/step
Epoch 10/50
5452/5452 - 120s - loss: 3.1446 - accuracy100: 0.4464 - val_loss: 3.2281 - val_accuracy100: 0.3886 - 120s/epoch - 22ms/step
Epoch 11/50
5452/5452 - 123s - loss: 3.1427 - accuracy100: 0.4469 - val_loss: 3.2274 - val_accuracy100: 0.3893 - 123s/epoch - 23ms/step
Epoch 12/50
5452/5452 - 124s - loss: 3.1411 - accuracy100: 0.4477 - val_loss: 3.2273 - val_accuracy100: 0.3907 - 124s/epoch - 23ms/step
Epoch 13/50
5452/5452 - 123s - loss: 3.1394 - accuracy100: 0.4484 - val_loss: 3.2271 - val_accuracy100: 0.3912 - 123s/epoch - 23ms/step
Epoch 14/50
5452/5452 - 121s - loss: 3.1375 - accuracy100: 0.4490 - val_loss: 3.2291 - val_accuracy100: 0.3905 - 121s/epoch - 22ms/step
Epoch 15/50
5452/5452 - 119s - loss: 3.1359 - accuracy100: 0.4499 - val_loss: 3.2292 - val_accuracy100: 0.3912 - 119s/epoch - 22ms/step
Epoch 16/50
5452/5452 - 119s - loss: 3.1342 - accuracy100: 0.4504 - val_loss: 3.2300 - val_accuracy100: 0.3908 - 119s/epoch - 22ms/step
Epoch 17/50
5452/5452 - 118s - loss: 3.1324 - accuracy100: 0.4512 - val_loss: 3.2313 - val_accuracy100: 0.3903 - 118s/epoch - 22ms/step
Epoch 18/50
5452/5452 - 119s - loss: 3.1307 - accuracy100: 0.4521 - val_loss: 3.2344 - val_accuracy100: 0.3902 - 119s/epoch - 22ms/step
Epoch 19/50
5452/5452 - 120s - loss: 3.1285 - accuracy100: 0.4526 - val_loss: 3.2357 - val_accuracy100: 0.3915 - 120s/epoch - 22ms/step
Epoch 20/50
5452/5452 - 120s - loss: 3.1269 - accuracy100: 0.4534 - val_loss: 3.2359 - val_accuracy100: 0.3921 - 120s/epoch - 22ms/step
Epoch 21/50
5452/5452 - 118s - loss: 3.1250 - accuracy100: 0.4541 - val_loss: 3.2367 - val_accuracy100: 0.3934 - 118s/epoch - 22ms/step
Epoch 22/50
5452/5452 - 118s - loss: 3.1227 - accuracy100: 0.4551 - val_loss: 3.2445 - val_accuracy100: 0.3927 - 118s/epoch - 22ms/step
Epoch 23/50
5452/5452 - 118s - loss: 3.1206 - accuracy100: 0.4561 - val_loss: 3.2450 - val_accuracy100: 0.3924 - 118s/epoch - 22ms/step
testing model: results/AAPL/W6/deepOF_L2/h100
Evaluating performance on  test set...
29350/29350 - 218s - 218s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0774556
{'0': {'precision': 0.4168054913098469, 'recall': 0.11423382594329733, 'f1-score': 0.17932113272811595, 'support': 2255943}, '1': {'precision': 0.4057459614480098, 'recall': 0.7732587233226795, 'f1-score': 0.5322228286203008, 'support': 3025510}, '2': {'precision': 0.37716494639939424, 'recall': 0.19081510036533142, 'f1-score': 0.2534200541424895, 'support': 2231946}, 'accuracy': 0.40236063597846994, 'macro avg': {'precision': 0.39990546638575025, 'recall': 0.35943588321043607, 'f1-score': 0.3216546718303021, 'support': 7513399}, 'weighted avg': {'precision': 0.4005763154278004, 'recall': 0.40236063597846994, 'f1-score': 0.3434402486161301, 'support': 7513399}}
[[ 257705 1747219  251019]
 [ 233731 2339502  452277]
 [ 126850 1679207  425889]]
Evaluating performance on  train set...
5452/5452 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0886185
{'0': {'precision': 0.4621352212888114, 'recall': 0.11186496314580109, 'f1-score': 0.1801279543098773, 'support': 469146}, '1': {'precision': 0.33724837784748113, 'recall': 0.7745243686203096, 'f1-score': 0.4698929484472867, 'support': 459074}, '2': {'precision': 0.44229400444635814, 'recall': 0.21544430961384944, 'f1-score': 0.2897496600010074, 'support': 467253}, 'accuracy': 0.36454449494902447, 'macro avg': {'precision': 0.4138925345275502, 'recall': 0.3672778804599867, 'f1-score': 0.3132568542527238, 'support': 1395473}, 'weighted avg': {'precision': 0.4144071958384644, 'recall': 0.36454449494902447, 'f1-score': 0.31215820195202776, 'support': 1395473}}
[[ 52481 357027  59638]
 [ 36213 355564  67297]
 [ 24868 341718 100667]]
Evaluating performance on  val set...
1969/1969 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.076278
{'0': {'precision': 0.4207407726616535, 'recall': 0.12209945787765668, 'f1-score': 0.18927197123166842, 'support': 159927}, '1': {'precision': 0.3798603265892985, 'recall': 0.7860000318760658, 'f1-score': 0.5121886624580887, 'support': 188229}, '2': {'precision': 0.4325152924263983, 'recall': 0.18912036740086977, 'f1-score': 0.26316846441178704, 'support': 155906}, 'accuracy': 0.3907455828846451, 'macro avg': {'precision': 0.41103879722578346, 'recall': 0.36573995238486406, 'f1-score': 0.3215430327005147, 'support': 504062}, 'weighted avg': {'precision': 0.40911687082951576, 'recall': 0.3907455828846451, 'f1-score': 0.3327130410575974, 'support': 504062}}
[[ 19527 124002  16398]
 [ 17993 147948  22288]
 [  8891 117530  29485]]
training model: results/AAPL/W6/deepOF_L2/h200
Epoch 1/50
5452/5452 - 123s - loss: 3.1783 - accuracy200: 0.4294 - val_loss: 3.2916 - val_accuracy200: 0.3761 - 123s/epoch - 22ms/step
Epoch 2/50
5452/5452 - 119s - loss: 3.1554 - accuracy200: 0.4397 - val_loss: 3.2797 - val_accuracy200: 0.3770 - 119s/epoch - 22ms/step
Epoch 3/50
5452/5452 - 119s - loss: 3.1441 - accuracy200: 0.4440 - val_loss: 3.2725 - val_accuracy200: 0.3775 - 119s/epoch - 22ms/step
Epoch 4/50
5452/5452 - 123s - loss: 3.1399 - accuracy200: 0.4452 - val_loss: 3.2671 - val_accuracy200: 0.3783 - 123s/epoch - 23ms/step
Epoch 5/50
5452/5452 - 124s - loss: 3.1371 - accuracy200: 0.4464 - val_loss: 3.2648 - val_accuracy200: 0.3782 - 124s/epoch - 23ms/step
Epoch 6/50
5452/5452 - 125s - loss: 3.1344 - accuracy200: 0.4472 - val_loss: 3.2630 - val_accuracy200: 0.3793 - 125s/epoch - 23ms/step
Epoch 7/50
5452/5452 - 122s - loss: 3.1322 - accuracy200: 0.4485 - val_loss: 3.2609 - val_accuracy200: 0.3798 - 122s/epoch - 22ms/step
Epoch 8/50
5452/5452 - 124s - loss: 3.1305 - accuracy200: 0.4491 - val_loss: 3.2587 - val_accuracy200: 0.3805 - 124s/epoch - 23ms/step
Epoch 9/50
5452/5452 - 122s - loss: 3.1290 - accuracy200: 0.4495 - val_loss: 3.2551 - val_accuracy200: 0.3819 - 122s/epoch - 22ms/step
Epoch 10/50
5452/5452 - 121s - loss: 3.1272 - accuracy200: 0.4503 - val_loss: 3.2529 - val_accuracy200: 0.3819 - 121s/epoch - 22ms/step
Epoch 11/50
5452/5452 - 121s - loss: 3.1259 - accuracy200: 0.4508 - val_loss: 3.2528 - val_accuracy200: 0.3820 - 121s/epoch - 22ms/step
Epoch 12/50
5452/5452 - 121s - loss: 3.1246 - accuracy200: 0.4516 - val_loss: 3.2499 - val_accuracy200: 0.3843 - 121s/epoch - 22ms/step
Epoch 13/50
5452/5452 - 120s - loss: 3.1234 - accuracy200: 0.4520 - val_loss: 3.2514 - val_accuracy200: 0.3830 - 120s/epoch - 22ms/step
Epoch 14/50
5452/5452 - 121s - loss: 3.1219 - accuracy200: 0.4527 - val_loss: 3.2505 - val_accuracy200: 0.3839 - 121s/epoch - 22ms/step
Epoch 15/50
5452/5452 - 123s - loss: 3.1208 - accuracy200: 0.4527 - val_loss: 3.2505 - val_accuracy200: 0.3843 - 123s/epoch - 23ms/step
Epoch 16/50
5452/5452 - 124s - loss: 3.1192 - accuracy200: 0.4534 - val_loss: 3.2531 - val_accuracy200: 0.3838 - 124s/epoch - 23ms/step
Epoch 17/50
5452/5452 - 124s - loss: 3.1181 - accuracy200: 0.4545 - val_loss: 3.2529 - val_accuracy200: 0.3844 - 124s/epoch - 23ms/step
Epoch 18/50
5452/5452 - 125s - loss: 3.1168 - accuracy200: 0.4549 - val_loss: 3.2496 - val_accuracy200: 0.3868 - 125s/epoch - 23ms/step
Epoch 19/50
5452/5452 - 121s - loss: 3.1153 - accuracy200: 0.4552 - val_loss: 3.2524 - val_accuracy200: 0.3856 - 121s/epoch - 22ms/step
Epoch 20/50
5452/5452 - 121s - loss: 3.1138 - accuracy200: 0.4561 - val_loss: 3.2502 - val_accuracy200: 0.3883 - 121s/epoch - 22ms/step
Epoch 21/50
5452/5452 - 124s - loss: 3.1125 - accuracy200: 0.4566 - val_loss: 3.2553 - val_accuracy200: 0.3884 - 124s/epoch - 23ms/step
Epoch 22/50
5452/5452 - 125s - loss: 3.1110 - accuracy200: 0.4573 - val_loss: 3.2563 - val_accuracy200: 0.3881 - 125s/epoch - 23ms/step
Epoch 23/50
5452/5452 - 123s - loss: 3.1092 - accuracy200: 0.4582 - val_loss: 3.2573 - val_accuracy200: 0.3866 - 123s/epoch - 23ms/step
Epoch 24/50
5452/5452 - 125s - loss: 3.1076 - accuracy200: 0.4592 - val_loss: 3.2537 - val_accuracy200: 0.3899 - 125s/epoch - 23ms/step
Epoch 25/50
5452/5452 - 124s - loss: 3.1060 - accuracy200: 0.4599 - val_loss: 3.2561 - val_accuracy200: 0.3883 - 124s/epoch - 23ms/step
Epoch 26/50
5452/5452 - 123s - loss: 3.1040 - accuracy200: 0.4607 - val_loss: 3.2656 - val_accuracy200: 0.3880 - 123s/epoch - 23ms/step
Epoch 27/50
5452/5452 - 121s - loss: 3.1019 - accuracy200: 0.4617 - val_loss: 3.2664 - val_accuracy200: 0.3871 - 121s/epoch - 22ms/step
Epoch 28/50
5452/5452 - 119s - loss: 3.0997 - accuracy200: 0.4632 - val_loss: 3.2719 - val_accuracy200: 0.3861 - 119s/epoch - 22ms/step
testing model: results/AAPL/W6/deepOF_L2/h200
Evaluating performance on  test set...
29350/29350 - 219s - 219s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0800259
{'0': {'precision': 0.3655770782889427, 'recall': 0.03684224320552957, 'f1-score': 0.06693853356081045, 'support': 2212976}, '1': {'precision': 0.4139091200614516, 'recall': 0.8763599554571216, 'f1-score': 0.5622600508728206, 'support': 3069402}, '2': {'precision': 0.36084572268815207, 'recall': 0.12803465319241727, 'f1-score': 0.189006387818812, 'support': 2231021}, 'accuracy': 0.4068837552750759, 'macro avg': {'precision': 0.3801106403461821, 'recall': 0.3470789506183562, 'f1-score': 0.27273499075081437, 'support': 7513399}, 'weighted avg': {'precision': 0.383916941775068, 'recall': 0.4068837552750759, 'f1-score': 0.305535845131121, 'support': 7513399}}
[[  81531 1924208  207237]
 [  80779 2689901  298722]
 [  60710 1884663  285648]]
Evaluating performance on  train set...
5452/5452 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0928426
{'0': {'precision': 0.4352275728497227, 'recall': 0.042475910627676895, 'f1-score': 0.0773981690587365, 'support': 465558}, '1': {'precision': 0.34460717579559885, 'recall': 0.8912289304848489, 'f1-score': 0.49703012100217825, 'support': 464949}, '2': {'precision': 0.4240943772106954, 'recall': 0.13460554105031336, 'f1-score': 0.2043510343746735, 'support': 464966}, 'accuracy': 0.35596389181302684, 'macro avg': {'precision': 0.4013097086186723, 'recall': 0.35610346072094634, 'f1-score': 0.2595931081451961, 'support': 1395473}, 'weighted avg': {'precision': 0.40132478832188606, 'recall': 0.35596389181302684, 'f1-score': 0.2595129232665508, 'support': 1395473}}
[[ 19775 399954  45829]
 [ 11411 414376  39162]
 [ 14250 388129  62587]]
Evaluating performance on  val set...
1969/1969 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0834035
{'0': {'precision': 0.3991829091837603, 'recall': 0.02943668601914326, 'f1-score': 0.05483007353542911, 'support': 159325}, '1': {'precision': 0.38430655316130174, 'recall': 0.9135670394299988, 'f1-score': 0.5410231042672518, 'support': 189754}, '2': {'precision': 0.404045303519026, 'recall': 0.1074956608144119, 'f1-score': 0.16981285929791662, 'support': 154983}, 'accuracy': 0.3862679591002694, 'macro avg': {'precision': 0.395844921954696, 'recall': 0.35016646208785135, 'f1-score': 0.2552220123668658, 'support': 504062}, 'weighted avg': {'precision': 0.3950777403763059, 'recall': 0.3862679591002694, 'f1-score': 0.27321084701034665, 'support': 504062}}
[[  4690 142752  11883]
 [  3711 173353  12690]
 [  3348 134975  16660]]
training model: results/AAPL/W6/deepOF_L2/h300
Epoch 1/50
5452/5452 - 122s - loss: 3.2121 - accuracy300: 0.4117 - val_loss: 3.2973 - val_accuracy300: 0.3590 - 122s/epoch - 22ms/step
Epoch 2/50
5452/5452 - 119s - loss: 3.1959 - accuracy300: 0.4194 - val_loss: 3.2957 - val_accuracy300: 0.3593 - 119s/epoch - 22ms/step
Epoch 3/50
5452/5452 - 118s - loss: 3.1854 - accuracy300: 0.4245 - val_loss: 3.2929 - val_accuracy300: 0.3591 - 118s/epoch - 22ms/step
Epoch 4/50
5452/5452 - 118s - loss: 3.1813 - accuracy300: 0.4262 - val_loss: 3.2919 - val_accuracy300: 0.3594 - 118s/epoch - 22ms/step
Epoch 5/50
5452/5452 - 118s - loss: 3.1787 - accuracy300: 0.4273 - val_loss: 3.2894 - val_accuracy300: 0.3596 - 118s/epoch - 22ms/step
Epoch 6/50
5452/5452 - 119s - loss: 3.1773 - accuracy300: 0.4277 - val_loss: 3.2861 - val_accuracy300: 0.3602 - 119s/epoch - 22ms/step
Epoch 7/50
5452/5452 - 117s - loss: 3.1754 - accuracy300: 0.4287 - val_loss: 3.2847 - val_accuracy300: 0.3605 - 117s/epoch - 22ms/step
Epoch 8/50
5452/5452 - 118s - loss: 3.1742 - accuracy300: 0.4291 - val_loss: 3.2844 - val_accuracy300: 0.3605 - 118s/epoch - 22ms/step
Epoch 9/50
5452/5452 - 118s - loss: 3.1726 - accuracy300: 0.4301 - val_loss: 3.2832 - val_accuracy300: 0.3606 - 118s/epoch - 22ms/step
Epoch 10/50
5452/5452 - 119s - loss: 3.1713 - accuracy300: 0.4307 - val_loss: 3.2825 - val_accuracy300: 0.3606 - 119s/epoch - 22ms/step
Epoch 11/50
5452/5452 - 118s - loss: 3.1703 - accuracy300: 0.4311 - val_loss: 3.2808 - val_accuracy300: 0.3608 - 118s/epoch - 22ms/step
Epoch 12/50
5452/5452 - 118s - loss: 3.1693 - accuracy300: 0.4316 - val_loss: 3.2797 - val_accuracy300: 0.3615 - 118s/epoch - 22ms/step
Epoch 13/50
5452/5452 - 119s - loss: 3.1679 - accuracy300: 0.4321 - val_loss: 3.2787 - val_accuracy300: 0.3626 - 119s/epoch - 22ms/step
Epoch 14/50
5452/5452 - 123s - loss: 3.1668 - accuracy300: 0.4327 - val_loss: 3.2779 - val_accuracy300: 0.3627 - 123s/epoch - 23ms/step
Epoch 15/50
5452/5452 - 124s - loss: 3.1659 - accuracy300: 0.4332 - val_loss: 3.2779 - val_accuracy300: 0.3628 - 124s/epoch - 23ms/step
Epoch 16/50
5452/5452 - 118s - loss: 3.1649 - accuracy300: 0.4339 - val_loss: 3.2781 - val_accuracy300: 0.3630 - 118s/epoch - 22ms/step
Epoch 17/50
5452/5452 - 118s - loss: 3.1638 - accuracy300: 0.4346 - val_loss: 3.2760 - val_accuracy300: 0.3639 - 118s/epoch - 22ms/step
Epoch 18/50
5452/5452 - 121s - loss: 3.1627 - accuracy300: 0.4351 - val_loss: 3.2757 - val_accuracy300: 0.3648 - 121s/epoch - 22ms/step
Epoch 19/50
5452/5452 - 119s - loss: 3.1614 - accuracy300: 0.4361 - val_loss: 3.2758 - val_accuracy300: 0.3661 - 119s/epoch - 22ms/step
Epoch 20/50
5452/5452 - 119s - loss: 3.1602 - accuracy300: 0.4366 - val_loss: 3.2757 - val_accuracy300: 0.3689 - 119s/epoch - 22ms/step
Epoch 21/50
5452/5452 - 118s - loss: 3.1592 - accuracy300: 0.4373 - val_loss: 3.2757 - val_accuracy300: 0.3655 - 118s/epoch - 22ms/step
Epoch 22/50
5452/5452 - 118s - loss: 3.1582 - accuracy300: 0.4376 - val_loss: 3.2762 - val_accuracy300: 0.3686 - 118s/epoch - 22ms/step
Epoch 23/50
5452/5452 - 119s - loss: 3.1566 - accuracy300: 0.4387 - val_loss: 3.2791 - val_accuracy300: 0.3659 - 119s/epoch - 22ms/step
Epoch 24/50
5452/5452 - 119s - loss: 3.1556 - accuracy300: 0.4393 - val_loss: 3.2779 - val_accuracy300: 0.3686 - 119s/epoch - 22ms/step
Epoch 25/50
5452/5452 - 118s - loss: 3.1541 - accuracy300: 0.4402 - val_loss: 3.2820 - val_accuracy300: 0.3669 - 118s/epoch - 22ms/step
Epoch 26/50
5452/5452 - 119s - loss: 3.1521 - accuracy300: 0.4419 - val_loss: 3.2789 - val_accuracy300: 0.3712 - 119s/epoch - 22ms/step
Epoch 27/50
5452/5452 - 118s - loss: 3.1509 - accuracy300: 0.4426 - val_loss: 3.2807 - val_accuracy300: 0.3713 - 118s/epoch - 22ms/step
Epoch 28/50
5452/5452 - 118s - loss: 3.1498 - accuracy300: 0.4438 - val_loss: 3.2814 - val_accuracy300: 0.3695 - 118s/epoch - 22ms/step
Epoch 29/50
5452/5452 - 118s - loss: 3.1480 - accuracy300: 0.4449 - val_loss: 3.2840 - val_accuracy300: 0.3694 - 118s/epoch - 22ms/step
Epoch 30/50
5452/5452 - 118s - loss: 3.1456 - accuracy300: 0.4462 - val_loss: 3.2856 - val_accuracy300: 0.3680 - 118s/epoch - 22ms/step
testing model: results/AAPL/W6/deepOF_L2/h300
Evaluating performance on  test set...
29350/29350 - 219s - 219s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0840498
{'0': {'precision': 0.33309743097381483, 'recall': 0.03052881813204782, 'f1-score': 0.05593144562834582, 'support': 2204671}, '1': {'precision': 0.4169832694179746, 'recall': 0.8444791200820341, 'f1-score': 0.5582943532491558, 'support': 3099198}, '2': {'precision': 0.33296901454182803, 'recall': 0.15594221395500402, 'f1-score': 0.21240635223580281, 'support': 2209530}, 'accuracy': 0.4031561481028759, 'macro avg': {'precision': 0.3610165716445392, 'recall': 0.3436500507230286, 'f1-score': 0.27554405037110147, 'support': 7513399}, 'weighted avg': {'precision': 0.367661691806428, 'recall': 0.4031561481028759, 'f1-score': 0.30916678145557575, 'support': 7513399}}
[[  67306 1850558  286807]
 [  78548 2617208  403442]
 [  56207 1808764  344559]]
Evaluating performance on  train set...
5452/5452 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0982854
{'0': {'precision': 0.41143934320509956, 'recall': 0.03506665370093987, 'f1-score': 0.06462534016156335, 'support': 473042}, '1': {'precision': 0.33517591687031084, 'recall': 0.8677848446785941, 'f1-score': 0.48357451092054343, 'support': 450614}, '2': {'precision': 0.40049974270147537, 'recall': 0.16000483238204644, 'f1-score': 0.2286578809475492, 'support': 471817}, 'accuracy': 0.3462030436991615, 'macro avg': {'precision': 0.38237166759229524, 'recall': 0.35428544358719344, 'f1-score': 0.2589525773432187, 'support': 1395473}, 'weighted avg': {'precision': 0.3831142827523047, 'recall': 0.3462030436991615, 'f1-score': 0.25536905424876427, 'support': 1395473}}
[[ 16588 392021  64433]
 [ 11007 391036  48571]
 [ 12722 383602  75493]]
Evaluating performance on  val set...
1969/1969 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0931567
{'0': {'precision': 0.38800925102294964, 'recall': 0.02665607430945979, 'f1-score': 0.04988506535835593, 'support': 163640}, '1': {'precision': 0.3665577908770533, 'recall': 0.8956618821539702, 'f1-score': 0.5202134745796717, 'support': 180931}, '2': {'precision': 0.3799037968694555, 'recall': 0.1208281345028873, 'f1-score': 0.18334387799274082, 'support': 159491}, 'accuracy': 0.3683792866750519, 'macro avg': {'precision': 0.3781569462564862, 'recall': 0.3477153636554391, 'f1-score': 0.25114747264358944, 'support': 504062}, 'weighted avg': {'precision': 0.3777446781647455, 'recall': 0.3683792866750519, 'f1-score': 0.26093542998551006, 'support': 504062}}
[[  4362 143097  16181]
 [  3604 162053  15274]
 [  3276 136944  19271]]
training model: results/AAPL/W6/deepOF_L2/h500
Epoch 1/50
5452/5452 - 126s - loss: 3.2203 - accuracy500: 0.4094 - val_loss: 3.3005 - val_accuracy500: 0.3722 - 126s/epoch - 23ms/step
Epoch 2/50
5452/5452 - 123s - loss: 3.2229 - accuracy500: 0.4045 - val_loss: 3.2962 - val_accuracy500: 0.3722 - 123s/epoch - 23ms/step
Epoch 3/50
5452/5452 - 123s - loss: 3.2159 - accuracy500: 0.4111 - val_loss: 3.3014 - val_accuracy500: 0.3722 - 123s/epoch - 22ms/step
Epoch 4/50
5452/5452 - 124s - loss: 3.2021 - accuracy500: 0.4177 - val_loss: 3.3010 - val_accuracy500: 0.3721 - 124s/epoch - 23ms/step
Epoch 5/50
5452/5452 - 122s - loss: 3.1917 - accuracy500: 0.4222 - val_loss: 3.2946 - val_accuracy500: 0.3719 - 122s/epoch - 22ms/step
Epoch 6/50
5452/5452 - 120s - loss: 3.1871 - accuracy500: 0.4240 - val_loss: 3.2908 - val_accuracy500: 0.3719 - 120s/epoch - 22ms/step
Epoch 7/50
5452/5452 - 118s - loss: 3.1847 - accuracy500: 0.4252 - val_loss: 3.2883 - val_accuracy500: 0.3720 - 118s/epoch - 22ms/step
Epoch 8/50
5452/5452 - 121s - loss: 3.1828 - accuracy500: 0.4260 - val_loss: 3.2869 - val_accuracy500: 0.3722 - 121s/epoch - 22ms/step
Epoch 9/50
5452/5452 - 118s - loss: 3.1813 - accuracy500: 0.4267 - val_loss: 3.2876 - val_accuracy500: 0.3722 - 118s/epoch - 22ms/step
Epoch 10/50
5452/5452 - 117s - loss: 3.1799 - accuracy500: 0.4273 - val_loss: 3.2876 - val_accuracy500: 0.3723 - 117s/epoch - 22ms/step
Epoch 11/50
5452/5452 - 117s - loss: 3.1787 - accuracy500: 0.4280 - val_loss: 3.2866 - val_accuracy500: 0.3735 - 117s/epoch - 22ms/step
Epoch 12/50
5452/5452 - 118s - loss: 3.1777 - accuracy500: 0.4287 - val_loss: 3.2867 - val_accuracy500: 0.3737 - 118s/epoch - 22ms/step
Epoch 13/50
5452/5452 - 118s - loss: 3.1766 - accuracy500: 0.4293 - val_loss: 3.2854 - val_accuracy500: 0.3738 - 118s/epoch - 22ms/step
Epoch 14/50
5452/5452 - 118s - loss: 3.1753 - accuracy500: 0.4300 - val_loss: 3.2847 - val_accuracy500: 0.3745 - 118s/epoch - 22ms/step
Epoch 15/50
5452/5452 - 117s - loss: 3.1744 - accuracy500: 0.4302 - val_loss: 3.2843 - val_accuracy500: 0.3747 - 117s/epoch - 21ms/step
Epoch 16/50
5452/5452 - 118s - loss: 3.1736 - accuracy500: 0.4306 - val_loss: 3.2858 - val_accuracy500: 0.3749 - 118s/epoch - 22ms/step
Epoch 17/50
5452/5452 - 119s - loss: 3.1724 - accuracy500: 0.4316 - val_loss: 3.2850 - val_accuracy500: 0.3747 - 119s/epoch - 22ms/step
Epoch 18/50
5452/5452 - 119s - loss: 3.1715 - accuracy500: 0.4319 - val_loss: 3.2851 - val_accuracy500: 0.3748 - 119s/epoch - 22ms/step
Epoch 19/50
5452/5452 - 119s - loss: 3.1707 - accuracy500: 0.4324 - val_loss: 3.2859 - val_accuracy500: 0.3747 - 119s/epoch - 22ms/step
Epoch 20/50
5452/5452 - 119s - loss: 3.1697 - accuracy500: 0.4330 - val_loss: 3.2865 - val_accuracy500: 0.3748 - 119s/epoch - 22ms/step
Epoch 21/50
5452/5452 - 120s - loss: 3.1687 - accuracy500: 0.4334 - val_loss: 3.2885 - val_accuracy500: 0.3742 - 120s/epoch - 22ms/step
Epoch 22/50
5452/5452 - 119s - loss: 3.1676 - accuracy500: 0.4340 - val_loss: 3.2897 - val_accuracy500: 0.3744 - 119s/epoch - 22ms/step
Epoch 23/50
5452/5452 - 119s - loss: 3.1669 - accuracy500: 0.4344 - val_loss: 3.2882 - val_accuracy500: 0.3746 - 119s/epoch - 22ms/step
Epoch 24/50
5452/5452 - 120s - loss: 3.1660 - accuracy500: 0.4348 - val_loss: 3.2883 - val_accuracy500: 0.3746 - 120s/epoch - 22ms/step
Epoch 25/50
5452/5452 - 119s - loss: 3.1647 - accuracy500: 0.4354 - val_loss: 3.2907 - val_accuracy500: 0.3747 - 119s/epoch - 22ms/step
testing model: results/AAPL/W6/deepOF_L2/h500
Evaluating performance on  test set...
29350/29350 - 221s - 221s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0937631
{'0': {'precision': 0.31526201851298896, 'recall': 0.007369991182885112, 'f1-score': 0.014403272005958092, 'support': 2292133}, '1': {'precision': 0.3882449262603262, 'recall': 0.9666237604079723, 'f1-score': 0.5539824992249612, 'support': 2912551}, '2': {'precision': 0.33903503088419507, 'recall': 0.03059754019010575, 'f1-score': 0.05612945825192267, 'support': 2308715}, 'accuracy': 0.3863597554182867, 'macro avg': {'precision': 0.34751399188583676, 'recall': 0.33486376392698775, 'f1-score': 0.20817174316094733, 'support': 7513399}, 'weighted avg': {'precision': 0.35085863080510915, 'recall': 0.3863597554182867, 'f1-score': 0.23639146801348906, 'support': 7513399}}
[[  16893 2213518   61722]
 [  21214 2815341   75996]
 [  15477 2222597   70641]]
Evaluating performance on  train set...
5452/5452 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1075836
{'0': {'precision': 0.37548352674403096, 'recall': 0.006005333333333333, 'f1-score': 0.011821596776462634, 'support': 468750}, '1': {'precision': 0.33349715766046817, 'recall': 0.9651095675886419, 'f1-score': 0.4957024961656398, 'support': 459123}, '2': {'precision': 0.3942377396024748, 'recall': 0.05001069289991446, 'f1-score': 0.08876160761562067, 'support': 467600}, 'accuracy': 0.3363046078283134, 'macro avg': {'precision': 0.3677394746689913, 'recall': 0.3403751979406299, 'f1-score': 0.1987619001859077, 'support': 1395473}, 'weighted avg': {'precision': 0.36795386633487637, 'recall': 0.3363046078283134, 'f1-score': 0.1968040358767874, 'support': 1395473}}
[[  2815 443735  22200]
 [  2287 443104  13732]
 [  2395 441820  23385]]
Evaluating performance on  val set...
1969/1969 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0955095
{'0': {'precision': 0.32718327183271834, 'recall': 0.0033096103120489723, 'f1-score': 0.006552934655416642, 'support': 160744}, '1': {'precision': 0.37477778255114835, 'recall': 0.976452152778518, 'f1-score': 0.5416584742793532, 'support': 187618}, '2': {'precision': 0.3673694262836994, 'recall': 0.03211946050096339, 'f1-score': 0.059074022668076286, 'support': 155700}, 'accuracy': 0.37442417797810584, 'macro avg': {'precision': 0.35644349355585536, 'recall': 0.3372937411971768, 'f1-score': 0.2024284772009487, 'support': 504062}, 'weighted avg': {'precision': 0.35731165119872516, 'recall': 0.37442417797810584, 'f1-score': 0.22194898620608866, 'support': 504062}}
[[   532 155421   4791]
 [   597 183200   3821]
 [   497 150202   5001]]
training model: results/AAPL/W6/deepOF_L2/h1000
Epoch 1/50
5452/5452 - 124s - loss: 3.2090 - accuracy1000: 0.4150 - val_loss: 3.2842 - val_accuracy1000: 0.3755 - 124s/epoch - 23ms/step
Epoch 2/50
5452/5452 - 120s - loss: 3.1978 - accuracy1000: 0.4158 - val_loss: 3.2835 - val_accuracy1000: 0.3751 - 120s/epoch - 22ms/step
Epoch 3/50
5452/5452 - 120s - loss: 3.1896 - accuracy1000: 0.4197 - val_loss: 3.2921 - val_accuracy1000: 0.3544 - 120s/epoch - 22ms/step
Epoch 4/50
5452/5452 - 119s - loss: 3.1775 - accuracy1000: 0.4246 - val_loss: 3.2904 - val_accuracy1000: 0.3567 - 119s/epoch - 22ms/step
Epoch 5/50
5452/5452 - 119s - loss: 3.1744 - accuracy1000: 0.4265 - val_loss: 3.2878 - val_accuracy1000: 0.3625 - 119s/epoch - 22ms/step
Epoch 6/50
5452/5452 - 119s - loss: 3.1724 - accuracy1000: 0.4274 - val_loss: 3.2874 - val_accuracy1000: 0.3610 - 119s/epoch - 22ms/step
Epoch 7/50
5452/5452 - 118s - loss: 3.1712 - accuracy1000: 0.4279 - val_loss: 3.2874 - val_accuracy1000: 0.3617 - 118s/epoch - 22ms/step
Epoch 8/50
5452/5452 - 119s - loss: 3.1702 - accuracy1000: 0.4283 - val_loss: 3.2851 - val_accuracy1000: 0.3643 - 119s/epoch - 22ms/step
Epoch 9/50
5452/5452 - 119s - loss: 3.1694 - accuracy1000: 0.4290 - val_loss: 3.2842 - val_accuracy1000: 0.3677 - 119s/epoch - 22ms/step
Epoch 10/50
5452/5452 - 119s - loss: 3.1686 - accuracy1000: 0.4294 - val_loss: 3.2849 - val_accuracy1000: 0.3665 - 119s/epoch - 22ms/step
Epoch 11/50
5452/5452 - 119s - loss: 3.1677 - accuracy1000: 0.4299 - val_loss: 3.2843 - val_accuracy1000: 0.3651 - 119s/epoch - 22ms/step
Epoch 12/50
5452/5452 - 119s - loss: 3.1669 - accuracy1000: 0.4305 - val_loss: 3.2832 - val_accuracy1000: 0.3687 - 119s/epoch - 22ms/step
Epoch 13/50
5452/5452 - 120s - loss: 3.1663 - accuracy1000: 0.4313 - val_loss: 3.2831 - val_accuracy1000: 0.3686 - 120s/epoch - 22ms/step
Epoch 14/50
5452/5452 - 119s - loss: 3.1653 - accuracy1000: 0.4319 - val_loss: 3.2828 - val_accuracy1000: 0.3692 - 119s/epoch - 22ms/step
Epoch 15/50
5452/5452 - 119s - loss: 3.1645 - accuracy1000: 0.4320 - val_loss: 3.2835 - val_accuracy1000: 0.3699 - 119s/epoch - 22ms/step
Epoch 16/50
5452/5452 - 120s - loss: 3.1639 - accuracy1000: 0.4330 - val_loss: 3.2826 - val_accuracy1000: 0.3702 - 120s/epoch - 22ms/step
Epoch 17/50
5452/5452 - 121s - loss: 3.1630 - accuracy1000: 0.4329 - val_loss: 3.2829 - val_accuracy1000: 0.3690 - 121s/epoch - 22ms/step
Epoch 18/50
5452/5452 - 119s - loss: 3.1623 - accuracy1000: 0.4338 - val_loss: 3.2830 - val_accuracy1000: 0.3684 - 119s/epoch - 22ms/step
Epoch 19/50
5452/5452 - 120s - loss: 3.1614 - accuracy1000: 0.4342 - val_loss: 3.2829 - val_accuracy1000: 0.3682 - 120s/epoch - 22ms/step
Epoch 20/50
5452/5452 - 118s - loss: 3.1610 - accuracy1000: 0.4342 - val_loss: 3.2827 - val_accuracy1000: 0.3690 - 118s/epoch - 22ms/step
Epoch 21/50
5452/5452 - 120s - loss: 3.1604 - accuracy1000: 0.4347 - val_loss: 3.2834 - val_accuracy1000: 0.3682 - 120s/epoch - 22ms/step
Epoch 22/50
5452/5452 - 119s - loss: 3.1595 - accuracy1000: 0.4347 - val_loss: 3.2826 - val_accuracy1000: 0.3702 - 119s/epoch - 22ms/step
Epoch 23/50
5452/5452 - 119s - loss: 3.1587 - accuracy1000: 0.4354 - val_loss: 3.2826 - val_accuracy1000: 0.3696 - 119s/epoch - 22ms/step
Epoch 24/50
5452/5452 - 118s - loss: 3.1581 - accuracy1000: 0.4357 - val_loss: 3.2839 - val_accuracy1000: 0.3665 - 118s/epoch - 22ms/step
Epoch 25/50
5452/5452 - 119s - loss: 3.1576 - accuracy1000: 0.4359 - val_loss: 3.2831 - val_accuracy1000: 0.3687 - 119s/epoch - 22ms/step
Epoch 26/50
5452/5452 - 118s - loss: 3.1569 - accuracy1000: 0.4362 - val_loss: 3.2834 - val_accuracy1000: 0.3674 - 118s/epoch - 22ms/step
Epoch 27/50
5452/5452 - 118s - loss: 3.1562 - accuracy1000: 0.4368 - val_loss: 3.2826 - val_accuracy1000: 0.3696 - 118s/epoch - 22ms/step
Epoch 28/50
5452/5452 - 119s - loss: 3.1554 - accuracy1000: 0.4372 - val_loss: 3.2849 - val_accuracy1000: 0.3645 - 119s/epoch - 22ms/step
Epoch 29/50
5452/5452 - 120s - loss: 3.1546 - accuracy1000: 0.4373 - val_loss: 3.2843 - val_accuracy1000: 0.3660 - 120s/epoch - 22ms/step
Epoch 30/50
5452/5452 - 120s - loss: 3.1540 - accuracy1000: 0.4379 - val_loss: 3.2850 - val_accuracy1000: 0.3639 - 120s/epoch - 22ms/step
Epoch 31/50
5452/5452 - 121s - loss: 3.1531 - accuracy1000: 0.4383 - val_loss: 3.2864 - val_accuracy1000: 0.3635 - 121s/epoch - 22ms/step
Epoch 32/50
5452/5452 - 120s - loss: 3.1526 - accuracy1000: 0.4382 - val_loss: 3.2862 - val_accuracy1000: 0.3638 - 120s/epoch - 22ms/step
testing model: results/AAPL/W6/deepOF_L2/h1000
Evaluating performance on  test set...
29350/29350 - 220s - 220s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0945736
{'0': {'precision': 0.30835761632816144, 'recall': 0.17701610699409281, 'f1-score': 0.2249164393604765, 'support': 2232198}, '1': {'precision': 0.41155078508511345, 'recall': 0.5716353668022283, 'f1-score': 0.4785604100266675, 'support': 3016094}, '2': {'precision': 0.3209463991109762, 'recall': 0.2894318016764771, 'f1-score': 0.30437553115896593, 'support': 2265107}, 'accuracy': 0.3693182007238002, 'macro avg': {'precision': 0.34695160017475035, 'recall': 0.34602775849093276, 'f1-score': 0.33595079351537, 'support': 7513399}, 'weighted avg': {'precision': 0.3535775277333275, 'recall': 0.3693182007238002, 'f1-score': 0.35069139196300375, 'support': 7513399}}
[[ 395135 1234056  603007]
 [ 507899 1724106  784089]
 [ 378384 1231129  655594]]
Evaluating performance on  train set...
5452/5452 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0956056
{'0': {'precision': 0.3480161140282764, 'recall': 0.19441587194557602, 'f1-score': 0.24946853433963928, 'support': 465677}, '1': {'precision': 0.3619939736292856, 'recall': 0.5487492252172091, 'f1-score': 0.43622376277739433, 'support': 463033}, '2': {'precision': 0.3691937463660443, 'recall': 0.3428142333475447, 'f1-score': 0.3555153164662427, 'support': 466763}, 'accuracy': 0.3616243381276456, 'macro avg': {'precision': 0.3597346113412021, 'recall': 0.36199311017010993, 'f1-score': 0.34706920452775875, 'support': 1395473}, 'weighted avg': {'precision': 0.359737691921584, 'recall': 0.3616243381276456, 'f1-score': 0.3469068565823332, 'support': 1395473}}
[[ 90535 223504 151638]
 [ 87183 254089 121761]
 [ 82428 224322 160013]]
Evaluating performance on  val set...
1969/1969 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.093998
{'0': {'precision': 0.3274432327063906, 'recall': 0.19344878674319294, 'f1-score': 0.24321162056294926, 'support': 160642}, '1': {'precision': 0.3979168780714089, 'recall': 0.5808035123912296, 'f1-score': 0.47227282209657684, 'support': 189045}, '2': {'precision': 0.3418277350347157, 'recall': 0.294995951417004, 'f1-score': 0.31668984700973574, 'support': 154375}, 'accuracy': 0.36982355345175794, 'macro avg': {'precision': 0.3557292819375051, 'recall': 0.35641608351714216, 'f1-score': 0.3440580965564206, 'support': 504062}, 'weighted avg': {'precision': 0.3582793160353562, 'recall': 0.36982355345175794, 'f1-score': 0.35162303830847913, 'support': 504062}}
[[ 31076  84494  45072]
 [ 36634 109798  42613]
 [ 27195  81640  45540]]
training model: results/AAPL/W6/deepVOL_L2/h10
Epoch 1/50
5452/5452 - 138s - loss: 3.0362 - accuracy10: 0.4827 - val_loss: 3.1619 - val_accuracy10: 0.4472 - 138s/epoch - 25ms/step
Epoch 2/50
5452/5452 - 135s - loss: 2.9385 - accuracy10: 0.5115 - val_loss: 3.0296 - val_accuracy10: 0.4766 - 135s/epoch - 25ms/step
Epoch 3/50
5452/5452 - 130s - loss: 2.8903 - accuracy10: 0.5259 - val_loss: 3.0252 - val_accuracy10: 0.4843 - 130s/epoch - 24ms/step
Epoch 4/50
5452/5452 - 128s - loss: 2.8645 - accuracy10: 0.5329 - val_loss: 2.9963 - val_accuracy10: 0.4890 - 128s/epoch - 23ms/step
Epoch 5/50
5452/5452 - 123s - loss: 2.8485 - accuracy10: 0.5371 - val_loss: 2.9950 - val_accuracy10: 0.4907 - 123s/epoch - 23ms/step
Epoch 6/50
5452/5452 - 132s - loss: 2.8380 - accuracy10: 0.5393 - val_loss: 2.9857 - val_accuracy10: 0.4934 - 132s/epoch - 24ms/step
Epoch 7/50
5452/5452 - 133s - loss: 2.8293 - accuracy10: 0.5416 - val_loss: 2.9918 - val_accuracy10: 0.4943 - 133s/epoch - 24ms/step
Epoch 8/50
5452/5452 - 123s - loss: 2.8231 - accuracy10: 0.5429 - val_loss: 2.9609 - val_accuracy10: 0.5012 - 123s/epoch - 23ms/step
Epoch 9/50
5452/5452 - 121s - loss: 2.8176 - accuracy10: 0.5441 - val_loss: 2.9569 - val_accuracy10: 0.5016 - 121s/epoch - 22ms/step
Epoch 10/50
5452/5452 - 131s - loss: 2.8132 - accuracy10: 0.5451 - val_loss: 2.9513 - val_accuracy10: 0.5032 - 131s/epoch - 24ms/step
Epoch 11/50
5452/5452 - 130s - loss: 2.8091 - accuracy10: 0.5462 - val_loss: 2.9438 - val_accuracy10: 0.5072 - 130s/epoch - 24ms/step
Epoch 12/50
5452/5452 - 126s - loss: 2.8052 - accuracy10: 0.5470 - val_loss: 2.9520 - val_accuracy10: 0.5050 - 126s/epoch - 23ms/step
Epoch 13/50
5452/5452 - 124s - loss: 2.8019 - accuracy10: 0.5480 - val_loss: 2.9328 - val_accuracy10: 0.5080 - 124s/epoch - 23ms/step
Epoch 14/50
5452/5452 - 124s - loss: 2.7986 - accuracy10: 0.5487 - val_loss: 2.9306 - val_accuracy10: 0.5092 - 124s/epoch - 23ms/step
Epoch 15/50
5452/5452 - 139s - loss: 2.7962 - accuracy10: 0.5492 - val_loss: 2.9293 - val_accuracy10: 0.5099 - 139s/epoch - 25ms/step
Epoch 16/50
5452/5452 - 124s - loss: 2.7934 - accuracy10: 0.5500 - val_loss: 2.9197 - val_accuracy10: 0.5117 - 124s/epoch - 23ms/step
Epoch 17/50
5452/5452 - 134s - loss: 2.7903 - accuracy10: 0.5502 - val_loss: 2.9151 - val_accuracy10: 0.5122 - 134s/epoch - 25ms/step
Epoch 18/50
5452/5452 - 128s - loss: 2.7877 - accuracy10: 0.5511 - val_loss: 2.9031 - val_accuracy10: 0.5172 - 128s/epoch - 24ms/step
Epoch 19/50
5452/5452 - 130s - loss: 2.7851 - accuracy10: 0.5518 - val_loss: 2.8998 - val_accuracy10: 0.5184 - 130s/epoch - 24ms/step
Epoch 20/50
5452/5452 - 125s - loss: 2.7825 - accuracy10: 0.5521 - val_loss: 2.8937 - val_accuracy10: 0.5208 - 125s/epoch - 23ms/step
Epoch 21/50
5452/5452 - 129s - loss: 2.7808 - accuracy10: 0.5524 - val_loss: 2.8931 - val_accuracy10: 0.5194 - 129s/epoch - 24ms/step
Epoch 22/50
5452/5452 - 128s - loss: 2.7788 - accuracy10: 0.5529 - val_loss: 2.8860 - val_accuracy10: 0.5220 - 128s/epoch - 24ms/step
Epoch 23/50
5452/5452 - 134s - loss: 2.7769 - accuracy10: 0.5535 - val_loss: 2.8833 - val_accuracy10: 0.5223 - 134s/epoch - 25ms/step
Epoch 24/50
5452/5452 - 124s - loss: 2.7748 - accuracy10: 0.5539 - val_loss: 2.8862 - val_accuracy10: 0.5215 - 124s/epoch - 23ms/step
Epoch 25/50
5452/5452 - 132s - loss: 2.7729 - accuracy10: 0.5544 - val_loss: 2.8870 - val_accuracy10: 0.5216 - 132s/epoch - 24ms/step
Epoch 26/50
5452/5452 - 133s - loss: 2.7712 - accuracy10: 0.5548 - val_loss: 2.8779 - val_accuracy10: 0.5242 - 133s/epoch - 24ms/step
Epoch 27/50
5452/5452 - 126s - loss: 2.7690 - accuracy10: 0.5554 - val_loss: 2.8771 - val_accuracy10: 0.5257 - 126s/epoch - 23ms/step
Epoch 28/50
5452/5452 - 125s - loss: 2.7680 - accuracy10: 0.5556 - val_loss: 2.8807 - val_accuracy10: 0.5240 - 125s/epoch - 23ms/step
Epoch 29/50
5452/5452 - 128s - loss: 2.7663 - accuracy10: 0.5557 - val_loss: 2.8805 - val_accuracy10: 0.5244 - 128s/epoch - 23ms/step
Epoch 30/50
5452/5452 - 134s - loss: 2.7647 - accuracy10: 0.5562 - val_loss: 2.8788 - val_accuracy10: 0.5243 - 134s/epoch - 25ms/step
Epoch 31/50
5452/5452 - 130s - loss: 2.7632 - accuracy10: 0.5566 - val_loss: 2.8712 - val_accuracy10: 0.5265 - 130s/epoch - 24ms/step
Epoch 32/50
5452/5452 - 127s - loss: 2.7620 - accuracy10: 0.5571 - val_loss: 2.8706 - val_accuracy10: 0.5266 - 127s/epoch - 23ms/step
Epoch 33/50
5452/5452 - 127s - loss: 2.7599 - accuracy10: 0.5577 - val_loss: 2.8664 - val_accuracy10: 0.5277 - 127s/epoch - 23ms/step
Epoch 34/50
5452/5452 - 134s - loss: 2.7590 - accuracy10: 0.5576 - val_loss: 2.8725 - val_accuracy10: 0.5246 - 134s/epoch - 25ms/step
Epoch 35/50
5452/5452 - 131s - loss: 2.7574 - accuracy10: 0.5584 - val_loss: 2.8674 - val_accuracy10: 0.5264 - 131s/epoch - 24ms/step
Epoch 36/50
5452/5452 - 120s - loss: 2.7565 - accuracy10: 0.5582 - val_loss: 2.8746 - val_accuracy10: 0.5249 - 120s/epoch - 22ms/step
Epoch 37/50
5452/5452 - 120s - loss: 2.7553 - accuracy10: 0.5586 - val_loss: 2.8645 - val_accuracy10: 0.5291 - 120s/epoch - 22ms/step
Epoch 38/50
5452/5452 - 127s - loss: 2.7542 - accuracy10: 0.5589 - val_loss: 2.8685 - val_accuracy10: 0.5285 - 127s/epoch - 23ms/step
Epoch 39/50
5452/5452 - 130s - loss: 2.7531 - accuracy10: 0.5589 - val_loss: 2.8693 - val_accuracy10: 0.5276 - 130s/epoch - 24ms/step
Epoch 40/50
5452/5452 - 128s - loss: 2.7516 - accuracy10: 0.5594 - val_loss: 2.8696 - val_accuracy10: 0.5271 - 128s/epoch - 23ms/step
Epoch 41/50
5452/5452 - 134s - loss: 2.7503 - accuracy10: 0.5596 - val_loss: 2.8710 - val_accuracy10: 0.5284 - 134s/epoch - 25ms/step
Epoch 42/50
5452/5452 - 130s - loss: 2.7494 - accuracy10: 0.5600 - val_loss: 2.8648 - val_accuracy10: 0.5289 - 130s/epoch - 24ms/step
Epoch 43/50
5452/5452 - 123s - loss: 2.7480 - accuracy10: 0.5603 - val_loss: 2.8703 - val_accuracy10: 0.5262 - 123s/epoch - 22ms/step
Epoch 44/50
5452/5452 - 122s - loss: 2.7466 - accuracy10: 0.5602 - val_loss: 2.8713 - val_accuracy10: 0.5269 - 122s/epoch - 22ms/step
Epoch 45/50
5452/5452 - 138s - loss: 2.7458 - accuracy10: 0.5609 - val_loss: 2.8712 - val_accuracy10: 0.5265 - 138s/epoch - 25ms/step
Epoch 46/50
5452/5452 - 141s - loss: 2.7444 - accuracy10: 0.5610 - val_loss: 2.8601 - val_accuracy10: 0.5300 - 141s/epoch - 26ms/step
Epoch 47/50
5452/5452 - 126s - loss: 2.7437 - accuracy10: 0.5614 - val_loss: 2.8684 - val_accuracy10: 0.5286 - 126s/epoch - 23ms/step
Epoch 48/50
5452/5452 - 138s - loss: 2.7427 - accuracy10: 0.5617 - val_loss: 2.8678 - val_accuracy10: 0.5276 - 138s/epoch - 25ms/step
Epoch 49/50
5452/5452 - 135s - loss: 2.7419 - accuracy10: 0.5617 - val_loss: 2.8681 - val_accuracy10: 0.5284 - 135s/epoch - 25ms/step
Epoch 50/50
5452/5452 - 123s - loss: 2.7406 - accuracy10: 0.5620 - val_loss: 2.8612 - val_accuracy10: 0.5300 - 123s/epoch - 22ms/step
testing model: results/AAPL/W6/deepVOL_L2/h10
Evaluating performance on  test set...
29350/29350 - 298s - 298s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9983222
{'0': {'precision': 0.5532683259444756, 'recall': 0.36932157095391493, 'f1-score': 0.44295721855137704, 'support': 2469455}, '1': {'precision': 0.4432576837223082, 'recall': 0.6845641925365882, 'f1-score': 0.5380962095708537, 'support': 2535248}, '2': {'precision': 0.5427697383404221, 'recall': 0.421795981266799, 'f1-score': 0.47469672564861115, 'support': 2508701}, 'accuracy': 0.4932149262837457, 'macro avg': {'precision': 0.5130985826690687, 'recall': 0.49189391491910067, 'f1-score': 0.4852500512569473, 'support': 7513404}, 'weighted avg': {'precision': 0.5126419896136538, 'recall': 0.4932149262837457, 'f1-score': 0.4856576869274266, 'support': 7513404}}
[[ 912023 1115540  441892]
 [ 350204 1735540  449504]
 [ 386201 1064340 1058160]]
Evaluating performance on  train set...
5452/5452 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96144325
{'0': {'precision': 0.5620452845583735, 'recall': 0.41282256173295234, 'f1-score': 0.4760131848927069, 'support': 460532}, '1': {'precision': 0.49477156164482866, 'recall': 0.6889422096233878, 'f1-score': 0.5759314814310214, 'support': 475529}, '2': {'precision': 0.5456430064849924, 'recall': 0.4692173072653424, 'f1-score': 0.5045524763598914, 'support': 459414}, 'accuracy': 0.5254805711316936, 'macro avg': {'precision': 0.5341532842293982, 'recall': 0.5236606928738942, 'f1-score': 0.5188323808945399, 'support': 1395475}, 'weighted avg': {'precision': 0.53372084853325, 'recall': 0.5254805711316936, 'f1-score': 0.5194574584803191, 'support': 1395475}}
[[190118 174459  95955]
 [ 64371 327612  83546]
 [ 83772 160077 215565]]
Evaluating performance on  val set...
1969/1969 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9516863
{'0': {'precision': 0.5570553375065322, 'recall': 0.3347028485917375, 'f1-score': 0.41815822090165133, 'support': 149688}, '1': {'precision': 0.5221077570143214, 'recall': 0.7608177039896041, 'f1-score': 0.6192547221191719, 'support': 206236}, '2': {'precision': 0.5288390436282968, 'recall': 0.4055245411404154, 'f1-score': 0.4590444533593139, 'support': 148139}, 'accuracy': 0.5298603547572427, 'macro avg': {'precision': 0.5360007127163835, 'recall': 0.500348364573919, 'f1-score': 0.49881913212671236, 'support': 504063}, 'weighted avg': {'precision': 0.5344641479742327, 'recall': 0.5298603547572427, 'f1-score': 0.5124523540063272, 'support': 504063}}
[[ 50101  75131  24456]
 [ 20262 156908  29066]
 [ 19576  68489  60074]]
training model: results/AAPL/W6/deepVOL_L2/h20
Epoch 1/50
5452/5452 - 124s - loss: 3.1161 - accuracy20: 0.4549 - val_loss: 3.2428 - val_accuracy20: 0.4136 - 124s/epoch - 23ms/step
Epoch 2/50
5452/5452 - 128s - loss: 3.0602 - accuracy20: 0.4740 - val_loss: 3.2351 - val_accuracy20: 0.4223 - 128s/epoch - 23ms/step
Epoch 3/50
5452/5452 - 135s - loss: 3.0204 - accuracy20: 0.4881 - val_loss: 3.1890 - val_accuracy20: 0.4390 - 135s/epoch - 25ms/step
Epoch 4/50
5452/5452 - 132s - loss: 2.9950 - accuracy20: 0.4969 - val_loss: 3.1203 - val_accuracy20: 0.4558 - 132s/epoch - 24ms/step
Epoch 5/50
5452/5452 - 139s - loss: 2.9796 - accuracy20: 0.5018 - val_loss: 3.1172 - val_accuracy20: 0.4564 - 139s/epoch - 25ms/step
Epoch 6/50
5452/5452 - 131s - loss: 2.9696 - accuracy20: 0.5047 - val_loss: 3.0792 - val_accuracy20: 0.4645 - 131s/epoch - 24ms/step
Epoch 7/50
5452/5452 - 138s - loss: 2.9621 - accuracy20: 0.5071 - val_loss: 3.0906 - val_accuracy20: 0.4639 - 138s/epoch - 25ms/step
Epoch 8/50
5452/5452 - 131s - loss: 2.9560 - accuracy20: 0.5088 - val_loss: 3.0871 - val_accuracy20: 0.4638 - 131s/epoch - 24ms/step
Epoch 9/50
5452/5452 - 127s - loss: 2.9511 - accuracy20: 0.5098 - val_loss: 3.0845 - val_accuracy20: 0.4651 - 127s/epoch - 23ms/step
Epoch 10/50
5452/5452 - 121s - loss: 2.9472 - accuracy20: 0.5111 - val_loss: 3.0548 - val_accuracy20: 0.4717 - 121s/epoch - 22ms/step
Epoch 11/50
5452/5452 - 120s - loss: 2.9430 - accuracy20: 0.5119 - val_loss: 3.0807 - val_accuracy20: 0.4668 - 120s/epoch - 22ms/step
Epoch 12/50
5452/5452 - 131s - loss: 2.9392 - accuracy20: 0.5132 - val_loss: 3.0623 - val_accuracy20: 0.4693 - 131s/epoch - 24ms/step
Epoch 13/50
5452/5452 - 126s - loss: 2.9367 - accuracy20: 0.5136 - val_loss: 3.0842 - val_accuracy20: 0.4665 - 126s/epoch - 23ms/step
Epoch 14/50
5452/5452 - 122s - loss: 2.9333 - accuracy20: 0.5145 - val_loss: 3.0548 - val_accuracy20: 0.4727 - 122s/epoch - 22ms/step
Epoch 15/50
5452/5452 - 123s - loss: 2.9315 - accuracy20: 0.5150 - val_loss: 3.0636 - val_accuracy20: 0.4703 - 123s/epoch - 22ms/step
Epoch 16/50
5452/5452 - 132s - loss: 2.9290 - accuracy20: 0.5157 - val_loss: 3.0658 - val_accuracy20: 0.4712 - 132s/epoch - 24ms/step
Epoch 17/50
5452/5452 - 132s - loss: 2.9266 - accuracy20: 0.5162 - val_loss: 3.0476 - val_accuracy20: 0.4741 - 132s/epoch - 24ms/step
Epoch 18/50
5452/5452 - 129s - loss: 2.9249 - accuracy20: 0.5166 - val_loss: 3.0535 - val_accuracy20: 0.4730 - 129s/epoch - 24ms/step
Epoch 19/50
5452/5452 - 126s - loss: 2.9225 - accuracy20: 0.5174 - val_loss: 3.0438 - val_accuracy20: 0.4754 - 126s/epoch - 23ms/step
Epoch 20/50
5452/5452 - 129s - loss: 2.9209 - accuracy20: 0.5179 - val_loss: 3.0604 - val_accuracy20: 0.4703 - 129s/epoch - 24ms/step
Epoch 21/50
5452/5452 - 133s - loss: 2.9183 - accuracy20: 0.5184 - val_loss: 3.0520 - val_accuracy20: 0.4733 - 133s/epoch - 24ms/step
Epoch 22/50
5452/5452 - 140s - loss: 2.9170 - accuracy20: 0.5185 - val_loss: 3.0561 - val_accuracy20: 0.4723 - 140s/epoch - 26ms/step
Epoch 23/50
5452/5452 - 131s - loss: 2.9152 - accuracy20: 0.5194 - val_loss: 3.0424 - val_accuracy20: 0.4749 - 131s/epoch - 24ms/step
Epoch 24/50
5452/5452 - 120s - loss: 2.9138 - accuracy20: 0.5196 - val_loss: 3.0422 - val_accuracy20: 0.4758 - 120s/epoch - 22ms/step
Epoch 25/50
5452/5452 - 129s - loss: 2.9119 - accuracy20: 0.5203 - val_loss: 3.0358 - val_accuracy20: 0.4772 - 129s/epoch - 24ms/step
Epoch 26/50
5452/5452 - 120s - loss: 2.9103 - accuracy20: 0.5208 - val_loss: 3.0348 - val_accuracy20: 0.4771 - 120s/epoch - 22ms/step
Epoch 27/50
5452/5452 - 128s - loss: 2.9090 - accuracy20: 0.5210 - val_loss: 3.0348 - val_accuracy20: 0.4777 - 128s/epoch - 24ms/step
Epoch 28/50
5452/5452 - 127s - loss: 2.9074 - accuracy20: 0.5211 - val_loss: 3.0431 - val_accuracy20: 0.4763 - 127s/epoch - 23ms/step
Epoch 29/50
5452/5452 - 119s - loss: 2.9061 - accuracy20: 0.5217 - val_loss: 3.0456 - val_accuracy20: 0.4755 - 119s/epoch - 22ms/step
Epoch 30/50
5452/5452 - 127s - loss: 2.9051 - accuracy20: 0.5216 - val_loss: 3.0395 - val_accuracy20: 0.4758 - 127s/epoch - 23ms/step
Epoch 31/50
5452/5452 - 132s - loss: 2.9033 - accuracy20: 0.5224 - val_loss: 3.0423 - val_accuracy20: 0.4759 - 132s/epoch - 24ms/step
Epoch 32/50
5452/5452 - 134s - loss: 2.9025 - accuracy20: 0.5227 - val_loss: 3.0380 - val_accuracy20: 0.4776 - 134s/epoch - 25ms/step
Epoch 33/50
5452/5452 - 127s - loss: 2.9012 - accuracy20: 0.5230 - val_loss: 3.0314 - val_accuracy20: 0.4791 - 127s/epoch - 23ms/step
Epoch 34/50
5452/5452 - 131s - loss: 2.8998 - accuracy20: 0.5236 - val_loss: 3.0470 - val_accuracy20: 0.4743 - 131s/epoch - 24ms/step
Epoch 35/50
5452/5452 - 125s - loss: 2.8986 - accuracy20: 0.5238 - val_loss: 3.0510 - val_accuracy20: 0.4736 - 125s/epoch - 23ms/step
Epoch 36/50
5452/5452 - 135s - loss: 2.8973 - accuracy20: 0.5244 - val_loss: 3.0375 - val_accuracy20: 0.4780 - 135s/epoch - 25ms/step
Epoch 37/50
5452/5452 - 132s - loss: 2.8963 - accuracy20: 0.5243 - val_loss: 3.0316 - val_accuracy20: 0.4782 - 132s/epoch - 24ms/step
Epoch 38/50
5452/5452 - 131s - loss: 2.8953 - accuracy20: 0.5247 - val_loss: 3.0348 - val_accuracy20: 0.4779 - 131s/epoch - 24ms/step
Epoch 39/50
5452/5452 - 129s - loss: 2.8938 - accuracy20: 0.5253 - val_loss: 3.0220 - val_accuracy20: 0.4799 - 129s/epoch - 24ms/step
Epoch 40/50
5452/5452 - 128s - loss: 2.8923 - accuracy20: 0.5256 - val_loss: 3.0326 - val_accuracy20: 0.4773 - 128s/epoch - 24ms/step
Epoch 41/50
5452/5452 - 119s - loss: 2.8915 - accuracy20: 0.5260 - val_loss: 3.0315 - val_accuracy20: 0.4781 - 119s/epoch - 22ms/step
Epoch 42/50
5452/5452 - 133s - loss: 2.8906 - accuracy20: 0.5261 - val_loss: 3.0363 - val_accuracy20: 0.4781 - 133s/epoch - 24ms/step
Epoch 43/50
5452/5452 - 131s - loss: 2.8895 - accuracy20: 0.5267 - val_loss: 3.0231 - val_accuracy20: 0.4796 - 131s/epoch - 24ms/step
Epoch 44/50
5452/5452 - 131s - loss: 2.8884 - accuracy20: 0.5268 - val_loss: 3.0218 - val_accuracy20: 0.4814 - 131s/epoch - 24ms/step
Epoch 45/50
5452/5452 - 130s - loss: 2.8871 - accuracy20: 0.5272 - val_loss: 3.0192 - val_accuracy20: 0.4812 - 130s/epoch - 24ms/step
Epoch 46/50
5452/5452 - 130s - loss: 2.8861 - accuracy20: 0.5271 - val_loss: 3.0259 - val_accuracy20: 0.4804 - 130s/epoch - 24ms/step
Epoch 47/50
5452/5452 - 125s - loss: 2.8845 - accuracy20: 0.5280 - val_loss: 3.0282 - val_accuracy20: 0.4805 - 125s/epoch - 23ms/step
Epoch 48/50
5452/5452 - 125s - loss: 2.8840 - accuracy20: 0.5280 - val_loss: 3.0244 - val_accuracy20: 0.4800 - 125s/epoch - 23ms/step
Epoch 49/50
5452/5452 - 118s - loss: 2.8827 - accuracy20: 0.5286 - val_loss: 3.0320 - val_accuracy20: 0.4783 - 118s/epoch - 22ms/step
Epoch 50/50
5452/5452 - 128s - loss: 2.8817 - accuracy20: 0.5287 - val_loss: 3.0227 - val_accuracy20: 0.4816 - 128s/epoch - 24ms/step
testing model: results/AAPL/W6/deepVOL_L2/h20
Evaluating performance on  test set...
29350/29350 - 307s - 307s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.034931
{'0': {'precision': 0.5099050532061679, 'recall': 0.24667237115275548, 'f1-score': 0.33249601293275455, 'support': 2322149}, '1': {'precision': 0.4333868534278762, 'recall': 0.6797954683018338, 'f1-score': 0.5293192556706737, 'support': 2896177}, '2': {'precision': 0.4618973839267733, 'recall': 0.3717586068970205, 'f1-score': 0.41195488275280684, 'support': 2295078}, 'accuracy': 0.45183687713318754, 'macro avg': {'precision': 0.46839643018693916, 'recall': 0.4327421487838699, 'f1-score': 0.42459005045207837, 'support': 7513404}, 'weighted avg': {'precision': 0.46574509643108863, 'recall': 0.45183687713318754, 'f1-score': 0.43263694142692904, 'support': 7513404}}
[[ 572810 1354878  394461]
 [ 327849 1968808  599520]
 [ 222707 1219156  853215]]
Evaluating performance on  train set...
5452/5452 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0141582
{'0': {'precision': 0.5529089267759242, 'recall': 0.32415052773343545, 'f1-score': 0.40869685511389836, 'support': 464818}, '1': {'precision': 0.4306657014775909, 'recall': 0.62876307953515, 'f1-score': 0.5111937632133463, 'support': 466473}, '2': {'precision': 0.5073699788200793, 'recall': 0.48304336211502336, 'f1-score': 0.4949079142534256, 'support': 464184}, 'accuracy': 0.47882835593615075, 'macro avg': {'precision': 0.49698153569119813, 'recall': 0.4786523231278696, 'f1-score': 0.4715995108602234, 'support': 1395475}, 'weighted avg': {'precision': 0.4968981669611476, 'recall': 0.47882835593615075, 'f1-score': 0.4716358790931858, 'support': 1395475}}
[[150671 210267 103880]
 [ 59345 293301 113827]
 [ 62490 177473 224221]]
Evaluating performance on  val set...
1969/1969 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0061451
{'0': {'precision': 0.5573057743329027, 'recall': 0.25813570445099276, 'f1-score': 0.3528408166495908, 'support': 155426}, '1': {'precision': 0.4599408950087229, 'recall': 0.6950178576016856, 'f1-score': 0.5535559339238062, 'support': 194595}, '2': {'precision': 0.4889399285605605, 'recall': 0.4380818218407967, 'f1-score': 0.46211579087930266, 'support': 154042}, 'accuracy': 0.4817869988473663, 'macro avg': {'precision': 0.5020621993007287, 'recall': 0.4637451279644917, 'f1-score': 0.45617084715089984, 'support': 504063}, 'weighted avg': {'precision': 0.498825127456318, 'recall': 0.4817869988473663, 'f1-score': 0.46372198393675373, 'support': 504063}}
[[ 40121  86130  29175]
 [ 17987 135247  41361]
 [ 13883  72676  67483]]
training model: results/AAPL/W6/deepVOL_L2/h30
Epoch 1/50
5452/5452 - 123s - loss: 3.1624 - accuracy30: 0.4372 - val_loss: 3.2695 - val_accuracy30: 0.3975 - 123s/epoch - 23ms/step
Epoch 2/50
5452/5452 - 120s - loss: 3.1181 - accuracy30: 0.4535 - val_loss: 3.1907 - val_accuracy30: 0.4230 - 120s/epoch - 22ms/step
Epoch 3/50
5452/5452 - 137s - loss: 3.0850 - accuracy30: 0.4677 - val_loss: 3.2027 - val_accuracy30: 0.4212 - 137s/epoch - 25ms/step
Epoch 4/50
5452/5452 - 134s - loss: 3.0688 - accuracy30: 0.4734 - val_loss: 3.2132 - val_accuracy30: 0.4206 - 134s/epoch - 25ms/step
Epoch 5/50
5452/5452 - 134s - loss: 3.0585 - accuracy30: 0.4774 - val_loss: 3.1757 - val_accuracy30: 0.4279 - 134s/epoch - 25ms/step
Epoch 6/50
5452/5452 - 135s - loss: 3.0504 - accuracy30: 0.4800 - val_loss: 3.1595 - val_accuracy30: 0.4338 - 135s/epoch - 25ms/step
Epoch 7/50
5452/5452 - 134s - loss: 3.0443 - accuracy30: 0.4822 - val_loss: 3.1550 - val_accuracy30: 0.4335 - 134s/epoch - 25ms/step
Epoch 8/50
5452/5452 - 136s - loss: 3.0390 - accuracy30: 0.4839 - val_loss: 3.1481 - val_accuracy30: 0.4371 - 136s/epoch - 25ms/step
Epoch 9/50
5452/5452 - 129s - loss: 3.0341 - accuracy30: 0.4855 - val_loss: 3.1475 - val_accuracy30: 0.4365 - 129s/epoch - 24ms/step
Epoch 10/50
5452/5452 - 115s - loss: 3.0297 - accuracy30: 0.4869 - val_loss: 3.1407 - val_accuracy30: 0.4386 - 115s/epoch - 21ms/step
Epoch 11/50
5452/5452 - 136s - loss: 3.0267 - accuracy30: 0.4880 - val_loss: 3.1435 - val_accuracy30: 0.4382 - 136s/epoch - 25ms/step
Epoch 12/50
5452/5452 - 130s - loss: 3.0230 - accuracy30: 0.4891 - val_loss: 3.1342 - val_accuracy30: 0.4426 - 130s/epoch - 24ms/step
Epoch 13/50
5452/5452 - 131s - loss: 3.0202 - accuracy30: 0.4898 - val_loss: 3.1332 - val_accuracy30: 0.4422 - 131s/epoch - 24ms/step
Epoch 14/50
5452/5452 - 129s - loss: 3.0180 - accuracy30: 0.4907 - val_loss: 3.1295 - val_accuracy30: 0.4430 - 129s/epoch - 24ms/step
Epoch 15/50
5452/5452 - 131s - loss: 3.0153 - accuracy30: 0.4914 - val_loss: 3.1178 - val_accuracy30: 0.4485 - 131s/epoch - 24ms/step
Epoch 16/50
5452/5452 - 125s - loss: 3.0131 - accuracy30: 0.4919 - val_loss: 3.1193 - val_accuracy30: 0.4465 - 125s/epoch - 23ms/step
Epoch 17/50
5452/5452 - 127s - loss: 3.0109 - accuracy30: 0.4929 - val_loss: 3.1221 - val_accuracy30: 0.4454 - 127s/epoch - 23ms/step
Epoch 18/50
5452/5452 - 131s - loss: 3.0090 - accuracy30: 0.4933 - val_loss: 3.1174 - val_accuracy30: 0.4489 - 131s/epoch - 24ms/step
Epoch 19/50
5452/5452 - 132s - loss: 3.0076 - accuracy30: 0.4936 - val_loss: 3.1174 - val_accuracy30: 0.4471 - 132s/epoch - 24ms/step
Epoch 20/50
5452/5452 - 131s - loss: 3.0057 - accuracy30: 0.4943 - val_loss: 3.1199 - val_accuracy30: 0.4471 - 131s/epoch - 24ms/step
Epoch 21/50
5452/5452 - 122s - loss: 3.0038 - accuracy30: 0.4947 - val_loss: 3.1255 - val_accuracy30: 0.4464 - 122s/epoch - 22ms/step
Epoch 22/50
5452/5452 - 117s - loss: 3.0019 - accuracy30: 0.4953 - val_loss: 3.1159 - val_accuracy30: 0.4490 - 117s/epoch - 22ms/step
Epoch 23/50
5452/5452 - 128s - loss: 3.0005 - accuracy30: 0.4957 - val_loss: 3.1150 - val_accuracy30: 0.4497 - 128s/epoch - 23ms/step
Epoch 24/50
5452/5452 - 128s - loss: 2.9991 - accuracy30: 0.4961 - val_loss: 3.1209 - val_accuracy30: 0.4486 - 128s/epoch - 23ms/step
Epoch 25/50
5452/5452 - 122s - loss: 2.9982 - accuracy30: 0.4962 - val_loss: 3.1158 - val_accuracy30: 0.4492 - 122s/epoch - 22ms/step
Epoch 26/50
5452/5452 - 127s - loss: 2.9963 - accuracy30: 0.4970 - val_loss: 3.1159 - val_accuracy30: 0.4503 - 127s/epoch - 23ms/step
Epoch 27/50
5452/5452 - 121s - loss: 2.9949 - accuracy30: 0.4976 - val_loss: 3.1183 - val_accuracy30: 0.4491 - 121s/epoch - 22ms/step
Epoch 28/50
5452/5452 - 137s - loss: 2.9939 - accuracy30: 0.4982 - val_loss: 3.1098 - val_accuracy30: 0.4534 - 137s/epoch - 25ms/step
Epoch 29/50
5452/5452 - 129s - loss: 2.9922 - accuracy30: 0.4984 - val_loss: 3.1096 - val_accuracy30: 0.4521 - 129s/epoch - 24ms/step
Epoch 30/50
5452/5452 - 127s - loss: 2.9906 - accuracy30: 0.4989 - val_loss: 3.1128 - val_accuracy30: 0.4511 - 127s/epoch - 23ms/step
Epoch 31/50
5452/5452 - 131s - loss: 2.9895 - accuracy30: 0.4991 - val_loss: 3.1130 - val_accuracy30: 0.4518 - 131s/epoch - 24ms/step
Epoch 32/50
5452/5452 - 117s - loss: 2.9884 - accuracy30: 0.4996 - val_loss: 3.1089 - val_accuracy30: 0.4531 - 117s/epoch - 21ms/step
Epoch 33/50
5452/5452 - 123s - loss: 2.9869 - accuracy30: 0.5003 - val_loss: 3.1126 - val_accuracy30: 0.4520 - 123s/epoch - 23ms/step
Epoch 34/50
5452/5452 - 130s - loss: 2.9854 - accuracy30: 0.5005 - val_loss: 3.1118 - val_accuracy30: 0.4528 - 130s/epoch - 24ms/step
Epoch 35/50
5452/5452 - 133s - loss: 2.9838 - accuracy30: 0.5011 - val_loss: 3.1115 - val_accuracy30: 0.4527 - 133s/epoch - 24ms/step
Epoch 36/50
5452/5452 - 133s - loss: 2.9828 - accuracy30: 0.5014 - val_loss: 3.1108 - val_accuracy30: 0.4545 - 133s/epoch - 24ms/step
Epoch 37/50
5452/5452 - 131s - loss: 2.9817 - accuracy30: 0.5017 - val_loss: 3.1133 - val_accuracy30: 0.4543 - 131s/epoch - 24ms/step
Epoch 38/50
5452/5452 - 133s - loss: 2.9802 - accuracy30: 0.5022 - val_loss: 3.1111 - val_accuracy30: 0.4543 - 133s/epoch - 24ms/step
Epoch 39/50
5452/5452 - 126s - loss: 2.9793 - accuracy30: 0.5023 - val_loss: 3.1217 - val_accuracy30: 0.4516 - 126s/epoch - 23ms/step
Epoch 40/50
5452/5452 - 125s - loss: 2.9782 - accuracy30: 0.5030 - val_loss: 3.1272 - val_accuracy30: 0.4510 - 125s/epoch - 23ms/step
Epoch 41/50
5452/5452 - 129s - loss: 2.9769 - accuracy30: 0.5032 - val_loss: 3.1196 - val_accuracy30: 0.4533 - 129s/epoch - 24ms/step
Epoch 42/50
5452/5452 - 133s - loss: 2.9756 - accuracy30: 0.5037 - val_loss: 3.1212 - val_accuracy30: 0.4522 - 133s/epoch - 24ms/step
testing model: results/AAPL/W6/deepVOL_L2/h30
Evaluating performance on  test set...
29350/29350 - 289s - 289s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0449411
{'0': {'precision': 0.46565548967298576, 'recall': 0.22316240864618125, 'f1-score': 0.3017250304567148, 'support': 2213509}, '1': {'precision': 0.44654696718547116, 'recall': 0.7402797255346131, 'f1-score': 0.5570647649468397, 'support': 3113981}, '2': {'precision': 0.44469985902251996, 'recall': 0.26249248598069275, 'f1-score': 0.33012340231017223, 'support': 2185914}, 'accuracy': 0.4489276764566367, 'macro avg': {'precision': 0.4523007719603256, 'recall': 0.4086448733871624, 'f1-score': 0.3963043992379089, 'support': 7513404}, 'weighted avg': {'precision': 0.45163910210992175, 'recall': 0.4489276764566367, 'f1-score': 0.4158143939940637, 'support': 7513404}}
[[ 493972 1456301  263236]
 [ 355509 2305217  453255]
 [ 211329 1400799  573786]]
Evaluating performance on  train set...
5452/5452 - 52s - 52s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0433147
{'0': {'precision': 0.5175884111230444, 'recall': 0.34202948740147887, 'f1-score': 0.4118818355113867, 'support': 467793}, '1': {'precision': 0.39643612978021797, 'recall': 0.6294190809223336, 'f1-score': 0.48647111570410845, 'support': 460701}, '2': {'precision': 0.5030107157247555, 'recall': 0.3822810778168705, 'f1-score': 0.43441378303401956, 'support': 466981}, 'accuracy': 0.4503778283380211, 'macro avg': {'precision': 0.47234508554267257, 'recall': 0.45124321538022766, 'f1-score': 0.44425557808317157, 'support': 1395475}, 'weighted avg': {'precision': 0.472713021781272, 'recall': 0.4503778283380211, 'f1-score': 0.4440467595409349, 'support': 1395475}}
[[159999 226411  81383]
 [ 75729 289974  94998]
 [ 73396 215067 178518]]
Evaluating performance on  val set...
1969/1969 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0367706
{'0': {'precision': 0.5171212289880887, 'recall': 0.2902532444405566, 'f1-score': 0.37181288094351933, 'support': 160043}, '1': {'precision': 0.42219686864890216, 'recall': 0.6811378771861097, 'f1-score': 0.5212820133721026, 'support': 186347}, '2': {'precision': 0.4834413183562801, 'recall': 0.3482967914608081, 'f1-score': 0.40488961141892366, 'support': 157673}, 'accuracy': 0.45291560777125084, 'macro avg': {'precision': 0.4742531386644237, 'recall': 0.4398959710291582, 'f1-score': 0.43266150191151515, 'support': 504063}, 'weighted avg': {'precision': 0.4714934357853035, 'recall': 0.45291560777125084, 'f1-score': 0.43741664822046217, 'support': 504063}}
[[ 46453  89232  24358]
 [ 25098 126928  34321]
 [ 18279  84477  54917]]
training model: results/AAPL/W6/deepVOL_L2/h50
Epoch 1/50
5452/5452 - 134s - loss: 3.1338 - accuracy50: 0.4473 - val_loss: 3.2831 - val_accuracy50: 0.3692 - 134s/epoch - 25ms/step
Epoch 2/50
5452/5452 - 130s - loss: 3.1180 - accuracy50: 0.4541 - val_loss: 3.2597 - val_accuracy50: 0.3868 - 130s/epoch - 24ms/step
Epoch 3/50
5452/5452 - 125s - loss: 3.0989 - accuracy50: 0.4620 - val_loss: 3.2428 - val_accuracy50: 0.3967 - 125s/epoch - 23ms/step
Epoch 4/50
5452/5452 - 129s - loss: 3.0837 - accuracy50: 0.4688 - val_loss: 3.2270 - val_accuracy50: 0.4078 - 129s/epoch - 24ms/step
Epoch 5/50
5452/5452 - 126s - loss: 3.0708 - accuracy50: 0.4739 - val_loss: 3.2137 - val_accuracy50: 0.4158 - 126s/epoch - 23ms/step
Epoch 6/50
5452/5452 - 133s - loss: 3.0633 - accuracy50: 0.4771 - val_loss: 3.2059 - val_accuracy50: 0.4200 - 133s/epoch - 24ms/step
Epoch 7/50
5452/5452 - 135s - loss: 3.0575 - accuracy50: 0.4798 - val_loss: 3.2022 - val_accuracy50: 0.4212 - 135s/epoch - 25ms/step
Epoch 8/50
5452/5452 - 130s - loss: 3.0532 - accuracy50: 0.4814 - val_loss: 3.2051 - val_accuracy50: 0.4172 - 130s/epoch - 24ms/step
Epoch 9/50
5452/5452 - 125s - loss: 3.0496 - accuracy50: 0.4828 - val_loss: 3.2051 - val_accuracy50: 0.4162 - 125s/epoch - 23ms/step
Epoch 10/50
5452/5452 - 130s - loss: 3.0468 - accuracy50: 0.4838 - val_loss: 3.2014 - val_accuracy50: 0.4177 - 130s/epoch - 24ms/step
Epoch 11/50
5452/5452 - 133s - loss: 3.0441 - accuracy50: 0.4850 - val_loss: 3.1931 - val_accuracy50: 0.4223 - 133s/epoch - 24ms/step
Epoch 12/50
5452/5452 - 131s - loss: 3.0419 - accuracy50: 0.4858 - val_loss: 3.1916 - val_accuracy50: 0.4211 - 131s/epoch - 24ms/step
Epoch 13/50
5452/5452 - 129s - loss: 3.0395 - accuracy50: 0.4869 - val_loss: 3.1919 - val_accuracy50: 0.4207 - 129s/epoch - 24ms/step
Epoch 14/50
5452/5452 - 129s - loss: 3.0375 - accuracy50: 0.4876 - val_loss: 3.1904 - val_accuracy50: 0.4217 - 129s/epoch - 24ms/step
Epoch 15/50
5452/5452 - 134s - loss: 3.0354 - accuracy50: 0.4884 - val_loss: 3.1900 - val_accuracy50: 0.4207 - 134s/epoch - 24ms/step
Epoch 16/50
5452/5452 - 135s - loss: 3.0334 - accuracy50: 0.4889 - val_loss: 3.1855 - val_accuracy50: 0.4244 - 135s/epoch - 25ms/step
Epoch 17/50
5452/5452 - 130s - loss: 3.0315 - accuracy50: 0.4896 - val_loss: 3.1837 - val_accuracy50: 0.4244 - 130s/epoch - 24ms/step
Epoch 18/50
5452/5452 - 123s - loss: 3.0298 - accuracy50: 0.4902 - val_loss: 3.1957 - val_accuracy50: 0.4160 - 123s/epoch - 23ms/step
Epoch 19/50
5452/5452 - 136s - loss: 3.0279 - accuracy50: 0.4908 - val_loss: 3.1867 - val_accuracy50: 0.4228 - 136s/epoch - 25ms/step
Epoch 20/50
5452/5452 - 135s - loss: 3.0257 - accuracy50: 0.4915 - val_loss: 3.1975 - val_accuracy50: 0.4142 - 135s/epoch - 25ms/step
Epoch 21/50
5452/5452 - 138s - loss: 3.0245 - accuracy50: 0.4920 - val_loss: 3.1853 - val_accuracy50: 0.4223 - 138s/epoch - 25ms/step
Epoch 22/50
5452/5452 - 123s - loss: 3.0229 - accuracy50: 0.4925 - val_loss: 3.1908 - val_accuracy50: 0.4185 - 123s/epoch - 23ms/step
Epoch 23/50
5452/5452 - 128s - loss: 3.0210 - accuracy50: 0.4931 - val_loss: 3.1831 - val_accuracy50: 0.4236 - 128s/epoch - 23ms/step
Epoch 24/50
5452/5452 - 128s - loss: 3.0194 - accuracy50: 0.4934 - val_loss: 3.1846 - val_accuracy50: 0.4224 - 128s/epoch - 24ms/step
Epoch 25/50
5452/5452 - 133s - loss: 3.0177 - accuracy50: 0.4939 - val_loss: 3.1863 - val_accuracy50: 0.4219 - 133s/epoch - 24ms/step
Epoch 26/50
5452/5452 - 133s - loss: 3.0162 - accuracy50: 0.4945 - val_loss: 3.1928 - val_accuracy50: 0.4185 - 133s/epoch - 24ms/step
Epoch 27/50
5452/5452 - 131s - loss: 3.0150 - accuracy50: 0.4949 - val_loss: 3.1881 - val_accuracy50: 0.4200 - 131s/epoch - 24ms/step
Epoch 28/50
5452/5452 - 128s - loss: 3.0133 - accuracy50: 0.4953 - val_loss: 3.1862 - val_accuracy50: 0.4226 - 128s/epoch - 24ms/step
Epoch 29/50
5452/5452 - 118s - loss: 3.0120 - accuracy50: 0.4959 - val_loss: 3.1866 - val_accuracy50: 0.4217 - 118s/epoch - 22ms/step
Epoch 30/50
5452/5452 - 119s - loss: 3.0105 - accuracy50: 0.4963 - val_loss: 3.1910 - val_accuracy50: 0.4202 - 119s/epoch - 22ms/step
Epoch 31/50
5452/5452 - 133s - loss: 3.0092 - accuracy50: 0.4967 - val_loss: 3.1812 - val_accuracy50: 0.4253 - 133s/epoch - 24ms/step
Epoch 32/50
5452/5452 - 134s - loss: 3.0073 - accuracy50: 0.4971 - val_loss: 3.1871 - val_accuracy50: 0.4214 - 134s/epoch - 25ms/step
Epoch 33/50
5452/5452 - 128s - loss: 3.0065 - accuracy50: 0.4979 - val_loss: 3.1805 - val_accuracy50: 0.4261 - 128s/epoch - 24ms/step
Epoch 34/50
5452/5452 - 129s - loss: 3.0048 - accuracy50: 0.4985 - val_loss: 3.1808 - val_accuracy50: 0.4252 - 129s/epoch - 24ms/step
Epoch 35/50
5452/5452 - 125s - loss: 3.0029 - accuracy50: 0.4991 - val_loss: 3.1889 - val_accuracy50: 0.4219 - 125s/epoch - 23ms/step
Epoch 36/50
5452/5452 - 124s - loss: 3.0012 - accuracy50: 0.4996 - val_loss: 3.1852 - val_accuracy50: 0.4239 - 124s/epoch - 23ms/step
Epoch 37/50
5452/5452 - 124s - loss: 3.0003 - accuracy50: 0.5001 - val_loss: 3.1855 - val_accuracy50: 0.4248 - 124s/epoch - 23ms/step
Epoch 38/50
5452/5452 - 123s - loss: 2.9984 - accuracy50: 0.5007 - val_loss: 3.1833 - val_accuracy50: 0.4260 - 123s/epoch - 22ms/step
Epoch 39/50
5452/5452 - 130s - loss: 2.9971 - accuracy50: 0.5013 - val_loss: 3.1831 - val_accuracy50: 0.4256 - 130s/epoch - 24ms/step
Epoch 40/50
5452/5452 - 136s - loss: 2.9955 - accuracy50: 0.5018 - val_loss: 3.1868 - val_accuracy50: 0.4243 - 136s/epoch - 25ms/step
Epoch 41/50
5452/5452 - 135s - loss: 2.9937 - accuracy50: 0.5020 - val_loss: 3.1890 - val_accuracy50: 0.4220 - 135s/epoch - 25ms/step
Epoch 42/50
5452/5452 - 130s - loss: 2.9918 - accuracy50: 0.5030 - val_loss: 3.1947 - val_accuracy50: 0.4216 - 130s/epoch - 24ms/step
Epoch 43/50
5452/5452 - 116s - loss: 2.9905 - accuracy50: 0.5033 - val_loss: 3.1870 - val_accuracy50: 0.4247 - 116s/epoch - 21ms/step
testing model: results/AAPL/W6/deepVOL_L2/h50
Evaluating performance on  test set...
29350/29350 - 284s - 284s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0836692
{'0': {'precision': 0.3682227378060678, 'recall': 0.4767659895249342, 'f1-score': 0.41552288753059513, 'support': 2212683}, '1': {'precision': 0.46914767079986314, 'recall': 0.21280002570673437, 'f1-score': 0.29279264940078753, 'support': 3112025}, '2': {'precision': 0.3508932631755855, 'recall': 0.5189414153450274, 'f1-score': 0.4186842652377842, 'support': 2188696}, 'accuracy': 0.37971816769070316, 'macro avg': {'precision': 0.3960878905938388, 'recall': 0.402835810192232, 'f1-score': 0.37566660072305563, 'support': 7513404}, 'weighted avg': {'precision': 0.404977311737428, 'recall': 0.37971816769070316, 'f1-score': 0.36560938965750045, 'support': 7513404}}
[[1054932  392482  765269]
 [1113964  662239 1335822]
 [ 696033  356858 1135805]]
Evaluating performance on  train set...
5452/5452 - 54s - 54s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.054425
{'0': {'precision': 0.43111146849309884, 'recall': 0.5832131765749778, 'f1-score': 0.495758217490395, 'support': 468832}, '1': {'precision': 0.4964334705075446, 'recall': 0.17306868795336028, 'f1-score': 0.2566596337624533, 'support': 460037}, '2': {'precision': 0.41979985121152763, 'recall': 0.5405802754358067, 'f1-score': 0.47259520037771946, 'support': 466606}, 'accuracy': 0.43374836525197513, 'macro avg': {'precision': 0.4491149300707236, 'recall': 0.4322873799880482, 'f1-score': 0.40833768387685593, 'support': 1395475}, 'weighted avg': {'precision': 0.44886346644894526, 'recall': 0.43374836525197513, 'f1-score': 0.40919113608418695, 'support': 1395475}}
[[273429  42772 152631]
 [184435  79618 195984]
 [176378  37990 252238]]
Evaluating performance on  val set...
1969/1969 - 17s - 17s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0593542
{'0': {'precision': 0.42255624837004196, 'recall': 0.5433145755726401, 'f1-score': 0.4753864865729923, 'support': 164021}, '1': {'precision': 0.5037988422575976, 'recall': 0.21622910635654788, 'f1-score': 0.3025881805129797, 'support': 180318}, '2': {'precision': 0.4023060952098472, 'recall': 0.5434875159650397, 'f1-score': 0.46235952063914776, 'support': 159724}, 'accuracy': 0.4263613873662618, 'macro avg': {'precision': 0.44288706194582894, 'recall': 0.43434373263140924, 'f1-score': 0.41344472924170655, 'support': 504063}, 'weighted avg': {'precision': 0.4452023592356626, 'recall': 0.4263613873662618, 'f1-score': 0.4094436102679536, 'support': 504063}}
[[89115 19711 55195]
 [67555 38990 73773]
 [54225 18691 86808]]
training model: results/AAPL/W6/deepVOL_L2/h100
Epoch 1/50
5452/5452 - 135s - loss: 3.2271 - accuracy100: 0.4062 - val_loss: 3.2941 - val_accuracy100: 0.3732 - 135s/epoch - 25ms/step
Epoch 2/50
5452/5452 - 124s - loss: 3.2175 - accuracy100: 0.4117 - val_loss: 3.3121 - val_accuracy100: 0.3732 - 124s/epoch - 23ms/step
Epoch 3/50
5452/5452 - 134s - loss: 3.2053 - accuracy100: 0.4190 - val_loss: 3.2962 - val_accuracy100: 0.3734 - 134s/epoch - 25ms/step
Epoch 4/50
5452/5452 - 133s - loss: 3.1973 - accuracy100: 0.4238 - val_loss: 3.2980 - val_accuracy100: 0.3737 - 133s/epoch - 24ms/step
Epoch 5/50
5452/5452 - 139s - loss: 3.1921 - accuracy100: 0.4264 - val_loss: 3.2891 - val_accuracy100: 0.3740 - 139s/epoch - 25ms/step
Epoch 6/50
5452/5452 - 124s - loss: 3.1885 - accuracy100: 0.4282 - val_loss: 3.2947 - val_accuracy100: 0.3740 - 124s/epoch - 23ms/step
Epoch 7/50
5452/5452 - 124s - loss: 3.1852 - accuracy100: 0.4297 - val_loss: 3.2917 - val_accuracy100: 0.3746 - 124s/epoch - 23ms/step
Epoch 8/50
5452/5452 - 120s - loss: 3.1820 - accuracy100: 0.4310 - val_loss: 3.2900 - val_accuracy100: 0.3754 - 120s/epoch - 22ms/step
Epoch 9/50
5452/5452 - 133s - loss: 3.1792 - accuracy100: 0.4324 - val_loss: 3.2856 - val_accuracy100: 0.3764 - 133s/epoch - 24ms/step
Epoch 10/50
5452/5452 - 121s - loss: 3.1771 - accuracy100: 0.4333 - val_loss: 3.2844 - val_accuracy100: 0.3763 - 121s/epoch - 22ms/step
Epoch 11/50
5452/5452 - 129s - loss: 3.1742 - accuracy100: 0.4344 - val_loss: 3.2835 - val_accuracy100: 0.3779 - 129s/epoch - 24ms/step
Epoch 12/50
5452/5452 - 128s - loss: 3.1722 - accuracy100: 0.4354 - val_loss: 3.2841 - val_accuracy100: 0.3799 - 128s/epoch - 23ms/step
Epoch 13/50
5452/5452 - 133s - loss: 3.1694 - accuracy100: 0.4371 - val_loss: 3.2787 - val_accuracy100: 0.3811 - 133s/epoch - 24ms/step
Epoch 14/50
5452/5452 - 124s - loss: 3.1675 - accuracy100: 0.4376 - val_loss: 3.2798 - val_accuracy100: 0.3812 - 124s/epoch - 23ms/step
Epoch 15/50
5452/5452 - 132s - loss: 3.1653 - accuracy100: 0.4386 - val_loss: 3.2811 - val_accuracy100: 0.3815 - 132s/epoch - 24ms/step
Epoch 16/50
5452/5452 - 126s - loss: 3.1634 - accuracy100: 0.4396 - val_loss: 3.2700 - val_accuracy100: 0.3848 - 126s/epoch - 23ms/step
Epoch 17/50
5452/5452 - 127s - loss: 3.1616 - accuracy100: 0.4404 - val_loss: 3.2728 - val_accuracy100: 0.3841 - 127s/epoch - 23ms/step
Epoch 18/50
5452/5452 - 127s - loss: 3.1596 - accuracy100: 0.4414 - val_loss: 3.2714 - val_accuracy100: 0.3856 - 127s/epoch - 23ms/step
Epoch 19/50
5452/5452 - 135s - loss: 3.1578 - accuracy100: 0.4424 - val_loss: 3.2738 - val_accuracy100: 0.3854 - 135s/epoch - 25ms/step
Epoch 20/50
5452/5452 - 126s - loss: 3.1564 - accuracy100: 0.4428 - val_loss: 3.2771 - val_accuracy100: 0.3845 - 126s/epoch - 23ms/step
Epoch 21/50
5452/5452 - 129s - loss: 3.1548 - accuracy100: 0.4439 - val_loss: 3.2748 - val_accuracy100: 0.3851 - 129s/epoch - 24ms/step
Epoch 22/50
5452/5452 - 126s - loss: 3.1532 - accuracy100: 0.4441 - val_loss: 3.2687 - val_accuracy100: 0.3859 - 126s/epoch - 23ms/step
Epoch 23/50
5452/5452 - 138s - loss: 3.1514 - accuracy100: 0.4448 - val_loss: 3.2666 - val_accuracy100: 0.3879 - 138s/epoch - 25ms/step
Epoch 24/50
5452/5452 - 137s - loss: 3.1501 - accuracy100: 0.4454 - val_loss: 3.2694 - val_accuracy100: 0.3864 - 137s/epoch - 25ms/step
Epoch 25/50
5452/5452 - 136s - loss: 3.1484 - accuracy100: 0.4462 - val_loss: 3.2684 - val_accuracy100: 0.3869 - 136s/epoch - 25ms/step
Epoch 26/50
5452/5452 - 123s - loss: 3.1468 - accuracy100: 0.4471 - val_loss: 3.2704 - val_accuracy100: 0.3869 - 123s/epoch - 23ms/step
Epoch 27/50
5452/5452 - 136s - loss: 3.1456 - accuracy100: 0.4474 - val_loss: 3.2689 - val_accuracy100: 0.3870 - 136s/epoch - 25ms/step
Epoch 28/50
5452/5452 - 135s - loss: 3.1443 - accuracy100: 0.4482 - val_loss: 3.2663 - val_accuracy100: 0.3876 - 135s/epoch - 25ms/step
Epoch 29/50
5452/5452 - 117s - loss: 3.1426 - accuracy100: 0.4488 - val_loss: 3.2718 - val_accuracy100: 0.3877 - 117s/epoch - 21ms/step
Epoch 30/50
5452/5452 - 127s - loss: 3.1411 - accuracy100: 0.4495 - val_loss: 3.2658 - val_accuracy100: 0.3886 - 127s/epoch - 23ms/step
Epoch 31/50
5452/5452 - 134s - loss: 3.1397 - accuracy100: 0.4503 - val_loss: 3.2695 - val_accuracy100: 0.3867 - 134s/epoch - 25ms/step
Epoch 32/50
5452/5452 - 123s - loss: 3.1379 - accuracy100: 0.4511 - val_loss: 3.2695 - val_accuracy100: 0.3868 - 123s/epoch - 22ms/step
Epoch 33/50
5452/5452 - 127s - loss: 3.1365 - accuracy100: 0.4517 - val_loss: 3.2699 - val_accuracy100: 0.3878 - 127s/epoch - 23ms/step
Epoch 34/50
5452/5452 - 120s - loss: 3.1350 - accuracy100: 0.4523 - val_loss: 3.2685 - val_accuracy100: 0.3895 - 120s/epoch - 22ms/step
Epoch 35/50
5452/5452 - 131s - loss: 3.1334 - accuracy100: 0.4530 - val_loss: 3.2720 - val_accuracy100: 0.3876 - 131s/epoch - 24ms/step
Epoch 36/50
5452/5452 - 129s - loss: 3.1328 - accuracy100: 0.4535 - val_loss: 3.2717 - val_accuracy100: 0.3888 - 129s/epoch - 24ms/step
Epoch 37/50
5452/5452 - 131s - loss: 3.1307 - accuracy100: 0.4544 - val_loss: 3.2770 - val_accuracy100: 0.3887 - 131s/epoch - 24ms/step
Epoch 38/50
5452/5452 - 126s - loss: 3.1291 - accuracy100: 0.4548 - val_loss: 3.2762 - val_accuracy100: 0.3894 - 126s/epoch - 23ms/step
Epoch 39/50
5452/5452 - 126s - loss: 3.1273 - accuracy100: 0.4560 - val_loss: 3.2734 - val_accuracy100: 0.3892 - 126s/epoch - 23ms/step
Epoch 40/50
5452/5452 - 126s - loss: 3.1257 - accuracy100: 0.4565 - val_loss: 3.2813 - val_accuracy100: 0.3870 - 126s/epoch - 23ms/step
testing model: results/AAPL/W6/deepVOL_L2/h100
Evaluating performance on  test set...
29350/29350 - 273s - 273s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0869002
{'0': {'precision': 0.40459968093066595, 'recall': 0.0635170345389473, 'f1-score': 0.10979728370664583, 'support': 2255946}, '1': {'precision': 0.40781951314871323, 'recall': 0.8329524609074173, 'f1-score': 0.5475530946638197, 'support': 3025510}, '2': {'precision': 0.3536132927121767, 'recall': 0.15522987094681417, 'f1-score': 0.2157495657328925, 'support': 2231948}, 'accuracy': 0.40059898283121737, 'macro avg': {'precision': 0.3886774955971853, 'recall': 0.35056645546439286, 'f1-score': 0.29103331470111937, 'support': 7513404}, 'weighted avg': {'precision': 0.39075012184433755, 'recall': 0.40059898283121737, 'f1-score': 0.31754793408734633, 'support': 7513404}}
[[ 143291 1860523  252132]
 [ 124216 2520106  381188]
 [  86648 1798835  346465]]
Evaluating performance on  train set...
5452/5452 - 53s - 53s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1011043
{'0': {'precision': 0.4681197974770445, 'recall': 0.10466789608894479, 'f1-score': 0.1710829854407839, 'support': 469055}, '1': {'precision': 0.3401863891954764, 'recall': 0.8226126671339815, 'f1-score': 0.4813241486833156, 'support': 459362}, '2': {'precision': 0.4277602278036084, 'recall': 0.1646754792766637, 'f1-score': 0.23780342638769936, 'support': 467058}, 'accuracy': 0.36108493523710566, 'macro avg': {'precision': 0.41202213815870975, 'recall': 0.36398534749986333, 'f1-score': 0.2967368535039329, 'support': 1395475}, 'weighted avg': {'precision': 0.41249858879356865, 'recall': 0.36108493523710566, 'f1-score': 0.29553904301057216, 'support': 1395475}}
[[ 49095 370064  49896]
 [ 28490 377877  52995]
 [ 27292 362853  76913]]
Evaluating performance on  val set...
1969/1969 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0894963
{'0': {'precision': 0.43576245625017784, 'recall': 0.09568259918775383, 'f1-score': 0.1569113646493471, 'support': 160050}, '1': {'precision': 0.38349688365397966, 'recall': 0.8370368401467226, 'f1-score': 0.5260010656653643, 'support': 188110}, '2': {'precision': 0.39833399036731054, 'recall': 0.14906704810042143, 'f1-score': 0.2169468741540099, 'support': 155903}, 'accuracy': 0.3888581387644005, 'macro avg': {'precision': 0.4058644434238226, 'recall': 0.36059549581163264, 'f1-score': 0.29995310148957377, 'support': 504063}, 'weighted avg': {'precision': 0.4046812481916465, 'recall': 0.3888581387644005, 'f1-score': 0.3132195636173897, 'support': 504063}}
[[ 15314 129118  15618]
 [ 11170 157455  19485]
 [  8659 124004  23240]]
training model: results/AAPL/W6/deepVOL_L2/h200
Epoch 1/50
5452/5452 - 125s - loss: 3.1887 - accuracy200: 0.4200 - val_loss: 3.3113 - val_accuracy200: 0.3763 - 125s/epoch - 23ms/step
Epoch 2/50
5452/5452 - 135s - loss: 3.1943 - accuracy200: 0.4182 - val_loss: 3.3038 - val_accuracy200: 0.3763 - 135s/epoch - 25ms/step
Epoch 3/50
5452/5452 - 122s - loss: 3.1865 - accuracy200: 0.4228 - val_loss: 3.3096 - val_accuracy200: 0.3763 - 122s/epoch - 22ms/step
Epoch 4/50
5452/5452 - 125s - loss: 3.1828 - accuracy200: 0.4265 - val_loss: 3.3272 - val_accuracy200: 0.3763 - 125s/epoch - 23ms/step
Epoch 5/50
5452/5452 - 122s - loss: 3.1734 - accuracy200: 0.4303 - val_loss: 3.3385 - val_accuracy200: 0.3763 - 122s/epoch - 22ms/step
Epoch 6/50
5452/5452 - 125s - loss: 3.1671 - accuracy200: 0.4335 - val_loss: 3.3432 - val_accuracy200: 0.3763 - 125s/epoch - 23ms/step
Epoch 7/50
5452/5452 - 126s - loss: 3.1613 - accuracy200: 0.4354 - val_loss: 3.3387 - val_accuracy200: 0.3763 - 126s/epoch - 23ms/step
Epoch 8/50
5452/5452 - 136s - loss: 3.1571 - accuracy200: 0.4367 - val_loss: 3.3251 - val_accuracy200: 0.3763 - 136s/epoch - 25ms/step
Epoch 9/50
5452/5452 - 126s - loss: 3.1545 - accuracy200: 0.4374 - val_loss: 3.3201 - val_accuracy200: 0.3763 - 126s/epoch - 23ms/step
Epoch 10/50
5452/5452 - 142s - loss: 3.1515 - accuracy200: 0.4391 - val_loss: 3.3185 - val_accuracy200: 0.3763 - 142s/epoch - 26ms/step
Epoch 11/50
5452/5452 - 137s - loss: 3.1496 - accuracy200: 0.4398 - val_loss: 3.3122 - val_accuracy200: 0.3763 - 137s/epoch - 25ms/step
Epoch 12/50
5452/5452 - 132s - loss: 3.1478 - accuracy200: 0.4407 - val_loss: 3.3102 - val_accuracy200: 0.3763 - 132s/epoch - 24ms/step
testing model: results/AAPL/W6/deepVOL_L2/h200
Evaluating performance on  test set...
29350/29350 - 304s - 304s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0874752
{'0': {'precision': 0.343205574912892, 'recall': 8.902039606394286e-05, 'f1-score': 0.000177994624020239, 'support': 2212976}, '1': {'precision': 0.4085467488820879, 'recall': 0.9997791102835891, 'f1-score': 0.580059653734634, 'support': 3069405}, '2': {'precision': 0.3253652058432935, 'recall': 0.00021963018758659145, 'f1-score': 0.00043896406272886043, 'support': 2231023}, 'accuracy': 0.4085250839699289, 'macro avg': {'precision': 0.35903917654609113, 'recall': 0.33336258695574655, 'f1-score': 0.19355887080712766, 'support': 7513404}, 'weighted avg': {'precision': 0.36460150309193806, 'recall': 0.4085250839699289, 'f1-score': 0.23715099550384375, 'support': 7513404}}
[[    197 2212253     526]
 [    188 3068727     490]
 [    189 2230344     490]]
Evaluating performance on  train set...
5452/5452 - 48s - 48s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1198297
{'0': {'precision': 0.3372093023255814, 'recall': 6.22660995441692e-05, 'f1-score': 0.00012450920831463905, 'support': 465743}, '1': {'precision': 0.3330602450053865, 'recall': 0.9998128054015324, 'f1-score': 0.49966933883897613, 'support': 464757}, '2': {'precision': 0.3177966101694915, 'recall': 0.00016129899456960052, 'f1-score': 0.00032243433624742316, 'support': 464975}, 'accuracy': 0.33305791934645906, 'macro avg': {'precision': 0.3293553858334865, 'recall': 0.33334545683188205, 'f1-score': 0.16670542746117942, 'support': 1395475}, 'weighted avg': {'precision': 0.3293591294681388, 'recall': 0.33305791934645906, 'f1-score': 0.16656173425427953, 'support': 1395475}}
[[    29 465619     95]
 [    21 464670     66]
 [    36 464864     75]]
Evaluating performance on  val set...
1969/1969 - 17s - 17s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.101378
{'0': {'precision': 0.2413793103448276, 'recall': 4.3921017461741656e-05, 'f1-score': 8.78260542263152e-05, 'support': 159377}, '1': {'precision': 0.37633446307952406, 'recall': 0.9997627808411265, 'f1-score': 0.5468293625278601, 'support': 189698}, '2': {'precision': 0.3023255813953488, 'recall': 0.0001677549229617777, 'f1-score': 0.00033532378090460037, 'support': 154988}, 'accuracy': 0.3763140718521296, 'macro avg': {'precision': 0.30667978493990017, 'recall': 0.3333248189271833, 'f1-score': 0.182417504120997, 'support': 504063}, 'weighted avg': {'precision': 0.3109076495029182, 'recall': 0.3763140718521296, 'f1-score': 0.20592347589092888, 'support': 504063}}
[[     7 159342     28]
 [    13 189653     32]
 [     9 154953     26]]
training model: results/AAPL/W6/deepVOL_L2/h300
Epoch 1/50
5452/5452 - 126s - loss: 3.2122 - accuracy300: 0.4083 - val_loss: 3.3190 - val_accuracy300: 0.3589 - 126s/epoch - 23ms/step
Epoch 2/50
5452/5452 - 127s - loss: 3.2196 - accuracy300: 0.4024 - val_loss: 3.3191 - val_accuracy300: 0.3589 - 127s/epoch - 23ms/step
Epoch 3/50
5452/5452 - 135s - loss: 3.2109 - accuracy300: 0.4088 - val_loss: 3.3209 - val_accuracy300: 0.3589 - 135s/epoch - 25ms/step
Epoch 4/50
5452/5452 - 137s - loss: 3.2036 - accuracy300: 0.4126 - val_loss: 3.3207 - val_accuracy300: 0.3589 - 137s/epoch - 25ms/step
Epoch 5/50
5452/5452 - 127s - loss: 3.1966 - accuracy300: 0.4160 - val_loss: 3.3125 - val_accuracy300: 0.3589 - 127s/epoch - 23ms/step
Epoch 6/50
5452/5452 - 132s - loss: 3.1917 - accuracy300: 0.4194 - val_loss: 3.3128 - val_accuracy300: 0.3589 - 132s/epoch - 24ms/step
Epoch 7/50
5452/5452 - 123s - loss: 3.1884 - accuracy300: 0.4203 - val_loss: 3.3099 - val_accuracy300: 0.3589 - 123s/epoch - 23ms/step
Epoch 8/50
5452/5452 - 130s - loss: 3.1865 - accuracy300: 0.4214 - val_loss: 3.3087 - val_accuracy300: 0.3589 - 130s/epoch - 24ms/step
Epoch 9/50
5452/5452 - 128s - loss: 3.1848 - accuracy300: 0.4223 - val_loss: 3.3026 - val_accuracy300: 0.3590 - 128s/epoch - 24ms/step
Epoch 10/50
5452/5452 - 131s - loss: 3.1829 - accuracy300: 0.4229 - val_loss: 3.3014 - val_accuracy300: 0.3603 - 131s/epoch - 24ms/step
Epoch 11/50
5452/5452 - 121s - loss: 3.1813 - accuracy300: 0.4237 - val_loss: 3.2997 - val_accuracy300: 0.3613 - 121s/epoch - 22ms/step
Epoch 12/50
5452/5452 - 120s - loss: 3.1798 - accuracy300: 0.4245 - val_loss: 3.3029 - val_accuracy300: 0.3611 - 120s/epoch - 22ms/step
Epoch 13/50
5452/5452 - 125s - loss: 3.1781 - accuracy300: 0.4250 - val_loss: 3.3056 - val_accuracy300: 0.3611 - 125s/epoch - 23ms/step
Epoch 14/50
5452/5452 - 135s - loss: 3.1766 - accuracy300: 0.4257 - val_loss: 3.2972 - val_accuracy300: 0.3636 - 135s/epoch - 25ms/step
Epoch 15/50
5452/5452 - 133s - loss: 3.1755 - accuracy300: 0.4263 - val_loss: 3.2993 - val_accuracy300: 0.3637 - 133s/epoch - 24ms/step
Epoch 16/50
5452/5452 - 135s - loss: 3.1739 - accuracy300: 0.4273 - val_loss: 3.3002 - val_accuracy300: 0.3630 - 135s/epoch - 25ms/step
Epoch 17/50
5452/5452 - 133s - loss: 3.1725 - accuracy300: 0.4279 - val_loss: 3.3022 - val_accuracy300: 0.3624 - 133s/epoch - 24ms/step
Epoch 18/50
5452/5452 - 116s - loss: 3.1711 - accuracy300: 0.4287 - val_loss: 3.2988 - val_accuracy300: 0.3652 - 116s/epoch - 21ms/step
Epoch 19/50
5452/5452 - 115s - loss: 3.1697 - accuracy300: 0.4298 - val_loss: 3.2976 - val_accuracy300: 0.3675 - 115s/epoch - 21ms/step
Epoch 20/50
5452/5452 - 124s - loss: 3.1684 - accuracy300: 0.4299 - val_loss: 3.2951 - val_accuracy300: 0.3703 - 124s/epoch - 23ms/step
Epoch 21/50
5452/5452 - 128s - loss: 3.1670 - accuracy300: 0.4305 - val_loss: 3.2959 - val_accuracy300: 0.3696 - 128s/epoch - 23ms/step
Epoch 22/50
5452/5452 - 119s - loss: 3.1660 - accuracy300: 0.4312 - val_loss: 3.2977 - val_accuracy300: 0.3684 - 119s/epoch - 22ms/step
Epoch 23/50
5452/5452 - 121s - loss: 3.1649 - accuracy300: 0.4317 - val_loss: 3.2921 - val_accuracy300: 0.3729 - 121s/epoch - 22ms/step
Epoch 24/50
5452/5452 - 121s - loss: 3.1641 - accuracy300: 0.4318 - val_loss: 3.2905 - val_accuracy300: 0.3703 - 121s/epoch - 22ms/step
Epoch 25/50
5452/5452 - 130s - loss: 3.1642 - accuracy300: 0.4318 - val_loss: 3.2982 - val_accuracy300: 0.3690 - 130s/epoch - 24ms/step
Epoch 26/50
5452/5452 - 121s - loss: 3.1625 - accuracy300: 0.4327 - val_loss: 3.2966 - val_accuracy300: 0.3691 - 121s/epoch - 22ms/step
Epoch 27/50
5452/5452 - 130s - loss: 3.1609 - accuracy300: 0.4330 - val_loss: 3.2950 - val_accuracy300: 0.3678 - 130s/epoch - 24ms/step
Epoch 28/50
5452/5452 - 129s - loss: 3.1601 - accuracy300: 0.4336 - val_loss: 3.2935 - val_accuracy300: 0.3728 - 129s/epoch - 24ms/step
Epoch 29/50
5452/5452 - 128s - loss: 3.1587 - accuracy300: 0.4341 - val_loss: 3.2950 - val_accuracy300: 0.3724 - 128s/epoch - 23ms/step
Epoch 30/50
5452/5452 - 132s - loss: 3.1580 - accuracy300: 0.4345 - val_loss: 3.2958 - val_accuracy300: 0.3705 - 132s/epoch - 24ms/step
Epoch 31/50
5452/5452 - 131s - loss: 3.1563 - accuracy300: 0.4350 - val_loss: 3.3066 - val_accuracy300: 0.3667 - 131s/epoch - 24ms/step
Epoch 32/50
5452/5452 - 131s - loss: 3.1557 - accuracy300: 0.4351 - val_loss: 3.3023 - val_accuracy300: 0.3686 - 131s/epoch - 24ms/step
Epoch 33/50
5452/5452 - 126s - loss: 3.1546 - accuracy300: 0.4353 - val_loss: 3.3043 - val_accuracy300: 0.3678 - 126s/epoch - 23ms/step
Epoch 34/50
5452/5452 - 134s - loss: 3.1535 - accuracy300: 0.4356 - val_loss: 3.3010 - val_accuracy300: 0.3676 - 134s/epoch - 25ms/step
testing model: results/AAPL/W6/deepVOL_L2/h300
Evaluating performance on  test set...
29350/29350 - 286s - 286s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0903162
{'0': {'precision': 0.30413828680347293, 'recall': 0.15777675772178357, 'f1-score': 0.20776960334872185, 'support': 2204672}, '1': {'precision': 0.4205266795498695, 'recall': 0.8066984404680048, 'f1-score': 0.5528540950386139, 'support': 3099199}, '2': {'precision': 0.3226356643933237, 'recall': 0.061983233561119025, 'f1-score': 0.10398865915115237, 'support': 2209533}, 'accuracy': 0.39727918264477724, 'macro avg': {'precision': 0.3491002102488887, 'recall': 0.3421528105836358, 'f1-score': 0.28820411917949607, 'support': 7513404}, 'weighted avg': {'precision': 0.35758694424415827, 'recall': 0.39727918264477724, 'f1-score': 0.3195934970971657, 'support': 7513404}}
[[ 347846 1730672  126154]
 [ 437703 2500119  161377]
 [ 358161 1714418  136954]]
Evaluating performance on  train set...
5452/5452 - 51s - 51s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.103638
{'0': {'precision': 0.37133064272326016, 'recall': 0.20768491022646812, 'f1-score': 0.2663823823226826, 'support': 473135}, '1': {'precision': 0.3437240022568148, 'recall': 0.7694097017989723, 'f1-score': 0.4751712774736196, 'support': 450535}, '2': {'precision': 0.38796894156109524, 'recall': 0.10060936191858925, 'f1-score': 0.15978322154993227, 'support': 471805}, 'accuracy': 0.3528382808721045, 'macro avg': {'precision': 0.3676745288470567, 'recall': 0.35923465798134324, 'f1-score': 0.3004456271154115, 'support': 1395475}, 'weighted avg': {'precision': 0.3680430702627251, 'recall': 0.3528382808721045, 'f1-score': 0.2977499724467908, 'support': 1395475}}
[[ 98263 330905  43967]
 [ 72974 346646  30915]
 [ 93387 330950  47468]]
Evaluating performance on  val set...
1969/1969 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977323
{'0': {'precision': 0.3529458875036707, 'recall': 0.16156172669782787, 'f1-score': 0.22165870996676204, 'support': 163665}, '1': {'precision': 0.37337024333321545, 'recall': 0.8172218966641973, 'f1-score': 0.5125623261974603, 'support': 180886}, '2': {'precision': 0.37108375718542147, 'recall': 0.07729825969206079, 'f1-score': 0.1279450448534028, 'support': 159512}, 'accuracy': 0.37018388574444067, 'macro avg': {'precision': 0.3657999626741026, 'recall': 0.352027294351362, 'f1-score': 0.2873886936725418, 'support': 504063}, 'weighted avg': {'precision': 0.3660150631766689, 'recall': 0.37018388574444067, 'f1-score': 0.29639527538803667, 'support': 504063}}
[[ 26442 125682  11541]
 [ 23706 147824   9356]
 [ 24770 122412  12330]]
training model: results/AAPL/W6/deepVOL_L2/h500
Epoch 1/50
5452/5452 - 126s - loss: 3.2173 - accuracy500: 0.4065 - val_loss: 3.3039 - val_accuracy500: 0.3722 - 126s/epoch - 23ms/step
Epoch 2/50
5452/5452 - 129s - loss: 3.2202 - accuracy500: 0.4060 - val_loss: 3.2992 - val_accuracy500: 0.3722 - 129s/epoch - 24ms/step
Epoch 3/50
5452/5452 - 125s - loss: 3.2177 - accuracy500: 0.4074 - val_loss: 3.3110 - val_accuracy500: 0.3722 - 125s/epoch - 23ms/step
Epoch 4/50
5452/5452 - 134s - loss: 3.2084 - accuracy500: 0.4125 - val_loss: 3.3011 - val_accuracy500: 0.3722 - 134s/epoch - 25ms/step
Epoch 5/50
5452/5452 - 119s - loss: 3.2043 - accuracy500: 0.4141 - val_loss: 3.3076 - val_accuracy500: 0.3722 - 119s/epoch - 22ms/step
Epoch 6/50
5452/5452 - 134s - loss: 3.2009 - accuracy500: 0.4161 - val_loss: 3.3066 - val_accuracy500: 0.3722 - 134s/epoch - 25ms/step
Epoch 7/50
5452/5452 - 122s - loss: 3.1974 - accuracy500: 0.4185 - val_loss: 3.3083 - val_accuracy500: 0.3722 - 122s/epoch - 22ms/step
Epoch 8/50
5452/5452 - 136s - loss: 3.1943 - accuracy500: 0.4204 - val_loss: 3.3006 - val_accuracy500: 0.3722 - 136s/epoch - 25ms/step
Epoch 9/50
5452/5452 - 132s - loss: 3.1922 - accuracy500: 0.4214 - val_loss: 3.2954 - val_accuracy500: 0.3722 - 132s/epoch - 24ms/step
Epoch 10/50
5452/5452 - 120s - loss: 3.1895 - accuracy500: 0.4220 - val_loss: 3.2985 - val_accuracy500: 0.3722 - 120s/epoch - 22ms/step
Epoch 11/50
5452/5452 - 128s - loss: 3.1874 - accuracy500: 0.4226 - val_loss: 3.3005 - val_accuracy500: 0.3722 - 128s/epoch - 24ms/step
Epoch 12/50
5452/5452 - 124s - loss: 3.1854 - accuracy500: 0.4234 - val_loss: 3.3072 - val_accuracy500: 0.3722 - 124s/epoch - 23ms/step
Epoch 13/50
5452/5452 - 132s - loss: 3.1837 - accuracy500: 0.4241 - val_loss: 3.3126 - val_accuracy500: 0.3722 - 132s/epoch - 24ms/step
Epoch 14/50
5452/5452 - 126s - loss: 3.1817 - accuracy500: 0.4250 - val_loss: 3.3171 - val_accuracy500: 0.3722 - 126s/epoch - 23ms/step
Epoch 15/50
5452/5452 - 131s - loss: 3.1799 - accuracy500: 0.4255 - val_loss: 3.3169 - val_accuracy500: 0.3720 - 131s/epoch - 24ms/step
Epoch 16/50
5452/5452 - 121s - loss: 3.1781 - accuracy500: 0.4255 - val_loss: 3.3125 - val_accuracy500: 0.3718 - 121s/epoch - 22ms/step
Epoch 17/50
5452/5452 - 120s - loss: 3.1764 - accuracy500: 0.4264 - val_loss: 3.3175 - val_accuracy500: 0.3719 - 120s/epoch - 22ms/step
Epoch 18/50
5452/5452 - 135s - loss: 3.1750 - accuracy500: 0.4268 - val_loss: 3.3051 - val_accuracy500: 0.3718 - 135s/epoch - 25ms/step
Epoch 19/50
5452/5452 - 124s - loss: 3.1736 - accuracy500: 0.4275 - val_loss: 3.3021 - val_accuracy500: 0.3721 - 124s/epoch - 23ms/step
testing model: results/AAPL/W6/deepVOL_L2/h500
Evaluating performance on  test set...
29350/29350 - 264s - 264s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0955034
{'0': {'precision': 0.2947882736156352, 'recall': 0.0001579314298378716, 'f1-score': 0.0003156937282470015, 'support': 2292134}, '1': {'precision': 0.38765017460592005, 'recall': 0.9995986340510769, 'f1-score': 0.5586518908614162, 'support': 2912554}, '2': {'precision': 0.28174386920980926, 'recall': 0.0002239339962126134, 'f1-score': 0.0004475123033423629, 'support': 2308716}, 'accuracy': 0.3876091316266236, 'macro avg': {'precision': 0.32139410581045486, 'recall': 0.33332683315904243, 'f1-score': 0.18647169896433521, 'support': 7513404}, 'weighted avg': {'precision': 0.32677769891669145, 'recall': 0.3876091316266236, 'f1-score': 0.21679395790230452, 'support': 7513404}}
[[    362 2291147     625]
 [    476 2911385     693]
 [    390 2307809     517]]
Evaluating performance on  train set...
5452/5452 - 54s - 54s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1137933
{'0': {'precision': 0.3767123287671233, 'recall': 0.00011729980123015501, 'f1-score': 0.00023452657612519455, 'support': 468884}, '1': {'precision': 0.3289956496525958, 'recall': 0.999714659115661, 'f1-score': 0.49506919841373004, 'support': 459100}, '2': {'precision': 0.30223880597014924, 'recall': 0.00017326536767552745, 'f1-score': 0.0003463321924324278, 'support': 467491}, 'accuracy': 0.3289955033232412, 'macro avg': {'precision': 0.33598226146328947, 'recall': 0.33333507476152224, 'f1-score': 0.16521668572742923, 'support': 1395475}, 'weighted avg': {'precision': 0.33606492983316905, 'recall': 0.3289955033232412, 'f1-score': 0.16306859093415202, 'support': 1395475}}
[[    55 468728    101]
 [    45 458969     86]
 [    46 467364     81]]
Evaluating performance on  val set...
1969/1969 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0991421
{'0': {'precision': 0.4044943820224719, 'recall': 0.0002239279449634873, 'f1-score': 0.0004476080942463709, 'support': 160766}, '1': {'precision': 0.37218140611169986, 'recall': 0.999637536312998, 'f1-score': 0.5424134225897372, 'support': 187605}, '2': {'precision': 0.2727272727272727, 'recall': 0.0001541505022737199, 'f1-score': 0.00030812684555141863, 'support': 155692}, 'accuracy': 0.37216974862269203, 'macro avg': {'precision': 0.34980102028714816, 'recall': 0.33333853825341175, 'f1-score': 0.18105638584317832, 'support': 504063}, 'weighted avg': {'precision': 0.35176851119654623, 'recall': 0.37216974862269203, 'f1-score': 0.20211640845026288, 'support': 504063}}
[[    36 160704     26]
 [    30 187537     38]
 [    23 155645     24]]
training model: results/AAPL/W6/deepVOL_L2/h1000
Epoch 1/50
5452/5452 - 135s - loss: 3.2080 - accuracy1000: 0.4132 - val_loss: 3.2838 - val_accuracy1000: 0.3750 - 135s/epoch - 25ms/step
Epoch 2/50
5452/5452 - 133s - loss: 3.2132 - accuracy1000: 0.4111 - val_loss: 3.2872 - val_accuracy1000: 0.3749 - 133s/epoch - 24ms/step
Epoch 3/50
5452/5452 - 131s - loss: 3.2112 - accuracy1000: 0.4094 - val_loss: 3.2833 - val_accuracy1000: 0.3750 - 131s/epoch - 24ms/step
Epoch 4/50
5452/5452 - 127s - loss: 3.2088 - accuracy1000: 0.4131 - val_loss: 3.2848 - val_accuracy1000: 0.3745 - 127s/epoch - 23ms/step
Epoch 5/50
5452/5452 - 135s - loss: 3.2082 - accuracy1000: 0.4119 - val_loss: 3.2844 - val_accuracy1000: 0.3749 - 135s/epoch - 25ms/step
Epoch 6/50
5452/5452 - 133s - loss: 3.2116 - accuracy1000: 0.4105 - val_loss: 3.2864 - val_accuracy1000: 0.3751 - 133s/epoch - 24ms/step
Epoch 7/50
5452/5452 - 135s - loss: 3.2060 - accuracy1000: 0.4137 - val_loss: 3.2851 - val_accuracy1000: 0.3750 - 135s/epoch - 25ms/step
Epoch 8/50
5452/5452 - 132s - loss: 3.2036 - accuracy1000: 0.4167 - val_loss: 3.2848 - val_accuracy1000: 0.3750 - 132s/epoch - 24ms/step
Epoch 9/50
5452/5452 - 125s - loss: 3.1949 - accuracy1000: 0.4217 - val_loss: 3.2838 - val_accuracy1000: 0.3750 - 125s/epoch - 23ms/step
Epoch 10/50
5452/5452 - 134s - loss: 3.1863 - accuracy1000: 0.4257 - val_loss: 3.2860 - val_accuracy1000: 0.3750 - 134s/epoch - 25ms/step
Epoch 11/50
5452/5452 - 133s - loss: 3.1807 - accuracy1000: 0.4277 - val_loss: 3.2887 - val_accuracy1000: 0.3750 - 133s/epoch - 24ms/step
Epoch 12/50
5452/5452 - 129s - loss: 3.1763 - accuracy1000: 0.4290 - val_loss: 3.2868 - val_accuracy1000: 0.3750 - 129s/epoch - 24ms/step
Epoch 13/50
5452/5452 - 134s - loss: 3.1739 - accuracy1000: 0.4302 - val_loss: 3.2876 - val_accuracy1000: 0.3750 - 134s/epoch - 25ms/step
testing model: results/AAPL/W6/deepVOL_L2/h1000
Evaluating performance on  test set...
29350/29350 - 297s - 297s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0894051
{'0': {'precision': 0.28034682080924855, 'recall': 4.345488755487859e-05, 'f1-score': 8.68963058319963e-05, 'support': 2232200}, '1': {'precision': 0.40142960468713773, 'recall': 0.9999472828101511, 'f1-score': 0.5728772124440121, 'support': 3016094}, '2': {'precision': 0.2916666666666667, 'recall': 9.27107292802557e-06, 'f1-score': 1.8541556484203035e-05, 'support': 2265110}, 'accuracy': 0.4014229768557634, 'macro avg': {'precision': 0.3244810307210177, 'recall': 0.333333336256878, 'f1-score': 0.19099421676877612, 'support': 7513404}, 'weighted avg': {'precision': 0.3323655534645796, 'recall': 0.4014229768557634, 'f1-score': 0.2300006084842498, 'support': 7513404}}
[[     97 2232082      21]
 [    129 3015935      30]
 [    120 2264969      21]]
Evaluating performance on  train set...
5452/5452 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1032741
{'0': {'precision': 0.2638888888888889, 'recall': 4.079599426279491e-05, 'f1-score': 8.157937673356175e-05, 'support': 465732}, '1': {'precision': 0.33179708641012706, 'recall': 0.9999438460691169, 'f1-score': 0.4982627575797526, 'support': 463013}, '2': {'precision': 0.2727272727272727, 'recall': 6.42769909797956e-06, 'f1-score': 1.2855095224117872e-05, 'support': 466730}, 'accuracy': 0.33179311703900105, 'macro avg': {'precision': 0.2894710826754296, 'recall': 0.33333035658749255, 'f1-score': 0.16611906401723678, 'support': 1395475}, 'weighted avg': {'precision': 0.28937663832745997, 'recall': 0.33179311703900105, 'f1-score': 0.1653531078379425, 'support': 1395475}}
[[    19 465709      4]
 [    22 462987      4]
 [    31 466696      3]]
Evaluating performance on  val set...
1969/1969 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0944225
{'0': {'precision': 0.25, 'recall': 3.735152767748201e-05, 'f1-score': 7.469189592929167e-05, 'support': 160636}, '1': {'precision': 0.37503546380707686, 'recall': 0.999941811872494, 'f1-score': 0.5454834022770918, 'support': 189042}, '2': {'precision': 0.5, 'recall': 1.2954626420960586e-05, 'f1-score': 2.5908581569930502e-05, 'support': 154385}, 'accuracy': 0.3750305021396135, 'macro avg': {'precision': 0.3750118212690256, 'recall': 0.3333307060088641, 'f1-score': 0.18186133425153037, 'support': 504063}, 'weighted avg': {'precision': 0.37346314676740294, 'recall': 0.3750305021396135, 'f1-score': 0.20460789908607882, 'support': 504063}}
[[     6 160629      1]
 [    10 189031      1]
 [     8 154375      2]]
training model: results/AAPL/W6/deepVOL_L3/h10
Epoch 1/50
5452/5452 - 187s - loss: 3.0669 - accuracy10: 0.4665 - val_loss: 3.2151 - val_accuracy10: 0.4154 - 187s/epoch - 34ms/step
Epoch 2/50
5452/5452 - 183s - loss: 2.9641 - accuracy10: 0.5017 - val_loss: 3.1905 - val_accuracy10: 0.4504 - 183s/epoch - 34ms/step
Epoch 3/50
5452/5452 - 186s - loss: 2.9166 - accuracy10: 0.5160 - val_loss: 3.0662 - val_accuracy10: 0.4725 - 186s/epoch - 34ms/step
Epoch 4/50
5452/5452 - 186s - loss: 2.8809 - accuracy10: 0.5275 - val_loss: 3.0140 - val_accuracy10: 0.4872 - 186s/epoch - 34ms/step
Epoch 5/50
5452/5452 - 184s - loss: 2.8604 - accuracy10: 0.5330 - val_loss: 2.9884 - val_accuracy10: 0.4974 - 184s/epoch - 34ms/step
Epoch 6/50
5452/5452 - 189s - loss: 2.8446 - accuracy10: 0.5371 - val_loss: 2.9740 - val_accuracy10: 0.4995 - 189s/epoch - 35ms/step
Epoch 7/50
5452/5452 - 191s - loss: 2.8329 - accuracy10: 0.5403 - val_loss: 2.9567 - val_accuracy10: 0.5055 - 191s/epoch - 35ms/step
Epoch 8/50
5452/5452 - 184s - loss: 2.8245 - accuracy10: 0.5425 - val_loss: 2.9390 - val_accuracy10: 0.5118 - 184s/epoch - 34ms/step
Epoch 9/50
5452/5452 - 198s - loss: 2.8173 - accuracy10: 0.5440 - val_loss: 2.9297 - val_accuracy10: 0.5146 - 198s/epoch - 36ms/step
Epoch 10/50
5452/5452 - 196s - loss: 2.8106 - accuracy10: 0.5454 - val_loss: 2.9278 - val_accuracy10: 0.5155 - 196s/epoch - 36ms/step
Epoch 11/50
5452/5452 - 203s - loss: 2.8056 - accuracy10: 0.5468 - val_loss: 2.9078 - val_accuracy10: 0.5192 - 203s/epoch - 37ms/step
Epoch 12/50
5452/5452 - 187s - loss: 2.8007 - accuracy10: 0.5479 - val_loss: 2.9126 - val_accuracy10: 0.5196 - 187s/epoch - 34ms/step
Epoch 13/50
5452/5452 - 180s - loss: 2.7974 - accuracy10: 0.5491 - val_loss: 2.9067 - val_accuracy10: 0.5206 - 180s/epoch - 33ms/step
Epoch 14/50
5452/5452 - 183s - loss: 2.7934 - accuracy10: 0.5495 - val_loss: 2.9058 - val_accuracy10: 0.5201 - 183s/epoch - 34ms/step
Epoch 15/50
5452/5452 - 181s - loss: 2.7905 - accuracy10: 0.5500 - val_loss: 2.8932 - val_accuracy10: 0.5230 - 181s/epoch - 33ms/step
Epoch 16/50
5452/5452 - 179s - loss: 2.7871 - accuracy10: 0.5511 - val_loss: 2.9013 - val_accuracy10: 0.5196 - 179s/epoch - 33ms/step
Epoch 17/50
5452/5452 - 181s - loss: 2.7842 - accuracy10: 0.5518 - val_loss: 2.9012 - val_accuracy10: 0.5204 - 181s/epoch - 33ms/step
Epoch 18/50
5452/5452 - 183s - loss: 2.7821 - accuracy10: 0.5525 - val_loss: 2.8902 - val_accuracy10: 0.5225 - 183s/epoch - 34ms/step
Epoch 19/50
5452/5452 - 181s - loss: 2.7791 - accuracy10: 0.5529 - val_loss: 2.9047 - val_accuracy10: 0.5196 - 181s/epoch - 33ms/step
Epoch 20/50
5452/5452 - 180s - loss: 2.7775 - accuracy10: 0.5534 - val_loss: 2.8940 - val_accuracy10: 0.5220 - 180s/epoch - 33ms/step
Epoch 21/50
5452/5452 - 193s - loss: 2.7748 - accuracy10: 0.5539 - val_loss: 2.8884 - val_accuracy10: 0.5231 - 193s/epoch - 35ms/step
Epoch 22/50
5452/5452 - 182s - loss: 2.7733 - accuracy10: 0.5542 - val_loss: 2.8952 - val_accuracy10: 0.5214 - 182s/epoch - 33ms/step
Epoch 23/50
5452/5452 - 182s - loss: 2.7713 - accuracy10: 0.5547 - val_loss: 2.8895 - val_accuracy10: 0.5227 - 182s/epoch - 33ms/step
Epoch 24/50
5452/5452 - 186s - loss: 2.7692 - accuracy10: 0.5552 - val_loss: 2.8843 - val_accuracy10: 0.5238 - 186s/epoch - 34ms/step
Epoch 25/50
5452/5452 - 187s - loss: 2.7672 - accuracy10: 0.5553 - val_loss: 2.8713 - val_accuracy10: 0.5259 - 187s/epoch - 34ms/step
Epoch 26/50
5452/5452 - 182s - loss: 2.7654 - accuracy10: 0.5558 - val_loss: 2.8718 - val_accuracy10: 0.5267 - 182s/epoch - 33ms/step
Epoch 27/50
5452/5452 - 183s - loss: 2.7641 - accuracy10: 0.5564 - val_loss: 2.8802 - val_accuracy10: 0.5246 - 183s/epoch - 34ms/step
Epoch 28/50
5452/5452 - 182s - loss: 2.7623 - accuracy10: 0.5564 - val_loss: 2.8689 - val_accuracy10: 0.5280 - 182s/epoch - 33ms/step
Epoch 29/50
5452/5452 - 184s - loss: 2.7601 - accuracy10: 0.5571 - val_loss: 2.8702 - val_accuracy10: 0.5269 - 184s/epoch - 34ms/step
Epoch 30/50
5452/5452 - 197s - loss: 2.7588 - accuracy10: 0.5574 - val_loss: 2.8686 - val_accuracy10: 0.5279 - 197s/epoch - 36ms/step
Epoch 31/50
5452/5452 - 200s - loss: 2.7578 - accuracy10: 0.5578 - val_loss: 2.8675 - val_accuracy10: 0.5271 - 200s/epoch - 37ms/step
Epoch 32/50
5452/5452 - 182s - loss: 2.7560 - accuracy10: 0.5584 - val_loss: 2.8560 - val_accuracy10: 0.5304 - 182s/epoch - 33ms/step
Epoch 33/50
5452/5452 - 180s - loss: 2.7545 - accuracy10: 0.5585 - val_loss: 2.8617 - val_accuracy10: 0.5307 - 180s/epoch - 33ms/step
Epoch 34/50
5452/5452 - 181s - loss: 2.7536 - accuracy10: 0.5584 - val_loss: 2.8614 - val_accuracy10: 0.5299 - 181s/epoch - 33ms/step
Epoch 35/50
5452/5452 - 186s - loss: 2.7515 - accuracy10: 0.5592 - val_loss: 2.8560 - val_accuracy10: 0.5316 - 186s/epoch - 34ms/step
Epoch 36/50
5452/5452 - 186s - loss: 2.7504 - accuracy10: 0.5595 - val_loss: 2.8575 - val_accuracy10: 0.5316 - 186s/epoch - 34ms/step
Epoch 37/50
5452/5452 - 187s - loss: 2.7487 - accuracy10: 0.5601 - val_loss: 2.8538 - val_accuracy10: 0.5323 - 187s/epoch - 34ms/step
Epoch 38/50
5452/5452 - 183s - loss: 2.7481 - accuracy10: 0.5600 - val_loss: 2.8537 - val_accuracy10: 0.5322 - 183s/epoch - 34ms/step
Epoch 39/50
5452/5452 - 183s - loss: 2.7464 - accuracy10: 0.5603 - val_loss: 2.8574 - val_accuracy10: 0.5313 - 183s/epoch - 33ms/step
Epoch 40/50
5452/5452 - 183s - loss: 2.7449 - accuracy10: 0.5608 - val_loss: 2.8482 - val_accuracy10: 0.5329 - 183s/epoch - 34ms/step
Epoch 41/50
5452/5452 - 186s - loss: 2.7436 - accuracy10: 0.5611 - val_loss: 2.8616 - val_accuracy10: 0.5308 - 186s/epoch - 34ms/step
Epoch 42/50
5452/5452 - 200s - loss: 2.7426 - accuracy10: 0.5610 - val_loss: 2.8505 - val_accuracy10: 0.5335 - 200s/epoch - 37ms/step
Epoch 43/50
5452/5452 - 199s - loss: 2.7417 - accuracy10: 0.5611 - val_loss: 2.8511 - val_accuracy10: 0.5334 - 199s/epoch - 36ms/step
Epoch 44/50
5452/5452 - 182s - loss: 2.7400 - accuracy10: 0.5618 - val_loss: 2.8571 - val_accuracy10: 0.5308 - 182s/epoch - 33ms/step
Epoch 45/50
5452/5452 - 183s - loss: 2.7388 - accuracy10: 0.5618 - val_loss: 2.8548 - val_accuracy10: 0.5325 - 183s/epoch - 34ms/step
Epoch 46/50
5452/5452 - 188s - loss: 2.7380 - accuracy10: 0.5621 - val_loss: 2.8553 - val_accuracy10: 0.5323 - 188s/epoch - 34ms/step
Epoch 47/50
5452/5452 - 199s - loss: 2.7369 - accuracy10: 0.5626 - val_loss: 2.8524 - val_accuracy10: 0.5330 - 199s/epoch - 36ms/step
Epoch 48/50
5452/5452 - 199s - loss: 2.7355 - accuracy10: 0.5627 - val_loss: 2.8542 - val_accuracy10: 0.5322 - 199s/epoch - 36ms/step
Epoch 49/50
5452/5452 - 197s - loss: 2.7343 - accuracy10: 0.5633 - val_loss: 2.8606 - val_accuracy10: 0.5307 - 197s/epoch - 36ms/step
Epoch 50/50
5452/5452 - 199s - loss: 2.7338 - accuracy10: 0.5633 - val_loss: 2.8510 - val_accuracy10: 0.5332 - 199s/epoch - 37ms/step
testing model: results/AAPL/W6/deepVOL_L3/h10
Evaluating performance on  test set...
29350/29350 - 400s - 400s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.998609
{'0': {'precision': 0.5612366764369543, 'recall': 0.34938761791569395, 'f1-score': 0.43066969920152626, 'support': 2469455}, '1': {'precision': 0.44802649812741563, 'recall': 0.6637634661382239, 'f1-score': 0.5349636727747439, 'support': 2535248}, '2': {'precision': 0.5362520951095268, 'recall': 0.474551172100621, 'f1-score': 0.5035184759107688, 'support': 2508701}, 'accuracy': 0.4972591650868235, 'macro avg': {'precision': 0.5151717565579655, 'recall': 0.4959007520515129, 'f1-score': 0.489717282629013, 'support': 7513404}, 'weighted avg': {'precision': 0.5146938947231532, 'recall': 0.4972591650868235, 'f1-score': 0.4901855839979257, 'support': 7513404}}
[[ 862797 1105040  501618]
 [ 324517 1682805  527926]
 [ 350000  968194 1190507]]
Evaluating performance on  train set...
5452/5452 - 77s - 77s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9625479
{'0': {'precision': 0.5688505064389427, 'recall': 0.39719064038981006, 'f1-score': 0.4677690959236201, 'support': 460532}, '1': {'precision': 0.5034430995434329, 'recall': 0.6460257944310441, 'f1-score': 0.5658913086526639, 'support': 475529}, '2': {'precision': 0.5285674236052705, 'recall': 0.5335100802326442, 'f1-score': 0.5310272509435352, 'support': 459414}, 'accuracy': 0.5268636127483474, 'macro avg': {'precision': 0.533620343195882, 'recall': 0.5255755050178328, 'f1-score': 0.5215625518399397, 'support': 1395475}, 'weighted avg': {'precision': 0.5333000802324084, 'recall': 0.5268636127483474, 'f1-score': 0.5220313648479281, 'support': 1395475}}
[[182919 165583 112030]
 [ 61747 307204 106578]
 [ 76893 137419 245102]]
Evaluating performance on  val set...
1969/1969 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94824636
{'0': {'precision': 0.5641696455756154, 'recall': 0.3342285286729731, 'f1-score': 0.4197728712447612, 'support': 149688}, '1': {'precision': 0.5348458876065904, 'recall': 0.7125720048876045, 'f1-score': 0.6110481639407654, 'support': 206236}, '2': {'precision': 0.5110192935420326, 'recall': 0.48507145316223277, 'f1-score': 0.4977074069456565, 'support': 148139}, 'accuracy': 0.533357933432924, 'macro avg': {'precision': 0.5366782755747461, 'recall': 0.5106239955742701, 'f1-score': 0.5095094807103945, 'support': 504063}, 'weighted avg': {'precision': 0.5365515610337966, 'recall': 0.533357933432924, 'f1-score': 0.5209368040242909, 'support': 504063}}
[[ 50030  69931  29727]
 [ 20246 146958  39032]
 [ 18403  57878  71858]]
training model: results/AAPL/W6/deepVOL_L3/h20
Epoch 1/50
5452/5452 - 189s - loss: 3.1313 - accuracy20: 0.4460 - val_loss: 3.4298 - val_accuracy20: 0.3889 - 189s/epoch - 35ms/step
Epoch 2/50
5452/5452 - 183s - loss: 3.0766 - accuracy20: 0.4675 - val_loss: 3.3227 - val_accuracy20: 0.4174 - 183s/epoch - 34ms/step
Epoch 3/50
5452/5452 - 184s - loss: 3.0407 - accuracy20: 0.4801 - val_loss: 3.2493 - val_accuracy20: 0.4305 - 184s/epoch - 34ms/step
Epoch 4/50
5452/5452 - 180s - loss: 3.0171 - accuracy20: 0.4889 - val_loss: 3.1975 - val_accuracy20: 0.4410 - 180s/epoch - 33ms/step
Epoch 5/50
5452/5452 - 185s - loss: 2.9971 - accuracy20: 0.4952 - val_loss: 3.1740 - val_accuracy20: 0.4406 - 185s/epoch - 34ms/step
Epoch 6/50
5452/5452 - 185s - loss: 2.9832 - accuracy20: 0.4998 - val_loss: 3.1577 - val_accuracy20: 0.4488 - 185s/epoch - 34ms/step
Epoch 7/50
5452/5452 - 180s - loss: 2.9719 - accuracy20: 0.5033 - val_loss: 3.1425 - val_accuracy20: 0.4458 - 180s/epoch - 33ms/step
Epoch 8/50
5452/5452 - 180s - loss: 2.9632 - accuracy20: 0.5058 - val_loss: 3.1318 - val_accuracy20: 0.4489 - 180s/epoch - 33ms/step
Epoch 9/50
5452/5452 - 183s - loss: 2.9566 - accuracy20: 0.5076 - val_loss: 3.1192 - val_accuracy20: 0.4530 - 183s/epoch - 34ms/step
Epoch 10/50
5452/5452 - 179s - loss: 2.9512 - accuracy20: 0.5093 - val_loss: 3.1502 - val_accuracy20: 0.4496 - 179s/epoch - 33ms/step
Epoch 11/50
5452/5452 - 180s - loss: 2.9474 - accuracy20: 0.5106 - val_loss: 3.1322 - val_accuracy20: 0.4531 - 180s/epoch - 33ms/step
Epoch 12/50
5452/5452 - 182s - loss: 2.9432 - accuracy20: 0.5115 - val_loss: 3.1098 - val_accuracy20: 0.4554 - 182s/epoch - 33ms/step
Epoch 13/50
5452/5452 - 179s - loss: 2.9400 - accuracy20: 0.5124 - val_loss: 3.1127 - val_accuracy20: 0.4542 - 179s/epoch - 33ms/step
Epoch 14/50
5452/5452 - 184s - loss: 2.9369 - accuracy20: 0.5132 - val_loss: 3.0992 - val_accuracy20: 0.4574 - 184s/epoch - 34ms/step
Epoch 15/50
5452/5452 - 184s - loss: 2.9337 - accuracy20: 0.5142 - val_loss: 3.0941 - val_accuracy20: 0.4603 - 184s/epoch - 34ms/step
Epoch 16/50
5452/5452 - 180s - loss: 2.9311 - accuracy20: 0.5148 - val_loss: 3.0855 - val_accuracy20: 0.4633 - 180s/epoch - 33ms/step
Epoch 17/50
5452/5452 - 181s - loss: 2.9292 - accuracy20: 0.5150 - val_loss: 3.0808 - val_accuracy20: 0.4644 - 181s/epoch - 33ms/step
Epoch 18/50
5452/5452 - 181s - loss: 2.9268 - accuracy20: 0.5157 - val_loss: 3.0857 - val_accuracy20: 0.4627 - 181s/epoch - 33ms/step
Epoch 19/50
5452/5452 - 183s - loss: 2.9246 - accuracy20: 0.5162 - val_loss: 3.0699 - val_accuracy20: 0.4657 - 183s/epoch - 34ms/step
Epoch 20/50
5452/5452 - 185s - loss: 2.9228 - accuracy20: 0.5166 - val_loss: 3.0675 - val_accuracy20: 0.4661 - 185s/epoch - 34ms/step
Epoch 21/50
5452/5452 - 188s - loss: 2.9203 - accuracy20: 0.5173 - val_loss: 3.0600 - val_accuracy20: 0.4676 - 188s/epoch - 35ms/step
Epoch 22/50
5452/5452 - 179s - loss: 2.9190 - accuracy20: 0.5179 - val_loss: 3.0493 - val_accuracy20: 0.4715 - 179s/epoch - 33ms/step
Epoch 23/50
5452/5452 - 187s - loss: 2.9170 - accuracy20: 0.5183 - val_loss: 3.0458 - val_accuracy20: 0.4751 - 187s/epoch - 34ms/step
Epoch 24/50
5452/5452 - 183s - loss: 2.9156 - accuracy20: 0.5185 - val_loss: 3.0441 - val_accuracy20: 0.4723 - 183s/epoch - 33ms/step
Epoch 25/50
5452/5452 - 187s - loss: 2.9137 - accuracy20: 0.5192 - val_loss: 3.0455 - val_accuracy20: 0.4730 - 187s/epoch - 34ms/step
Epoch 26/50
5452/5452 - 180s - loss: 2.9122 - accuracy20: 0.5196 - val_loss: 3.0414 - val_accuracy20: 0.4730 - 180s/epoch - 33ms/step
Epoch 27/50
5452/5452 - 186s - loss: 2.9105 - accuracy20: 0.5203 - val_loss: 3.0272 - val_accuracy20: 0.4792 - 186s/epoch - 34ms/step
Epoch 28/50
5452/5452 - 178s - loss: 2.9097 - accuracy20: 0.5204 - val_loss: 3.0380 - val_accuracy20: 0.4773 - 178s/epoch - 33ms/step
Epoch 29/50
5452/5452 - 188s - loss: 2.9076 - accuracy20: 0.5209 - val_loss: 3.0349 - val_accuracy20: 0.4780 - 188s/epoch - 35ms/step
Epoch 30/50
5452/5452 - 181s - loss: 2.9067 - accuracy20: 0.5213 - val_loss: 3.0240 - val_accuracy20: 0.4819 - 181s/epoch - 33ms/step
Epoch 31/50
5452/5452 - 189s - loss: 2.9056 - accuracy20: 0.5215 - val_loss: 3.0270 - val_accuracy20: 0.4802 - 189s/epoch - 35ms/step
Epoch 32/50
5452/5452 - 183s - loss: 2.9039 - accuracy20: 0.5219 - val_loss: 3.0266 - val_accuracy20: 0.4822 - 183s/epoch - 34ms/step
Epoch 33/50
5452/5452 - 187s - loss: 2.9022 - accuracy20: 0.5225 - val_loss: 3.0258 - val_accuracy20: 0.4819 - 187s/epoch - 34ms/step
Epoch 34/50
5452/5452 - 183s - loss: 2.9013 - accuracy20: 0.5227 - val_loss: 3.0159 - val_accuracy20: 0.4841 - 183s/epoch - 34ms/step
Epoch 35/50
5452/5452 - 188s - loss: 2.9002 - accuracy20: 0.5233 - val_loss: 3.0158 - val_accuracy20: 0.4859 - 188s/epoch - 35ms/step
Epoch 36/50
5452/5452 - 180s - loss: 2.8992 - accuracy20: 0.5235 - val_loss: 3.0147 - val_accuracy20: 0.4861 - 180s/epoch - 33ms/step
Epoch 37/50
5452/5452 - 185s - loss: 2.8981 - accuracy20: 0.5236 - val_loss: 3.0129 - val_accuracy20: 0.4857 - 185s/epoch - 34ms/step
Epoch 38/50
5452/5452 - 179s - loss: 2.8965 - accuracy20: 0.5243 - val_loss: 3.0142 - val_accuracy20: 0.4860 - 179s/epoch - 33ms/step
Epoch 39/50
5452/5452 - 189s - loss: 2.8954 - accuracy20: 0.5245 - val_loss: 3.0142 - val_accuracy20: 0.4868 - 189s/epoch - 35ms/step
Epoch 40/50
5452/5452 - 181s - loss: 2.8945 - accuracy20: 0.5248 - val_loss: 3.0093 - val_accuracy20: 0.4884 - 181s/epoch - 33ms/step
Epoch 41/50
5452/5452 - 187s - loss: 2.8935 - accuracy20: 0.5248 - val_loss: 3.0153 - val_accuracy20: 0.4860 - 187s/epoch - 34ms/step
Epoch 42/50
5452/5452 - 181s - loss: 2.8924 - accuracy20: 0.5254 - val_loss: 3.0126 - val_accuracy20: 0.4875 - 181s/epoch - 33ms/step
Epoch 43/50
5452/5452 - 188s - loss: 2.8915 - accuracy20: 0.5254 - val_loss: 3.0113 - val_accuracy20: 0.4885 - 188s/epoch - 34ms/step
Epoch 44/50
5452/5452 - 183s - loss: 2.8901 - accuracy20: 0.5259 - val_loss: 3.0161 - val_accuracy20: 0.4869 - 183s/epoch - 34ms/step
Epoch 45/50
5452/5452 - 190s - loss: 2.8890 - accuracy20: 0.5262 - val_loss: 3.0115 - val_accuracy20: 0.4885 - 190s/epoch - 35ms/step
Epoch 46/50
5452/5452 - 179s - loss: 2.8875 - accuracy20: 0.5264 - val_loss: 3.0099 - val_accuracy20: 0.4885 - 179s/epoch - 33ms/step
Epoch 47/50
5452/5452 - 186s - loss: 2.8864 - accuracy20: 0.5270 - val_loss: 3.0127 - val_accuracy20: 0.4868 - 186s/epoch - 34ms/step
Epoch 48/50
5452/5452 - 181s - loss: 2.8860 - accuracy20: 0.5270 - val_loss: 3.0201 - val_accuracy20: 0.4860 - 181s/epoch - 33ms/step
Epoch 49/50
5452/5452 - 186s - loss: 2.8845 - accuracy20: 0.5272 - val_loss: 3.0079 - val_accuracy20: 0.4895 - 186s/epoch - 34ms/step
Epoch 50/50
5452/5452 - 180s - loss: 2.8836 - accuracy20: 0.5276 - val_loss: 3.0199 - val_accuracy20: 0.4870 - 180s/epoch - 33ms/step
testing model: results/AAPL/W6/deepVOL_L3/h20
Evaluating performance on  test set...
29350/29350 - 401s - 401s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0355711
{'0': {'precision': 0.4985297264062991, 'recall': 0.27794297437416804, 'f1-score': 0.3569033008682246, 'support': 2322149}, '1': {'precision': 0.43955349311829, 'recall': 0.6722655417814588, 'f1-score': 0.5315553303505809, 'support': 2896177}, '2': {'precision': 0.4661171260392611, 'recall': 0.3633867781400022, 'f1-score': 0.4083906050686404, 'support': 2295078}, 'accuracy': 0.4560417621626629, 'macro avg': {'precision': 0.46806678185461675, 'recall': 0.437865098098543, 'f1-score': 0.4322830787624819, 'support': 7513404}, 'weighted avg': {'precision': 0.46589537632735395, 'recall': 0.4560417621626629, 'f1-score': 0.4399536160036551, 'support': 7513404}}
[[ 645425 1295842  380882]
 [ 374808 1947000  574369]
 [ 274424 1186653  834001]]
Evaluating performance on  train set...
5452/5452 - 91s - 91s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0116141
{'0': {'precision': 0.5307617582773415, 'recall': 0.39495458437495967, 'f1-score': 0.4528963786940207, 'support': 464818}, '1': {'precision': 0.4479838779565089, 'recall': 0.6095036583039104, 'f1-score': 0.5164085686366393, 'support': 466473}, '2': {'precision': 0.5144553806406833, 'recall': 0.4598693621494924, 'f1-score': 0.4856332952647887, 'support': 464184}, 'accuracy': 0.48826600261559683, 'macro avg': {'precision': 0.4977336722915113, 'recall': 0.48810920160945415, 'f1-score': 0.48497941419848295, 'support': 1395475}, 'weighted avg': {'precision': 0.4976670731244049, 'recall': 0.48826600261559683, 'f1-score': 0.4850163913496315, 'support': 1395475}}
[[183582 185997  95239]
 [ 75927 284317 106229]
 [ 86375 164345 213464]]
Evaluating performance on  val set...
1969/1969 - 33s - 33s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0024172
{'0': {'precision': 0.5330147512718448, 'recall': 0.3222176469831302, 'f1-score': 0.40163763513296763, 'support': 155426}, '1': {'precision': 0.4743740902474527, 'recall': 0.6698938821655233, 'f1-score': 0.5554298618434367, 'support': 194595}, '2': {'precision': 0.4913196112486604, 'recall': 0.43155762714064994, 'f1-score': 0.45950364095705154, 'support': 154042}, 'accuracy': 0.48985345085832527, 'macro avg': {'precision': 0.49956948425598596, 'recall': 0.47455638542976786, 'f1-score': 0.472190379311152, 'support': 504063}, 'weighted avg': {'precision': 0.4976342885291064, 'recall': 0.48985345085832527, 'f1-score': 0.47869346669742935, 'support': 504063}}
[[ 50081  77260  28085]
 [ 23495 130358  40742]
 [ 20382  67182  66478]]
training model: results/AAPL/W6/deepVOL_L3/h30
Epoch 1/50
5452/5452 - 188s - loss: 3.1618 - accuracy30: 0.4359 - val_loss: 3.2811 - val_accuracy30: 0.3733 - 188s/epoch - 34ms/step
Epoch 2/50
5452/5452 - 197s - loss: 3.1193 - accuracy30: 0.4532 - val_loss: 3.2529 - val_accuracy30: 0.3819 - 197s/epoch - 36ms/step
Epoch 3/50
5452/5452 - 197s - loss: 3.0937 - accuracy30: 0.4632 - val_loss: 3.2100 - val_accuracy30: 0.4035 - 197s/epoch - 36ms/step
Epoch 4/50
5452/5452 - 183s - loss: 3.0738 - accuracy30: 0.4705 - val_loss: 3.1687 - val_accuracy30: 0.4182 - 183s/epoch - 34ms/step
Epoch 5/50
5452/5452 - 181s - loss: 3.0598 - accuracy30: 0.4758 - val_loss: 3.1647 - val_accuracy30: 0.4228 - 181s/epoch - 33ms/step
Epoch 6/50
5452/5452 - 197s - loss: 3.0493 - accuracy30: 0.4796 - val_loss: 3.1446 - val_accuracy30: 0.4281 - 197s/epoch - 36ms/step
Epoch 7/50
5452/5452 - 181s - loss: 3.0425 - accuracy30: 0.4822 - val_loss: 3.1531 - val_accuracy30: 0.4298 - 181s/epoch - 33ms/step
Epoch 8/50
5452/5452 - 180s - loss: 3.0367 - accuracy30: 0.4842 - val_loss: 3.1331 - val_accuracy30: 0.4382 - 180s/epoch - 33ms/step
Epoch 9/50
5452/5452 - 179s - loss: 3.0326 - accuracy30: 0.4858 - val_loss: 3.1331 - val_accuracy30: 0.4408 - 179s/epoch - 33ms/step
Epoch 10/50
5452/5452 - 181s - loss: 3.0288 - accuracy30: 0.4870 - val_loss: 3.1299 - val_accuracy30: 0.4427 - 181s/epoch - 33ms/step
Epoch 11/50
5452/5452 - 178s - loss: 3.0254 - accuracy30: 0.4877 - val_loss: 3.1240 - val_accuracy30: 0.4442 - 178s/epoch - 33ms/step
Epoch 12/50
5452/5452 - 179s - loss: 3.0226 - accuracy30: 0.4887 - val_loss: 3.1229 - val_accuracy30: 0.4461 - 179s/epoch - 33ms/step
Epoch 13/50
5452/5452 - 178s - loss: 3.0204 - accuracy30: 0.4895 - val_loss: 3.1184 - val_accuracy30: 0.4479 - 178s/epoch - 33ms/step
Epoch 14/50
5452/5452 - 179s - loss: 3.0180 - accuracy30: 0.4903 - val_loss: 3.1139 - val_accuracy30: 0.4487 - 179s/epoch - 33ms/step
Epoch 15/50
5452/5452 - 178s - loss: 3.0159 - accuracy30: 0.4911 - val_loss: 3.1066 - val_accuracy30: 0.4506 - 178s/epoch - 33ms/step
Epoch 16/50
5452/5452 - 179s - loss: 3.0138 - accuracy30: 0.4915 - val_loss: 3.1056 - val_accuracy30: 0.4510 - 179s/epoch - 33ms/step
Epoch 17/50
5452/5452 - 180s - loss: 3.0119 - accuracy30: 0.4923 - val_loss: 3.1023 - val_accuracy30: 0.4518 - 180s/epoch - 33ms/step
Epoch 18/50
5452/5452 - 181s - loss: 3.0099 - accuracy30: 0.4928 - val_loss: 3.1048 - val_accuracy30: 0.4531 - 181s/epoch - 33ms/step
Epoch 19/50
5452/5452 - 179s - loss: 3.0082 - accuracy30: 0.4933 - val_loss: 3.0990 - val_accuracy30: 0.4531 - 179s/epoch - 33ms/step
Epoch 20/50
5452/5452 - 179s - loss: 3.0064 - accuracy30: 0.4936 - val_loss: 3.0993 - val_accuracy30: 0.4527 - 179s/epoch - 33ms/step
Epoch 21/50
5452/5452 - 186s - loss: 3.0049 - accuracy30: 0.4940 - val_loss: 3.1002 - val_accuracy30: 0.4519 - 186s/epoch - 34ms/step
Epoch 22/50
5452/5452 - 184s - loss: 3.0034 - accuracy30: 0.4944 - val_loss: 3.1016 - val_accuracy30: 0.4512 - 184s/epoch - 34ms/step
Epoch 23/50
5452/5452 - 179s - loss: 3.0017 - accuracy30: 0.4951 - val_loss: 3.0958 - val_accuracy30: 0.4550 - 179s/epoch - 33ms/step
Epoch 24/50
5452/5452 - 179s - loss: 3.0001 - accuracy30: 0.4952 - val_loss: 3.0933 - val_accuracy30: 0.4553 - 179s/epoch - 33ms/step
Epoch 25/50
5452/5452 - 178s - loss: 2.9987 - accuracy30: 0.4959 - val_loss: 3.0972 - val_accuracy30: 0.4537 - 178s/epoch - 33ms/step
Epoch 26/50
5452/5452 - 180s - loss: 2.9968 - accuracy30: 0.4965 - val_loss: 3.0918 - val_accuracy30: 0.4567 - 180s/epoch - 33ms/step
Epoch 27/50
5452/5452 - 178s - loss: 2.9955 - accuracy30: 0.4969 - val_loss: 3.0926 - val_accuracy30: 0.4542 - 178s/epoch - 33ms/step
Epoch 28/50
5452/5452 - 180s - loss: 2.9944 - accuracy30: 0.4974 - val_loss: 3.0942 - val_accuracy30: 0.4547 - 180s/epoch - 33ms/step
Epoch 29/50
5452/5452 - 179s - loss: 2.9926 - accuracy30: 0.4975 - val_loss: 3.0909 - val_accuracy30: 0.4570 - 179s/epoch - 33ms/step
Epoch 30/50
5452/5452 - 180s - loss: 2.9915 - accuracy30: 0.4981 - val_loss: 3.0916 - val_accuracy30: 0.4564 - 180s/epoch - 33ms/step
Epoch 31/50
5452/5452 - 179s - loss: 2.9902 - accuracy30: 0.4986 - val_loss: 3.0916 - val_accuracy30: 0.4565 - 179s/epoch - 33ms/step
Epoch 32/50
5452/5452 - 179s - loss: 2.9890 - accuracy30: 0.4989 - val_loss: 3.0856 - val_accuracy30: 0.4606 - 179s/epoch - 33ms/step
Epoch 33/50
5452/5452 - 179s - loss: 2.9880 - accuracy30: 0.4989 - val_loss: 3.0887 - val_accuracy30: 0.4588 - 179s/epoch - 33ms/step
Epoch 34/50
5452/5452 - 180s - loss: 2.9863 - accuracy30: 0.4999 - val_loss: 3.0907 - val_accuracy30: 0.4574 - 180s/epoch - 33ms/step
Epoch 35/50
5452/5452 - 180s - loss: 2.9853 - accuracy30: 0.5001 - val_loss: 3.0863 - val_accuracy30: 0.4599 - 180s/epoch - 33ms/step
Epoch 36/50
5452/5452 - 182s - loss: 2.9840 - accuracy30: 0.5003 - val_loss: 3.0807 - val_accuracy30: 0.4618 - 182s/epoch - 33ms/step
Epoch 37/50
5452/5452 - 179s - loss: 2.9834 - accuracy30: 0.5008 - val_loss: 3.0823 - val_accuracy30: 0.4610 - 179s/epoch - 33ms/step
Epoch 38/50
5452/5452 - 179s - loss: 2.9815 - accuracy30: 0.5013 - val_loss: 3.0861 - val_accuracy30: 0.4604 - 179s/epoch - 33ms/step
Epoch 39/50
5452/5452 - 178s - loss: 2.9805 - accuracy30: 0.5015 - val_loss: 3.0856 - val_accuracy30: 0.4605 - 178s/epoch - 33ms/step
Epoch 40/50
5452/5452 - 178s - loss: 2.9794 - accuracy30: 0.5016 - val_loss: 3.0826 - val_accuracy30: 0.4621 - 178s/epoch - 33ms/step
Epoch 41/50
5452/5452 - 179s - loss: 2.9777 - accuracy30: 0.5025 - val_loss: 3.0804 - val_accuracy30: 0.4635 - 179s/epoch - 33ms/step
Epoch 42/50
5452/5452 - 178s - loss: 2.9770 - accuracy30: 0.5028 - val_loss: 3.0813 - val_accuracy30: 0.4631 - 178s/epoch - 33ms/step
Epoch 43/50
5452/5452 - 180s - loss: 2.9758 - accuracy30: 0.5032 - val_loss: 3.0845 - val_accuracy30: 0.4621 - 180s/epoch - 33ms/step
Epoch 44/50
5452/5452 - 180s - loss: 2.9743 - accuracy30: 0.5035 - val_loss: 3.0813 - val_accuracy30: 0.4636 - 180s/epoch - 33ms/step
Epoch 45/50
5452/5452 - 179s - loss: 2.9733 - accuracy30: 0.5039 - val_loss: 3.0790 - val_accuracy30: 0.4643 - 179s/epoch - 33ms/step
Epoch 46/50
5452/5452 - 179s - loss: 2.9719 - accuracy30: 0.5041 - val_loss: 3.0761 - val_accuracy30: 0.4660 - 179s/epoch - 33ms/step
Epoch 47/50
5452/5452 - 180s - loss: 2.9709 - accuracy30: 0.5044 - val_loss: 3.0831 - val_accuracy30: 0.4635 - 180s/epoch - 33ms/step
Epoch 48/50
5452/5452 - 185s - loss: 2.9697 - accuracy30: 0.5052 - val_loss: 3.0805 - val_accuracy30: 0.4644 - 185s/epoch - 34ms/step
Epoch 49/50
5452/5452 - 182s - loss: 2.9685 - accuracy30: 0.5056 - val_loss: 3.0797 - val_accuracy30: 0.4648 - 182s/epoch - 33ms/step
Epoch 50/50
5452/5452 - 187s - loss: 2.9678 - accuracy30: 0.5058 - val_loss: 3.0793 - val_accuracy30: 0.4655 - 187s/epoch - 34ms/step
testing model: results/AAPL/W6/deepVOL_L3/h30
Evaluating performance on  test set...
29350/29350 - 391s - 391s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0380569
{'0': {'precision': 0.4510601504549003, 'recall': 0.29106048360318393, 'f1-score': 0.35381251915238543, 'support': 2213509}, '1': {'precision': 0.45911449843358876, 'recall': 0.6322292910586159, 'f1-score': 0.5319416972986278, 'support': 3113981}, '2': {'precision': 0.4236831516987651, 'recall': 0.34828726107248503, 'f1-score': 0.3823033681770055, 'support': 2185914}, 'accuracy': 0.449109484861988, 'macro avg': {'precision': 0.44461926686241804, 'recall': 0.4238590119114283, 'f1-score': 0.4226858615426729, 'support': 7513404}, 'weighted avg': {'precision': 0.4464333956196759, 'recall': 0.449109484861988, 'f1-score': 0.4359283513434692, 'support': 7513404}}
[[ 644265 1202377  366867]
 [ 476501 1968750  668730]
 [ 307569 1117019  761326]]
Evaluating performance on  train set...
5452/5452 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0296569
{'0': {'precision': 0.49812365471319775, 'recall': 0.4338585656476262, 'f1-score': 0.4637754017782673, 'support': 467793}, '1': {'precision': 0.429489650505047, 'recall': 0.5344724669579619, 'f1-score': 0.47626434458334227, 'support': 460701}, '2': {'precision': 0.4935969000846352, 'recall': 0.4383583057983087, 'f1-score': 0.46434055950876824, 'support': 466981}, 'accuracy': 0.468580949139182, 'macro avg': {'precision': 0.47373673510096, 'recall': 0.46889644613463227, 'f1-score': 0.4681267686234593, 'support': 1395475}, 'weighted avg': {'precision': 0.4739500487540082, 'recall': 0.468580949139182, 'f1-score': 0.4680876154412766, 'support': 1395475}}
[[202956 167778  97059]
 [101512 246232 112957]
 [102973 159303 204705]]
Evaluating performance on  val set...
1969/1969 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0254508
{'0': {'precision': 0.4957724447371671, 'recall': 0.37626762807495484, 'f1-score': 0.42783153587109424, 'support': 160043}, '1': {'precision': 0.44722208592970575, 'recall': 0.5869587382678552, 'f1-score': 0.5076499295691301, 'support': 186347}, '2': {'precision': 0.47317172126990564, 'recall': 0.4142116912851281, 'f1-score': 0.4417329784679691, 'support': 157673}, 'accuracy': 0.4660270640773078, 'macro avg': {'precision': 0.4720554173122595, 'recall': 0.4591460192093127, 'f1-score': 0.4590714813027312, 'support': 504063}, 'weighted avg': {'precision': 0.47075426727929476, 'recall': 0.4660270640773078, 'f1-score': 0.4616880188286312, 'support': 504063}}
[[ 60219  69441  30383]
 [ 34636 109378  42333]
 [ 26610  65753  65310]]
training model: results/AAPL/W6/deepVOL_L3/h50
Epoch 1/50
5452/5452 - 187s - loss: 3.1396 - accuracy50: 0.4432 - val_loss: 3.2823 - val_accuracy50: 0.3584 - 187s/epoch - 34ms/step
Epoch 2/50
5452/5452 - 196s - loss: 3.1269 - accuracy50: 0.4508 - val_loss: 3.2636 - val_accuracy50: 0.3612 - 196s/epoch - 36ms/step
Epoch 3/50
5452/5452 - 186s - loss: 3.1196 - accuracy50: 0.4527 - val_loss: 3.2757 - val_accuracy50: 0.3583 - 186s/epoch - 34ms/step
Epoch 4/50
5452/5452 - 186s - loss: 3.1189 - accuracy50: 0.4534 - val_loss: 3.2668 - val_accuracy50: 0.3732 - 186s/epoch - 34ms/step
Epoch 5/50
5452/5452 - 188s - loss: 3.1073 - accuracy50: 0.4590 - val_loss: 3.2638 - val_accuracy50: 0.3763 - 188s/epoch - 34ms/step
Epoch 6/50
5452/5452 - 181s - loss: 3.0987 - accuracy50: 0.4636 - val_loss: 3.2658 - val_accuracy50: 0.3806 - 181s/epoch - 33ms/step
Epoch 7/50
5452/5452 - 197s - loss: 3.0917 - accuracy50: 0.4661 - val_loss: 3.2523 - val_accuracy50: 0.3810 - 197s/epoch - 36ms/step
Epoch 8/50
5452/5452 - 197s - loss: 3.0846 - accuracy50: 0.4699 - val_loss: 3.2158 - val_accuracy50: 0.4066 - 197s/epoch - 36ms/step
Epoch 9/50
5452/5452 - 185s - loss: 3.0856 - accuracy50: 0.4687 - val_loss: 3.2391 - val_accuracy50: 0.3963 - 185s/epoch - 34ms/step
Epoch 10/50
5452/5452 - 183s - loss: 3.0806 - accuracy50: 0.4707 - val_loss: 3.2267 - val_accuracy50: 0.3937 - 183s/epoch - 34ms/step
Epoch 11/50
5452/5452 - 185s - loss: 3.0741 - accuracy50: 0.4731 - val_loss: 3.2201 - val_accuracy50: 0.4000 - 185s/epoch - 34ms/step
Epoch 12/50
5452/5452 - 184s - loss: 3.0683 - accuracy50: 0.4755 - val_loss: 3.2148 - val_accuracy50: 0.4038 - 184s/epoch - 34ms/step
Epoch 13/50
5452/5452 - 182s - loss: 3.0633 - accuracy50: 0.4775 - val_loss: 3.2117 - val_accuracy50: 0.4080 - 182s/epoch - 33ms/step
Epoch 14/50
5452/5452 - 184s - loss: 3.0583 - accuracy50: 0.4796 - val_loss: 3.2069 - val_accuracy50: 0.4132 - 184s/epoch - 34ms/step
Epoch 15/50
5452/5452 - 181s - loss: 3.0550 - accuracy50: 0.4807 - val_loss: 3.2023 - val_accuracy50: 0.4152 - 181s/epoch - 33ms/step
Epoch 16/50
5452/5452 - 183s - loss: 3.0510 - accuracy50: 0.4821 - val_loss: 3.2001 - val_accuracy50: 0.4152 - 183s/epoch - 34ms/step
Epoch 17/50
5452/5452 - 181s - loss: 3.0478 - accuracy50: 0.4831 - val_loss: 3.1982 - val_accuracy50: 0.4161 - 181s/epoch - 33ms/step
Epoch 18/50
5452/5452 - 180s - loss: 3.0446 - accuracy50: 0.4847 - val_loss: 3.1948 - val_accuracy50: 0.4164 - 180s/epoch - 33ms/step
Epoch 19/50
5452/5452 - 179s - loss: 3.0419 - accuracy50: 0.4855 - val_loss: 3.1908 - val_accuracy50: 0.4172 - 179s/epoch - 33ms/step
Epoch 20/50
5452/5452 - 178s - loss: 3.0394 - accuracy50: 0.4867 - val_loss: 3.1913 - val_accuracy50: 0.4160 - 178s/epoch - 33ms/step
Epoch 21/50
5452/5452 - 179s - loss: 3.0374 - accuracy50: 0.4872 - val_loss: 3.1907 - val_accuracy50: 0.4152 - 179s/epoch - 33ms/step
Epoch 22/50
5452/5452 - 178s - loss: 3.0353 - accuracy50: 0.4879 - val_loss: 3.1890 - val_accuracy50: 0.4159 - 178s/epoch - 33ms/step
Epoch 23/50
5452/5452 - 179s - loss: 3.0337 - accuracy50: 0.4888 - val_loss: 3.1882 - val_accuracy50: 0.4156 - 179s/epoch - 33ms/step
Epoch 24/50
5452/5452 - 198s - loss: 3.0320 - accuracy50: 0.4896 - val_loss: 3.1829 - val_accuracy50: 0.4183 - 198s/epoch - 36ms/step
Epoch 25/50
5452/5452 - 198s - loss: 3.0306 - accuracy50: 0.4897 - val_loss: 3.1832 - val_accuracy50: 0.4196 - 198s/epoch - 36ms/step
Epoch 26/50
5452/5452 - 196s - loss: 3.0294 - accuracy50: 0.4904 - val_loss: 3.1800 - val_accuracy50: 0.4199 - 196s/epoch - 36ms/step
Epoch 27/50
5452/5452 - 197s - loss: 3.0280 - accuracy50: 0.4905 - val_loss: 3.1824 - val_accuracy50: 0.4184 - 197s/epoch - 36ms/step
Epoch 28/50
5452/5452 - 185s - loss: 3.0266 - accuracy50: 0.4909 - val_loss: 3.1793 - val_accuracy50: 0.4208 - 185s/epoch - 34ms/step
Epoch 29/50
5452/5452 - 180s - loss: 3.0254 - accuracy50: 0.4912 - val_loss: 3.1768 - val_accuracy50: 0.4220 - 180s/epoch - 33ms/step
Epoch 30/50
5452/5452 - 180s - loss: 3.0245 - accuracy50: 0.4913 - val_loss: 3.1742 - val_accuracy50: 0.4238 - 180s/epoch - 33ms/step
Epoch 31/50
5452/5452 - 180s - loss: 3.0235 - accuracy50: 0.4922 - val_loss: 3.1763 - val_accuracy50: 0.4232 - 180s/epoch - 33ms/step
Epoch 32/50
5452/5452 - 179s - loss: 3.0223 - accuracy50: 0.4924 - val_loss: 3.1753 - val_accuracy50: 0.4233 - 179s/epoch - 33ms/step
Epoch 33/50
5452/5452 - 178s - loss: 3.0213 - accuracy50: 0.4928 - val_loss: 3.1751 - val_accuracy50: 0.4238 - 178s/epoch - 33ms/step
Epoch 34/50
5452/5452 - 196s - loss: 3.0201 - accuracy50: 0.4932 - val_loss: 3.1712 - val_accuracy50: 0.4260 - 196s/epoch - 36ms/step
Epoch 35/50
5452/5452 - 199s - loss: 3.0189 - accuracy50: 0.4936 - val_loss: 3.1716 - val_accuracy50: 0.4253 - 199s/epoch - 37ms/step
Epoch 36/50
5452/5452 - 184s - loss: 3.0178 - accuracy50: 0.4940 - val_loss: 3.1668 - val_accuracy50: 0.4292 - 184s/epoch - 34ms/step
Epoch 37/50
5452/5452 - 183s - loss: 3.0170 - accuracy50: 0.4943 - val_loss: 3.1723 - val_accuracy50: 0.4251 - 183s/epoch - 34ms/step
Epoch 38/50
5452/5452 - 179s - loss: 3.0160 - accuracy50: 0.4945 - val_loss: 3.1739 - val_accuracy50: 0.4236 - 179s/epoch - 33ms/step
Epoch 39/50
5452/5452 - 178s - loss: 3.0150 - accuracy50: 0.4948 - val_loss: 3.1744 - val_accuracy50: 0.4230 - 178s/epoch - 33ms/step
Epoch 40/50
5452/5452 - 181s - loss: 3.0138 - accuracy50: 0.4951 - val_loss: 3.1739 - val_accuracy50: 0.4248 - 181s/epoch - 33ms/step
Epoch 41/50
5452/5452 - 179s - loss: 3.0129 - accuracy50: 0.4955 - val_loss: 3.1738 - val_accuracy50: 0.4246 - 179s/epoch - 33ms/step
Epoch 42/50
5452/5452 - 179s - loss: 3.0121 - accuracy50: 0.4961 - val_loss: 3.1737 - val_accuracy50: 0.4247 - 179s/epoch - 33ms/step
Epoch 43/50
5452/5452 - 182s - loss: 3.0109 - accuracy50: 0.4960 - val_loss: 3.1696 - val_accuracy50: 0.4280 - 182s/epoch - 33ms/step
Epoch 44/50
5452/5452 - 186s - loss: 3.0097 - accuracy50: 0.4965 - val_loss: 3.1734 - val_accuracy50: 0.4258 - 186s/epoch - 34ms/step
Epoch 45/50
5452/5452 - 186s - loss: 3.0087 - accuracy50: 0.4969 - val_loss: 3.1725 - val_accuracy50: 0.4264 - 186s/epoch - 34ms/step
Epoch 46/50
5452/5452 - 185s - loss: 3.0077 - accuracy50: 0.4973 - val_loss: 3.1751 - val_accuracy50: 0.4241 - 185s/epoch - 34ms/step
testing model: results/AAPL/W6/deepVOL_L3/h50
Evaluating performance on  test set...
29350/29350 - 400s - 400s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0744226
{'0': {'precision': 0.37740297522224936, 'recall': 0.4759484300281604, 'f1-score': 0.42098566297497764, 'support': 2212683}, '1': {'precision': 0.4956672768741372, 'recall': 0.21229424570818037, 'f1-score': 0.2972684455573291, 'support': 3112025}, '2': {'precision': 0.35921927437046414, 'recall': 0.5563956803503091, 'f1-score': 0.4365766450794825, 'support': 2188696}, 'accuracy': 0.390178539580728, 'macro avg': {'precision': 0.41076317548895025, 'recall': 0.41487945202888327, 'f1-score': 0.3849435845372631, 'support': 7513404}, 'weighted avg': {'precision': 0.4210906126804131, 'recall': 0.390178539580728, 'f1-score': 0.3742841740937786, 'support': 7513404}}
[[1053123  353703  805857]
 [1084921  660665 1366439]
 [ 652403  318512 1217781]]
Evaluating performance on  train set...
5452/5452 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.048938
{'0': {'precision': 0.43412299793965464, 'recall': 0.5739134700703024, 'f1-score': 0.49432544177044385, 'support': 468832}, '1': {'precision': 0.5412574306295738, 'recall': 0.16447372711325392, 'f1-score': 0.252284814030642, 'support': 460037}, '2': {'precision': 0.4229362948844363, 'recall': 0.5763706424692353, 'f1-score': 0.48787425543474816, 'support': 466606}, 'accuracy': 0.4397577885666171, 'macro avg': {'precision': 0.466105574484555, 'recall': 0.4382526132175972, 'f1-score': 0.41149483707861134, 'support': 1395475}, 'weighted avg': {'precision': 0.46570079062357167, 'recall': 0.4397577885666171, 'f1-score': 0.41237642332519125, 'support': 1395475}}
[[269069  33927 165836]
 [183264  75664 201109]
 [167466  30202 268938]]
Evaluating performance on  val set...
1969/1969 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0547014
{'0': {'precision': 0.4300772176832787, 'recall': 0.5497649691198079, 'f1-score': 0.4826111622530025, 'support': 164021}, '1': {'precision': 0.5473710056473394, 'recall': 0.17308310873013233, 'f1-score': 0.2630026628914282, 'support': 180318}, '2': {'precision': 0.4006689752209556, 'recall': 0.5954646765670782, 'f1-score': 0.47902050354820674, 'support': 159724}, 'accuracy': 0.42949591618508004, 'macro avg': {'precision': 0.4593723995171912, 'recall': 0.4394375848056728, 'f1-score': 0.4082114428975458, 'support': 504063}, 'weighted avg': {'precision': 0.46271793747237533, 'recall': 0.42949591618508004, 'f1-score': 0.4029130297599507, 'support': 504063}}
[[90173 13387 60461]
 [67301 31210 81807]
 [52193 12421 95110]]
training model: results/AAPL/W6/deepVOL_L3/h100
Epoch 1/50
5452/5452 - 189s - loss: 3.2266 - accuracy100: 0.4059 - val_loss: 3.3039 - val_accuracy100: 0.3732 - 189s/epoch - 35ms/step
Epoch 2/50
5452/5452 - 180s - loss: 3.2196 - accuracy100: 0.4119 - val_loss: 3.3121 - val_accuracy100: 0.3730 - 180s/epoch - 33ms/step
Epoch 3/50
5452/5452 - 180s - loss: 3.2128 - accuracy100: 0.4153 - val_loss: 3.2907 - val_accuracy100: 0.3729 - 180s/epoch - 33ms/step
Epoch 4/50
5452/5452 - 183s - loss: 3.2041 - accuracy100: 0.4205 - val_loss: 3.2943 - val_accuracy100: 0.3736 - 183s/epoch - 34ms/step
Epoch 5/50
5452/5452 - 187s - loss: 3.1994 - accuracy100: 0.4235 - val_loss: 3.2920 - val_accuracy100: 0.3738 - 187s/epoch - 34ms/step
Epoch 6/50
5452/5452 - 181s - loss: 3.1938 - accuracy100: 0.4253 - val_loss: 3.2879 - val_accuracy100: 0.3749 - 181s/epoch - 33ms/step
Epoch 7/50
5452/5452 - 182s - loss: 3.1879 - accuracy100: 0.4295 - val_loss: 3.2785 - val_accuracy100: 0.3755 - 182s/epoch - 33ms/step
Epoch 8/50
5452/5452 - 185s - loss: 3.1840 - accuracy100: 0.4313 - val_loss: 3.2684 - val_accuracy100: 0.3784 - 185s/epoch - 34ms/step
Epoch 9/50
5452/5452 - 181s - loss: 3.1787 - accuracy100: 0.4337 - val_loss: 3.2644 - val_accuracy100: 0.3792 - 181s/epoch - 33ms/step
Epoch 10/50
5452/5452 - 189s - loss: 3.1741 - accuracy100: 0.4357 - val_loss: 3.2572 - val_accuracy100: 0.3828 - 189s/epoch - 35ms/step
Epoch 11/50
5452/5452 - 186s - loss: 3.1707 - accuracy100: 0.4374 - val_loss: 3.2531 - val_accuracy100: 0.3827 - 186s/epoch - 34ms/step
Epoch 12/50
5452/5452 - 198s - loss: 3.1674 - accuracy100: 0.4382 - val_loss: 3.2459 - val_accuracy100: 0.3836 - 198s/epoch - 36ms/step
Epoch 13/50
5452/5452 - 186s - loss: 3.1647 - accuracy100: 0.4393 - val_loss: 3.2397 - val_accuracy100: 0.3863 - 186s/epoch - 34ms/step
Epoch 14/50
5452/5452 - 188s - loss: 3.1627 - accuracy100: 0.4398 - val_loss: 3.2402 - val_accuracy100: 0.3855 - 188s/epoch - 34ms/step
Epoch 15/50
5452/5452 - 187s - loss: 3.1606 - accuracy100: 0.4407 - val_loss: 3.2389 - val_accuracy100: 0.3862 - 187s/epoch - 34ms/step
Epoch 16/50
5452/5452 - 188s - loss: 3.1590 - accuracy100: 0.4417 - val_loss: 3.2364 - val_accuracy100: 0.3872 - 188s/epoch - 34ms/step
Epoch 17/50
5452/5452 - 187s - loss: 3.1573 - accuracy100: 0.4423 - val_loss: 3.2358 - val_accuracy100: 0.3868 - 187s/epoch - 34ms/step
Epoch 18/50
5452/5452 - 190s - loss: 3.1559 - accuracy100: 0.4425 - val_loss: 3.2368 - val_accuracy100: 0.3868 - 190s/epoch - 35ms/step
Epoch 19/50
5452/5452 - 190s - loss: 3.1545 - accuracy100: 0.4433 - val_loss: 3.2340 - val_accuracy100: 0.3878 - 190s/epoch - 35ms/step
Epoch 20/50
5452/5452 - 188s - loss: 3.1534 - accuracy100: 0.4435 - val_loss: 3.2359 - val_accuracy100: 0.3880 - 188s/epoch - 35ms/step
Epoch 21/50
5452/5452 - 188s - loss: 3.1522 - accuracy100: 0.4442 - val_loss: 3.2342 - val_accuracy100: 0.3898 - 188s/epoch - 35ms/step
Epoch 22/50
5452/5452 - 187s - loss: 3.1512 - accuracy100: 0.4445 - val_loss: 3.2343 - val_accuracy100: 0.3903 - 187s/epoch - 34ms/step
Epoch 23/50
5452/5452 - 185s - loss: 3.1502 - accuracy100: 0.4448 - val_loss: 3.2342 - val_accuracy100: 0.3894 - 185s/epoch - 34ms/step
Epoch 24/50
5452/5452 - 188s - loss: 3.1492 - accuracy100: 0.4451 - val_loss: 3.2381 - val_accuracy100: 0.3870 - 188s/epoch - 34ms/step
Epoch 25/50
5452/5452 - 189s - loss: 3.1482 - accuracy100: 0.4455 - val_loss: 3.2382 - val_accuracy100: 0.3892 - 189s/epoch - 35ms/step
Epoch 26/50
5452/5452 - 188s - loss: 3.1471 - accuracy100: 0.4463 - val_loss: 3.2373 - val_accuracy100: 0.3889 - 188s/epoch - 34ms/step
Epoch 27/50
5452/5452 - 189s - loss: 3.1462 - accuracy100: 0.4466 - val_loss: 3.2436 - val_accuracy100: 0.3855 - 189s/epoch - 35ms/step
Epoch 28/50
5452/5452 - 187s - loss: 3.1450 - accuracy100: 0.4469 - val_loss: 3.2434 - val_accuracy100: 0.3851 - 187s/epoch - 34ms/step
Epoch 29/50
5452/5452 - 188s - loss: 3.1442 - accuracy100: 0.4471 - val_loss: 3.2434 - val_accuracy100: 0.3865 - 188s/epoch - 35ms/step
testing model: results/AAPL/W6/deepVOL_L3/h100
Evaluating performance on  test set...
29350/29350 - 496s - 496s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0791262
{'0': {'precision': 0.42076605416336704, 'recall': 0.0833752226338751, 'f1-score': 0.1391731447403665, 'support': 2255946}, '1': {'precision': 0.40712535739008276, 'recall': 0.8399671460348834, 'f1-score': 0.548430727610344, 'support': 3025510}, '2': {'precision': 0.378037432499815, 'recall': 0.13960898730615587, 'f1-score': 0.2039130228502342, 'support': 2231948}, 'accuracy': 0.4047458382379012, 'macro avg': {'precision': 0.40197628135108826, 'recall': 0.3543171186583048, 'f1-score': 0.29717229840031484, 'support': 7513404}, 'weighted avg': {'precision': 0.40258013920933805, 'recall': 0.4047458382379012, 'f1-score': 0.3232054356988333, 'support': 7513404}}
[[ 188090 1876721  191135]
 [ 162659 2541329  321522]
 [  96269 1824079  311600]]
Evaluating performance on  train set...
5452/5452 - 98s - 98s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.090252
{'0': {'precision': 0.45230393214003306, 'recall': 0.10731364125742184, 'f1-score': 0.17346982732625363, 'support': 469055}, '1': {'precision': 0.33343537024136966, 'recall': 0.8085975766389035, 'f1-score': 0.47216681984417835, 'support': 459362}, '2': {'precision': 0.43319761942530155, 'recall': 0.1578711851632988, 'f1-score': 0.2314093420517866, 'support': 467058}, 'accuracy': 0.35508339454307675, 'macro avg': {'precision': 0.40631230726890144, 'recall': 0.3579274676865414, 'f1-score': 0.29234866307407287, 'support': 1395475}, 'weighted avg': {'precision': 0.4067800377422037, 'recall': 0.35508339454307675, 'f1-score': 0.29118684966323344, 'support': 1395475}}
[[ 50336 375222  43497]
 [ 34944 371439  52979]
 [ 26008 367315  73735]]
Evaluating performance on  val set...
1969/1969 - 34s - 34s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0786632
{'0': {'precision': 0.43246524471529235, 'recall': 0.11350827866291784, 'f1-score': 0.1798196557424106, 'support': 160050}, '1': {'precision': 0.37890723131605325, 'recall': 0.8098293551645314, 'f1-score': 0.5162627318678377, 'support': 188110}, '2': {'precision': 0.4121009131507032, 'recall': 0.1586306870297557, 'f1-score': 0.2290808883125304, 'support': 155903}, 'accuracy': 0.38732261641897936, 'macro avg': {'precision': 0.40782446306068293, 'recall': 0.36065610695240163, 'f1-score': 0.3083877586409262, 'support': 504063}, 'weighted avg': {'precision': 0.4061795258975156, 'recall': 0.38732261641897936, 'f1-score': 0.32061213801413746, 'support': 504063}}
[[ 18167 127517  14366]
 [ 14858 152337  20915]
 [  8983 122189  24731]]
training model: results/AAPL/W6/deepVOL_L3/h200
Epoch 1/50
5452/5452 - 186s - loss: 3.1818 - accuracy200: 0.4227 - val_loss: 3.3118 - val_accuracy200: 0.3763 - 186s/epoch - 34ms/step
Epoch 2/50
5452/5452 - 196s - loss: 3.1775 - accuracy200: 0.4245 - val_loss: 3.3000 - val_accuracy200: 0.3763 - 196s/epoch - 36ms/step
Epoch 3/50
5452/5452 - 185s - loss: 3.1586 - accuracy200: 0.4331 - val_loss: 3.3002 - val_accuracy200: 0.3766 - 185s/epoch - 34ms/step
Epoch 4/50
5452/5452 - 184s - loss: 3.1505 - accuracy200: 0.4367 - val_loss: 3.3014 - val_accuracy200: 0.3767 - 184s/epoch - 34ms/step
Epoch 5/50
5452/5452 - 187s - loss: 3.1456 - accuracy200: 0.4401 - val_loss: 3.2831 - val_accuracy200: 0.3776 - 187s/epoch - 34ms/step
Epoch 6/50
5452/5452 - 185s - loss: 3.1419 - accuracy200: 0.4413 - val_loss: 3.2779 - val_accuracy200: 0.3776 - 185s/epoch - 34ms/step
Epoch 7/50
5452/5452 - 187s - loss: 3.1393 - accuracy200: 0.4428 - val_loss: 3.2734 - val_accuracy200: 0.3785 - 187s/epoch - 34ms/step
Epoch 8/50
5452/5452 - 186s - loss: 3.1368 - accuracy200: 0.4440 - val_loss: 3.2663 - val_accuracy200: 0.3812 - 186s/epoch - 34ms/step
Epoch 9/50
5452/5452 - 188s - loss: 3.1344 - accuracy200: 0.4448 - val_loss: 3.2648 - val_accuracy200: 0.3824 - 188s/epoch - 35ms/step
Epoch 10/50
5452/5452 - 187s - loss: 3.1322 - accuracy200: 0.4461 - val_loss: 3.2654 - val_accuracy200: 0.3847 - 187s/epoch - 34ms/step
Epoch 11/50
5452/5452 - 187s - loss: 3.1304 - accuracy200: 0.4472 - val_loss: 3.2568 - val_accuracy200: 0.3842 - 187s/epoch - 34ms/step
Epoch 12/50
5452/5452 - 186s - loss: 3.1287 - accuracy200: 0.4476 - val_loss: 3.2562 - val_accuracy200: 0.3856 - 186s/epoch - 34ms/step
Epoch 13/50
5452/5452 - 187s - loss: 3.1271 - accuracy200: 0.4485 - val_loss: 3.2557 - val_accuracy200: 0.3887 - 187s/epoch - 34ms/step
Epoch 14/50
5452/5452 - 187s - loss: 3.1255 - accuracy200: 0.4493 - val_loss: 3.2579 - val_accuracy200: 0.3875 - 187s/epoch - 34ms/step
Epoch 15/50
5452/5452 - 189s - loss: 3.1238 - accuracy200: 0.4499 - val_loss: 3.2547 - val_accuracy200: 0.3900 - 189s/epoch - 35ms/step
Epoch 16/50
5452/5452 - 186s - loss: 3.1222 - accuracy200: 0.4504 - val_loss: 3.2570 - val_accuracy200: 0.3886 - 186s/epoch - 34ms/step
Epoch 17/50
5452/5452 - 182s - loss: 3.1210 - accuracy200: 0.4509 - val_loss: 3.2576 - val_accuracy200: 0.3887 - 182s/epoch - 33ms/step
Epoch 18/50
5452/5452 - 186s - loss: 3.1196 - accuracy200: 0.4516 - val_loss: 3.2547 - val_accuracy200: 0.3898 - 186s/epoch - 34ms/step
Epoch 19/50
5452/5452 - 188s - loss: 3.1181 - accuracy200: 0.4520 - val_loss: 3.2610 - val_accuracy200: 0.3889 - 188s/epoch - 35ms/step
Epoch 20/50
5452/5452 - 187s - loss: 3.1165 - accuracy200: 0.4526 - val_loss: 3.2556 - val_accuracy200: 0.3921 - 187s/epoch - 34ms/step
Epoch 21/50
5452/5452 - 187s - loss: 3.1151 - accuracy200: 0.4531 - val_loss: 3.2551 - val_accuracy200: 0.3934 - 187s/epoch - 34ms/step
Epoch 22/50
5452/5452 - 185s - loss: 3.1139 - accuracy200: 0.4536 - val_loss: 3.2581 - val_accuracy200: 0.3926 - 185s/epoch - 34ms/step
Epoch 23/50
5452/5452 - 186s - loss: 3.1129 - accuracy200: 0.4540 - val_loss: 3.2578 - val_accuracy200: 0.3944 - 186s/epoch - 34ms/step
Epoch 24/50
5452/5452 - 197s - loss: 3.1111 - accuracy200: 0.4548 - val_loss: 3.2570 - val_accuracy200: 0.3950 - 197s/epoch - 36ms/step
Epoch 25/50
5452/5452 - 185s - loss: 3.1098 - accuracy200: 0.4551 - val_loss: 3.2567 - val_accuracy200: 0.3959 - 185s/epoch - 34ms/step
Epoch 26/50
5452/5452 - 188s - loss: 3.1088 - accuracy200: 0.4556 - val_loss: 3.2563 - val_accuracy200: 0.3963 - 188s/epoch - 34ms/step
Epoch 27/50
5452/5452 - 186s - loss: 3.1075 - accuracy200: 0.4561 - val_loss: 3.2542 - val_accuracy200: 0.3964 - 186s/epoch - 34ms/step
Epoch 28/50
5452/5452 - 197s - loss: 3.1060 - accuracy200: 0.4566 - val_loss: 3.2595 - val_accuracy200: 0.3962 - 197s/epoch - 36ms/step
Epoch 29/50
5452/5452 - 201s - loss: 3.1048 - accuracy200: 0.4569 - val_loss: 3.2591 - val_accuracy200: 0.3966 - 201s/epoch - 37ms/step
Epoch 30/50
5452/5452 - 198s - loss: 3.1039 - accuracy200: 0.4574 - val_loss: 3.2593 - val_accuracy200: 0.3956 - 198s/epoch - 36ms/step
Epoch 31/50
5452/5452 - 199s - loss: 3.1020 - accuracy200: 0.4579 - val_loss: 3.2620 - val_accuracy200: 0.3943 - 199s/epoch - 37ms/step
Epoch 32/50
5452/5452 - 185s - loss: 3.1012 - accuracy200: 0.4584 - val_loss: 3.2640 - val_accuracy200: 0.3933 - 185s/epoch - 34ms/step
Epoch 33/50
5452/5452 - 185s - loss: 3.1000 - accuracy200: 0.4586 - val_loss: 3.2689 - val_accuracy200: 0.3916 - 185s/epoch - 34ms/step
Epoch 34/50
5452/5452 - 196s - loss: 3.0987 - accuracy200: 0.4588 - val_loss: 3.2731 - val_accuracy200: 0.3903 - 196s/epoch - 36ms/step
Epoch 35/50
5452/5452 - 185s - loss: 3.0970 - accuracy200: 0.4592 - val_loss: 3.2750 - val_accuracy200: 0.3865 - 185s/epoch - 34ms/step
Epoch 36/50
5452/5452 - 192s - loss: 3.0952 - accuracy200: 0.4597 - val_loss: 3.2783 - val_accuracy200: 0.3882 - 192s/epoch - 35ms/step
Epoch 37/50
5452/5452 - 181s - loss: 3.0934 - accuracy200: 0.4604 - val_loss: 3.2866 - val_accuracy200: 0.3844 - 181s/epoch - 33ms/step
testing model: results/AAPL/W6/deepVOL_L3/h200
Evaluating performance on  test set...
29350/29350 - 396s - 396s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0838838
{'0': {'precision': 0.3621337387154454, 'recall': 0.1050621425627752, 'f1-score': 0.16287192592374652, 'support': 2212976}, '1': {'precision': 0.4318174673520337, 'recall': 0.7339314948662689, 'f1-score': 0.5437267363634948, 'support': 3069405}, '2': {'precision': 0.3386460781185026, 'recall': 0.25113770678294217, 'f1-score': 0.28839992433474415, 'support': 2231023}, 'accuracy': 0.4053458325946535, 'macro avg': {'precision': 0.3775324280619939, 'recall': 0.36337711473732875, 'f1-score': 0.33166619554066185, 'support': 7513404}, 'weighted avg': {'precision': 0.38362680285625483, 'recall': 0.4053458325946535, 'f1-score': 0.35573437695615673, 'support': 7513404}}
[[ 232500 1497361  483115]
 [ 205569 2252733  611103]
 [ 203959 1466770  560294]]
Evaluating performance on  train set...
5452/5452 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0882006
{'0': {'precision': 0.41205093799843034, 'recall': 0.17472726374846215, 'f1-score': 0.24539607199828717, 'support': 465743}, '1': {'precision': 0.38598167105776976, 'recall': 0.6720522767811996, 'f1-score': 0.4903431716156359, 'support': 464757}, '2': {'precision': 0.38606058111778746, 'recall': 0.3227872466261627, 'f1-score': 0.3515999545530681, 'support': 464975}, 'accuracy': 0.3896931152474964, 'macro avg': {'precision': 0.39469773005799585, 'recall': 0.3898555957186081, 'f1-score': 0.36244639938899703, 'support': 1395475}, 'weighted avg': {'precision': 0.39470864201597455, 'recall': 0.3896931152474964, 'f1-score': 0.3623620007807945, 'support': 1395475}}
[[ 81378 252770 131595]
 [ 45331 312341 107085]
 [ 70786 244101 150088]]
Evaluating performance on  val set...
1969/1969 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0847837
{'0': {'precision': 0.3903120405162555, 'recall': 0.14990243259692426, 'f1-score': 0.21661294636583298, 'support': 159377}, '1': {'precision': 0.41658262659636114, 'recall': 0.6859323767251104, 'f1-score': 0.5183557780216672, 'support': 189698}, '2': {'precision': 0.3530750486582581, 'recall': 0.2972939840503781, 'f1-score': 0.3227923920277418, 'support': 154988}, 'accuracy': 0.3969503812023497, 'macro avg': {'precision': 0.38665657192362496, 'recall': 0.37770959779080426, 'f1-score': 0.3525870388050807, 'support': 504063}, 'weighted avg': {'precision': 0.3887491222781317, 'recall': 0.3969503812023497, 'f1-score': 0.3628179874097032, 'support': 504063}}
[[ 23891  93133  42353]
 [ 17506 130120  42072]
 [ 19813  89098  46077]]
training model: results/AAPL/W6/deepVOL_L3/h300
Epoch 1/50
5452/5452 - 186s - loss: 3.2097 - accuracy300: 0.4093 - val_loss: 3.3097 - val_accuracy300: 0.3589 - 186s/epoch - 34ms/step
Epoch 2/50
5452/5452 - 179s - loss: 3.2150 - accuracy300: 0.4046 - val_loss: 3.3176 - val_accuracy300: 0.3589 - 179s/epoch - 33ms/step
Epoch 3/50
5452/5452 - 179s - loss: 3.2152 - accuracy300: 0.4061 - val_loss: 3.3158 - val_accuracy300: 0.3589 - 179s/epoch - 33ms/step
Epoch 4/50
5452/5452 - 180s - loss: 3.2078 - accuracy300: 0.4099 - val_loss: 3.3243 - val_accuracy300: 0.3589 - 180s/epoch - 33ms/step
Epoch 5/50
5452/5452 - 179s - loss: 3.1915 - accuracy300: 0.4165 - val_loss: 3.3266 - val_accuracy300: 0.3589 - 179s/epoch - 33ms/step
Epoch 6/50
5452/5452 - 180s - loss: 3.1839 - accuracy300: 0.4217 - val_loss: 3.3065 - val_accuracy300: 0.3594 - 180s/epoch - 33ms/step
Epoch 7/50
5452/5452 - 179s - loss: 3.1790 - accuracy300: 0.4239 - val_loss: 3.3068 - val_accuracy300: 0.3589 - 179s/epoch - 33ms/step
Epoch 8/50
5452/5452 - 180s - loss: 3.1753 - accuracy300: 0.4269 - val_loss: 3.3024 - val_accuracy300: 0.3586 - 180s/epoch - 33ms/step
Epoch 9/50
5452/5452 - 184s - loss: 3.1727 - accuracy300: 0.4282 - val_loss: 3.3051 - val_accuracy300: 0.3591 - 184s/epoch - 34ms/step
Epoch 10/50
5452/5452 - 178s - loss: 3.1704 - accuracy300: 0.4289 - val_loss: 3.3042 - val_accuracy300: 0.3585 - 178s/epoch - 33ms/step
Epoch 11/50
5452/5452 - 179s - loss: 3.1685 - accuracy300: 0.4299 - val_loss: 3.3002 - val_accuracy300: 0.3587 - 179s/epoch - 33ms/step
Epoch 12/50
5452/5452 - 183s - loss: 3.1671 - accuracy300: 0.4308 - val_loss: 3.2959 - val_accuracy300: 0.3591 - 183s/epoch - 34ms/step
Epoch 13/50
5452/5452 - 185s - loss: 3.1655 - accuracy300: 0.4319 - val_loss: 3.2994 - val_accuracy300: 0.3589 - 185s/epoch - 34ms/step
Epoch 14/50
5452/5452 - 185s - loss: 3.1643 - accuracy300: 0.4326 - val_loss: 3.3021 - val_accuracy300: 0.3595 - 185s/epoch - 34ms/step
Epoch 15/50
5452/5452 - 191s - loss: 3.1636 - accuracy300: 0.4328 - val_loss: 3.3019 - val_accuracy300: 0.3596 - 191s/epoch - 35ms/step
Epoch 16/50
5452/5452 - 185s - loss: 3.1619 - accuracy300: 0.4340 - val_loss: 3.3083 - val_accuracy300: 0.3580 - 185s/epoch - 34ms/step
Epoch 17/50
5452/5452 - 187s - loss: 3.1617 - accuracy300: 0.4337 - val_loss: 3.3026 - val_accuracy300: 0.3621 - 187s/epoch - 34ms/step
Epoch 18/50
5452/5452 - 189s - loss: 3.1596 - accuracy300: 0.4350 - val_loss: 3.3021 - val_accuracy300: 0.3624 - 189s/epoch - 35ms/step
Epoch 19/50
5452/5452 - 187s - loss: 3.1588 - accuracy300: 0.4351 - val_loss: 3.3005 - val_accuracy300: 0.3621 - 187s/epoch - 34ms/step
Epoch 20/50
5452/5452 - 181s - loss: 3.1573 - accuracy300: 0.4359 - val_loss: 3.2968 - val_accuracy300: 0.3635 - 181s/epoch - 33ms/step
Epoch 21/50
5452/5452 - 184s - loss: 3.1555 - accuracy300: 0.4366 - val_loss: 3.3004 - val_accuracy300: 0.3620 - 184s/epoch - 34ms/step
Epoch 22/50
5452/5452 - 186s - loss: 3.1541 - accuracy300: 0.4374 - val_loss: 3.2991 - val_accuracy300: 0.3629 - 186s/epoch - 34ms/step
testing model: results/AAPL/W6/deepVOL_L3/h300
Evaluating performance on  test set...
29350/29350 - 405s - 405s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0849886
{'0': {'precision': 0.3453407848378083, 'recall': 0.002578614868787738, 'f1-score': 0.005119006777618999, 'support': 2204672}, '1': {'precision': 0.4130500810373239, 'recall': 0.9241174897126645, 'f1-score': 0.5709184284206553, 'support': 3099199}, '2': {'precision': 0.31429763807494226, 'recall': 0.08009882631307158, 'f1-score': 0.12766276676357813, 'support': 2209533}, 'accuracy': 0.40550062262058584, 'macro avg': {'precision': 0.3575628346500248, 'recall': 0.3355983102981746, 'f1-score': 0.23456673398728414, 'support': 7513404}, 'weighted avg': {'precision': 0.3641410151829151, 'recall': 0.40550062262058584, 'f1-score': 0.27454275710300186, 'support': 7513404}}
[[   5685 2041749  157238]
 [   6294 2864024  228881]
 [   4483 2028069  176981]]
Evaluating performance on  train set...
5452/5452 - 90s - 90s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1071259
{'0': {'precision': 0.39734660033167496, 'recall': 0.0025320468787978063, 'f1-score': 0.0050320277223564, 'support': 473135}, '1': {'precision': 0.32459190854091463, 'recall': 0.9152896001420533, 'f1-score': 0.47923224291544086, 'support': 450535}, '2': {'precision': 0.3710769129914614, 'recall': 0.0959803308570278, 'f1-score': 0.1525127180936247, 'support': 471805}, 'accuracy': 0.328814203049141, 'macro avg': {'precision': 0.3643384739546837, 'recall': 0.33793399262595963, 'f1-score': 0.2122589962438073, 'support': 1395475}, 'weighted avg': {'precision': 0.36497575534950066, 'recall': 0.328814203049141, 'f1-score': 0.2079922535039953, 'support': 1395475}}
[[  1198 432363  39574]
 [   989 412370  37176]
 [   828 425693  45284]]
Evaluating performance on  val set...
1969/1969 - 33s - 33s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1003299
{'0': {'precision': 0.3799638989169675, 'recall': 0.0025723276204442, 'f1-score': 0.005110060507486057, 'support': 163665}, '1': {'precision': 0.3601612871466921, 'recall': 0.9100759594440697, 'f1-score': 0.5160833219689667, 'support': 180886}, '2': {'precision': 0.3447975240835186, 'recall': 0.09917749134861327, 'f1-score': 0.15404539567854952, 'support': 159512}, 'accuracy': 0.35880633968373, 'macro avg': {'precision': 0.3616409033823927, 'recall': 0.3372752594710424, 'f1-score': 0.22507959271833408, 'support': 504063}, 'weighted avg': {'precision': 0.3617291266462173, 'recall': 0.35880633968373, 'f1-score': 0.2356068090419511, 'support': 504063}}
[[   421 149053  14191]
 [   395 164620  15871]
 [   292 143400  15820]]
training model: results/AAPL/W6/deepVOL_L3/h500
Epoch 1/50
5452/5452 - 190s - loss: 3.2125 - accuracy500: 0.4092 - val_loss: 3.3004 - val_accuracy500: 0.3722 - 190s/epoch - 35ms/step
Epoch 2/50
5452/5452 - 191s - loss: 3.2176 - accuracy500: 0.4069 - val_loss: 3.3051 - val_accuracy500: 0.3722 - 191s/epoch - 35ms/step
Epoch 3/50
5452/5452 - 188s - loss: 3.2160 - accuracy500: 0.4075 - val_loss: 3.3025 - val_accuracy500: 0.3722 - 188s/epoch - 34ms/step
Epoch 4/50
5452/5452 - 188s - loss: 3.2158 - accuracy500: 0.4065 - val_loss: 3.3030 - val_accuracy500: 0.3722 - 188s/epoch - 35ms/step
Epoch 5/50
5452/5452 - 188s - loss: 3.2138 - accuracy500: 0.4095 - val_loss: 3.3042 - val_accuracy500: 0.3722 - 188s/epoch - 35ms/step
Epoch 6/50
5452/5452 - 188s - loss: 3.2087 - accuracy500: 0.4118 - val_loss: 3.3133 - val_accuracy500: 0.3722 - 188s/epoch - 34ms/step
Epoch 7/50
5452/5452 - 189s - loss: 3.2069 - accuracy500: 0.4108 - val_loss: 3.3097 - val_accuracy500: 0.3722 - 189s/epoch - 35ms/step
Epoch 8/50
5452/5452 - 187s - loss: 3.1987 - accuracy500: 0.4147 - val_loss: 3.3085 - val_accuracy500: 0.3722 - 187s/epoch - 34ms/step
Epoch 9/50
5452/5452 - 186s - loss: 3.1962 - accuracy500: 0.4154 - val_loss: 3.3165 - val_accuracy500: 0.3722 - 186s/epoch - 34ms/step
Epoch 10/50
5452/5452 - 186s - loss: 3.1896 - accuracy500: 0.4196 - val_loss: 3.3114 - val_accuracy500: 0.3722 - 186s/epoch - 34ms/step
Epoch 11/50
5452/5452 - 186s - loss: 3.1833 - accuracy500: 0.4225 - val_loss: 3.2936 - val_accuracy500: 0.3720 - 186s/epoch - 34ms/step
Epoch 12/50
5452/5452 - 187s - loss: 3.1768 - accuracy500: 0.4270 - val_loss: 3.3029 - val_accuracy500: 0.3723 - 187s/epoch - 34ms/step
Epoch 13/50
5452/5452 - 187s - loss: 3.1717 - accuracy500: 0.4293 - val_loss: 3.2970 - val_accuracy500: 0.3723 - 187s/epoch - 34ms/step
Epoch 14/50
5452/5452 - 187s - loss: 3.1686 - accuracy500: 0.4314 - val_loss: 3.2978 - val_accuracy500: 0.3724 - 187s/epoch - 34ms/step
Epoch 15/50
5452/5452 - 187s - loss: 3.1654 - accuracy500: 0.4332 - val_loss: 3.3002 - val_accuracy500: 0.3725 - 187s/epoch - 34ms/step
Epoch 16/50
5452/5452 - 187s - loss: 3.1631 - accuracy500: 0.4344 - val_loss: 3.3002 - val_accuracy500: 0.3730 - 187s/epoch - 34ms/step
Epoch 17/50
5452/5452 - 190s - loss: 3.1605 - accuracy500: 0.4355 - val_loss: 3.3020 - val_accuracy500: 0.3732 - 190s/epoch - 35ms/step
Epoch 18/50
5452/5452 - 189s - loss: 3.1595 - accuracy500: 0.4362 - val_loss: 3.3004 - val_accuracy500: 0.3731 - 189s/epoch - 35ms/step
Epoch 19/50
5452/5452 - 188s - loss: 3.1598 - accuracy500: 0.4365 - val_loss: 3.3009 - val_accuracy500: 0.3732 - 188s/epoch - 35ms/step
Epoch 20/50
5452/5452 - 189s - loss: 3.1577 - accuracy500: 0.4371 - val_loss: 3.3054 - val_accuracy500: 0.3737 - 189s/epoch - 35ms/step
Epoch 21/50
5452/5452 - 189s - loss: 3.1563 - accuracy500: 0.4374 - val_loss: 3.3048 - val_accuracy500: 0.3739 - 189s/epoch - 35ms/step
testing model: results/AAPL/W6/deepVOL_L3/h500
Evaluating performance on  test set...
29350/29350 - 401s - 401s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0939336
{'0': {'precision': 0.3122200895713372, 'recall': 0.00489674687431014, 'f1-score': 0.009642267908833147, 'support': 2292134}, '1': {'precision': 0.3877367878035273, 'recall': 0.9949618101501294, 'f1-score': 0.5580150248589812, 'support': 2912554}, '2': {'precision': 0.3379348426283821, 'recall': 0.000530164818886342, 'f1-score': 0.0010586687586330373, 'support': 2308716}, 'accuracy': 0.38735145880615496, 'macro avg': {'precision': 0.3459639066677489, 'recall': 0.3334629072811086, 'f1-score': 0.1895719871754825, 'support': 7513404}, 'weighted avg': {'precision': 0.3493955859670863, 'recall': 0.38735145880615496, 'f1-score': 0.21958015678723342, 'support': 7513404}}
[[  11224 2279700    1210]
 [  13486 2897880    1188]
 [  11239 2296253    1224]]
Evaluating performance on  train set...
5452/5452 - 77s - 77s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1122601
{'0': {'precision': 0.3540786841520338, 'recall': 0.003397428788357035, 'f1-score': 0.006730279710086759, 'support': 468884}, '1': {'precision': 0.3289211337309494, 'recall': 0.9957068176867785, 'f1-score': 0.49449207981251386, 'support': 459100}, '2': {'precision': 0.3738474434199497, 'recall': 0.00095402906152204, 'f1-score': 0.0019032013040769474, 'support': 467491}, 'accuracy': 0.3290406492412978, 'macro avg': {'precision': 0.35228242043431096, 'recall': 0.3333527585122192, 'f1-score': 0.1677085202755592, 'support': 1395475}, 'weighted avg': {'precision': 0.35242468507687835, 'recall': 0.3290406492412978, 'f1-score': 0.16558287593425441, 'support': 1395475}}
[[  1593 466863    428]
 [  1652 457129    319]
 [  1254 465791    446]]
Evaluating performance on  val set...
1969/1969 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0986334
{'0': {'precision': 0.33101391650099404, 'recall': 0.0041426669818245155, 'f1-score': 0.008182923982356339, 'support': 160766}, '1': {'precision': 0.3721906948838007, 'recall': 0.9952879720689747, 'f1-score': 0.5417809153239729, 'support': 187605}, '2': {'precision': 0.3783783783783784, 'recall': 0.0008992112632633661, 'f1-score': 0.001794158731786085, 'support': 155692}, 'accuracy': 0.37203087709274435, 'macro avg': {'precision': 0.36052766325439106, 'recall': 0.3334432834380208, 'f1-score': 0.18391933267937177, 'support': 504063}, 'weighted avg': {'precision': 0.36096897629931324, 'recall': 0.37203087709274435, 'f1-score': 0.20480709898875868, 'support': 504063}}
[[   666 159984    116]
 [   770 186721    114]
 [   576 154976    140]]
training model: results/AAPL/W6/deepVOL_L3/h1000
Epoch 1/50
5452/5452 - 192s - loss: 3.2032 - accuracy1000: 0.4144 - val_loss: 3.2839 - val_accuracy1000: 0.3750 - 192s/epoch - 35ms/step
Epoch 2/50
5452/5452 - 191s - loss: 3.2088 - accuracy1000: 0.4118 - val_loss: 3.2854 - val_accuracy1000: 0.3750 - 191s/epoch - 35ms/step
Epoch 3/50
5452/5452 - 189s - loss: 3.2080 - accuracy1000: 0.4126 - val_loss: 3.2832 - val_accuracy1000: 0.3751 - 189s/epoch - 35ms/step
Epoch 4/50
5452/5452 - 191s - loss: 3.2031 - accuracy1000: 0.4159 - val_loss: 3.2852 - val_accuracy1000: 0.3750 - 191s/epoch - 35ms/step
Epoch 5/50
5452/5452 - 190s - loss: 3.2062 - accuracy1000: 0.4130 - val_loss: 3.2849 - val_accuracy1000: 0.3750 - 190s/epoch - 35ms/step
Epoch 6/50
5452/5452 - 191s - loss: 3.1918 - accuracy1000: 0.4189 - val_loss: 3.2856 - val_accuracy1000: 0.3748 - 191s/epoch - 35ms/step
Epoch 7/50
5452/5452 - 191s - loss: 3.1818 - accuracy1000: 0.4254 - val_loss: 3.2925 - val_accuracy1000: 0.3618 - 191s/epoch - 35ms/step
Epoch 8/50
5452/5452 - 191s - loss: 3.1692 - accuracy1000: 0.4303 - val_loss: 3.2953 - val_accuracy1000: 0.3575 - 191s/epoch - 35ms/step
Epoch 9/50
5452/5452 - 189s - loss: 3.1586 - accuracy1000: 0.4364 - val_loss: 3.2908 - val_accuracy1000: 0.3635 - 189s/epoch - 35ms/step
Epoch 10/50
5452/5452 - 191s - loss: 3.1506 - accuracy1000: 0.4388 - val_loss: 3.2921 - val_accuracy1000: 0.3631 - 191s/epoch - 35ms/step
Epoch 11/50
5452/5452 - 190s - loss: 3.1492 - accuracy1000: 0.4378 - val_loss: 3.3023 - val_accuracy1000: 0.3537 - 190s/epoch - 35ms/step
Epoch 12/50
5452/5452 - 190s - loss: 3.1403 - accuracy1000: 0.4430 - val_loss: 3.2992 - val_accuracy1000: 0.3474 - 190s/epoch - 35ms/step
Epoch 13/50
5452/5452 - 190s - loss: 3.1370 - accuracy1000: 0.4446 - val_loss: 3.2998 - val_accuracy1000: 0.3580 - 190s/epoch - 35ms/step
testing model: results/AAPL/W6/deepVOL_L3/h1000
Evaluating performance on  test set...
29350/29350 - 394s - 394s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0915608
{'0': {'precision': 0.29171485378651063, 'recall': 0.04587850551025894, 'f1-score': 0.07928735064426294, 'support': 2232200}, '1': {'precision': 0.40262528033246103, 'recall': 0.955956942986525, 'f1-score': 0.5666089627103003, 'support': 3016094}, '2': {'precision': 0.24292845257903495, 'recall': 0.00012891206166587937, 'f1-score': 0.00025768737931935234, 'support': 2265110}, 'accuracy': 0.3974174688330349, 'macro avg': {'precision': 0.31242286223266885, 'recall': 0.33398812018614993, 'f1-score': 0.21538466691129418, 'support': 7513404}, 'weighted avg': {'precision': 0.3215295299045014, 'recall': 0.3974174688330349, 'f1-score': 0.25108656570905197, 'support': 7513404}}
[[ 102410 2129396     394]
 [ 132322 2883256     516]
 [ 116330 2148488     292]]
Evaluating performance on  train set...
5452/5452 - 77s - 77s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1024573
{'0': {'precision': 0.3375953774353656, 'recall': 0.048925132909054994, 'f1-score': 0.08546453949256134, 'support': 465732}, '1': {'precision': 0.3318956265547229, 'recall': 0.9517961698699604, 'f1-score': 0.4921695176851748, 'support': 463013}, '2': {'precision': 0.30409356725146197, 'recall': 0.0001114134510316457, 'f1-score': 0.00022274529289935125, 'support': 466730}, 'accuracy': 0.33216789981905803, 'macro avg': {'precision': 0.32452819041385017, 'recall': 0.33361090541001565, 'f1-score': 0.1926189341568785, 'support': 1395475}, 'weighted avg': {'precision': 0.32449922120065533, 'recall': 0.33216789981905803, 'f1-score': 0.1918976819430447, 'support': 1395475}}
[[ 22786 442893     53]
 [ 22253 440694     66]
 [ 22456 444222     52]]
Evaluating performance on  val set...
1969/1969 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0944192
{'0': {'precision': 0.3398085718327125, 'recall': 0.04486540999526881, 'f1-score': 0.07926530836701587, 'support': 160636}, '1': {'precision': 0.3761873594120888, 'recall': 0.9607441732525047, 'f1-score': 0.5406706398585369, 'support': 189042}, '2': {'precision': 0.38333333333333336, 'recall': 0.00014897820384104674, 'f1-score': 0.0002978406552494416, 'support': 154385}, 'accuracy': 0.3746575328877541, 'macro avg': {'precision': 0.3664430881927116, 'recall': 0.3352528538172049, 'f1-score': 0.20674459629360073, 'support': 504063}, 'weighted avg': {'precision': 0.36678275772982016, 'recall': 0.3746575328877541, 'f1-score': 0.2281228800855095, 'support': 504063}}
[[  7207 153416     13]
 [  7397 181621     24]
 [  6605 147757     23]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       256            32
 Used       :        63 (peak)  24.72 (ave)

============================================
