This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/XRAY_orderbooks/XRAY_orderbooks_2019-09-04.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-08-27.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-08-14.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-08-15.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-08-23.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-08-19.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-08-21.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-08-16.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-09-06.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-08-20.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-08-22.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-08-13.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-08-29.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-08-28.csv
training model: results/XRAY/W6/deepLOB_L1/h10
Epoch 1/50
512/512 - 19s - loss: 3.2411 - accuracy10: 0.3882 - val_loss: 3.2883 - val_accuracy10: 0.3781 - 19s/epoch - 37ms/step
Epoch 2/50
512/512 - 10s - loss: 3.1743 - accuracy10: 0.4123 - val_loss: 3.1967 - val_accuracy10: 0.4027 - 10s/epoch - 20ms/step
Epoch 3/50
512/512 - 10s - loss: 3.1365 - accuracy10: 0.4312 - val_loss: 3.1851 - val_accuracy10: 0.4305 - 10s/epoch - 20ms/step
Epoch 4/50
512/512 - 10s - loss: 3.1035 - accuracy10: 0.4535 - val_loss: 3.1535 - val_accuracy10: 0.4527 - 10s/epoch - 20ms/step
Epoch 5/50
512/512 - 10s - loss: 3.0865 - accuracy10: 0.4642 - val_loss: 3.1242 - val_accuracy10: 0.4580 - 10s/epoch - 20ms/step
Epoch 6/50
512/512 - 10s - loss: 3.0752 - accuracy10: 0.4703 - val_loss: 3.1455 - val_accuracy10: 0.4611 - 10s/epoch - 20ms/step
Epoch 7/50
512/512 - 10s - loss: 3.0656 - accuracy10: 0.4718 - val_loss: 3.1275 - val_accuracy10: 0.4627 - 10s/epoch - 20ms/step
Epoch 8/50
512/512 - 10s - loss: 3.0590 - accuracy10: 0.4756 - val_loss: 3.1465 - val_accuracy10: 0.4708 - 10s/epoch - 19ms/step
Epoch 9/50
512/512 - 10s - loss: 3.0521 - accuracy10: 0.4779 - val_loss: 3.1509 - val_accuracy10: 0.4710 - 10s/epoch - 20ms/step
Epoch 10/50
512/512 - 10s - loss: 3.0466 - accuracy10: 0.4796 - val_loss: 3.1551 - val_accuracy10: 0.4667 - 10s/epoch - 19ms/step
Epoch 11/50
512/512 - 10s - loss: 3.0412 - accuracy10: 0.4810 - val_loss: 3.1563 - val_accuracy10: 0.4661 - 10s/epoch - 20ms/step
Epoch 12/50
512/512 - 10s - loss: 3.0373 - accuracy10: 0.4817 - val_loss: 3.1426 - val_accuracy10: 0.4685 - 10s/epoch - 20ms/step
Epoch 13/50
512/512 - 9s - loss: 3.0328 - accuracy10: 0.4835 - val_loss: 3.1426 - val_accuracy10: 0.4733 - 9s/epoch - 18ms/step
Epoch 14/50
512/512 - 10s - loss: 3.0302 - accuracy10: 0.4844 - val_loss: 3.1452 - val_accuracy10: 0.4684 - 10s/epoch - 20ms/step
Epoch 15/50
512/512 - 11s - loss: 3.0240 - accuracy10: 0.4854 - val_loss: 3.1322 - val_accuracy10: 0.4688 - 11s/epoch - 21ms/step
testing model: results/XRAY/W6/deepLOB_L1/h10
Evaluating performance on  test set...
1214/1214 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0586303
{'0': {'precision': 0.3890217278303358, 'recall': 0.5733798855166526, 'f1-score': 0.46354293399636337, 'support': 91367}, '1': {'precision': 0.5119203082335927, 'recall': 0.3705905791722985, 'f1-score': 0.4299388171312033, 'support': 127993}, '2': {'precision': 0.423321419147456, 'recall': 0.38641514391758, 'f1-score': 0.40402722209820796, 'support': 91337}, 'accuracy': 0.43487706672417176, 'macro avg': {'precision': 0.4414211517371281, 'recall': 0.44346186953551037, 'f1-score': 0.43250299107525825, 'support': 310697}, 'weighted avg': {'precision': 0.44973357540976483, 'recall': 0.43487706672417176, 'f1-score': 0.43220346722467173, 'support': 310697}}
[[52388 22223 16756]
 [49236 47433 31324]
 [33042 23001 35294]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.03436
{'0': {'precision': 0.381781214965702, 'recall': 0.5687273550724637, 'f1-score': 0.45686999033596726, 'support': 35328}, '1': {'precision': 0.5897607570076772, 'recall': 0.43363964555300294, 'f1-score': 0.49979195824034506, 'support': 60940}, '2': {'precision': 0.4215958240119314, 'recall': 0.40741381298282026, 'f1-score': 0.41438351144142954, 'support': 34692}, 'accuracy': 0.4631337813072694, 'macro avg': {'precision': 0.4643792653284368, 'recall': 0.469926937869429, 'f1-score': 0.4570151533392473, 'support': 130960}, 'weighted avg': {'precision': 0.48910804536482966, 'recall': 0.4631337813072694, 'f1-score': 0.4655881011964092, 'support': 130960}}
[[20092  9044  6192]
 [21315 26426 13199]
 [11220  9338 14134]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0406396
{'0': {'precision': 0.3818707275051409, 'recall': 0.5936069114470842, 'f1-score': 0.46475919913419916, 'support': 11575}, '1': {'precision': 0.5881475165209976, 'recall': 0.41672540529654617, 'f1-score': 0.4878149403270959, 'support': 19862}, '2': {'precision': 0.4187347712300334, 'recall': 0.3962425277540564, 'f1-score': 0.40717827212496166, 'support': 11710}, 'accuracy': 0.4586182121584351, 'macro avg': {'precision': 0.4629176717520573, 'recall': 0.468858281499229, 'f1-score': 0.45325080386208555, 'support': 43147}, 'weighted avg': {'precision': 0.48683161784401585, 'recall': 0.4586182121584351, 'f1-score': 0.45974518834075223, 'support': 43147}}
[[6871 2715 1989]
 [7133 8277 4452]
 [3989 3081 4640]]
training model: results/XRAY/W6/deepLOB_L1/h20
Epoch 1/50
512/512 - 12s - loss: 3.2819 - accuracy20: 0.3828 - val_loss: 3.3681 - val_accuracy20: 0.3552 - 12s/epoch - 24ms/step
Epoch 2/50
512/512 - 10s - loss: 3.2318 - accuracy20: 0.4079 - val_loss: 3.2964 - val_accuracy20: 0.3821 - 10s/epoch - 20ms/step
Epoch 3/50
512/512 - 10s - loss: 3.1967 - accuracy20: 0.4280 - val_loss: 3.2466 - val_accuracy20: 0.4125 - 10s/epoch - 20ms/step
Epoch 4/50
512/512 - 10s - loss: 3.1719 - accuracy20: 0.4415 - val_loss: 3.2166 - val_accuracy20: 0.4203 - 10s/epoch - 20ms/step
Epoch 5/50
512/512 - 10s - loss: 3.1533 - accuracy20: 0.4490 - val_loss: 3.2086 - val_accuracy20: 0.4263 - 10s/epoch - 20ms/step
Epoch 6/50
512/512 - 10s - loss: 3.1413 - accuracy20: 0.4531 - val_loss: 3.1973 - val_accuracy20: 0.4298 - 10s/epoch - 20ms/step
Epoch 7/50
512/512 - 9s - loss: 3.1336 - accuracy20: 0.4573 - val_loss: 3.2059 - val_accuracy20: 0.4291 - 9s/epoch - 19ms/step
Epoch 8/50
512/512 - 10s - loss: 3.1266 - accuracy20: 0.4595 - val_loss: 3.1962 - val_accuracy20: 0.4332 - 10s/epoch - 19ms/step
Epoch 9/50
512/512 - 9s - loss: 3.1224 - accuracy20: 0.4615 - val_loss: 3.2031 - val_accuracy20: 0.4319 - 9s/epoch - 18ms/step
Epoch 10/50
512/512 - 9s - loss: 3.1175 - accuracy20: 0.4631 - val_loss: 3.1989 - val_accuracy20: 0.4349 - 9s/epoch - 18ms/step
Epoch 11/50
512/512 - 10s - loss: 3.1117 - accuracy20: 0.4667 - val_loss: 3.1984 - val_accuracy20: 0.4347 - 10s/epoch - 19ms/step
Epoch 12/50
512/512 - 10s - loss: 3.1093 - accuracy20: 0.4662 - val_loss: 3.1966 - val_accuracy20: 0.4359 - 10s/epoch - 20ms/step
Epoch 13/50
512/512 - 10s - loss: 3.1038 - accuracy20: 0.4692 - val_loss: 3.2158 - val_accuracy20: 0.4340 - 10s/epoch - 20ms/step
Epoch 14/50
512/512 - 10s - loss: 3.1013 - accuracy20: 0.4683 - val_loss: 3.2011 - val_accuracy20: 0.4331 - 10s/epoch - 20ms/step
Epoch 15/50
512/512 - 10s - loss: 3.0972 - accuracy20: 0.4700 - val_loss: 3.2054 - val_accuracy20: 0.4365 - 10s/epoch - 20ms/step
Epoch 16/50
512/512 - 10s - loss: 3.0926 - accuracy20: 0.4705 - val_loss: 3.2144 - val_accuracy20: 0.4352 - 10s/epoch - 19ms/step
Epoch 17/50
512/512 - 10s - loss: 3.0884 - accuracy20: 0.4732 - val_loss: 3.2251 - val_accuracy20: 0.4331 - 10s/epoch - 20ms/step
Epoch 18/50
512/512 - 10s - loss: 3.0840 - accuracy20: 0.4746 - val_loss: 3.2384 - val_accuracy20: 0.4292 - 10s/epoch - 19ms/step
testing model: results/XRAY/W6/deepLOB_L1/h20
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0719492
{'0': {'precision': 0.4634936543638631, 'recall': 0.3602054124551679, 'f1-score': 0.4053735876749958, 'support': 110412}, '1': {'precision': 0.3559944575186399, 'recall': 0.5380745534329152, 'f1-score': 0.42849390015222044, 'support': 90244}, '2': {'precision': 0.4826814632327182, 'recall': 0.38814623640279533, 'f1-score': 0.43028257694051275, 'support': 110041}, 'accuracy': 0.4217646131118099, 'macro avg': {'precision': 0.43405652503840714, 'recall': 0.42880873409695947, 'f1-score': 0.42138335492257634, 'support': 310697}, 'weighted avg': {'precision': 0.43906563657044173, 'recall': 0.4217646131118099, 'f1-score': 0.42091116791220895, 'support': 310697}}
[[39771 46871 23770]
 [19679 48558 22007]
 [26357 40972 42712]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0518875
{'0': {'precision': 0.45496331164336146, 'recall': 0.381035202448866, 'f1-score': 0.4147304920680995, 'support': 43122}, '1': {'precision': 0.4314895919644216, 'recall': 0.5586767088496738, 'f1-score': 0.486914541412638, 'support': 45674}, '2': {'precision': 0.46577797692393863, 'recall': 0.3944597286784935, 'f1-score': 0.42716252311485514, 'support': 42164}, 'accuracy': 0.4473121563836286, 'macro avg': {'precision': 0.4507436268439073, 'recall': 0.4447238799923445, 'f1-score': 0.4429358521985309, 'support': 130960}, 'weighted avg': {'precision': 0.4502584466026952, 'recall': 0.4473121563836286, 'f1-score': 0.4439082442582175, 'support': 130960}}
[[16431 17727  8964]
 [10045 25517 10112]
 [ 9639 15893 16632]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0627171
{'0': {'precision': 0.44217462932454693, 'recall': 0.38176516606215777, 'f1-score': 0.4097553528491279, 'support': 14061}, '1': {'precision': 0.4116448638215741, 'recall': 0.5213553337407483, 'f1-score': 0.46004973186734177, 'support': 14727}, '2': {'precision': 0.4522055847834885, 'recall': 0.38909394804652137, 'f1-score': 0.4182825484764543, 'support': 14359}, 'accuracy': 0.4318492595081929, 'macro avg': {'precision': 0.43534169264320316, 'recall': 0.4307381492831425, 'f1-score': 0.42936254439764127, 'support': 43147}, 'weighted avg': {'precision': 0.4350923903015016, 'recall': 0.4318492595081929, 'f1-score': 0.4297596943285822, 'support': 43147}}
[[5368 5631 3062]
 [3343 7678 3706]
 [3429 5343 5587]]
training model: results/XRAY/W6/deepLOB_L1/h30
Epoch 1/50
512/512 - 11s - loss: 3.2906 - accuracy30: 0.3786 - val_loss: 3.3618 - val_accuracy30: 0.3461 - 11s/epoch - 22ms/step
Epoch 2/50
512/512 - 10s - loss: 3.2535 - accuracy30: 0.3949 - val_loss: 3.2715 - val_accuracy30: 0.3915 - 10s/epoch - 20ms/step
Epoch 3/50
512/512 - 10s - loss: 3.2280 - accuracy30: 0.4108 - val_loss: 3.2655 - val_accuracy30: 0.3961 - 10s/epoch - 20ms/step
Epoch 4/50
512/512 - 11s - loss: 3.2132 - accuracy30: 0.4201 - val_loss: 3.2493 - val_accuracy30: 0.4064 - 11s/epoch - 21ms/step
Epoch 5/50
512/512 - 10s - loss: 3.2016 - accuracy30: 0.4260 - val_loss: 3.2345 - val_accuracy30: 0.4134 - 10s/epoch - 20ms/step
Epoch 6/50
512/512 - 10s - loss: 3.1925 - accuracy30: 0.4294 - val_loss: 3.2253 - val_accuracy30: 0.4144 - 10s/epoch - 20ms/step
Epoch 7/50
512/512 - 10s - loss: 3.1855 - accuracy30: 0.4349 - val_loss: 3.2343 - val_accuracy30: 0.4157 - 10s/epoch - 20ms/step
Epoch 8/50
512/512 - 10s - loss: 3.1826 - accuracy30: 0.4352 - val_loss: 3.2240 - val_accuracy30: 0.4180 - 10s/epoch - 19ms/step
Epoch 9/50
512/512 - 10s - loss: 3.1725 - accuracy30: 0.4390 - val_loss: 3.2291 - val_accuracy30: 0.4159 - 10s/epoch - 20ms/step
Epoch 10/50
512/512 - 10s - loss: 3.1693 - accuracy30: 0.4401 - val_loss: 3.2341 - val_accuracy30: 0.4110 - 10s/epoch - 19ms/step
Epoch 11/50
512/512 - 10s - loss: 3.1619 - accuracy30: 0.4429 - val_loss: 3.2333 - val_accuracy30: 0.4152 - 10s/epoch - 19ms/step
Epoch 12/50
512/512 - 10s - loss: 3.1592 - accuracy30: 0.4438 - val_loss: 3.2363 - val_accuracy30: 0.4146 - 10s/epoch - 19ms/step
Epoch 13/50
512/512 - 10s - loss: 3.1543 - accuracy30: 0.4460 - val_loss: 3.2336 - val_accuracy30: 0.4130 - 10s/epoch - 19ms/step
Epoch 14/50
512/512 - 10s - loss: 3.1512 - accuracy30: 0.4475 - val_loss: 3.2420 - val_accuracy30: 0.4125 - 10s/epoch - 20ms/step
Epoch 15/50
512/512 - 10s - loss: 3.1465 - accuracy30: 0.4505 - val_loss: 3.2702 - val_accuracy30: 0.4047 - 10s/epoch - 20ms/step
Epoch 16/50
512/512 - 10s - loss: 3.1427 - accuracy30: 0.4524 - val_loss: 3.2699 - val_accuracy30: 0.4064 - 10s/epoch - 19ms/step
Epoch 17/50
512/512 - 10s - loss: 3.1390 - accuracy30: 0.4530 - val_loss: 3.2596 - val_accuracy30: 0.4082 - 10s/epoch - 20ms/step
Epoch 18/50
512/512 - 10s - loss: 3.1354 - accuracy30: 0.4549 - val_loss: 3.2699 - val_accuracy30: 0.4073 - 10s/epoch - 20ms/step
testing model: results/XRAY/W6/deepLOB_L1/h30
Evaluating performance on  test set...
1214/1214 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0782511
{'0': {'precision': 0.44611240319183093, 'recall': 0.49222806881118397, 'f1-score': 0.46803703612418773, 'support': 115737}, '1': {'precision': 0.30383411580594677, 'recall': 0.3359619306594154, 'f1-score': 0.3190913626625187, 'support': 80905}, '2': {'precision': 0.46413145740677386, 'recall': 0.3806321511551444, 'f1-score': 0.418255126667341, 'support': 114055}, 'accuracy': 0.41057042713640624, 'macro avg': {'precision': 0.40469265880151717, 'recall': 0.4029407168752479, 'f1-score': 0.4017945084846824, 'support': 310697}, 'weighted avg': {'precision': 0.4156780519992876, 'recall': 0.41057042713640624, 'f1-score': 0.4109771823292783, 'support': 310697}}
[[56969 33062 25706]
 [29307 27181 24417]
 [41425 29217 43413]]
Evaluating performance on  train set...
512/512 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0684183
{'0': {'precision': 0.4304600194170746, 'recall': 0.4705337789017341, 'f1-score': 0.44960571311448877, 'support': 44288}, '1': {'precision': 0.3990888282419227, 'recall': 0.4190372749751577, 'f1-score': 0.40881984916975733, 'support': 43273}, '2': {'precision': 0.447902352275483, 'recall': 0.38302725869259663, 'f1-score': 0.4129322337042925, 'support': 43399}, 'accuracy': 0.4245189370800244, 'macro avg': {'precision': 0.4258170666448268, 'recall': 0.4241994375231628, 'f1-score': 0.4237859319961795, 'support': 130960}, 'weighted avg': {'precision': 0.4258743004799924, 'recall': 0.4245189370800244, 'f1-score': 0.4239756045057268, 'support': 130960}}
[[20839 14115  9334]
 [13984 18133 11156]
 [13588 13188 16623]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0748621
{'0': {'precision': 0.43216112946052715, 'recall': 0.45721137375813636, 'f1-score': 0.4443334665068585, 'support': 14595}, '1': {'precision': 0.37957760124006973, 'recall': 0.4324503311258278, 'f1-score': 0.4042926426581364, 'support': 13590}, '2': {'precision': 0.4441626441953694, 'recall': 0.36285255981820613, 'f1-score': 0.399411440132426, 'support': 14962}, 'accuracy': 0.41669177463091295, 'macro avg': {'precision': 0.4186337916319887, 'recall': 0.4175047549007234, 'f1-score': 0.41601251643247367, 'support': 43147}, 'weighted avg': {'precision': 0.4197606500516851, 'recall': 0.41669177463091295, 'f1-score': 0.4161442956556199, 'support': 43147}}
[[6673 4769 3153]
 [4072 5877 3641]
 [4696 4837 5429]]
training model: results/XRAY/W6/deepLOB_L1/h50
Epoch 1/50
512/512 - 13s - loss: 3.3066 - accuracy50: 0.3683 - val_loss: 3.3437 - val_accuracy50: 0.3444 - 13s/epoch - 25ms/step
Epoch 2/50
512/512 - 9s - loss: 3.2734 - accuracy50: 0.3806 - val_loss: 3.2879 - val_accuracy50: 0.3732 - 9s/epoch - 18ms/step
Epoch 3/50
512/512 - 10s - loss: 3.2598 - accuracy50: 0.3903 - val_loss: 3.3196 - val_accuracy50: 0.3718 - 10s/epoch - 19ms/step
Epoch 4/50
512/512 - 10s - loss: 3.2480 - accuracy50: 0.3979 - val_loss: 3.2905 - val_accuracy50: 0.3731 - 10s/epoch - 19ms/step
Epoch 5/50
512/512 - 9s - loss: 3.2435 - accuracy50: 0.4010 - val_loss: 3.2855 - val_accuracy50: 0.3832 - 9s/epoch - 18ms/step
Epoch 6/50
512/512 - 10s - loss: 3.2360 - accuracy50: 0.4054 - val_loss: 3.2794 - val_accuracy50: 0.3863 - 10s/epoch - 20ms/step
Epoch 7/50
512/512 - 10s - loss: 3.2298 - accuracy50: 0.4081 - val_loss: 3.2789 - val_accuracy50: 0.3856 - 10s/epoch - 20ms/step
Epoch 8/50
512/512 - 10s - loss: 3.2262 - accuracy50: 0.4112 - val_loss: 3.2899 - val_accuracy50: 0.3856 - 10s/epoch - 20ms/step
Epoch 9/50
512/512 - 10s - loss: 3.2202 - accuracy50: 0.4152 - val_loss: 3.2938 - val_accuracy50: 0.3802 - 10s/epoch - 20ms/step
Epoch 10/50
512/512 - 10s - loss: 3.2170 - accuracy50: 0.4161 - val_loss: 3.2903 - val_accuracy50: 0.3813 - 10s/epoch - 19ms/step
Epoch 11/50
512/512 - 10s - loss: 3.2125 - accuracy50: 0.4183 - val_loss: 3.2902 - val_accuracy50: 0.3801 - 10s/epoch - 20ms/step
Epoch 12/50
512/512 - 10s - loss: 3.2098 - accuracy50: 0.4203 - val_loss: 3.2935 - val_accuracy50: 0.3817 - 10s/epoch - 20ms/step
Epoch 13/50
512/512 - 10s - loss: 3.2044 - accuracy50: 0.4228 - val_loss: 3.2943 - val_accuracy50: 0.3804 - 10s/epoch - 19ms/step
Epoch 14/50
512/512 - 9s - loss: 3.2039 - accuracy50: 0.4238 - val_loss: 3.2911 - val_accuracy50: 0.3825 - 9s/epoch - 17ms/step
Epoch 15/50
512/512 - 9s - loss: 3.2001 - accuracy50: 0.4250 - val_loss: 3.2971 - val_accuracy50: 0.3832 - 9s/epoch - 18ms/step
Epoch 16/50
512/512 - 10s - loss: 3.1972 - accuracy50: 0.4252 - val_loss: 3.2972 - val_accuracy50: 0.3857 - 10s/epoch - 19ms/step
Epoch 17/50
512/512 - 10s - loss: 3.1925 - accuracy50: 0.4292 - val_loss: 3.3042 - val_accuracy50: 0.3806 - 10s/epoch - 19ms/step
testing model: results/XRAY/W6/deepLOB_L1/h50
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0858135
{'0': {'precision': 0.4388029378185708, 'recall': 0.426857422694837, 'f1-score': 0.432747760327318, 'support': 114352}, '1': {'precision': 0.2982623985106273, 'recall': 0.2750816779147688, 'f1-score': 0.28620343146376864, 'support': 83866}, '2': {'precision': 0.43361723036606337, 'recall': 0.47074565029916693, 'f1-score': 0.45141929075958376, 'support': 112479}, 'accuracy': 0.40177729427706094, 'macro avg': {'precision': 0.3902275222317539, 'recall': 0.39089491696959094, 'f1-score': 0.3901234941835568, 'support': 310697}, 'weighted avg': {'precision': 0.3989896919290045, 'recall': 0.40177729427706094, 'f1-score': 0.3999507535555127, 'support': 310697}}
[[48812 28887 36653]
 [28288 23070 32508]
 [34139 25391 52949]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.083613
{'0': {'precision': 0.41094142345531637, 'recall': 0.4467066404152497, 'f1-score': 0.4280783002079715, 'support': 44696}, '1': {'precision': 0.35725415994212256, 'recall': 0.3011305000469087, 'f1-score': 0.3268002138111844, 'support': 42636}, '2': {'precision': 0.40839004220863123, 'recall': 0.4346749793710461, 'f1-score': 0.42112275715047076, 'support': 43628}, 'accuracy': 0.3953039095907147, 'macro avg': {'precision': 0.3921952085353568, 'recall': 0.3941707066110682, 'f1-score': 0.39200042372320887, 'support': 130960}, 'weighted avg': {'precision': 0.39261275952603325, 'recall': 0.3953039095907147, 'f1-score': 0.3927885252833681, 'support': 130960}}
[[19966 12233 12497]
 [14822 12839 14975]
 [13798 10866 18964]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0932577
{'0': {'precision': 0.3945276952011163, 'recall': 0.4494436381228834, 'f1-score': 0.42019901783406566, 'support': 14469}, '1': {'precision': 0.34665235697184843, 'recall': 0.30396699001013466, 'f1-score': 0.32390943803756705, 'support': 13814}, '2': {'precision': 0.4080131949694179, 'recall': 0.3994214208826695, 'f1-score': 0.4036715961244263, 'support': 14864}, 'accuracy': 0.38563515424015576, 'macro avg': {'precision': 0.3830644157141276, 'recall': 0.38427734967189586, 'f1-score': 0.382593350665353, 'support': 43147}, 'weighted avg': {'precision': 0.3838455746888427, 'recall': 0.38563515424015576, 'f1-score': 0.38367717734455514, 'support': 43147}}
[[6503 4067 3899]
 [4900 4199 4715]
 [5080 3847 5937]]
training model: results/XRAY/W6/deepLOB_L1/h100
Epoch 1/50
512/512 - 11s - loss: 3.3283 - accuracy100: 0.3561 - val_loss: 3.3799 - val_accuracy100: 0.3470 - 11s/epoch - 22ms/step
Epoch 2/50
512/512 - 10s - loss: 3.2981 - accuracy100: 0.3645 - val_loss: 3.3256 - val_accuracy100: 0.3485 - 10s/epoch - 19ms/step
Epoch 3/50
512/512 - 10s - loss: 3.2872 - accuracy100: 0.3663 - val_loss: 3.3090 - val_accuracy100: 0.3452 - 10s/epoch - 19ms/step
Epoch 4/50
512/512 - 10s - loss: 3.2812 - accuracy100: 0.3703 - val_loss: 3.3213 - val_accuracy100: 0.3475 - 10s/epoch - 19ms/step
Epoch 5/50
512/512 - 10s - loss: 3.2730 - accuracy100: 0.3763 - val_loss: 3.3291 - val_accuracy100: 0.3519 - 10s/epoch - 19ms/step
Epoch 6/50
512/512 - 9s - loss: 3.2669 - accuracy100: 0.3803 - val_loss: 3.3277 - val_accuracy100: 0.3494 - 9s/epoch - 18ms/step
Epoch 7/50
512/512 - 9s - loss: 3.2636 - accuracy100: 0.3837 - val_loss: 3.3286 - val_accuracy100: 0.3497 - 9s/epoch - 18ms/step
Epoch 8/50
512/512 - 10s - loss: 3.2581 - accuracy100: 0.3883 - val_loss: 3.3315 - val_accuracy100: 0.3496 - 10s/epoch - 19ms/step
Epoch 9/50
512/512 - 11s - loss: 3.2540 - accuracy100: 0.3899 - val_loss: 3.3441 - val_accuracy100: 0.3509 - 11s/epoch - 21ms/step
Epoch 10/50
512/512 - 10s - loss: 3.2508 - accuracy100: 0.3922 - val_loss: 3.3428 - val_accuracy100: 0.3520 - 10s/epoch - 20ms/step
Epoch 11/50
512/512 - 10s - loss: 3.2476 - accuracy100: 0.3965 - val_loss: 3.3442 - val_accuracy100: 0.3527 - 10s/epoch - 20ms/step
Epoch 12/50
512/512 - 10s - loss: 3.2435 - accuracy100: 0.3971 - val_loss: 3.3453 - val_accuracy100: 0.3546 - 10s/epoch - 20ms/step
Epoch 13/50
512/512 - 10s - loss: 3.2415 - accuracy100: 0.3998 - val_loss: 3.3485 - val_accuracy100: 0.3529 - 10s/epoch - 20ms/step
testing model: results/XRAY/W6/deepLOB_L1/h100
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1044883
{'0': {'precision': 0.3996622920213058, 'recall': 0.2515444499166213, 'f1-score': 0.308758570587705, 'support': 115737}, '1': {'precision': 0.2646502269990501, 'recall': 0.43995722776216645, 'f1-score': 0.33049545363265725, 'support': 80426}, '2': {'precision': 0.4039768799446962, 'recall': 0.36735816438786734, 'f1-score': 0.3847982952726741, 'support': 114534}, 'accuracy': 0.3430094271911219, 'macro avg': {'precision': 0.35609646632168407, 'recall': 0.35295328068888504, 'f1-score': 0.3413507731643455, 'support': 310697}, 'weighted avg': {'precision': 0.36630402551643987, 'recall': 0.3430094271911219, 'f1-score': 0.34241626404094583, 'support': 310697}}
[[29113 50254 36370]
 [19335 35384 25707]
 [24396 48063 42075]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1004577
{'0': {'precision': 0.3592796343432685, 'recall': 0.29871430196836957, 'f1-score': 0.3262095872368977, 'support': 43945}, '1': {'precision': 0.3439661798616449, 'recall': 0.4249762583095916, 'f1-score': 0.3802039082412914, 'support': 44226}, '2': {'precision': 0.35154973479801915, 'recall': 0.3268363364416088, 'f1-score': 0.33874288482499704, 'support': 42789}, 'accuracy': 0.3505421502748931, 'macro avg': {'precision': 0.3515985163343109, 'recall': 0.35017563223985665, 'f1-score': 0.3483854601010621, 'support': 130960}, 'weighted avg': {'precision': 0.351582570281372, 'recall': 0.3505421502748931, 'f1-score': 0.34853884892930376, 'support': 130960}}
[[13127 17993 12825]
 [12460 18795 12971]
 [10950 17854 13985]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1034303
{'0': {'precision': 0.35004468275245754, 'recall': 0.27660475955087915, 'f1-score': 0.30902134038105006, 'support': 14161}, '1': {'precision': 0.3321834743707217, 'recall': 0.42497586539787613, 'f1-score': 0.3728936620783542, 'support': 14502}, '2': {'precision': 0.34914950760966873, 'recall': 0.3231151615575808, 'f1-score': 0.33562822719449226, 'support': 14484}, 'accuracy': 0.3420863559459522, 'macro avg': {'precision': 0.3437925549109493, 'recall': 0.34156526216877864, 'f1-score': 0.33918107655129887, 'support': 43147}, 'weighted avg': {'precision': 0.3437409081975618, 'recall': 0.3420863559459522, 'f1-score': 0.33942091759059423, 'support': 43147}}
[[3917 6089 4155]
 [3770 6163 4569]
 [3503 6301 4680]]
training model: results/XRAY/W6/deepLOB_L1/h200
Epoch 1/50
512/512 - 12s - loss: 3.3226 - accuracy200: 0.3625 - val_loss: 3.3740 - val_accuracy200: 0.3404 - 12s/epoch - 24ms/step
Epoch 2/50
512/512 - 10s - loss: 3.2970 - accuracy200: 0.3666 - val_loss: 3.3540 - val_accuracy200: 0.3393 - 10s/epoch - 19ms/step
Epoch 3/50
512/512 - 10s - loss: 3.2851 - accuracy200: 0.3736 - val_loss: 3.4364 - val_accuracy200: 0.3225 - 10s/epoch - 20ms/step
Epoch 4/50
512/512 - 10s - loss: 3.2729 - accuracy200: 0.3827 - val_loss: 3.3873 - val_accuracy200: 0.3261 - 10s/epoch - 19ms/step
Epoch 5/50
512/512 - 10s - loss: 3.2696 - accuracy200: 0.3833 - val_loss: 3.3896 - val_accuracy200: 0.3412 - 10s/epoch - 20ms/step
Epoch 6/50
512/512 - 10s - loss: 3.2649 - accuracy200: 0.3836 - val_loss: 3.4270 - val_accuracy200: 0.3335 - 10s/epoch - 19ms/step
Epoch 7/50
512/512 - 10s - loss: 3.2564 - accuracy200: 0.3898 - val_loss: 3.3900 - val_accuracy200: 0.3352 - 10s/epoch - 19ms/step
Epoch 8/50
512/512 - 10s - loss: 3.2526 - accuracy200: 0.3946 - val_loss: 3.3943 - val_accuracy200: 0.3318 - 10s/epoch - 20ms/step
Epoch 9/50
512/512 - 10s - loss: 3.2448 - accuracy200: 0.4000 - val_loss: 3.3906 - val_accuracy200: 0.3375 - 10s/epoch - 20ms/step
Epoch 10/50
512/512 - 10s - loss: 3.2404 - accuracy200: 0.4044 - val_loss: 3.3962 - val_accuracy200: 0.3313 - 10s/epoch - 20ms/step
Epoch 11/50
512/512 - 10s - loss: 3.2362 - accuracy200: 0.4086 - val_loss: 3.3916 - val_accuracy200: 0.3289 - 10s/epoch - 20ms/step
Epoch 12/50
512/512 - 10s - loss: 3.2289 - accuracy200: 0.4120 - val_loss: 3.3878 - val_accuracy200: 0.3316 - 10s/epoch - 20ms/step
testing model: results/XRAY/W6/deepLOB_L1/h200
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1183687
{'0': {'precision': 0.39088405436076284, 'recall': 0.48107270296279264, 'f1-score': 0.4313141609305984, 'support': 117423}, '1': {'precision': 0.2584442352829042, 'recall': 0.2824736629640722, 'f1-score': 0.26992521433993255, 'support': 76793}, '2': {'precision': 0.40865431378270595, 'recall': 0.2885534979953812, 'f1-score': 0.33825964001227804, 'support': 116481}, 'accuracy': 0.35981036186380944, 'macro avg': {'precision': 0.352660867808791, 'recall': 0.3506999546407487, 'f1-score': 0.3464996717609363, 'support': 310697}, 'weighted avg': {'precision': 0.3648118572081716, 'recall': 0.35981036186380944, 'f1-score': 0.3565383342357031, 'support': 310697}}
[[56489 32316 28618]
 [35082 21692 20019]
 [52945 29925 33611]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1134373
{'0': {'precision': 0.34645896635639944, 'recall': 0.5594059405940595, 'f1-score': 0.4279031066658742, 'support': 45046}, '1': {'precision': 0.35475070183069074, 'recall': 0.20864631055091742, 'f1-score': 0.2627540561119897, 'support': 43001}, '2': {'precision': 0.34381831430653387, 'recall': 0.26388273949618996, 'f1-score': 0.2985932576566599, 'support': 42913}, 'accuracy': 0.3473961514966402, 'macro avg': {'precision': 0.34834266083120796, 'recall': 0.34397833021372226, 'f1-score': 0.3297501401448413, 'support': 130960}, 'weighted avg': {'precision': 0.3483162862686942, 'recall': 0.3473961514966402, 'f1-score': 0.33130377959348567, 'support': 130960}}
[[25199  8294 11553]
 [23970  8972 10059]
 [23564  8025 11324]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1167449
{'0': {'precision': 0.35459319582921073, 'recall': 0.6157404348113394, 'f1-score': 0.45002535558185025, 'support': 15133}, '1': {'precision': 0.2599968389442074, 'recall': 0.1297216307862156, 'f1-score': 0.17308501683501681, 'support': 12681}, '2': {'precision': 0.3543919559855815, 'recall': 0.24365747081458292, 'f1-score': 0.2887729468599034, 'support': 15333}, 'accuracy': 0.3406725844207013, 'macro avg': {'precision': 0.3229939969196665, 'recall': 0.3297065121373793, 'f1-score': 0.30396110642559016, 'support': 43147}, 'weighted avg': {'precision': 0.32671960062720146, 'recall': 0.3406725844207013, 'f1-score': 0.31132825917695056, 'support': 43147}}
[[9318 2314 3501]
 [7731 1645 3305]
 [9229 2368 3736]]
training model: results/XRAY/W6/deepLOB_L1/h300
Epoch 1/50
512/512 - 13s - loss: 3.3366 - accuracy300: 0.3555 - val_loss: 3.3869 - val_accuracy300: 0.3382 - 13s/epoch - 24ms/step
Epoch 2/50
512/512 - 10s - loss: 3.3086 - accuracy300: 0.3582 - val_loss: 3.3469 - val_accuracy300: 0.3335 - 10s/epoch - 19ms/step
Epoch 3/50
512/512 - 10s - loss: 3.2998 - accuracy300: 0.3572 - val_loss: 3.3514 - val_accuracy300: 0.3338 - 10s/epoch - 20ms/step
Epoch 4/50
512/512 - 10s - loss: 3.2819 - accuracy300: 0.3704 - val_loss: 3.3830 - val_accuracy300: 0.3306 - 10s/epoch - 20ms/step
Epoch 5/50
512/512 - 10s - loss: 3.2732 - accuracy300: 0.3754 - val_loss: 3.3715 - val_accuracy300: 0.3278 - 10s/epoch - 20ms/step
Epoch 6/50
512/512 - 10s - loss: 3.2669 - accuracy300: 0.3812 - val_loss: 3.3528 - val_accuracy300: 0.3284 - 10s/epoch - 19ms/step
Epoch 7/50
512/512 - 10s - loss: 3.2614 - accuracy300: 0.3866 - val_loss: 3.3925 - val_accuracy300: 0.3260 - 10s/epoch - 20ms/step
Epoch 8/50
512/512 - 10s - loss: 3.2534 - accuracy300: 0.3924 - val_loss: 3.3918 - val_accuracy300: 0.3300 - 10s/epoch - 20ms/step
Epoch 9/50
512/512 - 10s - loss: 3.2451 - accuracy300: 0.3998 - val_loss: 3.4711 - val_accuracy300: 0.3260 - 10s/epoch - 20ms/step
Epoch 10/50
512/512 - 10s - loss: 3.2404 - accuracy300: 0.4028 - val_loss: 3.5197 - val_accuracy300: 0.3252 - 10s/epoch - 20ms/step
Epoch 11/50
512/512 - 10s - loss: 3.2313 - accuracy300: 0.4068 - val_loss: 3.5235 - val_accuracy300: 0.3237 - 10s/epoch - 20ms/step
Epoch 12/50
512/512 - 10s - loss: 3.2276 - accuracy300: 0.4121 - val_loss: 3.5972 - val_accuracy300: 0.3306 - 10s/epoch - 20ms/step
testing model: results/XRAY/W6/deepLOB_L1/h300
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1131177
{'0': {'precision': 0.3620510039530204, 'recall': 0.22977366795576606, 'f1-score': 0.2811298383254103, 'support': 110413}, '1': {'precision': 0.3110062224697855, 'recall': 0.4604133890305431, 'f1-score': 0.371241349745851, 'support': 92165}, '2': {'precision': 0.38433333653283164, 'recall': 0.37034193804974147, 'f1-score': 0.377207939633164, 'support': 108119}, 'accuracy': 0.3471066666237524, 'macro avg': {'precision': 0.3524635209852125, 'recall': 0.35350966501201686, 'f1-score': 0.34319304256814176, 'support': 310697}, 'weighted avg': {'precision': 0.3546631026562402, 'recall': 0.3471066666237524, 'f1-score': 0.3412945508439024, 'support': 310697}}
[[25370 50040 35003]
 [20592 42434 29139]
 [24111 43967 40041]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1129357
{'0': {'precision': 0.34164541772911355, 'recall': 0.20704935914916825, 'f1-score': 0.25783903101652705, 'support': 44004}, '1': {'precision': 0.3426144562508199, 'recall': 0.4595724089389407, 'f1-score': 0.3925672628889223, 'support': 45464}, '2': {'precision': 0.3244435208275607, 'recall': 0.3386435939458209, 'f1-score': 0.33139150943396223, 'support': 41492}, 'accuracy': 0.3364080635308491, 'macro avg': {'precision': 0.33623446493583137, 'recall': 0.33508845401130993, 'f1-score': 0.3272659344464705, 'support': 130960}, 'weighted avg': {'precision': 0.3365317590631975, 'recall': 0.3364080635308491, 'f1-score': 0.32791480811138657, 'support': 130960}}
[[ 9111 20970 13923]
 [ 9236 20894 15334]
 [ 8321 19120 14051]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1121663
{'0': {'precision': 0.33733493397358943, 'recall': 0.20271245130572788, 'f1-score': 0.25324441240086515, 'support': 13862}, '1': {'precision': 0.33513063085142886, 'recall': 0.4550415973377704, 'f1-score': 0.3859876926551121, 'support': 15025}, '2': {'precision': 0.3297031076581576, 'recall': 0.33330995792426366, 'f1-score': 0.33149672199748914, 'support': 14260}, 'accuracy': 0.3337427862887339, 'macro avg': {'precision': 0.3340562241610587, 'recall': 0.33035466885592063, 'f1-score': 0.3235762756844888, 'support': 43147}, 'weighted avg': {'precision': 0.3340450297469104, 'recall': 0.3337427862887339, 'f1-score': 0.3253315962298201, 'support': 43147}}
[[2810 6726 4326]
 [2851 6837 5337]
 [2669 6838 4753]]
training model: results/XRAY/W6/deepLOB_L1/h500
Epoch 1/50
512/512 - 13s - loss: 3.3314 - accuracy500: 0.3606 - val_loss: 3.3701 - val_accuracy500: 0.3357 - 13s/epoch - 25ms/step
Epoch 2/50
512/512 - 10s - loss: 3.3053 - accuracy500: 0.3649 - val_loss: 3.3931 - val_accuracy500: 0.3349 - 10s/epoch - 19ms/step
Epoch 3/50
512/512 - 10s - loss: 3.2892 - accuracy500: 0.3709 - val_loss: 3.4265 - val_accuracy500: 0.3318 - 10s/epoch - 19ms/step
Epoch 4/50
512/512 - 10s - loss: 3.2772 - accuracy500: 0.3798 - val_loss: 3.3519 - val_accuracy500: 0.3368 - 10s/epoch - 20ms/step
Epoch 5/50
512/512 - 10s - loss: 3.2599 - accuracy500: 0.3896 - val_loss: 3.3512 - val_accuracy500: 0.3283 - 10s/epoch - 20ms/step
Epoch 6/50
512/512 - 10s - loss: 3.2479 - accuracy500: 0.3980 - val_loss: 3.3590 - val_accuracy500: 0.3377 - 10s/epoch - 20ms/step
Epoch 7/50
512/512 - 10s - loss: 3.2357 - accuracy500: 0.4067 - val_loss: 3.3714 - val_accuracy500: 0.3365 - 10s/epoch - 20ms/step
Epoch 8/50
512/512 - 10s - loss: 3.2270 - accuracy500: 0.4126 - val_loss: 3.3591 - val_accuracy500: 0.3429 - 10s/epoch - 19ms/step
Epoch 9/50
512/512 - 10s - loss: 3.2191 - accuracy500: 0.4186 - val_loss: 3.4259 - val_accuracy500: 0.3375 - 10s/epoch - 20ms/step
Epoch 10/50
512/512 - 10s - loss: 3.2112 - accuracy500: 0.4244 - val_loss: 3.4397 - val_accuracy500: 0.3361 - 10s/epoch - 20ms/step
Epoch 11/50
512/512 - 10s - loss: 3.2011 - accuracy500: 0.4298 - val_loss: 3.5265 - val_accuracy500: 0.3404 - 10s/epoch - 20ms/step
Epoch 12/50
512/512 - 10s - loss: 3.1977 - accuracy500: 0.4307 - val_loss: 3.5292 - val_accuracy500: 0.3430 - 10s/epoch - 19ms/step
Epoch 13/50
512/512 - 10s - loss: 3.1858 - accuracy500: 0.4341 - val_loss: 3.5471 - val_accuracy500: 0.3332 - 10s/epoch - 20ms/step
Epoch 14/50
512/512 - 10s - loss: 3.1817 - accuracy500: 0.4357 - val_loss: 3.5453 - val_accuracy500: 0.3413 - 10s/epoch - 19ms/step
Epoch 15/50
512/512 - 10s - loss: 3.1805 - accuracy500: 0.4375 - val_loss: 3.5492 - val_accuracy500: 0.3437 - 10s/epoch - 19ms/step
testing model: results/XRAY/W6/deepLOB_L1/h500
Evaluating performance on  test set...
1214/1214 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1154722
{'0': {'precision': 0.35507899159663864, 'recall': 0.22760296817229878, 'f1-score': 0.2773967206915748, 'support': 116031}, '1': {'precision': 0.28496430275935286, 'recall': 0.34726821683343423, 'f1-score': 0.31304636257610285, 'support': 84249}, '2': {'precision': 0.3719632181844029, 'recall': 0.45023864078900894, 'f1-score': 0.4073749334207399, 'support': 110417}, 'accuracy': 0.3391728919172055, 'macro avg': {'precision': 0.33733550418013153, 'recall': 0.341703275264914, 'f1-score': 0.3326060055628059, 'support': 310697}, 'weighted avg': {'precision': 0.3420669999368823, 'recall': 0.3391728919172055, 'f1-score': 0.3332558084653409, 'support': 310697}}
[[26409 39495 50127]
 [21180 29257 33812]
 [26786 33917 49714]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1150404
{'0': {'precision': 0.3714069795687026, 'recall': 0.2926440252642324, 'f1-score': 0.3273544734400647, 'support': 47023}, '1': {'precision': 0.305622060709705, 'recall': 0.3542017639480725, 'f1-score': 0.32812356559258243, 'support': 40364}, '2': {'precision': 0.3355471153642131, 'recall': 0.36293117297408944, 'f1-score': 0.34870234393949423, 'support': 43573}, 'accuracy': 0.33500305436774586, 'macro avg': {'precision': 0.3375253852142069, 'recall': 0.33659232072879813, 'f1-score': 0.3347267943240471, 'support': 130960}, 'weighted avg': {'precision': 0.3391997076703611, 'recall': 0.33500305436774586, 'f1-score': 0.33469438178548216, 'support': 130960}}
[[13761 16888 16374]
 [11126 14297 14941]
 [12164 15595 15814]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1143144
{'0': {'precision': 0.342349364720555, 'recall': 0.3051271363067945, 'f1-score': 0.32266833192521027, 'support': 14394}, '1': {'precision': 0.3073904077695736, 'recall': 0.33905642380218654, 'f1-score': 0.32244784034610285, 'support': 13629}, '2': {'precision': 0.3502126267582597, 'recall': 0.3539407564136472, 'f1-score': 0.35206682232233877, 'support': 15124}, 'accuracy': 0.3329547824877743, 'macro avg': {'precision': 0.3333174664161294, 'recall': 0.33270810550754276, 'f1-score': 0.3323943315312173, 'support': 43147}, 'weighted avg': {'precision': 0.3340630029983801, 'recall': 0.3329547824877743, 'f1-score': 0.33290352067609713, 'support': 43147}}
[[4392 5018 4984]
 [4060 4621 4948]
 [4377 5394 5353]]
training model: results/XRAY/W6/deepLOB_L1/h1000
Epoch 1/50
512/512 - 13s - loss: 3.3327 - accuracy1000: 0.3653 - val_loss: 3.4994 - val_accuracy1000: 0.3375 - 13s/epoch - 25ms/step
Epoch 2/50
512/512 - 10s - loss: 3.2843 - accuracy1000: 0.3817 - val_loss: 3.5402 - val_accuracy1000: 0.3342 - 10s/epoch - 19ms/step
Epoch 3/50
512/512 - 10s - loss: 3.2516 - accuracy1000: 0.3960 - val_loss: 3.8223 - val_accuracy1000: 0.3125 - 10s/epoch - 20ms/step
Epoch 4/50
512/512 - 10s - loss: 3.2263 - accuracy1000: 0.4064 - val_loss: 3.7632 - val_accuracy1000: 0.3187 - 10s/epoch - 20ms/step
Epoch 5/50
512/512 - 10s - loss: 3.2088 - accuracy1000: 0.4166 - val_loss: 3.7481 - val_accuracy1000: 0.3175 - 10s/epoch - 20ms/step
Epoch 6/50
512/512 - 10s - loss: 3.1882 - accuracy1000: 0.4230 - val_loss: 3.8725 - val_accuracy1000: 0.3176 - 10s/epoch - 20ms/step
Epoch 7/50
512/512 - 10s - loss: 3.1775 - accuracy1000: 0.4318 - val_loss: 3.6958 - val_accuracy1000: 0.3153 - 10s/epoch - 20ms/step
Epoch 8/50
512/512 - 10s - loss: 3.1687 - accuracy1000: 0.4328 - val_loss: 3.7639 - val_accuracy1000: 0.3178 - 10s/epoch - 20ms/step
Epoch 9/50
512/512 - 10s - loss: 3.1510 - accuracy1000: 0.4429 - val_loss: 3.8149 - val_accuracy1000: 0.3165 - 10s/epoch - 19ms/step
Epoch 10/50
512/512 - 9s - loss: 3.1417 - accuracy1000: 0.4467 - val_loss: 3.9273 - val_accuracy1000: 0.3167 - 9s/epoch - 18ms/step
Epoch 11/50
512/512 - 10s - loss: 3.1296 - accuracy1000: 0.4512 - val_loss: 3.9474 - val_accuracy1000: 0.3169 - 10s/epoch - 20ms/step
testing model: results/XRAY/W6/deepLOB_L1/h1000
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1552266
{'0': {'precision': 0.3677184657967576, 'recall': 0.20406748121620671, 'f1-score': 0.2624736809424622, 'support': 113928}, '1': {'precision': 0.29676238473405125, 'recall': 0.6450698150843711, 'f1-score': 0.4065107493273177, 'support': 92745}, '2': {'precision': 0.3946112092080309, 'recall': 0.17401753441513496, 'f1-score': 0.2415258477487875, 'support': 104024}, 'accuracy': 0.3256484613626781, 'macro avg': {'precision': 0.3530306865796133, 'recall': 0.34105161023857095, 'f1-score': 0.3035034260061891, 'support': 310697}, 'weighted avg': {'precision': 0.3555415506751234, 'recall': 0.3256484613626781, 'f1-score': 0.29845613493208745, 'support': 310697}}
[[23249 75579 15100]
 [20247 59827 12671]
 [19729 66193 18102]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1336346
{'0': {'precision': 0.3442142496210207, 'recall': 0.23023365854757666, 'f1-score': 0.27591607485215885, 'support': 44381}, '1': {'precision': 0.35890110419981675, 'recall': 0.641120609832253, 'f1-score': 0.46018779705552765, 'support': 46439}, '2': {'precision': 0.3247448004803756, 'recall': 0.14820627802690584, 'f1-score': 0.20352725842043143, 'support': 40140}, 'accuracy': 0.3507941356139279, 'macro avg': {'precision': 0.3426200514337377, 'recall': 0.3398535154689118, 'f1-score': 0.3132103767760393, 'support': 130960}, 'weighted avg': {'precision': 0.343454774600245, 'recall': 0.3507941356139279, 'f1-score': 0.3190720569522864, 'support': 130960}}
[[10218 28272  5891]
 [10187 29773  6479]
 [ 9280 24911  5949]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1493192
{'0': {'precision': 0.3223094688221709, 'recall': 0.2625874915330774, 'f1-score': 0.28939946914399467, 'support': 13287}, '1': {'precision': 0.3546065782300563, 'recall': 0.6243281289992322, 'f1-score': 0.45230976056370675, 'support': 15628}, '2': {'precision': 0.3080923653006033, 'recall': 0.10406127037661608, 'f1-score': 0.15557539786753508, 'support': 14232}, 'accuracy': 0.34132152872737387, 'macro avg': {'precision': 0.3283361374509435, 'recall': 0.33032563030297524, 'f1-score': 0.29909487585841216, 'support': 43147}, 'weighted avg': {'precision': 0.32931809997862405, 'recall': 0.34132152872737387, 'f1-score': 0.3042644157660237, 'support': 43147}}
[[3489 8404 1394]
 [3939 9757 1932]
 [3397 9354 1481]]
training model: results/XRAY/W6/deepOF_L1/h10
Epoch 1/50
512/512 - 11s - loss: 3.2687 - accuracy10: 0.4067 - val_loss: 3.2582 - val_accuracy10: 0.4245 - 11s/epoch - 22ms/step
Epoch 2/50
512/512 - 9s - loss: 3.2259 - accuracy10: 0.4243 - val_loss: 3.2414 - val_accuracy10: 0.4286 - 9s/epoch - 18ms/step
Epoch 3/50
512/512 - 8s - loss: 3.2110 - accuracy10: 0.4288 - val_loss: 3.2354 - val_accuracy10: 0.4286 - 8s/epoch - 16ms/step
Epoch 4/50
512/512 - 9s - loss: 3.2038 - accuracy10: 0.4324 - val_loss: 3.2298 - val_accuracy10: 0.4320 - 9s/epoch - 17ms/step
Epoch 5/50
512/512 - 10s - loss: 3.1953 - accuracy10: 0.4326 - val_loss: 3.2269 - val_accuracy10: 0.4339 - 10s/epoch - 19ms/step
Epoch 6/50
512/512 - 9s - loss: 3.1920 - accuracy10: 0.4341 - val_loss: 3.2250 - val_accuracy10: 0.4325 - 9s/epoch - 18ms/step
Epoch 7/50
512/512 - 9s - loss: 3.1858 - accuracy10: 0.4345 - val_loss: 3.2223 - val_accuracy10: 0.4348 - 9s/epoch - 18ms/step
Epoch 8/50
512/512 - 9s - loss: 3.1819 - accuracy10: 0.4357 - val_loss: 3.2195 - val_accuracy10: 0.4317 - 9s/epoch - 17ms/step
Epoch 9/50
512/512 - 9s - loss: 3.1789 - accuracy10: 0.4375 - val_loss: 3.2186 - val_accuracy10: 0.4353 - 9s/epoch - 18ms/step
Epoch 10/50
512/512 - 9s - loss: 3.1749 - accuracy10: 0.4387 - val_loss: 3.2162 - val_accuracy10: 0.4344 - 9s/epoch - 17ms/step
Epoch 11/50
512/512 - 9s - loss: 3.1727 - accuracy10: 0.4393 - val_loss: 3.2156 - val_accuracy10: 0.4355 - 9s/epoch - 18ms/step
Epoch 12/50
512/512 - 9s - loss: 3.1683 - accuracy10: 0.4402 - val_loss: 3.2148 - val_accuracy10: 0.4353 - 9s/epoch - 18ms/step
Epoch 13/50
512/512 - 9s - loss: 3.1659 - accuracy10: 0.4418 - val_loss: 3.2134 - val_accuracy10: 0.4341 - 9s/epoch - 18ms/step
Epoch 14/50
512/512 - 9s - loss: 3.1629 - accuracy10: 0.4415 - val_loss: 3.2156 - val_accuracy10: 0.4382 - 9s/epoch - 17ms/step
Epoch 15/50
512/512 - 9s - loss: 3.1614 - accuracy10: 0.4435 - val_loss: 3.2111 - val_accuracy10: 0.4370 - 9s/epoch - 18ms/step
Epoch 16/50
512/512 - 10s - loss: 3.1568 - accuracy10: 0.4444 - val_loss: 3.2143 - val_accuracy10: 0.4346 - 10s/epoch - 19ms/step
Epoch 17/50
512/512 - 9s - loss: 3.1545 - accuracy10: 0.4449 - val_loss: 3.2106 - val_accuracy10: 0.4350 - 9s/epoch - 18ms/step
Epoch 18/50
512/512 - 9s - loss: 3.1530 - accuracy10: 0.4454 - val_loss: 3.2110 - val_accuracy10: 0.4363 - 9s/epoch - 18ms/step
Epoch 19/50
512/512 - 9s - loss: 3.1522 - accuracy10: 0.4483 - val_loss: 3.2137 - val_accuracy10: 0.4376 - 9s/epoch - 17ms/step
Epoch 20/50
512/512 - 9s - loss: 3.1472 - accuracy10: 0.4474 - val_loss: 3.2132 - val_accuracy10: 0.4377 - 9s/epoch - 18ms/step
Epoch 21/50
512/512 - 9s - loss: 3.1451 - accuracy10: 0.4482 - val_loss: 3.2122 - val_accuracy10: 0.4362 - 9s/epoch - 17ms/step
Epoch 22/50
512/512 - 9s - loss: 3.1437 - accuracy10: 0.4484 - val_loss: 3.2117 - val_accuracy10: 0.4369 - 9s/epoch - 18ms/step
Epoch 23/50
512/512 - 9s - loss: 3.1395 - accuracy10: 0.4505 - val_loss: 3.2144 - val_accuracy10: 0.4359 - 9s/epoch - 18ms/step
Epoch 24/50
512/512 - 9s - loss: 3.1393 - accuracy10: 0.4515 - val_loss: 3.2139 - val_accuracy10: 0.4336 - 9s/epoch - 18ms/step
Epoch 25/50
512/512 - 9s - loss: 3.1368 - accuracy10: 0.4520 - val_loss: 3.2150 - val_accuracy10: 0.4369 - 9s/epoch - 18ms/step
Epoch 26/50
512/512 - 9s - loss: 3.1338 - accuracy10: 0.4540 - val_loss: 3.2168 - val_accuracy10: 0.4327 - 9s/epoch - 18ms/step
Epoch 27/50
512/512 - 9s - loss: 3.1311 - accuracy10: 0.4546 - val_loss: 3.2168 - val_accuracy10: 0.4379 - 9s/epoch - 18ms/step
testing model: results/XRAY/W6/deepOF_L1/h10
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.083119
{'0': {'precision': 0.382595686573758, 'recall': 0.4170588621587899, 'f1-score': 0.39908463463935234, 'support': 91366}, '1': {'precision': 0.4672510681287227, 'recall': 0.34690720441281025, 'f1-score': 0.39818489173471083, 'support': 127991}, '2': {'precision': 0.3621779960368743, 'recall': 0.46026167405704277, 'f1-score': 0.40537113377208844, 'support': 91335}, 'accuracy': 0.4008600157068737, 'macro avg': {'precision': 0.40400825024645165, 'recall': 0.4080759135428809, 'f1-score': 0.4008802200487172, 'support': 310692}, 'weighted avg': {'precision': 0.4114676149639811, 'recall': 0.4008600157068737, 'f1-score': 0.400562041216221, 'support': 310692}}
[[38105 25316 27945]
 [37503 44401 46087]
 [23988 25309 42038]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0496304
{'0': {'precision': 0.3803364252687714, 'recall': 0.3786073304342915, 'f1-score': 0.37946990816081055, 'support': 35414}, '1': {'precision': 0.5629198555416254, 'recall': 0.49451777817960646, 'f1-score': 0.5265064669128585, 'support': 60833}, '2': {'precision': 0.3705578952349406, 'recall': 0.45118543485149654, 'f1-score': 0.40691617194299734, 'support': 34713}, 'accuracy': 0.45168753817959684, 'macro avg': {'precision': 0.43793805868177915, 'recall': 0.4414368478217982, 'f1-score': 0.43763084900555543, 'support': 130960}, 'weighted avg': {'precision': 0.4625573759462619, 'recall': 0.45168753817959684, 'f1-score': 0.4550457873089045, 'support': 130960}}
[[13408 12184  9822]
 [13968 30083 16782]
 [ 7877 11174 15662]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0615414
{'0': {'precision': 0.3664662186062964, 'recall': 0.357889282321444, 'f1-score': 0.36212697164329094, 'support': 11579}, '1': {'precision': 0.5472590882862088, 'recall': 0.47874810701665826, 'f1-score': 0.5107162089391492, 'support': 19810}, '2': {'precision': 0.3548387096774194, 'recall': 0.43786680275580503, 'f1-score': 0.3920045688178184, 'support': 11757}, 'accuracy': 0.4351735966254114, 'macro avg': {'precision': 0.42285467218997486, 'recall': 0.4248347306979691, 'f1-score': 0.42161591646675284, 'support': 43146}, 'weighted avg': {'precision': 0.4463068092956363, 'recall': 0.4351735966254114, 'f1-score': 0.4384914944452163, 'support': 43146}}
[[4144 3979 3456]
 [4422 9484 5904]
 [2742 3867 5148]]
training model: results/XRAY/W6/deepOF_L1/h20
Epoch 1/50
512/512 - 12s - loss: 3.2893 - accuracy20: 0.3840 - val_loss: 3.2624 - val_accuracy20: 0.3990 - 12s/epoch - 23ms/step
Epoch 2/50
512/512 - 9s - loss: 3.2511 - accuracy20: 0.4053 - val_loss: 3.2535 - val_accuracy20: 0.4063 - 9s/epoch - 18ms/step
Epoch 3/50
512/512 - 9s - loss: 3.2362 - accuracy20: 0.4109 - val_loss: 3.2440 - val_accuracy20: 0.4104 - 9s/epoch - 18ms/step
Epoch 4/50
512/512 - 9s - loss: 3.2288 - accuracy20: 0.4142 - val_loss: 3.2410 - val_accuracy20: 0.4100 - 9s/epoch - 18ms/step
Epoch 5/50
512/512 - 10s - loss: 3.2208 - accuracy20: 0.4161 - val_loss: 3.2397 - val_accuracy20: 0.4091 - 10s/epoch - 19ms/step
Epoch 6/50
512/512 - 10s - loss: 3.2182 - accuracy20: 0.4185 - val_loss: 3.2361 - val_accuracy20: 0.4116 - 10s/epoch - 20ms/step
Epoch 7/50
512/512 - 9s - loss: 3.2125 - accuracy20: 0.4196 - val_loss: 3.2349 - val_accuracy20: 0.4107 - 9s/epoch - 18ms/step
Epoch 8/50
512/512 - 9s - loss: 3.2082 - accuracy20: 0.4215 - val_loss: 3.2334 - val_accuracy20: 0.4119 - 9s/epoch - 18ms/step
Epoch 9/50
512/512 - 10s - loss: 3.2051 - accuracy20: 0.4227 - val_loss: 3.2322 - val_accuracy20: 0.4117 - 10s/epoch - 19ms/step
Epoch 10/50
512/512 - 9s - loss: 3.2011 - accuracy20: 0.4247 - val_loss: 3.2324 - val_accuracy20: 0.4106 - 9s/epoch - 18ms/step
Epoch 11/50
512/512 - 9s - loss: 3.1998 - accuracy20: 0.4235 - val_loss: 3.2330 - val_accuracy20: 0.4111 - 9s/epoch - 17ms/step
Epoch 12/50
512/512 - 9s - loss: 3.1957 - accuracy20: 0.4249 - val_loss: 3.2280 - val_accuracy20: 0.4154 - 9s/epoch - 17ms/step
Epoch 13/50
512/512 - 9s - loss: 3.1922 - accuracy20: 0.4276 - val_loss: 3.2310 - val_accuracy20: 0.4127 - 9s/epoch - 18ms/step
Epoch 14/50
512/512 - 9s - loss: 3.1891 - accuracy20: 0.4281 - val_loss: 3.2308 - val_accuracy20: 0.4132 - 9s/epoch - 18ms/step
Epoch 15/50
512/512 - 9s - loss: 3.1875 - accuracy20: 0.4274 - val_loss: 3.2301 - val_accuracy20: 0.4113 - 9s/epoch - 18ms/step
Epoch 16/50
512/512 - 8s - loss: 3.1861 - accuracy20: 0.4294 - val_loss: 3.2296 - val_accuracy20: 0.4136 - 8s/epoch - 16ms/step
Epoch 17/50
512/512 - 9s - loss: 3.1825 - accuracy20: 0.4303 - val_loss: 3.2327 - val_accuracy20: 0.4110 - 9s/epoch - 18ms/step
Epoch 18/50
512/512 - 9s - loss: 3.1805 - accuracy20: 0.4313 - val_loss: 3.2294 - val_accuracy20: 0.4142 - 9s/epoch - 17ms/step
Epoch 19/50
512/512 - 9s - loss: 3.1786 - accuracy20: 0.4310 - val_loss: 3.2314 - val_accuracy20: 0.4132 - 9s/epoch - 18ms/step
Epoch 20/50
512/512 - 9s - loss: 3.1760 - accuracy20: 0.4338 - val_loss: 3.2286 - val_accuracy20: 0.4135 - 9s/epoch - 18ms/step
Epoch 21/50
512/512 - 10s - loss: 3.1711 - accuracy20: 0.4355 - val_loss: 3.2338 - val_accuracy20: 0.4120 - 10s/epoch - 19ms/step
Epoch 22/50
512/512 - 9s - loss: 3.1693 - accuracy20: 0.4346 - val_loss: 3.2313 - val_accuracy20: 0.4137 - 9s/epoch - 17ms/step
testing model: results/XRAY/W6/deepOF_L1/h20
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0830463
{'0': {'precision': 0.44528169164197556, 'recall': 0.378395268587369, 'f1-score': 0.40912273486194956, 'support': 110411}, '1': {'precision': 0.320547877100527, 'recall': 0.28578710578223, 'f1-score': 0.30217108577722057, 'support': 90242}, '2': {'precision': 0.41259438457591086, 'recall': 0.511473204954607, 'f1-score': 0.4567435858940389, 'support': 110039}, 'accuracy': 0.39862951089825294, 'macro avg': {'precision': 0.3928079844394711, 'recall': 0.39188519310806863, 'f1-score': 0.38934580217773634, 'support': 310692}, 'weighted avg': {'precision': 0.3974751582452608, 'recall': 0.39862951089825294, 'f1-score': 0.39492417200875723, 'support': 310692}}
[[41779 27924 40708]
 [25032 25790 39420]
 [27015 26742 56282]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0680128
{'0': {'precision': 0.4379995004995005, 'recall': 0.3248286719762919, 'f1-score': 0.37301924917579493, 'support': 43192}, '1': {'precision': 0.4342063340342828, 'recall': 0.447416227100615, 'f1-score': 0.4407123145912384, 'support': 45689}, '2': {'precision': 0.40268857644313294, 'recall': 0.49618574585897957, 'f1-score': 0.4445745677540244, 'support': 42079}, 'accuracy': 0.4226557727550397, 'macro avg': {'precision': 0.4249648036589721, 'recall': 0.4228102149786288, 'f1-score': 0.4194353771736859, 'support': 130960}, 'weighted avg': {'precision': 0.42533033162352907, 'recall': 0.4226557727550397, 'f1-score': 0.41962740980667085, 'support': 130960}}
[[14030 13955 15207]
 [ 9484 20442 15763]
 [ 8518 12682 20879]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0754482
{'0': {'precision': 0.42585990943250795, 'recall': 0.31367539564260877, 'f1-score': 0.36125868410298323, 'support': 14091}, '1': {'precision': 0.42007758159443553, 'recall': 0.4288835780129737, 'f1-score': 0.424434908943474, 'support': 14645}, '2': {'precision': 0.4034240808307606, 'recall': 0.49875086745315755, 'f1-score': 0.44605120248254465, 'support': 14410}, 'accuracy': 0.414592314467158, 'macro avg': {'precision': 0.41645385728590134, 'recall': 0.41376994703624664, 'f1-score': 0.4105815985096673, 'support': 43146}, 'weighted avg': {'precision': 0.4164040506891772, 'recall': 0.414592314467158, 'f1-score': 0.41102172129388087, 'support': 43146}}
[[4420 4428 5243]
 [2979 6281 5385]
 [2980 4243 7187]]
training model: results/XRAY/W6/deepOF_L1/h30
Epoch 1/50
512/512 - 12s - loss: 3.2988 - accuracy30: 0.3730 - val_loss: 3.2710 - val_accuracy30: 0.3907 - 12s/epoch - 22ms/step
Epoch 2/50
512/512 - 10s - loss: 3.2633 - accuracy30: 0.3964 - val_loss: 3.2627 - val_accuracy30: 0.3941 - 10s/epoch - 19ms/step
Epoch 3/50
512/512 - 9s - loss: 3.2479 - accuracy30: 0.4014 - val_loss: 3.2551 - val_accuracy30: 0.3987 - 9s/epoch - 18ms/step
Epoch 4/50
512/512 - 9s - loss: 3.2417 - accuracy30: 0.4041 - val_loss: 3.2505 - val_accuracy30: 0.4011 - 9s/epoch - 17ms/step
Epoch 5/50
512/512 - 9s - loss: 3.2353 - accuracy30: 0.4076 - val_loss: 3.2463 - val_accuracy30: 0.4033 - 9s/epoch - 18ms/step
Epoch 6/50
512/512 - 9s - loss: 3.2312 - accuracy30: 0.4094 - val_loss: 3.2467 - val_accuracy30: 0.4052 - 9s/epoch - 18ms/step
Epoch 7/50
512/512 - 8s - loss: 3.2268 - accuracy30: 0.4109 - val_loss: 3.2443 - val_accuracy30: 0.4062 - 8s/epoch - 16ms/step
Epoch 8/50
512/512 - 9s - loss: 3.2231 - accuracy30: 0.4132 - val_loss: 3.2426 - val_accuracy30: 0.4065 - 9s/epoch - 17ms/step
Epoch 9/50
512/512 - 9s - loss: 3.2202 - accuracy30: 0.4143 - val_loss: 3.2413 - val_accuracy30: 0.4068 - 9s/epoch - 18ms/step
Epoch 10/50
512/512 - 9s - loss: 3.2187 - accuracy30: 0.4147 - val_loss: 3.2417 - val_accuracy30: 0.4079 - 9s/epoch - 17ms/step
Epoch 11/50
512/512 - 9s - loss: 3.2158 - accuracy30: 0.4147 - val_loss: 3.2392 - val_accuracy30: 0.4076 - 9s/epoch - 17ms/step
Epoch 12/50
512/512 - 9s - loss: 3.2121 - accuracy30: 0.4165 - val_loss: 3.2402 - val_accuracy30: 0.4066 - 9s/epoch - 17ms/step
Epoch 13/50
512/512 - 9s - loss: 3.2091 - accuracy30: 0.4179 - val_loss: 3.2408 - val_accuracy30: 0.4065 - 9s/epoch - 18ms/step
Epoch 14/50
512/512 - 9s - loss: 3.2067 - accuracy30: 0.4191 - val_loss: 3.2383 - val_accuracy30: 0.4085 - 9s/epoch - 18ms/step
Epoch 15/50
512/512 - 9s - loss: 3.2058 - accuracy30: 0.4211 - val_loss: 3.2421 - val_accuracy30: 0.4041 - 9s/epoch - 18ms/step
Epoch 16/50
512/512 - 9s - loss: 3.2041 - accuracy30: 0.4197 - val_loss: 3.2387 - val_accuracy30: 0.4072 - 9s/epoch - 18ms/step
Epoch 17/50
512/512 - 9s - loss: 3.2023 - accuracy30: 0.4211 - val_loss: 3.2382 - val_accuracy30: 0.4072 - 9s/epoch - 18ms/step
Epoch 18/50
512/512 - 9s - loss: 3.1993 - accuracy30: 0.4210 - val_loss: 3.2410 - val_accuracy30: 0.4077 - 9s/epoch - 18ms/step
Epoch 19/50
512/512 - 9s - loss: 3.1966 - accuracy30: 0.4234 - val_loss: 3.2379 - val_accuracy30: 0.4081 - 9s/epoch - 18ms/step
Epoch 20/50
512/512 - 10s - loss: 3.1946 - accuracy30: 0.4237 - val_loss: 3.2412 - val_accuracy30: 0.4073 - 10s/epoch - 19ms/step
Epoch 21/50
512/512 - 9s - loss: 3.1926 - accuracy30: 0.4245 - val_loss: 3.2410 - val_accuracy30: 0.4088 - 9s/epoch - 17ms/step
Epoch 22/50
512/512 - 9s - loss: 3.1910 - accuracy30: 0.4250 - val_loss: 3.2413 - val_accuracy30: 0.4069 - 9s/epoch - 17ms/step
Epoch 23/50
512/512 - 9s - loss: 3.1886 - accuracy30: 0.4258 - val_loss: 3.2421 - val_accuracy30: 0.4065 - 9s/epoch - 17ms/step
Epoch 24/50
512/512 - 9s - loss: 3.1865 - accuracy30: 0.4272 - val_loss: 3.2445 - val_accuracy30: 0.4077 - 9s/epoch - 17ms/step
Epoch 25/50
512/512 - 9s - loss: 3.1839 - accuracy30: 0.4288 - val_loss: 3.2444 - val_accuracy30: 0.4082 - 9s/epoch - 17ms/step
Epoch 26/50
512/512 - 9s - loss: 3.1822 - accuracy30: 0.4281 - val_loss: 3.2407 - val_accuracy30: 0.4104 - 9s/epoch - 17ms/step
Epoch 27/50
512/512 - 9s - loss: 3.1779 - accuracy30: 0.4299 - val_loss: 3.2452 - val_accuracy30: 0.4083 - 9s/epoch - 17ms/step
Epoch 28/50
512/512 - 9s - loss: 3.1776 - accuracy30: 0.4314 - val_loss: 3.2460 - val_accuracy30: 0.4087 - 9s/epoch - 17ms/step
Epoch 29/50
512/512 - 8s - loss: 3.1743 - accuracy30: 0.4323 - val_loss: 3.2481 - val_accuracy30: 0.4070 - 8s/epoch - 16ms/step
testing model: results/XRAY/W6/deepOF_L1/h30
Evaluating performance on  test set...
1214/1214 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0785013
{'0': {'precision': 0.4597127769442117, 'recall': 0.4076899814230786, 'f1-score': 0.4321413361541949, 'support': 115735}, '1': {'precision': 0.2825838667693697, 'recall': 0.131501532680708, 'f1-score': 0.1794809072735401, 'support': 80904}, '2': {'precision': 0.41779290513776, 'recall': 0.6242185650530894, 'f1-score': 0.5005589577371704, 'support': 114053}, 'accuracy': 0.41525691038069856, 'macro avg': {'precision': 0.3866965162837805, 'recall': 0.3878033597189587, 'f1-score': 0.37072706705496844, 'support': 310692}, 'weighted avg': {'precision': 0.3982000103202669, 'recall': 0.41525691038069856, 'f1-score': 0.391464381666286, 'support': 310692}}
[[47184 13850 54701]
 [25755 10639 44510]
 [29699 13160 71194]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.071722
{'0': {'precision': 0.4429355832328914, 'recall': 0.3736584043202205, 'f1-score': 0.40535836846749684, 'support': 44257}, '1': {'precision': 0.4191378460238078, 'recall': 0.27505951417939767, 'f1-score': 0.3321471930338678, 'support': 43267}, '2': {'precision': 0.3962533151415738, 'recall': 0.5950824201123492, 'f1-score': 0.4757286020595029, 'support': 43436}, 'accuracy': 0.4145235186316433, 'macro avg': {'precision': 0.4194422481327577, 'recall': 0.4146001128706558, 'f1-score': 0.40441138785362246, 'support': 130960}, 'weighted avg': {'precision': 0.4195899227820675, 'recall': 0.4145235186316433, 'f1-score': 0.4045105793625453, 'support': 130960}}
[[16537  8551 19169]
 [11152 11901 20214]
 [ 9646  7942 25848]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0800601
{'0': {'precision': 0.42975900579393733, 'recall': 0.35014024765683793, 'f1-score': 0.38588554625650306, 'support': 14617}, '1': {'precision': 0.3995381062355658, 'recall': 0.25512461288895444, 'f1-score': 0.31140311403114035, 'support': 13562}, '2': {'precision': 0.39845860831819996, 'recall': 0.6010556557760406, 'f1-score': 0.47922437673130197, 'support': 14967}, 'accuracy': 0.40731469892921707, 'macro avg': {'precision': 0.40925190678256773, 'recall': 0.4021068387739444, 'f1-score': 0.39217101233964846, 'support': 43146}, 'weighted avg': {'precision': 0.40940187213542917, 'recall': 0.40731469892921707, 'f1-score': 0.39485211395399405, 'support': 43146}}
[[5118 2637 6862]
 [3383 3460 6719]
 [3408 2563 8996]]
training model: results/XRAY/W6/deepOF_L1/h50
Epoch 1/50
512/512 - 11s - loss: 3.3078 - accuracy50: 0.3623 - val_loss: 3.2822 - val_accuracy50: 0.3738 - 11s/epoch - 21ms/step
Epoch 2/50
512/512 - 9s - loss: 3.2773 - accuracy50: 0.3804 - val_loss: 3.2735 - val_accuracy50: 0.3809 - 9s/epoch - 18ms/step
Epoch 3/50
512/512 - 9s - loss: 3.2633 - accuracy50: 0.3879 - val_loss: 3.2674 - val_accuracy50: 0.3879 - 9s/epoch - 18ms/step
Epoch 4/50
512/512 - 9s - loss: 3.2574 - accuracy50: 0.3897 - val_loss: 3.2638 - val_accuracy50: 0.3895 - 9s/epoch - 18ms/step
Epoch 5/50
512/512 - 9s - loss: 3.2517 - accuracy50: 0.3928 - val_loss: 3.2601 - val_accuracy50: 0.3925 - 9s/epoch - 18ms/step
Epoch 6/50
512/512 - 9s - loss: 3.2469 - accuracy50: 0.3946 - val_loss: 3.2606 - val_accuracy50: 0.3919 - 9s/epoch - 17ms/step
Epoch 7/50
512/512 - 9s - loss: 3.2440 - accuracy50: 0.3975 - val_loss: 3.2581 - val_accuracy50: 0.3940 - 9s/epoch - 18ms/step
Epoch 8/50
512/512 - 9s - loss: 3.2406 - accuracy50: 0.3996 - val_loss: 3.2582 - val_accuracy50: 0.3944 - 9s/epoch - 17ms/step
Epoch 9/50
512/512 - 9s - loss: 3.2390 - accuracy50: 0.4010 - val_loss: 3.2574 - val_accuracy50: 0.3937 - 9s/epoch - 17ms/step
Epoch 10/50
512/512 - 9s - loss: 3.2359 - accuracy50: 0.4029 - val_loss: 3.2573 - val_accuracy50: 0.3938 - 9s/epoch - 17ms/step
Epoch 11/50
512/512 - 9s - loss: 3.2346 - accuracy50: 0.4003 - val_loss: 3.2574 - val_accuracy50: 0.3948 - 9s/epoch - 18ms/step
Epoch 12/50
512/512 - 9s - loss: 3.2314 - accuracy50: 0.4043 - val_loss: 3.2565 - val_accuracy50: 0.3939 - 9s/epoch - 18ms/step
Epoch 13/50
512/512 - 9s - loss: 3.2299 - accuracy50: 0.4053 - val_loss: 3.2553 - val_accuracy50: 0.3951 - 9s/epoch - 18ms/step
Epoch 14/50
512/512 - 9s - loss: 3.2282 - accuracy50: 0.4052 - val_loss: 3.2564 - val_accuracy50: 0.3922 - 9s/epoch - 18ms/step
Epoch 15/50
512/512 - 8s - loss: 3.2265 - accuracy50: 0.4060 - val_loss: 3.2569 - val_accuracy50: 0.3952 - 8s/epoch - 16ms/step
Epoch 16/50
512/512 - 9s - loss: 3.2245 - accuracy50: 0.4078 - val_loss: 3.2569 - val_accuracy50: 0.3921 - 9s/epoch - 17ms/step
Epoch 17/50
512/512 - 8s - loss: 3.2240 - accuracy50: 0.4060 - val_loss: 3.2588 - val_accuracy50: 0.3923 - 8s/epoch - 16ms/step
Epoch 18/50
512/512 - 9s - loss: 3.2212 - accuracy50: 0.4085 - val_loss: 3.2548 - val_accuracy50: 0.3948 - 9s/epoch - 18ms/step
Epoch 19/50
512/512 - 9s - loss: 3.2184 - accuracy50: 0.4097 - val_loss: 3.2568 - val_accuracy50: 0.3924 - 9s/epoch - 17ms/step
Epoch 20/50
512/512 - 9s - loss: 3.2168 - accuracy50: 0.4109 - val_loss: 3.2579 - val_accuracy50: 0.3895 - 9s/epoch - 18ms/step
Epoch 21/50
512/512 - 9s - loss: 3.2147 - accuracy50: 0.4116 - val_loss: 3.2589 - val_accuracy50: 0.3903 - 9s/epoch - 18ms/step
Epoch 22/50
512/512 - 9s - loss: 3.2127 - accuracy50: 0.4134 - val_loss: 3.2570 - val_accuracy50: 0.3919 - 9s/epoch - 17ms/step
Epoch 23/50
512/512 - 9s - loss: 3.2103 - accuracy50: 0.4150 - val_loss: 3.2586 - val_accuracy50: 0.3918 - 9s/epoch - 18ms/step
Epoch 24/50
512/512 - 9s - loss: 3.2091 - accuracy50: 0.4135 - val_loss: 3.2597 - val_accuracy50: 0.3915 - 9s/epoch - 17ms/step
Epoch 25/50
512/512 - 9s - loss: 3.2085 - accuracy50: 0.4147 - val_loss: 3.2627 - val_accuracy50: 0.3900 - 9s/epoch - 18ms/step
Epoch 26/50
512/512 - 10s - loss: 3.2035 - accuracy50: 0.4192 - val_loss: 3.2636 - val_accuracy50: 0.3886 - 10s/epoch - 19ms/step
Epoch 27/50
512/512 - 8s - loss: 3.2030 - accuracy50: 0.4179 - val_loss: 3.2655 - val_accuracy50: 0.3880 - 8s/epoch - 16ms/step
Epoch 28/50
512/512 - 9s - loss: 3.2000 - accuracy50: 0.4197 - val_loss: 3.2649 - val_accuracy50: 0.3899 - 9s/epoch - 17ms/step
testing model: results/XRAY/W6/deepOF_L1/h50
Evaluating performance on  test set...
1214/1214 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0832858
{'0': {'precision': 0.4520170209389289, 'recall': 0.3985220813292523, 'f1-score': 0.42358726012817954, 'support': 114350}, '1': {'precision': 0.28091496012386435, 'recall': 0.11465909903894307, 'f1-score': 0.162849183298475, 'support': 83866}, '2': {'precision': 0.41514654642344745, 'recall': 0.6482983036381095, 'f1-score': 0.5061640982923782, 'support': 112476}, 'accuracy': 0.4123215274290938, 'macro avg': {'precision': 0.3826928424954135, 'recall': 0.3871598280021016, 'f1-score': 0.3642001805730109, 'support': 310692}, 'weighted avg': {'precision': 0.39248317737707505, 'recall': 0.4123215274290938, 'f1-score': 0.3830997448331491, 'support': 310692}}
[[45571 13227 55552]
 [27076  9616 47174]
 [28170 11388 72918]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.078456
{'0': {'precision': 0.4389798145117294, 'recall': 0.3602480300859599, 'f1-score': 0.39573599567206025, 'support': 44672}, '1': {'precision': 0.388414010963486, 'recall': 0.19582172049558516, 'f1-score': 0.2603740093113059, 'support': 42697}, '2': {'precision': 0.3835847967680765, 'recall': 0.640384483035489, 'f1-score': 0.47978344003781204, 'support': 43591}, 'accuracy': 0.3998854612095296, 'macro avg': {'precision': 0.40365954074776395, 'recall': 0.3988180778723447, 'f1-score': 0.37863114834039274, 'support': 130960}, 'weighted avg': {'precision': 0.4040551632245965, 'recall': 0.3998854612095296, 'f1-score': 0.3795796228536604, 'support': 130960}}
[[16093  6912 21667]
 [11144  8361 23192]
 [ 9423  6253 27915]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0861143
{'0': {'precision': 0.42005097706032285, 'recall': 0.3424534183002009, 'f1-score': 0.37730377380089286, 'support': 14437}, '1': {'precision': 0.3722313066745949, 'recall': 0.18019573978123202, 'f1-score': 0.24283566891334918, 'support': 13896}, '2': {'precision': 0.3861819952127875, 'recall': 0.6426112198744346, 'f1-score': 0.48243880188535804, 'support': 14813}, 'accuracy': 0.39324618736383443, 'macro avg': {'precision': 0.3928214263159018, 'recall': 0.38842012598528913, 'f1-score': 0.3675260815332, 'support': 43146}, 'weighted avg': {'precision': 0.39302174218831576, 'recall': 0.39324618736383443, 'f1-score': 0.3700909704239373, 'support': 43146}}
[[4944 2229 7264]
 [3526 2504 7866]
 [3300 1994 9519]]
training model: results/XRAY/W6/deepOF_L1/h100
Epoch 1/50
512/512 - 12s - loss: 3.3184 - accuracy100: 0.3524 - val_loss: 3.2956 - val_accuracy100: 0.3584 - 12s/epoch - 23ms/step
Epoch 2/50
512/512 - 8s - loss: 3.2916 - accuracy100: 0.3644 - val_loss: 3.2917 - val_accuracy100: 0.3608 - 8s/epoch - 16ms/step
Epoch 3/50
512/512 - 8s - loss: 3.2809 - accuracy100: 0.3685 - val_loss: 3.2834 - val_accuracy100: 0.3674 - 8s/epoch - 16ms/step
Epoch 4/50
512/512 - 8s - loss: 3.2753 - accuracy100: 0.3727 - val_loss: 3.2850 - val_accuracy100: 0.3654 - 8s/epoch - 16ms/step
Epoch 5/50
512/512 - 9s - loss: 3.2700 - accuracy100: 0.3778 - val_loss: 3.2799 - val_accuracy100: 0.3684 - 9s/epoch - 17ms/step
Epoch 6/50
512/512 - 9s - loss: 3.2676 - accuracy100: 0.3792 - val_loss: 3.2804 - val_accuracy100: 0.3709 - 9s/epoch - 18ms/step
Epoch 7/50
512/512 - 9s - loss: 3.2642 - accuracy100: 0.3811 - val_loss: 3.2787 - val_accuracy100: 0.3711 - 9s/epoch - 18ms/step
Epoch 8/50
512/512 - 9s - loss: 3.2628 - accuracy100: 0.3816 - val_loss: 3.2794 - val_accuracy100: 0.3691 - 9s/epoch - 17ms/step
Epoch 9/50
512/512 - 9s - loss: 3.2601 - accuracy100: 0.3830 - val_loss: 3.2773 - val_accuracy100: 0.3722 - 9s/epoch - 17ms/step
Epoch 10/50
512/512 - 9s - loss: 3.2584 - accuracy100: 0.3838 - val_loss: 3.2786 - val_accuracy100: 0.3701 - 9s/epoch - 18ms/step
Epoch 11/50
512/512 - 9s - loss: 3.2574 - accuracy100: 0.3835 - val_loss: 3.2766 - val_accuracy100: 0.3708 - 9s/epoch - 18ms/step
Epoch 12/50
512/512 - 9s - loss: 3.2552 - accuracy100: 0.3853 - val_loss: 3.2788 - val_accuracy100: 0.3703 - 9s/epoch - 18ms/step
Epoch 13/50
512/512 - 9s - loss: 3.2526 - accuracy100: 0.3878 - val_loss: 3.2762 - val_accuracy100: 0.3719 - 9s/epoch - 18ms/step
Epoch 14/50
512/512 - 9s - loss: 3.2513 - accuracy100: 0.3889 - val_loss: 3.2771 - val_accuracy100: 0.3732 - 9s/epoch - 18ms/step
Epoch 15/50
512/512 - 9s - loss: 3.2504 - accuracy100: 0.3907 - val_loss: 3.2779 - val_accuracy100: 0.3709 - 9s/epoch - 18ms/step
Epoch 16/50
512/512 - 9s - loss: 3.2485 - accuracy100: 0.3908 - val_loss: 3.2769 - val_accuracy100: 0.3710 - 9s/epoch - 18ms/step
Epoch 17/50
512/512 - 9s - loss: 3.2465 - accuracy100: 0.3907 - val_loss: 3.2777 - val_accuracy100: 0.3724 - 9s/epoch - 18ms/step
Epoch 18/50
512/512 - 9s - loss: 3.2448 - accuracy100: 0.3916 - val_loss: 3.2780 - val_accuracy100: 0.3707 - 9s/epoch - 18ms/step
Epoch 19/50
512/512 - 9s - loss: 3.2431 - accuracy100: 0.3954 - val_loss: 3.2782 - val_accuracy100: 0.3720 - 9s/epoch - 18ms/step
Epoch 20/50
512/512 - 10s - loss: 3.2411 - accuracy100: 0.3951 - val_loss: 3.2798 - val_accuracy100: 0.3703 - 10s/epoch - 19ms/step
Epoch 21/50
512/512 - 10s - loss: 3.2389 - accuracy100: 0.3961 - val_loss: 3.2802 - val_accuracy100: 0.3720 - 10s/epoch - 19ms/step
Epoch 22/50
512/512 - 9s - loss: 3.2380 - accuracy100: 0.3946 - val_loss: 3.2810 - val_accuracy100: 0.3708 - 9s/epoch - 18ms/step
Epoch 23/50
512/512 - 9s - loss: 3.2355 - accuracy100: 0.3986 - val_loss: 3.2810 - val_accuracy100: 0.3705 - 9s/epoch - 18ms/step
testing model: results/XRAY/W6/deepOF_L1/h100
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0880717
{'0': {'precision': 0.4296179488203122, 'recall': 0.3719358880200458, 'f1-score': 0.39870143703312627, 'support': 115735}, '1': {'precision': 0.2801384490757788, 'recall': 0.04729813741824783, 'f1-score': 0.08093186532631243, 'support': 80426}, '2': {'precision': 0.4017428662837642, 'recall': 0.6907300206930874, 'f1-score': 0.5080141789319566, 'support': 114531}, 'accuracy': 0.40541758397383904, 'macro avg': {'precision': 0.3704997547266184, 'recall': 0.36998801537712706, 'f1-score': 0.32921582709713176, 'support': 310692}, 'weighted avg': {'precision': 0.3806479099250486, 'recall': 0.40541758397383904, 'f1-score': 0.35673950067275245, 'support': 310692}}
[[43046  5154 67535]
 [26350  3804 50272]
 [30800  4621 79110]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0891118
{'0': {'precision': 0.4037360166996735, 'recall': 0.3433943367021761, 'f1-score': 0.3711284410440601, 'support': 43932}, '1': {'precision': 0.43954698500153044, 'recall': 0.06487170220455367, 'f1-score': 0.1130575128921781, 'support': 44272}, '2': {'precision': 0.35509993108201243, 'recall': 0.7230564131349986, 'f1-score': 0.47628951747088194, 'support': 42756}, 'accuracy': 0.3731902871105681, 'macro avg': {'precision': 0.3994609775944055, 'recall': 0.3771074840139095, 'f1-score': 0.32015849046904005, 'support': 130960}, 'weighted avg': {'precision': 0.3999634045432219, 'recall': 0.3731902871105681, 'f1-score': 0.31821878048026253, 'support': 130960}}
[[15086  1876 26970]
 [12225  2872 29175]
 [10055  1786 30915]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0936667
{'0': {'precision': 0.3869860145716439, 'recall': 0.3264801469549244, 'f1-score': 0.3541674650316152, 'support': 14154}, '1': {'precision': 0.42016401350699467, 'recall': 0.06014777984945791, 'f1-score': 0.10523136402078047, 'support': 14481}, '2': {'precision': 0.36152684333379104, 'recall': 0.7257942250706361, 'f1-score': 0.48264326467016466, 'support': 14511}, 'accuracy': 0.371390163630464, 'macro avg': {'precision': 0.3895589571374765, 'recall': 0.37080738395833945, 'f1-score': 0.3140140312408535, 'support': 43146}, 'weighted avg': {'precision': 0.3895589661488546, 'recall': 0.371390163630464, 'f1-score': 0.31382696185211056, 'support': 43146}}
[[ 4621   593  8940]
 [ 3950   871  9660]
 [ 3370   609 10532]]
training model: results/XRAY/W6/deepOF_L1/h200
Epoch 1/50
512/512 - 10s - loss: 3.3238 - accuracy200: 0.3536 - val_loss: 3.3035 - val_accuracy200: 0.3671 - 10s/epoch - 20ms/step
Epoch 2/50
512/512 - 8s - loss: 3.3006 - accuracy200: 0.3612 - val_loss: 3.2997 - val_accuracy200: 0.3655 - 8s/epoch - 16ms/step
Epoch 3/50
512/512 - 9s - loss: 3.2902 - accuracy200: 0.3634 - val_loss: 3.2912 - val_accuracy200: 0.3695 - 9s/epoch - 17ms/step
Epoch 4/50
512/512 - 8s - loss: 3.2856 - accuracy200: 0.3660 - val_loss: 3.2915 - val_accuracy200: 0.3695 - 8s/epoch - 16ms/step
Epoch 5/50
512/512 - 8s - loss: 3.2807 - accuracy200: 0.3689 - val_loss: 3.2889 - val_accuracy200: 0.3697 - 8s/epoch - 16ms/step
Epoch 6/50
512/512 - 8s - loss: 3.2782 - accuracy200: 0.3710 - val_loss: 3.2887 - val_accuracy200: 0.3689 - 8s/epoch - 16ms/step
Epoch 7/50
512/512 - 9s - loss: 3.2767 - accuracy200: 0.3716 - val_loss: 3.2872 - val_accuracy200: 0.3688 - 9s/epoch - 18ms/step
Epoch 8/50
512/512 - 10s - loss: 3.2752 - accuracy200: 0.3728 - val_loss: 3.2863 - val_accuracy200: 0.3689 - 10s/epoch - 19ms/step
Epoch 9/50
512/512 - 9s - loss: 3.2727 - accuracy200: 0.3728 - val_loss: 3.2835 - val_accuracy200: 0.3700 - 9s/epoch - 17ms/step
Epoch 10/50
512/512 - 10s - loss: 3.2725 - accuracy200: 0.3721 - val_loss: 3.2837 - val_accuracy200: 0.3694 - 10s/epoch - 19ms/step
Epoch 11/50
512/512 - 8s - loss: 3.2697 - accuracy200: 0.3729 - val_loss: 3.2821 - val_accuracy200: 0.3725 - 8s/epoch - 16ms/step
Epoch 12/50
512/512 - 9s - loss: 3.2695 - accuracy200: 0.3746 - val_loss: 3.2823 - val_accuracy200: 0.3709 - 9s/epoch - 18ms/step
Epoch 13/50
512/512 - 9s - loss: 3.2674 - accuracy200: 0.3752 - val_loss: 3.2815 - val_accuracy200: 0.3706 - 9s/epoch - 18ms/step
Epoch 14/50
512/512 - 9s - loss: 3.2664 - accuracy200: 0.3760 - val_loss: 3.2816 - val_accuracy200: 0.3704 - 9s/epoch - 17ms/step
Epoch 15/50
512/512 - 9s - loss: 3.2657 - accuracy200: 0.3759 - val_loss: 3.2839 - val_accuracy200: 0.3697 - 9s/epoch - 17ms/step
Epoch 16/50
512/512 - 9s - loss: 3.2635 - accuracy200: 0.3787 - val_loss: 3.2837 - val_accuracy200: 0.3686 - 9s/epoch - 18ms/step
Epoch 17/50
512/512 - 9s - loss: 3.2626 - accuracy200: 0.3780 - val_loss: 3.2845 - val_accuracy200: 0.3697 - 9s/epoch - 18ms/step
Epoch 18/50
512/512 - 8s - loss: 3.2617 - accuracy200: 0.3785 - val_loss: 3.2850 - val_accuracy200: 0.3693 - 8s/epoch - 17ms/step
Epoch 19/50
512/512 - 9s - loss: 3.2597 - accuracy200: 0.3802 - val_loss: 3.2837 - val_accuracy200: 0.3712 - 9s/epoch - 18ms/step
Epoch 20/50
512/512 - 9s - loss: 3.2591 - accuracy200: 0.3814 - val_loss: 3.2853 - val_accuracy200: 0.3689 - 9s/epoch - 17ms/step
Epoch 21/50
512/512 - 8s - loss: 3.2575 - accuracy200: 0.3815 - val_loss: 3.2843 - val_accuracy200: 0.3682 - 8s/epoch - 16ms/step
Epoch 22/50
512/512 - 9s - loss: 3.2553 - accuracy200: 0.3840 - val_loss: 3.2833 - val_accuracy200: 0.3724 - 9s/epoch - 18ms/step
Epoch 23/50
512/512 - 8s - loss: 3.2550 - accuracy200: 0.3835 - val_loss: 3.2853 - val_accuracy200: 0.3710 - 8s/epoch - 16ms/step
testing model: results/XRAY/W6/deepOF_L1/h200
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0869749
{'0': {'precision': 0.4159030363892492, 'recall': 0.253949463894874, 'f1-score': 0.3153480895525545, 'support': 117421}, '1': {'precision': 0.2560620756547042, 'recall': 0.020626880054171605, 'f1-score': 0.038178334277347285, 'support': 76793}, '2': {'precision': 0.38856315692262755, 'recall': 0.7766359312488195, 'f1-score': 0.5179751894573803, 'support': 116478}, 'accuracy': 0.3922341096648771, 'macro avg': {'precision': 0.3535094229888603, 'recall': 0.35040409173262166, 'f1-score': 0.2905005377624274, 'support': 310692}, 'weighted avg': {'precision': 0.3661458447711803, 'recall': 0.3922341096648771, 'f1-score': 0.3228053215568073, 'support': 310692}}
[[29819  2468 85134]
 [17995  1584 57214]
 [23883  2134 90461]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0966927
{'0': {'precision': 0.3965893537528206, 'recall': 0.2378322019610453, 'f1-score': 0.29734714537310536, 'support': 45078}, '1': {'precision': 0.5142944973870274, 'recall': 0.03887533403044034, 'f1-score': 0.0722865537504321, 'support': 43035}, '2': {'precision': 0.34311738879949144, 'recall': 0.8061941326113847, 'f1-score': 0.4813650963970429, 'support': 42847}, 'accuracy': 0.35840714722052536, 'macro avg': {'precision': 0.41800041331311316, 'recall': 0.36096722286762345, 'f1-score': 0.2836662651735268, 'support': 130960}, 'weighted avg': {'precision': 0.41777389539868803, 'recall': 0.35840714722052536, 'f1-score': 0.28359588229308785, 'support': 130960}}
[[10721   754 33603]
 [ 8834  1673 32528]
 [ 7478   826 34543]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.094888
{'0': {'precision': 0.3922093023255814, 'recall': 0.22317057033214238, 'f1-score': 0.2844733069073121, 'support': 15114}, '1': {'precision': 0.3808487486398259, 'recall': 0.027543873455575667, 'f1-score': 0.05137237633935124, 'support': 12707}, '2': {'precision': 0.3647664079459958, 'recall': 0.8003915171288744, 'f1-score': 0.5011439777741461, 'support': 15325}, 'accuracy': 0.3705789644462986, 'macro avg': {'precision': 0.37927481963713433, 'recall': 0.35036865363886416, 'f1-score': 0.27899655367360315, 'support': 43146}, 'weighted avg': {'precision': 0.37911606281202176, 'recall': 0.3705789644462986, 'f1-score': 0.29278148162355816, 'support': 43146}}
[[ 3373   263 11478]
 [ 2474   350  9883]
 [ 2753   306 12266]]
training model: results/XRAY/W6/deepOF_L1/h300
Epoch 1/50
512/512 - 10s - loss: 3.3377 - accuracy300: 0.3374 - val_loss: 3.3149 - val_accuracy300: 0.3381 - 10s/epoch - 20ms/step
Epoch 2/50
512/512 - 9s - loss: 3.3108 - accuracy300: 0.3436 - val_loss: 3.3084 - val_accuracy300: 0.3365 - 9s/epoch - 17ms/step
Epoch 3/50
512/512 - 9s - loss: 3.3007 - accuracy300: 0.3458 - val_loss: 3.3038 - val_accuracy300: 0.3385 - 9s/epoch - 18ms/step
Epoch 4/50
512/512 - 9s - loss: 3.2943 - accuracy300: 0.3471 - val_loss: 3.3024 - val_accuracy300: 0.3385 - 9s/epoch - 17ms/step
Epoch 5/50
512/512 - 8s - loss: 3.2905 - accuracy300: 0.3483 - val_loss: 3.3013 - val_accuracy300: 0.3402 - 8s/epoch - 16ms/step
Epoch 6/50
512/512 - 9s - loss: 3.2877 - accuracy300: 0.3515 - val_loss: 3.3013 - val_accuracy300: 0.3371 - 9s/epoch - 18ms/step
Epoch 7/50
512/512 - 9s - loss: 3.2852 - accuracy300: 0.3528 - val_loss: 3.3001 - val_accuracy300: 0.3383 - 9s/epoch - 18ms/step
Epoch 8/50
512/512 - 9s - loss: 3.2830 - accuracy300: 0.3557 - val_loss: 3.3014 - val_accuracy300: 0.3389 - 9s/epoch - 18ms/step
Epoch 9/50
512/512 - 9s - loss: 3.2818 - accuracy300: 0.3550 - val_loss: 3.3012 - val_accuracy300: 0.3378 - 9s/epoch - 17ms/step
Epoch 10/50
512/512 - 8s - loss: 3.2798 - accuracy300: 0.3565 - val_loss: 3.3013 - val_accuracy300: 0.3405 - 8s/epoch - 16ms/step
Epoch 11/50
512/512 - 9s - loss: 3.2783 - accuracy300: 0.3582 - val_loss: 3.3006 - val_accuracy300: 0.3396 - 9s/epoch - 18ms/step
Epoch 12/50
512/512 - 10s - loss: 3.2765 - accuracy300: 0.3595 - val_loss: 3.3020 - val_accuracy300: 0.3410 - 10s/epoch - 19ms/step
Epoch 13/50
512/512 - 9s - loss: 3.2747 - accuracy300: 0.3630 - val_loss: 3.3016 - val_accuracy300: 0.3399 - 9s/epoch - 18ms/step
Epoch 14/50
512/512 - 9s - loss: 3.2738 - accuracy300: 0.3642 - val_loss: 3.3029 - val_accuracy300: 0.3385 - 9s/epoch - 17ms/step
Epoch 15/50
512/512 - 8s - loss: 3.2726 - accuracy300: 0.3639 - val_loss: 3.3036 - val_accuracy300: 0.3399 - 8s/epoch - 16ms/step
Epoch 16/50
512/512 - 9s - loss: 3.2718 - accuracy300: 0.3649 - val_loss: 3.3044 - val_accuracy300: 0.3383 - 9s/epoch - 17ms/step
Epoch 17/50
512/512 - 9s - loss: 3.2708 - accuracy300: 0.3661 - val_loss: 3.3043 - val_accuracy300: 0.3395 - 9s/epoch - 18ms/step
testing model: results/XRAY/W6/deepOF_L1/h300
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0991167
{'0': {'precision': 0.3831824459106951, 'recall': 0.11308553418106727, 'f1-score': 0.17463303425945997, 'support': 110412}, '1': {'precision': 0.3320112882312562, 'recall': 0.04723102295907296, 'f1-score': 0.08269769650914272, 'support': 92164}, '2': {'precision': 0.355507252939667, 'recall': 0.8713603906914795, 'f1-score': 0.5049850983082828, 'support': 108116}, 'accuracy': 0.3574182791961171, 'macro avg': {'precision': 0.3569003290272061, 'recall': 0.3438923159438732, 'f1-score': 0.2541052763589618, 'support': 310692}, 'weighted avg': {'precision': 0.3583724419851886, 'recall': 0.3574182791961171, 'f1-score': 0.26231863700520913, 'support': 310692}}
[[12486  4748 93178]
 [10201  4353 77610]
 [ 9898  4010 94208]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1002283
{'0': {'precision': 0.3753627394080093, 'recall': 0.11761229314420804, 'f1-score': 0.17910551093879812, 'support': 43992}, '1': {'precision': 0.4574568288854003, 'recall': 0.06402566299738537, 'f1-score': 0.11232966482277433, 'support': 45513}, '2': {'precision': 0.32479288125191774, 'recall': 0.8681461826076469, 'f1-score': 0.472727750375999, 'support': 41455}, 'accuracy': 0.3365684178375076, 'macro avg': {'precision': 0.3858708165151092, 'recall': 0.34992804624974677, 'f1-score': 0.25472097537919053, 'support': 130960}, 'weighted avg': {'precision': 0.3878854549281965, 'recall': 0.3365684178375076, 'f1-score': 0.24884391084404073, 'support': 130960}}
[[ 5174  1797 37021]
 [ 4803  2914 37796]
 [ 3807  1659 35989]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1026298
{'0': {'precision': 0.3455832001826067, 'recall': 0.1090699517325841, 'f1-score': 0.16580878326579784, 'support': 13881}, '1': {'precision': 0.3920940170940171, 'recall': 0.04883891143788675, 'f1-score': 0.0868587657535057, 'support': 15029}, '2': {'precision': 0.33439947957607136, 'recall': 0.8666057881427367, 'f1-score': 0.4825832697686244, 'support': 14236}, 'accuracy': 0.3380382886014926, 'macro avg': {'precision': 0.3573588989508984, 'recall': 0.3415048837710692, 'f1-score': 0.24508360626264267, 'support': 43146}, 'weighted avg': {'precision': 0.3580942005257891, 'recall': 0.3380382886014926, 'f1-score': 0.24282778332749536, 'support': 43146}}
[[ 1514   553 11814]
 [ 1553   734 12742]
 [ 1314   585 12337]]
training model: results/XRAY/W6/deepOF_L1/h500
Epoch 1/50
512/512 - 12s - loss: 3.3392 - accuracy500: 0.3377 - val_loss: 3.3173 - val_accuracy500: 0.3396 - 12s/epoch - 23ms/step
Epoch 2/50
512/512 - 10s - loss: 3.3162 - accuracy500: 0.3398 - val_loss: 3.3111 - val_accuracy500: 0.3420 - 10s/epoch - 19ms/step
Epoch 3/50
512/512 - 9s - loss: 3.3062 - accuracy500: 0.3444 - val_loss: 3.3064 - val_accuracy500: 0.3438 - 9s/epoch - 18ms/step
Epoch 4/50
512/512 - 8s - loss: 3.3013 - accuracy500: 0.3455 - val_loss: 3.3080 - val_accuracy500: 0.3453 - 8s/epoch - 16ms/step
Epoch 5/50
512/512 - 8s - loss: 3.2977 - accuracy500: 0.3470 - val_loss: 3.3055 - val_accuracy500: 0.3471 - 8s/epoch - 17ms/step
Epoch 6/50
512/512 - 9s - loss: 3.2931 - accuracy500: 0.3497 - val_loss: 3.3051 - val_accuracy500: 0.3509 - 9s/epoch - 18ms/step
Epoch 7/50
512/512 - 8s - loss: 3.2916 - accuracy500: 0.3518 - val_loss: 3.3045 - val_accuracy500: 0.3482 - 8s/epoch - 16ms/step
Epoch 8/50
512/512 - 9s - loss: 3.2892 - accuracy500: 0.3547 - val_loss: 3.3058 - val_accuracy500: 0.3491 - 9s/epoch - 18ms/step
Epoch 9/50
512/512 - 9s - loss: 3.2874 - accuracy500: 0.3551 - val_loss: 3.3041 - val_accuracy500: 0.3525 - 9s/epoch - 18ms/step
Epoch 10/50
512/512 - 9s - loss: 3.2860 - accuracy500: 0.3585 - val_loss: 3.3054 - val_accuracy500: 0.3505 - 9s/epoch - 18ms/step
Epoch 11/50
512/512 - 9s - loss: 3.2853 - accuracy500: 0.3579 - val_loss: 3.3045 - val_accuracy500: 0.3524 - 9s/epoch - 18ms/step
Epoch 12/50
512/512 - 9s - loss: 3.2832 - accuracy500: 0.3587 - val_loss: 3.3046 - val_accuracy500: 0.3508 - 9s/epoch - 18ms/step
Epoch 13/50
512/512 - 9s - loss: 3.2824 - accuracy500: 0.3615 - val_loss: 3.3046 - val_accuracy500: 0.3513 - 9s/epoch - 18ms/step
Epoch 14/50
512/512 - 9s - loss: 3.2810 - accuracy500: 0.3628 - val_loss: 3.3072 - val_accuracy500: 0.3497 - 9s/epoch - 18ms/step
Epoch 15/50
512/512 - 9s - loss: 3.2802 - accuracy500: 0.3635 - val_loss: 3.3065 - val_accuracy500: 0.3525 - 9s/epoch - 18ms/step
Epoch 16/50
512/512 - 9s - loss: 3.2788 - accuracy500: 0.3637 - val_loss: 3.3065 - val_accuracy500: 0.3506 - 9s/epoch - 18ms/step
Epoch 17/50
512/512 - 9s - loss: 3.2784 - accuracy500: 0.3648 - val_loss: 3.3076 - val_accuracy500: 0.3498 - 9s/epoch - 17ms/step
Epoch 18/50
512/512 - 8s - loss: 3.2769 - accuracy500: 0.3671 - val_loss: 3.3086 - val_accuracy500: 0.3518 - 8s/epoch - 16ms/step
Epoch 19/50
512/512 - 8s - loss: 3.2751 - accuracy500: 0.3687 - val_loss: 3.3087 - val_accuracy500: 0.3500 - 8s/epoch - 16ms/step
testing model: results/XRAY/W6/deepOF_L1/h500
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1051315
{'0': {'precision': 0.40546822435622976, 'recall': 0.05713226865697369, 'f1-score': 0.10015259333121819, 'support': 116029}, '1': {'precision': 0.2779055779498976, 'recall': 0.15629859108119978, 'f1-score': 0.20007293059438433, 'support': 84249}, '2': {'precision': 0.3613986070618724, 'recall': 0.8083304653395402, 'f1-score': 0.49948233503276673, 'support': 110414}, 'accuracy': 0.3509842545028517, 'macro avg': {'precision': 0.34825746978933325, 'recall': 0.34058710835923794, 'f1-score': 0.2665692863194564, 'support': 310692}, 'weighted avg': {'precision': 0.3552161157695064, 'recall': 0.3509842545028517, 'f1-score': 0.2691617168178843, 'support': 310692}}
[[ 6629 18119 91281]
 [ 4653 13168 66428]
 [ 5067 16096 89251]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1012359
{'0': {'precision': 0.41111607808076295, 'recall': 0.058717119264493065, 'f1-score': 0.10275796569768525, 'support': 46988}, '1': {'precision': 0.34187677020940704, 'recall': 0.18214877668653984, 'f1-score': 0.2376694641704325, 'support': 40423}, '2': {'precision': 0.34160565464600046, 'recall': 0.8056901421387402, 'f1-score': 0.47978613574363643, 'support': 43549}, 'accuracy': 0.3452122785583384, 'macro avg': {'precision': 0.36486616764539015, 'recall': 0.34885201269659105, 'f1-score': 0.2734045218705847, 'support': 130960}, 'weighted avg': {'precision': 0.3666294411515915, 'recall': 0.3452122785583384, 'f1-score': 0.26977634749437884, 'support': 130960}}
[[ 2759  7632 36597]
 [ 2032  7363 31028]
 [ 1920  6542 35087]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1016016
{'0': {'precision': 0.36237826755509994, 'recall': 0.04921684650191437, 'f1-score': 0.0866633978916401, 'support': 14365}, '1': {'precision': 0.332685697205201, 'recall': 0.16307692307692306, 'f1-score': 0.21886829556069023, 'support': 13650}, '2': {'precision': 0.35642244377463483, 'recall': 0.8127684885334743, 'f1-score': 0.4955374231892818, 'support': 15131}, 'accuracy': 0.353010707829231, 'macro avg': {'precision': 0.3504954695116453, 'recall': 0.3416874193707706, 'f1-score': 0.2670230388805374, 'support': 43146}, 'weighted avg': {'precision': 0.3508958322216197, 'recall': 0.353010707829231, 'f1-score': 0.271878011759928, 'support': 43146}}
[[  707  2232 11426]
 [  644  2226 10780]
 [  600  2233 12298]]
training model: results/XRAY/W6/deepOF_L1/h1000
Epoch 1/50
512/512 - 11s - loss: 3.3455 - accuracy1000: 0.3343 - val_loss: 3.3192 - val_accuracy1000: 0.3413 - 11s/epoch - 22ms/step
Epoch 2/50
512/512 - 8s - loss: 3.3221 - accuracy1000: 0.3371 - val_loss: 3.3090 - val_accuracy1000: 0.3430 - 8s/epoch - 16ms/step
Epoch 3/50
512/512 - 9s - loss: 3.3115 - accuracy1000: 0.3389 - val_loss: 3.3054 - val_accuracy1000: 0.3420 - 9s/epoch - 17ms/step
Epoch 4/50
512/512 - 9s - loss: 3.3067 - accuracy1000: 0.3411 - val_loss: 3.3041 - val_accuracy1000: 0.3415 - 9s/epoch - 18ms/step
Epoch 5/50
512/512 - 8s - loss: 3.3012 - accuracy1000: 0.3435 - val_loss: 3.3024 - val_accuracy1000: 0.3377 - 8s/epoch - 15ms/step
Epoch 6/50
512/512 - 9s - loss: 3.2981 - accuracy1000: 0.3451 - val_loss: 3.3021 - val_accuracy1000: 0.3386 - 9s/epoch - 18ms/step
Epoch 7/50
512/512 - 9s - loss: 3.2967 - accuracy1000: 0.3437 - val_loss: 3.3032 - val_accuracy1000: 0.3361 - 9s/epoch - 17ms/step
Epoch 8/50
512/512 - 9s - loss: 3.2939 - accuracy1000: 0.3464 - val_loss: 3.3022 - val_accuracy1000: 0.3388 - 9s/epoch - 17ms/step
Epoch 9/50
512/512 - 9s - loss: 3.2922 - accuracy1000: 0.3487 - val_loss: 3.3018 - val_accuracy1000: 0.3379 - 9s/epoch - 17ms/step
Epoch 10/50
512/512 - 9s - loss: 3.2910 - accuracy1000: 0.3500 - val_loss: 3.3033 - val_accuracy1000: 0.3362 - 9s/epoch - 17ms/step
Epoch 11/50
512/512 - 9s - loss: 3.2897 - accuracy1000: 0.3507 - val_loss: 3.3019 - val_accuracy1000: 0.3362 - 9s/epoch - 18ms/step
Epoch 12/50
512/512 - 8s - loss: 3.2891 - accuracy1000: 0.3502 - val_loss: 3.3022 - val_accuracy1000: 0.3368 - 8s/epoch - 16ms/step
Epoch 13/50
512/512 - 9s - loss: 3.2874 - accuracy1000: 0.3530 - val_loss: 3.3013 - val_accuracy1000: 0.3363 - 9s/epoch - 18ms/step
Epoch 14/50
512/512 - 9s - loss: 3.2866 - accuracy1000: 0.3532 - val_loss: 3.3035 - val_accuracy1000: 0.3355 - 9s/epoch - 18ms/step
Epoch 15/50
512/512 - 9s - loss: 3.2848 - accuracy1000: 0.3573 - val_loss: 3.3030 - val_accuracy1000: 0.3370 - 9s/epoch - 18ms/step
Epoch 16/50
512/512 - 9s - loss: 3.2838 - accuracy1000: 0.3556 - val_loss: 3.3029 - val_accuracy1000: 0.3363 - 9s/epoch - 17ms/step
Epoch 17/50
512/512 - 9s - loss: 3.2833 - accuracy1000: 0.3563 - val_loss: 3.3044 - val_accuracy1000: 0.3363 - 9s/epoch - 18ms/step
Epoch 18/50
512/512 - 9s - loss: 3.2815 - accuracy1000: 0.3583 - val_loss: 3.3054 - val_accuracy1000: 0.3350 - 9s/epoch - 17ms/step
Epoch 19/50
512/512 - 9s - loss: 3.2812 - accuracy1000: 0.3584 - val_loss: 3.3046 - val_accuracy1000: 0.3363 - 9s/epoch - 18ms/step
Epoch 20/50
512/512 - 9s - loss: 3.2802 - accuracy1000: 0.3610 - val_loss: 3.3055 - val_accuracy1000: 0.3348 - 9s/epoch - 18ms/step
Epoch 21/50
512/512 - 8s - loss: 3.2794 - accuracy1000: 0.3594 - val_loss: 3.3050 - val_accuracy1000: 0.3372 - 8s/epoch - 16ms/step
Epoch 22/50
512/512 - 8s - loss: 3.2782 - accuracy1000: 0.3615 - val_loss: 3.3047 - val_accuracy1000: 0.3370 - 8s/epoch - 17ms/step
Epoch 23/50
512/512 - 9s - loss: 3.2763 - accuracy1000: 0.3636 - val_loss: 3.3062 - val_accuracy1000: 0.3378 - 9s/epoch - 17ms/step
testing model: results/XRAY/W6/deepOF_L1/h1000
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1084478
{'0': {'precision': 0.391580354159706, 'recall': 0.03086213858118428, 'f1-score': 0.05721492209430047, 'support': 113926}, '1': {'precision': 0.30850427606004427, 'recall': 0.11124169757612352, 'f1-score': 0.16352051733155817, 'support': 92744}, '2': {'precision': 0.33988765092015166, 'recall': 0.8765645728788141, 'f1-score': 0.489839991619504, 'support': 104022}, 'accuracy': 0.33800355335830984, 'macro avg': {'precision': 0.346657427046634, 'recall': 0.3395561363453739, 'f1-score': 0.2368584770151209, 'support': 310692}, 'weighted avg': {'precision': 0.3494743901707396, 'recall': 0.33800355335830984, 'f1-score': 0.23379407800058366, 'support': 310692}}
[[ 3516 12914 97496]
 [ 2834 10317 79593]
 [ 2629 10211 91182]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1035646
{'0': {'precision': 0.3860610806577917, 'recall': 0.03332582244254169, 'f1-score': 0.06135529236066459, 'support': 44380}, '1': {'precision': 0.4067359184463514, 'recall': 0.13558738761990793, 'f1-score': 0.20337780071943604, 'support': 46494}, '2': {'precision': 0.3117889456239362, 'recall': 0.8682582447737365, 'f1-score': 0.45881779113606996, 'support': 40086}, 'accuracy': 0.32519853390348197, 'macro avg': {'precision': 0.36819531490935975, 'recall': 0.3457238182787287, 'f1-score': 0.24118362807205687, 'support': 130960}, 'weighted avg': {'precision': 0.370666938195774, 'recall': 0.32519853390348197, 'f1-score': 0.23343742606212778, 'support': 130960}}
[[ 1479  4941 37960]
 [ 1325  6304 38865]
 [ 1027  4254 34805]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1021717
{'0': {'precision': 0.3117839607201309, 'recall': 0.028674644389252654, 'f1-score': 0.052519126059687095, 'support': 13287}, '1': {'precision': 0.3763235916984329, 'recall': 0.11381541023506053, 'f1-score': 0.17477255962626015, 'support': 15613}, '2': {'precision': 0.33232084296543196, 'recall': 0.8678225466797698, 'f1-score': 0.48060177266366044, 'support': 14246}, 'accuracy': 0.3365549529504473, 'macro avg': {'precision': 0.3401427984613319, 'recall': 0.33677086710136095, 'f1-score': 0.2359644861165359, 'support': 43146}, 'weighted avg': {'precision': 0.34191944681225506, 'recall': 0.3365549529504473, 'f1-score': 0.23810314872216123, 'support': 43146}}
[[  381  1461 11445]
 [  442  1777 13394]
 [  399  1484 12363]]
training model: results/XRAY/W6/deepLOB_L2/h10
Epoch 1/50
512/512 - 25s - loss: 3.3108 - accuracy10: 0.3687 - val_loss: 3.3479 - val_accuracy10: 0.3400 - 25s/epoch - 49ms/step
Epoch 2/50
512/512 - 23s - loss: 3.2050 - accuracy10: 0.3936 - val_loss: 3.2723 - val_accuracy10: 0.3512 - 23s/epoch - 44ms/step
Epoch 3/50
512/512 - 22s - loss: 3.1522 - accuracy10: 0.4207 - val_loss: 3.2068 - val_accuracy10: 0.3684 - 22s/epoch - 44ms/step
Epoch 4/50
512/512 - 22s - loss: 3.1223 - accuracy10: 0.4364 - val_loss: 3.2135 - val_accuracy10: 0.3756 - 22s/epoch - 44ms/step
Epoch 5/50
512/512 - 23s - loss: 3.0913 - accuracy10: 0.4537 - val_loss: 3.2183 - val_accuracy10: 0.3962 - 23s/epoch - 45ms/step
Epoch 6/50
512/512 - 22s - loss: 3.0699 - accuracy10: 0.4657 - val_loss: 3.1791 - val_accuracy10: 0.4295 - 22s/epoch - 44ms/step
Epoch 7/50
512/512 - 22s - loss: 3.0524 - accuracy10: 0.4727 - val_loss: 3.2036 - val_accuracy10: 0.4223 - 22s/epoch - 43ms/step
Epoch 8/50
512/512 - 22s - loss: 3.0389 - accuracy10: 0.4783 - val_loss: 3.1949 - val_accuracy10: 0.4150 - 22s/epoch - 44ms/step
Epoch 9/50
512/512 - 23s - loss: 3.0294 - accuracy10: 0.4816 - val_loss: 3.2210 - val_accuracy10: 0.4141 - 23s/epoch - 44ms/step
Epoch 10/50
512/512 - 23s - loss: 3.0220 - accuracy10: 0.4849 - val_loss: 3.2059 - val_accuracy10: 0.4207 - 23s/epoch - 45ms/step
Epoch 11/50
512/512 - 23s - loss: 3.0123 - accuracy10: 0.4878 - val_loss: 3.2260 - val_accuracy10: 0.4244 - 23s/epoch - 44ms/step
Epoch 12/50
512/512 - 23s - loss: 3.0025 - accuracy10: 0.4898 - val_loss: 3.2592 - val_accuracy10: 0.4158 - 23s/epoch - 44ms/step
Epoch 13/50
512/512 - 23s - loss: 2.9956 - accuracy10: 0.4926 - val_loss: 3.2968 - val_accuracy10: 0.4028 - 23s/epoch - 44ms/step
Epoch 14/50
512/512 - 22s - loss: 2.9880 - accuracy10: 0.4966 - val_loss: 3.2847 - val_accuracy10: 0.4137 - 22s/epoch - 44ms/step
Epoch 15/50
512/512 - 23s - loss: 2.9795 - accuracy10: 0.4986 - val_loss: 3.2982 - val_accuracy10: 0.4017 - 23s/epoch - 44ms/step
Epoch 16/50
512/512 - 22s - loss: 2.9725 - accuracy10: 0.4994 - val_loss: 3.3076 - val_accuracy10: 0.4061 - 22s/epoch - 43ms/step
testing model: results/XRAY/W6/deepLOB_L2/h10
Evaluating performance on  test set...
1214/1214 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0947908
{'0': {'precision': 0.3674907815994681, 'recall': 0.6653824685061346, 'f1-score': 0.4734790515465524, 'support': 91367}, '1': {'precision': 0.5212193770884335, 'recall': 0.22789527552288016, 'f1-score': 0.31713018330470333, 'support': 127993}, '2': {'precision': 0.4140240078831855, 'recall': 0.40480856607946397, 'f1-score': 0.4093644300020483, 'support': 91337}, 'accuracy': 0.408555602403628, 'macro avg': {'precision': 0.4342447221903624, 'recall': 0.43269543670282623, 'f1-score': 0.39999122161776796, 'support': 310697}, 'weighted avg': {'precision': 0.4444995374339147, 'recall': 0.408555602403628, 'f1-score': 0.3902223806392396, 'support': 310697}}
[[60794 13038 17535]
 [64029 29169 34795]
 [40607 13756 36974]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0602264
{'0': {'precision': 0.3610964158180135, 'recall': 0.6182631340579711, 'f1-score': 0.45591550471737496, 'support': 35328}, '1': {'precision': 0.5968727534148095, 'recall': 0.3269773547751887, 'f1-score': 0.4225011661931216, 'support': 60940}, '2': {'precision': 0.4029066005176877, 'recall': 0.43073331027326184, 'f1-score': 0.41635553078852044, 'support': 34692}, 'accuracy': 0.43304062309102015, 'macro avg': {'precision': 0.4536252565835035, 'recall': 0.45865793303547386, 'f1-score': 0.43159073389967234, 'support': 130960}, 'weighted avg': {'precision': 0.4818866490247166, 'recall': 0.43304062309102015, 'f1-score': 0.4298870654595266, 'support': 130960}}
[[21842  6798  6688]
 [25557 19926 15457]
 [13089  6660 14943]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0632988
{'0': {'precision': 0.3638346489405899, 'recall': 0.6052699784017279, 'f1-score': 0.45447763614543807, 'support': 11575}, '1': {'precision': 0.5753717313279781, 'recall': 0.33898902426744537, 'f1-score': 0.4266252692941326, 'support': 19862}, '2': {'precision': 0.39519238657806216, 'recall': 0.4113578138343296, 'f1-score': 0.40311310096656766, 'support': 11710}, 'accuracy': 0.43006466266484344, 'macro avg': {'precision': 0.4447995889488767, 'recall': 0.4518722721678343, 'f1-score': 0.42807200213537944, 'support': 43147}, 'weighted avg': {'precision': 0.4697226281306403, 'recall': 0.43006466266484344, 'f1-score': 0.4277160439757576, 'support': 43147}}
[[7006 2331 2238]
 [7995 6733 5134]
 [4255 2638 4817]]
training model: results/XRAY/W6/deepLOB_L2/h20
Epoch 1/50
512/512 - 25s - loss: 3.3199 - accuracy20: 0.3609 - val_loss: 3.3588 - val_accuracy20: 0.3594 - 25s/epoch - 49ms/step
Epoch 2/50
512/512 - 22s - loss: 3.2554 - accuracy20: 0.3875 - val_loss: 3.2755 - val_accuracy20: 0.3893 - 22s/epoch - 44ms/step
Epoch 3/50
512/512 - 23s - loss: 3.2076 - accuracy20: 0.4154 - val_loss: 3.2596 - val_accuracy20: 0.3975 - 23s/epoch - 44ms/step
Epoch 4/50
512/512 - 23s - loss: 3.1857 - accuracy20: 0.4270 - val_loss: 3.2444 - val_accuracy20: 0.4059 - 23s/epoch - 44ms/step
Epoch 5/50
512/512 - 23s - loss: 3.1673 - accuracy20: 0.4361 - val_loss: 3.2320 - val_accuracy20: 0.4118 - 23s/epoch - 45ms/step
Epoch 6/50
512/512 - 22s - loss: 3.1545 - accuracy20: 0.4423 - val_loss: 3.2234 - val_accuracy20: 0.4193 - 22s/epoch - 44ms/step
Epoch 7/50
512/512 - 23s - loss: 3.1419 - accuracy20: 0.4470 - val_loss: 3.2193 - val_accuracy20: 0.4174 - 23s/epoch - 45ms/step
Epoch 8/50
512/512 - 22s - loss: 3.1310 - accuracy20: 0.4532 - val_loss: 3.2102 - val_accuracy20: 0.4219 - 22s/epoch - 44ms/step
Epoch 9/50
512/512 - 22s - loss: 3.1203 - accuracy20: 0.4570 - val_loss: 3.2206 - val_accuracy20: 0.4220 - 22s/epoch - 43ms/step
Epoch 10/50
512/512 - 23s - loss: 3.1073 - accuracy20: 0.4615 - val_loss: 3.2275 - val_accuracy20: 0.4199 - 23s/epoch - 44ms/step
Epoch 11/50
512/512 - 23s - loss: 3.0992 - accuracy20: 0.4659 - val_loss: 3.2303 - val_accuracy20: 0.4200 - 23s/epoch - 45ms/step
Epoch 12/50
512/512 - 23s - loss: 3.0894 - accuracy20: 0.4702 - val_loss: 3.2273 - val_accuracy20: 0.4251 - 23s/epoch - 44ms/step
Epoch 13/50
512/512 - 23s - loss: 3.0805 - accuracy20: 0.4732 - val_loss: 3.2276 - val_accuracy20: 0.4254 - 23s/epoch - 44ms/step
Epoch 14/50
512/512 - 22s - loss: 3.0711 - accuracy20: 0.4765 - val_loss: 3.2407 - val_accuracy20: 0.4201 - 22s/epoch - 44ms/step
Epoch 15/50
512/512 - 23s - loss: 3.0629 - accuracy20: 0.4791 - val_loss: 3.2293 - val_accuracy20: 0.4195 - 23s/epoch - 45ms/step
Epoch 16/50
512/512 - 23s - loss: 3.0540 - accuracy20: 0.4835 - val_loss: 3.2399 - val_accuracy20: 0.4232 - 23s/epoch - 44ms/step
Epoch 17/50
512/512 - 22s - loss: 3.0477 - accuracy20: 0.4835 - val_loss: 3.2325 - val_accuracy20: 0.4231 - 22s/epoch - 44ms/step
Epoch 18/50
512/512 - 23s - loss: 3.0405 - accuracy20: 0.4879 - val_loss: 3.2507 - val_accuracy20: 0.4181 - 23s/epoch - 44ms/step
testing model: results/XRAY/W6/deepLOB_L2/h20
Evaluating performance on  test set...
1214/1214 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0643917
{'0': {'precision': 0.441397735464993, 'recall': 0.47135275151251677, 'f1-score': 0.45588370554974, 'support': 110412}, '1': {'precision': 0.4205055979462312, 'recall': 0.2613691768981871, 'f1-score': 0.32236770172753115, 'support': 90244}, '2': {'precision': 0.43287490855888805, 'recall': 0.5377450223098663, 'f1-score': 0.4796446476264585, 'support': 110041}, 'accuracy': 0.433876091497504, 'macro avg': {'precision': 0.4315927473233708, 'recall': 0.4234889835735234, 'f1-score': 0.4192986849679099, 'support': 310697}, 'weighted avg': {'precision': 0.4323109066452173, 'recall': 0.433876091497504, 'f1-score': 0.4255186218126353, 'support': 310697}}
[[52043 16749 41620]
 [30751 23587 35906]
 [35111 15756 59174]]
Evaluating performance on  train set...
512/512 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0693252
{'0': {'precision': 0.42408803324215405, 'recall': 0.4709892862112147, 'f1-score': 0.4463098678210805, 'support': 43122}, '1': {'precision': 0.4728641324802409, 'recall': 0.27507991417436617, 'f1-score': 0.3478212723547977, 'support': 45674}, '2': {'precision': 0.40352926600470806, 'recall': 0.5407219428896689, 'f1-score': 0.46215906672207413, 'support': 42164}, 'accuracy': 0.4251145387904704, 'macro avg': {'precision': 0.43349381057570097, 'recall': 0.42893038109174997, 'f1-score': 0.4187634022993174, 'support': 130960}, 'weighted avg': {'precision': 0.4344802117302474, 'recall': 0.4251145387904704, 'f1-score': 0.41706351407287107, 'support': 130960}}
[[20310  7277 15535]
 [14945 12564 18165]
 [12636  6729 22799]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0724652
{'0': {'precision': 0.416864379608849, 'recall': 0.46234264988265417, 'f1-score': 0.4384272997032641, 'support': 14061}, '1': {'precision': 0.4461267240485326, 'recall': 0.29211652067630883, 'f1-score': 0.35305703734099303, 'support': 14727}, '2': {'precision': 0.4109665531297113, 'recall': 0.5125705132669406, 'f1-score': 0.4561794967150118, 'support': 14359}, 'accuracy': 0.42095626578904677, 'macro avg': {'precision': 0.4246525522623643, 'recall': 0.4223432279419678, 'f1-score': 0.415887944586423, 'support': 43147}, 'weighted avg': {'precision': 0.4248894950548657, 'recall': 0.42095626578904677, 'f1-score': 0.4151963900938479, 'support': 43147}}
[[6501 2723 4837]
 [4713 4302 5712]
 [4381 2618 7360]]
training model: results/XRAY/W6/deepLOB_L2/h30
Epoch 1/50
512/512 - 26s - loss: 3.3249 - accuracy30: 0.3597 - val_loss: 3.3197 - val_accuracy30: 0.3649 - 26s/epoch - 50ms/step
Epoch 2/50
512/512 - 23s - loss: 3.2604 - accuracy30: 0.3861 - val_loss: 3.2845 - val_accuracy30: 0.3839 - 23s/epoch - 45ms/step
Epoch 3/50
512/512 - 23s - loss: 3.2235 - accuracy30: 0.4103 - val_loss: 3.2581 - val_accuracy30: 0.4042 - 23s/epoch - 45ms/step
Epoch 4/50
512/512 - 23s - loss: 3.2062 - accuracy30: 0.4183 - val_loss: 3.2831 - val_accuracy30: 0.3912 - 23s/epoch - 45ms/step
Epoch 5/50
512/512 - 23s - loss: 3.1893 - accuracy30: 0.4272 - val_loss: 3.2864 - val_accuracy30: 0.3955 - 23s/epoch - 44ms/step
Epoch 6/50
512/512 - 23s - loss: 3.1767 - accuracy30: 0.4360 - val_loss: 3.2827 - val_accuracy30: 0.4043 - 23s/epoch - 44ms/step
Epoch 7/50
512/512 - 23s - loss: 3.1661 - accuracy30: 0.4395 - val_loss: 3.2762 - val_accuracy30: 0.4052 - 23s/epoch - 44ms/step
Epoch 8/50
512/512 - 22s - loss: 3.1540 - accuracy30: 0.4445 - val_loss: 3.2527 - val_accuracy30: 0.4123 - 22s/epoch - 44ms/step
Epoch 9/50
512/512 - 22s - loss: 3.1418 - accuracy30: 0.4496 - val_loss: 3.2588 - val_accuracy30: 0.4103 - 22s/epoch - 44ms/step
Epoch 10/50
512/512 - 22s - loss: 3.1343 - accuracy30: 0.4524 - val_loss: 3.2580 - val_accuracy30: 0.4085 - 22s/epoch - 44ms/step
Epoch 11/50
512/512 - 23s - loss: 3.1277 - accuracy30: 0.4566 - val_loss: 3.2570 - val_accuracy30: 0.4135 - 23s/epoch - 45ms/step
Epoch 12/50
512/512 - 23s - loss: 3.1196 - accuracy30: 0.4590 - val_loss: 3.2747 - val_accuracy30: 0.4125 - 23s/epoch - 44ms/step
Epoch 13/50
512/512 - 23s - loss: 3.1114 - accuracy30: 0.4609 - val_loss: 3.2657 - val_accuracy30: 0.4146 - 23s/epoch - 44ms/step
Epoch 14/50
512/512 - 23s - loss: 3.1025 - accuracy30: 0.4646 - val_loss: 3.2836 - val_accuracy30: 0.4114 - 23s/epoch - 44ms/step
Epoch 15/50
512/512 - 22s - loss: 3.0971 - accuracy30: 0.4680 - val_loss: 3.2872 - val_accuracy30: 0.4102 - 22s/epoch - 44ms/step
Epoch 16/50
512/512 - 22s - loss: 3.0897 - accuracy30: 0.4704 - val_loss: 3.2836 - val_accuracy30: 0.4109 - 22s/epoch - 43ms/step
Epoch 17/50
512/512 - 23s - loss: 3.0818 - accuracy30: 0.4718 - val_loss: 3.3016 - val_accuracy30: 0.4102 - 23s/epoch - 44ms/step
Epoch 18/50
512/512 - 22s - loss: 3.0733 - accuracy30: 0.4763 - val_loss: 3.3088 - val_accuracy30: 0.4110 - 22s/epoch - 44ms/step
testing model: results/XRAY/W6/deepLOB_L2/h30
Evaluating performance on  test set...
1214/1214 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0655435
{'0': {'precision': 0.442946894765887, 'recall': 0.540941963244252, 'f1-score': 0.48706428763142845, 'support': 115737}, '1': {'precision': 0.3698845675215631, 'recall': 0.31962177862925656, 'f1-score': 0.34292117547209844, 'support': 80905}, '2': {'precision': 0.4627227384256466, 'recall': 0.4034457060190259, 'f1-score': 0.4310558831657291, 'support': 114055}, 'accuracy': 0.4328364934325082, 'macro avg': {'precision': 0.4251847335710323, 'recall': 0.42133648263084483, 'f1-score': 0.42034711542308534, 'support': 310697}, 'weighted avg': {'precision': 0.43118117531224526, 'recall': 0.4328364934325082, 'f1-score': 0.42896930422127016, 'support': 310697}}
[[62607 23446 29684]
 [31301 25859 23745]
 [47434 20606 46015]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.07389
{'0': {'precision': 0.4114905501961927, 'recall': 0.5422462066473989, 'f1-score': 0.46790519147775433, 'support': 44288}, '1': {'precision': 0.42488666122265084, 'recall': 0.3486931805051649, 'f1-score': 0.38303759551189304, 'support': 43273}, '2': {'precision': 0.43795502345898724, 'recall': 0.3742482545680776, 'f1-score': 0.40360315586755297, 'support': 43399}, 'accuracy': 0.42261759315821623, 'macro avg': {'precision': 0.42477741162594357, 'recall': 0.42172921390688045, 'f1-score': 0.4181819809524001, 'support': 130960}, 'weighted avg': {'precision': 0.4246871108832723, 'recall': 0.42261759315821623, 'f1-score': 0.4185533319505869, 'support': 130960}}
[[24015 10363  9910]
 [17250 15089 10934]
 [17096 10061 16242]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0837872
{'0': {'precision': 0.39865413067341193, 'recall': 0.5723192874272011, 'f1-score': 0.46995611567458084, 'support': 14595}, '1': {'precision': 0.40959445140159906, 'recall': 0.31287711552612213, 'f1-score': 0.3547620040882733, 'support': 13590}, '2': {'precision': 0.4428172352493016, 'recall': 0.3496190348883839, 'f1-score': 0.39073762838468723, 'support': 14962}, 'accuracy': 0.41337752335040673, 'macro avg': {'precision': 0.4170219391081042, 'recall': 0.4116051459472357, 'f1-score': 0.4051519160491805, 'support': 43147}, 'weighted avg': {'precision': 0.4174143533855478, 'recall': 0.41337752335040673, 'f1-score': 0.40620301619398413, 'support': 43147}}
[[8353 3078 3164]
 [5920 4252 3418]
 [6680 3051 5231]]
training model: results/XRAY/W6/deepLOB_L2/h50
Epoch 1/50
512/512 - 25s - loss: 3.3327 - accuracy50: 0.3495 - val_loss: 3.3761 - val_accuracy50: 0.3308 - 25s/epoch - 49ms/step
Epoch 2/50
512/512 - 23s - loss: 3.2859 - accuracy50: 0.3654 - val_loss: 3.3127 - val_accuracy50: 0.3511 - 23s/epoch - 44ms/step
Epoch 3/50
512/512 - 23s - loss: 3.2594 - accuracy50: 0.3861 - val_loss: 3.3045 - val_accuracy50: 0.3633 - 23s/epoch - 44ms/step
Epoch 4/50
512/512 - 23s - loss: 3.2403 - accuracy50: 0.3993 - val_loss: 3.3071 - val_accuracy50: 0.3665 - 23s/epoch - 44ms/step
Epoch 5/50
512/512 - 23s - loss: 3.2257 - accuracy50: 0.4074 - val_loss: 3.3019 - val_accuracy50: 0.3732 - 23s/epoch - 44ms/step
Epoch 6/50
512/512 - 23s - loss: 3.2168 - accuracy50: 0.4124 - val_loss: 3.2928 - val_accuracy50: 0.3793 - 23s/epoch - 45ms/step
Epoch 7/50
512/512 - 23s - loss: 3.2069 - accuracy50: 0.4173 - val_loss: 3.3065 - val_accuracy50: 0.3746 - 23s/epoch - 45ms/step
Epoch 8/50
512/512 - 23s - loss: 3.1986 - accuracy50: 0.4221 - val_loss: 3.2896 - val_accuracy50: 0.3840 - 23s/epoch - 45ms/step
Epoch 9/50
512/512 - 22s - loss: 3.1920 - accuracy50: 0.4246 - val_loss: 3.2921 - val_accuracy50: 0.3839 - 22s/epoch - 44ms/step
Epoch 10/50
512/512 - 22s - loss: 3.1810 - accuracy50: 0.4304 - val_loss: 3.2923 - val_accuracy50: 0.3854 - 22s/epoch - 44ms/step
Epoch 11/50
512/512 - 22s - loss: 3.1749 - accuracy50: 0.4302 - val_loss: 3.2924 - val_accuracy50: 0.3848 - 22s/epoch - 44ms/step
Epoch 12/50
512/512 - 22s - loss: 3.1670 - accuracy50: 0.4347 - val_loss: 3.2901 - val_accuracy50: 0.3896 - 22s/epoch - 44ms/step
Epoch 13/50
512/512 - 22s - loss: 3.1596 - accuracy50: 0.4385 - val_loss: 3.2941 - val_accuracy50: 0.3892 - 22s/epoch - 44ms/step
Epoch 14/50
512/512 - 22s - loss: 3.1517 - accuracy50: 0.4408 - val_loss: 3.3168 - val_accuracy50: 0.3824 - 22s/epoch - 44ms/step
Epoch 15/50
512/512 - 23s - loss: 3.1453 - accuracy50: 0.4444 - val_loss: 3.3107 - val_accuracy50: 0.3861 - 23s/epoch - 45ms/step
Epoch 16/50
512/512 - 22s - loss: 3.1359 - accuracy50: 0.4478 - val_loss: 3.3189 - val_accuracy50: 0.3860 - 22s/epoch - 44ms/step
Epoch 17/50
512/512 - 22s - loss: 3.1278 - accuracy50: 0.4525 - val_loss: 3.3315 - val_accuracy50: 0.3829 - 22s/epoch - 44ms/step
Epoch 18/50
512/512 - 23s - loss: 3.1180 - accuracy50: 0.4552 - val_loss: 3.3423 - val_accuracy50: 0.3864 - 23s/epoch - 44ms/step
testing model: results/XRAY/W6/deepLOB_L2/h50
Evaluating performance on  test set...
1214/1214 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0867485
{'0': {'precision': 0.41434761038531503, 'recall': 0.5477735413460193, 'f1-score': 0.4718088932575594, 'support': 114352}, '1': {'precision': 0.337160673611889, 'recall': 0.21533160041017815, 'f1-score': 0.2628139825945222, 'support': 83866}, '2': {'precision': 0.4278406946017365, 'recall': 0.4030441237919967, 'f1-score': 0.4150724000750782, 'support': 112479}, 'accuracy': 0.4056427966797233, 'macro avg': {'precision': 0.39311632619964687, 'recall': 0.3887164218493981, 'f1-score': 0.38323175864238657, 'support': 310697}, 'weighted avg': {'precision': 0.3983974370014031, 'recall': 0.4056427966797233, 'f1-score': 0.39485536234371543, 'support': 310697}}
[[62639 18262 33451]
 [38632 18059 27175]
 [49904 17241 45334]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0870484
{'0': {'precision': 0.39121121243650164, 'recall': 0.5720422409164131, 'f1-score': 0.46465307309271986, 'support': 44696}, '1': {'precision': 0.4002642007926024, 'recall': 0.18477343090346185, 'f1-score': 0.25283224750473376, 'support': 42636}, '2': {'precision': 0.3978485257610731, 'recall': 0.4187677638213991, 'f1-score': 0.4080402010050251, 'support': 43628}, 'accuracy': 0.3948992058643861, 'macro avg': {'precision': 0.3964413129967257, 'recall': 0.391861145213758, 'f1-score': 0.3751751738674929, 'support': 130960}, 'weighted avg': {'precision': 0.3963697029471546, 'recall': 0.3948992058643861, 'f1-score': 0.37683160773527236, 'support': 130960}}
[[25568  5848 13280]
 [20386  7878 14372]
 [19402  5956 18270]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0952404
{'0': {'precision': 0.37162683114880496, 'recall': 0.5996267883060336, 'f1-score': 0.45886552955176524, 'support': 14469}, '1': {'precision': 0.39285714285714285, 'recall': 0.15766613580425656, 'f1-score': 0.22502324620312017, 'support': 13814}, '2': {'precision': 0.39973346426316897, 'recall': 0.3834095801937567, 'f1-score': 0.3914013941828921, 'support': 14864}, 'accuracy': 0.3836419681553758, 'macro avg': {'precision': 0.38807247942303896, 'recall': 0.38023416810134897, 'f1-score': 0.3584300566459258, 'support': 43147}, 'weighted avg': {'precision': 0.3881065984686856, 'recall': 0.3836419681553758, 'f1-score': 0.36075710462532506, 'support': 43147}}
[[8676 1716 4077]
 [7155 2178 4481]
 [7515 1650 5699]]
training model: results/XRAY/W6/deepLOB_L2/h100
Epoch 1/50
512/512 - 25s - loss: 3.3391 - accuracy100: 0.3456 - val_loss: 3.3484 - val_accuracy100: 0.3346 - 25s/epoch - 48ms/step
Epoch 2/50
512/512 - 23s - loss: 3.3013 - accuracy100: 0.3548 - val_loss: 3.3337 - val_accuracy100: 0.3367 - 23s/epoch - 45ms/step
Epoch 3/50
512/512 - 23s - loss: 3.2861 - accuracy100: 0.3643 - val_loss: 3.3079 - val_accuracy100: 0.3482 - 23s/epoch - 45ms/step
Epoch 4/50
512/512 - 23s - loss: 3.2751 - accuracy100: 0.3711 - val_loss: 3.3023 - val_accuracy100: 0.3533 - 23s/epoch - 44ms/step
Epoch 5/50
512/512 - 22s - loss: 3.2660 - accuracy100: 0.3796 - val_loss: 3.3017 - val_accuracy100: 0.3543 - 22s/epoch - 43ms/step
Epoch 6/50
512/512 - 22s - loss: 3.2584 - accuracy100: 0.3843 - val_loss: 3.3157 - val_accuracy100: 0.3579 - 22s/epoch - 44ms/step
Epoch 7/50
512/512 - 23s - loss: 3.2475 - accuracy100: 0.3939 - val_loss: 3.2994 - val_accuracy100: 0.3556 - 23s/epoch - 44ms/step
Epoch 8/50
512/512 - 23s - loss: 3.2423 - accuracy100: 0.3964 - val_loss: 3.3006 - val_accuracy100: 0.3600 - 23s/epoch - 44ms/step
Epoch 9/50
512/512 - 22s - loss: 3.2343 - accuracy100: 0.4019 - val_loss: 3.3190 - val_accuracy100: 0.3579 - 22s/epoch - 44ms/step
Epoch 10/50
512/512 - 23s - loss: 3.2277 - accuracy100: 0.4036 - val_loss: 3.3161 - val_accuracy100: 0.3604 - 23s/epoch - 44ms/step
Epoch 11/50
512/512 - 23s - loss: 3.2220 - accuracy100: 0.4085 - val_loss: 3.3132 - val_accuracy100: 0.3630 - 23s/epoch - 44ms/step
Epoch 12/50
512/512 - 22s - loss: 3.2118 - accuracy100: 0.4129 - val_loss: 3.3218 - val_accuracy100: 0.3598 - 22s/epoch - 44ms/step
Epoch 13/50
512/512 - 23s - loss: 3.2054 - accuracy100: 0.4172 - val_loss: 3.3212 - val_accuracy100: 0.3603 - 23s/epoch - 44ms/step
Epoch 14/50
512/512 - 22s - loss: 3.1970 - accuracy100: 0.4223 - val_loss: 3.3173 - val_accuracy100: 0.3601 - 22s/epoch - 43ms/step
Epoch 15/50
512/512 - 23s - loss: 3.1908 - accuracy100: 0.4235 - val_loss: 3.3253 - val_accuracy100: 0.3596 - 23s/epoch - 44ms/step
Epoch 16/50
512/512 - 23s - loss: 3.1805 - accuracy100: 0.4292 - val_loss: 3.3472 - val_accuracy100: 0.3537 - 23s/epoch - 44ms/step
Epoch 17/50
512/512 - 23s - loss: 3.1699 - accuracy100: 0.4356 - val_loss: 3.3594 - val_accuracy100: 0.3572 - 23s/epoch - 45ms/step
testing model: results/XRAY/W6/deepLOB_L2/h100
Evaluating performance on  test set...
1214/1214 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0883688
{'0': {'precision': 0.3983633591586546, 'recall': 0.4424859811469107, 'f1-score': 0.41926702770853036, 'support': 115737}, '1': {'precision': 0.28832918859522294, 'recall': 0.12397732076691617, 'f1-score': 0.17339663327768504, 'support': 80426}, '2': {'precision': 0.3999688260289105, 'recall': 0.5152967677720153, 'f1-score': 0.45036685451347425, 'support': 114534}, 'accuracy': 0.38687853439202824, 'macro avg': {'precision': 0.36222045792759605, 'recall': 0.3605866898952807, 'f1-score': 0.3476768384998965, 'support': 310697}, 'weighted avg': {'precision': 0.37047210929394186, 'recall': 0.38687853439202824, 'f1-score': 0.36708633468858576, 'support': 310697}}
[[51212 12237 52288]
 [34203  9971 36252]
 [43141 12374 59019]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0974783
{'0': {'precision': 0.3674859510699892, 'recall': 0.44196154283763794, 'f1-score': 0.40129757427992896, 'support': 43945}, '1': {'precision': 0.391718813965729, 'recall': 0.1514493736715959, 'f1-score': 0.2184427231960864, 'support': 44226}, '2': {'precision': 0.3553679724635306, 'recall': 0.5066956460772628, 'f1-score': 0.41774968930336515, 'support': 42789}, 'accuracy': 0.3650045815516188, 'macro avg': {'precision': 0.3715242458330829, 'recall': 0.36670218752883227, 'f1-score': 0.3458299955931268, 'support': 130960}, 'weighted avg': {'precision': 0.37171019059224963, 'recall': 0.3650045815516188, 'f1-score': 0.3449218176038736, 'support': 130960}}
[[19422  5193 19330]
 [17529  6698 19999]
 [15900  5208 21681]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1005422
{'0': {'precision': 0.35134210976235253, 'recall': 0.4353506108325683, 'f1-score': 0.388860855304655, 'support': 14161}, '1': {'precision': 0.3795392424834049, 'recall': 0.13405047579644186, 'f1-score': 0.198124745209947, 'support': 14502}, '2': {'precision': 0.3600937591561676, 'recall': 0.5091135045567523, 'f1-score': 0.42182941479320407, 'support': 14484}, 'accuracy': 0.3588430250075324, 'macro avg': {'precision': 0.36365837046730837, 'recall': 0.35950486372858753, 'f1-score': 0.33627167176926864, 'support': 43147}, 'weighted avg': {'precision': 0.3637571955977691, 'recall': 0.3588430250075324, 'f1-score': 0.33582035531713994, 'support': 43147}}
[[6165 1595 6401]
 [5855 1944 6703]
 [5527 1583 7374]]
training model: results/XRAY/W6/deepLOB_L2/h200
Epoch 1/50
512/512 - 24s - loss: 3.3307 - accuracy200: 0.3568 - val_loss: 3.3307 - val_accuracy200: 0.3472 - 24s/epoch - 48ms/step
Epoch 2/50
512/512 - 22s - loss: 3.2871 - accuracy200: 0.3696 - val_loss: 3.3528 - val_accuracy200: 0.3395 - 22s/epoch - 44ms/step
Epoch 3/50
512/512 - 23s - loss: 3.2717 - accuracy200: 0.3797 - val_loss: 3.3447 - val_accuracy200: 0.3391 - 23s/epoch - 44ms/step
Epoch 4/50
512/512 - 22s - loss: 3.2616 - accuracy200: 0.3852 - val_loss: 3.3509 - val_accuracy200: 0.3394 - 22s/epoch - 44ms/step
Epoch 5/50
512/512 - 22s - loss: 3.2501 - accuracy200: 0.3952 - val_loss: 3.4241 - val_accuracy200: 0.3302 - 22s/epoch - 44ms/step
Epoch 6/50
512/512 - 22s - loss: 3.2442 - accuracy200: 0.3975 - val_loss: 3.4569 - val_accuracy200: 0.3218 - 22s/epoch - 43ms/step
Epoch 7/50
512/512 - 22s - loss: 3.2311 - accuracy200: 0.4060 - val_loss: 3.4060 - val_accuracy200: 0.3304 - 22s/epoch - 44ms/step
Epoch 8/50
512/512 - 22s - loss: 3.2167 - accuracy200: 0.4140 - val_loss: 3.4167 - val_accuracy200: 0.3381 - 22s/epoch - 44ms/step
Epoch 9/50
512/512 - 22s - loss: 3.2035 - accuracy200: 0.4186 - val_loss: 3.3941 - val_accuracy200: 0.3349 - 22s/epoch - 44ms/step
Epoch 10/50
512/512 - 22s - loss: 3.1963 - accuracy200: 0.4228 - val_loss: 3.4044 - val_accuracy200: 0.3297 - 22s/epoch - 44ms/step
Epoch 11/50
512/512 - 23s - loss: 3.1851 - accuracy200: 0.4281 - val_loss: 3.4157 - val_accuracy200: 0.3378 - 23s/epoch - 44ms/step
testing model: results/XRAY/W6/deepLOB_L2/h200
Evaluating performance on  test set...
1214/1214 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1045011
{'0': {'precision': 0.3780624688210188, 'recall': 0.46468749733868153, 'f1-score': 0.41692295349396946, 'support': 117423}, '1': {'precision': 0.24878956220376128, 'recall': 0.12713398356621047, 'f1-score': 0.16827681303055114, 'support': 76793}, '2': {'precision': 0.384568187717794, 'recall': 0.41971652029086287, 'f1-score': 0.40137433910216413, 'support': 116481}, 'accuracy': 0.3643968239152615, 'macro avg': {'precision': 0.33714007291419135, 'recall': 0.3371793337319183, 'f1-score': 0.3288580352088949, 'support': 310697}, 'weighted avg': {'precision': 0.34854991583517153, 'recall': 0.3643968239152615, 'f1-score': 0.34963745920989475, 'support': 310697}}
[[54565 15489 47369]
 [36161  9763 30869]
 [53602 13990 48889]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1132869
{'0': {'precision': 0.3469299758537427, 'recall': 0.4465435332770945, 'f1-score': 0.39048395550637705, 'support': 45046}, '1': {'precision': 0.3500033473923813, 'recall': 0.12157856794028046, 'f1-score': 0.18046877696848354, 'support': 43001}, '2': {'precision': 0.3310993573729821, 'recall': 0.44783631999627155, 'f1-score': 0.3807203138000713, 'support': 42913}, 'accuracy': 0.34026420281001835, 'macro avg': {'precision': 0.3426775602063687, 'recall': 0.33865280707121553, 'f1-score': 0.3172243487583106, 'support': 130960}, 'weighted avg': {'precision': 0.34275174371162387, 'recall': 0.34026420281001835, 'f1-score': 0.31832566405211116, 'support': 130960}}
[[20115  5067 19864]
 [18812  5228 18961]
 [19053  4642 19218]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.10863
{'0': {'precision': 0.3571727748691099, 'recall': 0.4508028811207295, 'f1-score': 0.39856279029007097, 'support': 15133}, '1': {'precision': 0.30940658201606636, 'recall': 0.09415661225455406, 'f1-score': 0.14437726723095526, 'support': 12681}, '2': {'precision': 0.35382405389340205, 'recall': 0.4658579534337703, 'f1-score': 0.4021846231806537, 'support': 15333}, 'accuracy': 0.3513338123160359, 'macro avg': {'precision': 0.34013447025952614, 'recall': 0.3369391489363513, 'f1-score': 0.31504156023389335, 'support': 43147}, 'weighted avg': {'precision': 0.3419441603584841, 'recall': 0.3513338123160359, 'f1-score': 0.3251441736029006, 'support': 43147}}
[[6822 1345 6966]
 [5408 1194 6079]
 [6870 1320 7143]]
training model: results/XRAY/W6/deepLOB_L2/h300
Epoch 1/50
512/512 - 26s - loss: 3.3388 - accuracy300: 0.3540 - val_loss: 3.4706 - val_accuracy300: 0.3364 - 26s/epoch - 51ms/step
Epoch 2/50
512/512 - 23s - loss: 3.2889 - accuracy300: 0.3709 - val_loss: 3.3978 - val_accuracy300: 0.3364 - 23s/epoch - 44ms/step
Epoch 3/50
512/512 - 23s - loss: 3.2662 - accuracy300: 0.3855 - val_loss: 3.4397 - val_accuracy300: 0.3345 - 23s/epoch - 44ms/step
Epoch 4/50
512/512 - 23s - loss: 3.2587 - accuracy300: 0.3907 - val_loss: 3.4376 - val_accuracy300: 0.3399 - 23s/epoch - 44ms/step
Epoch 5/50
512/512 - 23s - loss: 3.2462 - accuracy300: 0.3980 - val_loss: 3.4128 - val_accuracy300: 0.3401 - 23s/epoch - 44ms/step
Epoch 6/50
512/512 - 23s - loss: 3.2314 - accuracy300: 0.4088 - val_loss: 3.4124 - val_accuracy300: 0.3360 - 23s/epoch - 44ms/step
Epoch 7/50
512/512 - 23s - loss: 3.2187 - accuracy300: 0.4179 - val_loss: 3.4510 - val_accuracy300: 0.3404 - 23s/epoch - 45ms/step
Epoch 8/50
512/512 - 23s - loss: 3.2080 - accuracy300: 0.4208 - val_loss: 3.5046 - val_accuracy300: 0.3385 - 23s/epoch - 44ms/step
Epoch 9/50
512/512 - 23s - loss: 3.1975 - accuracy300: 0.4272 - val_loss: 3.5834 - val_accuracy300: 0.3394 - 23s/epoch - 45ms/step
Epoch 10/50
512/512 - 23s - loss: 3.1837 - accuracy300: 0.4320 - val_loss: 3.5424 - val_accuracy300: 0.3432 - 23s/epoch - 45ms/step
Epoch 11/50
512/512 - 23s - loss: 3.1747 - accuracy300: 0.4363 - val_loss: 3.5813 - val_accuracy300: 0.3452 - 23s/epoch - 45ms/step
Epoch 12/50
512/512 - 23s - loss: 3.1609 - accuracy300: 0.4421 - val_loss: 3.5787 - val_accuracy300: 0.3460 - 23s/epoch - 45ms/step
testing model: results/XRAY/W6/deepLOB_L2/h300
Evaluating performance on  test set...
1214/1214 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1314292
{'0': {'precision': 0.3691319945749661, 'recall': 0.30566147102243396, 'f1-score': 0.3344117399339084, 'support': 110413}, '1': {'precision': 0.3101563892165265, 'recall': 0.3965822166766126, 'f1-score': 0.3480848713406853, 'support': 92165}, '2': {'precision': 0.3722269330125614, 'recall': 0.34917082103978025, 'f1-score': 0.3603304365255487, 'support': 108119}, 'accuracy': 0.3477729105849107, 'macro avg': {'precision': 0.3505051056013513, 'recall': 0.3504715029129423, 'f1-score': 0.3476090159333807, 'support': 310697}, 'weighted avg': {'precision': 0.35271450416171385, 'recall': 0.3477729105849107, 'f1-score': 0.3474871404459737, 'support': 310697}}
[[33749 41292 35372]
 [27316 36551 28298]
 [30363 40004 37752]]
Evaluating performance on  train set...
512/512 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1232392
{'0': {'precision': 0.3510827121050763, 'recall': 0.29217798381965276, 'f1-score': 0.3189333333333333, 'support': 44004}, '1': {'precision': 0.3563901018922853, 'recall': 0.4039019883864156, 'f1-score': 0.37866149769561497, 'support': 45464}, '2': {'precision': 0.32353902928948475, 'recall': 0.3338474886725152, 'f1-score': 0.32861243565108056, 'support': 41492}, 'accuracy': 0.34416615760537567, 'macro avg': {'precision': 0.3436706144289488, 'recall': 0.3433091536261945, 'f1-score': 0.3420690888933429, 'support': 130960}, 'weighted avg': {'precision': 0.34419856948061955, 'recall': 0.34416615760537567, 'f1-score': 0.3427351550952052, 'support': 130960}}
[[12857 17157 13990]
 [12129 18363 14972]
 [11635 16005 13852]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.129778
{'0': {'precision': 0.32667785234899327, 'recall': 0.28091184533256386, 'f1-score': 0.30207121247381896, 'support': 13862}, '1': {'precision': 0.34903179536218026, 'recall': 0.3886855241264559, 'f1-score': 0.3677929275435337, 'support': 15025}, '2': {'precision': 0.3323214901690238, 'recall': 0.33779803646563816, 'f1-score': 0.335037384802643, 'support': 14260}, 'accuracy': 0.33724245022828936, 'macro avg': {'precision': 0.3360103792933991, 'recall': 0.33579846864155266, 'f1-score': 0.33496717493999856, 'support': 43147}, 'weighted avg': {'precision': 0.3363273359535723, 'recall': 0.33724245022828936, 'f1-score': 0.3358526199026436, 'support': 43147}}
[[3894 5482 4486]
 [3993 5840 5192]
 [4033 5410 4817]]
training model: results/XRAY/W6/deepLOB_L2/h500
Epoch 1/50
512/512 - 25s - loss: 3.3457 - accuracy500: 0.3508 - val_loss: 3.3429 - val_accuracy500: 0.3345 - 25s/epoch - 48ms/step
Epoch 2/50
512/512 - 23s - loss: 3.3024 - accuracy500: 0.3577 - val_loss: 3.3408 - val_accuracy500: 0.3289 - 23s/epoch - 44ms/step
Epoch 3/50
512/512 - 23s - loss: 3.2806 - accuracy500: 0.3675 - val_loss: 3.3476 - val_accuracy500: 0.3335 - 23s/epoch - 45ms/step
Epoch 4/50
512/512 - 23s - loss: 3.2627 - accuracy500: 0.3841 - val_loss: 3.4028 - val_accuracy500: 0.3401 - 23s/epoch - 44ms/step
Epoch 5/50
512/512 - 23s - loss: 3.2451 - accuracy500: 0.3975 - val_loss: 3.4102 - val_accuracy500: 0.3305 - 23s/epoch - 45ms/step
Epoch 6/50
512/512 - 23s - loss: 3.2243 - accuracy500: 0.4125 - val_loss: 3.5349 - val_accuracy500: 0.3272 - 23s/epoch - 45ms/step
Epoch 7/50
512/512 - 23s - loss: 3.2163 - accuracy500: 0.4160 - val_loss: 3.4858 - val_accuracy500: 0.3200 - 23s/epoch - 45ms/step
Epoch 8/50
512/512 - 23s - loss: 3.1988 - accuracy500: 0.4261 - val_loss: 3.5096 - val_accuracy500: 0.3256 - 23s/epoch - 45ms/step
Epoch 9/50
512/512 - 23s - loss: 3.1832 - accuracy500: 0.4325 - val_loss: 3.5551 - val_accuracy500: 0.3357 - 23s/epoch - 45ms/step
Epoch 10/50
512/512 - 22s - loss: 3.1700 - accuracy500: 0.4376 - val_loss: 3.5601 - val_accuracy500: 0.3345 - 22s/epoch - 44ms/step
Epoch 11/50
512/512 - 23s - loss: 3.1615 - accuracy500: 0.4444 - val_loss: 3.6406 - val_accuracy500: 0.3326 - 23s/epoch - 45ms/step
Epoch 12/50
512/512 - 23s - loss: 3.1497 - accuracy500: 0.4486 - val_loss: 3.6936 - val_accuracy500: 0.3319 - 23s/epoch - 44ms/step
testing model: results/XRAY/W6/deepLOB_L2/h500
Evaluating performance on  test set...
1214/1214 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1152375
{'0': {'precision': 0.377290943940186, 'recall': 0.20527272883970663, 'f1-score': 0.26588524224157173, 'support': 116031}, '1': {'precision': 0.2742580898850415, 'recall': 0.42221272656055264, 'f1-score': 0.3325200516013237, 'support': 84249}, '2': {'precision': 0.37200621028429864, 'recall': 0.397112763433167, 'f1-score': 0.3841497069465495, 'support': 110417}, 'accuracy': 0.33227549670579376, 'macro avg': {'precision': 0.34118508136984205, 'recall': 0.34153273961114206, 'f1-score': 0.32751833359648164, 'support': 310697}, 'weighted avg': {'precision': 0.347474307933485, 'recall': 0.33227549670579376, 'f1-score': 0.32598341973629896, 'support': 310697}}
[[23818 49557 42656]
 [17313 35571 31365]
 [21998 44571 43848]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.111268
{'0': {'precision': 0.370309659344917, 'recall': 0.2642323969121494, 'f1-score': 0.30840448768864176, 'support': 47023}, '1': {'precision': 0.30650422576978203, 'recall': 0.3072787632543851, 'f1-score': 0.30689100581467277, 'support': 40364}, '2': {'precision': 0.33146590330341935, 'recall': 0.43315814839464806, 'f1-score': 0.37554967467218503, 'support': 43573}, 'accuracy': 0.3337049480757483, 'macro avg': {'precision': 0.3360932628060394, 'recall': 0.33488976952039423, 'f1-score': 0.33028172272516654, 'support': 130960}, 'weighted avg': {'precision': 0.3377196967393663, 'recall': 0.3337049480757483, 'f1-score': 0.3302785488529137, 'support': 130960}}
[[12425 14736 19862]
 [ 9756 12403 18205]
 [11372 13327 18874]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1125392
{'0': {'precision': 0.32547823676185195, 'recall': 0.24468528553563984, 'f1-score': 0.2793575252825699, 'support': 14394}, '1': {'precision': 0.30473245727046294, 'recall': 0.2603272433780908, 'f1-score': 0.2807850585628363, 'support': 13629}, '2': {'precision': 0.34414736740318136, 'recall': 0.47064268711980956, 'f1-score': 0.39757589298181917, 'support': 15124}, 'accuracy': 0.3288293508239275, 'macro avg': {'precision': 0.32478602047849875, 'recall': 0.32521840534451335, 'f1-score': 0.3192394922757418, 'support': 43147}, 'weighted avg': {'precision': 0.3254691446611573, 'recall': 0.3288293508239275, 'f1-score': 0.3212466588065738, 'support': 43147}}
[[3522 4032 6840]
 [3356 3548 6725]
 [3943 4063 7118]]
training model: results/XRAY/W6/deepLOB_L2/h1000
Epoch 1/50
512/512 - 26s - loss: 3.3390 - accuracy1000: 0.3641 - val_loss: 3.4580 - val_accuracy1000: 0.3517 - 26s/epoch - 50ms/step
Epoch 2/50
512/512 - 24s - loss: 3.2910 - accuracy1000: 0.3788 - val_loss: 3.4486 - val_accuracy1000: 0.3263 - 24s/epoch - 46ms/step
Epoch 3/50
512/512 - 23s - loss: 3.2607 - accuracy1000: 0.3926 - val_loss: 3.4636 - val_accuracy1000: 0.3263 - 23s/epoch - 46ms/step
Epoch 4/50
512/512 - 23s - loss: 3.2489 - accuracy1000: 0.3990 - val_loss: 3.5086 - val_accuracy1000: 0.3315 - 23s/epoch - 45ms/step
Epoch 5/50
512/512 - 23s - loss: 3.2137 - accuracy1000: 0.4172 - val_loss: 3.5978 - val_accuracy1000: 0.3309 - 23s/epoch - 45ms/step
Epoch 6/50
512/512 - 23s - loss: 3.1886 - accuracy1000: 0.4291 - val_loss: 3.7532 - val_accuracy1000: 0.3216 - 23s/epoch - 45ms/step
Epoch 7/50
512/512 - 23s - loss: 3.1665 - accuracy1000: 0.4375 - val_loss: 3.7477 - val_accuracy1000: 0.3249 - 23s/epoch - 45ms/step
Epoch 8/50
512/512 - 23s - loss: 3.1386 - accuracy1000: 0.4467 - val_loss: 3.8177 - val_accuracy1000: 0.3267 - 23s/epoch - 44ms/step
Epoch 9/50
512/512 - 23s - loss: 3.1226 - accuracy1000: 0.4553 - val_loss: 3.7997 - val_accuracy1000: 0.3211 - 23s/epoch - 44ms/step
Epoch 10/50
512/512 - 23s - loss: 3.1123 - accuracy1000: 0.4581 - val_loss: 3.9788 - val_accuracy1000: 0.3265 - 23s/epoch - 45ms/step
Epoch 11/50
512/512 - 23s - loss: 3.1024 - accuracy1000: 0.4600 - val_loss: 4.0098 - val_accuracy1000: 0.3218 - 23s/epoch - 45ms/step
Epoch 12/50
512/512 - 23s - loss: 3.0790 - accuracy1000: 0.4698 - val_loss: 3.8827 - val_accuracy1000: 0.3279 - 23s/epoch - 45ms/step
testing model: results/XRAY/W6/deepLOB_L2/h1000
Evaluating performance on  test set...
1214/1214 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1426101
{'0': {'precision': 0.38312116447735456, 'recall': 0.1989151042763851, 'f1-score': 0.2618688575737091, 'support': 113928}, '1': {'precision': 0.3039354641325183, 'recall': 0.5248584829370856, 'f1-score': 0.38495239300287853, 'support': 92745}, '2': {'precision': 0.37852210927155944, 'recall': 0.33253864492809354, 'f1-score': 0.35404352876757195, 'support': 104024}, 'accuracy': 0.3409495424802943, 'macro avg': {'precision': 0.3551929126271441, 'recall': 0.35210407738052146, 'f1-score': 0.3336215931147198, 'support': 310697}, 'weighted avg': {'precision': 0.3579439342588153, 'recall': 0.3409495424802943, 'f1-score': 0.3294709280463841, 'support': 310697}}
[[22662 59406 31860]
 [19132 48678 24935]
 [17357 52075 34592]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1298519
{'0': {'precision': 0.35903799769287237, 'recall': 0.2314278632748248, 'f1-score': 0.2814435249630076, 'support': 44381}, '1': {'precision': 0.363509091797034, 'recall': 0.48084584078037856, 'f1-score': 0.414024548522268, 'support': 46439}, '2': {'precision': 0.3297820349916919, 'recall': 0.3362232187344295, 'f1-score': 0.3329714793249778, 'support': 40140}, 'accuracy': 0.35199297495418447, 'macro avg': {'precision': 0.3507763748271994, 'recall': 0.3494989742632109, 'f1-score': 0.3428131842700845, 'support': 130960}, 'weighted avg': {'precision': 0.35165634525149925, 'recall': 0.35199297495418447, 'f1-score': 0.3442509641899317, 'support': 130960}}
[[10271 20725 13385]
 [10066 22330 14043]
 [ 8270 18374 13496]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1397078
{'0': {'precision': 0.30368540251183856, 'recall': 0.2220215247986754, 'f1-score': 0.2565105864962393, 'support': 13287}, '1': {'precision': 0.3441599921379785, 'recall': 0.44816995136933707, 'f1-score': 0.3893382250757386, 'support': 15628}, '2': {'precision': 0.3111909493961168, 'recall': 0.28604553119730186, 'f1-score': 0.2980888921432232, 'support': 14232}, 'accuracy': 0.3250515678957981, 'macro avg': {'precision': 0.31967878134864464, 'recall': 0.31874566912177144, 'f1-score': 0.31464590123840036, 'support': 43147}, 'weighted avg': {'precision': 0.3208211438133048, 'recall': 0.3250515678957981, 'f1-score': 0.31833580682878365, 'support': 43147}}
[[2950 6583 3754]
 [3367 7004 5257]
 [3397 6764 4071]]
training model: results/XRAY/W6/deepOF_L2/h10
Epoch 1/50
512/512 - 17s - loss: 3.2506 - accuracy10: 0.4080 - val_loss: 3.1884 - val_accuracy10: 0.4394 - 17s/epoch - 33ms/step
Epoch 2/50
512/512 - 14s - loss: 3.1495 - accuracy10: 0.4443 - val_loss: 3.1485 - val_accuracy10: 0.4530 - 14s/epoch - 27ms/step
Epoch 3/50
512/512 - 14s - loss: 3.1106 - accuracy10: 0.4573 - val_loss: 3.1263 - val_accuracy10: 0.4614 - 14s/epoch - 27ms/step
Epoch 4/50
512/512 - 14s - loss: 3.0822 - accuracy10: 0.4677 - val_loss: 3.1067 - val_accuracy10: 0.4683 - 14s/epoch - 27ms/step
Epoch 5/50
512/512 - 14s - loss: 3.0601 - accuracy10: 0.4764 - val_loss: 3.0951 - val_accuracy10: 0.4740 - 14s/epoch - 28ms/step
Epoch 6/50
512/512 - 14s - loss: 3.0443 - accuracy10: 0.4817 - val_loss: 3.0812 - val_accuracy10: 0.4751 - 14s/epoch - 27ms/step
Epoch 7/50
512/512 - 13s - loss: 3.0273 - accuracy10: 0.4866 - val_loss: 3.0769 - val_accuracy10: 0.4757 - 13s/epoch - 26ms/step
Epoch 8/50
512/512 - 14s - loss: 3.0139 - accuracy10: 0.4909 - val_loss: 3.0682 - val_accuracy10: 0.4764 - 14s/epoch - 27ms/step
Epoch 9/50
512/512 - 14s - loss: 2.9999 - accuracy10: 0.4962 - val_loss: 3.0631 - val_accuracy10: 0.4782 - 14s/epoch - 27ms/step
Epoch 10/50
512/512 - 13s - loss: 2.9887 - accuracy10: 0.4964 - val_loss: 3.0533 - val_accuracy10: 0.4781 - 13s/epoch - 26ms/step
Epoch 11/50
512/512 - 14s - loss: 2.9769 - accuracy10: 0.5034 - val_loss: 3.0512 - val_accuracy10: 0.4798 - 14s/epoch - 26ms/step
Epoch 12/50
512/512 - 13s - loss: 2.9672 - accuracy10: 0.5045 - val_loss: 3.0467 - val_accuracy10: 0.4743 - 13s/epoch - 26ms/step
Epoch 13/50
512/512 - 13s - loss: 2.9563 - accuracy10: 0.5069 - val_loss: 3.0456 - val_accuracy10: 0.4743 - 13s/epoch - 26ms/step
Epoch 14/50
512/512 - 13s - loss: 2.9497 - accuracy10: 0.5087 - val_loss: 3.0470 - val_accuracy10: 0.4748 - 13s/epoch - 26ms/step
Epoch 15/50
512/512 - 13s - loss: 2.9371 - accuracy10: 0.5119 - val_loss: 3.0440 - val_accuracy10: 0.4771 - 13s/epoch - 26ms/step
Epoch 16/50
512/512 - 13s - loss: 2.9273 - accuracy10: 0.5137 - val_loss: 3.0424 - val_accuracy10: 0.4785 - 13s/epoch - 26ms/step
Epoch 17/50
512/512 - 14s - loss: 2.9211 - accuracy10: 0.5151 - val_loss: 3.0457 - val_accuracy10: 0.4727 - 14s/epoch - 27ms/step
Epoch 18/50
512/512 - 14s - loss: 2.9063 - accuracy10: 0.5184 - val_loss: 3.0452 - val_accuracy10: 0.4787 - 14s/epoch - 27ms/step
Epoch 19/50
512/512 - 13s - loss: 2.9023 - accuracy10: 0.5188 - val_loss: 3.0494 - val_accuracy10: 0.4767 - 13s/epoch - 26ms/step
Epoch 20/50
512/512 - 13s - loss: 2.8925 - accuracy10: 0.5219 - val_loss: 3.0495 - val_accuracy10: 0.4739 - 13s/epoch - 26ms/step
Epoch 21/50
512/512 - 13s - loss: 2.8832 - accuracy10: 0.5237 - val_loss: 3.0565 - val_accuracy10: 0.4740 - 13s/epoch - 26ms/step
Epoch 22/50
512/512 - 13s - loss: 2.8749 - accuracy10: 0.5240 - val_loss: 3.0572 - val_accuracy10: 0.4713 - 13s/epoch - 25ms/step
Epoch 23/50
512/512 - 13s - loss: 2.8677 - accuracy10: 0.5279 - val_loss: 3.0703 - val_accuracy10: 0.4673 - 13s/epoch - 26ms/step
Epoch 24/50
512/512 - 14s - loss: 2.8565 - accuracy10: 0.5300 - val_loss: 3.0821 - val_accuracy10: 0.4635 - 14s/epoch - 27ms/step
Epoch 25/50
512/512 - 13s - loss: 2.8480 - accuracy10: 0.5321 - val_loss: 3.0785 - val_accuracy10: 0.4679 - 13s/epoch - 26ms/step
Epoch 26/50
512/512 - 13s - loss: 2.8379 - accuracy10: 0.5340 - val_loss: 3.0868 - val_accuracy10: 0.4624 - 13s/epoch - 25ms/step
testing model: results/XRAY/W6/deepOF_L2/h10
Evaluating performance on  test set...
1214/1214 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0297314
{'0': {'precision': 0.42813701977465046, 'recall': 0.5177746645360418, 'f1-score': 0.46870866586413423, 'support': 91366}, '1': {'precision': 0.5750596078612931, 'recall': 0.3881835441554484, 'f1-score': 0.4634939292594303, 'support': 127991}, '2': {'precision': 0.41825499345336953, 'recall': 0.5211255269064433, 'f1-score': 0.4640576403716595, 'support': 91335}, 'accuracy': 0.46537406820903016, 'macro avg': {'precision': 0.47381720702977104, 'recall': 0.4756945785326445, 'f1-score': 0.465420078498408, 'support': 310692}, 'weighted avg': {'precision': 0.4857574094137248, 'recall': 0.46537406820903016, 'f1-score': 0.46519315607911293, 'support': 310692}}
[[47307 18502 25557]
 [37662 49684 40645]
 [25526 18212 47597]]
Evaluating performance on  train set...
512/512 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9817762
{'0': {'precision': 0.43829277837887615, 'recall': 0.5376122437454114, 'f1-score': 0.48289855807642074, 'support': 35414}, '1': {'precision': 0.6437416481069043, 'recall': 0.47513685006493184, 'f1-score': 0.5467356454465494, 'support': 60833}, '2': {'precision': 0.4385631496210788, 'recall': 0.5384726183274278, 'f1-score': 0.4834096257790881, 'support': 34713}, 'accuracy': 0.5088194868662187, 'macro avg': {'precision': 0.5068658587022864, 'recall': 0.5170739040459237, 'f1-score': 0.5043479431006861, 'support': 130960}, 'weighted avg': {'precision': 0.5337987075869987, 'recall': 0.5088194868662187, 'f1-score': 0.5126873655684009, 'support': 130960}}
[[19039  8399  7976]
 [15976 28904 15953]
 [ 8424  7597 18692]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0164652
{'0': {'precision': 0.4093969144460028, 'recall': 0.5041886173244667, 'f1-score': 0.4518750725647277, 'support': 11579}, '1': {'precision': 0.6307135095979718, 'recall': 0.43952549217566883, 'f1-score': 0.5180425405325003, 'support': 19810}, '2': {'precision': 0.405012930177044, 'recall': 0.5195202857871906, 'f1-score': 0.4551754974290185, 'support': 11757}, 'accuracy': 0.47867705001622396, 'macro avg': {'precision': 0.4817077847403395, 'recall': 0.48774479842910873, 'f1-score': 0.4750310368420822, 'support': 43146}, 'weighted avg': {'precision': 0.5098173299401473, 'recall': 0.47867705001622396, 'f1-score': 0.48315446429446035, 'support': 43146}}
[[5838 2681 3060]
 [5190 8707 5913]
 [3232 2417 6108]]
training model: results/XRAY/W6/deepOF_L2/h20
Epoch 1/50
512/512 - 15s - loss: 3.2801 - accuracy20: 0.3831 - val_loss: 3.2173 - val_accuracy20: 0.4166 - 15s/epoch - 30ms/step
Epoch 2/50
512/512 - 13s - loss: 3.2054 - accuracy20: 0.4223 - val_loss: 3.1904 - val_accuracy20: 0.4281 - 13s/epoch - 26ms/step
Epoch 3/50
512/512 - 13s - loss: 3.1726 - accuracy20: 0.4359 - val_loss: 3.1711 - val_accuracy20: 0.4360 - 13s/epoch - 26ms/step
Epoch 4/50
512/512 - 14s - loss: 3.1508 - accuracy20: 0.4453 - val_loss: 3.1560 - val_accuracy20: 0.4425 - 14s/epoch - 27ms/step
Epoch 5/50
512/512 - 13s - loss: 3.1317 - accuracy20: 0.4521 - val_loss: 3.1440 - val_accuracy20: 0.4478 - 13s/epoch - 26ms/step
Epoch 6/50
512/512 - 13s - loss: 3.1182 - accuracy20: 0.4592 - val_loss: 3.1408 - val_accuracy20: 0.4502 - 13s/epoch - 26ms/step
Epoch 7/50
512/512 - 13s - loss: 3.1054 - accuracy20: 0.4636 - val_loss: 3.1283 - val_accuracy20: 0.4520 - 13s/epoch - 26ms/step
Epoch 8/50
512/512 - 14s - loss: 3.0920 - accuracy20: 0.4687 - val_loss: 3.1226 - val_accuracy20: 0.4559 - 14s/epoch - 27ms/step
Epoch 9/50
512/512 - 13s - loss: 3.0808 - accuracy20: 0.4728 - val_loss: 3.1158 - val_accuracy20: 0.4563 - 13s/epoch - 26ms/step
Epoch 10/50
512/512 - 13s - loss: 3.0701 - accuracy20: 0.4769 - val_loss: 3.1070 - val_accuracy20: 0.4600 - 13s/epoch - 25ms/step
Epoch 11/50
512/512 - 13s - loss: 3.0610 - accuracy20: 0.4808 - val_loss: 3.1061 - val_accuracy20: 0.4607 - 13s/epoch - 26ms/step
Epoch 12/50
512/512 - 13s - loss: 3.0493 - accuracy20: 0.4842 - val_loss: 3.0996 - val_accuracy20: 0.4626 - 13s/epoch - 26ms/step
Epoch 13/50
512/512 - 14s - loss: 3.0412 - accuracy20: 0.4855 - val_loss: 3.0977 - val_accuracy20: 0.4642 - 14s/epoch - 27ms/step
Epoch 14/50
512/512 - 14s - loss: 3.0320 - accuracy20: 0.4891 - val_loss: 3.0966 - val_accuracy20: 0.4651 - 14s/epoch - 27ms/step
Epoch 15/50
512/512 - 14s - loss: 3.0215 - accuracy20: 0.4924 - val_loss: 3.0947 - val_accuracy20: 0.4659 - 14s/epoch - 27ms/step
Epoch 16/50
512/512 - 13s - loss: 3.0154 - accuracy20: 0.4929 - val_loss: 3.0892 - val_accuracy20: 0.4688 - 13s/epoch - 26ms/step
Epoch 17/50
512/512 - 14s - loss: 3.0044 - accuracy20: 0.4975 - val_loss: 3.0979 - val_accuracy20: 0.4655 - 14s/epoch - 26ms/step
Epoch 18/50
512/512 - 13s - loss: 2.9938 - accuracy20: 0.5004 - val_loss: 3.1008 - val_accuracy20: 0.4628 - 13s/epoch - 25ms/step
Epoch 19/50
512/512 - 13s - loss: 2.9888 - accuracy20: 0.5025 - val_loss: 3.1102 - val_accuracy20: 0.4632 - 13s/epoch - 26ms/step
Epoch 20/50
512/512 - 14s - loss: 2.9805 - accuracy20: 0.5051 - val_loss: 3.1067 - val_accuracy20: 0.4619 - 14s/epoch - 27ms/step
Epoch 21/50
512/512 - 14s - loss: 2.9705 - accuracy20: 0.5072 - val_loss: 3.1142 - val_accuracy20: 0.4612 - 14s/epoch - 26ms/step
Epoch 22/50
512/512 - 13s - loss: 2.9634 - accuracy20: 0.5091 - val_loss: 3.1093 - val_accuracy20: 0.4658 - 13s/epoch - 26ms/step
Epoch 23/50
512/512 - 13s - loss: 2.9528 - accuracy20: 0.5131 - val_loss: 3.1203 - val_accuracy20: 0.4620 - 13s/epoch - 26ms/step
Epoch 24/50
512/512 - 14s - loss: 2.9452 - accuracy20: 0.5148 - val_loss: 3.1172 - val_accuracy20: 0.4638 - 14s/epoch - 26ms/step
Epoch 25/50
512/512 - 14s - loss: 2.9368 - accuracy20: 0.5169 - val_loss: 3.1281 - val_accuracy20: 0.4612 - 14s/epoch - 28ms/step
Epoch 26/50
512/512 - 13s - loss: 2.9262 - accuracy20: 0.5214 - val_loss: 3.1402 - val_accuracy20: 0.4606 - 13s/epoch - 25ms/step
testing model: results/XRAY/W6/deepOF_L2/h20
Evaluating performance on  test set...
1214/1214 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0397165
{'0': {'precision': 0.485039990054287, 'recall': 0.42403383720824916, 'f1-score': 0.4524899122912992, 'support': 110411}, '1': {'precision': 0.4431847087466841, 'recall': 0.4054431417743401, 'f1-score': 0.42347467288583845, 'support': 90242}, '2': {'precision': 0.4561548806710685, 'recall': 0.5455792946137279, 'f1-score': 0.496875646596317, 'support': 110039}, 'accuracy': 0.4616823091679219, 'macro avg': {'precision': 0.46145985982401316, 'recall': 0.4583520911987724, 'f1-score': 0.45761341059115157, 'support': 310692}, 'weighted avg': {'precision': 0.46265256827586765, 'recall': 0.4616823091679219, 'f1-score': 0.45978256412257346, 'support': 310692}}
[[46818 23476 40117]
 [22195 36588 31459]
 [27511 22493 60035]]
Evaluating performance on  train set...
512/512 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.007439
{'0': {'precision': 0.49748484457629305, 'recall': 0.44649472124467493, 'f1-score': 0.47061263833473654, 'support': 43192}, '1': {'precision': 0.5234065582642493, 'recall': 0.4656919608658539, 'f1-score': 0.4928654157980079, 'support': 45689}, '2': {'precision': 0.45797765016296754, 'recall': 0.5609924190213645, 'f1-score': 0.5042777949862748, 'support': 42079}, 'accuracy': 0.48998167379352475, 'macro avg': {'precision': 0.49295635100117, 'recall': 0.49105970037729785, 'f1-score': 0.48925194970633973, 'support': 130960}, 'weighted avg': {'precision': 0.4938342179954341, 'recall': 0.48998167379352475, 'f1-score': 0.48919314594209357, 'support': 130960}}
[[19285 10151 13756]
 [10230 21277 14182]
 [ 9250  9223 23606]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0307971
{'0': {'precision': 0.4597010325165665, 'recall': 0.42339081683343976, 'f1-score': 0.4407994384720529, 'support': 14091}, '1': {'precision': 0.501671422747656, 'recall': 0.4201433936497098, 'f1-score': 0.4573021181716834, 'support': 14645}, '2': {'precision': 0.4456794950566944, 'recall': 0.5537126995142262, 'f1-score': 0.49385696159440473, 'support': 14410}, 'accuracy': 0.4658137486673156, 'macro avg': {'precision': 0.46901731677363895, 'recall': 0.46574896999912524, 'f1-score': 0.46398617274604703, 'support': 43146}, 'weighted avg': {'precision': 0.46926405133957555, 'recall': 0.4658137486673156, 'f1-score': 0.4641211983662303, 'support': 43146}}
[[5966 3189 4936]
 [3504 6153 4988]
 [3508 2923 7979]]
training model: results/XRAY/W6/deepOF_L2/h30
Epoch 1/50
512/512 - 15s - loss: 3.2998 - accuracy30: 0.3694 - val_loss: 3.2426 - val_accuracy30: 0.3990 - 15s/epoch - 29ms/step
Epoch 2/50
512/512 - 13s - loss: 3.2373 - accuracy30: 0.4049 - val_loss: 3.2232 - val_accuracy30: 0.4110 - 13s/epoch - 25ms/step
Epoch 3/50
512/512 - 13s - loss: 3.2122 - accuracy30: 0.4167 - val_loss: 3.2099 - val_accuracy30: 0.4162 - 13s/epoch - 25ms/step
Epoch 4/50
512/512 - 13s - loss: 3.1952 - accuracy30: 0.4249 - val_loss: 3.1957 - val_accuracy30: 0.4213 - 13s/epoch - 25ms/step
Epoch 5/50
512/512 - 13s - loss: 3.1789 - accuracy30: 0.4321 - val_loss: 3.1908 - val_accuracy30: 0.4242 - 13s/epoch - 25ms/step
Epoch 6/50
512/512 - 13s - loss: 3.1683 - accuracy30: 0.4357 - val_loss: 3.1835 - val_accuracy30: 0.4282 - 13s/epoch - 25ms/step
Epoch 7/50
512/512 - 12s - loss: 3.1579 - accuracy30: 0.4401 - val_loss: 3.1844 - val_accuracy30: 0.4269 - 12s/epoch - 24ms/step
Epoch 8/50
512/512 - 13s - loss: 3.1483 - accuracy30: 0.4458 - val_loss: 3.1784 - val_accuracy30: 0.4315 - 13s/epoch - 25ms/step
Epoch 9/50
512/512 - 13s - loss: 3.1381 - accuracy30: 0.4492 - val_loss: 3.1751 - val_accuracy30: 0.4326 - 13s/epoch - 25ms/step
Epoch 10/50
512/512 - 13s - loss: 3.1292 - accuracy30: 0.4530 - val_loss: 3.1705 - val_accuracy30: 0.4341 - 13s/epoch - 25ms/step
Epoch 11/50
512/512 - 13s - loss: 3.1230 - accuracy30: 0.4562 - val_loss: 3.1731 - val_accuracy30: 0.4361 - 13s/epoch - 25ms/step
Epoch 12/50
512/512 - 13s - loss: 3.1121 - accuracy30: 0.4610 - val_loss: 3.1696 - val_accuracy30: 0.4361 - 13s/epoch - 25ms/step
Epoch 13/50
512/512 - 13s - loss: 3.1035 - accuracy30: 0.4647 - val_loss: 3.1711 - val_accuracy30: 0.4375 - 13s/epoch - 25ms/step
Epoch 14/50
512/512 - 13s - loss: 3.0963 - accuracy30: 0.4685 - val_loss: 3.1728 - val_accuracy30: 0.4374 - 13s/epoch - 25ms/step
Epoch 15/50
512/512 - 12s - loss: 3.0858 - accuracy30: 0.4713 - val_loss: 3.1788 - val_accuracy30: 0.4396 - 12s/epoch - 24ms/step
Epoch 16/50
512/512 - 13s - loss: 3.0769 - accuracy30: 0.4753 - val_loss: 3.1784 - val_accuracy30: 0.4393 - 13s/epoch - 25ms/step
Epoch 17/50
512/512 - 13s - loss: 3.0702 - accuracy30: 0.4771 - val_loss: 3.1797 - val_accuracy30: 0.4375 - 13s/epoch - 25ms/step
Epoch 18/50
512/512 - 13s - loss: 3.0576 - accuracy30: 0.4826 - val_loss: 3.1780 - val_accuracy30: 0.4409 - 13s/epoch - 26ms/step
Epoch 19/50
512/512 - 13s - loss: 3.0494 - accuracy30: 0.4852 - val_loss: 3.1895 - val_accuracy30: 0.4386 - 13s/epoch - 25ms/step
Epoch 20/50
512/512 - 13s - loss: 3.0388 - accuracy30: 0.4889 - val_loss: 3.2027 - val_accuracy30: 0.4386 - 13s/epoch - 25ms/step
Epoch 21/50
512/512 - 12s - loss: 3.0263 - accuracy30: 0.4924 - val_loss: 3.2027 - val_accuracy30: 0.4374 - 12s/epoch - 24ms/step
Epoch 22/50
512/512 - 13s - loss: 3.0194 - accuracy30: 0.4945 - val_loss: 3.2133 - val_accuracy30: 0.4364 - 13s/epoch - 24ms/step
testing model: results/XRAY/W6/deepOF_L2/h30
Evaluating performance on  test set...
1214/1214 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0614948
{'0': {'precision': 0.4683949654711517, 'recall': 0.43602194668855576, 'f1-score': 0.45162907043866996, 'support': 115735}, '1': {'precision': 0.3569363771444009, 'recall': 0.3266093147433996, 'f1-score': 0.3411000813249513, 'support': 80904}, '2': {'precision': 0.45003335246575554, 'recall': 0.5087196303472947, 'f1-score': 0.4775803670276032, 'support': 114053}, 'accuracy': 0.43421781056480374, 'macro avg': {'precision': 0.42512156502710274, 'recall': 0.4237836305930833, 'f1-score': 0.42343650626374146, 'support': 310692}, 'weighted avg': {'precision': 0.4326307916974727, 'recall': 0.43421781056480374, 'f1-score': 0.4323739428351311, 'support': 310692}}
[[50463 24857 40415]
 [23990 26424 30490]
 [33283 22749 58021]]
Evaluating performance on  train set...
512/512 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0389891
{'0': {'precision': 0.4733860439912313, 'recall': 0.43425898727884854, 'f1-score': 0.4529791647025549, 'support': 44257}, '1': {'precision': 0.45982338250817434, 'recall': 0.4127857258418656, 'f1-score': 0.43503678082525454, 'support': 43267}, '2': {'precision': 0.446875, 'recall': 0.5300442029652822, 'f1-score': 0.4849193310585955, 'support': 43436}, 'accuracy': 0.45893402565668906, 'macro avg': {'precision': 0.46002814216646853, 'recall': 0.45902963869533214, 'f1-score': 0.4576450921954683, 'support': 130960}, 'weighted avg': {'precision': 0.4601121482887989, 'recall': 0.45893402565668906, 'f1-score': 0.4576450164330209, 'support': 130960}}
[[19219 10939 14099]
 [11009 17860 14398]
 [10371 10042 23023]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0572041
{'0': {'precision': 0.44171868195674263, 'recall': 0.4163645070807963, 'f1-score': 0.42866701884134534, 'support': 14617}, '1': {'precision': 0.42443729903536975, 'recall': 0.3698569532517328, 'f1-score': 0.3952718676122931, 'support': 13562}, '2': {'precision': 0.436980056980057, 'recall': 0.5123939333199706, 'f1-score': 0.4716917304794415, 'support': 14967}, 'accuracy': 0.4350577110276735, 'macro avg': {'precision': 0.4343786793240565, 'recall': 0.4328717978841666, 'f1-score': 0.43187687231102667, 'support': 43146}, 'weighted avg': {'precision': 0.43464286692856596, 'recall': 0.4350577110276735, 'f1-score': 0.4330949106069546, 'support': 43146}}
[[6086 3490 5041]
 [3706 5016 4840]
 [3986 3312 7669]]
training model: results/XRAY/W6/deepOF_L2/h50
Epoch 1/50
512/512 - 15s - loss: 3.3161 - accuracy50: 0.3558 - val_loss: 3.2817 - val_accuracy50: 0.3729 - 15s/epoch - 30ms/step
Epoch 2/50
512/512 - 12s - loss: 3.2661 - accuracy50: 0.3839 - val_loss: 3.2607 - val_accuracy50: 0.3897 - 12s/epoch - 24ms/step
Epoch 3/50
512/512 - 12s - loss: 3.2479 - accuracy50: 0.3961 - val_loss: 3.2557 - val_accuracy50: 0.3930 - 12s/epoch - 24ms/step
Epoch 4/50
512/512 - 12s - loss: 3.2342 - accuracy50: 0.4039 - val_loss: 3.2490 - val_accuracy50: 0.3953 - 12s/epoch - 24ms/step
Epoch 5/50
512/512 - 13s - loss: 3.2236 - accuracy50: 0.4086 - val_loss: 3.2435 - val_accuracy50: 0.4003 - 13s/epoch - 25ms/step
Epoch 6/50
512/512 - 13s - loss: 3.2156 - accuracy50: 0.4135 - val_loss: 3.2435 - val_accuracy50: 0.4001 - 13s/epoch - 25ms/step
Epoch 7/50
512/512 - 13s - loss: 3.2094 - accuracy50: 0.4167 - val_loss: 3.2413 - val_accuracy50: 0.3999 - 13s/epoch - 25ms/step
Epoch 8/50
512/512 - 13s - loss: 3.2018 - accuracy50: 0.4212 - val_loss: 3.2419 - val_accuracy50: 0.4040 - 13s/epoch - 25ms/step
Epoch 9/50
512/512 - 12s - loss: 3.1946 - accuracy50: 0.4244 - val_loss: 3.2425 - val_accuracy50: 0.4013 - 12s/epoch - 24ms/step
Epoch 10/50
512/512 - 12s - loss: 3.1874 - accuracy50: 0.4268 - val_loss: 3.2433 - val_accuracy50: 0.4018 - 12s/epoch - 24ms/step
Epoch 11/50
512/512 - 13s - loss: 3.1814 - accuracy50: 0.4301 - val_loss: 3.2460 - val_accuracy50: 0.4040 - 13s/epoch - 25ms/step
Epoch 12/50
512/512 - 13s - loss: 3.1760 - accuracy50: 0.4339 - val_loss: 3.2475 - val_accuracy50: 0.4017 - 13s/epoch - 25ms/step
Epoch 13/50
512/512 - 12s - loss: 3.1678 - accuracy50: 0.4364 - val_loss: 3.2507 - val_accuracy50: 0.4023 - 12s/epoch - 24ms/step
Epoch 14/50
512/512 - 13s - loss: 3.1617 - accuracy50: 0.4400 - val_loss: 3.2530 - val_accuracy50: 0.4049 - 13s/epoch - 25ms/step
Epoch 15/50
512/512 - 12s - loss: 3.1536 - accuracy50: 0.4439 - val_loss: 3.2568 - val_accuracy50: 0.4040 - 12s/epoch - 24ms/step
Epoch 16/50
512/512 - 12s - loss: 3.1448 - accuracy50: 0.4487 - val_loss: 3.2619 - val_accuracy50: 0.4031 - 12s/epoch - 24ms/step
Epoch 17/50
512/512 - 13s - loss: 3.1397 - accuracy50: 0.4508 - val_loss: 3.2640 - val_accuracy50: 0.4027 - 13s/epoch - 25ms/step
testing model: results/XRAY/W6/deepOF_L2/h50
Evaluating performance on  test set...
1214/1214 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.08356
{'0': {'precision': 0.443156277014696, 'recall': 0.4034717971141233, 'f1-score': 0.42238396045042575, 'support': 114350}, '1': {'precision': 0.29982093183021186, 'recall': 0.3174349557627644, 'f1-score': 0.30837662676141986, 'support': 83866}, '2': {'precision': 0.4379526101758229, 'recall': 0.45864006543618197, 'f1-score': 0.4480576726814757, 'support': 112476}, 'accuracy': 0.40021950999703887, 'macro avg': {'precision': 0.3936432730069102, 'recall': 0.39318227277102324, 'f1-score': 0.3929394199644405, 'support': 310692}, 'weighted avg': {'precision': 0.4025815287411291, 'recall': 0.40021950999703887, 'f1-score': 0.4009039655028166, 'support': 310692}}
[[46137 32651 35562]
 [26603 26622 30641]
 [31370 29520 51586]]
Evaluating performance on  train set...
512/512 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0694426
{'0': {'precision': 0.43942536294197987, 'recall': 0.3889237106017192, 'f1-score': 0.41263507896924356, 'support': 44672}, '1': {'precision': 0.39150747986191026, 'recall': 0.39841206642152843, 'f1-score': 0.39492959708405395, 'support': 42697}, '2': {'precision': 0.41993246060201783, 'recall': 0.4621366795898236, 'f1-score': 0.4400249008879132, 'support': 43591}, 'accuracy': 0.41638668295662795, 'macro avg': {'precision': 0.4169551011353027, 'recall': 0.41649081887102374, 'f1-score': 0.41586319231373686, 'support': 130960}, 'weighted avg': {'precision': 0.4173142988020057, 'recall': 0.41638668295662795, 'f1-score': 0.41597944951906624, 'support': 130960}}
[[17374 13751 13547]
 [11406 17011 14280]
 [10758 12688 20145]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0810529
{'0': {'precision': 0.41313703284258213, 'recall': 0.37902611345847476, 'f1-score': 0.3953471569973268, 'support': 14437}, '1': {'precision': 0.3753755954562111, 'recall': 0.3685952792170409, 'f1-score': 0.3719545405032497, 'support': 13896}, '2': {'precision': 0.4130167322834646, 'recall': 0.45325052318909065, 'f1-score': 0.4321992983359619, 'support': 14813}, 'accuracy': 0.4011495851295601, 'macro avg': {'precision': 0.40050978686075256, 'recall': 0.4002906386215354, 'f1-score': 0.3998336652788461, 'support': 43146}, 'weighted avg': {'precision': 0.40093393299315877, 'recall': 0.4011495851295601, 'f1-score': 0.40046529009999, 'support': 43146}}
[[5472 4370 4595]
 [3827 5122 4947]
 [3946 4153 6714]]
training model: results/XRAY/W6/deepOF_L2/h100
Epoch 1/50
512/512 - 15s - loss: 3.3264 - accuracy100: 0.3465 - val_loss: 3.2986 - val_accuracy100: 0.3517 - 15s/epoch - 29ms/step
Epoch 2/50
512/512 - 13s - loss: 3.2924 - accuracy100: 0.3626 - val_loss: 3.2865 - val_accuracy100: 0.3607 - 13s/epoch - 25ms/step
Epoch 3/50
512/512 - 13s - loss: 3.2778 - accuracy100: 0.3743 - val_loss: 3.2803 - val_accuracy100: 0.3671 - 13s/epoch - 25ms/step
Epoch 4/50
512/512 - 13s - loss: 3.2682 - accuracy100: 0.3823 - val_loss: 3.2742 - val_accuracy100: 0.3701 - 13s/epoch - 26ms/step
Epoch 5/50
512/512 - 12s - loss: 3.2599 - accuracy100: 0.3864 - val_loss: 3.2745 - val_accuracy100: 0.3705 - 12s/epoch - 24ms/step
Epoch 6/50
512/512 - 12s - loss: 3.2553 - accuracy100: 0.3890 - val_loss: 3.2687 - val_accuracy100: 0.3757 - 12s/epoch - 24ms/step
Epoch 7/50
512/512 - 12s - loss: 3.2490 - accuracy100: 0.3927 - val_loss: 3.2703 - val_accuracy100: 0.3757 - 12s/epoch - 24ms/step
Epoch 8/50
512/512 - 12s - loss: 3.2456 - accuracy100: 0.3949 - val_loss: 3.2698 - val_accuracy100: 0.3758 - 12s/epoch - 24ms/step
Epoch 9/50
512/512 - 12s - loss: 3.2390 - accuracy100: 0.3987 - val_loss: 3.2674 - val_accuracy100: 0.3795 - 12s/epoch - 24ms/step
Epoch 10/50
512/512 - 12s - loss: 3.2346 - accuracy100: 0.4020 - val_loss: 3.2702 - val_accuracy100: 0.3773 - 12s/epoch - 24ms/step
Epoch 11/50
512/512 - 13s - loss: 3.2308 - accuracy100: 0.4039 - val_loss: 3.2686 - val_accuracy100: 0.3794 - 13s/epoch - 25ms/step
Epoch 12/50
512/512 - 12s - loss: 3.2264 - accuracy100: 0.4059 - val_loss: 3.2710 - val_accuracy100: 0.3771 - 12s/epoch - 24ms/step
Epoch 13/50
512/512 - 13s - loss: 3.2219 - accuracy100: 0.4091 - val_loss: 3.2732 - val_accuracy100: 0.3806 - 13s/epoch - 25ms/step
Epoch 14/50
512/512 - 13s - loss: 3.2167 - accuracy100: 0.4115 - val_loss: 3.2747 - val_accuracy100: 0.3788 - 13s/epoch - 24ms/step
Epoch 15/50
512/512 - 13s - loss: 3.2123 - accuracy100: 0.4142 - val_loss: 3.2768 - val_accuracy100: 0.3795 - 13s/epoch - 25ms/step
Epoch 16/50
512/512 - 13s - loss: 3.2052 - accuracy100: 0.4179 - val_loss: 3.2797 - val_accuracy100: 0.3783 - 13s/epoch - 25ms/step
Epoch 17/50
512/512 - 13s - loss: 3.2014 - accuracy100: 0.4207 - val_loss: 3.2816 - val_accuracy100: 0.3791 - 13s/epoch - 25ms/step
Epoch 18/50
512/512 - 12s - loss: 3.1943 - accuracy100: 0.4232 - val_loss: 3.2857 - val_accuracy100: 0.3776 - 12s/epoch - 24ms/step
Epoch 19/50
512/512 - 12s - loss: 3.1889 - accuracy100: 0.4259 - val_loss: 3.2909 - val_accuracy100: 0.3792 - 12s/epoch - 24ms/step
testing model: results/XRAY/W6/deepOF_L2/h100
Evaluating performance on  test set...
1214/1214 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0897343
{'0': {'precision': 0.4299672361338638, 'recall': 0.38099105715643494, 'f1-score': 0.4040002382184921, 'support': 115735}, '1': {'precision': 0.29998320950342106, 'recall': 0.17771616144033023, 'f1-score': 0.22320257355237677, 'support': 80426}, '2': {'precision': 0.4117474796565604, 'recall': 0.576987889741642, 'f1-score': 0.48055994909553673, 'support': 114531}, 'accuracy': 0.40062183770422155, 'macro avg': {'precision': 0.38056597509794843, 'recall': 0.3785650361128024, 'f1-score': 0.3692542536221352, 'support': 310692}, 'weighted avg': {'precision': 0.3896030740219265, 'recall': 0.40062183770422155, 'f1-score': 0.3854211543284074, 'support': 310692}}
[[44094 17583 54058]
 [25780 14293 40353]
 [32678 15770 66083]]
Evaluating performance on  train set...
512/512 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0814567
{'0': {'precision': 0.41999534028838437, 'recall': 0.3692980060092871, 'f1-score': 0.393018495415511, 'support': 43932}, '1': {'precision': 0.40964186067785757, 'recall': 0.2022949042284062, 'f1-score': 0.27083994859000526, 'support': 44272}, '2': {'precision': 0.3712181415678038, 'recall': 0.6118205631958088, 'f1-score': 0.46207517840740475, 'support': 42756}, 'accuracy': 0.39202046426389736, 'macro avg': {'precision': 0.40028511417801527, 'recall': 0.3944711578111673, 'f1-score': 0.3753112074709737, 'support': 130960}, 'weighted avg': {'precision': 0.40057042307843954, 'recall': 0.39202046426389736, 'f1-score': 0.3742608511954638, 'support': 130960}}
[[16224  6731 20977]
 [11984  8956 23332]
 [10421  6176 26159]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0897352
{'0': {'precision': 0.3833308030970093, 'recall': 0.3567896001130422, 'f1-score': 0.3695843091334895, 'support': 14154}, '1': {'precision': 0.3971553610503282, 'recall': 0.17547130723016366, 'f1-score': 0.24340246180372624, 'support': 14481}, '2': {'precision': 0.37032323746500384, 'recall': 0.6016125697746537, 'f1-score': 0.45844820795588814, 'support': 14511}, 'accuracy': 0.37827376813609603, 'macro avg': {'precision': 0.38360313387078043, 'recall': 0.3779578257059532, 'f1-score': 0.35714499296436797, 'support': 43146}, 'weighted avg': {'precision': 0.38359596415101155, 'recall': 0.37827376813609603, 'f1-score': 0.35712115390773336, 'support': 43146}}
[[5050 2015 7089]
 [4185 2541 7755]
 [3939 1842 8730]]
training model: results/XRAY/W6/deepOF_L2/h200
Epoch 1/50
512/512 - 14s - loss: 3.3267 - accuracy200: 0.3520 - val_loss: 3.3027 - val_accuracy200: 0.3594 - 14s/epoch - 28ms/step
Epoch 2/50
512/512 - 13s - loss: 3.2948 - accuracy200: 0.3639 - val_loss: 3.2946 - val_accuracy200: 0.3633 - 13s/epoch - 24ms/step
Epoch 3/50
512/512 - 12s - loss: 3.2816 - accuracy200: 0.3695 - val_loss: 3.2901 - val_accuracy200: 0.3670 - 12s/epoch - 24ms/step
Epoch 4/50
512/512 - 12s - loss: 3.2734 - accuracy200: 0.3758 - val_loss: 3.2863 - val_accuracy200: 0.3639 - 12s/epoch - 24ms/step
Epoch 5/50
512/512 - 12s - loss: 3.2672 - accuracy200: 0.3799 - val_loss: 3.2825 - val_accuracy200: 0.3674 - 12s/epoch - 24ms/step
Epoch 6/50
512/512 - 13s - loss: 3.2617 - accuracy200: 0.3830 - val_loss: 3.2817 - val_accuracy200: 0.3681 - 13s/epoch - 25ms/step
Epoch 7/50
512/512 - 13s - loss: 3.2569 - accuracy200: 0.3863 - val_loss: 3.2792 - val_accuracy200: 0.3676 - 13s/epoch - 25ms/step
Epoch 8/50
512/512 - 13s - loss: 3.2516 - accuracy200: 0.3908 - val_loss: 3.2812 - val_accuracy200: 0.3652 - 13s/epoch - 25ms/step
Epoch 9/50
512/512 - 13s - loss: 3.2489 - accuracy200: 0.3923 - val_loss: 3.2794 - val_accuracy200: 0.3678 - 13s/epoch - 25ms/step
Epoch 10/50
512/512 - 13s - loss: 3.2426 - accuracy200: 0.3970 - val_loss: 3.2793 - val_accuracy200: 0.3683 - 13s/epoch - 25ms/step
Epoch 11/50
512/512 - 12s - loss: 3.2389 - accuracy200: 0.3972 - val_loss: 3.2821 - val_accuracy200: 0.3682 - 12s/epoch - 24ms/step
Epoch 12/50
512/512 - 12s - loss: 3.2349 - accuracy200: 0.3999 - val_loss: 3.2846 - val_accuracy200: 0.3659 - 12s/epoch - 24ms/step
Epoch 13/50
512/512 - 12s - loss: 3.2293 - accuracy200: 0.4040 - val_loss: 3.2849 - val_accuracy200: 0.3675 - 12s/epoch - 24ms/step
Epoch 14/50
512/512 - 12s - loss: 3.2268 - accuracy200: 0.4047 - val_loss: 3.2862 - val_accuracy200: 0.3649 - 12s/epoch - 24ms/step
Epoch 15/50
512/512 - 13s - loss: 3.2208 - accuracy200: 0.4078 - val_loss: 3.2881 - val_accuracy200: 0.3669 - 13s/epoch - 24ms/step
Epoch 16/50
512/512 - 12s - loss: 3.2167 - accuracy200: 0.4099 - val_loss: 3.2942 - val_accuracy200: 0.3630 - 12s/epoch - 24ms/step
Epoch 17/50
512/512 - 12s - loss: 3.2144 - accuracy200: 0.4110 - val_loss: 3.2925 - val_accuracy200: 0.3672 - 12s/epoch - 24ms/step
testing model: results/XRAY/W6/deepOF_L2/h200
Evaluating performance on  test set...
1214/1214 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0877696
{'0': {'precision': 0.4075007339269987, 'recall': 0.28371415675219935, 'f1-score': 0.3345232536538587, 'support': 117421}, '1': {'precision': 0.268906225123388, 'recall': 0.06598257653692394, 'f1-score': 0.10596428123300848, 'support': 76793}, '2': {'precision': 0.3891583411471844, 'recall': 0.7019437146929034, 'f1-score': 0.5007180586389037, 'support': 116478}, 'accuracy': 0.38669164317072857, 'macro avg': {'precision': 0.3551884333991904, 'recall': 0.3505468159940089, 'f1-score': 0.31373519784192366, 'support': 310692}, 'weighted avg': {'precision': 0.36636812239930283, 'recall': 0.38669164317072857, 'f1-score': 0.3403370799703835, 'support': 310692}}
[[33314  7615 76492]
 [19882  5067 51844]
 [28556  6161 81761]]
Evaluating performance on  train set...
512/512 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0943499
{'0': {'precision': 0.39823225372358323, 'recall': 0.2888548737743467, 'f1-score': 0.33483767277402765, 'support': 45078}, '1': {'precision': 0.43082581869957287, 'recall': 0.08437318461717207, 'f1-score': 0.14111108952062645, 'support': 43035}, '2': {'precision': 0.3439861969165693, 'recall': 0.7212173547739632, 'f1-score': 0.46580545967049036, 'support': 42847}, 'accuracy': 0.36311850946854, 'macro avg': {'precision': 0.39101475644657513, 'recall': 0.36481513772182733, 'f1-score': 0.3139180739883815, 'support': 130960}, 'weighted avg': {'precision': 0.39119486270901077, 'recall': 0.36311850946854, 'f1-score': 0.31402638119524495, 'support': 130960}}
[[13021  2416 29641]
 [10112  3631 29292]
 [ 9564  2381 30902]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.093632
{'0': {'precision': 0.3770610617865555, 'recall': 0.2753738255921662, 'f1-score': 0.3182930559804221, 'support': 15114}, '1': {'precision': 0.3555465258025193, 'recall': 0.06885968363893917, 'f1-score': 0.11537447257383966, 'support': 12707}, '2': {'precision': 0.362667386244814, 'recall': 0.7015986949429037, 'f1-score': 0.47816419105221025, 'support': 15325}, 'accuracy': 0.3659435405367821, 'macro avg': {'precision': 0.36509165794462956, 'recall': 0.3486107347246697, 'f1-score': 0.3039439065354907, 'support': 43146}, 'weighted avg': {'precision': 0.3656122997593378, 'recall': 0.3659435405367821, 'f1-score': 0.3153156932035184, 'support': 43146}}
[[ 4162   817 10135]
 [ 3072   875  8760]
 [ 3804   769 10752]]
training model: results/XRAY/W6/deepOF_L2/h300
Epoch 1/50
512/512 - 14s - loss: 3.3357 - accuracy300: 0.3377 - val_loss: 3.3076 - val_accuracy300: 0.3476 - 14s/epoch - 28ms/step
Epoch 2/50
512/512 - 12s - loss: 3.3012 - accuracy300: 0.3543 - val_loss: 3.3017 - val_accuracy300: 0.3521 - 12s/epoch - 24ms/step
Epoch 3/50
512/512 - 13s - loss: 3.2870 - accuracy300: 0.3634 - val_loss: 3.2966 - val_accuracy300: 0.3587 - 13s/epoch - 25ms/step
Epoch 4/50
512/512 - 12s - loss: 3.2774 - accuracy300: 0.3710 - val_loss: 3.2956 - val_accuracy300: 0.3648 - 12s/epoch - 24ms/step
Epoch 5/50
512/512 - 13s - loss: 3.2679 - accuracy300: 0.3787 - val_loss: 3.2938 - val_accuracy300: 0.3672 - 13s/epoch - 25ms/step
Epoch 6/50
512/512 - 13s - loss: 3.2637 - accuracy300: 0.3816 - val_loss: 3.2921 - val_accuracy300: 0.3711 - 13s/epoch - 25ms/step
Epoch 7/50
512/512 - 13s - loss: 3.2578 - accuracy300: 0.3861 - val_loss: 3.2994 - val_accuracy300: 0.3684 - 13s/epoch - 24ms/step
Epoch 8/50
512/512 - 12s - loss: 3.2536 - accuracy300: 0.3907 - val_loss: 3.2983 - val_accuracy300: 0.3693 - 12s/epoch - 24ms/step
Epoch 9/50
512/512 - 13s - loss: 3.2499 - accuracy300: 0.3913 - val_loss: 3.2981 - val_accuracy300: 0.3723 - 13s/epoch - 25ms/step
Epoch 10/50
512/512 - 13s - loss: 3.2454 - accuracy300: 0.3956 - val_loss: 3.2985 - val_accuracy300: 0.3696 - 13s/epoch - 25ms/step
Epoch 11/50
512/512 - 12s - loss: 3.2413 - accuracy300: 0.3980 - val_loss: 3.3036 - val_accuracy300: 0.3691 - 12s/epoch - 24ms/step
Epoch 12/50
512/512 - 13s - loss: 3.2389 - accuracy300: 0.4005 - val_loss: 3.3014 - val_accuracy300: 0.3731 - 13s/epoch - 25ms/step
Epoch 13/50
512/512 - 12s - loss: 3.2347 - accuracy300: 0.4035 - val_loss: 3.3056 - val_accuracy300: 0.3675 - 12s/epoch - 24ms/step
Epoch 14/50
512/512 - 13s - loss: 3.2322 - accuracy300: 0.4054 - val_loss: 3.3096 - val_accuracy300: 0.3672 - 13s/epoch - 25ms/step
Epoch 15/50
512/512 - 13s - loss: 3.2279 - accuracy300: 0.4071 - val_loss: 3.3052 - val_accuracy300: 0.3721 - 13s/epoch - 25ms/step
Epoch 16/50
512/512 - 12s - loss: 3.2249 - accuracy300: 0.4091 - val_loss: 3.3117 - val_accuracy300: 0.3685 - 12s/epoch - 24ms/step
testing model: results/XRAY/W6/deepOF_L2/h300
Evaluating performance on  test set...
1214/1214 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1043718
{'0': {'precision': 0.37364940260729934, 'recall': 0.12434336847444119, 'f1-score': 0.18659236859094153, 'support': 110412}, '1': {'precision': 0.32422300603866966, 'recall': 0.5714921227377284, 'f1-score': 0.41372728450967533, 'support': 92164}, '2': {'precision': 0.3757533902561527, 'recall': 0.38750046246624, 'f1-score': 0.381536528058576, 'support': 108116}, 'accuracy': 0.34856063239478324, 'macro avg': {'precision': 0.3578752663007072, 'recall': 0.36111198455946986, 'f1-score': 0.3272853937197309, 'support': 310692}, 'weighted avg': {'precision': 0.3597196596956449, 'recall': 0.34856063239478324, 'f1-score': 0.3218074534200873, 'support': 310692}}
[[13729 56859 39824]
 [ 9716 52671 29777]
 [13298 52923 41895]]
Evaluating performance on  train set...
512/512 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0919417
{'0': {'precision': 0.39455339110039744, 'recall': 0.13766139298054192, 'f1-score': 0.20410845789588988, 'support': 43992}, '1': {'precision': 0.38742153263058154, 'recall': 0.5749566058049349, 'f1-score': 0.4629169357049984, 'support': 45513}, '2': {'precision': 0.35365219381280294, 'recall': 0.41005910022916414, 'f1-score': 0.37977256987109315, 'support': 41455}, 'accuracy': 0.37586285888821014, 'macro avg': {'precision': 0.378542372514594, 'recall': 0.37422569967154695, 'f1-score': 0.3489326544906605, 'support': 130960}, 'weighted avg': {'precision': 0.379127677843724, 'recall': 0.37586285888821014, 'f1-score': 0.3496590535927287, 'support': 130960}}
[[ 6056 21530 16406]
 [ 4683 26168 14662]
 [ 4610 19846 16999]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.098187
{'0': {'precision': 0.3431578947368421, 'recall': 0.12916936820113825, 'f1-score': 0.18768973097456298, 'support': 13881}, '1': {'precision': 0.37958200101950973, 'recall': 0.545012974915164, 'f1-score': 0.4474978146853147, 'support': 15029}, '2': {'precision': 0.35852404846408026, 'recall': 0.4115622365833099, 'f1-score': 0.3832166917391589, 'support': 14236}, 'accuracy': 0.36719510499235153, 'macro avg': {'precision': 0.360421314740144, 'recall': 0.3619148598998707, 'f1-score': 0.3394680791330122, 'support': 43146}, 'weighted avg': {'precision': 0.36091551903070884, 'recall': 0.36719510499235153, 'f1-score': 0.3427024205294157, 'support': 43146}}
[[1793 6795 5293]
 [1648 8191 5190]
 [1784 6593 5859]]
training model: results/XRAY/W6/deepOF_L2/h500
Epoch 1/50
512/512 - 14s - loss: 3.3404 - accuracy500: 0.3398 - val_loss: 3.3164 - val_accuracy500: 0.3455 - 14s/epoch - 28ms/step
Epoch 2/50
512/512 - 12s - loss: 3.3091 - accuracy500: 0.3481 - val_loss: 3.3073 - val_accuracy500: 0.3528 - 12s/epoch - 24ms/step
Epoch 3/50
512/512 - 12s - loss: 3.2968 - accuracy500: 0.3553 - val_loss: 3.3030 - val_accuracy500: 0.3528 - 12s/epoch - 24ms/step
Epoch 4/50
512/512 - 13s - loss: 3.2886 - accuracy500: 0.3620 - val_loss: 3.3021 - val_accuracy500: 0.3537 - 13s/epoch - 25ms/step
Epoch 5/50
512/512 - 12s - loss: 3.2800 - accuracy500: 0.3667 - val_loss: 3.3010 - val_accuracy500: 0.3595 - 12s/epoch - 24ms/step
Epoch 6/50
512/512 - 12s - loss: 3.2747 - accuracy500: 0.3697 - val_loss: 3.3034 - val_accuracy500: 0.3543 - 12s/epoch - 24ms/step
Epoch 7/50
512/512 - 12s - loss: 3.2687 - accuracy500: 0.3745 - val_loss: 3.3088 - val_accuracy500: 0.3514 - 12s/epoch - 24ms/step
Epoch 8/50
512/512 - 13s - loss: 3.2650 - accuracy500: 0.3774 - val_loss: 3.3097 - val_accuracy500: 0.3550 - 13s/epoch - 25ms/step
Epoch 9/50
512/512 - 13s - loss: 3.2607 - accuracy500: 0.3789 - val_loss: 3.3125 - val_accuracy500: 0.3538 - 13s/epoch - 25ms/step
Epoch 10/50
512/512 - 12s - loss: 3.2570 - accuracy500: 0.3821 - val_loss: 3.3149 - val_accuracy500: 0.3542 - 12s/epoch - 24ms/step
Epoch 11/50
512/512 - 12s - loss: 3.2529 - accuracy500: 0.3851 - val_loss: 3.3167 - val_accuracy500: 0.3486 - 12s/epoch - 24ms/step
Epoch 12/50
512/512 - 13s - loss: 3.2516 - accuracy500: 0.3872 - val_loss: 3.3166 - val_accuracy500: 0.3520 - 13s/epoch - 25ms/step
Epoch 13/50
512/512 - 12s - loss: 3.2472 - accuracy500: 0.3894 - val_loss: 3.3184 - val_accuracy500: 0.3511 - 12s/epoch - 24ms/step
Epoch 14/50
512/512 - 12s - loss: 3.2442 - accuracy500: 0.3910 - val_loss: 3.3269 - val_accuracy500: 0.3488 - 12s/epoch - 24ms/step
Epoch 15/50
512/512 - 13s - loss: 3.2392 - accuracy500: 0.3934 - val_loss: 3.3271 - val_accuracy500: 0.3481 - 13s/epoch - 25ms/step
testing model: results/XRAY/W6/deepOF_L2/h500
Evaluating performance on  test set...
1214/1214 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1173887
{'0': {'precision': 0.377949418358216, 'recall': 0.06916374354687191, 'f1-score': 0.11692966735148841, 'support': 116029}, '1': {'precision': 0.28409042823290453, 'recall': 0.6375031157639853, 'f1-score': 0.39303342419641063, 'support': 84249}, '2': {'precision': 0.38230929354700555, 'recall': 0.3476461318311084, 'f1-score': 0.3641546934070781, 'support': 110414}, 'accuracy': 0.3222451817233788, 'macro avg': {'precision': 0.34811638004604206, 'recall': 0.3514376637139886, 'f1-score': 0.29137259498499235, 'support': 310692}, 'weighted avg': {'precision': 0.3540475000597971, 'recall': 0.3222451817233788, 'f1-score': 0.2796585739127444, 'support': 310692}}
[[ 8025 70856 37148]
 [ 5670 53709 24870]
 [ 7538 64491 38385]]
Evaluating performance on  train set...
512/512 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.10377
{'0': {'precision': 0.4037351799391459, 'recall': 0.08189324934025709, 'f1-score': 0.136166598842867, 'support': 46988}, '1': {'precision': 0.338691549700724, 'recall': 0.641120154367563, 'f1-score': 0.4432320571912332, 'support': 40423}, '2': {'precision': 0.3638084210995079, 'recall': 0.3751865714482537, 'f1-score': 0.36940990278091795, 'support': 43549}, 'accuracy': 0.3520387904703726, 'macro avg': {'precision': 0.36874505024645926, 'recall': 0.36606665838535796, 'f1-score': 0.31626951960500604, 'support': 130960}, 'weighted avg': {'precision': 0.3703812620570818, 'recall': 0.3520387904703726, 'f1-score': 0.3085094490720529, 'support': 130960}}
[[ 3848 26453 16687]
 [ 2622 25916 11885]
 [ 3061 24149 16339]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1033032
{'0': {'precision': 0.34272151898734177, 'recall': 0.07539157674904282, 'f1-score': 0.12359486447931528, 'support': 14365}, '1': {'precision': 0.342775529635801, 'recall': 0.6329670329670329, 'f1-score': 0.44471896232242125, 'support': 13650}, '2': {'precision': 0.38673883626522326, 'recall': 0.3777674971911969, 'f1-score': 0.38220052823376016, 'support': 15131}, 'accuracy': 0.3578315486951282, 'macro avg': {'precision': 0.3574119616294553, 'recall': 0.3620420356357576, 'f1-score': 0.31683811834516556, 'support': 43146}, 'weighted avg': {'precision': 0.3581751710775261, 'recall': 0.3578315486951282, 'f1-score': 0.31587934586407634, 'support': 43146}}
[[1083 8259 5023]
 [ 969 8640 4041]
 [1108 8307 5716]]
training model: results/XRAY/W6/deepOF_L2/h1000
Epoch 1/50
512/512 - 15s - loss: 3.3424 - accuracy1000: 0.3369 - val_loss: 3.3113 - val_accuracy1000: 0.3566 - 15s/epoch - 29ms/step
Epoch 2/50
512/512 - 13s - loss: 3.3156 - accuracy1000: 0.3447 - val_loss: 3.3054 - val_accuracy1000: 0.3674 - 13s/epoch - 25ms/step
Epoch 3/50
512/512 - 12s - loss: 3.3034 - accuracy1000: 0.3504 - val_loss: 3.3027 - val_accuracy1000: 0.3677 - 12s/epoch - 24ms/step
Epoch 4/50
512/512 - 13s - loss: 3.2946 - accuracy1000: 0.3588 - val_loss: 3.3015 - val_accuracy1000: 0.3727 - 13s/epoch - 25ms/step
Epoch 5/50
512/512 - 13s - loss: 3.2870 - accuracy1000: 0.3650 - val_loss: 3.3006 - val_accuracy1000: 0.3741 - 13s/epoch - 24ms/step
Epoch 6/50
512/512 - 12s - loss: 3.2811 - accuracy1000: 0.3709 - val_loss: 3.3019 - val_accuracy1000: 0.3767 - 12s/epoch - 24ms/step
Epoch 7/50
512/512 - 13s - loss: 3.2761 - accuracy1000: 0.3720 - val_loss: 3.3090 - val_accuracy1000: 0.3762 - 13s/epoch - 25ms/step
Epoch 8/50
512/512 - 12s - loss: 3.2718 - accuracy1000: 0.3780 - val_loss: 3.3163 - val_accuracy1000: 0.3756 - 12s/epoch - 24ms/step
Epoch 9/50
512/512 - 12s - loss: 3.2674 - accuracy1000: 0.3796 - val_loss: 3.3227 - val_accuracy1000: 0.3745 - 12s/epoch - 24ms/step
Epoch 10/50
512/512 - 13s - loss: 3.2625 - accuracy1000: 0.3844 - val_loss: 3.3276 - val_accuracy1000: 0.3750 - 13s/epoch - 25ms/step
Epoch 11/50
512/512 - 13s - loss: 3.2589 - accuracy1000: 0.3870 - val_loss: 3.3284 - val_accuracy1000: 0.3767 - 13s/epoch - 25ms/step
Epoch 12/50
512/512 - 13s - loss: 3.2556 - accuracy1000: 0.3894 - val_loss: 3.3350 - val_accuracy1000: 0.3751 - 13s/epoch - 25ms/step
Epoch 13/50
512/512 - 12s - loss: 3.2518 - accuracy1000: 0.3915 - val_loss: 3.3396 - val_accuracy1000: 0.3739 - 12s/epoch - 24ms/step
Epoch 14/50
512/512 - 12s - loss: 3.2479 - accuracy1000: 0.3938 - val_loss: 3.3516 - val_accuracy1000: 0.3716 - 12s/epoch - 24ms/step
Epoch 15/50
512/512 - 13s - loss: 3.2439 - accuracy1000: 0.3966 - val_loss: 3.3476 - val_accuracy1000: 0.3744 - 13s/epoch - 25ms/step
testing model: results/XRAY/W6/deepOF_L2/h1000
Evaluating performance on  test set...
1214/1214 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1174296
{'0': {'precision': 0.37858527131782943, 'recall': 0.034294190966065695, 'f1-score': 0.06289136068766803, 'support': 113926}, '1': {'precision': 0.30613961312026916, 'recall': 0.7496333994651945, 'f1-score': 0.4347382934752363, 'support': 92744}, '2': {'precision': 0.3559155487014316, 'recall': 0.2507065813001096, 'f1-score': 0.294187653346118, 'support': 104022}, 'accuracy': 0.32028504113398476, 'macro avg': {'precision': 0.34688014437984344, 'recall': 0.3448780572437899, 'f1-score': 0.26393910250300745, 'support': 310692}, 'weighted avg': {'precision': 0.3493696815701775, 'recall': 0.32028504113398476, 'f1-score': 0.2513303127346068, 'support': 310692}}
[[ 3907 83043 26976]
 [ 3002 69524 20218]
 [ 3411 74532 26079]]
Evaluating performance on  train set...
512/512 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0997669
{'0': {'precision': 0.4000471475719001, 'recall': 0.038237945020279406, 'f1-score': 0.06980379252190368, 'support': 44380}, '1': {'precision': 0.37814068977587206, 'recall': 0.7435368004473696, 'f1-score': 0.5013232788311641, 'support': 46494}, '2': {'precision': 0.34510015015440404, 'recall': 0.30387167589682185, 'f1-score': 0.3231763129618084, 'support': 40086}, 'accuracy': 0.3699450213805742, 'macro avg': {'precision': 0.3744293291673921, 'recall': 0.36188214045482364, 'f1-score': 0.29810112810495876, 'support': 130960}, 'weighted avg': {'precision': 0.37545090301443007, 'recall': 0.3699450213805742, 'f1-score': 0.30055942669124375, 'support': 130960}}
[[ 1697 30192 12491]
 [ 1299 34570 10625]
 [ 1246 26659 12181]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0967364
{'0': {'precision': 0.31492537313432833, 'recall': 0.03176036727628509, 'f1-score': 0.057701510904491694, 'support': 13287}, '1': {'precision': 0.3812506279934354, 'recall': 0.7290719272401204, 'f1-score': 0.5006817681988124, 'support': 15613}, '2': {'precision': 0.36881747426562894, 'recall': 0.30934999298048577, 'f1-score': 0.33647642679900747, 'support': 14246}, 'accuracy': 0.37574746210540955, 'macro avg': {'precision': 0.35499782513113093, 'recall': 0.3567274291656304, 'f1-score': 0.29828656863410385, 'support': 43146}, 'weighted avg': {'precision': 0.3567202805841903, 'recall': 0.37574746210540955, 'f1-score': 0.3100465303493881, 'support': 43146}}
[[  422  9092  3773]
 [  461 11383  3769]
 [  457  9382  4407]]
training model: results/XRAY/W6/deepVOL_L2/h10
Epoch 1/50
512/512 - 15s - loss: 3.3015 - accuracy10: 0.3703 - val_loss: 3.2563 - val_accuracy10: 0.3715 - 15s/epoch - 29ms/step
Epoch 2/50
512/512 - 13s - loss: 3.2044 - accuracy10: 0.4005 - val_loss: 3.1796 - val_accuracy10: 0.4006 - 13s/epoch - 25ms/step
Epoch 3/50
512/512 - 12s - loss: 3.1522 - accuracy10: 0.4191 - val_loss: 3.1501 - val_accuracy10: 0.4182 - 12s/epoch - 23ms/step
Epoch 4/50
512/512 - 12s - loss: 3.1208 - accuracy10: 0.4315 - val_loss: 3.1252 - val_accuracy10: 0.4264 - 12s/epoch - 24ms/step
Epoch 5/50
512/512 - 12s - loss: 3.0968 - accuracy10: 0.4448 - val_loss: 3.1025 - val_accuracy10: 0.4462 - 12s/epoch - 23ms/step
Epoch 6/50
512/512 - 12s - loss: 3.0726 - accuracy10: 0.4569 - val_loss: 3.0850 - val_accuracy10: 0.4533 - 12s/epoch - 24ms/step
Epoch 7/50
512/512 - 12s - loss: 3.0548 - accuracy10: 0.4668 - val_loss: 3.0828 - val_accuracy10: 0.4573 - 12s/epoch - 23ms/step
Epoch 8/50
512/512 - 12s - loss: 3.0411 - accuracy10: 0.4743 - val_loss: 3.0691 - val_accuracy10: 0.4619 - 12s/epoch - 24ms/step
Epoch 9/50
512/512 - 12s - loss: 3.0278 - accuracy10: 0.4798 - val_loss: 3.0570 - val_accuracy10: 0.4709 - 12s/epoch - 23ms/step
Epoch 10/50
512/512 - 11s - loss: 3.0182 - accuracy10: 0.4857 - val_loss: 3.0624 - val_accuracy10: 0.4726 - 11s/epoch - 22ms/step
Epoch 11/50
512/512 - 12s - loss: 3.0088 - accuracy10: 0.4867 - val_loss: 3.0638 - val_accuracy10: 0.4802 - 12s/epoch - 23ms/step
Epoch 12/50
512/512 - 12s - loss: 3.0016 - accuracy10: 0.4909 - val_loss: 3.0545 - val_accuracy10: 0.4757 - 12s/epoch - 23ms/step
Epoch 13/50
512/512 - 11s - loss: 2.9928 - accuracy10: 0.4940 - val_loss: 3.0507 - val_accuracy10: 0.4784 - 11s/epoch - 22ms/step
Epoch 14/50
512/512 - 13s - loss: 2.9879 - accuracy10: 0.4946 - val_loss: 3.0500 - val_accuracy10: 0.4749 - 13s/epoch - 25ms/step
Epoch 15/50
512/512 - 12s - loss: 2.9801 - accuracy10: 0.4981 - val_loss: 3.0494 - val_accuracy10: 0.4726 - 12s/epoch - 24ms/step
Epoch 16/50
512/512 - 13s - loss: 2.9752 - accuracy10: 0.4995 - val_loss: 3.0458 - val_accuracy10: 0.4716 - 13s/epoch - 25ms/step
Epoch 17/50
512/512 - 12s - loss: 2.9694 - accuracy10: 0.5007 - val_loss: 3.0417 - val_accuracy10: 0.4752 - 12s/epoch - 23ms/step
Epoch 18/50
512/512 - 11s - loss: 2.9630 - accuracy10: 0.5030 - val_loss: 3.0478 - val_accuracy10: 0.4743 - 11s/epoch - 22ms/step
Epoch 19/50
512/512 - 12s - loss: 2.9575 - accuracy10: 0.5043 - val_loss: 3.0419 - val_accuracy10: 0.4770 - 12s/epoch - 23ms/step
Epoch 20/50
512/512 - 12s - loss: 2.9533 - accuracy10: 0.5053 - val_loss: 3.0464 - val_accuracy10: 0.4745 - 12s/epoch - 23ms/step
Epoch 21/50
512/512 - 12s - loss: 2.9472 - accuracy10: 0.5068 - val_loss: 3.0431 - val_accuracy10: 0.4703 - 12s/epoch - 23ms/step
Epoch 22/50
512/512 - 12s - loss: 2.9417 - accuracy10: 0.5101 - val_loss: 3.0493 - val_accuracy10: 0.4754 - 12s/epoch - 23ms/step
Epoch 23/50
512/512 - 12s - loss: 2.9380 - accuracy10: 0.5093 - val_loss: 3.0560 - val_accuracy10: 0.4681 - 12s/epoch - 23ms/step
Epoch 24/50
512/512 - 12s - loss: 2.9317 - accuracy10: 0.5118 - val_loss: 3.0522 - val_accuracy10: 0.4752 - 12s/epoch - 23ms/step
Epoch 25/50
512/512 - 12s - loss: 2.9280 - accuracy10: 0.5119 - val_loss: 3.0529 - val_accuracy10: 0.4731 - 12s/epoch - 23ms/step
Epoch 26/50
512/512 - 13s - loss: 2.9223 - accuracy10: 0.5131 - val_loss: 3.0598 - val_accuracy10: 0.4697 - 13s/epoch - 25ms/step
Epoch 27/50
512/512 - 12s - loss: 2.9178 - accuracy10: 0.5150 - val_loss: 3.0622 - val_accuracy10: 0.4673 - 12s/epoch - 23ms/step
testing model: results/XRAY/W6/deepVOL_L2/h10
Evaluating performance on  test set...
1214/1214 - 13s - 13s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0288783
{'0': {'precision': 0.4582829793598564, 'recall': 0.4191994921580002, 'f1-score': 0.43787083719175496, 'support': 91367}, '1': {'precision': 0.6114046444358912, 'recall': 0.40955364746509576, 'f1-score': 0.4905254292799326, 'support': 127993}, '2': {'precision': 0.40749725925663965, 'recall': 0.6307848954968961, 'f1-score': 0.4951315303237339, 'support': 91337}, 'accuracy': 0.4774265602822042, 'macro avg': {'precision': 0.49239496101746244, 'recall': 0.4865126783733307, 'f1-score': 0.4745092655984739, 'support': 310697}, 'weighted avg': {'precision': 0.5064324174329934, 'recall': 0.4774265602822042, 'f1-score': 0.4763953132367045, 'support': 310697}}
[[38301 16562 36504]
 [28306 52420 47267]
 [16968 16755 57614]]
Evaluating performance on  train set...
512/512 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0182863
{'0': {'precision': 0.4225575447570332, 'recall': 0.467674365942029, 'f1-score': 0.4439726984468211, 'support': 35328}, '1': {'precision': 0.6547088727005922, 'recall': 0.40999343616672135, 'f1-score': 0.5042279671449618, 'support': 60940}, '2': {'precision': 0.3958620432790793, 'recall': 0.6127349244782658, 'f1-score': 0.48098201153976694, 'support': 34692}, 'accuracy': 0.47926084300549787, 'macro avg': {'precision': 0.4910428202455683, 'recall': 0.4968009088623387, 'f1-score': 0.47639422571051665, 'support': 130960}, 'weighted avg': {'precision': 0.5235134212659467, 'recall': 0.47926084300549787, 'f1-score': 0.4818154226701349, 'support': 130960}}
[[16522  7004 11802]
 [15316 24985 20639]
 [ 7262  6173 21257]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0251868
{'0': {'precision': 0.4077327381380949, 'recall': 0.489244060475162, 'f1-score': 0.44478479421929, 'support': 11575}, '1': {'precision': 0.6400688414300243, 'recall': 0.41194240257778675, 'f1-score': 0.5012712513401746, 'support': 19862}, '2': {'precision': 0.4052807283763278, 'recall': 0.570196413321947, 'f1-score': 0.4737981195671457, 'support': 11710}, 'accuracy': 0.4756298236262081, 'macro avg': {'precision': 0.4843607693148157, 'recall': 0.49046095879163193, 'f1-score': 0.4732847217088701, 'support': 43147}, 'weighted avg': {'precision': 0.5140193084506082, 'recall': 0.4756298236262081, 'f1-score': 0.47866154233986385, 'support': 43147}}
[[5663 2490 3422]
 [5304 8182 6376]
 [2922 2111 6677]]
training model: results/XRAY/W6/deepVOL_L2/h20
Epoch 1/50
512/512 - 15s - loss: 3.3170 - accuracy20: 0.3665 - val_loss: 3.2589 - val_accuracy20: 0.3967 - 15s/epoch - 30ms/step
Epoch 2/50
512/512 - 12s - loss: 3.2420 - accuracy20: 0.4015 - val_loss: 3.2250 - val_accuracy20: 0.4121 - 12s/epoch - 23ms/step
Epoch 3/50
512/512 - 13s - loss: 3.1918 - accuracy20: 0.4263 - val_loss: 3.1906 - val_accuracy20: 0.4318 - 13s/epoch - 26ms/step
Epoch 4/50
512/512 - 13s - loss: 3.1667 - accuracy20: 0.4377 - val_loss: 3.1887 - val_accuracy20: 0.4365 - 13s/epoch - 25ms/step
Epoch 5/50
512/512 - 12s - loss: 3.1502 - accuracy20: 0.4458 - val_loss: 3.1889 - val_accuracy20: 0.4365 - 12s/epoch - 24ms/step
Epoch 6/50
512/512 - 12s - loss: 3.1355 - accuracy20: 0.4517 - val_loss: 3.1767 - val_accuracy20: 0.4436 - 12s/epoch - 24ms/step
Epoch 7/50
512/512 - 12s - loss: 3.1248 - accuracy20: 0.4568 - val_loss: 3.1729 - val_accuracy20: 0.4465 - 12s/epoch - 23ms/step
Epoch 8/50
512/512 - 21s - loss: 3.1104 - accuracy20: 0.4610 - val_loss: 3.1639 - val_accuracy20: 0.4467 - 21s/epoch - 41ms/step
Epoch 9/50
512/512 - 13s - loss: 3.1009 - accuracy20: 0.4655 - val_loss: 3.1786 - val_accuracy20: 0.4450 - 13s/epoch - 24ms/step
Epoch 10/50
512/512 - 12s - loss: 3.0910 - accuracy20: 0.4685 - val_loss: 3.1628 - val_accuracy20: 0.4520 - 12s/epoch - 23ms/step
Epoch 11/50
512/512 - 12s - loss: 3.0825 - accuracy20: 0.4718 - val_loss: 3.1615 - val_accuracy20: 0.4513 - 12s/epoch - 23ms/step
Epoch 12/50
512/512 - 12s - loss: 3.0747 - accuracy20: 0.4744 - val_loss: 3.1602 - val_accuracy20: 0.4551 - 12s/epoch - 23ms/step
Epoch 13/50
512/512 - 22s - loss: 3.0684 - accuracy20: 0.4768 - val_loss: 3.1591 - val_accuracy20: 0.4532 - 22s/epoch - 44ms/step
Epoch 14/50
512/512 - 13s - loss: 3.0624 - accuracy20: 0.4788 - val_loss: 3.1629 - val_accuracy20: 0.4552 - 13s/epoch - 25ms/step
Epoch 15/50
512/512 - 12s - loss: 3.0560 - accuracy20: 0.4822 - val_loss: 3.1611 - val_accuracy20: 0.4551 - 12s/epoch - 23ms/step
Epoch 16/50
512/512 - 12s - loss: 3.0528 - accuracy20: 0.4829 - val_loss: 3.1617 - val_accuracy20: 0.4565 - 12s/epoch - 23ms/step
Epoch 17/50
512/512 - 12s - loss: 3.0460 - accuracy20: 0.4834 - val_loss: 3.1690 - val_accuracy20: 0.4544 - 12s/epoch - 24ms/step
Epoch 18/50
512/512 - 12s - loss: 3.0416 - accuracy20: 0.4858 - val_loss: 3.1661 - val_accuracy20: 0.4531 - 12s/epoch - 23ms/step
Epoch 19/50
512/512 - 12s - loss: 3.0351 - accuracy20: 0.4887 - val_loss: 3.1586 - val_accuracy20: 0.4558 - 12s/epoch - 23ms/step
Epoch 20/50
512/512 - 12s - loss: 3.0295 - accuracy20: 0.4894 - val_loss: 3.1624 - val_accuracy20: 0.4552 - 12s/epoch - 24ms/step
Epoch 21/50
512/512 - 12s - loss: 3.0236 - accuracy20: 0.4913 - val_loss: 3.1669 - val_accuracy20: 0.4558 - 12s/epoch - 23ms/step
Epoch 22/50
512/512 - 12s - loss: 3.0202 - accuracy20: 0.4927 - val_loss: 3.1659 - val_accuracy20: 0.4585 - 12s/epoch - 24ms/step
Epoch 23/50
512/512 - 13s - loss: 3.0150 - accuracy20: 0.4936 - val_loss: 3.1654 - val_accuracy20: 0.4568 - 13s/epoch - 25ms/step
Epoch 24/50
512/512 - 19s - loss: 3.0118 - accuracy20: 0.4954 - val_loss: 3.1559 - val_accuracy20: 0.4574 - 19s/epoch - 37ms/step
Epoch 25/50
512/512 - 12s - loss: 3.0039 - accuracy20: 0.4962 - val_loss: 3.1785 - val_accuracy20: 0.4508 - 12s/epoch - 24ms/step
Epoch 26/50
512/512 - 12s - loss: 3.0012 - accuracy20: 0.4970 - val_loss: 3.1746 - val_accuracy20: 0.4527 - 12s/epoch - 24ms/step
Epoch 27/50
512/512 - 11s - loss: 2.9981 - accuracy20: 0.4994 - val_loss: 3.1844 - val_accuracy20: 0.4542 - 11s/epoch - 22ms/step
Epoch 28/50
512/512 - 12s - loss: 2.9912 - accuracy20: 0.5016 - val_loss: 3.1782 - val_accuracy20: 0.4526 - 12s/epoch - 23ms/step
Epoch 29/50
512/512 - 12s - loss: 2.9862 - accuracy20: 0.5019 - val_loss: 3.1870 - val_accuracy20: 0.4537 - 12s/epoch - 23ms/step
Epoch 30/50
512/512 - 12s - loss: 2.9829 - accuracy20: 0.5032 - val_loss: 3.1929 - val_accuracy20: 0.4518 - 12s/epoch - 24ms/step
Epoch 31/50
512/512 - 12s - loss: 2.9783 - accuracy20: 0.5044 - val_loss: 3.1890 - val_accuracy20: 0.4503 - 12s/epoch - 23ms/step
Epoch 32/50
512/512 - 12s - loss: 2.9714 - accuracy20: 0.5087 - val_loss: 3.1986 - val_accuracy20: 0.4472 - 12s/epoch - 23ms/step
Epoch 33/50
512/512 - 12s - loss: 2.9655 - accuracy20: 0.5080 - val_loss: 3.1977 - val_accuracy20: 0.4482 - 12s/epoch - 23ms/step
Epoch 34/50
512/512 - 12s - loss: 2.9610 - accuracy20: 0.5095 - val_loss: 3.2060 - val_accuracy20: 0.4478 - 12s/epoch - 24ms/step
testing model: results/XRAY/W6/deepVOL_L2/h20
Evaluating performance on  test set...
1214/1214 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0400487
{'0': {'precision': 0.48566075367924816, 'recall': 0.4366644929898924, 'f1-score': 0.45986122040203165, 'support': 110412}, '1': {'precision': 0.4698885721689557, 'recall': 0.4018660520367005, 'f1-score': 0.43322343272171254, 'support': 90244}, '2': {'precision': 0.4590447245314502, 'recall': 0.5600094510228006, 'f1-score': 0.5045254518288065, 'support': 110041}, 'accuracy': 0.470242712353193, 'macro avg': {'precision': 0.4715313501265513, 'recall': 0.4661799986831312, 'f1-score': 0.46587003498418356, 'support': 310697}, 'weighted avg': {'precision': 0.4716528964689511, 'recall': 0.470242712353193, 'f1-score': 0.4679430370240493, 'support': 310697}}
[[48213 20463 41736]
 [23094 36266 30884]
 [27966 20451 61624]]
Evaluating performance on  train set...
512/512 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0328774
{'0': {'precision': 0.45567748296112137, 'recall': 0.49304299429525533, 'f1-score': 0.47362441523724663, 'support': 43122}, '1': {'precision': 0.5423409620479428, 'recall': 0.37200595524806235, 'f1-score': 0.4413074815266938, 'support': 45674}, '2': {'precision': 0.4416212032544881, 'recall': 0.554833507257376, 'f1-score': 0.4917960414980501, 'support': 42164}, 'accuracy': 0.47072388515577274, 'macro avg': {'precision': 0.47987988275451743, 'recall': 0.47329415226689786, 'f1-score': 0.4689093127539968, 'support': 130960}, 'weighted avg': {'precision': 0.48137692375419555, 'recall': 0.47072388515577274, 'f1-score': 0.4682040183173072, 'support': 130960}}
[[21261  7403 14458]
 [13562 16991 15121]
 [11835  6935 23394]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.053972
{'0': {'precision': 0.42889230405485285, 'recall': 0.5160372661972833, 'f1-score': 0.4684463668937022, 'support': 14061}, '1': {'precision': 0.5089567966280295, 'recall': 0.360765940110002, 'f1-score': 0.42223635063180476, 'support': 14727}, '2': {'precision': 0.4545915136162128, 'recall': 0.49989553590082875, 'f1-score': 0.47616836379316063, 'support': 14359}, 'accuracy': 0.45766797228080747, 'macro avg': {'precision': 0.46414687143303174, 'recall': 0.45889958073603804, 'f1-score': 0.45561702710622254, 'support': 43147}, 'weighted avg': {'precision': 0.46477254444738864, 'recall': 0.45766797228080747, 'f1-score': 0.455243716512224, 'support': 43147}}
[[7256 2707 4098]
 [4900 5313 4514]
 [4762 2419 7178]]
training model: results/XRAY/W6/deepVOL_L2/h30
Epoch 1/50
512/512 - 14s - loss: 3.3103 - accuracy30: 0.3704 - val_loss: 3.3077 - val_accuracy30: 0.3815 - 14s/epoch - 28ms/step
Epoch 2/50
512/512 - 12s - loss: 3.2494 - accuracy30: 0.3950 - val_loss: 3.2628 - val_accuracy30: 0.4051 - 12s/epoch - 23ms/step
Epoch 3/50
512/512 - 13s - loss: 3.2167 - accuracy30: 0.4136 - val_loss: 3.2312 - val_accuracy30: 0.4198 - 13s/epoch - 26ms/step
Epoch 4/50
512/512 - 12s - loss: 3.1973 - accuracy30: 0.4249 - val_loss: 3.2329 - val_accuracy30: 0.4189 - 12s/epoch - 24ms/step
Epoch 5/50
512/512 - 12s - loss: 3.1850 - accuracy30: 0.4299 - val_loss: 3.2071 - val_accuracy30: 0.4283 - 12s/epoch - 24ms/step
Epoch 6/50
512/512 - 12s - loss: 3.1753 - accuracy30: 0.4353 - val_loss: 3.2286 - val_accuracy30: 0.4247 - 12s/epoch - 23ms/step
Epoch 7/50
512/512 - 12s - loss: 3.1650 - accuracy30: 0.4415 - val_loss: 3.1989 - val_accuracy30: 0.4352 - 12s/epoch - 24ms/step
Epoch 8/50
512/512 - 12s - loss: 3.1554 - accuracy30: 0.4446 - val_loss: 3.1933 - val_accuracy30: 0.4351 - 12s/epoch - 24ms/step
Epoch 9/50
512/512 - 12s - loss: 3.1475 - accuracy30: 0.4479 - val_loss: 3.1864 - val_accuracy30: 0.4376 - 12s/epoch - 24ms/step
Epoch 10/50
512/512 - 11s - loss: 3.1415 - accuracy30: 0.4511 - val_loss: 3.1923 - val_accuracy30: 0.4398 - 11s/epoch - 22ms/step
Epoch 11/50
512/512 - 12s - loss: 3.1352 - accuracy30: 0.4526 - val_loss: 3.1961 - val_accuracy30: 0.4370 - 12s/epoch - 23ms/step
Epoch 12/50
512/512 - 13s - loss: 3.1317 - accuracy30: 0.4541 - val_loss: 3.1931 - val_accuracy30: 0.4392 - 13s/epoch - 25ms/step
Epoch 13/50
512/512 - 13s - loss: 3.1245 - accuracy30: 0.4578 - val_loss: 3.2011 - val_accuracy30: 0.4414 - 13s/epoch - 25ms/step
Epoch 14/50
512/512 - 12s - loss: 3.1189 - accuracy30: 0.4602 - val_loss: 3.2020 - val_accuracy30: 0.4393 - 12s/epoch - 23ms/step
Epoch 15/50
512/512 - 12s - loss: 3.1119 - accuracy30: 0.4622 - val_loss: 3.2027 - val_accuracy30: 0.4396 - 12s/epoch - 24ms/step
Epoch 16/50
512/512 - 12s - loss: 3.1068 - accuracy30: 0.4651 - val_loss: 3.2000 - val_accuracy30: 0.4404 - 12s/epoch - 23ms/step
Epoch 17/50
512/512 - 13s - loss: 3.1014 - accuracy30: 0.4660 - val_loss: 3.1953 - val_accuracy30: 0.4411 - 13s/epoch - 24ms/step
Epoch 18/50
512/512 - 12s - loss: 3.0971 - accuracy30: 0.4684 - val_loss: 3.2014 - val_accuracy30: 0.4379 - 12s/epoch - 23ms/step
Epoch 19/50
512/512 - 12s - loss: 3.0912 - accuracy30: 0.4710 - val_loss: 3.2038 - val_accuracy30: 0.4368 - 12s/epoch - 23ms/step
testing model: results/XRAY/W6/deepVOL_L2/h30
Evaluating performance on  test set...
1214/1214 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0539811
{'0': {'precision': 0.48985917987777877, 'recall': 0.38231507642327, 'f1-score': 0.4294567248198384, 'support': 115737}, '1': {'precision': 0.4152263983427049, 'recall': 0.3468388851121686, 'f1-score': 0.3779641041182611, 'support': 80905}, '2': {'precision': 0.45222496383901983, 'recall': 0.6058042172636009, 'f1-score': 0.5178681177017282, 'support': 114055}, 'accuracy': 0.4551186525779135, 'macro avg': {'precision': 0.45243684735316786, 'recall': 0.4449860595996798, 'f1-score': 0.441762982213276, 'support': 310697}, 'weighted avg': {'precision': 0.45660962902792895, 'recall': 0.4551186525779135, 'f1-score': 0.4485034196295174, 'support': 310697}}
[[44248 20131 51358]
 [20508 28061 32336]
 [25572 19388 69095]]
Evaluating performance on  train set...
512/512 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0580264
{'0': {'precision': 0.4421989224475196, 'recall': 0.4466221098265896, 'f1-score': 0.44439951021692, 'support': 44288}, '1': {'precision': 0.4932870467188088, 'recall': 0.27254870242414436, 'f1-score': 0.3511059509987794, 'support': 43273}, '2': {'precision': 0.41793966623876766, 'recall': 0.6001520772368026, 'f1-score': 0.49274018861321045, 'support': 43399}, 'accuracy': 0.43998167379352476, 'macro avg': {'precision': 0.4511418784683654, 'recall': 0.43977429649584554, 'f1-score': 0.42941521660963655, 'support': 130960}, 'weighted avg': {'precision': 0.4510406217556127, 'recall': 0.43998167379352476, 'f1-score': 0.4295922783421033, 'support': 130960}}
[[19780  6283 18225]
 [13430 11794 18049]
 [11521  5832 26046]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0626101
{'0': {'precision': 0.4227067852357169, 'recall': 0.47550531003768415, 'f1-score': 0.4475542514429433, 'support': 14595}, '1': {'precision': 0.4591051238874188, 'recall': 0.2808682855040471, 'f1-score': 0.34852081811541274, 'support': 13590}, '2': {'precision': 0.44230247081183816, 'recall': 0.5443790937040502, 'f1-score': 0.48806064056086523, 'support': 14962}, 'accuracy': 0.4380837601687255, 'macro avg': {'precision': 0.44137145997832467, 'recall': 0.43358422974859384, 'f1-score': 0.4280452367064071, 'support': 43147}, 'weighted avg': {'precision': 0.4409663182244891, 'recall': 0.4380837601687255, 'f1-score': 0.430408035832616, 'support': 43147}}
[[6940 2325 5330]
 [4833 3817 4940]
 [4645 2172 8145]]
training model: results/XRAY/W6/deepVOL_L2/h50
Epoch 1/50
512/512 - 14s - loss: 3.3226 - accuracy50: 0.3575 - val_loss: 3.3030 - val_accuracy50: 0.3630 - 14s/epoch - 28ms/step
Epoch 2/50
512/512 - 12s - loss: 3.2769 - accuracy50: 0.3784 - val_loss: 3.2892 - val_accuracy50: 0.3801 - 12s/epoch - 23ms/step
Epoch 3/50
512/512 - 12s - loss: 3.2555 - accuracy50: 0.3919 - val_loss: 3.2731 - val_accuracy50: 0.3903 - 12s/epoch - 24ms/step
Epoch 4/50
512/512 - 12s - loss: 3.2423 - accuracy50: 0.4010 - val_loss: 3.2614 - val_accuracy50: 0.3961 - 12s/epoch - 24ms/step
Epoch 5/50
512/512 - 12s - loss: 3.2337 - accuracy50: 0.4059 - val_loss: 3.2611 - val_accuracy50: 0.3965 - 12s/epoch - 24ms/step
Epoch 6/50
512/512 - 12s - loss: 3.2259 - accuracy50: 0.4109 - val_loss: 3.2650 - val_accuracy50: 0.3961 - 12s/epoch - 23ms/step
Epoch 7/50
512/512 - 12s - loss: 3.2192 - accuracy50: 0.4150 - val_loss: 3.2702 - val_accuracy50: 0.3930 - 12s/epoch - 23ms/step
Epoch 8/50
512/512 - 12s - loss: 3.2135 - accuracy50: 0.4179 - val_loss: 3.2690 - val_accuracy50: 0.3963 - 12s/epoch - 23ms/step
Epoch 9/50
512/512 - 12s - loss: 3.2073 - accuracy50: 0.4233 - val_loss: 3.2727 - val_accuracy50: 0.3963 - 12s/epoch - 24ms/step
Epoch 10/50
512/512 - 12s - loss: 3.2043 - accuracy50: 0.4235 - val_loss: 3.2662 - val_accuracy50: 0.3966 - 12s/epoch - 24ms/step
Epoch 11/50
512/512 - 12s - loss: 3.1986 - accuracy50: 0.4276 - val_loss: 3.2767 - val_accuracy50: 0.3946 - 12s/epoch - 24ms/step
Epoch 12/50
512/512 - 12s - loss: 3.1939 - accuracy50: 0.4279 - val_loss: 3.2743 - val_accuracy50: 0.3993 - 12s/epoch - 24ms/step
Epoch 13/50
512/512 - 12s - loss: 3.1905 - accuracy50: 0.4301 - val_loss: 3.2716 - val_accuracy50: 0.4006 - 12s/epoch - 23ms/step
Epoch 14/50
512/512 - 12s - loss: 3.1839 - accuracy50: 0.4327 - val_loss: 3.2662 - val_accuracy50: 0.4023 - 12s/epoch - 23ms/step
Epoch 15/50
512/512 - 12s - loss: 3.1788 - accuracy50: 0.4345 - val_loss: 3.2789 - val_accuracy50: 0.3946 - 12s/epoch - 24ms/step
testing model: results/XRAY/W6/deepVOL_L2/h50
Evaluating performance on  test set...
1214/1214 - 13s - 13s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0753031
{'0': {'precision': 0.43156205858871216, 'recall': 0.49161361410381976, 'f1-score': 0.4596346927429113, 'support': 114352}, '1': {'precision': 0.34012720439433364, 'recall': 0.11222664727064603, 'f1-score': 0.1687675949003927, 'support': 83866}, '2': {'precision': 0.4219663395762007, 'recall': 0.5730847535984495, 'f1-score': 0.48605036947670033, 'support': 112479}, 'accuracy': 0.41870053460445383, 'macro avg': {'precision': 0.3978852008530822, 'recall': 0.39230833832430506, 'f1-score': 0.3714842190400014, 'support': 310697}, 'weighted avg': {'precision': 0.4034073214632361, 'recall': 0.41870053460445383, 'f1-score': 0.39068439349856454, 'support': 310697}}
[[56217 10169 47966]
 [34119  9412 40335]
 [39928  8091 64460]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0784962
{'0': {'precision': 0.39777595619963807, 'recall': 0.5754206192947915, 'f1-score': 0.4703849002770843, 'support': 44696}, '1': {'precision': 0.45354523227383864, 'recall': 0.12182193451543297, 'f1-score': 0.19205738796036093, 'support': 42636}, '2': {'precision': 0.40126889208947875, 'recall': 0.5044925277344824, 'f1-score': 0.44699885254724353, 'support': 43628}, 'accuracy': 0.4041157605375687, 'macro avg': {'precision': 0.4175300268543185, 'recall': 0.40057836051490225, 'f1-score': 0.36981371359489623, 'support': 130960}, 'weighted avg': {'precision': 0.4170961200794608, 'recall': 0.4041157605375687, 'f1-score': 0.37198036220825936, 'support': 130960}}
[[25719  3344 15633]
 [20234  5194 17208]
 [18704  2914 22010]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.084871
{'0': {'precision': 0.381382796435915, 'recall': 0.6153155021079549, 'f1-score': 0.4708962526115357, 'support': 14469}, '1': {'precision': 0.4148338792700047, 'recall': 0.12834805270015925, 'f1-score': 0.19604157452454665, 'support': 13814}, '2': {'precision': 0.41399961362611887, 'recall': 0.432521528525296, 'f1-score': 0.4230579409732504, 'support': 14864}, 'accuracy': 0.3964354416297773, 'macro avg': {'precision': 0.40340542977734617, 'recall': 0.3920616944444701, 'f1-score': 0.36333192270311093, 'support': 43147}, 'weighted avg': {'precision': 0.4033289254596085, 'recall': 0.3964354416297773, 'f1-score': 0.3664182776124596, 'support': 43147}}
[[8903 1227 4339]
 [7280 1773 4761]
 [7161 1274 6429]]
training model: results/XRAY/W6/deepVOL_L2/h100
Epoch 1/50
512/512 - 15s - loss: 3.3413 - accuracy100: 0.3504 - val_loss: 3.3181 - val_accuracy100: 0.3449 - 15s/epoch - 30ms/step
Epoch 2/50
512/512 - 12s - loss: 3.2994 - accuracy100: 0.3602 - val_loss: 3.2964 - val_accuracy100: 0.3541 - 12s/epoch - 23ms/step
Epoch 3/50
512/512 - 12s - loss: 3.2838 - accuracy100: 0.3676 - val_loss: 3.2897 - val_accuracy100: 0.3631 - 12s/epoch - 23ms/step
Epoch 4/50
512/512 - 12s - loss: 3.2766 - accuracy100: 0.3721 - val_loss: 3.2867 - val_accuracy100: 0.3667 - 12s/epoch - 24ms/step
Epoch 5/50
512/512 - 12s - loss: 3.2684 - accuracy100: 0.3801 - val_loss: 3.2849 - val_accuracy100: 0.3711 - 12s/epoch - 23ms/step
Epoch 6/50
512/512 - 11s - loss: 3.2634 - accuracy100: 0.3849 - val_loss: 3.2878 - val_accuracy100: 0.3712 - 11s/epoch - 22ms/step
Epoch 7/50
512/512 - 12s - loss: 3.2592 - accuracy100: 0.3871 - val_loss: 3.2931 - val_accuracy100: 0.3658 - 12s/epoch - 24ms/step
Epoch 8/50
512/512 - 11s - loss: 3.2542 - accuracy100: 0.3909 - val_loss: 3.2990 - val_accuracy100: 0.3679 - 11s/epoch - 22ms/step
Epoch 9/50
512/512 - 11s - loss: 3.2486 - accuracy100: 0.3947 - val_loss: 3.3018 - val_accuracy100: 0.3660 - 11s/epoch - 22ms/step
Epoch 10/50
512/512 - 13s - loss: 3.2433 - accuracy100: 0.3980 - val_loss: 3.3066 - val_accuracy100: 0.3661 - 13s/epoch - 25ms/step
Epoch 11/50
512/512 - 12s - loss: 3.2382 - accuracy100: 0.4011 - val_loss: 3.3045 - val_accuracy100: 0.3657 - 12s/epoch - 23ms/step
Epoch 12/50
512/512 - 12s - loss: 3.2318 - accuracy100: 0.4060 - val_loss: 3.3101 - val_accuracy100: 0.3651 - 12s/epoch - 23ms/step
Epoch 13/50
512/512 - 11s - loss: 3.2294 - accuracy100: 0.4057 - val_loss: 3.3103 - val_accuracy100: 0.3662 - 11s/epoch - 22ms/step
Epoch 14/50
512/512 - 12s - loss: 3.2231 - accuracy100: 0.4100 - val_loss: 3.3067 - val_accuracy100: 0.3698 - 12s/epoch - 23ms/step
Epoch 15/50
512/512 - 12s - loss: 3.2182 - accuracy100: 0.4120 - val_loss: 3.3090 - val_accuracy100: 0.3676 - 12s/epoch - 23ms/step
testing model: results/XRAY/W6/deepVOL_L2/h100
Evaluating performance on  test set...
1214/1214 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0909429
{'0': {'precision': 0.41509144881738963, 'recall': 0.37453882509482705, 'f1-score': 0.3937738171478922, 'support': 115737}, '1': {'precision': 0.2880884365887044, 'recall': 0.2407554770845249, 'f1-score': 0.2623037429388098, 'support': 80426}, '2': {'precision': 0.40997447053324226, 'recall': 0.4977473937869977, 'f1-score': 0.4496172941255338, 'support': 114534}, 'accuracy': 0.38532718371918623, 'macro avg': {'precision': 0.37105145197977873, 'recall': 0.3710138986554499, 'f1-score': 0.3685649514040786, 'support': 310697}, 'weighted avg': {'precision': 0.38032956745934376, 'recall': 0.38532718371918623, 'f1-score': 0.3803278057728791, 'support': 310697}}
[[43348 24585 47804]
 [26821 19363 34242]
 [34261 23264 57009]]
Evaluating performance on  train set...
512/512 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.090225
{'0': {'precision': 0.37774066377954285, 'recall': 0.44262145864148367, 'f1-score': 0.4076154152434041, 'support': 43945}, '1': {'precision': 0.3753969399538106, 'recall': 0.235223624112513, 'f1-score': 0.28922127387472546, 'support': 44226}, '2': {'precision': 0.37316201333204524, 'recall': 0.45135432003552317, 'f1-score': 0.4085505161617871, 'support': 42789}, 'accuracy': 0.3754352474037874, 'macro avg': {'precision': 0.3754332056884662, 'recall': 0.37639980092983993, 'f1-score': 0.36846240175997225, 'support': 130960}, 'weighted avg': {'precision': 0.3754531759671207, 'recall': 0.3754352474037874, 'f1-score': 0.3679385118914303, 'support': 130960}}
[[19451  8631 15863]
 [17244 10403 16579]
 [14798  8678 19313]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0943098
{'0': {'precision': 0.35919493588703133, 'recall': 0.46882282324694585, 'f1-score': 0.4067516235755422, 'support': 14161}, '1': {'precision': 0.37131669114047966, 'recall': 0.2615501310164115, 'f1-score': 0.3069142695310919, 'support': 14502}, '2': {'precision': 0.377742404318638, 'recall': 0.37682960508146923, 'f1-score': 0.3772854525973802, 'support': 14484}, 'accuracy': 0.36827589403666533, 'macro avg': {'precision': 0.3694180104487163, 'recall': 0.36906751978160884, 'f1-score': 0.36365044856800477, 'support': 43147}, 'weighted avg': {'precision': 0.3694953328427617, 'recall': 0.36827589403666533, 'f1-score': 0.3633041225024591, 'support': 43147}}
[[6639 3130 4392]
 [6110 3793 4599]
 [5734 3292 5458]]
training model: results/XRAY/W6/deepVOL_L2/h200
Epoch 1/50
512/512 - 14s - loss: 3.3380 - accuracy200: 0.3544 - val_loss: 3.3381 - val_accuracy200: 0.3483 - 14s/epoch - 27ms/step
Epoch 2/50
512/512 - 12s - loss: 3.2973 - accuracy200: 0.3650 - val_loss: 3.3126 - val_accuracy200: 0.3584 - 12s/epoch - 23ms/step
Epoch 3/50
512/512 - 12s - loss: 3.2856 - accuracy200: 0.3694 - val_loss: 3.3029 - val_accuracy200: 0.3610 - 12s/epoch - 23ms/step
Epoch 4/50
512/512 - 12s - loss: 3.2813 - accuracy200: 0.3738 - val_loss: 3.3107 - val_accuracy200: 0.3605 - 12s/epoch - 23ms/step
Epoch 5/50
512/512 - 12s - loss: 3.2749 - accuracy200: 0.3795 - val_loss: 3.3087 - val_accuracy200: 0.3643 - 12s/epoch - 23ms/step
Epoch 6/50
512/512 - 11s - loss: 3.2714 - accuracy200: 0.3806 - val_loss: 3.3184 - val_accuracy200: 0.3589 - 11s/epoch - 22ms/step
Epoch 7/50
512/512 - 12s - loss: 3.2648 - accuracy200: 0.3839 - val_loss: 3.3243 - val_accuracy200: 0.3598 - 12s/epoch - 24ms/step
Epoch 8/50
512/512 - 12s - loss: 3.2574 - accuracy200: 0.3910 - val_loss: 3.3250 - val_accuracy200: 0.3623 - 12s/epoch - 23ms/step
Epoch 9/50
512/512 - 11s - loss: 3.2529 - accuracy200: 0.3939 - val_loss: 3.3206 - val_accuracy200: 0.3629 - 11s/epoch - 22ms/step
Epoch 10/50
512/512 - 12s - loss: 3.2483 - accuracy200: 0.3961 - val_loss: 3.3335 - val_accuracy200: 0.3603 - 12s/epoch - 23ms/step
Epoch 11/50
512/512 - 12s - loss: 3.2422 - accuracy200: 0.3987 - val_loss: 3.3306 - val_accuracy200: 0.3676 - 12s/epoch - 23ms/step
Epoch 12/50
512/512 - 12s - loss: 3.2393 - accuracy200: 0.4029 - val_loss: 3.3313 - val_accuracy200: 0.3634 - 12s/epoch - 23ms/step
Epoch 13/50
512/512 - 12s - loss: 3.2344 - accuracy200: 0.4036 - val_loss: 3.3350 - val_accuracy200: 0.3637 - 12s/epoch - 23ms/step
testing model: results/XRAY/W6/deepVOL_L2/h200
Evaluating performance on  test set...
1214/1214 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0847708
{'0': {'precision': 0.3962076930132497, 'recall': 0.40465666862539706, 'f1-score': 0.400387613229408, 'support': 117423}, '1': {'precision': 0.2512664640324215, 'recall': 0.016147305092912113, 'f1-score': 0.030344557556773684, 'support': 76793}, '2': {'precision': 0.38796782091640436, 'recall': 0.6189679003442622, 'f1-score': 0.4769711163153786, 'support': 116481}, 'accuracy': 0.3889770419411839, 'macro avg': {'precision': 0.34514732598735853, 'recall': 0.34659062468752383, 'f1-score': 0.30256776236718674, 'support': 310697}, 'weighted avg': {'precision': 0.35729434547903666, 'recall': 0.3889770419411839, 'f1-score': 0.33763775291111825, 'support': 310697}}
[[47516  1873 68034]
 [29850  1240 45703]
 [42561  1822 72098]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1042372
{'0': {'precision': 0.36469019665938296, 'recall': 0.4371975314123341, 'f1-score': 0.3976657782085454, 'support': 45046}, '1': {'precision': 0.39167785234899327, 'recall': 0.033929443501313925, 'f1-score': 0.062449171767324396, 'support': 43001}, '2': {'precision': 0.34280993541163135, 'recall': 0.5850208561508168, 'f1-score': 0.43230072494963234, 'support': 42913}, 'accuracy': 0.3532223579718998, 'macro avg': {'precision': 0.3663926614733359, 'recall': 0.35204927702148825, 'f1-score': 0.297471891641834, 'support': 130960}, 'weighted avg': {'precision': 0.3663819233803983, 'recall': 0.3532223579718998, 'f1-score': 0.29894586507416326, 'support': 130960}}
[[19694  1139 24213]
 [17627  1459 23915]
 [16681  1127 25105]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1002041
{'0': {'precision': 0.3675345377258236, 'recall': 0.45708055243507567, 'f1-score': 0.4074455865461079, 'support': 15133}, '1': {'precision': 0.28345724907063197, 'recall': 0.024051730936046053, 'f1-score': 0.04434106273170023, 'support': 12681}, '2': {'precision': 0.35972646337791925, 'recall': 0.5454901193504207, 'f1-score': 0.43354758449098074, 'support': 15333}, 'accuracy': 0.36123021299279207, 'macro avg': {'precision': 0.3369060833914583, 'recall': 0.3422074675738475, 'f1-score': 0.29511141125626295, 'support': 43147}, 'weighted avg': {'precision': 0.3400493058113706, 'recall': 0.36123021299279207, 'f1-score': 0.3100041298515111, 'support': 43147}}
[[6917  391 7825]
 [5314  305 7062]
 [6589  380 8364]]
training model: results/XRAY/W6/deepVOL_L2/h300
Epoch 1/50
512/512 - 14s - loss: 3.3534 - accuracy300: 0.3441 - val_loss: 3.3327 - val_accuracy300: 0.3340 - 14s/epoch - 28ms/step
Epoch 2/50
512/512 - 12s - loss: 3.3025 - accuracy300: 0.3554 - val_loss: 3.2980 - val_accuracy300: 0.3531 - 12s/epoch - 23ms/step
Epoch 3/50
512/512 - 12s - loss: 3.2817 - accuracy300: 0.3666 - val_loss: 3.2957 - val_accuracy300: 0.3574 - 12s/epoch - 23ms/step
Epoch 4/50
512/512 - 12s - loss: 3.2701 - accuracy300: 0.3788 - val_loss: 3.2966 - val_accuracy300: 0.3588 - 12s/epoch - 24ms/step
Epoch 5/50
512/512 - 12s - loss: 3.2637 - accuracy300: 0.3818 - val_loss: 3.2953 - val_accuracy300: 0.3600 - 12s/epoch - 23ms/step
Epoch 6/50
512/512 - 12s - loss: 3.2571 - accuracy300: 0.3869 - val_loss: 3.2958 - val_accuracy300: 0.3590 - 12s/epoch - 23ms/step
Epoch 7/50
512/512 - 12s - loss: 3.2488 - accuracy300: 0.3949 - val_loss: 3.3007 - val_accuracy300: 0.3575 - 12s/epoch - 23ms/step
Epoch 8/50
512/512 - 12s - loss: 3.2449 - accuracy300: 0.3967 - val_loss: 3.2975 - val_accuracy300: 0.3591 - 12s/epoch - 23ms/step
Epoch 9/50
512/512 - 11s - loss: 3.2354 - accuracy300: 0.4027 - val_loss: 3.3014 - val_accuracy300: 0.3593 - 11s/epoch - 22ms/step
Epoch 10/50
512/512 - 12s - loss: 3.2288 - accuracy300: 0.4051 - val_loss: 3.3075 - val_accuracy300: 0.3608 - 12s/epoch - 24ms/step
Epoch 11/50
512/512 - 12s - loss: 3.2239 - accuracy300: 0.4099 - val_loss: 3.3038 - val_accuracy300: 0.3604 - 12s/epoch - 23ms/step
Epoch 12/50
512/512 - 12s - loss: 3.2145 - accuracy300: 0.4136 - val_loss: 3.3073 - val_accuracy300: 0.3603 - 12s/epoch - 23ms/step
Epoch 13/50
512/512 - 13s - loss: 3.2101 - accuracy300: 0.4175 - val_loss: 3.3092 - val_accuracy300: 0.3582 - 13s/epoch - 25ms/step
Epoch 14/50
512/512 - 13s - loss: 3.2033 - accuracy300: 0.4183 - val_loss: 3.3111 - val_accuracy300: 0.3628 - 13s/epoch - 24ms/step
Epoch 15/50
512/512 - 13s - loss: 3.1952 - accuracy300: 0.4236 - val_loss: 3.3229 - val_accuracy300: 0.3617 - 13s/epoch - 26ms/step
testing model: results/XRAY/W6/deepVOL_L2/h300
Evaluating performance on  test set...
1214/1214 - 14s - 14s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0945001
{'0': {'precision': 0.3721271393643032, 'recall': 0.16541530435727678, 'f1-score': 0.2290257252669396, 'support': 110413}, '1': {'precision': 0.3537518608113137, 'recall': 0.3300276677697608, 'f1-score': 0.3414782008318879, 'support': 92165}, '2': {'precision': 0.3737452528852778, 'recall': 0.607127331921309, 'f1-score': 0.46267162874622914, 'support': 108119}, 'accuracy': 0.3679565621811604, 'macro avg': {'precision': 0.36654141768696497, 'recall': 0.3675234346827822, 'f1-score': 0.34439185161501884, 'support': 310697}, 'weighted avg': {'precision': 0.36723939106914094, 'recall': 0.3679565621811604, 'f1-score': 0.3436896706823146, 'support': 310697}}
[[18264 30254 61895]
 [13652 30417 48096]
 [17164 25313 65642]]
Evaluating performance on  train set...
512/512 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.091558
{'0': {'precision': 0.3738095238095238, 'recall': 0.18909644577765658, 'f1-score': 0.25114692744174816, 'support': 44004}, '1': {'precision': 0.4463766359670383, 'recall': 0.3240805912370227, 'f1-score': 0.3755224793556938, 'support': 45464}, '2': {'precision': 0.34230830206626855, 'recall': 0.6244577267907067, 'f1-score': 0.4422105406881485, 'support': 41492}, 'accuracy': 0.37389279169211975, 'macro avg': {'precision': 0.38749815394761017, 'recall': 0.3792115879351286, 'f1-score': 0.35629331582853013, 'support': 130960}, 'weighted avg': {'precision': 0.38902136326094483, 'recall': 0.37389279169211975, 'f1-score': 0.3548596758613821, 'support': 130960}}
[[ 8321  9550 26133]
 [ 7081 14734 23649]
 [ 6858  8724 25910]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0997804
{'0': {'precision': 0.32487118260651, 'recall': 0.18648102726879237, 'f1-score': 0.23694944772904347, 'support': 13862}, '1': {'precision': 0.4092041867419837, 'recall': 0.32785357737104825, 'f1-score': 0.364039463474116, 'support': 15025}, '2': {'precision': 0.3493866620594333, 'recall': 0.5672510518934082, 'f1-score': 0.432428097936491, 'support': 14260}, 'accuracy': 0.3615546851461284, 'macro avg': {'precision': 0.361154010469309, 'recall': 0.36052855217774954, 'f1-score': 0.34447233637988345, 'support': 43147}, 'weighted avg': {'precision': 0.3623406271596465, 'recall': 0.3615546851461284, 'f1-score': 0.34581108442517333, 'support': 43147}}
[[2585 3608 7669]
 [2705 4926 7394]
 [2667 3504 8089]]
training model: results/XRAY/W6/deepVOL_L2/h500
Epoch 1/50
512/512 - 14s - loss: 3.3560 - accuracy500: 0.3455 - val_loss: 3.3281 - val_accuracy500: 0.3382 - 14s/epoch - 28ms/step
Epoch 2/50
512/512 - 12s - loss: 3.3121 - accuracy500: 0.3480 - val_loss: 3.3042 - val_accuracy500: 0.3495 - 12s/epoch - 24ms/step
Epoch 3/50
512/512 - 12s - loss: 3.2955 - accuracy500: 0.3565 - val_loss: 3.2979 - val_accuracy500: 0.3603 - 12s/epoch - 24ms/step
Epoch 4/50
512/512 - 12s - loss: 3.2817 - accuracy500: 0.3662 - val_loss: 3.3022 - val_accuracy500: 0.3609 - 12s/epoch - 23ms/step
Epoch 5/50
512/512 - 13s - loss: 3.2734 - accuracy500: 0.3754 - val_loss: 3.3050 - val_accuracy500: 0.3608 - 13s/epoch - 25ms/step
Epoch 6/50
512/512 - 12s - loss: 3.2674 - accuracy500: 0.3821 - val_loss: 3.3104 - val_accuracy500: 0.3586 - 12s/epoch - 24ms/step
Epoch 7/50
512/512 - 12s - loss: 3.2592 - accuracy500: 0.3837 - val_loss: 3.3127 - val_accuracy500: 0.3566 - 12s/epoch - 22ms/step
Epoch 8/50
512/512 - 12s - loss: 3.2510 - accuracy500: 0.3926 - val_loss: 3.3215 - val_accuracy500: 0.3535 - 12s/epoch - 23ms/step
Epoch 9/50
512/512 - 12s - loss: 3.2429 - accuracy500: 0.3973 - val_loss: 3.3274 - val_accuracy500: 0.3611 - 12s/epoch - 23ms/step
Epoch 10/50
512/512 - 12s - loss: 3.2363 - accuracy500: 0.4008 - val_loss: 3.3332 - val_accuracy500: 0.3615 - 12s/epoch - 23ms/step
Epoch 11/50
512/512 - 12s - loss: 3.2281 - accuracy500: 0.4047 - val_loss: 3.3295 - val_accuracy500: 0.3589 - 12s/epoch - 24ms/step
Epoch 12/50
512/512 - 12s - loss: 3.2239 - accuracy500: 0.4058 - val_loss: 3.3264 - val_accuracy500: 0.3633 - 12s/epoch - 23ms/step
Epoch 13/50
512/512 - 12s - loss: 3.2127 - accuracy500: 0.4134 - val_loss: 3.3345 - val_accuracy500: 0.3588 - 12s/epoch - 23ms/step
testing model: results/XRAY/W6/deepVOL_L2/h500
Evaluating performance on  test set...
1214/1214 - 13s - 13s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0968305
{'0': {'precision': 0.38477106737453437, 'recall': 0.11305599365686757, 'f1-score': 0.17476219658415712, 'support': 116031}, '1': {'precision': 0.2959656084656085, 'recall': 0.22308870134957093, 'f1-score': 0.25441107794765594, 'support': 84249}, '2': {'precision': 0.37073205068043175, 'recall': 0.7154967079344666, 'f1-score': 0.4884009186534247, 'support': 110417}, 'accuracy': 0.35699089466586414, 'macro avg': {'precision': 0.3504895755068582, 'recall': 0.35054713431363504, 'f1-score': 0.3058580643950793, 'support': 310697}, 'weighted avg': {'precision': 0.3557012108457271, 'recall': 0.35699089466586414, 'f1-score': 0.30782233356879407, 'support': 310697}}
[[13118 25295 77618]
 [ 8975 18795 56479]
 [12000 19414 79003]]
Evaluating performance on  train set...
512/512 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0961834
{'0': {'precision': 0.3921696338109712, 'recall': 0.11524147757480382, 'f1-score': 0.17813645403592976, 'support': 47023}, '1': {'precision': 0.3777499492317065, 'recall': 0.2765087701912595, 'f1-score': 0.3192962380203118, 'support': 40364}, '2': {'precision': 0.3470592264486963, 'recall': 0.6977027058040529, 'f1-score': 0.46353940336512434, 'support': 43573}, 'accuracy': 0.35874312767257177, 'macro avg': {'precision': 0.37232626983045797, 'recall': 0.3631509845233721, 'f1-score': 0.32032403180712193, 'support': 130960}, 'weighted avg': {'precision': 0.3727161218351477, 'recall': 0.35874312767257177, 'f1-score': 0.31660343809111147, 'support': 130960}}
[[ 5419  9570 32034]
 [ 4042 11161 25161]
 [ 4357  8815 30401]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0978608
{'0': {'precision': 0.33414288605545434, 'recall': 0.11470056968181186, 'f1-score': 0.1707783811740367, 'support': 14394}, '1': {'precision': 0.3612634764516739, 'recall': 0.28028468706434806, 'f1-score': 0.31566334751890257, 'support': 13629}, '2': {'precision': 0.361682107701216, 'recall': 0.6608040201005025, 'f1-score': 0.46748994293198615, 'support': 15124}, 'accuracy': 0.35842584652467147, 'macro avg': {'precision': 0.3523628234027814, 'recall': 0.35192975894888745, 'f1-score': 0.3179772238749751, 'support': 43147}, 'weighted avg': {'precision': 0.35236268615002814, 'recall': 0.35842584652467147, 'f1-score': 0.32054784061134184, 'support': 43147}}
[[1651 3372 9371]
 [1542 3820 8267]
 [1748 3382 9994]]
training model: results/XRAY/W6/deepVOL_L2/h1000
Epoch 1/50
512/512 - 15s - loss: 3.3535 - accuracy1000: 0.3476 - val_loss: 3.3357 - val_accuracy1000: 0.3454 - 15s/epoch - 28ms/step
Epoch 2/50
512/512 - 13s - loss: 3.3227 - accuracy1000: 0.3522 - val_loss: 3.3121 - val_accuracy1000: 0.3458 - 13s/epoch - 25ms/step
Epoch 3/50
512/512 - 12s - loss: 3.2974 - accuracy1000: 0.3538 - val_loss: 3.3072 - val_accuracy1000: 0.3478 - 12s/epoch - 24ms/step
Epoch 4/50
512/512 - 12s - loss: 3.2856 - accuracy1000: 0.3616 - val_loss: 3.3088 - val_accuracy1000: 0.3494 - 12s/epoch - 23ms/step
Epoch 5/50
512/512 - 12s - loss: 3.2753 - accuracy1000: 0.3720 - val_loss: 3.3173 - val_accuracy1000: 0.3496 - 12s/epoch - 24ms/step
Epoch 6/50
512/512 - 12s - loss: 3.2679 - accuracy1000: 0.3780 - val_loss: 3.3177 - val_accuracy1000: 0.3560 - 12s/epoch - 24ms/step
Epoch 7/50
512/512 - 13s - loss: 3.2565 - accuracy1000: 0.3875 - val_loss: 3.3243 - val_accuracy1000: 0.3555 - 13s/epoch - 24ms/step
Epoch 8/50
512/512 - 12s - loss: 3.2480 - accuracy1000: 0.3957 - val_loss: 3.3346 - val_accuracy1000: 0.3559 - 12s/epoch - 23ms/step
Epoch 9/50
512/512 - 11s - loss: 3.2397 - accuracy1000: 0.4005 - val_loss: 3.3321 - val_accuracy1000: 0.3594 - 11s/epoch - 22ms/step
Epoch 10/50
512/512 - 12s - loss: 3.2291 - accuracy1000: 0.4046 - val_loss: 3.3448 - val_accuracy1000: 0.3581 - 12s/epoch - 23ms/step
Epoch 11/50
512/512 - 12s - loss: 3.2243 - accuracy1000: 0.4090 - val_loss: 3.3455 - val_accuracy1000: 0.3607 - 12s/epoch - 24ms/step
Epoch 12/50
512/512 - 12s - loss: 3.2177 - accuracy1000: 0.4116 - val_loss: 3.3499 - val_accuracy1000: 0.3575 - 12s/epoch - 24ms/step
Epoch 13/50
512/512 - 13s - loss: 3.2075 - accuracy1000: 0.4169 - val_loss: 3.3639 - val_accuracy1000: 0.3547 - 13s/epoch - 26ms/step
testing model: results/XRAY/W6/deepVOL_L2/h1000
Evaluating performance on  test set...
1214/1214 - 13s - 13s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1080765
{'0': {'precision': 0.40081643949353074, 'recall': 0.05084790393933011, 'f1-score': 0.09024699916654334, 'support': 113928}, '1': {'precision': 0.3099316933513825, 'recall': 0.2147716858051647, 'f1-score': 0.25372259798489305, 'support': 92745}, '2': {'precision': 0.34531738333872186, 'recall': 0.7700626778435745, 'f1-score': 0.47681689528837884, 'support': 104024}, 'accuracy': 0.3405794069463175, 'macro avg': {'precision': 0.3520218387278784, 'recall': 0.3452274225293564, 'f1-score': 0.2735954974799384, 'support': 310697}, 'weighted avg': {'precision': 0.3551052173111428, 'recall': 0.3405794069463175, 'f1-score': 0.2684723804434326, 'support': 310697}}
[[ 5793 25055 83080]
 [ 4036 19919 68790]
 [ 4624 19295 80105]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1046441
{'0': {'precision': 0.37526620018253726, 'recall': 0.055586850228701475, 'f1-score': 0.0968305367481111, 'support': 44381}, '1': {'precision': 0.41475614839516467, 'recall': 0.2571114795753569, 'f1-score': 0.3174392173022984, 'support': 46439}, '2': {'precision': 0.32173267223163665, 'recall': 0.766243148978575, 'f1-score': 0.4531818650635783, 'support': 40140}, 'accuracy': 0.3448686621869273, 'macro avg': {'precision': 0.3705850069364462, 'recall': 0.3596471595942112, 'f1-score': 0.2891505397046626, 'support': 130960}, 'weighted avg': {'precision': 0.372861174931293, 'recall': 0.3448686621869273, 'f1-score': 0.2842831087917791, 'support': 130960}}
[[ 2467  9103 32811]
 [ 2469 11940 32030]
 [ 1638  7745 30757]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1045296
{'0': {'precision': 0.3050913330742324, 'recall': 0.05908030405659667, 'f1-score': 0.09899117276166455, 'support': 13287}, '1': {'precision': 0.3978067687653621, 'recall': 0.2692603020220118, 'f1-score': 0.3211478287415096, 'support': 15628}, '2': {'precision': 0.33384451260168024, 'recall': 0.7036256323777403, 'f1-score': 0.45283530794971516, 'support': 14232}, 'accuracy': 0.34781097179409926, 'macro avg': {'precision': 0.34558087148042493, 'recall': 0.3439887461521163, 'f1-score': 0.29099143648429643, 'support': 43147}, 'weighted avg': {'precision': 0.34815741136508954, 'recall': 0.34781097179409926, 'f1-score': 0.2961722966323706, 'support': 43147}}
[[  785  2965  9537]
 [  975  4208 10445]
 [  813  3405 10014]]
training model: results/XRAY/W6/deepVOL_L3/h10
Epoch 1/50
512/512 - 21s - loss: 3.3319 - accuracy10: 0.3595 - val_loss: 3.3297 - val_accuracy10: 0.3702 - 21s/epoch - 41ms/step
Epoch 2/50
512/512 - 19s - loss: 3.2780 - accuracy10: 0.3743 - val_loss: 3.2465 - val_accuracy10: 0.3530 - 19s/epoch - 37ms/step
Epoch 3/50
512/512 - 19s - loss: 3.2191 - accuracy10: 0.3907 - val_loss: 3.2010 - val_accuracy10: 0.3741 - 19s/epoch - 37ms/step
Epoch 4/50
512/512 - 20s - loss: 3.1666 - accuracy10: 0.4098 - val_loss: 3.1468 - val_accuracy10: 0.4134 - 20s/epoch - 39ms/step
Epoch 5/50
512/512 - 20s - loss: 3.1307 - accuracy10: 0.4236 - val_loss: 3.1398 - val_accuracy10: 0.4087 - 20s/epoch - 39ms/step
Epoch 6/50
512/512 - 19s - loss: 3.0998 - accuracy10: 0.4383 - val_loss: 3.1051 - val_accuracy10: 0.4225 - 19s/epoch - 37ms/step
Epoch 7/50
512/512 - 19s - loss: 3.0815 - accuracy10: 0.4464 - val_loss: 3.0916 - val_accuracy10: 0.4330 - 19s/epoch - 36ms/step
Epoch 8/50
512/512 - 19s - loss: 3.0624 - accuracy10: 0.4555 - val_loss: 3.0901 - val_accuracy10: 0.4380 - 19s/epoch - 37ms/step
Epoch 9/50
512/512 - 18s - loss: 3.0461 - accuracy10: 0.4644 - val_loss: 3.0675 - val_accuracy10: 0.4525 - 18s/epoch - 36ms/step
Epoch 10/50
512/512 - 20s - loss: 3.0312 - accuracy10: 0.4720 - val_loss: 3.0760 - val_accuracy10: 0.4430 - 20s/epoch - 38ms/step
Epoch 11/50
512/512 - 19s - loss: 3.0192 - accuracy10: 0.4772 - val_loss: 3.0632 - val_accuracy10: 0.4549 - 19s/epoch - 36ms/step
Epoch 12/50
512/512 - 19s - loss: 3.0068 - accuracy10: 0.4845 - val_loss: 3.0707 - val_accuracy10: 0.4492 - 19s/epoch - 37ms/step
Epoch 13/50
512/512 - 19s - loss: 2.9975 - accuracy10: 0.4895 - val_loss: 3.0732 - val_accuracy10: 0.4469 - 19s/epoch - 37ms/step
Epoch 14/50
512/512 - 19s - loss: 2.9891 - accuracy10: 0.4930 - val_loss: 3.0533 - val_accuracy10: 0.4582 - 19s/epoch - 37ms/step
Epoch 15/50
512/512 - 19s - loss: 2.9806 - accuracy10: 0.4967 - val_loss: 3.0559 - val_accuracy10: 0.4528 - 19s/epoch - 37ms/step
Epoch 16/50
512/512 - 20s - loss: 2.9746 - accuracy10: 0.4985 - val_loss: 3.0600 - val_accuracy10: 0.4536 - 20s/epoch - 39ms/step
Epoch 17/50
512/512 - 20s - loss: 2.9694 - accuracy10: 0.5005 - val_loss: 3.0520 - val_accuracy10: 0.4528 - 20s/epoch - 40ms/step
Epoch 18/50
512/512 - 19s - loss: 2.9602 - accuracy10: 0.5026 - val_loss: 3.0559 - val_accuracy10: 0.4524 - 19s/epoch - 38ms/step
Epoch 19/50
512/512 - 19s - loss: 2.9559 - accuracy10: 0.5054 - val_loss: 3.0593 - val_accuracy10: 0.4501 - 19s/epoch - 37ms/step
Epoch 20/50
512/512 - 19s - loss: 2.9478 - accuracy10: 0.5077 - val_loss: 3.0714 - val_accuracy10: 0.4470 - 19s/epoch - 37ms/step
Epoch 21/50
512/512 - 19s - loss: 2.9426 - accuracy10: 0.5087 - val_loss: 3.0622 - val_accuracy10: 0.4480 - 19s/epoch - 37ms/step
Epoch 22/50
512/512 - 19s - loss: 2.9349 - accuracy10: 0.5108 - val_loss: 3.0643 - val_accuracy10: 0.4483 - 19s/epoch - 36ms/step
Epoch 23/50
512/512 - 18s - loss: 2.9287 - accuracy10: 0.5117 - val_loss: 3.0571 - val_accuracy10: 0.4531 - 18s/epoch - 36ms/step
Epoch 24/50
512/512 - 18s - loss: 2.9233 - accuracy10: 0.5131 - val_loss: 3.0564 - val_accuracy10: 0.4549 - 18s/epoch - 36ms/step
Epoch 25/50
512/512 - 18s - loss: 2.9187 - accuracy10: 0.5140 - val_loss: 3.0595 - val_accuracy10: 0.4523 - 18s/epoch - 36ms/step
Epoch 26/50
512/512 - 18s - loss: 2.9112 - accuracy10: 0.5181 - val_loss: 3.0643 - val_accuracy10: 0.4519 - 18s/epoch - 36ms/step
Epoch 27/50
512/512 - 20s - loss: 2.9099 - accuracy10: 0.5176 - val_loss: 3.0769 - val_accuracy10: 0.4451 - 20s/epoch - 40ms/step
testing model: results/XRAY/W6/deepVOL_L3/h10
Evaluating performance on  test set...
1214/1214 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0315012
{'0': {'precision': 0.426195853007596, 'recall': 0.5225956855319754, 'f1-score': 0.4694985250737463, 'support': 91367}, '1': {'precision': 0.6428989139515455, 'recall': 0.3607462908127788, 'f1-score': 0.4621621215836808, 'support': 127993}, '2': {'precision': 0.41762322222572607, 'recall': 0.5799730667746915, 'f1-score': 0.48558765428703693, 'support': 91337}, 'accuracy': 0.47278860111298143, 'macro avg': {'precision': 0.49557266306162256, 'recall': 0.48777168103981533, 'f1-score': 0.47241610031482134, 'support': 310697}, 'weighted avg': {'precision': 0.5129475001161141, 'recall': 0.47278860111298143, 'f1-score': 0.4712060552496101, 'support': 310697}}
[[47748 12629 30990]
 [38939 46173 42881]
 [25346 13018 52973]]
Evaluating performance on  train set...
512/512 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.039981
{'0': {'precision': 0.38401391653664746, 'recall': 0.6061197916666666, 'f1-score': 0.4701555621425199, 'support': 35328}, '1': {'precision': 0.6983468064962494, 'recall': 0.3147029865441418, 'f1-score': 0.43388158638944824, 'support': 60940}, '2': {'precision': 0.4060581938538241, 'recall': 0.5587455321111495, 'f1-score': 0.47031991168156845, 'support': 34692}, 'accuracy': 0.45796426389737327, 'macro avg': {'precision': 0.49613963896224034, 'recall': 0.49318943677398597, 'f1-score': 0.4581190200711789, 'support': 130960}, 'weighted avg': {'precision': 0.5361230062039171, 'recall': 0.45796426389737327, 'f1-score': 0.453319623930978, 'support': 130960}}
[[21413  4104  9811]
 [23220 19178 18542]
 [11128  4180 19384]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0480257
{'0': {'precision': 0.37356941236848856, 'recall': 0.6288552915766739, 'f1-score': 0.4687057308435287, 'support': 11575}, '1': {'precision': 0.683646408839779, 'recall': 0.3114993454838385, 'f1-score': 0.4279883785279469, 'support': 19862}, '2': {'precision': 0.4133588831097728, 'recall': 0.515798462852263, 'f1-score': 0.4589316921206595, 'support': 11710}, 'accuracy': 0.4520824159269474, 'macro avg': {'precision': 0.49019156810601344, 'recall': 0.4853843666375918, 'f1-score': 0.45187526716404497, 'support': 43147}, 'weighted avg': {'precision': 0.52710694698951, 'recall': 0.4520824159269474, 'f1-score': 0.44730952612160396, 'support': 43147}}
[[7279 1448 2848]
 [7951 6187 5724]
 [4255 1415 6040]]
training model: results/XRAY/W6/deepVOL_L3/h20
Epoch 1/50
512/512 - 21s - loss: 3.3303 - accuracy20: 0.3522 - val_loss: 3.3013 - val_accuracy20: 0.3484 - 21s/epoch - 41ms/step
Epoch 2/50
512/512 - 19s - loss: 3.2904 - accuracy20: 0.3652 - val_loss: 3.2699 - val_accuracy20: 0.3769 - 19s/epoch - 36ms/step
Epoch 3/50
512/512 - 19s - loss: 3.2552 - accuracy20: 0.3906 - val_loss: 3.2295 - val_accuracy20: 0.4049 - 19s/epoch - 36ms/step
Epoch 4/50
512/512 - 19s - loss: 3.2174 - accuracy20: 0.4100 - val_loss: 3.2027 - val_accuracy20: 0.4216 - 19s/epoch - 37ms/step
Epoch 5/50
512/512 - 18s - loss: 3.1866 - accuracy20: 0.4264 - val_loss: 3.1772 - val_accuracy20: 0.4334 - 18s/epoch - 36ms/step
Epoch 6/50
512/512 - 19s - loss: 3.1584 - accuracy20: 0.4379 - val_loss: 3.1730 - val_accuracy20: 0.4375 - 19s/epoch - 37ms/step
Epoch 7/50
512/512 - 19s - loss: 3.1414 - accuracy20: 0.4466 - val_loss: 3.1624 - val_accuracy20: 0.4429 - 19s/epoch - 37ms/step
Epoch 8/50
512/512 - 18s - loss: 3.1267 - accuracy20: 0.4539 - val_loss: 3.1517 - val_accuracy20: 0.4480 - 18s/epoch - 36ms/step
Epoch 9/50
512/512 - 20s - loss: 3.1112 - accuracy20: 0.4595 - val_loss: 3.1509 - val_accuracy20: 0.4500 - 20s/epoch - 39ms/step
Epoch 10/50
512/512 - 18s - loss: 3.1018 - accuracy20: 0.4641 - val_loss: 3.1446 - val_accuracy20: 0.4516 - 18s/epoch - 36ms/step
Epoch 11/50
512/512 - 19s - loss: 3.0908 - accuracy20: 0.4666 - val_loss: 3.1353 - val_accuracy20: 0.4558 - 19s/epoch - 37ms/step
Epoch 12/50
512/512 - 19s - loss: 3.0816 - accuracy20: 0.4704 - val_loss: 3.1301 - val_accuracy20: 0.4587 - 19s/epoch - 37ms/step
Epoch 13/50
512/512 - 19s - loss: 3.0733 - accuracy20: 0.4730 - val_loss: 3.1283 - val_accuracy20: 0.4597 - 19s/epoch - 37ms/step
Epoch 14/50
512/512 - 19s - loss: 3.0652 - accuracy20: 0.4779 - val_loss: 3.1361 - val_accuracy20: 0.4584 - 19s/epoch - 37ms/step
Epoch 15/50
512/512 - 18s - loss: 3.0570 - accuracy20: 0.4790 - val_loss: 3.1277 - val_accuracy20: 0.4613 - 18s/epoch - 36ms/step
Epoch 16/50
512/512 - 20s - loss: 3.0497 - accuracy20: 0.4816 - val_loss: 3.1326 - val_accuracy20: 0.4599 - 20s/epoch - 40ms/step
Epoch 17/50
512/512 - 20s - loss: 3.0422 - accuracy20: 0.4849 - val_loss: 3.1421 - val_accuracy20: 0.4595 - 20s/epoch - 39ms/step
Epoch 18/50
512/512 - 18s - loss: 3.0363 - accuracy20: 0.4878 - val_loss: 3.1401 - val_accuracy20: 0.4585 - 18s/epoch - 36ms/step
Epoch 19/50
512/512 - 18s - loss: 3.0304 - accuracy20: 0.4891 - val_loss: 3.1396 - val_accuracy20: 0.4596 - 18s/epoch - 36ms/step
Epoch 20/50
512/512 - 18s - loss: 3.0239 - accuracy20: 0.4911 - val_loss: 3.1393 - val_accuracy20: 0.4618 - 18s/epoch - 36ms/step
Epoch 21/50
512/512 - 18s - loss: 3.0186 - accuracy20: 0.4923 - val_loss: 3.1289 - val_accuracy20: 0.4589 - 18s/epoch - 36ms/step
Epoch 22/50
512/512 - 19s - loss: 3.0159 - accuracy20: 0.4935 - val_loss: 3.1332 - val_accuracy20: 0.4627 - 19s/epoch - 36ms/step
Epoch 23/50
512/512 - 19s - loss: 3.0101 - accuracy20: 0.4953 - val_loss: 3.1369 - val_accuracy20: 0.4606 - 19s/epoch - 37ms/step
Epoch 24/50
512/512 - 19s - loss: 3.0018 - accuracy20: 0.4971 - val_loss: 3.1388 - val_accuracy20: 0.4593 - 19s/epoch - 37ms/step
Epoch 25/50
512/512 - 19s - loss: 2.9987 - accuracy20: 0.4986 - val_loss: 3.1391 - val_accuracy20: 0.4595 - 19s/epoch - 37ms/step
testing model: results/XRAY/W6/deepVOL_L3/h20
Evaluating performance on  test set...
1214/1214 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0303954
{'0': {'precision': 0.491886011641078, 'recall': 0.39723943049668514, 'f1-score': 0.4395252005471518, 'support': 110412}, '1': {'precision': 0.5006771509908515, 'recall': 0.4014671335490448, 'f1-score': 0.44561701290235284, 'support': 90244}, '2': {'precision': 0.45574788158318136, 'recall': 0.6177970029352696, 'f1-score': 0.5245419719222711, 'support': 110041}, 'accuracy': 0.47658329497870916, 'macro avg': {'precision': 0.48277034807170366, 'recall': 0.4721678556603332, 'f1-score': 0.46989472845725855, 'support': 310697}, 'weighted avg': {'precision': 0.4816402468277067, 'recall': 0.47658329497870916, 'f1-score': 0.47140539267347503, 'support': 310697}}
[[43860 18911 47641]
 [20470 36230 33544]
 [24837 17221 67983]]
Evaluating performance on  train set...
512/512 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0375711
{'0': {'precision': 0.4458969080915901, 'recall': 0.4872686795603172, 'f1-score': 0.4656656878497423, 'support': 43122}, '1': {'precision': 0.5592585727525486, 'recall': 0.3302973245172308, 'f1-score': 0.41531197951795623, 'support': 45674}, '2': {'precision': 0.4376033203193697, 'recall': 0.5901479935489992, 'f1-score': 0.502554884575768, 'support': 42164}, 'accuracy': 0.4656459987782529, 'macro avg': {'precision': 0.48091960038783615, 'recall': 0.4692379992088491, 'f1-score': 0.4611775173144889, 'support': 130960}, 'weighted avg': {'precision': 0.48276304917968355, 'recall': 0.4656459987782529, 'f1-score': 0.4599810575535462, 'support': 130960}}
[[21012  6294 15816]
 [14425 15086 16163]
 [11686  5595 24883]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0448664
{'0': {'precision': 0.43464989927354863, 'recall': 0.5063651233909395, 'f1-score': 0.46777478483673873, 'support': 14061}, '1': {'precision': 0.5371044216561914, 'recall': 0.33075303863651795, 'f1-score': 0.4093965372331484, 'support': 14727}, '2': {'precision': 0.4492286828275979, 'recall': 0.5536597256076329, 'f1-score': 0.49600698777140007, 'support': 14359}, 'accuracy': 0.4621642292627529, 'macro avg': {'precision': 0.47366100125244603, 'recall': 0.46359262921169675, 'f1-score': 0.457726103280429, 'support': 43147}, 'weighted avg': {'precision': 0.47447154398075364, 'recall': 0.4621642292627529, 'f1-score': 0.4572444988256772, 'support': 43147}}
[[7120 2240 4701]
 [4810 4871 5046]
 [4451 1958 7950]]
training model: results/XRAY/W6/deepVOL_L3/h30
Epoch 1/50
512/512 - 22s - loss: 3.3331 - accuracy30: 0.3517 - val_loss: 3.2937 - val_accuracy30: 0.3613 - 22s/epoch - 43ms/step
Epoch 2/50
512/512 - 19s - loss: 3.2977 - accuracy30: 0.3568 - val_loss: 3.2880 - val_accuracy30: 0.3619 - 19s/epoch - 37ms/step
Epoch 3/50
512/512 - 19s - loss: 3.2774 - accuracy30: 0.3693 - val_loss: 3.2763 - val_accuracy30: 0.3765 - 19s/epoch - 37ms/step
Epoch 4/50
512/512 - 19s - loss: 3.2581 - accuracy30: 0.3827 - val_loss: 3.2702 - val_accuracy30: 0.3839 - 19s/epoch - 37ms/step
Epoch 5/50
512/512 - 19s - loss: 3.2388 - accuracy30: 0.3993 - val_loss: 3.2483 - val_accuracy30: 0.3998 - 19s/epoch - 36ms/step
Epoch 6/50
512/512 - 19s - loss: 3.2210 - accuracy30: 0.4108 - val_loss: 3.2352 - val_accuracy30: 0.4124 - 19s/epoch - 37ms/step
Epoch 7/50
512/512 - 19s - loss: 3.2045 - accuracy30: 0.4192 - val_loss: 3.2391 - val_accuracy30: 0.4168 - 19s/epoch - 37ms/step
Epoch 8/50
512/512 - 19s - loss: 3.1888 - accuracy30: 0.4292 - val_loss: 3.2338 - val_accuracy30: 0.4179 - 19s/epoch - 36ms/step
Epoch 9/50
512/512 - 19s - loss: 3.1777 - accuracy30: 0.4343 - val_loss: 3.2218 - val_accuracy30: 0.4242 - 19s/epoch - 37ms/step
Epoch 10/50
512/512 - 19s - loss: 3.1670 - accuracy30: 0.4391 - val_loss: 3.2137 - val_accuracy30: 0.4252 - 19s/epoch - 37ms/step
Epoch 11/50
512/512 - 19s - loss: 3.1567 - accuracy30: 0.4454 - val_loss: 3.2104 - val_accuracy30: 0.4278 - 19s/epoch - 37ms/step
Epoch 12/50
512/512 - 19s - loss: 3.1484 - accuracy30: 0.4486 - val_loss: 3.2155 - val_accuracy30: 0.4289 - 19s/epoch - 37ms/step
Epoch 13/50
512/512 - 19s - loss: 3.1420 - accuracy30: 0.4518 - val_loss: 3.2069 - val_accuracy30: 0.4328 - 19s/epoch - 38ms/step
Epoch 14/50
512/512 - 19s - loss: 3.1333 - accuracy30: 0.4539 - val_loss: 3.2109 - val_accuracy30: 0.4344 - 19s/epoch - 37ms/step
Epoch 15/50
512/512 - 19s - loss: 3.1285 - accuracy30: 0.4554 - val_loss: 3.2013 - val_accuracy30: 0.4354 - 19s/epoch - 36ms/step
Epoch 16/50
512/512 - 19s - loss: 3.1217 - accuracy30: 0.4580 - val_loss: 3.2042 - val_accuracy30: 0.4384 - 19s/epoch - 37ms/step
Epoch 17/50
512/512 - 19s - loss: 3.1163 - accuracy30: 0.4609 - val_loss: 3.2096 - val_accuracy30: 0.4355 - 19s/epoch - 37ms/step
Epoch 18/50
512/512 - 19s - loss: 3.1091 - accuracy30: 0.4631 - val_loss: 3.2087 - val_accuracy30: 0.4356 - 19s/epoch - 37ms/step
Epoch 19/50
512/512 - 19s - loss: 3.1024 - accuracy30: 0.4676 - val_loss: 3.2060 - val_accuracy30: 0.4381 - 19s/epoch - 37ms/step
Epoch 20/50
512/512 - 19s - loss: 3.0995 - accuracy30: 0.4669 - val_loss: 3.2078 - val_accuracy30: 0.4387 - 19s/epoch - 37ms/step
Epoch 21/50
512/512 - 19s - loss: 3.0909 - accuracy30: 0.4699 - val_loss: 3.1996 - val_accuracy30: 0.4406 - 19s/epoch - 36ms/step
Epoch 22/50
512/512 - 19s - loss: 3.0860 - accuracy30: 0.4707 - val_loss: 3.2065 - val_accuracy30: 0.4389 - 19s/epoch - 37ms/step
Epoch 23/50
512/512 - 19s - loss: 3.0796 - accuracy30: 0.4730 - val_loss: 3.2107 - val_accuracy30: 0.4375 - 19s/epoch - 36ms/step
Epoch 24/50
512/512 - 19s - loss: 3.0731 - accuracy30: 0.4756 - val_loss: 3.2095 - val_accuracy30: 0.4369 - 19s/epoch - 37ms/step
Epoch 25/50
512/512 - 19s - loss: 3.0690 - accuracy30: 0.4772 - val_loss: 3.2092 - val_accuracy30: 0.4365 - 19s/epoch - 37ms/step
Epoch 26/50
512/512 - 19s - loss: 3.0625 - accuracy30: 0.4786 - val_loss: 3.2077 - val_accuracy30: 0.4383 - 19s/epoch - 37ms/step
Epoch 27/50
512/512 - 19s - loss: 3.0586 - accuracy30: 0.4800 - val_loss: 3.2157 - val_accuracy30: 0.4336 - 19s/epoch - 36ms/step
Epoch 28/50
512/512 - 19s - loss: 3.0512 - accuracy30: 0.4829 - val_loss: 3.2181 - val_accuracy30: 0.4347 - 19s/epoch - 37ms/step
Epoch 29/50
512/512 - 19s - loss: 3.0468 - accuracy30: 0.4837 - val_loss: 3.2176 - val_accuracy30: 0.4372 - 19s/epoch - 36ms/step
Epoch 30/50
512/512 - 19s - loss: 3.0414 - accuracy30: 0.4850 - val_loss: 3.2226 - val_accuracy30: 0.4348 - 19s/epoch - 36ms/step
Epoch 31/50
512/512 - 19s - loss: 3.0320 - accuracy30: 0.4897 - val_loss: 3.2292 - val_accuracy30: 0.4347 - 19s/epoch - 37ms/step
testing model: results/XRAY/W6/deepVOL_L3/h30
Evaluating performance on  test set...
1214/1214 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0447907
{'0': {'precision': 0.4704309855765098, 'recall': 0.4728738432826149, 'f1-score': 0.4716492513196165, 'support': 115737}, '1': {'precision': 0.4501466834304873, 'recall': 0.2920709474074532, 'f1-score': 0.3542755193067415, 'support': 80905}, '2': {'precision': 0.4605293765199309, 'recall': 0.5728201306387269, 'f1-score': 0.510573616755236, 'support': 114055}, 'accuracy': 0.4624827404191222, 'macro avg': {'precision': 0.4603690151756427, 'recall': 0.44592164044293164, 'f1-score': 0.44549946246053135, 'support': 310697}, 'weighted avg': {'precision': 0.461514164731532, 'recall': 0.4624827404191222, 'f1-score': 0.45537422037711606, 'support': 310697}}
[[54729 15140 45868]
 [26611 23630 30664]
 [34998 13724 65333]]
Evaluating performance on  train set...
512/512 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0509367
{'0': {'precision': 0.4332406364404393, 'recall': 0.5557938945086706, 'f1-score': 0.4869243551194809, 'support': 44288}, '1': {'precision': 0.5411354581673307, 'recall': 0.25110345943197837, 'f1-score': 0.3430303221631178, 'support': 43273}, '2': {'precision': 0.4373150340337378, 'recall': 0.5447821378372774, 'f1-score': 0.48516873069780325, 'support': 43399}, 'accuracy': 0.4514660965180208, 'macro avg': {'precision': 0.47056370954716925, 'recall': 0.4505598305926421, 'f1-score': 0.43837446932680063, 'support': 130960}, 'weighted avg': {'precision': 0.47024244922097785, 'recall': 0.4514660965180208, 'f1-score': 0.43879577515310114, 'support': 130960}}
[[24615  4539 15134]
 [17120 10866 15287]
 [15081  4675 23643]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0658607
{'0': {'precision': 0.4115559554156045, 'recall': 0.5641658102089757, 'f1-score': 0.4759262470377435, 'support': 14595}, '1': {'precision': 0.4926152469043712, 'recall': 0.2429727740986019, 'f1-score': 0.3254324151185138, 'support': 13590}, '2': {'precision': 0.4503254851858612, 'recall': 0.4947199572249699, 'f1-score': 0.471479983438963, 'support': 14962}, 'accuracy': 0.43891811713444734, 'macro avg': {'precision': 0.45149889583527897, 'recall': 0.4339528471775158, 'f1-score': 0.4242795485317401, 'support': 43147}, 'weighted avg': {'precision': 0.4505312138519945, 'recall': 0.43891811713444734, 'f1-score': 0.4269834196859627, 'support': 43147}}
[[8234 1701 4660]
 [5913 3302 4375]
 [5860 1700 7402]]
training model: results/XRAY/W6/deepVOL_L3/h50
Epoch 1/50
512/512 - 21s - loss: 3.3401 - accuracy50: 0.3487 - val_loss: 3.3185 - val_accuracy50: 0.3378 - 21s/epoch - 42ms/step
Epoch 2/50
512/512 - 19s - loss: 3.3039 - accuracy50: 0.3540 - val_loss: 3.2996 - val_accuracy50: 0.3546 - 19s/epoch - 37ms/step
Epoch 3/50
512/512 - 19s - loss: 3.2842 - accuracy50: 0.3673 - val_loss: 3.2848 - val_accuracy50: 0.3710 - 19s/epoch - 37ms/step
Epoch 4/50
512/512 - 19s - loss: 3.2690 - accuracy50: 0.3798 - val_loss: 3.2704 - val_accuracy50: 0.3848 - 19s/epoch - 37ms/step
Epoch 5/50
512/512 - 19s - loss: 3.2548 - accuracy50: 0.3908 - val_loss: 3.2714 - val_accuracy50: 0.3854 - 19s/epoch - 37ms/step
Epoch 6/50
512/512 - 19s - loss: 3.2463 - accuracy50: 0.3968 - val_loss: 3.2682 - val_accuracy50: 0.3909 - 19s/epoch - 38ms/step
Epoch 7/50
512/512 - 19s - loss: 3.2362 - accuracy50: 0.4027 - val_loss: 3.2591 - val_accuracy50: 0.3979 - 19s/epoch - 37ms/step
Epoch 8/50
512/512 - 19s - loss: 3.2290 - accuracy50: 0.4075 - val_loss: 3.2560 - val_accuracy50: 0.3972 - 19s/epoch - 37ms/step
Epoch 9/50
512/512 - 19s - loss: 3.2218 - accuracy50: 0.4118 - val_loss: 3.2529 - val_accuracy50: 0.3984 - 19s/epoch - 37ms/step
Epoch 10/50
512/512 - 19s - loss: 3.2143 - accuracy50: 0.4162 - val_loss: 3.2491 - val_accuracy50: 0.4007 - 19s/epoch - 37ms/step
Epoch 11/50
512/512 - 18s - loss: 3.2076 - accuracy50: 0.4199 - val_loss: 3.2613 - val_accuracy50: 0.3986 - 18s/epoch - 36ms/step
Epoch 12/50
512/512 - 18s - loss: 3.2036 - accuracy50: 0.4216 - val_loss: 3.2608 - val_accuracy50: 0.4002 - 18s/epoch - 36ms/step
Epoch 13/50
512/512 - 19s - loss: 3.1973 - accuracy50: 0.4242 - val_loss: 3.2546 - val_accuracy50: 0.4010 - 19s/epoch - 37ms/step
Epoch 14/50
512/512 - 19s - loss: 3.1927 - accuracy50: 0.4268 - val_loss: 3.2629 - val_accuracy50: 0.3994 - 19s/epoch - 37ms/step
Epoch 15/50
512/512 - 19s - loss: 3.1884 - accuracy50: 0.4284 - val_loss: 3.2634 - val_accuracy50: 0.3997 - 19s/epoch - 36ms/step
Epoch 16/50
512/512 - 19s - loss: 3.1834 - accuracy50: 0.4323 - val_loss: 3.2569 - val_accuracy50: 0.3990 - 19s/epoch - 37ms/step
Epoch 17/50
512/512 - 19s - loss: 3.1784 - accuracy50: 0.4326 - val_loss: 3.2595 - val_accuracy50: 0.4023 - 19s/epoch - 37ms/step
Epoch 18/50
512/512 - 19s - loss: 3.1749 - accuracy50: 0.4352 - val_loss: 3.2568 - val_accuracy50: 0.4009 - 19s/epoch - 38ms/step
Epoch 19/50
512/512 - 20s - loss: 3.1704 - accuracy50: 0.4364 - val_loss: 3.2564 - val_accuracy50: 0.4030 - 20s/epoch - 39ms/step
Epoch 20/50
512/512 - 19s - loss: 3.1654 - accuracy50: 0.4407 - val_loss: 3.2702 - val_accuracy50: 0.4010 - 19s/epoch - 37ms/step
testing model: results/XRAY/W6/deepVOL_L3/h50
Evaluating performance on  test set...
1214/1214 - 20s - 20s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0762634
{'0': {'precision': 0.44480400018868815, 'recall': 0.41229711767175037, 'f1-score': 0.42793412208925014, 'support': 114352}, '1': {'precision': 0.36832210559298134, 'recall': 0.16819688550783393, 'f1-score': 0.23093546380275695, 'support': 83866}, '2': {'precision': 0.4199117809668037, 'recall': 0.6212270734981641, 'f1-score': 0.5011061986567844, 'support': 112479}, 'accuracy': 0.422044628689688, 'macro avg': {'precision': 0.41101262891615775, 'recall': 0.40057369222591616, 'f1-score': 0.38665859484959714, 'support': 310697}, 'weighted avg': {'precision': 0.41514783196684535, 'recall': 0.422044628689688, 'f1-score': 0.40124842034248287, 'support': 310697}}
[[47147 13129 54076]
 [27307 14106 42453]
 [31541 11063 69875]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.074622
{'0': {'precision': 0.41456821480406386, 'recall': 0.5112538034723465, 'f1-score': 0.4578624669391681, 'support': 44696}, '1': {'precision': 0.43899974741096237, 'recall': 0.16305469556243551, 'f1-score': 0.23778902722670683, 'support': 42636}, '2': {'precision': 0.40360642623825077, 'recall': 0.5551022279270194, 'f1-score': 0.4673845916319284, 'support': 43628}, 'accuracy': 0.4125, 'macro avg': {'precision': 0.4190581294844257, 'recall': 0.4098035756539338, 'f1-score': 0.3876786952659344, 'support': 130960}, 'weighted avg': {'precision': 0.41887045909757664, 'recall': 0.4125, 'f1-score': 0.3893864443407812, 'support': 130960}}
[[22851  4324 17521]
 [17419  6952 18265]
 [14850  4560 24218]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0820562
{'0': {'precision': 0.38845077588399896, 'recall': 0.5276798673025088, 'f1-score': 0.4474856406048529, 'support': 14469}, '1': {'precision': 0.4093886462882096, 'recall': 0.16287823946720717, 'f1-score': 0.23303987571206627, 'support': 13814}, '2': {'precision': 0.41225827961769285, 'recall': 0.4991254036598493, 'f1-score': 0.4515520389531345, 'support': 14864}, 'accuracy': 0.4010475815236285, 'macro avg': {'precision': 0.40336590059663374, 'recall': 0.3965611701431884, 'f1-score': 0.3773591850900179, 'support': 43147}, 'weighted avg': {'precision': 0.40335587884043606, 'recall': 0.4010475815236285, 'f1-score': 0.3802292646996892, 'support': 43147}}
[[7635 1565 5269]
 [6256 2250 5308]
 [5764 1681 7419]]
training model: results/XRAY/W6/deepVOL_L3/h100
Epoch 1/50
512/512 - 21s - loss: 3.3338 - accuracy100: 0.3502 - val_loss: 3.3162 - val_accuracy100: 0.3368 - 21s/epoch - 41ms/step
Epoch 2/50
512/512 - 19s - loss: 3.3032 - accuracy100: 0.3473 - val_loss: 3.3012 - val_accuracy100: 0.3344 - 19s/epoch - 37ms/step
Epoch 3/50
512/512 - 19s - loss: 3.2975 - accuracy100: 0.3464 - val_loss: 3.2978 - val_accuracy100: 0.3419 - 19s/epoch - 37ms/step
Epoch 4/50
512/512 - 20s - loss: 3.2915 - accuracy100: 0.3552 - val_loss: 3.2985 - val_accuracy100: 0.3415 - 20s/epoch - 38ms/step
Epoch 5/50
512/512 - 20s - loss: 3.2862 - accuracy100: 0.3617 - val_loss: 3.2953 - val_accuracy100: 0.3483 - 20s/epoch - 39ms/step
Epoch 6/50
512/512 - 20s - loss: 3.2810 - accuracy100: 0.3665 - val_loss: 3.2923 - val_accuracy100: 0.3569 - 20s/epoch - 38ms/step
Epoch 7/50
512/512 - 18s - loss: 3.2759 - accuracy100: 0.3752 - val_loss: 3.2947 - val_accuracy100: 0.3569 - 18s/epoch - 36ms/step
Epoch 8/50
512/512 - 19s - loss: 3.2699 - accuracy100: 0.3789 - val_loss: 3.2971 - val_accuracy100: 0.3581 - 19s/epoch - 37ms/step
Epoch 9/50
512/512 - 19s - loss: 3.2654 - accuracy100: 0.3821 - val_loss: 3.2999 - val_accuracy100: 0.3613 - 19s/epoch - 37ms/step
Epoch 10/50
512/512 - 19s - loss: 3.2611 - accuracy100: 0.3851 - val_loss: 3.2967 - val_accuracy100: 0.3631 - 19s/epoch - 36ms/step
Epoch 11/50
512/512 - 19s - loss: 3.2574 - accuracy100: 0.3899 - val_loss: 3.2983 - val_accuracy100: 0.3652 - 19s/epoch - 37ms/step
Epoch 12/50
512/512 - 19s - loss: 3.2531 - accuracy100: 0.3925 - val_loss: 3.3001 - val_accuracy100: 0.3648 - 19s/epoch - 37ms/step
Epoch 13/50
512/512 - 19s - loss: 3.2476 - accuracy100: 0.3960 - val_loss: 3.3111 - val_accuracy100: 0.3643 - 19s/epoch - 38ms/step
Epoch 14/50
512/512 - 19s - loss: 3.2398 - accuracy100: 0.3991 - val_loss: 3.3206 - val_accuracy100: 0.3627 - 19s/epoch - 36ms/step
Epoch 15/50
512/512 - 19s - loss: 3.2376 - accuracy100: 0.4015 - val_loss: 3.3182 - val_accuracy100: 0.3666 - 19s/epoch - 36ms/step
Epoch 16/50
512/512 - 19s - loss: 3.2319 - accuracy100: 0.4042 - val_loss: 3.3171 - val_accuracy100: 0.3679 - 19s/epoch - 37ms/step
testing model: results/XRAY/W6/deepVOL_L3/h100
Evaluating performance on  test set...
1214/1214 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0913757
{'0': {'precision': 0.4032884848040474, 'recall': 0.38018956772682894, 'f1-score': 0.39139851897974165, 'support': 115737}, '1': {'precision': 0.28938149059515367, 'recall': 0.17254370477208864, 'f1-score': 0.21618632185698705, 'support': 80426}, '2': {'precision': 0.39915383864353826, 'recall': 0.5354217961478688, 'f1-score': 0.4573533853651988, 'support': 114534}, 'accuracy': 0.38366318310122083, 'macro avg': {'precision': 0.36394127134757975, 'recall': 0.3627183562155955, 'f1-score': 0.3549794087339759, 'support': 310697}, 'weighted avg': {'precision': 0.372278718119489, 'recall': 0.38366318310122083, 'f1-score': 0.37035698494754077, 'support': 310697}}
[[44002 17552 54183]
 [28421 13877 38128]
 [36685 16525 61324]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.092344
{'0': {'precision': 0.37153505275063503, 'recall': 0.4559790647400159, 'f1-score': 0.40944849710864545, 'support': 43945}, '1': {'precision': 0.3974925917483474, 'recall': 0.1971464749242527, 'f1-score': 0.2635691721709164, 'support': 44226}, '2': {'precision': 0.36150439265229073, 'recall': 0.4654467269625371, 'f1-score': 0.4069431248148262, 'support': 42789}, 'accuracy': 0.3716631032376298, 'macro avg': {'precision': 0.37684401238375775, 'recall': 0.3728574222089352, 'f1-score': 0.35998693136479604, 'support': 130960}, 'weighted avg': {'precision': 0.3770237226098651, 'recall': 0.3716631032376298, 'f1-score': 0.35936556033576644, 'support': 130960}}
[[20038  6421 17486]
 [17817  8719 17690]
 [16078  6795 19916]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0970114
{'0': {'precision': 0.3492340011272224, 'recall': 0.48132194054092226, 'f1-score': 0.4047746303224657, 'support': 14161}, '1': {'precision': 0.3710033888315898, 'recall': 0.17363122327954764, 'f1-score': 0.23655408896613275, 'support': 14502}, '2': {'precision': 0.36210888796532686, 'recall': 0.42108533554266775, 'f1-score': 0.3893765761164491, 'support': 14484}, 'accuracy': 0.3576841958884743, 'macro avg': {'precision': 0.36078209264137967, 'recall': 0.3586794997877125, 'f1-score': 0.3435684318016825, 'support': 43147}, 'weighted avg': {'precision': 0.36087280617628353, 'recall': 0.3576841958884743, 'f1-score': 0.34306559590826574, 'support': 43147}}
[[6816 2027 5318]
 [6558 2518 5426]
 [6143 2242 6099]]
training model: results/XRAY/W6/deepVOL_L3/h200
Epoch 1/50
512/512 - 22s - loss: 3.3315 - accuracy200: 0.3580 - val_loss: 3.3000 - val_accuracy200: 0.3551 - 22s/epoch - 43ms/step
Epoch 2/50
512/512 - 19s - loss: 3.2964 - accuracy200: 0.3589 - val_loss: 3.2992 - val_accuracy200: 0.3566 - 19s/epoch - 37ms/step
Epoch 3/50
512/512 - 20s - loss: 3.2905 - accuracy200: 0.3623 - val_loss: 3.2932 - val_accuracy200: 0.3598 - 20s/epoch - 39ms/step
Epoch 4/50
512/512 - 20s - loss: 3.2866 - accuracy200: 0.3641 - val_loss: 3.2944 - val_accuracy200: 0.3626 - 20s/epoch - 39ms/step
Epoch 5/50
512/512 - 19s - loss: 3.2824 - accuracy200: 0.3690 - val_loss: 3.2984 - val_accuracy200: 0.3642 - 19s/epoch - 37ms/step
Epoch 6/50
512/512 - 19s - loss: 3.2788 - accuracy200: 0.3724 - val_loss: 3.2942 - val_accuracy200: 0.3621 - 19s/epoch - 37ms/step
Epoch 7/50
512/512 - 19s - loss: 3.2762 - accuracy200: 0.3739 - val_loss: 3.2969 - val_accuracy200: 0.3650 - 19s/epoch - 36ms/step
Epoch 8/50
512/512 - 20s - loss: 3.2733 - accuracy200: 0.3752 - val_loss: 3.2984 - val_accuracy200: 0.3640 - 20s/epoch - 40ms/step
Epoch 9/50
512/512 - 19s - loss: 3.2689 - accuracy200: 0.3801 - val_loss: 3.3093 - val_accuracy200: 0.3647 - 19s/epoch - 37ms/step
Epoch 10/50
512/512 - 19s - loss: 3.2687 - accuracy200: 0.3793 - val_loss: 3.3048 - val_accuracy200: 0.3624 - 19s/epoch - 37ms/step
Epoch 11/50
512/512 - 19s - loss: 3.2648 - accuracy200: 0.3821 - val_loss: 3.3002 - val_accuracy200: 0.3655 - 19s/epoch - 37ms/step
Epoch 12/50
512/512 - 19s - loss: 3.2574 - accuracy200: 0.3877 - val_loss: 3.3166 - val_accuracy200: 0.3638 - 19s/epoch - 36ms/step
Epoch 13/50
512/512 - 19s - loss: 3.2551 - accuracy200: 0.3883 - val_loss: 3.3108 - val_accuracy200: 0.3587 - 19s/epoch - 37ms/step
testing model: results/XRAY/W6/deepVOL_L3/h200
Evaluating performance on  test set...
1214/1214 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0861249
{'0': {'precision': 0.38879762752765706, 'recall': 0.22776628088193965, 'f1-score': 0.28725323824458143, 'support': 117423}, '1': {'precision': 0.257781324820431, 'recall': 0.004206112536298882, 'f1-score': 0.008277169874176768, 'support': 76793}, '2': {'precision': 0.382265068251231, 'recall': 0.789776873481512, 'f1-score': 0.5151762913847946, 'support': 116481}, 'accuracy': 0.3832093647508666, 'macro avg': {'precision': 0.34294800686643967, 'recall': 0.3405830889665835, 'f1-score': 0.27023556650118424, 'support': 310697}, 'weighted avg': {'precision': 0.35396609078648034, 'recall': 0.3832093647508666, 'f1-score': 0.3037493612662285, 'support': 310697}}
[[26745   466 90212]
 [18021   323 58449]
 [24023   464 91994]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1043156
{'0': {'precision': 0.3515182016440195, 'recall': 0.23258446920925277, 'f1-score': 0.2799428197352073, 'support': 45046}, '1': {'precision': 0.39399624765478425, 'recall': 0.0048836073579684195, 'f1-score': 0.0096476317361143, 'support': 43001}, '2': {'precision': 0.34049213889606644, 'recall': 0.7983827744506327, 'f1-score': 0.4773887901905458, 'support': 42913}, 'accuracy': 0.3432193036041539, 'macro avg': {'precision': 0.3620021960649567, 'recall': 0.3452836170059513, 'f1-score': 0.2556597472206225, 'support': 130960}, 'weighted avg': {'precision': 0.3618529376382619, 'recall': 0.3432193036041539, 'f1-score': 0.2558899452010056, 'support': 130960}}
[[10477   189 34380]
 [10810   210 31981]
 [ 8518   134 34261]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0976069
{'0': {'precision': 0.3553784162578837, 'recall': 0.26808960549791844, 'f1-score': 0.3056235639760443, 'support': 15133}, '1': {'precision': 0.28205128205128205, 'recall': 0.004337197381909944, 'f1-score': 0.008543025784405094, 'support': 12681}, '2': {'precision': 0.36456747843734144, 'recall': 0.7498206482749625, 'f1-score': 0.49060146365401447, 'support': 15333}, 'accuracy': 0.3617632743875588, 'macro avg': {'precision': 0.3339990589155024, 'recall': 0.3407491503849303, 'f1-score': 0.2682560178048213, 'support': 43147}, 'weighted avg': {'precision': 0.3370928923865534, 'recall': 0.3617632743875588, 'f1-score': 0.2840458837422885, 'support': 43147}}
[[ 4057    82 10994]
 [ 3581    55  9045]
 [ 3778    58 11497]]
training model: results/XRAY/W6/deepVOL_L3/h300
Epoch 1/50
512/512 - 22s - loss: 3.3421 - accuracy300: 0.3513 - val_loss: 3.3174 - val_accuracy300: 0.3374 - 22s/epoch - 42ms/step
Epoch 2/50
512/512 - 19s - loss: 3.3107 - accuracy300: 0.3377 - val_loss: 3.2955 - val_accuracy300: 0.3404 - 19s/epoch - 37ms/step
Epoch 3/50
512/512 - 19s - loss: 3.2945 - accuracy300: 0.3535 - val_loss: 3.2984 - val_accuracy300: 0.3487 - 19s/epoch - 36ms/step
Epoch 4/50
512/512 - 19s - loss: 3.2869 - accuracy300: 0.3648 - val_loss: 3.2980 - val_accuracy300: 0.3507 - 19s/epoch - 36ms/step
Epoch 5/50
512/512 - 19s - loss: 3.2832 - accuracy300: 0.3692 - val_loss: 3.2945 - val_accuracy300: 0.3563 - 19s/epoch - 37ms/step
Epoch 6/50
512/512 - 19s - loss: 3.2745 - accuracy300: 0.3772 - val_loss: 3.3038 - val_accuracy300: 0.3506 - 19s/epoch - 37ms/step
Epoch 7/50
512/512 - 19s - loss: 3.2660 - accuracy300: 0.3846 - val_loss: 3.2969 - val_accuracy300: 0.3554 - 19s/epoch - 37ms/step
Epoch 8/50
512/512 - 19s - loss: 3.2594 - accuracy300: 0.3893 - val_loss: 3.3098 - val_accuracy300: 0.3475 - 19s/epoch - 37ms/step
Epoch 9/50
512/512 - 19s - loss: 3.2533 - accuracy300: 0.3936 - val_loss: 3.3049 - val_accuracy300: 0.3536 - 19s/epoch - 37ms/step
Epoch 10/50
512/512 - 19s - loss: 3.2456 - accuracy300: 0.3979 - val_loss: 3.3090 - val_accuracy300: 0.3480 - 19s/epoch - 37ms/step
Epoch 11/50
512/512 - 20s - loss: 3.2386 - accuracy300: 0.4017 - val_loss: 3.3001 - val_accuracy300: 0.3573 - 20s/epoch - 40ms/step
Epoch 12/50
512/512 - 19s - loss: 3.2329 - accuracy300: 0.4078 - val_loss: 3.2989 - val_accuracy300: 0.3581 - 19s/epoch - 37ms/step
Epoch 13/50
512/512 - 20s - loss: 3.2258 - accuracy300: 0.4104 - val_loss: 3.2942 - val_accuracy300: 0.3620 - 20s/epoch - 40ms/step
Epoch 14/50
512/512 - 20s - loss: 3.2232 - accuracy300: 0.4131 - val_loss: 3.3037 - val_accuracy300: 0.3599 - 20s/epoch - 40ms/step
Epoch 15/50
512/512 - 19s - loss: 3.2097 - accuracy300: 0.4210 - val_loss: 3.3091 - val_accuracy300: 0.3635 - 19s/epoch - 38ms/step
Epoch 16/50
512/512 - 19s - loss: 3.2126 - accuracy300: 0.4199 - val_loss: 3.3044 - val_accuracy300: 0.3714 - 19s/epoch - 38ms/step
Epoch 17/50
512/512 - 20s - loss: 3.2021 - accuracy300: 0.4263 - val_loss: 3.3114 - val_accuracy300: 0.3692 - 20s/epoch - 38ms/step
Epoch 18/50
512/512 - 19s - loss: 3.1932 - accuracy300: 0.4292 - val_loss: 3.3258 - val_accuracy300: 0.3674 - 19s/epoch - 38ms/step
Epoch 19/50
512/512 - 20s - loss: 3.1830 - accuracy300: 0.4337 - val_loss: 3.3370 - val_accuracy300: 0.3702 - 20s/epoch - 38ms/step
Epoch 20/50
512/512 - 21s - loss: 3.1733 - accuracy300: 0.4379 - val_loss: 3.3318 - val_accuracy300: 0.3659 - 21s/epoch - 41ms/step
Epoch 21/50
512/512 - 21s - loss: 3.1631 - accuracy300: 0.4443 - val_loss: 3.3362 - val_accuracy300: 0.3632 - 21s/epoch - 40ms/step
Epoch 22/50
512/512 - 20s - loss: 3.1570 - accuracy300: 0.4481 - val_loss: 3.3673 - val_accuracy300: 0.3614 - 20s/epoch - 38ms/step
Epoch 23/50
512/512 - 19s - loss: 3.1501 - accuracy300: 0.4492 - val_loss: 3.3640 - val_accuracy300: 0.3590 - 19s/epoch - 38ms/step
testing model: results/XRAY/W6/deepVOL_L3/h300
Evaluating performance on  test set...
1214/1214 - 22s - 22s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1013544
{'0': {'precision': 0.33332294749961056, 'recall': 0.09689076467444957, 'f1-score': 0.15013893956830496, 'support': 110413}, '1': {'precision': 0.3614551491514704, 'recall': 0.29765095209678294, 'f1-score': 0.32646479552067403, 'support': 92165}, '2': {'precision': 0.36776415103647647, 'recall': 0.6894995329220581, 'f1-score': 0.47967827555698545, 'support': 108119}, 'accuracy': 0.36266523333022205, 'macro avg': {'precision': 0.3541807492291858, 'recall': 0.3613470832310968, 'f1-score': 0.31876067021532145, 'support': 310697}, 'weighted avg': {'precision': 0.35365321412737355, 'recall': 0.36266523333022205, 'f1-score': 0.3171200690340231, 'support': 310697}}
[[10698 26117 73598]
 [10172 27433 54560]
 [11225 22346 74548]]
Evaluating performance on  train set...
512/512 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0924551
{'0': {'precision': 0.3833127535720586, 'recall': 0.09876374875011362, 'f1-score': 0.15705973763145534, 'support': 44004}, '1': {'precision': 0.45761025066865707, 'recall': 0.3236406827379905, 'f1-score': 0.37913885954288956, 'support': 45464}, '2': {'precision': 0.34242237161018885, 'recall': 0.7218499951797936, 'f1-score': 0.4645006203473945, 'support': 41492}, 'accuracy': 0.3742440439828955, 'macro avg': {'precision': 0.39444845861696815, 'recall': 0.3814181422226326, 'f1-score': 0.3335664058405798, 'support': 130960}, 'weighted avg': {'precision': 0.39615054892665424, 'recall': 0.3742440439828955, 'f1-score': 0.33156296231251203, 'support': 130960}}
[[ 4346  9006 30652]
 [ 3885 14714 26865]
 [ 3107  8434 29951]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1009256
{'0': {'precision': 0.31001765225066197, 'recall': 0.10135622565286394, 'f1-score': 0.15276720669783622, 'support': 13862}, '1': {'precision': 0.4108072300558342, 'recall': 0.28891846921797004, 'f1-score': 0.33924663957486717, 'support': 15025}, '2': {'precision': 0.3490088419851683, 'recall': 0.6864656381486676, 'f1-score': 0.4627493618228231, 'support': 14260}, 'accuracy': 0.36004820729135284, 'macro avg': {'precision': 0.35661124143055484, 'recall': 0.35891344433983385, 'f1-score': 0.31825440269850885, 'support': 43147}, 'weighted avg': {'precision': 0.3580019332467167, 'recall': 0.36004820729135284, 'f1-score': 0.32015309705080863, 'support': 43147}}
[[1405 3084 9373]
 [1798 4341 8886]
 [1329 3142 9789]]
training model: results/XRAY/W6/deepVOL_L3/h500
Epoch 1/50
512/512 - 22s - loss: 3.3379 - accuracy500: 0.3527 - val_loss: 3.3069 - val_accuracy500: 0.3397 - 22s/epoch - 42ms/step
Epoch 2/50
512/512 - 20s - loss: 3.3087 - accuracy500: 0.3395 - val_loss: 3.2973 - val_accuracy500: 0.3563 - 20s/epoch - 39ms/step
Epoch 3/50
512/512 - 20s - loss: 3.2960 - accuracy500: 0.3496 - val_loss: 3.2965 - val_accuracy500: 0.3531 - 20s/epoch - 38ms/step
Epoch 4/50
512/512 - 20s - loss: 3.2885 - accuracy500: 0.3569 - val_loss: 3.2937 - val_accuracy500: 0.3639 - 20s/epoch - 38ms/step
Epoch 5/50
512/512 - 19s - loss: 3.2832 - accuracy500: 0.3628 - val_loss: 3.2945 - val_accuracy500: 0.3652 - 19s/epoch - 37ms/step
Epoch 6/50
512/512 - 19s - loss: 3.2708 - accuracy500: 0.3726 - val_loss: 3.2956 - val_accuracy500: 0.3644 - 19s/epoch - 38ms/step
Epoch 7/50
512/512 - 20s - loss: 3.2652 - accuracy500: 0.3782 - val_loss: 3.2929 - val_accuracy500: 0.3694 - 20s/epoch - 39ms/step
Epoch 8/50
512/512 - 20s - loss: 3.2614 - accuracy500: 0.3812 - val_loss: 3.2957 - val_accuracy500: 0.3708 - 20s/epoch - 39ms/step
Epoch 9/50
512/512 - 20s - loss: 3.2525 - accuracy500: 0.3885 - val_loss: 3.3058 - val_accuracy500: 0.3672 - 20s/epoch - 39ms/step
Epoch 10/50
512/512 - 22s - loss: 3.2450 - accuracy500: 0.3930 - val_loss: 3.3002 - val_accuracy500: 0.3713 - 22s/epoch - 43ms/step
Epoch 11/50
512/512 - 21s - loss: 3.2396 - accuracy500: 0.3986 - val_loss: 3.3002 - val_accuracy500: 0.3684 - 21s/epoch - 41ms/step
Epoch 12/50
512/512 - 20s - loss: 3.2319 - accuracy500: 0.4024 - val_loss: 3.3024 - val_accuracy500: 0.3683 - 20s/epoch - 38ms/step
Epoch 13/50
512/512 - 19s - loss: 3.2250 - accuracy500: 0.4080 - val_loss: 3.3055 - val_accuracy500: 0.3644 - 19s/epoch - 37ms/step
Epoch 14/50
512/512 - 20s - loss: 3.2238 - accuracy500: 0.4083 - val_loss: 3.3104 - val_accuracy500: 0.3691 - 20s/epoch - 38ms/step
Epoch 15/50
512/512 - 19s - loss: 3.2186 - accuracy500: 0.4096 - val_loss: 3.3126 - val_accuracy500: 0.3680 - 19s/epoch - 37ms/step
Epoch 16/50
512/512 - 19s - loss: 3.2153 - accuracy500: 0.4124 - val_loss: 3.3143 - val_accuracy500: 0.3690 - 19s/epoch - 37ms/step
Epoch 17/50
512/512 - 20s - loss: 3.2028 - accuracy500: 0.4171 - val_loss: 3.3224 - val_accuracy500: 0.3650 - 20s/epoch - 38ms/step
testing model: results/XRAY/W6/deepVOL_L3/h500
Evaluating performance on  test set...
1214/1214 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1030327
{'0': {'precision': 0.3656776853419716, 'recall': 0.04280752557506184, 'f1-score': 0.07664295523631706, 'support': 116031}, '1': {'precision': 0.29859648848149917, 'recall': 0.45277688755949624, 'f1-score': 0.3598679245283019, 'support': 84249}, '2': {'precision': 0.3775086648205334, 'recall': 0.5790412708188051, 'f1-score': 0.4570448209307313, 'support': 110417}, 'accuracy': 0.34454468501466057, 'macro avg': {'precision': 0.3472609462146681, 'recall': 0.3582085613177877, 'f1-score': 0.29785190023178343, 'support': 310697}, 'weighted avg': {'precision': 0.35169241193021167, 'recall': 0.34454468501466057, 'f1-score': 0.28863165561726883, 'support': 310697}}
[[ 4967 48368 62696]
 [ 3372 38146 42731]
 [ 5244 41237 63936]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.091987
{'0': {'precision': 0.415065334358186, 'recall': 0.04593496799438573, 'f1-score': 0.08271583663622264, 'support': 47023}, '1': {'precision': 0.37116708238780216, 'recall': 0.490313150331979, 'f1-score': 0.42250093398089344, 'support': 40364}, '2': {'precision': 0.355435908055498, 'recall': 0.5908704931953274, 'f1-score': 0.4438659402799807, 'support': 43573}, 'accuracy': 0.3642104459376909, 'macro avg': {'precision': 0.3805561082671621, 'recall': 0.375706203840564, 'f1-score': 0.31636090363236563, 'support': 130960}, 'weighted avg': {'precision': 0.38169528216805465, 'recall': 0.3642104459376909, 'f1-score': 0.3076049564841897, 'support': 130960}}
[[ 2160 17444 27419]
 [ 1303 19791 19270]
 [ 1741 16086 25746]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0976641
{'0': {'precision': 0.34986945169712796, 'recall': 0.03723773794636654, 'f1-score': 0.06731131483109382, 'support': 14394}, '1': {'precision': 0.3604385564184559, 'recall': 0.4631300902487343, 'f1-score': 0.4053819723194503, 'support': 13629}, '2': {'precision': 0.37870804464174584, 'recall': 0.6035440359693203, 'f1-score': 0.46539373390776756, 'support': 15124}, 'accuracy': 0.37026908012144527, 'macro avg': {'precision': 0.36300535091910996, 'recall': 0.36797062138814035, 'f1-score': 0.3126956736861039, 'support': 43147}, 'weighted avg': {'precision': 0.36331653279063114, 'recall': 0.37026908012144527, 'f1-score': 0.31363582168034, 'support': 43147}}
[[ 536 5747 8111]
 [ 453 6312 6864]
 [ 543 5453 9128]]
training model: results/XRAY/W6/deepVOL_L3/h1000
Epoch 1/50
512/512 - 22s - loss: 3.3454 - accuracy1000: 0.3481 - val_loss: 3.3025 - val_accuracy1000: 0.3556 - 22s/epoch - 43ms/step
Epoch 2/50
512/512 - 21s - loss: 3.3083 - accuracy1000: 0.3356 - val_loss: 3.2917 - val_accuracy1000: 0.3638 - 21s/epoch - 40ms/step
Epoch 3/50
512/512 - 19s - loss: 3.2986 - accuracy1000: 0.3431 - val_loss: 3.2873 - val_accuracy1000: 0.3599 - 19s/epoch - 37ms/step
Epoch 4/50
512/512 - 19s - loss: 3.2931 - accuracy1000: 0.3499 - val_loss: 3.2928 - val_accuracy1000: 0.3587 - 19s/epoch - 38ms/step
Epoch 5/50
512/512 - 19s - loss: 3.2862 - accuracy1000: 0.3578 - val_loss: 3.2925 - val_accuracy1000: 0.3607 - 19s/epoch - 38ms/step
Epoch 6/50
512/512 - 21s - loss: 3.2829 - accuracy1000: 0.3617 - val_loss: 3.2989 - val_accuracy1000: 0.3559 - 21s/epoch - 41ms/step
Epoch 7/50
512/512 - 19s - loss: 3.2795 - accuracy1000: 0.3663 - val_loss: 3.2972 - val_accuracy1000: 0.3646 - 19s/epoch - 37ms/step
Epoch 8/50
512/512 - 20s - loss: 3.2750 - accuracy1000: 0.3662 - val_loss: 3.2954 - val_accuracy1000: 0.3611 - 20s/epoch - 38ms/step
Epoch 9/50
512/512 - 20s - loss: 3.2674 - accuracy1000: 0.3751 - val_loss: 3.3025 - val_accuracy1000: 0.3616 - 20s/epoch - 39ms/step
Epoch 10/50
512/512 - 20s - loss: 3.2608 - accuracy1000: 0.3773 - val_loss: 3.3192 - val_accuracy1000: 0.3572 - 20s/epoch - 39ms/step
Epoch 11/50
512/512 - 21s - loss: 3.2520 - accuracy1000: 0.3847 - val_loss: 3.3282 - val_accuracy1000: 0.3622 - 21s/epoch - 41ms/step
Epoch 12/50
512/512 - 21s - loss: 3.2449 - accuracy1000: 0.3926 - val_loss: 3.3217 - val_accuracy1000: 0.3603 - 21s/epoch - 40ms/step
Epoch 13/50
512/512 - 20s - loss: 3.2331 - accuracy1000: 0.4003 - val_loss: 3.3314 - val_accuracy1000: 0.3602 - 20s/epoch - 38ms/step
testing model: results/XRAY/W6/deepVOL_L3/h1000
Evaluating performance on  test set...
1214/1214 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1039418
{'0': {'precision': 0.3392070484581498, 'recall': 0.0020275963766589423, 'f1-score': 0.004031097034264324, 'support': 113928}, '1': {'precision': 0.32196350403459734, 'recall': 0.2632918216615451, 'f1-score': 0.2896867529910018, 'support': 92745}, '2': {'precision': 0.3489913396990246, 'recall': 0.7856263939090979, 'f1-score': 0.48329371133898685, 'support': 104024}, 'accuracy': 0.3423721503587096, 'macro avg': {'precision': 0.33672063073059055, 'recall': 0.3503152706491006, 'f1-score': 0.2590038537880843, 'support': 310697}, 'weighted avg': {'precision': 0.3373356064567092, 'recall': 0.3423721503587096, 'f1-score': 0.24976230139781488, 'support': 310697}}
[[  231 29362 84335]
 [  213 24419 68113]
 [  237 22063 81724]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1009043
{'0': {'precision': 0.3914590747330961, 'recall': 0.0024785381131565308, 'f1-score': 0.004925887779320228, 'support': 44381}, '1': {'precision': 0.43576726291992224, 'recall': 0.23658993518378948, 'f1-score': 0.3066767152347457, 'support': 46439}, '2': {'precision': 0.32233136745491436, 'recall': 0.8469108121574489, 'f1-score': 0.4669450434734832, 'support': 40140}, 'accuracy': 0.3443188759926695, 'macro avg': {'precision': 0.3831859017026442, 'recall': 0.36199309515146494, 'f1-score': 0.25951588216251636, 'support': 130960}, 'weighted avg': {'precision': 0.38598291240155824, 'recall': 0.3443188759926695, 'f1-score': 0.25353962927112084, 'support': 130960}}
[[  110  8157 36114]
 [   95 10987 35357]
 [   76  6069 33995]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0967982
{'0': {'precision': 0.3629032258064516, 'recall': 0.0033867690223526757, 'f1-score': 0.006710908955335173, 'support': 13287}, '1': {'precision': 0.41716588606905564, 'recall': 0.24507294599436907, 'f1-score': 0.308758918134548, 'support': 15628}, '2': {'precision': 0.34666981856864254, 'recall': 0.8243395165823496, 'f1-score': 0.48808087531721933, 'support': 14232}, 'accuracy': 0.3617169212227965, 'macro avg': {'precision': 0.37557964348138323, 'recall': 0.3575997438663571, 'f1-score': 0.2678502341357008, 'support': 43147}, 'weighted avg': {'precision': 0.3772027831980542, 'recall': 0.3617169212227965, 'f1-score': 0.2748932541639261, 'support': 43147}}
[[   45  2879 10363]
 [   51  3830 11747]
 [   28  2472 11732]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        16 (peak)  13.29 (ave)

============================================
