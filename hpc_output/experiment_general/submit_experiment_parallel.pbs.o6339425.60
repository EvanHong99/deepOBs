This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/LILAK_orderbooks/LILAK_orderbooks_2019-09-04.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-08-27.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-08-14.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-08-15.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-08-23.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-08-19.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-08-21.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-08-16.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-09-06.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-08-20.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-08-22.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-08-13.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-08-29.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-08-28.csv
training model: results/LILAK/W6/deepLOB_L1/h10
Epoch 1/50
211/211 - 26s - loss: 3.3265 - accuracy10: 0.3648 - val_loss: 3.4645 - val_accuracy10: 0.3431 - 26s/epoch - 124ms/step
Epoch 2/50
211/211 - 5s - loss: 3.2940 - accuracy10: 0.3659 - val_loss: 3.4112 - val_accuracy10: 0.3728 - 5s/epoch - 22ms/step
Epoch 3/50
211/211 - 5s - loss: 3.2785 - accuracy10: 0.3707 - val_loss: 3.3615 - val_accuracy10: 0.3791 - 5s/epoch - 22ms/step
Epoch 4/50
211/211 - 4s - loss: 3.2557 - accuracy10: 0.3788 - val_loss: 3.3548 - val_accuracy10: 0.3774 - 4s/epoch - 21ms/step
Epoch 5/50
211/211 - 4s - loss: 3.2417 - accuracy10: 0.3879 - val_loss: 3.3291 - val_accuracy10: 0.3547 - 4s/epoch - 20ms/step
Epoch 6/50
211/211 - 4s - loss: 3.2287 - accuracy10: 0.3921 - val_loss: 3.3348 - val_accuracy10: 0.3874 - 4s/epoch - 20ms/step
Epoch 7/50
211/211 - 4s - loss: 3.2124 - accuracy10: 0.4029 - val_loss: 3.3078 - val_accuracy10: 0.3935 - 4s/epoch - 20ms/step
Epoch 8/50
211/211 - 4s - loss: 3.1990 - accuracy10: 0.4078 - val_loss: 3.3294 - val_accuracy10: 0.3935 - 4s/epoch - 19ms/step
Epoch 9/50
211/211 - 5s - loss: 3.1944 - accuracy10: 0.4078 - val_loss: 3.3381 - val_accuracy10: 0.3826 - 5s/epoch - 21ms/step
Epoch 10/50
211/211 - 5s - loss: 3.1758 - accuracy10: 0.4197 - val_loss: 3.2944 - val_accuracy10: 0.4019 - 5s/epoch - 22ms/step
Epoch 11/50
211/211 - 5s - loss: 3.1683 - accuracy10: 0.4217 - val_loss: 3.3127 - val_accuracy10: 0.3933 - 5s/epoch - 21ms/step
Epoch 12/50
211/211 - 4s - loss: 3.1653 - accuracy10: 0.4260 - val_loss: 3.3255 - val_accuracy10: 0.3912 - 4s/epoch - 20ms/step
Epoch 13/50
211/211 - 5s - loss: 3.1544 - accuracy10: 0.4275 - val_loss: 3.3118 - val_accuracy10: 0.3909 - 5s/epoch - 24ms/step
Epoch 14/50
211/211 - 5s - loss: 3.1492 - accuracy10: 0.4327 - val_loss: 3.3192 - val_accuracy10: 0.4049 - 5s/epoch - 23ms/step
Epoch 15/50
211/211 - 5s - loss: 3.1441 - accuracy10: 0.4359 - val_loss: 3.3190 - val_accuracy10: 0.3999 - 5s/epoch - 22ms/step
Epoch 16/50
211/211 - 5s - loss: 3.1352 - accuracy10: 0.4387 - val_loss: 3.3113 - val_accuracy10: 0.4016 - 5s/epoch - 23ms/step
Epoch 17/50
211/211 - 5s - loss: 3.1282 - accuracy10: 0.4433 - val_loss: 3.3415 - val_accuracy10: 0.4013 - 5s/epoch - 23ms/step
Epoch 18/50
211/211 - 5s - loss: 3.1210 - accuracy10: 0.4473 - val_loss: 3.3331 - val_accuracy10: 0.4029 - 5s/epoch - 22ms/step
Epoch 19/50
211/211 - 5s - loss: 3.1186 - accuracy10: 0.4462 - val_loss: 3.3166 - val_accuracy10: 0.4084 - 5s/epoch - 22ms/step
Epoch 20/50
211/211 - 5s - loss: 3.1102 - accuracy10: 0.4514 - val_loss: 3.3125 - val_accuracy10: 0.4129 - 5s/epoch - 22ms/step
testing model: results/LILAK/W6/deepLOB_L1/h10
Evaluating performance on  test set...
1059/1059 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1138556
{'0': {'precision': 0.3984302691496057, 'recall': 0.13003866602223296, 'f1-score': 0.19608093212232738, 'support': 82760}, '1': {'precision': 0.381440195956325, 'recall': 0.36535077690847095, 'f1-score': 0.37322216523898266, 'support': 100591}, '2': {'precision': 0.3582202724293877, 'recall': 0.6032194810524876, 'f1-score': 0.4495038738616284, 'support': 87716}, 'accuracy': 0.37048036094397324, 'macro avg': {'precision': 0.3793635791784395, 'recall': 0.36620297466106383, 'f1-score': 0.3396023237409795, 'support': 271067}, 'weighted avg': {'precision': 0.37911361118350895, 'recall': 0.37048036094397324, 'f1-score': 0.34382322660318265, 'support': 271067}}
[[10762 30855 41143]
 [10187 36751 53653]
 [ 6062 28742 52912]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0780382
{'0': {'precision': 0.37318972861141536, 'recall': 0.4008758742401464, 'f1-score': 0.38653767371506004, 'support': 15299}, '1': {'precision': 0.47419440745672436, 'recall': 0.3682577763070814, 'f1-score': 0.4145654350306163, 'support': 24176}, '2': {'precision': 0.33024, 'recall': 0.4275062137531069, 'f1-score': 0.37263043870734797, 'support': 14484}, 'accuracy': 0.3934098111529124, 'macro avg': {'precision': 0.3925413786893799, 'recall': 0.39887995476677823, 'f1-score': 0.3912445158176748, 'support': 53959}, 'weighted avg': {'precision': 0.40691543232268595, 'recall': 0.3934098111529124, 'f1-score': 0.3953622769455348, 'support': 53959}}
[[6133 5122 4044]
 [6759 8903 8514]
 [3542 4750 6192]]
Evaluating performance on  val set...
81/81 - 1s - 887ms/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0806891
{'0': {'precision': 0.38166862514688604, 'recall': 0.28067749740753545, 'f1-score': 0.32347375759386515, 'support': 5786}, '1': {'precision': 0.47007389162561575, 'recall': 0.4222345132743363, 'f1-score': 0.44487179487179485, 'support': 9040}, '2': {'precision': 0.3470104091019124, 'recall': 0.4933746343142316, 'f1-score': 0.40744688410431323, 'support': 5811}, 'accuracy': 0.40257789407375105, 'macro avg': {'precision': 0.39958430862480476, 'recall': 0.3987622149987011, 'f1-score': 0.3919308121899911, 'support': 20637}, 'weighted avg': {'precision': 0.41063527318344045, 'recall': 0.40257789407375105, 'f1-score': 0.40029723460819366, 'support': 20637}}
[[1624 2230 1932]
 [1760 3817 3463]
 [ 871 2073 2867]]
training model: results/LILAK/W6/deepLOB_L1/h20
Epoch 1/50
211/211 - 7s - loss: 3.3399 - accuracy20: 0.3582 - val_loss: 3.4181 - val_accuracy20: 0.3456 - 7s/epoch - 33ms/step
Epoch 2/50
211/211 - 5s - loss: 3.2949 - accuracy20: 0.3751 - val_loss: 3.3533 - val_accuracy20: 0.3539 - 5s/epoch - 23ms/step
Epoch 3/50
211/211 - 5s - loss: 3.2789 - accuracy20: 0.3805 - val_loss: 3.3463 - val_accuracy20: 0.3484 - 5s/epoch - 22ms/step
Epoch 4/50
211/211 - 5s - loss: 3.2727 - accuracy20: 0.3856 - val_loss: 3.3127 - val_accuracy20: 0.3592 - 5s/epoch - 22ms/step
Epoch 5/50
211/211 - 5s - loss: 3.2533 - accuracy20: 0.3981 - val_loss: 3.3113 - val_accuracy20: 0.3619 - 5s/epoch - 23ms/step
Epoch 6/50
211/211 - 5s - loss: 3.2413 - accuracy20: 0.4055 - val_loss: 3.3453 - val_accuracy20: 0.3475 - 5s/epoch - 22ms/step
Epoch 7/50
211/211 - 5s - loss: 3.2260 - accuracy20: 0.4129 - val_loss: 3.3226 - val_accuracy20: 0.3720 - 5s/epoch - 23ms/step
Epoch 8/50
211/211 - 5s - loss: 3.2237 - accuracy20: 0.4139 - val_loss: 3.3196 - val_accuracy20: 0.3647 - 5s/epoch - 23ms/step
Epoch 9/50
211/211 - 5s - loss: 3.2141 - accuracy20: 0.4167 - val_loss: 3.2997 - val_accuracy20: 0.3772 - 5s/epoch - 22ms/step
Epoch 10/50
211/211 - 5s - loss: 3.2068 - accuracy20: 0.4234 - val_loss: 3.3306 - val_accuracy20: 0.3774 - 5s/epoch - 23ms/step
Epoch 11/50
211/211 - 5s - loss: 3.1976 - accuracy20: 0.4275 - val_loss: 3.3097 - val_accuracy20: 0.3790 - 5s/epoch - 22ms/step
Epoch 12/50
211/211 - 5s - loss: 3.1943 - accuracy20: 0.4305 - val_loss: 3.3096 - val_accuracy20: 0.3799 - 5s/epoch - 22ms/step
Epoch 13/50
211/211 - 4s - loss: 3.1828 - accuracy20: 0.4311 - val_loss: 3.2999 - val_accuracy20: 0.3798 - 4s/epoch - 20ms/step
Epoch 14/50
211/211 - 5s - loss: 3.1752 - accuracy20: 0.4371 - val_loss: 3.3130 - val_accuracy20: 0.3815 - 5s/epoch - 22ms/step
Epoch 15/50
211/211 - 5s - loss: 3.1687 - accuracy20: 0.4394 - val_loss: 3.3309 - val_accuracy20: 0.3839 - 5s/epoch - 23ms/step
Epoch 16/50
211/211 - 5s - loss: 3.1690 - accuracy20: 0.4408 - val_loss: 3.3024 - val_accuracy20: 0.3815 - 5s/epoch - 22ms/step
Epoch 17/50
211/211 - 5s - loss: 3.1588 - accuracy20: 0.4447 - val_loss: 3.3229 - val_accuracy20: 0.3770 - 5s/epoch - 23ms/step
Epoch 18/50
211/211 - 5s - loss: 3.1604 - accuracy20: 0.4445 - val_loss: 3.3148 - val_accuracy20: 0.3809 - 5s/epoch - 22ms/step
Epoch 19/50
211/211 - 5s - loss: 3.1461 - accuracy20: 0.4500 - val_loss: 3.3287 - val_accuracy20: 0.3798 - 5s/epoch - 23ms/step
testing model: results/LILAK/W6/deepLOB_L1/h20
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1333578
{'0': {'precision': 0.44023070237813067, 'recall': 0.05762150982419855, 'f1-score': 0.10190477061367813, 'support': 96700}, '1': {'precision': 0.26727970384894945, 'recall': 0.6604477611940298, 'f1-score': 0.3805520234575875, 'support': 71824}, '2': {'precision': 0.4341986581493334, 'recall': 0.34269525954965235, 'f1-score': 0.3830582746517256, 'support': 102543}, 'accuracy': 0.32519266454419016, 'macro avg': {'precision': 0.38056968812547115, 'recall': 0.3535881768559603, 'f1-score': 0.2885050229076637, 'support': 271067}, 'weighted avg': {'precision': 0.3921223880878871, 'recall': 0.32519266454419016, 'f1-score': 0.2820959560137248, 'support': 271067}}
[[ 5572 66454 24674]
 [ 3270 47436 21118]
 [ 3815 63587 35141]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.108856
{'0': {'precision': 0.4540204353620613, 'recall': 0.16737635113003602, 'f1-score': 0.244585377527821, 'support': 18318}, '1': {'precision': 0.34774384236453204, 'recall': 0.4792006082328663, 'f1-score': 0.4030235903994154, 'support': 18414}, '2': {'precision': 0.35692364069442534, 'recall': 0.45231322923318046, 'f1-score': 0.3989963643811767, 'support': 17227}, 'accuracy': 0.36475842769510186, 'macro avg': {'precision': 0.3862293061403396, 'recall': 0.3662967295320276, 'f1-score': 0.3488684441028043, 'support': 53959}, 'weighted avg': {'precision': 0.3867533684187179, 'recall': 0.36475842769510186, 'f1-score': 0.34795125388469, 'support': 53959}}
[[3066 8915 6337]
 [1888 8824 7702]
 [1799 7636 7792]]
Evaluating performance on  val set...
81/81 - 1s - 757ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1005642
{'0': {'precision': 0.4668153931957613, 'recall': 0.1194178912826366, 'f1-score': 0.19018404907975459, 'support': 7009}, '1': {'precision': 0.34446225071225073, 'recall': 0.5765161674862167, 'f1-score': 0.4312545282282785, 'support': 6711}, '2': {'precision': 0.40449290593799264, 'recall': 0.4451351742084719, 'f1-score': 0.4238419712299539, 'support': 6917}, 'accuracy': 0.3772350632359355, 'macro avg': {'precision': 0.40525684994866823, 'recall': 0.3803564109924417, 'f1-score': 0.34842684951266234, 'support': 20637}, 'weighted avg': {'precision': 0.4061381347003974, 'recall': 0.3772350632359355, 'f1-score': 0.34689460938787453, 'support': 20637}}
[[ 837 3951 2221]
 [ 530 3869 2312]
 [ 426 3412 3079]]
training model: results/LILAK/W6/deepLOB_L1/h30
Epoch 1/50
211/211 - 7s - loss: 3.3485 - accuracy30: 0.3489 - val_loss: 3.3672 - val_accuracy30: 0.3524 - 7s/epoch - 34ms/step
Epoch 2/50
211/211 - 5s - loss: 3.3045 - accuracy30: 0.3706 - val_loss: 3.3449 - val_accuracy30: 0.3426 - 5s/epoch - 23ms/step
Epoch 3/50
211/211 - 5s - loss: 3.2894 - accuracy30: 0.3737 - val_loss: 3.4108 - val_accuracy30: 0.3424 - 5s/epoch - 23ms/step
Epoch 4/50
211/211 - 5s - loss: 3.2834 - accuracy30: 0.3795 - val_loss: 3.2975 - val_accuracy30: 0.3572 - 5s/epoch - 23ms/step
Epoch 5/50
211/211 - 5s - loss: 3.2663 - accuracy30: 0.3855 - val_loss: 3.2923 - val_accuracy30: 0.3554 - 5s/epoch - 23ms/step
Epoch 6/50
211/211 - 5s - loss: 3.2562 - accuracy30: 0.3972 - val_loss: 3.2832 - val_accuracy30: 0.3601 - 5s/epoch - 23ms/step
Epoch 7/50
211/211 - 5s - loss: 3.2422 - accuracy30: 0.4043 - val_loss: 3.3088 - val_accuracy30: 0.3497 - 5s/epoch - 22ms/step
Epoch 8/50
211/211 - 5s - loss: 3.2393 - accuracy30: 0.4046 - val_loss: 3.3237 - val_accuracy30: 0.3579 - 5s/epoch - 22ms/step
Epoch 9/50
211/211 - 5s - loss: 3.2327 - accuracy30: 0.4077 - val_loss: 3.3121 - val_accuracy30: 0.3509 - 5s/epoch - 23ms/step
Epoch 10/50
211/211 - 5s - loss: 3.2202 - accuracy30: 0.4149 - val_loss: 3.3302 - val_accuracy30: 0.3501 - 5s/epoch - 23ms/step
Epoch 11/50
211/211 - 5s - loss: 3.2133 - accuracy30: 0.4211 - val_loss: 3.3032 - val_accuracy30: 0.3533 - 5s/epoch - 23ms/step
Epoch 12/50
211/211 - 5s - loss: 3.2087 - accuracy30: 0.4208 - val_loss: 3.3201 - val_accuracy30: 0.3594 - 5s/epoch - 22ms/step
Epoch 13/50
211/211 - 5s - loss: 3.2051 - accuracy30: 0.4218 - val_loss: 3.3391 - val_accuracy30: 0.3464 - 5s/epoch - 22ms/step
Epoch 14/50
211/211 - 5s - loss: 3.2028 - accuracy30: 0.4241 - val_loss: 3.3381 - val_accuracy30: 0.3568 - 5s/epoch - 22ms/step
Epoch 15/50
211/211 - 5s - loss: 3.1915 - accuracy30: 0.4293 - val_loss: 3.3453 - val_accuracy30: 0.3550 - 5s/epoch - 22ms/step
Epoch 16/50
211/211 - 5s - loss: 3.1862 - accuracy30: 0.4290 - val_loss: 3.3778 - val_accuracy30: 0.3501 - 5s/epoch - 23ms/step
testing model: results/LILAK/W6/deepLOB_L1/h30
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1047482
{'0': {'precision': 0.4223357325284421, 'recall': 0.21183408147708988, 'f1-score': 0.2821487242038172, 'support': 94456}, '1': {'precision': 0.28097262417436336, 'recall': 0.5339596326412462, 'f1-score': 0.3681975720844145, 'support': 76002}, '2': {'precision': 0.42202483092762694, 'recall': 0.33245534693715273, 'f1-score': 0.37192338698468297, 'support': 100609}, 'accuracy': 0.3469216097865103, 'macro avg': {'precision': 0.3751110625434775, 'recall': 0.35941635368516295, 'f1-score': 0.3407565610909716, 'support': 271067}, 'weighted avg': {'precision': 0.38258482791709836, 'recall': 0.3469216097865103, 'f1-score': 0.33959586304528916, 'support': 271067}}
[[20009 51155 23292]
 [12904 40582 22516]
 [14464 52697 33448]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0954382
{'0': {'precision': 0.42763225475089883, 'recall': 0.22432374178251968, 'f1-score': 0.2942777365426077, 'support': 18558}, '1': {'precision': 0.34514327941538714, 'recall': 0.47172034564022, 'f1-score': 0.3986249407302039, 'support': 17822}, '2': {'precision': 0.3708849290244639, 'recall': 0.4191364696512885, 'f1-score': 0.39353718787555086, 'support': 17579}, 'accuracy': 0.36950277062213904, 'macro avg': {'precision': 0.38122015439691664, 'recall': 0.37172685235800934, 'f1-score': 0.36214662171612083, 'support': 53959}, 'weighted avg': {'precision': 0.38189975864506864, 'recall': 0.36950277062213904, 'f1-score': 0.36107952619795985, 'support': 53959}}
[[4163 8484 5911]
 [2828 8407 6587]
 [2744 7467 7368]]
Evaluating performance on  val set...
81/81 - 1s - 807ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.094282
{'0': {'precision': 0.45119947420308903, 'recall': 0.1917329981846111, 'f1-score': 0.26911015288122303, 'support': 7161}, '1': {'precision': 0.3220661244322383, 'recall': 0.467709771437337, 'f1-score': 0.38145877642937565, 'support': 6519}, '2': {'precision': 0.384151593453919, 'recall': 0.44875664798045134, 'f1-score': 0.4139485547600106, 'support': 6957}, 'accuracy': 0.3655570092552212, 'macro avg': {'precision': 0.3858057306964155, 'recall': 0.3693998058674664, 'f1-score': 0.35483916135686977, 'support': 20637}, 'weighted avg': {'precision': 0.3878049685322961, 'recall': 0.3655570092552212, 'f1-score': 0.353426741473612, 'support': 20637}}
[[1373 3381 2407]
 [ 872 3049 2598]
 [ 798 3037 3122]]
training model: results/LILAK/W6/deepLOB_L1/h50
Epoch 1/50
211/211 - 7s - loss: 3.3522 - accuracy50: 0.3476 - val_loss: 3.5287 - val_accuracy50: 0.3194 - 7s/epoch - 34ms/step
Epoch 2/50
211/211 - 5s - loss: 3.3191 - accuracy50: 0.3620 - val_loss: 3.4709 - val_accuracy50: 0.3273 - 5s/epoch - 22ms/step
Epoch 3/50
211/211 - 5s - loss: 3.2955 - accuracy50: 0.3698 - val_loss: 3.3662 - val_accuracy50: 0.3580 - 5s/epoch - 23ms/step
Epoch 4/50
211/211 - 5s - loss: 3.2822 - accuracy50: 0.3759 - val_loss: 3.3293 - val_accuracy50: 0.3497 - 5s/epoch - 23ms/step
Epoch 5/50
211/211 - 5s - loss: 3.2710 - accuracy50: 0.3803 - val_loss: 3.3165 - val_accuracy50: 0.3691 - 5s/epoch - 23ms/step
Epoch 6/50
211/211 - 5s - loss: 3.2668 - accuracy50: 0.3879 - val_loss: 3.3170 - val_accuracy50: 0.3704 - 5s/epoch - 22ms/step
Epoch 7/50
211/211 - 5s - loss: 3.2596 - accuracy50: 0.3912 - val_loss: 3.3437 - val_accuracy50: 0.3548 - 5s/epoch - 22ms/step
Epoch 8/50
211/211 - 5s - loss: 3.2514 - accuracy50: 0.3958 - val_loss: 3.3287 - val_accuracy50: 0.3595 - 5s/epoch - 22ms/step
Epoch 9/50
211/211 - 5s - loss: 3.2498 - accuracy50: 0.3966 - val_loss: 3.3041 - val_accuracy50: 0.3751 - 5s/epoch - 22ms/step
Epoch 10/50
211/211 - 5s - loss: 3.2388 - accuracy50: 0.4025 - val_loss: 3.3115 - val_accuracy50: 0.3675 - 5s/epoch - 22ms/step
Epoch 11/50
211/211 - 5s - loss: 3.2354 - accuracy50: 0.4068 - val_loss: 3.3394 - val_accuracy50: 0.3583 - 5s/epoch - 22ms/step
Epoch 12/50
211/211 - 5s - loss: 3.2281 - accuracy50: 0.4094 - val_loss: 3.3303 - val_accuracy50: 0.3652 - 5s/epoch - 23ms/step
Epoch 13/50
211/211 - 5s - loss: 3.2242 - accuracy50: 0.4121 - val_loss: 3.3380 - val_accuracy50: 0.3637 - 5s/epoch - 22ms/step
Epoch 14/50
211/211 - 5s - loss: 3.2189 - accuracy50: 0.4148 - val_loss: 3.3424 - val_accuracy50: 0.3647 - 5s/epoch - 22ms/step
Epoch 15/50
211/211 - 5s - loss: 3.2136 - accuracy50: 0.4167 - val_loss: 3.3633 - val_accuracy50: 0.3591 - 5s/epoch - 23ms/step
Epoch 16/50
211/211 - 5s - loss: 3.2151 - accuracy50: 0.4150 - val_loss: 3.3546 - val_accuracy50: 0.3673 - 5s/epoch - 22ms/step
Epoch 17/50
211/211 - 4s - loss: 3.2112 - accuracy50: 0.4163 - val_loss: 3.3457 - val_accuracy50: 0.3666 - 4s/epoch - 21ms/step
Epoch 18/50
211/211 - 5s - loss: 3.2066 - accuracy50: 0.4224 - val_loss: 3.4144 - val_accuracy50: 0.3569 - 5s/epoch - 21ms/step
Epoch 19/50
211/211 - 5s - loss: 3.2010 - accuracy50: 0.4231 - val_loss: 3.3620 - val_accuracy50: 0.3540 - 5s/epoch - 22ms/step
testing model: results/LILAK/W6/deepLOB_L1/h50
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1422276
{'0': {'precision': 0.36753423595965856, 'recall': 0.3636612590507279, 'f1-score': 0.3655874903644973, 'support': 91291}, '1': {'precision': 0.2998139129746209, 'recall': 0.4649466432527354, 'f1-score': 0.364551940611791, 'support': 81433}, '2': {'precision': 0.4045139845371238, 'recall': 0.22398137132281912, 'f1-score': 0.2883190659441347, 'support': 98343}, 'accuracy': 0.3434132520742104, 'macro avg': {'precision': 0.35728737782380104, 'recall': 0.35086309120876075, 'f1-score': 0.33948616564014095, 'support': 271067}, 'weighted avg': {'precision': 0.36060617150590024, 'recall': 0.3434132520742104, 'f1-score': 0.3372434404219228, 'support': 271067}}
[[33199 41383 16709]
 [27854 37862 15717]
 [29276 47040 22027]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0994697
{'0': {'precision': 0.398227969348659, 'recall': 0.3599177578184179, 'f1-score': 0.37810492809640195, 'support': 18482}, '1': {'precision': 0.34996184000555053, 'recall': 0.28133192035250154, 'f1-score': 0.3119163935439985, 'support': 17929}, '2': {'precision': 0.3635846248139392, 'recall': 0.47327330749943014, 'f1-score': 0.41124040604109924, 'support': 17548}, 'accuracy': 0.3706703237643396, 'macro avg': {'precision': 0.3705914780560496, 'recall': 0.3715076618901165, 'f1-score': 0.3670872425604999, 'support': 53959}, 'weighted avg': {'precision': 0.3709241860523071, 'recall': 0.3706703237643396, 'f1-score': 0.36688839574746124, 'support': 53959}}
[[6652 4929 6901]
 [5249 5044 7636]
 [4803 4440 8305]]
Evaluating performance on  val set...
81/81 - 1s - 723ms/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1001917
{'0': {'precision': 0.41457115672148975, 'recall': 0.4224376731301939, 'f1-score': 0.4184674487205872, 'support': 7220}, '1': {'precision': 0.31432490691749954, 'recall': 0.24856655818998916, 'f1-score': 0.2776047075112496, 'support': 6453}, '2': {'precision': 0.3875504463739758, 'recall': 0.45505456634118324, 'f1-score': 0.41859850736411075, 'support': 6964}, 'accuracy': 0.3790764161457576, 'macro avg': {'precision': 0.37214883667098836, 'recall': 0.37535293255378877, 'f1-score': 0.3715568878653159, 'support': 20637}, 'weighted avg': {'precision': 0.37410688008994275, 'recall': 0.3790764161457576, 'f1-score': 0.37446519177285464, 'support': 20637}}
[[3050 1804 2366]
 [2207 1604 2642]
 [2100 1695 3169]]
training model: results/LILAK/W6/deepLOB_L1/h100
Epoch 1/50
211/211 - 7s - loss: 3.3506 - accuracy100: 0.3469 - val_loss: 3.4033 - val_accuracy100: 0.3461 - 7s/epoch - 34ms/step
Epoch 2/50
211/211 - 5s - loss: 3.3087 - accuracy100: 0.3675 - val_loss: 3.4423 - val_accuracy100: 0.3558 - 5s/epoch - 23ms/step
Epoch 3/50
211/211 - 5s - loss: 3.2959 - accuracy100: 0.3724 - val_loss: 3.3604 - val_accuracy100: 0.3705 - 5s/epoch - 23ms/step
Epoch 4/50
211/211 - 5s - loss: 3.2768 - accuracy100: 0.3801 - val_loss: 3.3683 - val_accuracy100: 0.3680 - 5s/epoch - 23ms/step
Epoch 5/50
211/211 - 5s - loss: 3.2753 - accuracy100: 0.3798 - val_loss: 3.3189 - val_accuracy100: 0.3697 - 5s/epoch - 21ms/step
Epoch 6/50
211/211 - 5s - loss: 3.2666 - accuracy100: 0.3860 - val_loss: 3.3231 - val_accuracy100: 0.3705 - 5s/epoch - 22ms/step
Epoch 7/50
211/211 - 5s - loss: 3.2538 - accuracy100: 0.3932 - val_loss: 3.3097 - val_accuracy100: 0.3714 - 5s/epoch - 22ms/step
Epoch 8/50
211/211 - 5s - loss: 3.2443 - accuracy100: 0.3964 - val_loss: 3.3000 - val_accuracy100: 0.3703 - 5s/epoch - 23ms/step
Epoch 9/50
211/211 - 5s - loss: 3.2363 - accuracy100: 0.4039 - val_loss: 3.3044 - val_accuracy100: 0.3724 - 5s/epoch - 23ms/step
Epoch 10/50
211/211 - 5s - loss: 3.2295 - accuracy100: 0.4065 - val_loss: 3.3209 - val_accuracy100: 0.3654 - 5s/epoch - 23ms/step
Epoch 11/50
211/211 - 4s - loss: 3.2245 - accuracy100: 0.4102 - val_loss: 3.3242 - val_accuracy100: 0.3651 - 4s/epoch - 20ms/step
Epoch 12/50
211/211 - 5s - loss: 3.2142 - accuracy100: 0.4149 - val_loss: 3.3230 - val_accuracy100: 0.3714 - 5s/epoch - 22ms/step
Epoch 13/50
211/211 - 4s - loss: 3.2148 - accuracy100: 0.4168 - val_loss: 3.3283 - val_accuracy100: 0.3653 - 4s/epoch - 21ms/step
Epoch 14/50
211/211 - 5s - loss: 3.2134 - accuracy100: 0.4182 - val_loss: 3.3334 - val_accuracy100: 0.3617 - 5s/epoch - 22ms/step
Epoch 15/50
211/211 - 5s - loss: 3.2035 - accuracy100: 0.4223 - val_loss: 3.3272 - val_accuracy100: 0.3655 - 5s/epoch - 23ms/step
Epoch 16/50
211/211 - 5s - loss: 3.2011 - accuracy100: 0.4252 - val_loss: 3.3256 - val_accuracy100: 0.3677 - 5s/epoch - 23ms/step
Epoch 17/50
211/211 - 5s - loss: 3.1985 - accuracy100: 0.4247 - val_loss: 3.3227 - val_accuracy100: 0.3673 - 5s/epoch - 22ms/step
Epoch 18/50
211/211 - 4s - loss: 3.1888 - accuracy100: 0.4297 - val_loss: 3.3441 - val_accuracy100: 0.3632 - 4s/epoch - 21ms/step
testing model: results/LILAK/W6/deepLOB_L1/h100
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1217016
{'0': {'precision': 0.32272598870056496, 'recall': 0.2675526932084309, 'f1-score': 0.29256081946222795, 'support': 85400}, '1': {'precision': 0.3427577378287743, 'recall': 0.4829688814129521, 'f1-score': 0.4009591488931661, 'support': 90364}, '2': {'precision': 0.3603608544243056, 'recall': 0.27579404635740745, 'f1-score': 0.3124565355650525, 'support': 95303}, 'accuracy': 0.3422622451275884, 'macro avg': {'precision': 0.3419481936512149, 'recall': 0.3421052069929302, 'f1-score': 0.33532550130681554, 'support': 271067}, 'weighted avg': {'precision': 0.34263569584415365, 'recall': 0.3422622451275884, 'f1-score': 0.3356919570497793, 'support': 271067}}
[[22849 39598 22953]
 [23020 43643 23701]
 [24931 44088 26284]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1069726
{'0': {'precision': 0.36957403651115617, 'recall': 0.19552503085260503, 'f1-score': 0.2557462189002351, 'support': 18637}, '1': {'precision': 0.3852394807520143, 'recall': 0.3955759839126688, 'f1-score': 0.39033931456756527, 'support': 17405}, '2': {'precision': 0.35131734472108894, 'recall': 0.5142601998102361, 'f1-score': 0.4174519753533889, 'support': 17917}, 'accuracy': 0.36588891565818493, 'macro avg': {'precision': 0.3687102873280865, 'recall': 0.36845373819183663, 'f1-score': 0.35451250294039643, 'support': 53959}, 'weighted avg': {'precision': 0.3685649724108115, 'recall': 0.36588891565818493, 'f1-score': 0.3528546691765752, 'support': 53959}}
[[3644 5500 9493]
 [3000 6885 7520]
 [3216 5487 9214]]
Evaluating performance on  val set...
81/81 - 1s - 692ms/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0972657
{'0': {'precision': 0.35054967848993984, 'recall': 0.2569560589934621, 'f1-score': 0.2965432532023162, 'support': 6577}, '1': {'precision': 0.37579936051159074, 'recall': 0.5146414887794198, 'f1-score': 0.43439593439593444, 'support': 7308}, '2': {'precision': 0.3779269972451791, 'recall': 0.3250888625592417, 'f1-score': 0.3495222929936306, 'support': 6752}, 'accuracy': 0.3704995881184281, 'macro avg': {'precision': 0.3680920120822366, 'recall': 0.36556213677737454, 'f1-score': 0.3601538268639604, 'support': 20637}, 'weighted avg': {'precision': 0.36844842018929536, 'recall': 0.3704995881184281, 'f1-score': 0.3626934625754769, 'support': 20637}}
[[1690 3100 1787]
 [1721 3761 1826]
 [1410 3147 2195]]
training model: results/LILAK/W6/deepLOB_L1/h200
Epoch 1/50
211/211 - 7s - loss: 3.3562 - accuracy200: 0.3512 - val_loss: 3.4553 - val_accuracy200: 0.3403 - 7s/epoch - 32ms/step
Epoch 2/50
211/211 - 5s - loss: 3.3272 - accuracy200: 0.3538 - val_loss: 3.4692 - val_accuracy200: 0.3399 - 5s/epoch - 23ms/step
Epoch 3/50
211/211 - 5s - loss: 3.3123 - accuracy200: 0.3567 - val_loss: 3.3790 - val_accuracy200: 0.3422 - 5s/epoch - 21ms/step
Epoch 4/50
211/211 - 4s - loss: 3.3162 - accuracy200: 0.3535 - val_loss: 3.3657 - val_accuracy200: 0.3425 - 4s/epoch - 21ms/step
Epoch 5/50
211/211 - 4s - loss: 3.2949 - accuracy200: 0.3635 - val_loss: 3.3582 - val_accuracy200: 0.3420 - 4s/epoch - 20ms/step
Epoch 6/50
211/211 - 4s - loss: 3.2825 - accuracy200: 0.3727 - val_loss: 3.3461 - val_accuracy200: 0.3433 - 4s/epoch - 21ms/step
Epoch 7/50
211/211 - 5s - loss: 3.2700 - accuracy200: 0.3866 - val_loss: 3.3507 - val_accuracy200: 0.3408 - 5s/epoch - 23ms/step
Epoch 8/50
211/211 - 5s - loss: 3.2655 - accuracy200: 0.3888 - val_loss: 3.3351 - val_accuracy200: 0.3474 - 5s/epoch - 22ms/step
Epoch 9/50
211/211 - 5s - loss: 3.2644 - accuracy200: 0.3890 - val_loss: 3.3484 - val_accuracy200: 0.3480 - 5s/epoch - 22ms/step
Epoch 10/50
211/211 - 4s - loss: 3.2554 - accuracy200: 0.3951 - val_loss: 3.3366 - val_accuracy200: 0.3529 - 4s/epoch - 21ms/step
Epoch 11/50
211/211 - 5s - loss: 3.2443 - accuracy200: 0.4010 - val_loss: 3.3287 - val_accuracy200: 0.3464 - 5s/epoch - 23ms/step
Epoch 12/50
211/211 - 5s - loss: 3.2380 - accuracy200: 0.4055 - val_loss: 3.3334 - val_accuracy200: 0.3529 - 5s/epoch - 22ms/step
Epoch 13/50
211/211 - 5s - loss: 3.2290 - accuracy200: 0.4131 - val_loss: 3.3343 - val_accuracy200: 0.3461 - 5s/epoch - 22ms/step
Epoch 14/50
211/211 - 5s - loss: 3.2264 - accuracy200: 0.4136 - val_loss: 3.3455 - val_accuracy200: 0.3481 - 5s/epoch - 22ms/step
Epoch 15/50
211/211 - 4s - loss: 3.2208 - accuracy200: 0.4180 - val_loss: 3.3384 - val_accuracy200: 0.3546 - 4s/epoch - 21ms/step
Epoch 16/50
211/211 - 4s - loss: 3.2138 - accuracy200: 0.4193 - val_loss: 3.3362 - val_accuracy200: 0.3523 - 4s/epoch - 21ms/step
Epoch 17/50
211/211 - 5s - loss: 3.2109 - accuracy200: 0.4232 - val_loss: 3.3360 - val_accuracy200: 0.3549 - 5s/epoch - 22ms/step
Epoch 18/50
211/211 - 5s - loss: 3.2102 - accuracy200: 0.4224 - val_loss: 3.3338 - val_accuracy200: 0.3563 - 5s/epoch - 22ms/step
Epoch 19/50
211/211 - 5s - loss: 3.2078 - accuracy200: 0.4226 - val_loss: 3.3311 - val_accuracy200: 0.3597 - 5s/epoch - 22ms/step
Epoch 20/50
211/211 - 5s - loss: 3.2062 - accuracy200: 0.4232 - val_loss: 3.3523 - val_accuracy200: 0.3608 - 5s/epoch - 22ms/step
Epoch 21/50
211/211 - 5s - loss: 3.1995 - accuracy200: 0.4270 - val_loss: 3.3523 - val_accuracy200: 0.3583 - 5s/epoch - 22ms/step
testing model: results/LILAK/W6/deepLOB_L1/h200
Evaluating performance on  test set...
1059/1059 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1147305
{'0': {'precision': 0.29828350192462627, 'recall': 0.3248635078482987, 'f1-score': 0.3110066268433825, 'support': 82056}, '1': {'precision': 0.349662311097004, 'recall': 0.20799504898567142, 'f1-score': 0.2608341061410259, 'support': 95334}, '2': {'precision': 0.3507800624049924, 'recall': 0.4680337756332931, 'f1-score': 0.4010115838238052, 'support': 93677}, 'accuracy': 0.3332386457960578, 'macro avg': {'precision': 0.33290862514220754, 'recall': 0.3336307774890877, 'f1-score': 0.32428410560273785, 'support': 271067}, 'weighted avg': {'precision': 0.3344954631362777, 'recall': 0.3332386457960578, 'f1-score': 0.3244654664159479, 'support': 271067}}
[[26657 16918 38481]
 [32840 19829 42665]
 [29871 19962 43844]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1237448
{'0': {'precision': 0.3499853929301782, 'recall': 0.3242394716899426, 'f1-score': 0.33662086599792074, 'support': 18474}, '1': {'precision': 0.3310918205159555, 'recall': 0.15554279149913844, 'f1-score': 0.2116534448395795, 'support': 17410}, '2': {'precision': 0.3367870225013082, 'recall': 0.5341078838174274, 'f1-score': 0.41309370988446725, 'support': 18075}, 'accuracy': 0.3401100835819789, 'macro avg': {'precision': 0.3392880786491473, 'recall': 0.33796338233550277, 'f1-score': 0.3204560069073225, 'support': 53959}, 'weighted avg': {'precision': 0.33946819206964635, 'recall': 0.3401100835819789, 'f1-score': 0.32191643950526166, 'support': 53959}}
[[5990 2721 9763]
 [5454 2708 9248]
 [5671 2750 9654]]
Evaluating performance on  val set...
81/81 - 1s - 907ms/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1075028
{'0': {'precision': 0.34729916897506924, 'recall': 0.428022759601707, 'f1-score': 0.38345864661654133, 'support': 7030}, '1': {'precision': 0.3288608260983952, 'recall': 0.19160024524831393, 'f1-score': 0.2421307506053269, 'support': 6524}, '2': {'precision': 0.36282427802251593, 'recall': 0.4186079344910349, 'f1-score': 0.3887250081940347, 'support': 7083}, 'accuracy': 0.3500508794882977, 'macro avg': {'precision': 0.34632809103199347, 'recall': 0.34607697978035196, 'f1-score': 0.338104801805301, 'support': 20637}, 'weighted avg': {'precision': 0.3467987376360008, 'recall': 0.3500508794882977, 'f1-score': 0.3405879990164165, 'support': 20637}}
[[3009 1325 2696]
 [2763 1250 2511]
 [2892 1226 2965]]
training model: results/LILAK/W6/deepLOB_L1/h300
Epoch 1/50
211/211 - 7s - loss: 3.3551 - accuracy300: 0.3523 - val_loss: 3.4310 - val_accuracy300: 0.3510 - 7s/epoch - 33ms/step
Epoch 2/50
211/211 - 5s - loss: 3.3198 - accuracy300: 0.3600 - val_loss: 3.3849 - val_accuracy300: 0.3548 - 5s/epoch - 22ms/step
Epoch 3/50
211/211 - 5s - loss: 3.2986 - accuracy300: 0.3743 - val_loss: 3.3653 - val_accuracy300: 0.3428 - 5s/epoch - 22ms/step
Epoch 4/50
211/211 - 5s - loss: 3.2838 - accuracy300: 0.3826 - val_loss: 3.4435 - val_accuracy300: 0.3450 - 5s/epoch - 22ms/step
Epoch 5/50
211/211 - 5s - loss: 3.2647 - accuracy300: 0.3966 - val_loss: 3.4321 - val_accuracy300: 0.3541 - 5s/epoch - 22ms/step
Epoch 6/50
211/211 - 4s - loss: 3.2572 - accuracy300: 0.3929 - val_loss: 3.3792 - val_accuracy300: 0.3556 - 4s/epoch - 21ms/step
Epoch 7/50
211/211 - 5s - loss: 3.2471 - accuracy300: 0.4056 - val_loss: 3.3877 - val_accuracy300: 0.3620 - 5s/epoch - 23ms/step
Epoch 8/50
211/211 - 5s - loss: 3.2334 - accuracy300: 0.4134 - val_loss: 3.3713 - val_accuracy300: 0.3586 - 5s/epoch - 23ms/step
Epoch 9/50
211/211 - 5s - loss: 3.2212 - accuracy300: 0.4171 - val_loss: 3.3645 - val_accuracy300: 0.3524 - 5s/epoch - 22ms/step
Epoch 10/50
211/211 - 5s - loss: 3.2144 - accuracy300: 0.4240 - val_loss: 3.3582 - val_accuracy300: 0.3488 - 5s/epoch - 23ms/step
Epoch 11/50
211/211 - 5s - loss: 3.2051 - accuracy300: 0.4263 - val_loss: 3.3689 - val_accuracy300: 0.3579 - 5s/epoch - 21ms/step
Epoch 12/50
211/211 - 5s - loss: 3.1947 - accuracy300: 0.4316 - val_loss: 3.3882 - val_accuracy300: 0.3609 - 5s/epoch - 22ms/step
Epoch 13/50
211/211 - 5s - loss: 3.1881 - accuracy300: 0.4349 - val_loss: 3.3822 - val_accuracy300: 0.3570 - 5s/epoch - 22ms/step
Epoch 14/50
211/211 - 5s - loss: 3.1788 - accuracy300: 0.4382 - val_loss: 3.3893 - val_accuracy300: 0.3592 - 5s/epoch - 22ms/step
Epoch 15/50
211/211 - 5s - loss: 3.1725 - accuracy300: 0.4413 - val_loss: 3.3931 - val_accuracy300: 0.3532 - 5s/epoch - 22ms/step
Epoch 16/50
211/211 - 5s - loss: 3.1688 - accuracy300: 0.4421 - val_loss: 3.3943 - val_accuracy300: 0.3532 - 5s/epoch - 23ms/step
Epoch 17/50
211/211 - 5s - loss: 3.1613 - accuracy300: 0.4449 - val_loss: 3.3890 - val_accuracy300: 0.3611 - 5s/epoch - 22ms/step
Epoch 18/50
211/211 - 5s - loss: 3.1484 - accuracy300: 0.4502 - val_loss: 3.4056 - val_accuracy300: 0.3598 - 5s/epoch - 22ms/step
Epoch 19/50
211/211 - 5s - loss: 3.1414 - accuracy300: 0.4545 - val_loss: 3.4571 - val_accuracy300: 0.3612 - 5s/epoch - 23ms/step
Epoch 20/50
211/211 - 5s - loss: 3.1384 - accuracy300: 0.4544 - val_loss: 3.4437 - val_accuracy300: 0.3663 - 5s/epoch - 22ms/step
testing model: results/LILAK/W6/deepLOB_L1/h300
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1313941
{'0': {'precision': 0.3179273353691958, 'recall': 0.19424013012330618, 'f1-score': 0.24114865216003323, 'support': 83613}, '1': {'precision': 0.3431506800718031, 'recall': 0.5275708223795447, 'f1-score': 0.41583051750969424, 'support': 91673}, '2': {'precision': 0.3630854482427064, 'recall': 0.2996314509140644, 'f1-score': 0.3283206443088152, 'support': 95781}, 'accuracy': 0.34421010303725647, 'macro avg': {'precision': 0.3413878212279018, 'recall': 0.3404808011389718, 'f1-score': 0.3284332713261809, 'support': 271067}, 'weighted avg': {'precision': 0.3424142293402799, 'recall': 0.34421010303725647, 'f1-score': 0.33102691554953456, 'support': 271067}}
[[16241 43389 23983]
 [16949 48364 26360]
 [17894 49188 28699]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1359444
{'0': {'precision': 0.33511513157894735, 'recall': 0.22664071190211346, 'f1-score': 0.2704047777040478, 'support': 17980}, '1': {'precision': 0.3726213208665306, 'recall': 0.31052458296751534, 'f1-score': 0.3387507108437341, 'support': 18224}, '2': {'precision': 0.3487900195400571, 'recall': 0.5227823148408899, 'f1-score': 0.4184190952735141, 'support': 17755}, 'accuracy': 0.3524157230489816, 'macro avg': {'precision': 0.352175490661845, 'recall': 0.3533158699035062, 'f1-score': 0.3425248612737653, 'support': 53959}, 'weighted avg': {'precision': 0.35228206256963324, 'recall': 0.3524157230489816, 'f1-score': 0.34219132849230405, 'support': 53959}}
[[4075 4792 9113]
 [4348 5659 8217]
 [3737 4736 9282]]
Evaluating performance on  val set...
81/81 - 1s - 844ms/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1181724
{'0': {'precision': 0.33849969001859886, 'recall': 0.24717066545948393, 'f1-score': 0.2857142857142857, 'support': 6627}, '1': {'precision': 0.3388557806912992, 'recall': 0.39425877132159204, 'f1-score': 0.3644638164220243, 'support': 7211}, '2': {'precision': 0.3597462203023758, 'recall': 0.3919694072657744, 'f1-score': 0.37516717111283165, 'support': 6799}, 'accuracy': 0.34627126035761013, 'macro avg': {'precision': 0.34570056367075797, 'recall': 0.34446628134895013, 'f1-score': 0.3417817577497139, 'support': 20637}, 'weighted avg': {'precision': 0.3456239294545751, 'recall': 0.34627126035761013, 'f1-score': 0.34270188244628247, 'support': 20637}}
[[1638 2728 2261]
 [1886 2843 2482]
 [1315 2819 2665]]
training model: results/LILAK/W6/deepLOB_L1/h500
Epoch 1/50
211/211 - 7s - loss: 3.3403 - accuracy500: 0.3566 - val_loss: 3.5007 - val_accuracy500: 0.3504 - 7s/epoch - 32ms/step
Epoch 2/50
211/211 - 5s - loss: 3.3055 - accuracy500: 0.3742 - val_loss: 3.4061 - val_accuracy500: 0.3550 - 5s/epoch - 22ms/step
Epoch 3/50
211/211 - 5s - loss: 3.3107 - accuracy500: 0.3669 - val_loss: 3.3963 - val_accuracy500: 0.3508 - 5s/epoch - 22ms/step
Epoch 4/50
211/211 - 5s - loss: 3.3090 - accuracy500: 0.3639 - val_loss: 3.3304 - val_accuracy500: 0.3533 - 5s/epoch - 22ms/step
Epoch 5/50
211/211 - 5s - loss: 3.2962 - accuracy500: 0.3678 - val_loss: 3.3572 - val_accuracy500: 0.3510 - 5s/epoch - 22ms/step
Epoch 6/50
211/211 - 5s - loss: 3.2827 - accuracy500: 0.3756 - val_loss: 3.3456 - val_accuracy500: 0.3438 - 5s/epoch - 23ms/step
Epoch 7/50
211/211 - 5s - loss: 3.2645 - accuracy500: 0.3894 - val_loss: 3.3593 - val_accuracy500: 0.3443 - 5s/epoch - 22ms/step
Epoch 8/50
211/211 - 5s - loss: 3.2477 - accuracy500: 0.3982 - val_loss: 3.3529 - val_accuracy500: 0.3515 - 5s/epoch - 23ms/step
Epoch 9/50
211/211 - 5s - loss: 3.2342 - accuracy500: 0.4108 - val_loss: 3.3656 - val_accuracy500: 0.3649 - 5s/epoch - 23ms/step
Epoch 10/50
211/211 - 5s - loss: 3.2263 - accuracy500: 0.4109 - val_loss: 3.3485 - val_accuracy500: 0.3673 - 5s/epoch - 22ms/step
Epoch 11/50
211/211 - 4s - loss: 3.2150 - accuracy500: 0.4203 - val_loss: 3.4013 - val_accuracy500: 0.3565 - 4s/epoch - 20ms/step
Epoch 12/50
211/211 - 5s - loss: 3.1993 - accuracy500: 0.4248 - val_loss: 3.4161 - val_accuracy500: 0.3658 - 5s/epoch - 22ms/step
Epoch 13/50
211/211 - 4s - loss: 3.1926 - accuracy500: 0.4316 - val_loss: 3.3984 - val_accuracy500: 0.3660 - 4s/epoch - 21ms/step
Epoch 14/50
211/211 - 5s - loss: 3.1835 - accuracy500: 0.4358 - val_loss: 3.4090 - val_accuracy500: 0.3649 - 5s/epoch - 23ms/step
testing model: results/LILAK/W6/deepLOB_L1/h500
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1146797
{'0': {'precision': 0.323284001226578, 'recall': 0.23025725912131872, 'f1-score': 0.2689537108522708, 'support': 86994}, '1': {'precision': 0.30306173947176585, 'recall': 0.2666321320210168, 'f1-score': 0.28368217308575555, 'support': 81078}, '2': {'precision': 0.39649716201895857, 'recall': 0.5303849701441817, 'f1-score': 0.4537710419530753, 'support': 102995}, 'accuracy': 0.3551741820287973, 'macro avg': {'precision': 0.34094763423910085, 'recall': 0.3424247870955058, 'f1-score': 0.3354689752970339, 'support': 271067}, 'weighted avg': {'precision': 0.34505355988644654, 'recall': 0.3551741820287973, 'f1-score': 0.3435825490276807, 'support': 271067}}
[[20031 23831 43132]
 [19445 21618 40015]
 [22485 25883 54627]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1162163
{'0': {'precision': 0.3538160469667319, 'recall': 0.14900280204384375, 'f1-score': 0.20969612618881933, 'support': 18201}, '1': {'precision': 0.36127246077845937, 'recall': 0.37003058103975534, 'f1-score': 0.3655990770752074, 'support': 17985}, '2': {'precision': 0.33875076238653895, 'recall': 0.5312552748551174, 'f1-score': 0.41370547254962103, 'support': 17773}, 'accuracy': 0.34857947701032266, 'macro avg': {'precision': 0.35127975671057676, 'recall': 0.3500962193129055, 'f1-score': 0.3296668919378826, 'support': 53959}, 'weighted avg': {'precision': 0.35133913485865254, 'recall': 0.34857947701032266, 'f1-score': 0.32885646430780263, 'support': 53959}}
[[2712 5853 9636]
 [2535 6655 8795]
 [2418 5913 9442]]
Evaluating performance on  val set...
81/81 - 1s - 642ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1113797
{'0': {'precision': 0.3499658236500342, 'recall': 0.2231260894828588, 'f1-score': 0.2725095360596115, 'support': 6884}, '1': {'precision': 0.3318194329755023, 'recall': 0.36146926536731633, 'f1-score': 0.34601033295063144, 'support': 6670}, '2': {'precision': 0.35370741482965934, 'recall': 0.4485387547649301, 'f1-score': 0.3955182072829131, 'support': 7083}, 'accuracy': 0.3452052139361341, 'macro avg': {'precision': 0.34516422381839856, 'recall': 0.3443780365383684, 'f1-score': 0.33801269209771867, 'support': 20637}, 'weighted avg': {'precision': 0.34538498653834926, 'recall': 0.3452052139361341, 'f1-score': 0.3384842772302152, 'support': 20637}}
[[1536 2419 2929]
 [1383 2411 2876]
 [1470 2436 3177]]
training model: results/LILAK/W6/deepLOB_L1/h1000
Epoch 1/50
211/211 - 7s - loss: 3.3227 - accuracy1000: 0.3719 - val_loss: 3.4391 - val_accuracy1000: 0.3473 - 7s/epoch - 33ms/step
Epoch 2/50
211/211 - 5s - loss: 3.2961 - accuracy1000: 0.3788 - val_loss: 3.4487 - val_accuracy1000: 0.3673 - 5s/epoch - 22ms/step
Epoch 3/50
211/211 - 5s - loss: 3.2874 - accuracy1000: 0.3884 - val_loss: 3.4422 - val_accuracy1000: 0.3603 - 5s/epoch - 22ms/step
Epoch 4/50
211/211 - 5s - loss: 3.2550 - accuracy1000: 0.4003 - val_loss: 3.4227 - val_accuracy1000: 0.3674 - 5s/epoch - 22ms/step
Epoch 5/50
211/211 - 5s - loss: 3.2402 - accuracy1000: 0.4060 - val_loss: 3.4284 - val_accuracy1000: 0.3578 - 5s/epoch - 22ms/step
Epoch 6/50
211/211 - 5s - loss: 3.2193 - accuracy1000: 0.4207 - val_loss: 3.4359 - val_accuracy1000: 0.3601 - 5s/epoch - 21ms/step
Epoch 7/50
211/211 - 5s - loss: 3.2154 - accuracy1000: 0.4195 - val_loss: 3.4531 - val_accuracy1000: 0.3552 - 5s/epoch - 22ms/step
Epoch 8/50
211/211 - 5s - loss: 3.2055 - accuracy1000: 0.4280 - val_loss: 3.4151 - val_accuracy1000: 0.3559 - 5s/epoch - 23ms/step
Epoch 9/50
211/211 - 5s - loss: 3.1810 - accuracy1000: 0.4332 - val_loss: 3.4847 - val_accuracy1000: 0.3602 - 5s/epoch - 23ms/step
Epoch 10/50
211/211 - 5s - loss: 3.1676 - accuracy1000: 0.4406 - val_loss: 3.4554 - val_accuracy1000: 0.3653 - 5s/epoch - 23ms/step
Epoch 11/50
211/211 - 5s - loss: 3.1523 - accuracy1000: 0.4452 - val_loss: 3.4238 - val_accuracy1000: 0.3624 - 5s/epoch - 22ms/step
Epoch 12/50
211/211 - 5s - loss: 3.1359 - accuracy1000: 0.4521 - val_loss: 3.4107 - val_accuracy1000: 0.3621 - 5s/epoch - 22ms/step
Epoch 13/50
211/211 - 5s - loss: 3.1406 - accuracy1000: 0.4499 - val_loss: 3.5465 - val_accuracy1000: 0.3582 - 5s/epoch - 22ms/step
Epoch 14/50
211/211 - 5s - loss: 3.1348 - accuracy1000: 0.4520 - val_loss: 3.5220 - val_accuracy1000: 0.3581 - 5s/epoch - 22ms/step
Epoch 15/50
211/211 - 5s - loss: 3.1061 - accuracy1000: 0.4597 - val_loss: 3.4631 - val_accuracy1000: 0.3620 - 5s/epoch - 23ms/step
Epoch 16/50
211/211 - 5s - loss: 3.1067 - accuracy1000: 0.4621 - val_loss: 3.4953 - val_accuracy1000: 0.3625 - 5s/epoch - 22ms/step
Epoch 17/50
211/211 - 4s - loss: 3.0977 - accuracy1000: 0.4630 - val_loss: 3.4350 - val_accuracy1000: 0.3677 - 4s/epoch - 20ms/step
Epoch 18/50
211/211 - 4s - loss: 3.0880 - accuracy1000: 0.4714 - val_loss: 3.4187 - val_accuracy1000: 0.3739 - 4s/epoch - 21ms/step
Epoch 19/50
211/211 - 5s - loss: 3.0891 - accuracy1000: 0.4671 - val_loss: 3.4310 - val_accuracy1000: 0.3649 - 5s/epoch - 22ms/step
Epoch 20/50
211/211 - 5s - loss: 3.0952 - accuracy1000: 0.4616 - val_loss: 3.3979 - val_accuracy1000: 0.3691 - 5s/epoch - 22ms/step
Epoch 21/50
211/211 - 5s - loss: 3.0812 - accuracy1000: 0.4716 - val_loss: 3.3362 - val_accuracy1000: 0.3740 - 5s/epoch - 22ms/step
Epoch 22/50
211/211 - 4s - loss: 3.0596 - accuracy1000: 0.4752 - val_loss: 3.4118 - val_accuracy1000: 0.3795 - 4s/epoch - 21ms/step
Epoch 23/50
211/211 - 5s - loss: 3.0398 - accuracy1000: 0.4870 - val_loss: 3.4299 - val_accuracy1000: 0.3668 - 5s/epoch - 22ms/step
Epoch 24/50
211/211 - 4s - loss: 3.0264 - accuracy1000: 0.4872 - val_loss: 3.4208 - val_accuracy1000: 0.3729 - 4s/epoch - 21ms/step
Epoch 25/50
211/211 - 5s - loss: 3.0149 - accuracy1000: 0.4955 - val_loss: 3.4121 - val_accuracy1000: 0.3780 - 5s/epoch - 22ms/step
Epoch 26/50
211/211 - 5s - loss: 2.9995 - accuracy1000: 0.5010 - val_loss: 3.4176 - val_accuracy1000: 0.3764 - 5s/epoch - 22ms/step
Epoch 27/50
211/211 - 5s - loss: 2.9912 - accuracy1000: 0.5001 - val_loss: 3.4006 - val_accuracy1000: 0.3742 - 5s/epoch - 22ms/step
Epoch 28/50
211/211 - 5s - loss: 2.9869 - accuracy1000: 0.5038 - val_loss: 3.4156 - val_accuracy1000: 0.3637 - 5s/epoch - 21ms/step
Epoch 29/50
211/211 - 4s - loss: 2.9859 - accuracy1000: 0.5053 - val_loss: 3.4419 - val_accuracy1000: 0.3686 - 4s/epoch - 20ms/step
Epoch 30/50
211/211 - 4s - loss: 2.9705 - accuracy1000: 0.5066 - val_loss: 3.4159 - val_accuracy1000: 0.3693 - 4s/epoch - 20ms/step
Epoch 31/50
211/211 - 5s - loss: 2.9641 - accuracy1000: 0.5109 - val_loss: 3.4227 - val_accuracy1000: 0.3677 - 5s/epoch - 22ms/step
testing model: results/LILAK/W6/deepLOB_L1/h1000
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1204559
{'0': {'precision': 0.2942082761958538, 'recall': 0.4498174732376301, 'f1-score': 0.35574043910384584, 'support': 81084}, '1': {'precision': 0.33697827750632836, 'recall': 0.26060185290569304, 'f1-score': 0.2939092484436172, 'support': 87862}, '2': {'precision': 0.4074088112294533, 'recall': 0.31576267369101363, 'f1-score': 0.35577867269818503, 'support': 102121}, 'accuracy': 0.33798286032604485, 'macro avg': {'precision': 0.34619845497721186, 'recall': 0.34206066661144563, 'f1-score': 0.3351427867485494, 'support': 271067}, 'weighted avg': {'precision': 0.3507183260850219, 'recall': 0.33798286032604485, 'f1-score': 0.3357132590306481, 'support': 271067}}
[[36473 20855 23756]
 [41818 22897 23147]
 [45679 24196 32246]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2201165
{'0': {'precision': 0.36522766323024053, 'recall': 0.3663488985835084, 'f1-score': 0.36578742168804285, 'support': 18567}, '1': {'precision': 0.3545017182130584, 'recall': 0.2823980290172461, 'f1-score': 0.3143684290720707, 'support': 18265}, '2': {'precision': 0.2903055087803705, 'recall': 0.3523092193612425, 'f1-score': 0.31831610044313147, 'support': 17127}, 'accuracy': 0.33347541651995033, 'macro avg': {'precision': 0.3366782967412232, 'recall': 0.33368538232066564, 'f1-score': 0.33282398373441496, 'support': 53959}, 'weighted avg': {'precision': 0.33781608916471384, 'recall': 0.33347541651995033, 'f1-score': 0.33331444740956606, 'support': 53959}}
[[6802 4123 7642]
 [5998 5158 7109]
 [5824 5269 6034]]
Evaluating performance on  val set...
81/81 - 1s - 803ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1098145
{'0': {'precision': 0.36099485830443623, 'recall': 0.4452802359882006, 'f1-score': 0.39873208743313737, 'support': 6780}, '1': {'precision': 0.36470911086717894, 'recall': 0.3712290502793296, 'f1-score': 0.36794019933554817, 'support': 7160}, '2': {'precision': 0.4027276373846771, 'recall': 0.2998357473495595, 'f1-score': 0.3437473251733288, 'support': 6697}, 'accuracy': 0.3723893976837719, 'macro avg': {'precision': 0.37614386885209744, 'recall': 0.37211501120569657, 'f1-score': 0.37013987064733805, 'support': 20637}, 'weighted avg': {'precision': 0.37582639728052825, 'recall': 0.3723893976837719, 'f1-score': 0.3702055151778349, 'support': 20637}}
[[3019 2407 1354]
 [2878 2658 1624]
 [2466 2223 2008]]
training model: results/LILAK/W6/deepOF_L1/h10
Epoch 1/50
211/211 - 7s - loss: 3.3088 - accuracy10: 0.3631 - val_loss: 3.3306 - val_accuracy10: 0.3920 - 7s/epoch - 34ms/step
Epoch 2/50
211/211 - 5s - loss: 3.2901 - accuracy10: 0.3799 - val_loss: 3.3141 - val_accuracy10: 0.3965 - 5s/epoch - 21ms/step
Epoch 3/50
211/211 - 4s - loss: 3.2768 - accuracy10: 0.3866 - val_loss: 3.3114 - val_accuracy10: 0.3985 - 4s/epoch - 21ms/step
Epoch 4/50
211/211 - 4s - loss: 3.2696 - accuracy10: 0.3960 - val_loss: 3.3097 - val_accuracy10: 0.4030 - 4s/epoch - 21ms/step
Epoch 5/50
211/211 - 4s - loss: 3.2633 - accuracy10: 0.4026 - val_loss: 3.3126 - val_accuracy10: 0.4010 - 4s/epoch - 19ms/step
Epoch 6/50
211/211 - 4s - loss: 3.2576 - accuracy10: 0.4057 - val_loss: 3.3076 - val_accuracy10: 0.4049 - 4s/epoch - 19ms/step
Epoch 7/50
211/211 - 4s - loss: 3.2504 - accuracy10: 0.4080 - val_loss: 3.3071 - val_accuracy10: 0.4102 - 4s/epoch - 21ms/step
Epoch 8/50
211/211 - 4s - loss: 3.2457 - accuracy10: 0.4150 - val_loss: 3.3053 - val_accuracy10: 0.4112 - 4s/epoch - 21ms/step
Epoch 9/50
211/211 - 4s - loss: 3.2423 - accuracy10: 0.4157 - val_loss: 3.2994 - val_accuracy10: 0.4079 - 4s/epoch - 21ms/step
Epoch 10/50
211/211 - 4s - loss: 3.2386 - accuracy10: 0.4177 - val_loss: 3.3012 - val_accuracy10: 0.4050 - 4s/epoch - 20ms/step
Epoch 11/50
211/211 - 5s - loss: 3.2355 - accuracy10: 0.4201 - val_loss: 3.3042 - val_accuracy10: 0.4094 - 5s/epoch - 21ms/step
Epoch 12/50
211/211 - 4s - loss: 3.2339 - accuracy10: 0.4216 - val_loss: 3.3016 - val_accuracy10: 0.4099 - 4s/epoch - 21ms/step
Epoch 13/50
211/211 - 4s - loss: 3.2279 - accuracy10: 0.4273 - val_loss: 3.3006 - val_accuracy10: 0.4068 - 4s/epoch - 19ms/step
Epoch 14/50
211/211 - 4s - loss: 3.2239 - accuracy10: 0.4272 - val_loss: 3.3014 - val_accuracy10: 0.4095 - 4s/epoch - 20ms/step
Epoch 15/50
211/211 - 4s - loss: 3.2198 - accuracy10: 0.4291 - val_loss: 3.2982 - val_accuracy10: 0.4055 - 4s/epoch - 20ms/step
Epoch 16/50
211/211 - 4s - loss: 3.2181 - accuracy10: 0.4301 - val_loss: 3.2958 - val_accuracy10: 0.3995 - 4s/epoch - 20ms/step
Epoch 17/50
211/211 - 4s - loss: 3.2149 - accuracy10: 0.4300 - val_loss: 3.3026 - val_accuracy10: 0.4070 - 4s/epoch - 19ms/step
Epoch 18/50
211/211 - 4s - loss: 3.2120 - accuracy10: 0.4318 - val_loss: 3.3019 - val_accuracy10: 0.4073 - 4s/epoch - 19ms/step
Epoch 19/50
211/211 - 4s - loss: 3.2104 - accuracy10: 0.4317 - val_loss: 3.2951 - val_accuracy10: 0.4007 - 4s/epoch - 21ms/step
Epoch 20/50
211/211 - 4s - loss: 3.2084 - accuracy10: 0.4341 - val_loss: 3.3008 - val_accuracy10: 0.4078 - 4s/epoch - 21ms/step
Epoch 21/50
211/211 - 4s - loss: 3.2060 - accuracy10: 0.4343 - val_loss: 3.3014 - val_accuracy10: 0.4045 - 4s/epoch - 20ms/step
Epoch 22/50
211/211 - 4s - loss: 3.2016 - accuracy10: 0.4359 - val_loss: 3.3028 - val_accuracy10: 0.4047 - 4s/epoch - 20ms/step
Epoch 23/50
211/211 - 4s - loss: 3.1977 - accuracy10: 0.4370 - val_loss: 3.3046 - val_accuracy10: 0.4069 - 4s/epoch - 19ms/step
Epoch 24/50
211/211 - 4s - loss: 3.1939 - accuracy10: 0.4386 - val_loss: 3.3056 - val_accuracy10: 0.4073 - 4s/epoch - 21ms/step
Epoch 25/50
211/211 - 4s - loss: 3.1902 - accuracy10: 0.4381 - val_loss: 3.3096 - val_accuracy10: 0.4065 - 4s/epoch - 20ms/step
Epoch 26/50
211/211 - 4s - loss: 3.1850 - accuracy10: 0.4425 - val_loss: 3.3034 - val_accuracy10: 0.4131 - 4s/epoch - 20ms/step
Epoch 27/50
211/211 - 4s - loss: 3.1840 - accuracy10: 0.4408 - val_loss: 3.3034 - val_accuracy10: 0.4093 - 4s/epoch - 21ms/step
Epoch 28/50
211/211 - 4s - loss: 3.1811 - accuracy10: 0.4417 - val_loss: 3.3138 - val_accuracy10: 0.4117 - 4s/epoch - 20ms/step
Epoch 29/50
211/211 - 4s - loss: 3.1797 - accuracy10: 0.4429 - val_loss: 3.3107 - val_accuracy10: 0.4111 - 4s/epoch - 19ms/step
testing model: results/LILAK/W6/deepOF_L1/h10
Evaluating performance on  test set...
1059/1059 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1011301
{'0': {'precision': 0.3478058673831884, 'recall': 0.32533017557002863, 'f1-score': 0.3361927951551476, 'support': 82759}, '1': {'precision': 0.4325708804303755, 'recall': 0.4348630055274983, 'f1-score': 0.4337139145997451, 'support': 100588}, '2': {'precision': 0.36737274397492703, 'recall': 0.3875391894202816, 'f1-score': 0.37718660711808927, 'support': 87715}, 'accuracy': 0.3861072374585888, 'macro avg': {'precision': 0.382583163929497, 'recall': 0.38257745683926947, 'f1-score': 0.38236443895766065, 'support': 271062}, 'weighted avg': {'precision': 0.3855929851371886, 'recall': 0.3861072374585888, 'f1-score': 0.38564726158357576, 'support': 271062}}
[[26924 28358 27477]
 [25786 43742 31060]
 [24701 29021 33993]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0795832
{'0': {'precision': 0.36671394799054374, 'recall': 0.25452874770280914, 'f1-score': 0.30049203827825344, 'support': 15236}, '1': {'precision': 0.531312170227489, 'recall': 0.5056179775280899, 'f1-score': 0.5181467344313462, 'support': 24297}, '2': {'precision': 0.3266212614746817, 'recall': 0.4587550256481353, 'f1-score': 0.38157287822878233, 'support': 14426}, 'accuracy': 0.42219092273763414, 'macro avg': {'precision': 0.4082157932309048, 'recall': 0.40630058362634475, 'f1-score': 0.400070550312794, 'support': 53959}, 'weighted avg': {'precision': 0.4301114518363013, 'recall': 0.42219092273763414, 'f1-score': 0.4201760270393132, 'support': 53959}}
[[ 3878  5652  5706]
 [ 4074 12285  7938]
 [ 2623  5185  6618]]
Evaluating performance on  val set...
81/81 - 1s - 769ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0949256
{'0': {'precision': 0.3357695614789338, 'recall': 0.26824660827752017, 'f1-score': 0.2982338902147972, 'support': 5823}, '1': {'precision': 0.5003007337904487, 'recall': 0.462573684795907, 'f1-score': 0.4806981044845122, 'support': 8991}, '2': {'precision': 0.3253813062182245, 'recall': 0.42871865338371695, 'f1-score': 0.3699696138738605, 'support': 5822}, 'accuracy': 0.39818763326226014, 'macro avg': {'precision': 0.3871505338292023, 'recall': 0.3865129821523814, 'f1-score': 0.38296720285772334, 'support': 20636}, 'weighted avg': {'precision': 0.40452413349506966, 'recall': 0.39818763326226014, 'f1-score': 0.39797129735000136, 'support': 20636}}
[[1562 2123 2138]
 [1795 4159 3037]
 [1295 2031 2496]]
training model: results/LILAK/W6/deepOF_L1/h20
Epoch 1/50
211/211 - 6s - loss: 3.3221 - accuracy20: 0.3488 - val_loss: 3.3282 - val_accuracy20: 0.3443 - 6s/epoch - 30ms/step
Epoch 2/50
211/211 - 4s - loss: 3.3033 - accuracy20: 0.3567 - val_loss: 3.3158 - val_accuracy20: 0.3532 - 4s/epoch - 20ms/step
Epoch 3/50
211/211 - 5s - loss: 3.2926 - accuracy20: 0.3652 - val_loss: 3.3104 - val_accuracy20: 0.3551 - 5s/epoch - 22ms/step
Epoch 4/50
211/211 - 4s - loss: 3.2850 - accuracy20: 0.3737 - val_loss: 3.2987 - val_accuracy20: 0.3646 - 4s/epoch - 21ms/step
Epoch 5/50
211/211 - 4s - loss: 3.2801 - accuracy20: 0.3770 - val_loss: 3.3026 - val_accuracy20: 0.3600 - 4s/epoch - 19ms/step
Epoch 6/50
211/211 - 4s - loss: 3.2764 - accuracy20: 0.3779 - val_loss: 3.2990 - val_accuracy20: 0.3660 - 4s/epoch - 20ms/step
Epoch 7/50
211/211 - 4s - loss: 3.2730 - accuracy20: 0.3814 - val_loss: 3.3006 - val_accuracy20: 0.3639 - 4s/epoch - 21ms/step
Epoch 8/50
211/211 - 4s - loss: 3.2716 - accuracy20: 0.3810 - val_loss: 3.2986 - val_accuracy20: 0.3624 - 4s/epoch - 20ms/step
Epoch 9/50
211/211 - 4s - loss: 3.2692 - accuracy20: 0.3830 - val_loss: 3.2978 - val_accuracy20: 0.3650 - 4s/epoch - 20ms/step
Epoch 10/50
211/211 - 4s - loss: 3.2648 - accuracy20: 0.3855 - val_loss: 3.2929 - val_accuracy20: 0.3701 - 4s/epoch - 21ms/step
Epoch 11/50
211/211 - 4s - loss: 3.2614 - accuracy20: 0.3882 - val_loss: 3.2967 - val_accuracy20: 0.3673 - 4s/epoch - 19ms/step
Epoch 12/50
211/211 - 4s - loss: 3.2588 - accuracy20: 0.3907 - val_loss: 3.2939 - val_accuracy20: 0.3688 - 4s/epoch - 21ms/step
Epoch 13/50
211/211 - 4s - loss: 3.2536 - accuracy20: 0.3925 - val_loss: 3.2901 - val_accuracy20: 0.3663 - 4s/epoch - 19ms/step
Epoch 14/50
211/211 - 4s - loss: 3.2508 - accuracy20: 0.3956 - val_loss: 3.2933 - val_accuracy20: 0.3724 - 4s/epoch - 18ms/step
Epoch 15/50
211/211 - 4s - loss: 3.2494 - accuracy20: 0.3950 - val_loss: 3.2930 - val_accuracy20: 0.3719 - 4s/epoch - 19ms/step
Epoch 16/50
211/211 - 4s - loss: 3.2460 - accuracy20: 0.3987 - val_loss: 3.2885 - val_accuracy20: 0.3703 - 4s/epoch - 19ms/step
Epoch 17/50
211/211 - 4s - loss: 3.2432 - accuracy20: 0.3998 - val_loss: 3.2859 - val_accuracy20: 0.3757 - 4s/epoch - 19ms/step
Epoch 18/50
211/211 - 4s - loss: 3.2394 - accuracy20: 0.4020 - val_loss: 3.2963 - val_accuracy20: 0.3749 - 4s/epoch - 20ms/step
Epoch 19/50
211/211 - 4s - loss: 3.2373 - accuracy20: 0.4048 - val_loss: 3.2855 - val_accuracy20: 0.3728 - 4s/epoch - 20ms/step
Epoch 20/50
211/211 - 4s - loss: 3.2354 - accuracy20: 0.4032 - val_loss: 3.2883 - val_accuracy20: 0.3707 - 4s/epoch - 21ms/step
Epoch 21/50
211/211 - 4s - loss: 3.2356 - accuracy20: 0.4046 - val_loss: 3.2895 - val_accuracy20: 0.3769 - 4s/epoch - 21ms/step
Epoch 22/50
211/211 - 4s - loss: 3.2323 - accuracy20: 0.4053 - val_loss: 3.2851 - val_accuracy20: 0.3757 - 4s/epoch - 20ms/step
Epoch 23/50
211/211 - 4s - loss: 3.2309 - accuracy20: 0.4055 - val_loss: 3.2893 - val_accuracy20: 0.3739 - 4s/epoch - 20ms/step
Epoch 24/50
211/211 - 4s - loss: 3.2277 - accuracy20: 0.4076 - val_loss: 3.2948 - val_accuracy20: 0.3731 - 4s/epoch - 19ms/step
Epoch 25/50
211/211 - 4s - loss: 3.2245 - accuracy20: 0.4112 - val_loss: 3.2855 - val_accuracy20: 0.3761 - 4s/epoch - 21ms/step
Epoch 26/50
211/211 - 4s - loss: 3.2223 - accuracy20: 0.4123 - val_loss: 3.2951 - val_accuracy20: 0.3765 - 4s/epoch - 21ms/step
Epoch 27/50
211/211 - 4s - loss: 3.2157 - accuracy20: 0.4145 - val_loss: 3.2953 - val_accuracy20: 0.3777 - 4s/epoch - 20ms/step
Epoch 28/50
211/211 - 4s - loss: 3.2157 - accuracy20: 0.4147 - val_loss: 3.2955 - val_accuracy20: 0.3770 - 4s/epoch - 21ms/step
Epoch 29/50
211/211 - 4s - loss: 3.2138 - accuracy20: 0.4171 - val_loss: 3.2962 - val_accuracy20: 0.3789 - 4s/epoch - 21ms/step
Epoch 30/50
211/211 - 4s - loss: 3.2110 - accuracy20: 0.4158 - val_loss: 3.2983 - val_accuracy20: 0.3737 - 4s/epoch - 20ms/step
Epoch 31/50
211/211 - 4s - loss: 3.2066 - accuracy20: 0.4178 - val_loss: 3.3012 - val_accuracy20: 0.3726 - 4s/epoch - 21ms/step
Epoch 32/50
211/211 - 4s - loss: 3.2057 - accuracy20: 0.4205 - val_loss: 3.2944 - val_accuracy20: 0.3770 - 4s/epoch - 20ms/step
testing model: results/LILAK/W6/deepOF_L1/h20
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.102642
{'0': {'precision': 0.3893558433437947, 'recall': 0.3348569773935345, 'f1-score': 0.36005582088390475, 'support': 96698}, '1': {'precision': 0.30530005159499707, 'recall': 0.47784801314360503, 'f1-score': 0.3725656223539373, 'support': 71822}, '2': {'precision': 0.4189971517520037, 'recall': 0.30843946870550604, 'f1-score': 0.35531689013464246, 'support': 102542}, 'accuracy': 0.36275095734555196, 'macro avg': {'precision': 0.37121768223026513, 'recall': 0.37371481974754855, 'f1-score': 0.3626461111241615, 'support': 271062}, 'weighted avg': {'precision': 0.37829720720819626, 'recall': 0.36275095734555196, 'f1-score': 0.3615777587589659, 'support': 271062}}
[[32380 38507 25811]
 [19456 34320 18046]
 [31327 39587 31628]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0819715
{'0': {'precision': 0.4261453765046188, 'recall': 0.24965833925545292, 'f1-score': 0.3148569458807308, 'support': 18293}, '1': {'precision': 0.4037914341672518, 'recall': 0.593213897937025, 'f1-score': 0.48050834414370835, 'support': 18420}, '2': {'precision': 0.38755330325690623, 'recall': 0.36362054969268237, 'f1-score': 0.3752056720615072, 'support': 17246}, 'accuracy': 0.40336181174595526, 'macro avg': {'precision': 0.40583003797625894, 'recall': 0.4021642622950534, 'f1-score': 0.39019032069531545, 'support': 53959}, 'weighted avg': {'precision': 0.4061798746775955, 'recall': 0.40336181174595526, 'f1-score': 0.3906936531532472, 'support': 53959}}
[[ 4567  8361  5365]
 [ 2948 10927  4545]
 [ 3202  7773  6271]]
Evaluating performance on  val set...
81/81 - 1s - 766ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.095341
{'0': {'precision': 0.3923373287671233, 'recall': 0.2602953706333428, 'f1-score': 0.31295885265494283, 'support': 7042}, '1': {'precision': 0.3631525076765609, 'recall': 0.5349819059107358, 'f1-score': 0.43263016705279844, 'support': 6632}, '2': {'precision': 0.3869874071682273, 'recall': 0.3442976156276932, 'f1-score': 0.3643964730921253, 'support': 6962}, 'accuracy': 0.3769141306454739, 'macro avg': {'precision': 0.38082574787063717, 'recall': 0.37985829739059057, 'f1-score': 0.3699951642666222, 'support': 20636}, 'weighted avg': {'precision': 0.38115299616176745, 'recall': 0.3769141306454739, 'f1-score': 0.36877242459573767, 'support': 20636}}
[[1833 3175 2034]
 [1321 3548 1763]
 [1518 3047 2397]]
training model: results/LILAK/W6/deepOF_L1/h30
Epoch 1/50
211/211 - 6s - loss: 3.3273 - accuracy30: 0.3447 - val_loss: 3.3298 - val_accuracy30: 0.3418 - 6s/epoch - 29ms/step
Epoch 2/50
211/211 - 4s - loss: 3.3110 - accuracy30: 0.3419 - val_loss: 3.3075 - val_accuracy30: 0.3473 - 4s/epoch - 21ms/step
Epoch 3/50
211/211 - 4s - loss: 3.3010 - accuracy30: 0.3527 - val_loss: 3.3050 - val_accuracy30: 0.3495 - 4s/epoch - 21ms/step
Epoch 4/50
211/211 - 4s - loss: 3.2951 - accuracy30: 0.3538 - val_loss: 3.2980 - val_accuracy30: 0.3557 - 4s/epoch - 21ms/step
Epoch 5/50
211/211 - 4s - loss: 3.2897 - accuracy30: 0.3620 - val_loss: 3.2989 - val_accuracy30: 0.3492 - 4s/epoch - 21ms/step
Epoch 6/50
211/211 - 4s - loss: 3.2863 - accuracy30: 0.3637 - val_loss: 3.2957 - val_accuracy30: 0.3519 - 4s/epoch - 20ms/step
Epoch 7/50
211/211 - 4s - loss: 3.2817 - accuracy30: 0.3689 - val_loss: 3.2994 - val_accuracy30: 0.3529 - 4s/epoch - 20ms/step
Epoch 8/50
211/211 - 4s - loss: 3.2792 - accuracy30: 0.3732 - val_loss: 3.2935 - val_accuracy30: 0.3580 - 4s/epoch - 21ms/step
Epoch 9/50
211/211 - 4s - loss: 3.2759 - accuracy30: 0.3724 - val_loss: 3.2954 - val_accuracy30: 0.3549 - 4s/epoch - 21ms/step
Epoch 10/50
211/211 - 4s - loss: 3.2721 - accuracy30: 0.3788 - val_loss: 3.2964 - val_accuracy30: 0.3575 - 4s/epoch - 21ms/step
Epoch 11/50
211/211 - 4s - loss: 3.2706 - accuracy30: 0.3779 - val_loss: 3.2980 - val_accuracy30: 0.3555 - 4s/epoch - 21ms/step
Epoch 12/50
211/211 - 4s - loss: 3.2683 - accuracy30: 0.3798 - val_loss: 3.2936 - val_accuracy30: 0.3597 - 4s/epoch - 20ms/step
Epoch 13/50
211/211 - 4s - loss: 3.2638 - accuracy30: 0.3829 - val_loss: 3.2960 - val_accuracy30: 0.3553 - 4s/epoch - 20ms/step
Epoch 14/50
211/211 - 4s - loss: 3.2648 - accuracy30: 0.3819 - val_loss: 3.2877 - val_accuracy30: 0.3624 - 4s/epoch - 21ms/step
Epoch 15/50
211/211 - 4s - loss: 3.2602 - accuracy30: 0.3873 - val_loss: 3.2941 - val_accuracy30: 0.3596 - 4s/epoch - 20ms/step
Epoch 16/50
211/211 - 4s - loss: 3.2581 - accuracy30: 0.3885 - val_loss: 3.2936 - val_accuracy30: 0.3609 - 4s/epoch - 21ms/step
Epoch 17/50
211/211 - 4s - loss: 3.2576 - accuracy30: 0.3861 - val_loss: 3.2878 - val_accuracy30: 0.3625 - 4s/epoch - 20ms/step
Epoch 18/50
211/211 - 4s - loss: 3.2544 - accuracy30: 0.3898 - val_loss: 3.2893 - val_accuracy30: 0.3618 - 4s/epoch - 21ms/step
Epoch 19/50
211/211 - 4s - loss: 3.2510 - accuracy30: 0.3948 - val_loss: 3.2909 - val_accuracy30: 0.3639 - 4s/epoch - 20ms/step
Epoch 20/50
211/211 - 5s - loss: 3.2500 - accuracy30: 0.3898 - val_loss: 3.2880 - val_accuracy30: 0.3664 - 5s/epoch - 22ms/step
Epoch 21/50
211/211 - 4s - loss: 3.2485 - accuracy30: 0.3938 - val_loss: 3.2909 - val_accuracy30: 0.3689 - 4s/epoch - 20ms/step
Epoch 22/50
211/211 - 4s - loss: 3.2454 - accuracy30: 0.3955 - val_loss: 3.2873 - val_accuracy30: 0.3668 - 4s/epoch - 21ms/step
Epoch 23/50
211/211 - 4s - loss: 3.2437 - accuracy30: 0.3977 - val_loss: 3.2965 - val_accuracy30: 0.3652 - 4s/epoch - 20ms/step
Epoch 24/50
211/211 - 4s - loss: 3.2392 - accuracy30: 0.3992 - val_loss: 3.2951 - val_accuracy30: 0.3665 - 4s/epoch - 21ms/step
Epoch 25/50
211/211 - 5s - loss: 3.2359 - accuracy30: 0.4013 - val_loss: 3.2982 - val_accuracy30: 0.3623 - 5s/epoch - 22ms/step
Epoch 26/50
211/211 - 4s - loss: 3.2352 - accuracy30: 0.4025 - val_loss: 3.2954 - val_accuracy30: 0.3661 - 4s/epoch - 20ms/step
Epoch 27/50
211/211 - 4s - loss: 3.2323 - accuracy30: 0.4044 - val_loss: 3.2949 - val_accuracy30: 0.3703 - 4s/epoch - 19ms/step
Epoch 28/50
211/211 - 4s - loss: 3.2302 - accuracy30: 0.4052 - val_loss: 3.3020 - val_accuracy30: 0.3650 - 4s/epoch - 21ms/step
Epoch 29/50
211/211 - 4s - loss: 3.2277 - accuracy30: 0.4059 - val_loss: 3.2989 - val_accuracy30: 0.3688 - 4s/epoch - 20ms/step
Epoch 30/50
211/211 - 4s - loss: 3.2242 - accuracy30: 0.4053 - val_loss: 3.2963 - val_accuracy30: 0.3670 - 4s/epoch - 20ms/step
Epoch 31/50
211/211 - 4s - loss: 3.2241 - accuracy30: 0.4099 - val_loss: 3.3000 - val_accuracy30: 0.3658 - 4s/epoch - 20ms/step
Epoch 32/50
211/211 - 4s - loss: 3.2189 - accuracy30: 0.4126 - val_loss: 3.2996 - val_accuracy30: 0.3656 - 4s/epoch - 21ms/step
testing model: results/LILAK/W6/deepOF_L1/h30
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1020592
{'0': {'precision': 0.3763107408478095, 'recall': 0.30319520613208545, 'f1-score': 0.3358193203405333, 'support': 94454}, '1': {'precision': 0.3056555883373829, 'recall': 0.3707763157894737, 'f1-score': 0.3350813356164384, 'support': 76000}, '2': {'precision': 0.3969231667445119, 'recall': 0.40544489503816794, 'f1-score': 0.4011387774368657, 'support': 100608}, 'accuracy': 0.36009473847311685, 'macro avg': {'precision': 0.35962983197656806, 'recall': 0.35980547231990906, 'f1-score': 0.3573464777979458, 'support': 271062}, 'weighted avg': {'precision': 0.3641510997097046, 'recall': 0.36009473847311685, 'f1-score': 0.35985652622153685, 'support': 271062}}
[[28638 31491 34325]
 [20169 28179 27652]
 [27295 32522 40791]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0867385
{'0': {'precision': 0.41886523377813994, 'recall': 0.2216711590296496, 'f1-score': 0.28991433708182046, 'support': 18550}, '1': {'precision': 0.3819188906534454, 'recall': 0.5526596042822711, 'f1-score': 0.451692702368409, 'support': 17841}, '2': {'precision': 0.3792633015006821, 'recall': 0.3956056466302368, 'f1-score': 0.38726214025018807, 'support': 17568}, 'accuracy': 0.38773883874793824, 'macro avg': {'precision': 0.3933491419774225, 'recall': 0.3899788033140525, 'f1-score': 0.37628972656680587, 'support': 53959}, 'weighted avg': {'precision': 0.39375567922861054, 'recall': 0.38773883874793824, 'f1-score': 0.3750992741848044, 'support': 53959}}
[[4112 8274 6164]
 [2770 9860 5211]
 [2935 7683 6950]]
Evaluating performance on  val set...
81/81 - 1s - 754ms/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0967516
{'0': {'precision': 0.3900110987791343, 'recall': 0.24477570353859013, 'f1-score': 0.3007789095266627, 'support': 7178}, '1': {'precision': 0.3442493810488409, 'recall': 0.47470515207945374, 'f1-score': 0.3990867579908676, 'support': 6444}, '2': {'precision': 0.38951000690131127, 'recall': 0.4023381807812946, 'f1-score': 0.39582018374360056, 'support': 7014}, 'accuracy': 0.37012987012987014, 'macro avg': {'precision': 0.37459016224309555, 'recall': 0.3739396787997795, 'f1-score': 0.3652286170870436, 'support': 20636}, 'weighted avg': {'precision': 0.3755507785869914, 'recall': 0.37012987012987014, 'f1-score': 0.363781200322405, 'support': 20636}}
[[1757 3018 2403]
 [1365 3059 2020]
 [1383 2809 2822]]
training model: results/LILAK/W6/deepOF_L1/h50
Epoch 1/50
211/211 - 6s - loss: 3.3298 - accuracy50: 0.3379 - val_loss: 3.3251 - val_accuracy50: 0.3397 - 6s/epoch - 29ms/step
Epoch 2/50
211/211 - 4s - loss: 3.3091 - accuracy50: 0.3458 - val_loss: 3.3133 - val_accuracy50: 0.3475 - 4s/epoch - 20ms/step
Epoch 3/50
211/211 - 4s - loss: 3.3015 - accuracy50: 0.3491 - val_loss: 3.3084 - val_accuracy50: 0.3464 - 4s/epoch - 19ms/step
Epoch 4/50
211/211 - 5s - loss: 3.2926 - accuracy50: 0.3539 - val_loss: 3.3030 - val_accuracy50: 0.3541 - 5s/epoch - 21ms/step
Epoch 5/50
211/211 - 4s - loss: 3.2905 - accuracy50: 0.3570 - val_loss: 3.3040 - val_accuracy50: 0.3485 - 4s/epoch - 20ms/step
Epoch 6/50
211/211 - 5s - loss: 3.2869 - accuracy50: 0.3591 - val_loss: 3.2995 - val_accuracy50: 0.3521 - 5s/epoch - 22ms/step
Epoch 7/50
211/211 - 4s - loss: 3.2831 - accuracy50: 0.3633 - val_loss: 3.3017 - val_accuracy50: 0.3515 - 4s/epoch - 19ms/step
Epoch 8/50
211/211 - 4s - loss: 3.2804 - accuracy50: 0.3637 - val_loss: 3.2999 - val_accuracy50: 0.3524 - 4s/epoch - 21ms/step
Epoch 9/50
211/211 - 4s - loss: 3.2816 - accuracy50: 0.3661 - val_loss: 3.3011 - val_accuracy50: 0.3546 - 4s/epoch - 19ms/step
Epoch 10/50
211/211 - 4s - loss: 3.2763 - accuracy50: 0.3696 - val_loss: 3.2997 - val_accuracy50: 0.3527 - 4s/epoch - 20ms/step
Epoch 11/50
211/211 - 5s - loss: 3.2762 - accuracy50: 0.3694 - val_loss: 3.2993 - val_accuracy50: 0.3541 - 5s/epoch - 22ms/step
Epoch 12/50
211/211 - 4s - loss: 3.2735 - accuracy50: 0.3723 - val_loss: 3.3000 - val_accuracy50: 0.3553 - 4s/epoch - 21ms/step
Epoch 13/50
211/211 - 4s - loss: 3.2700 - accuracy50: 0.3740 - val_loss: 3.3009 - val_accuracy50: 0.3526 - 4s/epoch - 21ms/step
Epoch 14/50
211/211 - 5s - loss: 3.2690 - accuracy50: 0.3750 - val_loss: 3.2970 - val_accuracy50: 0.3547 - 5s/epoch - 21ms/step
Epoch 15/50
211/211 - 4s - loss: 3.2675 - accuracy50: 0.3787 - val_loss: 3.2979 - val_accuracy50: 0.3578 - 4s/epoch - 21ms/step
Epoch 16/50
211/211 - 5s - loss: 3.2648 - accuracy50: 0.3802 - val_loss: 3.2969 - val_accuracy50: 0.3546 - 5s/epoch - 22ms/step
Epoch 17/50
211/211 - 4s - loss: 3.2643 - accuracy50: 0.3805 - val_loss: 3.2945 - val_accuracy50: 0.3595 - 4s/epoch - 21ms/step
Epoch 18/50
211/211 - 4s - loss: 3.2627 - accuracy50: 0.3806 - val_loss: 3.2963 - val_accuracy50: 0.3545 - 4s/epoch - 21ms/step
Epoch 19/50
211/211 - 4s - loss: 3.2617 - accuracy50: 0.3820 - val_loss: 3.2956 - val_accuracy50: 0.3572 - 4s/epoch - 21ms/step
Epoch 20/50
211/211 - 5s - loss: 3.2589 - accuracy50: 0.3836 - val_loss: 3.2996 - val_accuracy50: 0.3549 - 5s/epoch - 22ms/step
Epoch 21/50
211/211 - 4s - loss: 3.2562 - accuracy50: 0.3878 - val_loss: 3.2949 - val_accuracy50: 0.3595 - 4s/epoch - 21ms/step
Epoch 22/50
211/211 - 5s - loss: 3.2532 - accuracy50: 0.3903 - val_loss: 3.2958 - val_accuracy50: 0.3608 - 5s/epoch - 23ms/step
Epoch 23/50
211/211 - 4s - loss: 3.2501 - accuracy50: 0.3899 - val_loss: 3.2982 - val_accuracy50: 0.3606 - 4s/epoch - 21ms/step
Epoch 24/50
211/211 - 4s - loss: 3.2531 - accuracy50: 0.3899 - val_loss: 3.2994 - val_accuracy50: 0.3589 - 4s/epoch - 21ms/step
Epoch 25/50
211/211 - 4s - loss: 3.2489 - accuracy50: 0.3924 - val_loss: 3.3007 - val_accuracy50: 0.3581 - 4s/epoch - 19ms/step
Epoch 26/50
211/211 - 4s - loss: 3.2462 - accuracy50: 0.3916 - val_loss: 3.3033 - val_accuracy50: 0.3603 - 4s/epoch - 20ms/step
Epoch 27/50
211/211 - 4s - loss: 3.2426 - accuracy50: 0.3965 - val_loss: 3.3043 - val_accuracy50: 0.3599 - 4s/epoch - 20ms/step
testing model: results/LILAK/W6/deepOF_L1/h50
Evaluating performance on  test set...
1059/1059 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1040832
{'0': {'precision': 0.36411060254561417, 'recall': 0.3180667988476158, 'f1-score': 0.33953482933217954, 'support': 91289}, '1': {'precision': 0.3085598096655522, 'recall': 0.36153751688566865, 'f1-score': 0.3329544619177679, 'support': 81430}, '2': {'precision': 0.39196713448585074, 'recall': 0.3822539479169844, 'f1-score': 0.387049611581012, 'support': 98343}, 'accuracy': 0.35441338144040846, 'macro avg': {'precision': 0.3548791822323391, 'recall': 0.3539527545500896, 'f1-score': 0.35317963427698645, 'support': 271062}, 'weighted avg': {'precision': 0.3575290597855639, 'recall': 0.35441338144040846, 'f1-score': 0.3547966768509811, 'support': 271062}}
[[29036 32472 29781]
 [23457 29440 28533]
 [27252 33499 37592]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0929855
{'0': {'precision': 0.4081721176368526, 'recall': 0.254627124147635, 'f1-score': 0.3136143976003999, 'support': 18478}, '1': {'precision': 0.3594867394058273, 'recall': 0.4904934485642598, 'f1-score': 0.4148941187567797, 'support': 17935}, '2': {'precision': 0.3694671788875898, 'recall': 0.378205858885216, 'f1-score': 0.37378545075618896, 'support': 17546}, 'accuracy': 0.37320928853388685, 'macro avg': {'precision': 0.3790420119767566, 'recall': 0.37444214386570357, 'f1-score': 0.3674313223711228, 'support': 53959}, 'weighted avg': {'precision': 0.37940418061303816, 'recall': 0.37320928853388685, 'f1-score': 0.3668439440636617, 'support': 53959}}
[[4705 8063 5710]
 [3523 8797 5615]
 [3299 7611 6636]]
Evaluating performance on  val set...
81/81 - 1s - 837ms/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0991176
{'0': {'precision': 0.3866615265998458, 'recall': 0.2777623926890058, 'f1-score': 0.3232876712328767, 'support': 7222}, '1': {'precision': 0.3217683917382223, 'recall': 0.4307907410284294, 'f1-score': 0.36838259714380606, 'support': 6437}, '2': {'precision': 0.3850658857979502, 'recall': 0.3769528450623477, 'f1-score': 0.3809661765770986, 'support': 6977}, 'accuracy': 0.3590327582864896, 'macro avg': {'precision': 0.3644986013786728, 'recall': 0.36183532625992765, 'f1-score': 0.35754548165126043, 'support': 20636}, 'weighted avg': {'precision': 0.36587988795964926, 'recall': 0.3590327582864896, 'f1-score': 0.35685517316519344, 'support': 20636}}
[[2006 3034 2182]
 [1646 2773 2018]
 [1536 2811 2630]]
training model: results/LILAK/W6/deepOF_L1/h100
Epoch 1/50
211/211 - 6s - loss: 3.3265 - accuracy100: 0.3478 - val_loss: 3.3294 - val_accuracy100: 0.3330 - 6s/epoch - 29ms/step
Epoch 2/50
211/211 - 5s - loss: 3.3075 - accuracy100: 0.3531 - val_loss: 3.3126 - val_accuracy100: 0.3411 - 5s/epoch - 22ms/step
Epoch 3/50
211/211 - 4s - loss: 3.2971 - accuracy100: 0.3587 - val_loss: 3.3112 - val_accuracy100: 0.3448 - 4s/epoch - 18ms/step
Epoch 4/50
211/211 - 4s - loss: 3.2902 - accuracy100: 0.3629 - val_loss: 3.3056 - val_accuracy100: 0.3459 - 4s/epoch - 20ms/step
Epoch 5/50
211/211 - 4s - loss: 3.2883 - accuracy100: 0.3656 - val_loss: 3.3045 - val_accuracy100: 0.3498 - 4s/epoch - 20ms/step
Epoch 6/50
211/211 - 4s - loss: 3.2850 - accuracy100: 0.3676 - val_loss: 3.3038 - val_accuracy100: 0.3499 - 4s/epoch - 21ms/step
Epoch 7/50
211/211 - 4s - loss: 3.2815 - accuracy100: 0.3708 - val_loss: 3.3041 - val_accuracy100: 0.3488 - 4s/epoch - 19ms/step
Epoch 8/50
211/211 - 4s - loss: 3.2778 - accuracy100: 0.3726 - val_loss: 3.3021 - val_accuracy100: 0.3502 - 4s/epoch - 21ms/step
Epoch 9/50
211/211 - 4s - loss: 3.2774 - accuracy100: 0.3735 - val_loss: 3.3026 - val_accuracy100: 0.3516 - 4s/epoch - 21ms/step
Epoch 10/50
211/211 - 4s - loss: 3.2752 - accuracy100: 0.3740 - val_loss: 3.2992 - val_accuracy100: 0.3540 - 4s/epoch - 19ms/step
Epoch 11/50
211/211 - 4s - loss: 3.2737 - accuracy100: 0.3790 - val_loss: 3.3008 - val_accuracy100: 0.3536 - 4s/epoch - 20ms/step
Epoch 12/50
211/211 - 4s - loss: 3.2705 - accuracy100: 0.3786 - val_loss: 3.3045 - val_accuracy100: 0.3519 - 4s/epoch - 20ms/step
Epoch 13/50
211/211 - 4s - loss: 3.2712 - accuracy100: 0.3782 - val_loss: 3.3028 - val_accuracy100: 0.3517 - 4s/epoch - 21ms/step
Epoch 14/50
211/211 - 4s - loss: 3.2678 - accuracy100: 0.3801 - val_loss: 3.3023 - val_accuracy100: 0.3552 - 4s/epoch - 21ms/step
Epoch 15/50
211/211 - 4s - loss: 3.2665 - accuracy100: 0.3810 - val_loss: 3.3053 - val_accuracy100: 0.3525 - 4s/epoch - 21ms/step
Epoch 16/50
211/211 - 4s - loss: 3.2671 - accuracy100: 0.3825 - val_loss: 3.3046 - val_accuracy100: 0.3533 - 4s/epoch - 20ms/step
Epoch 17/50
211/211 - 4s - loss: 3.2628 - accuracy100: 0.3846 - val_loss: 3.3056 - val_accuracy100: 0.3527 - 4s/epoch - 19ms/step
Epoch 18/50
211/211 - 4s - loss: 3.2633 - accuracy100: 0.3828 - val_loss: 3.3037 - val_accuracy100: 0.3533 - 4s/epoch - 21ms/step
Epoch 19/50
211/211 - 4s - loss: 3.2606 - accuracy100: 0.3858 - val_loss: 3.3039 - val_accuracy100: 0.3560 - 4s/epoch - 21ms/step
Epoch 20/50
211/211 - 4s - loss: 3.2594 - accuracy100: 0.3874 - val_loss: 3.3106 - val_accuracy100: 0.3490 - 4s/epoch - 21ms/step
testing model: results/LILAK/W6/deepOF_L1/h100
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.101517
{'0': {'precision': 0.3409712225465207, 'recall': 0.3023255813953488, 'f1-score': 0.32048759597063003, 'support': 85398}, '1': {'precision': 0.3369159939046137, 'recall': 0.22999712268431421, 'f1-score': 0.27337419762180365, 'support': 90362}, '2': {'precision': 0.36449269398535056, 'recall': 0.5111854945331682, 'f1-score': 0.42555217309649324, 'support': 95302}, 'accuracy': 0.3516464867816219, 'macro avg': {'precision': 0.34745997014549496, 'recall': 0.34783606620427704, 'f1-score': 0.3398046555629757, 'support': 271062}, 'weighted avg': {'precision': 0.3478892143732001, 'recall': 0.3516464867816219, 'f1-score': 0.3417211271467166, 'support': 271062}}
[[25818 18974 40606]
 [25245 20783 44334]
 [24656 21929 48717]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.097764
{'0': {'precision': 0.3854571634269258, 'recall': 0.2861724303811, 'f1-score': 0.32847633362986595, 'support': 18709}, '1': {'precision': 0.33930420376889625, 'recall': 0.18888696754856188, 'f1-score': 0.24267782426778248, 'support': 17349}, '2': {'precision': 0.34859097037256254, 'recall': 0.5922015529858667, 'f1-score': 0.4388557708229839, 'support': 17901}, 'accuracy': 0.35641876239366926, 'macro avg': {'precision': 0.3577841125227949, 'recall': 0.3557536503051762, 'f1-score': 0.3366699762402108, 'support': 53959}, 'weighted avg': {'precision': 0.3583875472558828, 'recall': 0.35641876239366926, 'f1-score': 0.3375088206342807, 'support': 53959}}
[[ 5354  3236 10119]
 [ 4381  3277  9691]
 [ 4155  3145 10601]]
Evaluating performance on  val set...
81/81 - 1s - 759ms/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.098257
{'0': {'precision': 0.3555322496067121, 'recall': 0.3088838268792711, 'f1-score': 0.33057045343734764, 'support': 6585}, '1': {'precision': 0.35471100554235946, 'recall': 0.18464074735540595, 'f1-score': 0.24286230574629564, 'support': 7279}, '2': {'precision': 0.35133920546467734, 'recall': 0.5772297696396929, 'f1-score': 0.43680858196446526, 'support': 6772}, 'accuracy': 0.3531207598371777, 'macro avg': {'precision': 0.353860820204583, 'recall': 0.35691811462478995, 'f1-score': 0.3367471137160362, 'support': 20636}, 'weighted avg': {'precision': 0.3538665619504666, 'recall': 0.3531207598371777, 'f1-score': 0.3344964565068608, 'support': 20636}}
[[2034 1198 3353]
 [2071 1344 3864]
 [1616 1247 3909]]
training model: results/LILAK/W6/deepOF_L1/h200
Epoch 1/50
211/211 - 6s - loss: 3.3327 - accuracy200: 0.3418 - val_loss: 3.3294 - val_accuracy200: 0.3406 - 6s/epoch - 29ms/step
Epoch 2/50
211/211 - 4s - loss: 3.3104 - accuracy200: 0.3472 - val_loss: 3.3161 - val_accuracy200: 0.3501 - 4s/epoch - 20ms/step
Epoch 3/50
211/211 - 4s - loss: 3.3030 - accuracy200: 0.3496 - val_loss: 3.3115 - val_accuracy200: 0.3494 - 4s/epoch - 21ms/step
Epoch 4/50
211/211 - 4s - loss: 3.2978 - accuracy200: 0.3513 - val_loss: 3.3057 - val_accuracy200: 0.3530 - 4s/epoch - 20ms/step
Epoch 5/50
211/211 - 4s - loss: 3.2951 - accuracy200: 0.3563 - val_loss: 3.3075 - val_accuracy200: 0.3493 - 4s/epoch - 20ms/step
Epoch 6/50
211/211 - 4s - loss: 3.2901 - accuracy200: 0.3594 - val_loss: 3.3052 - val_accuracy200: 0.3533 - 4s/epoch - 21ms/step
Epoch 7/50
211/211 - 4s - loss: 3.2894 - accuracy200: 0.3601 - val_loss: 3.3057 - val_accuracy200: 0.3508 - 4s/epoch - 20ms/step
Epoch 8/50
211/211 - 4s - loss: 3.2854 - accuracy200: 0.3614 - val_loss: 3.3036 - val_accuracy200: 0.3566 - 4s/epoch - 21ms/step
Epoch 9/50
211/211 - 5s - loss: 3.2856 - accuracy200: 0.3635 - val_loss: 3.3035 - val_accuracy200: 0.3558 - 5s/epoch - 21ms/step
Epoch 10/50
211/211 - 5s - loss: 3.2841 - accuracy200: 0.3637 - val_loss: 3.3085 - val_accuracy200: 0.3525 - 5s/epoch - 22ms/step
Epoch 11/50
211/211 - 4s - loss: 3.2797 - accuracy200: 0.3680 - val_loss: 3.3070 - val_accuracy200: 0.3545 - 4s/epoch - 20ms/step
Epoch 12/50
211/211 - 4s - loss: 3.2805 - accuracy200: 0.3671 - val_loss: 3.3024 - val_accuracy200: 0.3598 - 4s/epoch - 21ms/step
Epoch 13/50
211/211 - 4s - loss: 3.2775 - accuracy200: 0.3703 - val_loss: 3.3061 - val_accuracy200: 0.3572 - 4s/epoch - 20ms/step
Epoch 14/50
211/211 - 5s - loss: 3.2754 - accuracy200: 0.3720 - val_loss: 3.3073 - val_accuracy200: 0.3590 - 5s/epoch - 21ms/step
Epoch 15/50
211/211 - 4s - loss: 3.2737 - accuracy200: 0.3741 - val_loss: 3.3017 - val_accuracy200: 0.3580 - 4s/epoch - 21ms/step
Epoch 16/50
211/211 - 4s - loss: 3.2725 - accuracy200: 0.3758 - val_loss: 3.3032 - val_accuracy200: 0.3609 - 4s/epoch - 20ms/step
Epoch 17/50
211/211 - 5s - loss: 3.2711 - accuracy200: 0.3780 - val_loss: 3.3033 - val_accuracy200: 0.3618 - 5s/epoch - 22ms/step
Epoch 18/50
211/211 - 5s - loss: 3.2685 - accuracy200: 0.3787 - val_loss: 3.3041 - val_accuracy200: 0.3621 - 5s/epoch - 22ms/step
Epoch 19/50
211/211 - 4s - loss: 3.2684 - accuracy200: 0.3772 - val_loss: 3.3033 - val_accuracy200: 0.3644 - 4s/epoch - 21ms/step
Epoch 20/50
211/211 - 4s - loss: 3.2641 - accuracy200: 0.3813 - val_loss: 3.3049 - val_accuracy200: 0.3616 - 4s/epoch - 19ms/step
Epoch 21/50
211/211 - 4s - loss: 3.2636 - accuracy200: 0.3846 - val_loss: 3.3068 - val_accuracy200: 0.3616 - 4s/epoch - 21ms/step
Epoch 22/50
211/211 - 4s - loss: 3.2607 - accuracy200: 0.3836 - val_loss: 3.3052 - val_accuracy200: 0.3610 - 4s/epoch - 21ms/step
Epoch 23/50
211/211 - 4s - loss: 3.2590 - accuracy200: 0.3869 - val_loss: 3.3073 - val_accuracy200: 0.3629 - 4s/epoch - 20ms/step
Epoch 24/50
211/211 - 4s - loss: 3.2579 - accuracy200: 0.3871 - val_loss: 3.3052 - val_accuracy200: 0.3625 - 4s/epoch - 21ms/step
Epoch 25/50
211/211 - 4s - loss: 3.2559 - accuracy200: 0.3878 - val_loss: 3.3076 - val_accuracy200: 0.3582 - 4s/epoch - 20ms/step
testing model: results/LILAK/W6/deepOF_L1/h200
Evaluating performance on  test set...
1059/1059 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1037515
{'0': {'precision': 0.31809891515467337, 'recall': 0.3273411982645152, 'f1-score': 0.32265388496468217, 'support': 82052}, '1': {'precision': 0.36730871288983236, 'recall': 0.1234187173516269, 'f1-score': 0.1847574332440899, 'support': 95334}, '2': {'precision': 0.3611159625597537, 'recall': 0.5959477347452923, 'f1-score': 0.449721874257358, 'support': 93676}, 'accuracy': 0.34844795655606464, 'macro avg': {'precision': 0.34884119686808646, 'recall': 0.3489025501204781, 'f1-score': 0.31904439748871, 'support': 271062}, 'weighted avg': {'precision': 0.3502724835264922, 'recall': 0.34844795655606464, 'f1-score': 0.318068220565577, 'support': 271062}}
[[26859  9502 45691]
 [30492 11766 53076]
 [27085 10765 55826]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0965645
{'0': {'precision': 0.3846454640250261, 'recall': 0.3197356303158351, 'f1-score': 0.34919977516788453, 'support': 18459}, '1': {'precision': 0.36215704824976347, 'recall': 0.10986740141208885, 'f1-score': 0.16858980005284946, 'support': 17421}, '2': {'precision': 0.35382538253825385, 'recall': 0.6523037778638199, 'f1-score': 0.45879126223034883, 'support': 18079}, 'accuracy': 0.3634055486573139, 'macro avg': {'precision': 0.36687596493768115, 'recall': 0.36063560319724797, 'f1-score': 0.3255269458170276, 'support': 53959}, 'weighted avg': {'precision': 0.36705864913927566, 'recall': 0.3634055486573139, 'f1-score': 0.32760742019694855, 'support': 53959}}
[[ 5902  1697 10860]
 [ 4830  1914 10677]
 [ 4612  1674 11793]]
Evaluating performance on  val set...
81/81 - 1s - 656ms/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1011105
{'0': {'precision': 0.36114143146733196, 'recall': 0.3287904599659284, 'f1-score': 0.34420747566322357, 'support': 7044}, '1': {'precision': 0.3022774327122153, 'recall': 0.0900262062586712, 'f1-score': 0.13873381636773963, 'support': 6487}, '2': {'precision': 0.36221625579692457, 'recall': 0.6266009852216748, 'f1-score': 0.4590637244792741, 'support': 7105}, 'accuracy': 0.3562705950765652, 'macro avg': {'precision': 0.34187837332549065, 'recall': 0.3484725504820915, 'f1-score': 0.3140016721700791, 'support': 20636}, 'weighted avg': {'precision': 0.3430073874150599, 'recall': 0.3562705950765652, 'f1-score': 0.31916124674232005, 'support': 20636}}
[[2316  702 4026]
 [2090  584 3813]
 [2007  646 4452]]
training model: results/LILAK/W6/deepOF_L1/h300
Epoch 1/50
211/211 - 6s - loss: 3.3271 - accuracy300: 0.3455 - val_loss: 3.3228 - val_accuracy300: 0.3375 - 6s/epoch - 29ms/step
Epoch 2/50
211/211 - 5s - loss: 3.3093 - accuracy300: 0.3505 - val_loss: 3.3138 - val_accuracy300: 0.3386 - 5s/epoch - 21ms/step
Epoch 3/50
211/211 - 4s - loss: 3.3016 - accuracy300: 0.3562 - val_loss: 3.3110 - val_accuracy300: 0.3437 - 4s/epoch - 20ms/step
Epoch 4/50
211/211 - 5s - loss: 3.2942 - accuracy300: 0.3607 - val_loss: 3.3043 - val_accuracy300: 0.3465 - 5s/epoch - 21ms/step
Epoch 5/50
211/211 - 5s - loss: 3.2938 - accuracy300: 0.3590 - val_loss: 3.3080 - val_accuracy300: 0.3408 - 5s/epoch - 21ms/step
Epoch 6/50
211/211 - 4s - loss: 3.2897 - accuracy300: 0.3627 - val_loss: 3.3054 - val_accuracy300: 0.3415 - 4s/epoch - 21ms/step
Epoch 7/50
211/211 - 4s - loss: 3.2877 - accuracy300: 0.3628 - val_loss: 3.3066 - val_accuracy300: 0.3436 - 4s/epoch - 20ms/step
Epoch 8/50
211/211 - 4s - loss: 3.2830 - accuracy300: 0.3675 - val_loss: 3.3077 - val_accuracy300: 0.3392 - 4s/epoch - 19ms/step
Epoch 9/50
211/211 - 4s - loss: 3.2819 - accuracy300: 0.3676 - val_loss: 3.3079 - val_accuracy300: 0.3369 - 4s/epoch - 20ms/step
Epoch 10/50
211/211 - 4s - loss: 3.2827 - accuracy300: 0.3697 - val_loss: 3.3070 - val_accuracy300: 0.3394 - 4s/epoch - 20ms/step
Epoch 11/50
211/211 - 4s - loss: 3.2779 - accuracy300: 0.3706 - val_loss: 3.3075 - val_accuracy300: 0.3358 - 4s/epoch - 19ms/step
Epoch 12/50
211/211 - 4s - loss: 3.2779 - accuracy300: 0.3725 - val_loss: 3.3060 - val_accuracy300: 0.3363 - 4s/epoch - 20ms/step
Epoch 13/50
211/211 - 4s - loss: 3.2769 - accuracy300: 0.3699 - val_loss: 3.3067 - val_accuracy300: 0.3366 - 4s/epoch - 19ms/step
Epoch 14/50
211/211 - 4s - loss: 3.2745 - accuracy300: 0.3728 - val_loss: 3.3066 - val_accuracy300: 0.3416 - 4s/epoch - 21ms/step
testing model: results/LILAK/W6/deepOF_L1/h300
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1040053
{'0': {'precision': 0.312933890488954, 'recall': 0.22481760554957542, 'f1-score': 0.26165635418334177, 'support': 83610}, '1': {'precision': 0.34266953751979645, 'recall': 0.2100641417226634, 'f1-score': 0.26046027226802104, 'support': 91672}, '2': {'precision': 0.3590550265507306, 'recall': 0.5802986009605345, 'f1-score': 0.44362234513804083, 'support': 95780}, 'accuracy': 0.3454375751673049, 'macro avg': {'precision': 0.33821948485316033, 'recall': 0.3383934494109244, 'f1-score': 0.3219129905298012, 'support': 271062}, 'weighted avg': {'precision': 0.3392873027953944, 'recall': 0.3454375751673049, 'f1-score': 0.3255496899969187, 'support': 271062}}
[[18797 17227 47586]
 [20784 19257 51631]
 [20486 19713 55581]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1028
{'0': {'precision': 0.353583512765303, 'recall': 0.25551542095026397, 'f1-score': 0.29665473079776766, 'support': 17995}, '1': {'precision': 0.3461782094594595, 'recall': 0.17997694714309237, 'f1-score': 0.2368278502040374, 'support': 18219}, '2': {'precision': 0.3346250357335705, 'recall': 0.5936883629191322, 'f1-score': 0.42800845047533925, 'support': 17745}, 'accuracy': 0.34122203895550324, 'macro avg': {'precision': 0.344795585986111, 'recall': 0.3430602436708295, 'f1-score': 0.32049701049238144, 'support': 53959}, 'weighted avg': {'precision': 0.3448484473293747, 'recall': 0.34122203895550324, 'f1-score': 0.31965155835464115, 'support': 53959}}
[[ 4598  3095 10302]
 [ 4294  3279 10646]
 [ 4112  3098 10535]]
Evaluating performance on  val set...
81/81 - 1s - 839ms/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1033087
{'0': {'precision': 0.3303357314148681, 'recall': 0.24898328061455038, 'f1-score': 0.28394743622777635, 'support': 6639}, '1': {'precision': 0.3495717344753747, 'recall': 0.18141408528962355, 'f1-score': 0.23886602652034752, 'support': 7199}, '2': {'precision': 0.33616341627437796, 'recall': 0.588261253309797, 'f1-score': 0.42783780892264894, 'support': 6798}, 'accuracy': 0.33717774762550884, 'macro avg': {'precision': 0.33869029405487366, 'recall': 0.3395528730713236, 'f1-score': 0.31688375722359097, 'support': 20636}, 'weighted avg': {'precision': 0.33896611461449666, 'recall': 0.33717774762550884, 'f1-score': 0.31562148570906945, 'support': 20636}}
[[1653 1187 3799]
 [1795 1306 4098]
 [1556 1243 3999]]
training model: results/LILAK/W6/deepOF_L1/h500
Epoch 1/50
211/211 - 6s - loss: 3.3304 - accuracy500: 0.3460 - val_loss: 3.3276 - val_accuracy500: 0.3355 - 6s/epoch - 29ms/step
Epoch 2/50
211/211 - 4s - loss: 3.3136 - accuracy500: 0.3492 - val_loss: 3.3208 - val_accuracy500: 0.3317 - 4s/epoch - 19ms/step
Epoch 3/50
211/211 - 4s - loss: 3.3091 - accuracy500: 0.3502 - val_loss: 3.3206 - val_accuracy500: 0.3334 - 4s/epoch - 21ms/step
Epoch 4/50
211/211 - 5s - loss: 3.2997 - accuracy500: 0.3567 - val_loss: 3.3115 - val_accuracy500: 0.3380 - 5s/epoch - 22ms/step
Epoch 5/50
211/211 - 4s - loss: 3.3004 - accuracy500: 0.3572 - val_loss: 3.3093 - val_accuracy500: 0.3421 - 4s/epoch - 21ms/step
Epoch 6/50
211/211 - 4s - loss: 3.2938 - accuracy500: 0.3573 - val_loss: 3.3111 - val_accuracy500: 0.3389 - 4s/epoch - 21ms/step
Epoch 7/50
211/211 - 4s - loss: 3.2912 - accuracy500: 0.3614 - val_loss: 3.3101 - val_accuracy500: 0.3334 - 4s/epoch - 21ms/step
Epoch 8/50
211/211 - 5s - loss: 3.2894 - accuracy500: 0.3672 - val_loss: 3.3079 - val_accuracy500: 0.3413 - 5s/epoch - 22ms/step
Epoch 9/50
211/211 - 4s - loss: 3.2883 - accuracy500: 0.3615 - val_loss: 3.3101 - val_accuracy500: 0.3384 - 4s/epoch - 21ms/step
Epoch 10/50
211/211 - 5s - loss: 3.2878 - accuracy500: 0.3641 - val_loss: 3.3088 - val_accuracy500: 0.3399 - 5s/epoch - 21ms/step
Epoch 11/50
211/211 - 4s - loss: 3.2850 - accuracy500: 0.3638 - val_loss: 3.3074 - val_accuracy500: 0.3432 - 4s/epoch - 21ms/step
Epoch 12/50
211/211 - 4s - loss: 3.2827 - accuracy500: 0.3694 - val_loss: 3.3089 - val_accuracy500: 0.3419 - 4s/epoch - 21ms/step
Epoch 13/50
211/211 - 4s - loss: 3.2825 - accuracy500: 0.3688 - val_loss: 3.3079 - val_accuracy500: 0.3387 - 4s/epoch - 20ms/step
Epoch 14/50
211/211 - 4s - loss: 3.2778 - accuracy500: 0.3747 - val_loss: 3.3097 - val_accuracy500: 0.3399 - 4s/epoch - 21ms/step
Epoch 15/50
211/211 - 4s - loss: 3.2791 - accuracy500: 0.3726 - val_loss: 3.3062 - val_accuracy500: 0.3412 - 4s/epoch - 20ms/step
Epoch 16/50
211/211 - 4s - loss: 3.2752 - accuracy500: 0.3772 - val_loss: 3.3082 - val_accuracy500: 0.3405 - 4s/epoch - 20ms/step
Epoch 17/50
211/211 - 4s - loss: 3.2750 - accuracy500: 0.3759 - val_loss: 3.3093 - val_accuracy500: 0.3423 - 4s/epoch - 20ms/step
Epoch 18/50
211/211 - 4s - loss: 3.2738 - accuracy500: 0.3770 - val_loss: 3.3092 - val_accuracy500: 0.3388 - 4s/epoch - 20ms/step
Epoch 19/50
211/211 - 4s - loss: 3.2708 - accuracy500: 0.3785 - val_loss: 3.3100 - val_accuracy500: 0.3396 - 4s/epoch - 18ms/step
Epoch 20/50
211/211 - 4s - loss: 3.2693 - accuracy500: 0.3781 - val_loss: 3.3113 - val_accuracy500: 0.3438 - 4s/epoch - 18ms/step
Epoch 21/50
211/211 - 4s - loss: 3.2696 - accuracy500: 0.3792 - val_loss: 3.3109 - val_accuracy500: 0.3433 - 4s/epoch - 20ms/step
Epoch 22/50
211/211 - 4s - loss: 3.2656 - accuracy500: 0.3818 - val_loss: 3.3097 - val_accuracy500: 0.3430 - 4s/epoch - 20ms/step
Epoch 23/50
211/211 - 4s - loss: 3.2638 - accuracy500: 0.3820 - val_loss: 3.3152 - val_accuracy500: 0.3381 - 4s/epoch - 20ms/step
Epoch 24/50
211/211 - 4s - loss: 3.2638 - accuracy500: 0.3863 - val_loss: 3.3135 - val_accuracy500: 0.3416 - 4s/epoch - 21ms/step
Epoch 25/50
211/211 - 4s - loss: 3.2598 - accuracy500: 0.3878 - val_loss: 3.3167 - val_accuracy500: 0.3393 - 4s/epoch - 20ms/step
testing model: results/LILAK/W6/deepOF_L1/h500
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1000094
{'0': {'precision': 0.3245212856898615, 'recall': 0.17455828763895115, 'f1-score': 0.22700941076220446, 'support': 86991}, '1': {'precision': 0.30272419434615533, 'recall': 0.19627021226735078, 'f1-score': 0.23814191540148005, 'support': 81077}, '2': {'precision': 0.38561710851232356, 'recall': 0.6428724003340001, 'f1-score': 0.4820712200307246, 'support': 102994}, 'accuracy': 0.358995358995359, 'macro avg': {'precision': 0.3376208628494468, 'recall': 0.33790030008010064, 'f1-score': 0.3157408487314697, 'support': 271062}, 'weighted avg': {'precision': 0.3412158441336972, 'recall': 0.358995358995359, 'f1-score': 0.32725373148012327, 'support': 271062}}
[[15185 17136 54670]
 [14342 15913 50822]
 [17265 19517 66212]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985075
{'0': {'precision': 0.3803297328027288, 'recall': 0.1836499396068958, 'f1-score': 0.24769521270687547, 'support': 18214}, '1': {'precision': 0.3653986451276707, 'recall': 0.19525506794386277, 'f1-score': 0.25450981815542084, 'support': 17956}, '2': {'precision': 0.34187073013016955, 'recall': 0.6835684973860251, 'f1-score': 0.45578919749615804, 'support': 17789}, 'accuracy': 0.3523230601011879, 'macro avg': {'precision': 0.36253303602018966, 'recall': 0.3541578349789279, 'f1-score': 0.3193314094528181, 'support': 53959}, 'weighted avg': {'precision': 0.3626820779381928, 'recall': 0.3523230601011879, 'f1-score': 0.31856655855929356, 'support': 53959}}
[[ 3345  3129 11740]
 [ 2781  3506 11669]
 [ 2669  2960 12160]]
Evaluating performance on  val set...
81/81 - 1s - 715ms/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1033365
{'0': {'precision': 0.34725467289719625, 'recall': 0.17269426289034132, 'f1-score': 0.23067222815016006, 'support': 6885}, '1': {'precision': 0.3272874932322685, 'recall': 0.181123595505618, 'f1-score': 0.23319510078117464, 'support': 6675}, '2': {'precision': 0.34664891256102975, 'recall': 0.6622385528547202, 'f1-score': 0.45508400505001456, 'support': 7076}, 'accuracy': 0.34328358208955223, 'macro avg': {'precision': 0.3403970262301648, 'recall': 0.3386854704168932, 'f1-score': 0.3063171113271164, 'support': 20636}, 'weighted avg': {'precision': 0.3405882993557101, 'recall': 0.34328358208955223, 'f1-score': 0.30843816671167357, 'support': 20636}}
[[1189 1216 4480]
 [1114 1209 4352]
 [1121 1269 4686]]
training model: results/LILAK/W6/deepOF_L1/h1000
Epoch 1/50
211/211 - 6s - loss: 3.3264 - accuracy1000: 0.3540 - val_loss: 3.3423 - val_accuracy1000: 0.3295 - 6s/epoch - 31ms/step
Epoch 2/50
211/211 - 4s - loss: 3.3095 - accuracy1000: 0.3588 - val_loss: 3.3387 - val_accuracy1000: 0.3223 - 4s/epoch - 20ms/step
Epoch 3/50
211/211 - 4s - loss: 3.3032 - accuracy1000: 0.3579 - val_loss: 3.3352 - val_accuracy1000: 0.3247 - 4s/epoch - 21ms/step
Epoch 4/50
211/211 - 4s - loss: 3.2977 - accuracy1000: 0.3608 - val_loss: 3.3251 - val_accuracy1000: 0.3247 - 4s/epoch - 20ms/step
Epoch 5/50
211/211 - 4s - loss: 3.2944 - accuracy1000: 0.3632 - val_loss: 3.3260 - val_accuracy1000: 0.3266 - 4s/epoch - 21ms/step
Epoch 6/50
211/211 - 4s - loss: 3.2905 - accuracy1000: 0.3678 - val_loss: 3.3203 - val_accuracy1000: 0.3289 - 4s/epoch - 21ms/step
Epoch 7/50
211/211 - 4s - loss: 3.2883 - accuracy1000: 0.3678 - val_loss: 3.3197 - val_accuracy1000: 0.3278 - 4s/epoch - 21ms/step
Epoch 8/50
211/211 - 4s - loss: 3.2880 - accuracy1000: 0.3643 - val_loss: 3.3196 - val_accuracy1000: 0.3264 - 4s/epoch - 21ms/step
Epoch 9/50
211/211 - 4s - loss: 3.2856 - accuracy1000: 0.3657 - val_loss: 3.3188 - val_accuracy1000: 0.3268 - 4s/epoch - 21ms/step
Epoch 10/50
211/211 - 4s - loss: 3.2840 - accuracy1000: 0.3682 - val_loss: 3.3176 - val_accuracy1000: 0.3285 - 4s/epoch - 21ms/step
Epoch 11/50
211/211 - 5s - loss: 3.2821 - accuracy1000: 0.3688 - val_loss: 3.3173 - val_accuracy1000: 0.3268 - 5s/epoch - 21ms/step
Epoch 12/50
211/211 - 4s - loss: 3.2816 - accuracy1000: 0.3717 - val_loss: 3.3179 - val_accuracy1000: 0.3252 - 4s/epoch - 21ms/step
Epoch 13/50
211/211 - 5s - loss: 3.2797 - accuracy1000: 0.3741 - val_loss: 3.3154 - val_accuracy1000: 0.3266 - 5s/epoch - 21ms/step
Epoch 14/50
211/211 - 4s - loss: 3.2786 - accuracy1000: 0.3738 - val_loss: 3.3173 - val_accuracy1000: 0.3250 - 4s/epoch - 21ms/step
Epoch 15/50
211/211 - 4s - loss: 3.2779 - accuracy1000: 0.3741 - val_loss: 3.3177 - val_accuracy1000: 0.3256 - 4s/epoch - 20ms/step
Epoch 16/50
211/211 - 4s - loss: 3.2774 - accuracy1000: 0.3764 - val_loss: 3.3171 - val_accuracy1000: 0.3259 - 4s/epoch - 20ms/step
Epoch 17/50
211/211 - 5s - loss: 3.2774 - accuracy1000: 0.3737 - val_loss: 3.3188 - val_accuracy1000: 0.3288 - 5s/epoch - 21ms/step
Epoch 18/50
211/211 - 4s - loss: 3.2764 - accuracy1000: 0.3717 - val_loss: 3.3213 - val_accuracy1000: 0.3253 - 4s/epoch - 20ms/step
Epoch 19/50
211/211 - 4s - loss: 3.2743 - accuracy1000: 0.3756 - val_loss: 3.3215 - val_accuracy1000: 0.3256 - 4s/epoch - 21ms/step
Epoch 20/50
211/211 - 4s - loss: 3.2747 - accuracy1000: 0.3756 - val_loss: 3.3159 - val_accuracy1000: 0.3282 - 4s/epoch - 21ms/step
Epoch 21/50
211/211 - 4s - loss: 3.2715 - accuracy1000: 0.3785 - val_loss: 3.3158 - val_accuracy1000: 0.3285 - 4s/epoch - 21ms/step
Epoch 22/50
211/211 - 4s - loss: 3.2701 - accuracy1000: 0.3757 - val_loss: 3.3212 - val_accuracy1000: 0.3239 - 4s/epoch - 20ms/step
Epoch 23/50
211/211 - 4s - loss: 3.2695 - accuracy1000: 0.3785 - val_loss: 3.3203 - val_accuracy1000: 0.3263 - 4s/epoch - 21ms/step
testing model: results/LILAK/W6/deepOF_L1/h1000
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981209
{'0': {'precision': 0.29251183725960134, 'recall': 0.061714539422567, 'f1-score': 0.10192483959670029, 'support': 81083}, '1': {'precision': 0.3259136556579356, 'recall': 0.07165945822900069, 'f1-score': 0.11748679766369967, 'support': 87860}, '2': {'precision': 0.37858479267975637, 'recall': 0.8698675075157415, 'f1-score': 0.5275629832876029, 'support': 102119}, 'accuracy': 0.3693988829123964, 'macro avg': {'precision': 0.33233676186576444, 'recall': 0.3344138350557697, 'f1-score': 0.2489915401826676, 'support': 271062}, 'weighted avg': {'precision': 0.33576529181622844, 'recall': 0.3693988829123964, 'f1-score': 0.2673224801045466, 'support': 271062}}
[[ 5004  5861 70218]
 [ 5975  6296 75589]
 [ 6128  7161 88830]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1074014
{'0': {'precision': 0.3942598187311178, 'recall': 0.05626515763945028, 'f1-score': 0.09847663066547187, 'support': 18555}, '1': {'precision': 0.37220956719817766, 'recall': 0.04474750794172418, 'f1-score': 0.07989048061409083, 'support': 18258}, '2': {'precision': 0.32136167440345303, 'recall': 0.9205645631634201, 'f1-score': 0.47641181974585733, 'support': 17146}, 'accuracy': 0.3270075427639504, 'macro avg': {'precision': 0.3626103534442495, 'recall': 0.34052574291486487, 'f1-score': 0.21825964367514003, 'support': 53959}, 'weighted avg': {'precision': 0.36363462042998995, 'recall': 0.3270075427639504, 'f1-score': 0.21228027462355437, 'support': 53959}}
[[ 1044   771 16740]
 [  849   817 16592]
 [  755   607 15784]]
Evaluating performance on  val set...
81/81 - 1s - 758ms/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1084019
{'0': {'precision': 0.3390804597701149, 'recall': 0.05230496453900709, 'f1-score': 0.09062980030721966, 'support': 6768}, '1': {'precision': 0.36472945891783565, 'recall': 0.05082379223680536, 'f1-score': 0.08921568627450979, 'support': 7162}, '2': {'precision': 0.32628804990857263, 'recall': 0.9047121980316135, 'f1-score': 0.479604743083004, 'support': 6706}, 'accuracy': 0.3287943399883698, 'macro avg': {'precision': 0.34336598953217434, 'recall': 0.3359469849358086, 'f1-score': 0.21981674322157782, 'support': 20636}, 'weighted avg': {'precision': 0.3438251889504053, 'recall': 0.3287943399883698, 'f1-score': 0.21654267497053334, 'support': 20636}}
[[ 354  331 6083]
 [ 354  364 6444]
 [ 336  303 6067]]
training model: results/LILAK/W6/deepLOB_L2/h10
Epoch 1/50
211/211 - 13s - loss: 3.3556 - accuracy10: 0.3442 - val_loss: 3.4203 - val_accuracy10: 0.3865 - 13s/epoch - 60ms/step
Epoch 2/50
211/211 - 10s - loss: 3.3115 - accuracy10: 0.3613 - val_loss: 3.4116 - val_accuracy10: 0.3836 - 10s/epoch - 48ms/step
Epoch 3/50
211/211 - 10s - loss: 3.2928 - accuracy10: 0.3711 - val_loss: 3.3645 - val_accuracy10: 0.3644 - 10s/epoch - 47ms/step
Epoch 4/50
211/211 - 10s - loss: 3.2631 - accuracy10: 0.3910 - val_loss: 3.3582 - val_accuracy10: 0.3955 - 10s/epoch - 48ms/step
Epoch 5/50
211/211 - 10s - loss: 3.2470 - accuracy10: 0.4065 - val_loss: 3.3417 - val_accuracy10: 0.4008 - 10s/epoch - 47ms/step
Epoch 6/50
211/211 - 10s - loss: 3.2280 - accuracy10: 0.4121 - val_loss: 3.3331 - val_accuracy10: 0.3988 - 10s/epoch - 47ms/step
Epoch 7/50
211/211 - 10s - loss: 3.2086 - accuracy10: 0.4192 - val_loss: 3.3230 - val_accuracy10: 0.3904 - 10s/epoch - 48ms/step
Epoch 8/50
211/211 - 10s - loss: 3.1900 - accuracy10: 0.4295 - val_loss: 3.3031 - val_accuracy10: 0.4011 - 10s/epoch - 48ms/step
Epoch 9/50
211/211 - 10s - loss: 3.1695 - accuracy10: 0.4359 - val_loss: 3.2947 - val_accuracy10: 0.4215 - 10s/epoch - 46ms/step
Epoch 10/50
211/211 - 10s - loss: 3.1612 - accuracy10: 0.4395 - val_loss: 3.3004 - val_accuracy10: 0.4090 - 10s/epoch - 46ms/step
Epoch 11/50
211/211 - 10s - loss: 3.1411 - accuracy10: 0.4487 - val_loss: 3.2888 - val_accuracy10: 0.3972 - 10s/epoch - 47ms/step
Epoch 12/50
211/211 - 10s - loss: 3.1223 - accuracy10: 0.4528 - val_loss: 3.3464 - val_accuracy10: 0.4088 - 10s/epoch - 47ms/step
Epoch 13/50
211/211 - 10s - loss: 3.1164 - accuracy10: 0.4564 - val_loss: 3.3656 - val_accuracy10: 0.3933 - 10s/epoch - 48ms/step
Epoch 14/50
211/211 - 10s - loss: 3.0934 - accuracy10: 0.4622 - val_loss: 3.3691 - val_accuracy10: 0.4011 - 10s/epoch - 47ms/step
Epoch 15/50
211/211 - 10s - loss: 3.0846 - accuracy10: 0.4667 - val_loss: 3.3635 - val_accuracy10: 0.4044 - 10s/epoch - 46ms/step
Epoch 16/50
211/211 - 10s - loss: 3.0675 - accuracy10: 0.4724 - val_loss: 3.4046 - val_accuracy10: 0.3950 - 10s/epoch - 46ms/step
Epoch 17/50
211/211 - 10s - loss: 3.0569 - accuracy10: 0.4769 - val_loss: 3.4066 - val_accuracy10: 0.4089 - 10s/epoch - 47ms/step
Epoch 18/50
211/211 - 10s - loss: 3.0524 - accuracy10: 0.4775 - val_loss: 3.3754 - val_accuracy10: 0.3988 - 10s/epoch - 47ms/step
Epoch 19/50
211/211 - 10s - loss: 3.0262 - accuracy10: 0.4842 - val_loss: 3.4180 - val_accuracy10: 0.4002 - 10s/epoch - 47ms/step
Epoch 20/50
211/211 - 10s - loss: 3.0178 - accuracy10: 0.4881 - val_loss: 3.4257 - val_accuracy10: 0.4033 - 10s/epoch - 47ms/step
Epoch 21/50
211/211 - 10s - loss: 3.0108 - accuracy10: 0.4900 - val_loss: 3.4408 - val_accuracy10: 0.3983 - 10s/epoch - 48ms/step
testing model: results/LILAK/W6/deepLOB_L2/h10
Evaluating performance on  test set...
1059/1059 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.11257
{'0': {'precision': 0.39370114116272803, 'recall': 0.21176897051715804, 'f1-score': 0.27540148967597977, 'support': 82760}, '1': {'precision': 0.40704084547272207, 'recall': 0.28333548727023294, 'f1-score': 0.33410506942694196, 'support': 100591}, '2': {'precision': 0.36203052430508975, 'recall': 0.6460508915135209, 'f1-score': 0.46403026444541795, 'support': 87716}, 'accuracy': 0.3788583634304434, 'macro avg': {'precision': 0.38759083698018, 'recall': 0.3803851164336373, 'f1-score': 0.3578456078494465, 'support': 271067}, 'weighted avg': {'precision': 0.3884029468711397, 'recall': 0.3788583634304434, 'f1-score': 0.3582253428134147, 'support': 271067}}
[[17526 21132 44102]
 [16330 28501 55760]
 [10660 20387 56669]]
Evaluating performance on  train set...
211/211 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0540498
{'0': {'precision': 0.38245315161839866, 'recall': 0.32283155761814497, 'f1-score': 0.3501222840534505, 'support': 15299}, '1': {'precision': 0.5230739375121288, 'recall': 0.5574536730641959, 'f1-score': 0.5397168659017642, 'support': 24176}, '2': {'precision': 0.3702879581151832, 'recall': 0.39063794531897267, 'f1-score': 0.3801908345652466, 'support': 14484}, 'accuracy': 0.4461535610370837, 'macro avg': {'precision': 0.4252716824152369, 'recall': 0.4236410586671045, 'f1-score': 0.4233433281734871, 'support': 53959}, 'weighted avg': {'precision': 0.4421919803043685, 'recall': 0.4461535610370837, 'f1-score': 0.44314015866894907, 'support': 53959}}
[[ 4939  6522  3838]
 [ 4915 13477  5784]
 [ 3060  5766  5658]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0863583
{'0': {'precision': 0.37458563535911604, 'recall': 0.23435879709643967, 'f1-score': 0.288326600042526, 'support': 5786}, '1': {'precision': 0.4959976713724349, 'recall': 0.3769911504424779, 'f1-score': 0.4283828797687135, 'support': 9040}, '2': {'precision': 0.34131677508377684, 'recall': 0.5959387368783342, 'f1-score': 0.43404148649495516, 'support': 5811}, 'accuracy': 0.3986529049764985, 'macro avg': {'precision': 0.4039666939384426, 'recall': 0.4024295614724173, 'f1-score': 0.3835836554353982, 'support': 20637}, 'weighted avg': {'precision': 0.4184020553087408, 'recall': 0.3986529049764985, 'f1-score': 0.39070863104993026, 'support': 20637}}
[[1356 1833 2597]
 [1546 3408 4086]
 [ 718 1630 3463]]
training model: results/LILAK/W6/deepLOB_L2/h20
Epoch 1/50
211/211 - 13s - loss: 3.3538 - accuracy20: 0.3484 - val_loss: 3.3833 - val_accuracy20: 0.3422 - 13s/epoch - 60ms/step
Epoch 2/50
211/211 - 10s - loss: 3.3136 - accuracy20: 0.3583 - val_loss: 3.4004 - val_accuracy20: 0.3357 - 10s/epoch - 48ms/step
Epoch 3/50
211/211 - 10s - loss: 3.2897 - accuracy20: 0.3701 - val_loss: 3.3680 - val_accuracy20: 0.3420 - 10s/epoch - 49ms/step
Epoch 4/50
211/211 - 10s - loss: 3.2698 - accuracy20: 0.3795 - val_loss: 3.3534 - val_accuracy20: 0.3485 - 10s/epoch - 48ms/step
Epoch 5/50
211/211 - 10s - loss: 3.2451 - accuracy20: 0.3956 - val_loss: 3.3555 - val_accuracy20: 0.3612 - 10s/epoch - 49ms/step
Epoch 6/50
211/211 - 10s - loss: 3.2319 - accuracy20: 0.4030 - val_loss: 3.3839 - val_accuracy20: 0.3605 - 10s/epoch - 49ms/step
Epoch 7/50
211/211 - 10s - loss: 3.2150 - accuracy20: 0.4145 - val_loss: 3.3488 - val_accuracy20: 0.3650 - 10s/epoch - 50ms/step
Epoch 8/50
211/211 - 10s - loss: 3.1996 - accuracy20: 0.4236 - val_loss: 3.3564 - val_accuracy20: 0.3709 - 10s/epoch - 49ms/step
Epoch 9/50
211/211 - 10s - loss: 3.1849 - accuracy20: 0.4297 - val_loss: 3.3991 - val_accuracy20: 0.3681 - 10s/epoch - 48ms/step
Epoch 10/50
211/211 - 10s - loss: 3.1699 - accuracy20: 0.4375 - val_loss: 3.3781 - val_accuracy20: 0.3720 - 10s/epoch - 48ms/step
Epoch 11/50
211/211 - 10s - loss: 3.1516 - accuracy20: 0.4447 - val_loss: 3.4109 - val_accuracy20: 0.3753 - 10s/epoch - 48ms/step
Epoch 12/50
211/211 - 10s - loss: 3.1388 - accuracy20: 0.4486 - val_loss: 3.3781 - val_accuracy20: 0.3803 - 10s/epoch - 47ms/step
Epoch 13/50
211/211 - 10s - loss: 3.1218 - accuracy20: 0.4554 - val_loss: 3.4021 - val_accuracy20: 0.3793 - 10s/epoch - 47ms/step
Epoch 14/50
211/211 - 10s - loss: 3.1093 - accuracy20: 0.4595 - val_loss: 3.3956 - val_accuracy20: 0.3802 - 10s/epoch - 48ms/step
Epoch 15/50
211/211 - 10s - loss: 3.0954 - accuracy20: 0.4659 - val_loss: 3.3937 - val_accuracy20: 0.3784 - 10s/epoch - 48ms/step
Epoch 16/50
211/211 - 10s - loss: 3.0805 - accuracy20: 0.4693 - val_loss: 3.4091 - val_accuracy20: 0.3811 - 10s/epoch - 47ms/step
Epoch 17/50
211/211 - 10s - loss: 3.0664 - accuracy20: 0.4747 - val_loss: 3.3930 - val_accuracy20: 0.3791 - 10s/epoch - 47ms/step
testing model: results/LILAK/W6/deepLOB_L2/h20
Evaluating performance on  test set...
1059/1059 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1501902
{'0': {'precision': 0.3849117825998783, 'recall': 0.13739400206825234, 'f1-score': 0.202504248687289, 'support': 96700}, '1': {'precision': 0.27053787334161167, 'recall': 0.6916072621964803, 'f1-score': 0.38893499741618254, 'support': 71824}, '2': {'precision': 0.41960406513279686, 'recall': 0.21662131983655636, 'f1-score': 0.28573266186865276, 'support': 102543}, 'accuracy': 0.31421382905333367, 'macro avg': {'precision': 0.35835124035809557, 'recall': 0.34854086136709633, 'f1-score': 0.2923906359907081, 'support': 271067}, 'weighted avg': {'precision': 0.36773027053536045, 'recall': 0.31421382905333367, 'f1-score': 0.283387178994411, 'support': 271067}}
[[13286 65881 17533]
 [ 8958 49674 13192]
 [12273 68057 22213]]
Evaluating performance on  train set...
211/211 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1024929
{'0': {'precision': 0.39920948616600793, 'recall': 0.20952069003166285, 'f1-score': 0.2748102534727195, 'support': 18318}, '1': {'precision': 0.374337889395118, 'recall': 0.5488215488215489, 'f1-score': 0.4450903965999428, 'support': 18414}, '2': {'precision': 0.353643071247406, 'recall': 0.3561270099262785, 'f1-score': 0.354880694143167, 'support': 17227}, 'accuracy': 0.3721158657499212, 'macro avg': {'precision': 0.37573014893617734, 'recall': 0.37148974959316344, 'f1-score': 0.3582604480719431, 'support': 53959}, 'weighted avg': {'precision': 0.37617425177059804, 'recall': 0.3721158657499212, 'f1-score': 0.3584832651477781, 'support': 53959}}
[[ 3838  8753  5727]
 [ 2822 10106  5486]
 [ 2954  8138  6135]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1147329
{'0': {'precision': 0.3709025594970813, 'recall': 0.11784848052503924, 'f1-score': 0.17886530965786054, 'support': 7009}, '1': {'precision': 0.34405518524259804, 'recall': 0.6614513485322605, 'f1-score': 0.45265895069596696, 'support': 6711}, '2': {'precision': 0.39306463326071167, 'recall': 0.3129969640017349, 'f1-score': 0.3484909456740443, 'support': 6917}, 'accuracy': 0.36003295052575474, 'macro avg': {'precision': 0.36934079266679704, 'recall': 0.3640989310196782, 'f1-score': 0.3266717353426239, 'support': 20637}, 'weighted avg': {'precision': 0.3696001577720822, 'recall': 0.36003295052575474, 'f1-score': 0.3247551991442527, 'support': 20637}}
[[ 826 4401 1782]
 [ 711 4439 1561]
 [ 690 4062 2165]]
training model: results/LILAK/W6/deepLOB_L2/h30
Epoch 1/50
211/211 - 12s - loss: 3.3601 - accuracy30: 0.3425 - val_loss: 3.4506 - val_accuracy30: 0.3361 - 12s/epoch - 57ms/step
Epoch 2/50
211/211 - 10s - loss: 3.3172 - accuracy30: 0.3575 - val_loss: 3.3672 - val_accuracy30: 0.3375 - 10s/epoch - 47ms/step
Epoch 3/50
211/211 - 10s - loss: 3.2898 - accuracy30: 0.3702 - val_loss: 3.3477 - val_accuracy30: 0.3380 - 10s/epoch - 49ms/step
Epoch 4/50
211/211 - 10s - loss: 3.2724 - accuracy30: 0.3814 - val_loss: 3.3258 - val_accuracy30: 0.3487 - 10s/epoch - 49ms/step
Epoch 5/50
211/211 - 10s - loss: 3.2552 - accuracy30: 0.3940 - val_loss: 3.3199 - val_accuracy30: 0.3592 - 10s/epoch - 49ms/step
Epoch 6/50
211/211 - 10s - loss: 3.2405 - accuracy30: 0.3986 - val_loss: 3.3581 - val_accuracy30: 0.3516 - 10s/epoch - 47ms/step
Epoch 7/50
211/211 - 10s - loss: 3.2217 - accuracy30: 0.4108 - val_loss: 3.3250 - val_accuracy30: 0.3609 - 10s/epoch - 47ms/step
Epoch 8/50
211/211 - 10s - loss: 3.2072 - accuracy30: 0.4195 - val_loss: 3.3547 - val_accuracy30: 0.3641 - 10s/epoch - 47ms/step
Epoch 9/50
211/211 - 10s - loss: 3.1971 - accuracy30: 0.4232 - val_loss: 3.3189 - val_accuracy30: 0.3695 - 10s/epoch - 48ms/step
Epoch 10/50
211/211 - 10s - loss: 3.1858 - accuracy30: 0.4285 - val_loss: 3.3408 - val_accuracy30: 0.3690 - 10s/epoch - 46ms/step
Epoch 11/50
211/211 - 10s - loss: 3.1668 - accuracy30: 0.4375 - val_loss: 3.3466 - val_accuracy30: 0.3680 - 10s/epoch - 46ms/step
Epoch 12/50
211/211 - 10s - loss: 3.1543 - accuracy30: 0.4427 - val_loss: 3.3384 - val_accuracy30: 0.3803 - 10s/epoch - 46ms/step
Epoch 13/50
211/211 - 10s - loss: 3.1476 - accuracy30: 0.4450 - val_loss: 3.3319 - val_accuracy30: 0.3855 - 10s/epoch - 46ms/step
Epoch 14/50
211/211 - 10s - loss: 3.1337 - accuracy30: 0.4506 - val_loss: 3.3363 - val_accuracy30: 0.3822 - 10s/epoch - 47ms/step
Epoch 15/50
211/211 - 10s - loss: 3.1194 - accuracy30: 0.4561 - val_loss: 3.3569 - val_accuracy30: 0.3825 - 10s/epoch - 47ms/step
Epoch 16/50
211/211 - 10s - loss: 3.1044 - accuracy30: 0.4591 - val_loss: 3.3501 - val_accuracy30: 0.3846 - 10s/epoch - 46ms/step
Epoch 17/50
211/211 - 10s - loss: 3.0941 - accuracy30: 0.4657 - val_loss: 3.3706 - val_accuracy30: 0.3805 - 10s/epoch - 46ms/step
Epoch 18/50
211/211 - 10s - loss: 3.0851 - accuracy30: 0.4679 - val_loss: 3.3902 - val_accuracy30: 0.3803 - 10s/epoch - 48ms/step
Epoch 19/50
211/211 - 10s - loss: 3.0713 - accuracy30: 0.4752 - val_loss: 3.4031 - val_accuracy30: 0.3789 - 10s/epoch - 48ms/step
testing model: results/LILAK/W6/deepLOB_L2/h30
Evaluating performance on  test set...
1059/1059 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1194041
{'0': {'precision': 0.4167184663964793, 'recall': 0.17743711357669179, 'f1-score': 0.2488954891405235, 'support': 94456}, '1': {'precision': 0.3025144538332592, 'recall': 0.5817478487408226, 'f1-score': 0.3980428255693046, 'support': 76002}, '2': {'precision': 0.41466236879080914, 'recall': 0.34906419902791996, 'f1-score': 0.37904609772155723, 'support': 100609}, 'accuracy': 0.3544990721851055, 'macro avg': {'precision': 0.37796509634018255, 'recall': 0.3694163871151448, 'f1-score': 0.3419948041437951, 'support': 271067}, 'weighted avg': {'precision': 0.38393470707926725, 'recall': 0.3544990721851055, 'f1-score': 0.3390201389207972, 'support': 271067}}
[[16760 49681 28015]
 [10229 44214 21559]
 [13230 52260 35119]]
Evaluating performance on  train set...
211/211 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0937217
{'0': {'precision': 0.41935176358436604, 'recall': 0.23704062937816575, 'f1-score': 0.302877995042688, 'support': 18558}, '1': {'precision': 0.3864984543403793, 'recall': 0.5191336550331052, 'f1-score': 0.44310344827586207, 'support': 17822}, '2': {'precision': 0.3847729250934412, 'recall': 0.42749872006371237, 'f1-score': 0.4050121261115602, 'support': 17579}, 'accuracy': 0.3922607906002706, 'macro avg': {'precision': 0.3968743810060622, 'recall': 0.39455766815832777, 'f1-score': 0.38366452314337013, 'support': 53959}, 'weighted avg': {'precision': 0.39723547011750604, 'recall': 0.3922607906002706, 'f1-score': 0.3824664588315153, 'support': 53959}}
[[4399 7841 6318]
 [2872 9252 5698]
 [3219 6845 7515]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1105269
{'0': {'precision': 0.40813986815706504, 'recall': 0.1988549085323279, 'f1-score': 0.26741784037558686, 'support': 7161}, '1': {'precision': 0.335244161358811, 'recall': 0.4844301273201411, 'f1-score': 0.39626074408683104, 'support': 6519}, '2': {'precision': 0.39544513457556935, 'recall': 0.4392698002012362, 'f1-score': 0.41620701395982296, 'support': 6957}, 'accuracy': 0.370111934874255, 'macro avg': {'precision': 0.37960972136381516, 'recall': 0.3741849453512351, 'f1-score': 0.35996186614074693, 'support': 20637}, 'weighted avg': {'precision': 0.38083336168111, 'recall': 0.370111934874255, 'f1-score': 0.35827664591510966, 'support': 20637}}
[[1424 3324 2413]
 [1102 3158 2259]
 [ 963 2938 3056]]
training model: results/LILAK/W6/deepLOB_L2/h50
Epoch 1/50
211/211 - 12s - loss: 3.3559 - accuracy50: 0.3429 - val_loss: 3.4042 - val_accuracy50: 0.3370 - 12s/epoch - 57ms/step
Epoch 2/50
211/211 - 10s - loss: 3.3247 - accuracy50: 0.3463 - val_loss: 3.3513 - val_accuracy50: 0.3408 - 10s/epoch - 48ms/step
Epoch 3/50
211/211 - 10s - loss: 3.3032 - accuracy50: 0.3540 - val_loss: 3.3207 - val_accuracy50: 0.3438 - 10s/epoch - 48ms/step
Epoch 4/50
211/211 - 10s - loss: 3.2918 - accuracy50: 0.3635 - val_loss: 3.3170 - val_accuracy50: 0.3437 - 10s/epoch - 48ms/step
Epoch 5/50
211/211 - 10s - loss: 3.2754 - accuracy50: 0.3773 - val_loss: 3.3003 - val_accuracy50: 0.3587 - 10s/epoch - 49ms/step
Epoch 6/50
211/211 - 10s - loss: 3.2651 - accuracy50: 0.3856 - val_loss: 3.2989 - val_accuracy50: 0.3642 - 10s/epoch - 47ms/step
Epoch 7/50
211/211 - 10s - loss: 3.2544 - accuracy50: 0.3925 - val_loss: 3.2970 - val_accuracy50: 0.3717 - 10s/epoch - 47ms/step
Epoch 8/50
211/211 - 10s - loss: 3.2439 - accuracy50: 0.3984 - val_loss: 3.3057 - val_accuracy50: 0.3687 - 10s/epoch - 47ms/step
Epoch 9/50
211/211 - 10s - loss: 3.2333 - accuracy50: 0.4058 - val_loss: 3.3149 - val_accuracy50: 0.3702 - 10s/epoch - 48ms/step
Epoch 10/50
211/211 - 10s - loss: 3.2218 - accuracy50: 0.4119 - val_loss: 3.3103 - val_accuracy50: 0.3798 - 10s/epoch - 47ms/step
Epoch 11/50
211/211 - 10s - loss: 3.2083 - accuracy50: 0.4205 - val_loss: 3.3497 - val_accuracy50: 0.3636 - 10s/epoch - 49ms/step
Epoch 12/50
211/211 - 10s - loss: 3.1985 - accuracy50: 0.4253 - val_loss: 3.3460 - val_accuracy50: 0.3670 - 10s/epoch - 47ms/step
Epoch 13/50
211/211 - 10s - loss: 3.1866 - accuracy50: 0.4305 - val_loss: 3.3618 - val_accuracy50: 0.3670 - 10s/epoch - 47ms/step
Epoch 14/50
211/211 - 10s - loss: 3.1738 - accuracy50: 0.4362 - val_loss: 3.3642 - val_accuracy50: 0.3676 - 10s/epoch - 47ms/step
Epoch 15/50
211/211 - 10s - loss: 3.1577 - accuracy50: 0.4443 - val_loss: 3.3863 - val_accuracy50: 0.3669 - 10s/epoch - 47ms/step
Epoch 16/50
211/211 - 10s - loss: 3.1474 - accuracy50: 0.4461 - val_loss: 3.3828 - val_accuracy50: 0.3725 - 10s/epoch - 47ms/step
Epoch 17/50
211/211 - 10s - loss: 3.1321 - accuracy50: 0.4555 - val_loss: 3.3970 - val_accuracy50: 0.3697 - 10s/epoch - 48ms/step
testing model: results/LILAK/W6/deepLOB_L2/h50
Evaluating performance on  test set...
1059/1059 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1106157
{'0': {'precision': 0.3621900135695884, 'recall': 0.20173949239245928, 'f1-score': 0.25913887716336004, 'support': 91291}, '1': {'precision': 0.321709016652281, 'recall': 0.3753146758685054, 'f1-score': 0.34645053419106187, 'support': 81433}, '2': {'precision': 0.38237126245847175, 'recall': 0.48685722420507815, 'f1-score': 0.42833435468936615, 'support': 98343}, 'accuracy': 0.35732494180405583, 'macro avg': {'precision': 0.355423430893447, 'recall': 0.35463713082201426, 'f1-score': 0.3446412553479294, 'support': 271067}, 'weighted avg': {'precision': 0.3573506031563413, 'recall': 0.35732494180405583, 'f1-score': 0.3467527918526319, 'support': 271067}}
[[18417 31424 41450]
 [14983 30563 35887]
 [17449 33015 47879]]
Evaluating performance on  train set...
211/211 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0960696
{'0': {'precision': 0.39052095573834705, 'recall': 0.2157775132561411, 'f1-score': 0.27796751934202274, 'support': 18482}, '1': {'precision': 0.3832190598332758, 'recall': 0.43332031903619833, 'f1-score': 0.40673263179938224, 'support': 17929}, '2': {'precision': 0.3592059299650677, 'recall': 0.4805105994985184, 'f1-score': 0.41109648481302713, 'support': 17548}, 'accuracy': 0.3741544506013825, 'macro avg': {'precision': 0.3776486485122302, 'recall': 0.37653614393028595, 'f1-score': 0.3652655453181441, 'support': 53959}, 'weighted avg': {'precision': 0.37791079313430453, 'recall': 0.3741544506013825, 'f1-score': 0.36404726113362723, 'support': 53959}}
[[3988 6613 7881]
 [2999 7769 7161]
 [3225 5891 8432]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0995921
{'0': {'precision': 0.39671069025666583, 'recall': 0.22049861495844875, 'f1-score': 0.2834505474939909, 'support': 7220}, '1': {'precision': 0.34797759800871186, 'recall': 0.43328684332868433, 'f1-score': 0.38597459966869135, 'support': 6453}, '2': {'precision': 0.37769239725229947, 'recall': 0.4658242389431361, 'f1-score': 0.41715424676911206, 'support': 6964}, 'accuracy': 0.36982119494112514, 'macro avg': {'precision': 0.3741268951725591, 'recall': 0.37320323241008974, 'f1-score': 0.3621931313105981, 'support': 20637}, 'weighted avg': {'precision': 0.37505453690305557, 'recall': 0.36982119494112514, 'f1-score': 0.3606274758476899, 'support': 20637}}
[[1592 2809 2819]
 [1131 2796 2526]
 [1290 2430 3244]]
training model: results/LILAK/W6/deepLOB_L2/h100
Epoch 1/50
211/211 - 12s - loss: 3.3508 - accuracy100: 0.3500 - val_loss: 3.4066 - val_accuracy100: 0.3465 - 12s/epoch - 58ms/step
Epoch 2/50
211/211 - 10s - loss: 3.3162 - accuracy100: 0.3568 - val_loss: 3.4075 - val_accuracy100: 0.3462 - 10s/epoch - 48ms/step
Epoch 3/50
211/211 - 10s - loss: 3.2985 - accuracy100: 0.3675 - val_loss: 3.3628 - val_accuracy100: 0.3535 - 10s/epoch - 48ms/step
Epoch 4/50
211/211 - 10s - loss: 3.2860 - accuracy100: 0.3746 - val_loss: 3.3971 - val_accuracy100: 0.3485 - 10s/epoch - 47ms/step
Epoch 5/50
211/211 - 10s - loss: 3.2699 - accuracy100: 0.3812 - val_loss: 3.3718 - val_accuracy100: 0.3610 - 10s/epoch - 48ms/step
Epoch 6/50
211/211 - 10s - loss: 3.2563 - accuracy100: 0.3913 - val_loss: 3.3749 - val_accuracy100: 0.3643 - 10s/epoch - 47ms/step
Epoch 7/50
211/211 - 10s - loss: 3.2437 - accuracy100: 0.3995 - val_loss: 3.3631 - val_accuracy100: 0.3671 - 10s/epoch - 47ms/step
Epoch 8/50
211/211 - 10s - loss: 3.2354 - accuracy100: 0.4068 - val_loss: 3.3592 - val_accuracy100: 0.3646 - 10s/epoch - 47ms/step
Epoch 9/50
211/211 - 10s - loss: 3.2173 - accuracy100: 0.4158 - val_loss: 3.3441 - val_accuracy100: 0.3713 - 10s/epoch - 48ms/step
Epoch 10/50
211/211 - 10s - loss: 3.2057 - accuracy100: 0.4182 - val_loss: 3.3421 - val_accuracy100: 0.3728 - 10s/epoch - 47ms/step
Epoch 11/50
211/211 - 10s - loss: 3.1949 - accuracy100: 0.4242 - val_loss: 3.3556 - val_accuracy100: 0.3717 - 10s/epoch - 47ms/step
Epoch 12/50
211/211 - 10s - loss: 3.1805 - accuracy100: 0.4336 - val_loss: 3.3611 - val_accuracy100: 0.3668 - 10s/epoch - 47ms/step
Epoch 13/50
211/211 - 10s - loss: 3.1639 - accuracy100: 0.4419 - val_loss: 3.3880 - val_accuracy100: 0.3664 - 10s/epoch - 47ms/step
Epoch 14/50
211/211 - 10s - loss: 3.1526 - accuracy100: 0.4461 - val_loss: 3.3921 - val_accuracy100: 0.3716 - 10s/epoch - 48ms/step
Epoch 15/50
211/211 - 10s - loss: 3.1364 - accuracy100: 0.4521 - val_loss: 3.4106 - val_accuracy100: 0.3762 - 10s/epoch - 47ms/step
Epoch 16/50
211/211 - 10s - loss: 3.1213 - accuracy100: 0.4573 - val_loss: 3.4205 - val_accuracy100: 0.3734 - 10s/epoch - 47ms/step
Epoch 17/50
211/211 - 10s - loss: 3.1067 - accuracy100: 0.4655 - val_loss: 3.4375 - val_accuracy100: 0.3710 - 10s/epoch - 47ms/step
Epoch 18/50
211/211 - 10s - loss: 3.0838 - accuracy100: 0.4713 - val_loss: 3.4567 - val_accuracy100: 0.3675 - 10s/epoch - 47ms/step
Epoch 19/50
211/211 - 10s - loss: 3.0736 - accuracy100: 0.4767 - val_loss: 3.4450 - val_accuracy100: 0.3620 - 10s/epoch - 47ms/step
Epoch 20/50
211/211 - 10s - loss: 3.0613 - accuracy100: 0.4794 - val_loss: 3.4961 - val_accuracy100: 0.3603 - 10s/epoch - 47ms/step
testing model: results/LILAK/W6/deepLOB_L2/h100
Evaluating performance on  test set...
1059/1059 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1760243
{'0': {'precision': 0.3319441902375153, 'recall': 0.2760772833723653, 'f1-score': 0.3014441240962238, 'support': 85400}, '1': {'precision': 0.3379360957434797, 'recall': 0.6624540746314904, 'f1-score': 0.44755966265925, 'support': 90364}, '2': {'precision': 0.3469868995633188, 'recall': 0.08337617913392023, 'f1-score': 0.1344466722502813, 'support': 95303}, 'accuracy': 0.33713067249056505, 'macro avg': {'precision': 0.3389557285147713, 'recall': 0.340635845712592, 'f1-score': 0.2944834863352517, 'support': 271067}, 'weighted avg': {'precision': 0.3392304621777294, 'recall': 0.33713067249056505, 'f1-score': 0.2914400526800626, 'support': 271067}}
[[23577 54340  7483]
 [23031 59862  7471]
 [24419 62938  7946]]
Evaluating performance on  train set...
211/211 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1007812
{'0': {'precision': 0.37518342431179197, 'recall': 0.34297365455813705, 'f1-score': 0.3583562258227281, 'support': 18637}, '1': {'precision': 0.3995850622406639, 'recall': 0.3873024992818156, 'f1-score': 0.393347921225383, 'support': 17405}, '2': {'precision': 0.3694893277478556, 'recall': 0.4135178880392923, 'f1-score': 0.39026574310621825, 'support': 17917}, 'accuracy': 0.3806964547156174, 'macro avg': {'precision': 0.3814192714334372, 'recall': 0.381264680626415, 'f1-score': 0.3806566300514431, 'support': 53959}, 'weighted avg': {'precision': 0.38116369414659185, 'recall': 0.3806964547156174, 'f1-score': 0.3802386417246444, 'support': 53959}}
[[6392 5043 7202]
 [5223 6741 5441]
 [5422 5086 7409]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1143229
{'0': {'precision': 0.3357677560708417, 'recall': 0.27961076478637675, 'f1-score': 0.3051269288203086, 'support': 6577}, '1': {'precision': 0.3872942977420589, 'recall': 0.5539135194307608, 'f1-score': 0.45585585585585586, 'support': 7308}, '2': {'precision': 0.38700084961767206, 'recall': 0.26984597156398105, 'f1-score': 0.31797556719022685, 'support': 6752}, 'accuracy': 0.3735523574162911, 'macro avg': {'precision': 0.3700209678101909, 'recall': 0.3677900852603728, 'f1-score': 0.3596527839554638, 'support': 20637}, 'weighted avg': {'precision': 0.37077680846030986, 'recall': 0.3735523574162911, 'f1-score': 0.3627070521448939, 'support': 20637}}
[[1839 3250 1488]
 [1862 4048 1398]
 [1776 3154 1822]]
training model: results/LILAK/W6/deepLOB_L2/h200
Epoch 1/50
211/211 - 13s - loss: 3.3582 - accuracy200: 0.3447 - val_loss: 3.3908 - val_accuracy200: 0.3519 - 13s/epoch - 59ms/step
Epoch 2/50
211/211 - 10s - loss: 3.3247 - accuracy200: 0.3525 - val_loss: 3.3625 - val_accuracy200: 0.3392 - 10s/epoch - 48ms/step
Epoch 3/50
211/211 - 10s - loss: 3.2961 - accuracy200: 0.3694 - val_loss: 3.3917 - val_accuracy200: 0.3390 - 10s/epoch - 48ms/step
Epoch 4/50
211/211 - 10s - loss: 3.2838 - accuracy200: 0.3729 - val_loss: 3.3635 - val_accuracy200: 0.3410 - 10s/epoch - 47ms/step
Epoch 5/50
211/211 - 10s - loss: 3.2706 - accuracy200: 0.3854 - val_loss: 3.3724 - val_accuracy200: 0.3408 - 10s/epoch - 46ms/step
Epoch 6/50
211/211 - 10s - loss: 3.2534 - accuracy200: 0.3976 - val_loss: 3.3753 - val_accuracy200: 0.3391 - 10s/epoch - 46ms/step
Epoch 7/50
211/211 - 10s - loss: 3.2351 - accuracy200: 0.4116 - val_loss: 3.3974 - val_accuracy200: 0.3446 - 10s/epoch - 47ms/step
Epoch 8/50
211/211 - 10s - loss: 3.2207 - accuracy200: 0.4176 - val_loss: 3.4047 - val_accuracy200: 0.3454 - 10s/epoch - 49ms/step
Epoch 9/50
211/211 - 10s - loss: 3.2082 - accuracy200: 0.4205 - val_loss: 3.3758 - val_accuracy200: 0.3456 - 10s/epoch - 48ms/step
Epoch 10/50
211/211 - 10s - loss: 3.1921 - accuracy200: 0.4307 - val_loss: 3.3891 - val_accuracy200: 0.3480 - 10s/epoch - 46ms/step
Epoch 11/50
211/211 - 10s - loss: 3.1748 - accuracy200: 0.4415 - val_loss: 3.4089 - val_accuracy200: 0.3460 - 10s/epoch - 47ms/step
Epoch 12/50
211/211 - 10s - loss: 3.1620 - accuracy200: 0.4465 - val_loss: 3.4069 - val_accuracy200: 0.3454 - 10s/epoch - 46ms/step
testing model: results/LILAK/W6/deepLOB_L2/h200
Evaluating performance on  test set...
1059/1059 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1353147
{'0': {'precision': 0.3086656025138521, 'recall': 0.45010724383347955, 'f1-score': 0.36620346730255365, 'support': 82056}, '1': {'precision': 0.3607254814151366, 'recall': 0.2872742148656303, 'f1-score': 0.3198369692156771, 'support': 95334}, '2': {'precision': 0.34249152183128445, 'recall': 0.2759909049179628, 'f1-score': 0.3056660656755239, 'support': 93677}, 'accuracy': 0.3326668314475757, 'macro avg': {'precision': 0.3372942019200911, 'recall': 0.33779078787235756, 'f1-score': 0.33056883406458487, 'support': 271067}, 'weighted avg': {'precision': 0.3386647803520772, 'recall': 0.3326668314475757, 'f1-score': 0.3289755277126015, 'support': 271067}}
[[36934 22298 22824]
 [41137 27387 26810]
 [41586 26237 25854]]
Evaluating performance on  train set...
211/211 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1099352
{'0': {'precision': 0.345368492224476, 'recall': 0.5529933961242828, 'f1-score': 0.4251883297956466, 'support': 18474}, '1': {'precision': 0.34441250449155586, 'recall': 0.2202182653647329, 'f1-score': 0.2686567164179104, 'support': 17410}, '2': {'precision': 0.3655167207669661, 'recall': 0.2678838174273859, 'f1-score': 0.3091756592810166, 'support': 18075}, 'accuracy': 0.35011768194369797, 'macro avg': {'precision': 0.35176590582766604, 'recall': 0.3470318263054672, 'f1-score': 0.3343402351648579, 'support': 53959}, 'weighted avg': {'precision': 0.35180922471535553, 'recall': 0.35011768194369797, 'f1-score': 0.33582150668071997, 'support': 53959}}
[[10216  3749  4509]
 [ 9680  3834  3896]
 [ 9684  3549  4842]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1236061
{'0': {'precision': 0.33644608063212716, 'recall': 0.5330014224751067, 'f1-score': 0.4125061925469257, 'support': 7030}, '1': {'precision': 0.3078779899056397, 'recall': 0.21505211526670753, 'f1-score': 0.2532262431188521, 'support': 6524}, '2': {'precision': 0.3429091644750152, 'recall': 0.23930537907666244, 'f1-score': 0.2818892399800432, 'support': 7083}, 'accuracy': 0.3316858070455977, 'macro avg': {'precision': 0.3290777450042607, 'recall': 0.3291196389394922, 'f1-score': 0.31587389188194037, 'support': 20637}, 'weighted avg': {'precision': 0.3296330651240384, 'recall': 0.3316858070455977, 'f1-score': 0.31732267434660677, 'support': 20637}}
[[3747 1594 1689]
 [3562 1403 1559]
 [3828 1560 1695]]
training model: results/LILAK/W6/deepLOB_L2/h300
Epoch 1/50
211/211 - 12s - loss: 3.3543 - accuracy300: 0.3532 - val_loss: 3.4116 - val_accuracy300: 0.3475 - 12s/epoch - 58ms/step
Epoch 2/50
211/211 - 10s - loss: 3.3081 - accuracy300: 0.3711 - val_loss: 3.4641 - val_accuracy300: 0.3419 - 10s/epoch - 47ms/step
Epoch 3/50
211/211 - 10s - loss: 3.2657 - accuracy300: 0.3930 - val_loss: 3.4279 - val_accuracy300: 0.3434 - 10s/epoch - 48ms/step
Epoch 4/50
211/211 - 10s - loss: 3.2453 - accuracy300: 0.4060 - val_loss: 3.4580 - val_accuracy300: 0.3352 - 10s/epoch - 47ms/step
Epoch 5/50
211/211 - 10s - loss: 3.2248 - accuracy300: 0.4164 - val_loss: 3.4324 - val_accuracy300: 0.3471 - 10s/epoch - 46ms/step
Epoch 6/50
211/211 - 10s - loss: 3.2085 - accuracy300: 0.4243 - val_loss: 3.4428 - val_accuracy300: 0.3485 - 10s/epoch - 47ms/step
Epoch 7/50
211/211 - 10s - loss: 3.1923 - accuracy300: 0.4308 - val_loss: 3.4590 - val_accuracy300: 0.3542 - 10s/epoch - 47ms/step
Epoch 8/50
211/211 - 10s - loss: 3.1715 - accuracy300: 0.4423 - val_loss: 3.4934 - val_accuracy300: 0.3591 - 10s/epoch - 47ms/step
Epoch 9/50
211/211 - 10s - loss: 3.1557 - accuracy300: 0.4503 - val_loss: 3.5257 - val_accuracy300: 0.3575 - 10s/epoch - 48ms/step
Epoch 10/50
211/211 - 10s - loss: 3.1352 - accuracy300: 0.4543 - val_loss: 3.5933 - val_accuracy300: 0.3556 - 10s/epoch - 46ms/step
Epoch 11/50
211/211 - 10s - loss: 3.1148 - accuracy300: 0.4662 - val_loss: 3.6266 - val_accuracy300: 0.3655 - 10s/epoch - 46ms/step
testing model: results/LILAK/W6/deepLOB_L2/h300
Evaluating performance on  test set...
1059/1059 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1834522
{'0': {'precision': 0.3136400944739443, 'recall': 0.6718094076280005, 'f1-score': 0.4276350348292795, 'support': 83613}, '1': {'precision': 0.34217909212160236, 'recall': 0.24347408724488126, 'f1-score': 0.28450880167238146, 'support': 91673}, '2': {'precision': 0.3461725440335066, 'recall': 0.09664756058090854, 'f1-score': 0.1511075561939897, 'support': 95781}, 'accuracy': 0.3237170146126234, 'macro avg': {'precision': 0.3339972435430178, 'recall': 0.3373103518179301, 'f1-score': 0.28775046423188355, 'support': 271067}, 'weighted avg': {'precision': 0.33478706582279233, 'recall': 0.3237170146126234, 'f1-score': 0.2815202749973597, 'support': 271067}}
[[56172 19703  7738]
 [59607 22320  9746]
 [63318 23206  9257]]
Evaluating performance on  train set...
211/211 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1300153
{'0': {'precision': 0.3189169321244793, 'recall': 0.43431590656284763, 'f1-score': 0.3677765742005369, 'support': 17980}, '1': {'precision': 0.3855421686746988, 'recall': 0.18964003511852504, 'f1-score': 0.25422980726791233, 'support': 18224}, '2': {'precision': 0.33989955629235946, 'recall': 0.3926217966769924, 'f1-score': 0.36436337026970517, 'support': 17755}, 'accuracy': 0.33796030319316517, 'macro avg': {'precision': 0.34811955236384584, 'recall': 0.338859246119455, 'f1-score': 0.3287899172460515, 'support': 53959}, 'weighted avg': {'precision': 0.3483230516409995, 'recall': 0.33796030319316517, 'f1-score': 0.328304424672709, 'support': 53959}}
[[7809 2861 7310]
 [8540 3456 6228]
 [8137 2647 6971]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1381096
{'0': {'precision': 0.33101966617088086, 'recall': 0.6044967556963935, 'f1-score': 0.42778578674782425, 'support': 6627}, '1': {'precision': 0.3867472915091963, 'recall': 0.21286922756899182, 'f1-score': 0.2745974955277281, 'support': 7211}, '2': {'precision': 0.37406920718353043, 'recall': 0.2512134137373143, 'f1-score': 0.30057193136823585, 'support': 6799}, 'accuracy': 0.3512622958763386, 'macro avg': {'precision': 0.36394538828786915, 'recall': 0.3561931323342333, 'f1-score': 0.33431840454792944, 'support': 20637}, 'weighted avg': {'precision': 0.36467502962775916, 'recall': 0.3512622958763386, 'f1-score': 0.3323471197558227, 'support': 20637}}
[[4006 1254 1367]
 [4185 1535 1491]
 [3911 1180 1708]]
training model: results/LILAK/W6/deepLOB_L2/h500
Epoch 1/50
211/211 - 12s - loss: 3.3537 - accuracy500: 0.3520 - val_loss: 3.4944 - val_accuracy500: 0.3425 - 12s/epoch - 59ms/step
Epoch 2/50
211/211 - 10s - loss: 3.3227 - accuracy500: 0.3611 - val_loss: 3.3619 - val_accuracy500: 0.3513 - 10s/epoch - 48ms/step
Epoch 3/50
211/211 - 10s - loss: 3.3023 - accuracy500: 0.3696 - val_loss: 3.3695 - val_accuracy500: 0.3447 - 10s/epoch - 47ms/step
Epoch 4/50
211/211 - 10s - loss: 3.2547 - accuracy500: 0.4004 - val_loss: 3.3772 - val_accuracy500: 0.3515 - 10s/epoch - 47ms/step
Epoch 5/50
211/211 - 10s - loss: 3.2224 - accuracy500: 0.4212 - val_loss: 3.4203 - val_accuracy500: 0.3525 - 10s/epoch - 47ms/step
Epoch 6/50
211/211 - 10s - loss: 3.1942 - accuracy500: 0.4373 - val_loss: 3.4231 - val_accuracy500: 0.3553 - 10s/epoch - 46ms/step
Epoch 7/50
211/211 - 10s - loss: 3.1682 - accuracy500: 0.4441 - val_loss: 3.4887 - val_accuracy500: 0.3439 - 10s/epoch - 47ms/step
Epoch 8/50
211/211 - 10s - loss: 3.1402 - accuracy500: 0.4579 - val_loss: 3.5494 - val_accuracy500: 0.3478 - 10s/epoch - 47ms/step
Epoch 9/50
211/211 - 10s - loss: 3.1225 - accuracy500: 0.4642 - val_loss: 3.5558 - val_accuracy500: 0.3511 - 10s/epoch - 46ms/step
Epoch 10/50
211/211 - 10s - loss: 3.0986 - accuracy500: 0.4717 - val_loss: 3.5966 - val_accuracy500: 0.3454 - 10s/epoch - 46ms/step
Epoch 11/50
211/211 - 10s - loss: 3.0743 - accuracy500: 0.4779 - val_loss: 3.6199 - val_accuracy500: 0.3547 - 10s/epoch - 47ms/step
Epoch 12/50
211/211 - 10s - loss: 3.0426 - accuracy500: 0.4871 - val_loss: 3.6190 - val_accuracy500: 0.3586 - 10s/epoch - 47ms/step
testing model: results/LILAK/W6/deepLOB_L2/h500
Evaluating performance on  test set...
1059/1059 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1503304
{'0': {'precision': 0.33015611242330645, 'recall': 0.2715474630434283, 'f1-score': 0.2979974139834117, 'support': 86994}, '1': {'precision': 0.3022275030988477, 'recall': 0.5082266459458793, 'f1-score': 0.3790469094237394, 'support': 81078}, '2': {'precision': 0.37022556390977446, 'recall': 0.22708869362590417, 'f1-score': 0.2815068905337907, 'support': 102995}, 'accuracy': 0.3254472141573854, 'macro avg': {'precision': 0.33420305981064286, 'recall': 0.3356209342050706, 'f1-score': 0.31951707131364726, 'support': 271067}, 'weighted avg': {'precision': 0.337027319058715, 'recall': 0.3254472141573854, 'f1-score': 0.3159741117320022, 'support': 271067}}
[[23623 43516 19855]
 [19941 41206 19931]
 [27987 51619 23389]]
Evaluating performance on  train set...
211/211 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1187782
{'0': {'precision': 0.34330867518493613, 'recall': 0.2804790945552442, 'f1-score': 0.3087297027607269, 'support': 18201}, '1': {'precision': 0.3544333147838991, 'recall': 0.4249652488184598, 'f1-score': 0.3865078763053428, 'support': 17985}, '2': {'precision': 0.3336376604850214, 'recall': 0.3289821639565633, 'f1-score': 0.3312935577086521, 'support': 17773}, 'accuracy': 0.3446135028447525, 'macro avg': {'precision': 0.3437932168179523, 'recall': 0.3448088357767558, 'f1-score': 0.34217704559157386, 'support': 53959}, 'weighted avg': {'precision': 0.34383117743527003, 'recall': 0.3446135028447525, 'f1-score': 0.34208591479559397, 'support': 53959}}
[[5105 6953 6143]
 [4807 7643 5535]
 [4958 6968 5847]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1212105
{'0': {'precision': 0.3552248463280492, 'recall': 0.3190005810575247, 'f1-score': 0.3361395989591306, 'support': 6884}, '1': {'precision': 0.33260343436671663, 'recall': 0.43268365817091453, 'f1-score': 0.3760995634325927, 'support': 6670}, '2': {'precision': 0.3679473866389754, 'recall': 0.3001553014259495, 'f1-score': 0.3306119275328513, 'support': 7083}, 'accuracy': 0.34927557299995154, 'macro avg': {'precision': 0.3519252224445804, 'recall': 0.3506131802181296, 'f1-score': 0.3476170299748582, 'support': 20637}, 'weighted avg': {'precision': 0.35228008377730063, 'recall': 0.34927557299995154, 'f1-score': 0.3471576958882218, 'support': 20637}}
[[2196 2848 1840]
 [1972 2886 1812]
 [2014 2943 2126]]
training model: results/LILAK/W6/deepLOB_L2/h1000
Epoch 1/50
211/211 - 12s - loss: 3.3299 - accuracy1000: 0.3684 - val_loss: 3.4985 - val_accuracy1000: 0.3592 - 12s/epoch - 59ms/step
Epoch 2/50
211/211 - 10s - loss: 3.2898 - accuracy1000: 0.3811 - val_loss: 3.4136 - val_accuracy1000: 0.3612 - 10s/epoch - 48ms/step
Epoch 3/50
211/211 - 10s - loss: 3.2561 - accuracy1000: 0.3994 - val_loss: 3.4734 - val_accuracy1000: 0.3592 - 10s/epoch - 48ms/step
Epoch 4/50
211/211 - 10s - loss: 3.2168 - accuracy1000: 0.4145 - val_loss: 3.4267 - val_accuracy1000: 0.3631 - 10s/epoch - 48ms/step
Epoch 5/50
211/211 - 10s - loss: 3.1801 - accuracy1000: 0.4351 - val_loss: 3.5038 - val_accuracy1000: 0.3668 - 10s/epoch - 47ms/step
Epoch 6/50
211/211 - 10s - loss: 3.1532 - accuracy1000: 0.4466 - val_loss: 3.4605 - val_accuracy1000: 0.3627 - 10s/epoch - 47ms/step
Epoch 7/50
211/211 - 10s - loss: 3.1049 - accuracy1000: 0.4686 - val_loss: 3.5024 - val_accuracy1000: 0.3763 - 10s/epoch - 47ms/step
Epoch 8/50
211/211 - 10s - loss: 3.0762 - accuracy1000: 0.4763 - val_loss: 3.5046 - val_accuracy1000: 0.3636 - 10s/epoch - 47ms/step
Epoch 9/50
211/211 - 10s - loss: 3.0436 - accuracy1000: 0.4860 - val_loss: 3.4828 - val_accuracy1000: 0.3657 - 10s/epoch - 47ms/step
Epoch 10/50
211/211 - 10s - loss: 3.0214 - accuracy1000: 0.4926 - val_loss: 3.5372 - val_accuracy1000: 0.3671 - 10s/epoch - 47ms/step
Epoch 11/50
211/211 - 10s - loss: 2.9973 - accuracy1000: 0.5028 - val_loss: 3.5259 - val_accuracy1000: 0.3689 - 10s/epoch - 47ms/step
Epoch 12/50
211/211 - 10s - loss: 2.9648 - accuracy1000: 0.5119 - val_loss: 3.5112 - val_accuracy1000: 0.3662 - 10s/epoch - 46ms/step
testing model: results/LILAK/W6/deepLOB_L2/h1000
Evaluating performance on  test set...
1059/1059 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1684685
{'0': {'precision': 0.3048061744945148, 'recall': 0.47390360613684573, 'f1-score': 0.37099507122823444, 'support': 81084}, '1': {'precision': 0.315676607343274, 'recall': 0.3585395278960188, 'f1-score': 0.33574557430164026, 'support': 87862}, '2': {'precision': 0.39891169704477086, 'recall': 0.17659443209525955, 'f1-score': 0.2448126302357309, 'support': 102121}, 'accuracy': 0.3245027982011827, 'macro avg': {'precision': 0.3397981596275199, 'recall': 0.3363458553760414, 'f1-score': 0.31718442525520185, 'support': 271067}, 'weighted avg': {'precision': 0.34378269336000705, 'recall': 0.3245027982011827, 'f1-score': 0.31203190582794643, 'support': 271067}}
[[38426 29225 13433]
 [42619 31502 13741]
 [45022 39065 18034]]
Evaluating performance on  train set...
211/211 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.144004
{'0': {'precision': 0.3266430539157812, 'recall': 0.35762374104594175, 'f1-score': 0.3414320606761795, 'support': 18567}, '1': {'precision': 0.3405865102639296, 'recall': 0.31793046810840403, 'f1-score': 0.3288687526546793, 'support': 18265}, '2': {'precision': 0.2970267173270611, 'recall': 0.287557657499854, 'f1-score': 0.2922154978046755, 'support': 17127}, 'accuracy': 0.32194814581441467, 'macro avg': {'precision': 0.3214187605022573, 'recall': 0.32103728888473326, 'f1-score': 0.32083877037851144, 'support': 53959}, 'weighted avg': {'precision': 0.3219624303579673, 'recall': 0.32194814581441467, 'f1-score': 0.3215576950779855, 'support': 53959}}
[[6640 5735 6192]
 [6994 5807 5464]
 [6694 5508 4925]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1303895
{'0': {'precision': 0.35209638554216866, 'recall': 0.5387905604719764, 'f1-score': 0.42588166715243364, 'support': 6780}, '1': {'precision': 0.35922475961538464, 'recall': 0.3339385474860335, 'f1-score': 0.34612044006948467, 'support': 7160}, '2': {'precision': 0.4034941763727121, 'recall': 0.21726146035538302, 'f1-score': 0.2824420071823741, 'support': 6697}, 'accuracy': 0.3633764597567476, 'macro avg': {'precision': 0.37160510717675516, 'recall': 0.36333018943779766, 'f1-score': 0.3514813714680975, 'support': 20637}, 'weighted avg': {'precision': 0.3712488865624902, 'recall': 0.3633764597567476, 'f1-score': 0.35166032738728353, 'support': 20637}}
[[3653 2115 1012]
 [3630 2391 1139]
 [3092 2150 1455]]
training model: results/LILAK/W6/deepOF_L2/h10
Epoch 1/50
211/211 - 8s - loss: 3.3213 - accuracy10: 0.3674 - val_loss: 3.3112 - val_accuracy10: 0.4086 - 8s/epoch - 39ms/step
Epoch 2/50
211/211 - 6s - loss: 3.2750 - accuracy10: 0.3973 - val_loss: 3.2874 - val_accuracy10: 0.4143 - 6s/epoch - 29ms/step
Epoch 3/50
211/211 - 6s - loss: 3.2432 - accuracy10: 0.4123 - val_loss: 3.2715 - val_accuracy10: 0.4218 - 6s/epoch - 29ms/step
Epoch 4/50
211/211 - 6s - loss: 3.2161 - accuracy10: 0.4223 - val_loss: 3.2533 - val_accuracy10: 0.4309 - 6s/epoch - 28ms/step
Epoch 5/50
211/211 - 6s - loss: 3.1934 - accuracy10: 0.4326 - val_loss: 3.2470 - val_accuracy10: 0.4290 - 6s/epoch - 28ms/step
Epoch 6/50
211/211 - 6s - loss: 3.1755 - accuracy10: 0.4373 - val_loss: 3.2402 - val_accuracy10: 0.4366 - 6s/epoch - 29ms/step
Epoch 7/50
211/211 - 6s - loss: 3.1567 - accuracy10: 0.4469 - val_loss: 3.2383 - val_accuracy10: 0.4343 - 6s/epoch - 28ms/step
Epoch 8/50
211/211 - 6s - loss: 3.1378 - accuracy10: 0.4539 - val_loss: 3.2259 - val_accuracy10: 0.4348 - 6s/epoch - 27ms/step
Epoch 9/50
211/211 - 6s - loss: 3.1234 - accuracy10: 0.4601 - val_loss: 3.2215 - val_accuracy10: 0.4416 - 6s/epoch - 27ms/step
Epoch 10/50
211/211 - 6s - loss: 3.1074 - accuracy10: 0.4668 - val_loss: 3.2209 - val_accuracy10: 0.4462 - 6s/epoch - 27ms/step
Epoch 11/50
211/211 - 6s - loss: 3.0930 - accuracy10: 0.4723 - val_loss: 3.2183 - val_accuracy10: 0.4439 - 6s/epoch - 28ms/step
Epoch 12/50
211/211 - 6s - loss: 3.0779 - accuracy10: 0.4780 - val_loss: 3.2163 - val_accuracy10: 0.4486 - 6s/epoch - 28ms/step
Epoch 13/50
211/211 - 6s - loss: 3.0652 - accuracy10: 0.4812 - val_loss: 3.2105 - val_accuracy10: 0.4492 - 6s/epoch - 27ms/step
Epoch 14/50
211/211 - 6s - loss: 3.0494 - accuracy10: 0.4819 - val_loss: 3.2163 - val_accuracy10: 0.4526 - 6s/epoch - 28ms/step
Epoch 15/50
211/211 - 6s - loss: 3.0355 - accuracy10: 0.4869 - val_loss: 3.2167 - val_accuracy10: 0.4527 - 6s/epoch - 29ms/step
Epoch 16/50
211/211 - 6s - loss: 3.0211 - accuracy10: 0.4937 - val_loss: 3.2163 - val_accuracy10: 0.4514 - 6s/epoch - 28ms/step
Epoch 17/50
211/211 - 6s - loss: 3.0043 - accuracy10: 0.4981 - val_loss: 3.2262 - val_accuracy10: 0.4503 - 6s/epoch - 27ms/step
Epoch 18/50
211/211 - 6s - loss: 2.9909 - accuracy10: 0.4996 - val_loss: 3.2302 - val_accuracy10: 0.4533 - 6s/epoch - 27ms/step
Epoch 19/50
211/211 - 6s - loss: 2.9790 - accuracy10: 0.5049 - val_loss: 3.2400 - val_accuracy10: 0.4512 - 6s/epoch - 27ms/step
Epoch 20/50
211/211 - 6s - loss: 2.9608 - accuracy10: 0.5068 - val_loss: 3.2422 - val_accuracy10: 0.4543 - 6s/epoch - 28ms/step
Epoch 21/50
211/211 - 6s - loss: 2.9505 - accuracy10: 0.5098 - val_loss: 3.2500 - val_accuracy10: 0.4542 - 6s/epoch - 28ms/step
Epoch 22/50
211/211 - 6s - loss: 2.9313 - accuracy10: 0.5134 - val_loss: 3.2579 - val_accuracy10: 0.4544 - 6s/epoch - 28ms/step
Epoch 23/50
211/211 - 6s - loss: 2.9183 - accuracy10: 0.5166 - val_loss: 3.2631 - val_accuracy10: 0.4503 - 6s/epoch - 27ms/step
testing model: results/LILAK/W6/deepOF_L2/h10
Evaluating performance on  test set...
1059/1059 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0800291
{'0': {'precision': 0.4065856841682562, 'recall': 0.3914982056332242, 'f1-score': 0.3988993333210216, 'support': 82759}, '1': {'precision': 0.48100927841933117, 'recall': 0.4298325844037062, 'f1-score': 0.4539832208070393, 'support': 100588}, '2': {'precision': 0.40784132114141575, 'recall': 0.4718805221455851, 'f1-score': 0.43753006030559766, 'support': 87715}, 'accuracy': 0.43173517497841823, 'macro avg': {'precision': 0.4318120945763344, 'recall': 0.43107043739417183, 'f1-score': 0.43013753814455286, 'support': 271062}, 'weighted avg': {'precision': 0.43460974765051424, 'recall': 0.43173517497841823, 'f1-score': 0.4318411410694173, 'support': 271062}}
[[32400 22247 28112]
 [25367 43236 31985]
 [21921 24403 41391]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0177479
{'0': {'precision': 0.45530129672006103, 'recall': 0.3917694933053295, 'f1-score': 0.42115289635221903, 'support': 15236}, '1': {'precision': 0.5821552825120007, 'recall': 0.5440589373173643, 'f1-score': 0.5624627691260319, 'support': 24297}, '2': {'precision': 0.4056884577224121, 'recall': 0.5101899348398724, 'f1-score': 0.45197740112994356, 'support': 14426}, 'accuracy': 0.4920031876054041, 'macro avg': {'precision': 0.4810483456514912, 'recall': 0.4820061218208554, 'f1-score': 0.47853102220273147, 'support': 53959}, 'weighted avg': {'precision': 0.4991578633244583, 'recall': 0.4920031876054041, 'f1-score': 0.4930237665445648, 'support': 53959}}
[[ 5969  4975  4292]
 [ 4588 13219  6490]
 [ 2553  4513  7360]]
Evaluating performance on  val set...
81/81 - 1s - 887ms/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0606546
{'0': {'precision': 0.3978102189781022, 'recall': 0.3556585952258286, 'f1-score': 0.3755553540665518, 'support': 5823}, '1': {'precision': 0.5542197357457446, 'recall': 0.5178511845178512, 'f1-score': 0.5354185832566697, 'support': 8991}, '2': {'precision': 0.37800540617442024, 'recall': 0.4563723806252147, 'f1-score': 0.41350867636759786, 'support': 5822}, 'accuracy': 0.4547392905601861, 'macro avg': {'precision': 0.4433451202994223, 'recall': 0.44329405345629813, 'f1-score': 0.4414942045636065, 'support': 20636}, 'weighted avg': {'precision': 0.4603695495225312, 'recall': 0.4547392905601861, 'f1-score': 0.4559146550980036, 'support': 20636}}
[[2071 1877 1875]
 [1838 4656 2497]
 [1297 1868 2657]]
training model: results/LILAK/W6/deepOF_L2/h20
Epoch 1/50
211/211 - 8s - loss: 3.3305 - accuracy20: 0.3548 - val_loss: 3.3006 - val_accuracy20: 0.3767 - 8s/epoch - 39ms/step
Epoch 2/50
211/211 - 6s - loss: 3.2875 - accuracy20: 0.3788 - val_loss: 3.2774 - val_accuracy20: 0.3856 - 6s/epoch - 29ms/step
Epoch 3/50
211/211 - 6s - loss: 3.2656 - accuracy20: 0.3904 - val_loss: 3.2652 - val_accuracy20: 0.3915 - 6s/epoch - 28ms/step
Epoch 4/50
211/211 - 6s - loss: 3.2445 - accuracy20: 0.4049 - val_loss: 3.2551 - val_accuracy20: 0.3949 - 6s/epoch - 28ms/step
Epoch 5/50
211/211 - 6s - loss: 3.2248 - accuracy20: 0.4137 - val_loss: 3.2513 - val_accuracy20: 0.4001 - 6s/epoch - 28ms/step
Epoch 6/50
211/211 - 6s - loss: 3.2151 - accuracy20: 0.4198 - val_loss: 3.2375 - val_accuracy20: 0.4063 - 6s/epoch - 28ms/step
Epoch 7/50
211/211 - 6s - loss: 3.2004 - accuracy20: 0.4258 - val_loss: 3.2465 - val_accuracy20: 0.4039 - 6s/epoch - 27ms/step
Epoch 8/50
211/211 - 6s - loss: 3.1863 - accuracy20: 0.4330 - val_loss: 3.2405 - val_accuracy20: 0.4071 - 6s/epoch - 27ms/step
Epoch 9/50
211/211 - 6s - loss: 3.1761 - accuracy20: 0.4361 - val_loss: 3.2339 - val_accuracy20: 0.4151 - 6s/epoch - 27ms/step
Epoch 10/50
211/211 - 6s - loss: 3.1663 - accuracy20: 0.4425 - val_loss: 3.2351 - val_accuracy20: 0.4178 - 6s/epoch - 28ms/step
Epoch 11/50
211/211 - 6s - loss: 3.1532 - accuracy20: 0.4470 - val_loss: 3.2321 - val_accuracy20: 0.4147 - 6s/epoch - 28ms/step
Epoch 12/50
211/211 - 6s - loss: 3.1401 - accuracy20: 0.4544 - val_loss: 3.2340 - val_accuracy20: 0.4166 - 6s/epoch - 28ms/step
Epoch 13/50
211/211 - 6s - loss: 3.1334 - accuracy20: 0.4558 - val_loss: 3.2380 - val_accuracy20: 0.4203 - 6s/epoch - 28ms/step
Epoch 14/50
211/211 - 6s - loss: 3.1213 - accuracy20: 0.4609 - val_loss: 3.2380 - val_accuracy20: 0.4166 - 6s/epoch - 28ms/step
Epoch 15/50
211/211 - 6s - loss: 3.1087 - accuracy20: 0.4648 - val_loss: 3.2383 - val_accuracy20: 0.4179 - 6s/epoch - 28ms/step
Epoch 16/50
211/211 - 6s - loss: 3.0987 - accuracy20: 0.4681 - val_loss: 3.2368 - val_accuracy20: 0.4219 - 6s/epoch - 28ms/step
Epoch 17/50
211/211 - 6s - loss: 3.0863 - accuracy20: 0.4750 - val_loss: 3.2415 - val_accuracy20: 0.4214 - 6s/epoch - 29ms/step
Epoch 18/50
211/211 - 6s - loss: 3.0738 - accuracy20: 0.4784 - val_loss: 3.2452 - val_accuracy20: 0.4214 - 6s/epoch - 28ms/step
Epoch 19/50
211/211 - 6s - loss: 3.0618 - accuracy20: 0.4797 - val_loss: 3.2489 - val_accuracy20: 0.4219 - 6s/epoch - 28ms/step
Epoch 20/50
211/211 - 6s - loss: 3.0541 - accuracy20: 0.4845 - val_loss: 3.2528 - val_accuracy20: 0.4245 - 6s/epoch - 28ms/step
Epoch 21/50
211/211 - 6s - loss: 3.0400 - accuracy20: 0.4890 - val_loss: 3.2572 - val_accuracy20: 0.4245 - 6s/epoch - 28ms/step
testing model: results/LILAK/W6/deepOF_L2/h20
Evaluating performance on  test set...
1059/1059 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.09017
{'0': {'precision': 0.43761700818095556, 'recall': 0.35293387660551406, 'f1-score': 0.3907398502438689, 'support': 96698}, '1': {'precision': 0.33463129962687704, 'recall': 0.45827183871237226, 'f1-score': 0.38681168873140953, 'support': 71822}, '2': {'precision': 0.4405967249807321, 'recall': 0.40697470304850697, 'f1-score': 0.4231188437536437, 'support': 102542}, 'accuracy': 0.401288266153131, 'macro avg': {'precision': 0.4042816775961882, 'recall': 0.40606013945546443, 'f1-score': 0.4002234609096407, 'support': 271062}, 'weighted avg': {'precision': 0.41145659676331553, 'recall': 0.401288266153131, 'f1-score': 0.4019479072062298, 'support': 271062}}
[[34128 30927 31643]
 [17566 32914 21342]
 [26292 34518 41732]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0482457
{'0': {'precision': 0.47973381730187536, 'recall': 0.3467993221450828, 'f1-score': 0.4025763873465114, 'support': 18293}, '1': {'precision': 0.4448561089091849, 'recall': 0.5605863192182411, 'f1-score': 0.4960607225211377, 'support': 18420}, '2': {'precision': 0.43320207726987386, 'recall': 0.4401600371100545, 'f1-score': 0.4366533406195174, 'support': 17246}, 'accuracy': 0.4496191552845679, 'macro avg': {'precision': 0.4525973344936447, 'recall': 0.44918189282445947, 'f1-score': 0.4450968168290555, 'support': 53959}, 'weighted avg': {'precision': 0.45295545266974246, 'recall': 0.4496191552845679, 'f1-score': 0.44538060147321645, 'support': 53959}}
[[ 6344  6668  5281]
 [ 3443 10326  4651]
 [ 3437  6218  7591]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0774952
{'0': {'precision': 0.43512502461114394, 'recall': 0.31383129792672537, 'f1-score': 0.36465638148667606, 'support': 7042}, '1': {'precision': 0.40623598026020635, 'recall': 0.5461399276236429, 'f1-score': 0.4659120144069977, 'support': 6632}, '2': {'precision': 0.4154494804999247, 'recall': 0.3962941683424303, 'f1-score': 0.40564581342350947, 'support': 6962}, 'accuracy': 0.4163113006396588, 'macro avg': {'precision': 0.4189368284570916, 'recall': 0.4187551312975995, 'f1-score': 0.41207140310572776, 'support': 20636}, 'weighted avg': {'precision': 0.4192026908140066, 'recall': 0.4163113006396588, 'f1-score': 0.4110265977433056, 'support': 20636}}
[[2210 2639 2193]
 [1321 3622 1689]
 [1548 2655 2759]]
training model: results/LILAK/W6/deepOF_L2/h30
Epoch 1/50
211/211 - 8s - loss: 3.3369 - accuracy30: 0.3491 - val_loss: 3.3123 - val_accuracy30: 0.3615 - 8s/epoch - 40ms/step
Epoch 2/50
211/211 - 6s - loss: 3.3029 - accuracy30: 0.3644 - val_loss: 3.2951 - val_accuracy30: 0.3704 - 6s/epoch - 27ms/step
Epoch 3/50
211/211 - 6s - loss: 3.2836 - accuracy30: 0.3742 - val_loss: 3.2864 - val_accuracy30: 0.3752 - 6s/epoch - 28ms/step
Epoch 4/50
211/211 - 6s - loss: 3.2681 - accuracy30: 0.3821 - val_loss: 3.2745 - val_accuracy30: 0.3804 - 6s/epoch - 28ms/step
Epoch 5/50
211/211 - 6s - loss: 3.2541 - accuracy30: 0.3923 - val_loss: 3.2749 - val_accuracy30: 0.3817 - 6s/epoch - 28ms/step
Epoch 6/50
211/211 - 6s - loss: 3.2453 - accuracy30: 0.4004 - val_loss: 3.2672 - val_accuracy30: 0.3812 - 6s/epoch - 27ms/step
Epoch 7/50
211/211 - 6s - loss: 3.2341 - accuracy30: 0.4076 - val_loss: 3.2720 - val_accuracy30: 0.3873 - 6s/epoch - 27ms/step
Epoch 8/50
211/211 - 6s - loss: 3.2240 - accuracy30: 0.4122 - val_loss: 3.2656 - val_accuracy30: 0.3871 - 6s/epoch - 29ms/step
Epoch 9/50
211/211 - 6s - loss: 3.2149 - accuracy30: 0.4165 - val_loss: 3.2646 - val_accuracy30: 0.3896 - 6s/epoch - 29ms/step
Epoch 10/50
211/211 - 6s - loss: 3.2064 - accuracy30: 0.4231 - val_loss: 3.2650 - val_accuracy30: 0.3902 - 6s/epoch - 27ms/step
Epoch 11/50
211/211 - 6s - loss: 3.1975 - accuracy30: 0.4266 - val_loss: 3.2676 - val_accuracy30: 0.3908 - 6s/epoch - 28ms/step
Epoch 12/50
211/211 - 6s - loss: 3.1884 - accuracy30: 0.4288 - val_loss: 3.2726 - val_accuracy30: 0.3922 - 6s/epoch - 27ms/step
Epoch 13/50
211/211 - 6s - loss: 3.1829 - accuracy30: 0.4342 - val_loss: 3.2668 - val_accuracy30: 0.3953 - 6s/epoch - 27ms/step
Epoch 14/50
211/211 - 6s - loss: 3.1699 - accuracy30: 0.4372 - val_loss: 3.2688 - val_accuracy30: 0.3949 - 6s/epoch - 28ms/step
Epoch 15/50
211/211 - 6s - loss: 3.1600 - accuracy30: 0.4417 - val_loss: 3.2777 - val_accuracy30: 0.3954 - 6s/epoch - 27ms/step
Epoch 16/50
211/211 - 6s - loss: 3.1493 - accuracy30: 0.4466 - val_loss: 3.2731 - val_accuracy30: 0.4004 - 6s/epoch - 28ms/step
Epoch 17/50
211/211 - 6s - loss: 3.1376 - accuracy30: 0.4519 - val_loss: 3.2732 - val_accuracy30: 0.4037 - 6s/epoch - 27ms/step
Epoch 18/50
211/211 - 6s - loss: 3.1286 - accuracy30: 0.4572 - val_loss: 3.2778 - val_accuracy30: 0.4008 - 6s/epoch - 27ms/step
Epoch 19/50
211/211 - 6s - loss: 3.1188 - accuracy30: 0.4591 - val_loss: 3.2799 - val_accuracy30: 0.4035 - 6s/epoch - 27ms/step
testing model: results/LILAK/W6/deepOF_L2/h30
Evaluating performance on  test set...
1059/1059 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0990584
{'0': {'precision': 0.405089380733636, 'recall': 0.3183666123192242, 'f1-score': 0.3565301416232431, 'support': 94454}, '1': {'precision': 0.3255195062567239, 'recall': 0.4538684210526316, 'f1-score': 0.37912577074838155, 'support': 76000}, '2': {'precision': 0.4124120929311161, 'recall': 0.3724654103053435, 'f1-score': 0.39142219970648295, 'support': 100608}, 'accuracy': 0.3764378629243494, 'macro avg': {'precision': 0.38100699330715865, 'recall': 0.38156681455906644, 'f1-score': 0.3756927040260359, 'support': 271062}, 'weighted avg': {'precision': 0.3854976008770672, 'recall': 0.3764378629243494, 'f1-score': 0.3758160909379723, 'support': 271062}}
[[30071 33824 30559]
 [18675 34494 22831]
 [25487 37648 37473]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0706351
{'0': {'precision': 0.4538945712037766, 'recall': 0.31099730458221025, 'f1-score': 0.3690978886756238, 'support': 18550}, '1': {'precision': 0.4053892980290324, 'recall': 0.5337705285578163, 'f1-score': 0.4608051872641053, 'support': 17841}, '2': {'precision': 0.4065773172654578, 'recall': 0.4109744990892532, 'f1-score': 0.4087640831115892, 'support': 17568}, 'accuracy': 0.4172056561463333, 'macro avg': {'precision': 0.42195372883275556, 'recall': 0.4185807774097599, 'f1-score': 0.4128890530171061, 'support': 53959}, 'weighted avg': {'precision': 0.4224512142865061, 'recall': 0.4172056561463333, 'f1-score': 0.41233452423165967, 'support': 53959}}
[[5769 7166 5615]
 [3395 9523 4923]
 [3546 6802 7220]]
Evaluating performance on  val set...
81/81 - 1s - 854ms/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0901476
{'0': {'precision': 0.414440734557596, 'recall': 0.27667874059626635, 'f1-score': 0.33182957393483714, 'support': 7178}, '1': {'precision': 0.3680426968739789, 'recall': 0.5243637492240845, 'f1-score': 0.432512, 'support': 6444}, '2': {'precision': 0.3894642053129221, 'recall': 0.3699743370402053, 'f1-score': 0.37946918183812245, 'support': 7014}, 'accuracy': 0.38573366931575886, 'macro avg': {'precision': 0.3906492122481657, 'recall': 0.390338942286852, 'f1-score': 0.38127025192431985, 'support': 20636}, 'weighted avg': {'precision': 0.39146271890750045, 'recall': 0.38573366931575886, 'f1-score': 0.3794619524673799, 'support': 20636}}
[[1986 2913 2279]
 [1276 3379 1789]
 [1530 2889 2595]]
training model: results/LILAK/W6/deepOF_L2/h50
Epoch 1/50
211/211 - 8s - loss: 3.3436 - accuracy50: 0.3407 - val_loss: 3.3292 - val_accuracy50: 0.3440 - 8s/epoch - 36ms/step
Epoch 2/50
211/211 - 6s - loss: 3.3173 - accuracy50: 0.3465 - val_loss: 3.3121 - val_accuracy50: 0.3537 - 6s/epoch - 29ms/step
Epoch 3/50
211/211 - 6s - loss: 3.3006 - accuracy50: 0.3563 - val_loss: 3.3120 - val_accuracy50: 0.3498 - 6s/epoch - 30ms/step
Epoch 4/50
211/211 - 6s - loss: 3.2863 - accuracy50: 0.3665 - val_loss: 3.2996 - val_accuracy50: 0.3586 - 6s/epoch - 30ms/step
Epoch 5/50
211/211 - 6s - loss: 3.2763 - accuracy50: 0.3714 - val_loss: 3.2939 - val_accuracy50: 0.3630 - 6s/epoch - 29ms/step
Epoch 6/50
211/211 - 6s - loss: 3.2687 - accuracy50: 0.3786 - val_loss: 3.2915 - val_accuracy50: 0.3643 - 6s/epoch - 28ms/step
Epoch 7/50
211/211 - 6s - loss: 3.2592 - accuracy50: 0.3845 - val_loss: 3.2954 - val_accuracy50: 0.3627 - 6s/epoch - 28ms/step
Epoch 8/50
211/211 - 6s - loss: 3.2487 - accuracy50: 0.3927 - val_loss: 3.2919 - val_accuracy50: 0.3690 - 6s/epoch - 28ms/step
Epoch 9/50
211/211 - 6s - loss: 3.2438 - accuracy50: 0.3961 - val_loss: 3.2977 - val_accuracy50: 0.3661 - 6s/epoch - 27ms/step
Epoch 10/50
211/211 - 6s - loss: 3.2342 - accuracy50: 0.4020 - val_loss: 3.2957 - val_accuracy50: 0.3657 - 6s/epoch - 27ms/step
Epoch 11/50
211/211 - 6s - loss: 3.2271 - accuracy50: 0.4066 - val_loss: 3.2978 - val_accuracy50: 0.3666 - 6s/epoch - 29ms/step
Epoch 12/50
211/211 - 6s - loss: 3.2193 - accuracy50: 0.4107 - val_loss: 3.2950 - val_accuracy50: 0.3719 - 6s/epoch - 28ms/step
Epoch 13/50
211/211 - 6s - loss: 3.2117 - accuracy50: 0.4139 - val_loss: 3.3043 - val_accuracy50: 0.3694 - 6s/epoch - 27ms/step
Epoch 14/50
211/211 - 6s - loss: 3.2020 - accuracy50: 0.4228 - val_loss: 3.3030 - val_accuracy50: 0.3668 - 6s/epoch - 27ms/step
Epoch 15/50
211/211 - 6s - loss: 3.1937 - accuracy50: 0.4227 - val_loss: 3.3016 - val_accuracy50: 0.3747 - 6s/epoch - 27ms/step
Epoch 16/50
211/211 - 6s - loss: 3.1868 - accuracy50: 0.4284 - val_loss: 3.3104 - val_accuracy50: 0.3710 - 6s/epoch - 27ms/step
testing model: results/LILAK/W6/deepOF_L2/h50
Evaluating performance on  test set...
1059/1059 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1052642
{'0': {'precision': 0.36608602915037325, 'recall': 0.2820164532419021, 'f1-score': 0.31859863625675994, 'support': 91289}, '1': {'precision': 0.31604046641122474, 'recall': 0.42238732653813094, 'f1-score': 0.36155596785468386, 'support': 81430}, '2': {'precision': 0.3820098796596523, 'recall': 0.3570055825020591, 'f1-score': 0.369084725806706, 'support': 98343}, 'accuracy': 0.35139193247301354, 'macro avg': {'precision': 0.3547121250737501, 'recall': 0.35380312076069736, 'f1-score': 0.3497464433060499, 'support': 271062}, 'weighted avg': {'precision': 0.3568290660083067, 'recall': 0.35139193247301354, 'f1-score': 0.3498201612828768, 'support': 271062}}
[[25745 35299 30245]
 [20483 34395 26552]
 [24097 39137 35109]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0874467
{'0': {'precision': 0.41628379905099044, 'recall': 0.2991124580582314, 'f1-score': 0.348102660998268, 'support': 18478}, '1': {'precision': 0.37587847570823696, 'recall': 0.480122665179816, 'f1-score': 0.42165311918519244, 'support': 17935}, '2': {'precision': 0.37973330332526867, 'recall': 0.3846460731790722, 'f1-score': 0.38217390073331636, 'support': 17546}, 'accuracy': 0.38709019811338236, 'macro avg': {'precision': 0.39063185936149863, 'recall': 0.38796039880570654, 'f1-score': 0.38397656030559224, 'support': 53959}, 'weighted avg': {'precision': 0.3909685694849162, 'recall': 0.38709019811338236, 'f1-score': 0.38362854991343776, 'support': 53959}}
[[5527 7321 5630]
 [3930 8611 5394]
 [3820 6977 6749]]
Evaluating performance on  val set...
81/81 - 1s - 902ms/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0996243
{'0': {'precision': 0.3889879183996831, 'recall': 0.2719468291332041, 'f1-score': 0.32010431097710046, 'support': 7222}, '1': {'precision': 0.34098065677013045, 'recall': 0.4710268758738543, 'f1-score': 0.39559005805988645, 'support': 6437}, '2': {'precision': 0.37341299477221807, 'recall': 0.35832019492618605, 'f1-score': 0.3657109420713868, 'support': 6977}, 'accuracy': 0.36324869160690054, 'macro avg': {'precision': 0.3677938566473438, 'recall': 0.3670979666444148, 'f1-score': 0.3604684370361246, 'support': 20636}, 'weighted avg': {'precision': 0.3687471263247532, 'recall': 0.36324869160690054, 'f1-score': 0.35907015799768244, 'support': 20636}}
[[1964 3004 2254]
 [1464 3032 1941]
 [1621 2856 2500]]
training model: results/LILAK/W6/deepOF_L2/h100
Epoch 1/50
211/211 - 8s - loss: 3.3430 - accuracy100: 0.3446 - val_loss: 3.3419 - val_accuracy100: 0.3305 - 8s/epoch - 39ms/step
Epoch 2/50
211/211 - 6s - loss: 3.3171 - accuracy100: 0.3523 - val_loss: 3.3272 - val_accuracy100: 0.3414 - 6s/epoch - 30ms/step
Epoch 3/50
211/211 - 6s - loss: 3.3026 - accuracy100: 0.3583 - val_loss: 3.3203 - val_accuracy100: 0.3383 - 6s/epoch - 29ms/step
Epoch 4/50
211/211 - 6s - loss: 3.2875 - accuracy100: 0.3685 - val_loss: 3.3131 - val_accuracy100: 0.3467 - 6s/epoch - 29ms/step
Epoch 5/50
211/211 - 6s - loss: 3.2817 - accuracy100: 0.3709 - val_loss: 3.3122 - val_accuracy100: 0.3476 - 6s/epoch - 28ms/step
Epoch 6/50
211/211 - 6s - loss: 3.2742 - accuracy100: 0.3771 - val_loss: 3.3094 - val_accuracy100: 0.3480 - 6s/epoch - 29ms/step
Epoch 7/50
211/211 - 6s - loss: 3.2692 - accuracy100: 0.3790 - val_loss: 3.3087 - val_accuracy100: 0.3476 - 6s/epoch - 30ms/step
Epoch 8/50
211/211 - 6s - loss: 3.2608 - accuracy100: 0.3872 - val_loss: 3.3077 - val_accuracy100: 0.3489 - 6s/epoch - 30ms/step
Epoch 9/50
211/211 - 6s - loss: 3.2568 - accuracy100: 0.3890 - val_loss: 3.3047 - val_accuracy100: 0.3569 - 6s/epoch - 29ms/step
Epoch 10/50
211/211 - 6s - loss: 3.2480 - accuracy100: 0.3946 - val_loss: 3.3076 - val_accuracy100: 0.3572 - 6s/epoch - 27ms/step
Epoch 11/50
211/211 - 6s - loss: 3.2429 - accuracy100: 0.3995 - val_loss: 3.3112 - val_accuracy100: 0.3597 - 6s/epoch - 28ms/step
Epoch 12/50
211/211 - 6s - loss: 3.2354 - accuracy100: 0.4024 - val_loss: 3.3084 - val_accuracy100: 0.3614 - 6s/epoch - 27ms/step
Epoch 13/50
211/211 - 6s - loss: 3.2284 - accuracy100: 0.4066 - val_loss: 3.3116 - val_accuracy100: 0.3596 - 6s/epoch - 28ms/step
Epoch 14/50
211/211 - 6s - loss: 3.2226 - accuracy100: 0.4092 - val_loss: 3.3160 - val_accuracy100: 0.3574 - 6s/epoch - 27ms/step
Epoch 15/50
211/211 - 6s - loss: 3.2144 - accuracy100: 0.4144 - val_loss: 3.3120 - val_accuracy100: 0.3637 - 6s/epoch - 26ms/step
Epoch 16/50
211/211 - 6s - loss: 3.2083 - accuracy100: 0.4185 - val_loss: 3.3182 - val_accuracy100: 0.3638 - 6s/epoch - 27ms/step
Epoch 17/50
211/211 - 6s - loss: 3.1981 - accuracy100: 0.4213 - val_loss: 3.3280 - val_accuracy100: 0.3648 - 6s/epoch - 27ms/step
Epoch 18/50
211/211 - 6s - loss: 3.1942 - accuracy100: 0.4235 - val_loss: 3.3240 - val_accuracy100: 0.3655 - 6s/epoch - 27ms/step
Epoch 19/50
211/211 - 6s - loss: 3.1835 - accuracy100: 0.4295 - val_loss: 3.3310 - val_accuracy100: 0.3679 - 6s/epoch - 27ms/step
testing model: results/LILAK/W6/deepOF_L2/h100
Evaluating performance on  test set...
1059/1059 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1060597
{'0': {'precision': 0.3324554803110108, 'recall': 0.21730017096419119, 'f1-score': 0.262817244504872, 'support': 85398}, '1': {'precision': 0.336147605839543, 'recall': 0.42783470928044975, 'f1-score': 0.37648937776024854, 'support': 90362}, '2': {'precision': 0.3669975557440016, 'recall': 0.38599399802732365, 'f1-score': 0.37625615612390495, 'support': 95302}, 'accuracy': 0.3467951981465495, 'macro avg': {'precision': 0.3452002139648518, 'recall': 0.34370962609065486, 'f1-score': 0.3385209261296751, 'support': 271062}, 'weighted avg': {'precision': 0.34583085834232513, 'recall': 0.3467951981465495, 'f1-score': 0.3405950092241592, 'support': 271062}}
[[18557 36300 30541]
 [18794 38660 32908]
 [18467 40049 36786]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0869826
{'0': {'precision': 0.421785995968802, 'recall': 0.2572558661606713, 'f1-score': 0.3195883134130146, 'support': 18709}, '1': {'precision': 0.36216241692982043, 'recall': 0.44290737218283477, 'f1-score': 0.39848571280402423, 'support': 17349}, '2': {'precision': 0.3851671276545872, 'recall': 0.4589687726942629, 'f1-score': 0.41884176182707994, 'support': 17901}, 'accuracy': 0.3838655275301618, 'macro avg': {'precision': 0.3897051801844032, 'recall': 0.38637733701258964, 'f1-score': 0.3789719293480396, 'support': 53959}, 'weighted avg': {'precision': 0.3904673311595941, 'recall': 0.3838655275301618, 'f1-score': 0.37788307354746503, 'support': 53959}}
[[4813 7118 6778]
 [3328 7684 6337]
 [3270 6415 8216]]
Evaluating performance on  val set...
81/81 - 1s - 880ms/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0994713
{'0': {'precision': 0.3445359448030269, 'recall': 0.23507972665148064, 'f1-score': 0.2794728290305109, 'support': 6585}, '1': {'precision': 0.37383521333987246, 'recall': 0.4188762192608875, 'f1-score': 0.3950761256883706, 'support': 7279}, '2': {'precision': 0.356579441592588, 'recall': 0.4205552274069699, 'f1-score': 0.38593400636899516, 'support': 6772}, 'accuracy': 0.3607772824190735, 'macro avg': {'precision': 0.35831686657849576, 'recall': 0.358170391106446, 'f1-score': 0.3534943203626255, 'support': 20636}, 'weighted avg': {'precision': 0.358823012836493, 'recall': 0.3607772824190735, 'f1-score': 0.3551867023251793, 'support': 20636}}
[[1548 2549 2488]
 [1579 3049 2651]
 [1366 2558 2848]]
training model: results/LILAK/W6/deepOF_L2/h200
Epoch 1/50
211/211 - 9s - loss: 3.3467 - accuracy200: 0.3402 - val_loss: 3.3389 - val_accuracy200: 0.3353 - 9s/epoch - 41ms/step
Epoch 2/50
211/211 - 6s - loss: 3.3191 - accuracy200: 0.3454 - val_loss: 3.3267 - val_accuracy200: 0.3379 - 6s/epoch - 29ms/step
Epoch 3/50
211/211 - 6s - loss: 3.3060 - accuracy200: 0.3518 - val_loss: 3.3211 - val_accuracy200: 0.3460 - 6s/epoch - 27ms/step
Epoch 4/50
211/211 - 6s - loss: 3.2963 - accuracy200: 0.3575 - val_loss: 3.3121 - val_accuracy200: 0.3484 - 6s/epoch - 28ms/step
Epoch 5/50
211/211 - 6s - loss: 3.2881 - accuracy200: 0.3631 - val_loss: 3.3133 - val_accuracy200: 0.3488 - 6s/epoch - 27ms/step
Epoch 6/50
211/211 - 6s - loss: 3.2790 - accuracy200: 0.3703 - val_loss: 3.3121 - val_accuracy200: 0.3475 - 6s/epoch - 28ms/step
Epoch 7/50
211/211 - 6s - loss: 3.2752 - accuracy200: 0.3753 - val_loss: 3.3125 - val_accuracy200: 0.3475 - 6s/epoch - 28ms/step
Epoch 8/50
211/211 - 6s - loss: 3.2704 - accuracy200: 0.3769 - val_loss: 3.3125 - val_accuracy200: 0.3456 - 6s/epoch - 26ms/step
Epoch 9/50
211/211 - 6s - loss: 3.2637 - accuracy200: 0.3815 - val_loss: 3.3131 - val_accuracy200: 0.3483 - 6s/epoch - 27ms/step
Epoch 10/50
211/211 - 6s - loss: 3.2584 - accuracy200: 0.3865 - val_loss: 3.3135 - val_accuracy200: 0.3504 - 6s/epoch - 27ms/step
Epoch 11/50
211/211 - 6s - loss: 3.2518 - accuracy200: 0.3899 - val_loss: 3.3141 - val_accuracy200: 0.3523 - 6s/epoch - 27ms/step
Epoch 12/50
211/211 - 6s - loss: 3.2442 - accuracy200: 0.3951 - val_loss: 3.3150 - val_accuracy200: 0.3525 - 6s/epoch - 27ms/step
Epoch 13/50
211/211 - 6s - loss: 3.2407 - accuracy200: 0.3994 - val_loss: 3.3213 - val_accuracy200: 0.3547 - 6s/epoch - 27ms/step
Epoch 14/50
211/211 - 6s - loss: 3.2314 - accuracy200: 0.4033 - val_loss: 3.3235 - val_accuracy200: 0.3518 - 6s/epoch - 28ms/step
Epoch 15/50
211/211 - 6s - loss: 3.2246 - accuracy200: 0.4096 - val_loss: 3.3271 - val_accuracy200: 0.3552 - 6s/epoch - 28ms/step
Epoch 16/50
211/211 - 6s - loss: 3.2192 - accuracy200: 0.4117 - val_loss: 3.3318 - val_accuracy200: 0.3571 - 6s/epoch - 28ms/step
testing model: results/LILAK/W6/deepOF_L2/h200
Evaluating performance on  test set...
1059/1059 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1064669
{'0': {'precision': 0.30820126439767903, 'recall': 0.2168624774533223, 'f1-score': 0.2545873364475953, 'support': 82052}, '1': {'precision': 0.3550655322291027, 'recall': 0.22193551094048294, 'f1-score': 0.2731421415800107, 'support': 95334}, '2': {'precision': 0.34965981084702547, 'recall': 0.5738502924975447, 'f1-score': 0.4345429118804918, 'support': 93676}, 'accuracy': 0.3420176933690447, 'macro avg': {'precision': 0.3376422024912691, 'recall': 0.3375494269637833, 'f1-score': 0.3207574633026993, 'support': 271062}, 'weighted avg': {'precision': 0.3390112964443323, 'recall': 0.3420176933690447, 'f1-score': 0.32330380086070265, 'support': 271062}}
[[17794 18159 46099]
 [20293 21158 53883]
 [19648 20272 53756]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0939994
{'0': {'precision': 0.387813444417218, 'recall': 0.2572187009047077, 'f1-score': 0.30929581134779494, 'support': 18459}, '1': {'precision': 0.36945169712793735, 'recall': 0.2436714310315137, 'f1-score': 0.29365985265124006, 'support': 17421}, '2': {'precision': 0.35959108052669886, 'recall': 0.6011947563471431, 'f1-score': 0.45001552634302866, 'support': 18079}, 'accuracy': 0.3680942938156749, 'macro avg': {'precision': 0.3722854073572847, 'recall': 0.3673616294277882, 'f1-score': 0.35099039678068794, 'support': 53959}, 'weighted avg': {'precision': 0.3724293172780335, 'recall': 0.3680942938156749, 'f1-score': 0.3513958816038439, 'support': 53959}}
[[ 4748  3734  9977]
 [ 3796  4245  9380]
 [ 3699  3511 10869]]
Evaluating performance on  val set...
81/81 - 1s - 870ms/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1051804
{'0': {'precision': 0.34310850439882695, 'recall': 0.23253833049403747, 'f1-score': 0.27720426468099507, 'support': 7044}, '1': {'precision': 0.33666589165310395, 'recall': 0.22321566209341762, 'f1-score': 0.2684464219503152, 'support': 6487}, '2': {'precision': 0.35144018683504885, 'recall': 0.5718508092892329, 'f1-score': 0.4353369763205829, 'support': 7105}, 'accuracy': 0.34643341732893973, 'macro avg': {'precision': 0.34373819429565994, 'recall': 0.34253493395889595, 'f1-score': 0.32699588765063103, 'support': 20636}, 'weighted avg': {'precision': 0.3439518546037044, 'recall': 0.34643341732893973, 'f1-score': 0.3288964913918572, 'support': 20636}}
[[1638 1417 3989]
 [1530 1448 3509]
 [1606 1436 4063]]
training model: results/LILAK/W6/deepOF_L2/h300
Epoch 1/50
211/211 - 8s - loss: 3.3481 - accuracy300: 0.3432 - val_loss: 3.3315 - val_accuracy300: 0.3453 - 8s/epoch - 37ms/step
Epoch 2/50
211/211 - 6s - loss: 3.3210 - accuracy300: 0.3522 - val_loss: 3.3245 - val_accuracy300: 0.3441 - 6s/epoch - 30ms/step
Epoch 3/50
211/211 - 6s - loss: 3.3050 - accuracy300: 0.3593 - val_loss: 3.3198 - val_accuracy300: 0.3466 - 6s/epoch - 28ms/step
Epoch 4/50
211/211 - 6s - loss: 3.2928 - accuracy300: 0.3679 - val_loss: 3.3161 - val_accuracy300: 0.3479 - 6s/epoch - 28ms/step
Epoch 5/50
211/211 - 6s - loss: 3.2850 - accuracy300: 0.3729 - val_loss: 3.3196 - val_accuracy300: 0.3512 - 6s/epoch - 28ms/step
Epoch 6/50
211/211 - 6s - loss: 3.2782 - accuracy300: 0.3773 - val_loss: 3.3135 - val_accuracy300: 0.3494 - 6s/epoch - 28ms/step
Epoch 7/50
211/211 - 6s - loss: 3.2712 - accuracy300: 0.3807 - val_loss: 3.3173 - val_accuracy300: 0.3517 - 6s/epoch - 28ms/step
Epoch 8/50
211/211 - 6s - loss: 3.2636 - accuracy300: 0.3842 - val_loss: 3.3138 - val_accuracy300: 0.3527 - 6s/epoch - 28ms/step
Epoch 9/50
211/211 - 6s - loss: 3.2584 - accuracy300: 0.3915 - val_loss: 3.3176 - val_accuracy300: 0.3509 - 6s/epoch - 28ms/step
Epoch 10/50
211/211 - 6s - loss: 3.2523 - accuracy300: 0.3953 - val_loss: 3.3160 - val_accuracy300: 0.3556 - 6s/epoch - 27ms/step
Epoch 11/50
211/211 - 6s - loss: 3.2465 - accuracy300: 0.3977 - val_loss: 3.3159 - val_accuracy300: 0.3570 - 6s/epoch - 27ms/step
Epoch 12/50
211/211 - 6s - loss: 3.2384 - accuracy300: 0.4047 - val_loss: 3.3189 - val_accuracy300: 0.3533 - 6s/epoch - 27ms/step
Epoch 13/50
211/211 - 6s - loss: 3.2358 - accuracy300: 0.4037 - val_loss: 3.3253 - val_accuracy300: 0.3546 - 6s/epoch - 28ms/step
Epoch 14/50
211/211 - 6s - loss: 3.2266 - accuracy300: 0.4098 - val_loss: 3.3245 - val_accuracy300: 0.3558 - 6s/epoch - 28ms/step
Epoch 15/50
211/211 - 6s - loss: 3.2193 - accuracy300: 0.4141 - val_loss: 3.3319 - val_accuracy300: 0.3530 - 6s/epoch - 29ms/step
Epoch 16/50
211/211 - 6s - loss: 3.2153 - accuracy300: 0.4132 - val_loss: 3.3359 - val_accuracy300: 0.3499 - 6s/epoch - 29ms/step
testing model: results/LILAK/W6/deepOF_L2/h300
Evaluating performance on  test set...
1059/1059 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1040105
{'0': {'precision': 0.3190139281068562, 'recall': 0.12026073436191843, 'f1-score': 0.17467362697495853, 'support': 83610}, '1': {'precision': 0.3590780900515414, 'recall': 0.4027838380312418, 'f1-score': 0.3796773297960946, 'support': 91672}, '2': {'precision': 0.36139211340545524, 'recall': 0.5158383796199624, 'f1-score': 0.4250192478913344, 'support': 95780}, 'accuracy': 0.355586544775734, 'macro avg': {'precision': 0.3464947105212843, 'recall': 0.34629431733770755, 'f1-score': 0.3264567348874625, 'support': 271062}, 'weighted avg': {'precision': 0.34753782463862015, 'recall': 0.355586544775734, 'f1-score': 0.33246484454285685, 'support': 271062}}
[[10055 30745 42810]
 [10252 36924 44496]
 [11212 35161 49407]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0944998
{'0': {'precision': 0.4016044531761624, 'recall': 0.13631564323423173, 'f1-score': 0.20354312741152555, 'support': 17995}, '1': {'precision': 0.37418615314076115, 'recall': 0.44793896481694934, 'f1-score': 0.407754378075895, 'support': 18219}, '2': {'precision': 0.361468453592412, 'recall': 0.5304592843054382, 'f1-score': 0.429954780066688, 'support': 17745}, 'accuracy': 0.3711521710928668, 'macro avg': {'precision': 0.37908635330311186, 'recall': 0.37157129745220646, 'f1-score': 0.3470840951847029, 'support': 53959}, 'weighted avg': {'precision': 0.37914763742793456, 'recall': 0.3711521710928668, 'f1-score': 0.3469520036364372, 'support': 53959}}
[[2453 7092 8450]
 [1880 8161 8178]
 [1775 6557 9413]]
Evaluating performance on  val set...
81/81 - 1s - 916ms/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1058153
{'0': {'precision': 0.3213101160862355, 'recall': 0.11673444795902997, 'f1-score': 0.17125179538172575, 'support': 6639}, '1': {'precision': 0.3668347742555235, 'recall': 0.42436449506875956, 'f1-score': 0.39350808269466087, 'support': 7199}, '2': {'precision': 0.33902586903799514, 'recall': 0.4935275080906149, 'f1-score': 0.4019408170600216, 'support': 6798}, 'accuracy': 0.34817794146152353, 'macro avg': {'precision': 0.3423902531265847, 'recall': 0.3448754837061348, 'f1-score': 0.3222335650454694, 'support': 20636}, 'weighted avg': {'precision': 0.3430276826072069, 'recall': 0.34817794146152353, 'f1-score': 0.32478188753790305, 'support': 20636}}
[[ 775 2641 3223]
 [ 826 3055 3318]
 [ 811 2632 3355]]
training model: results/LILAK/W6/deepOF_L2/h500
Epoch 1/50
211/211 - 8s - loss: 3.3499 - accuracy500: 0.3406 - val_loss: 3.3320 - val_accuracy500: 0.3422 - 8s/epoch - 38ms/step
Epoch 2/50
211/211 - 6s - loss: 3.3237 - accuracy500: 0.3495 - val_loss: 3.3229 - val_accuracy500: 0.3415 - 6s/epoch - 29ms/step
Epoch 3/50
211/211 - 6s - loss: 3.3076 - accuracy500: 0.3561 - val_loss: 3.3177 - val_accuracy500: 0.3427 - 6s/epoch - 29ms/step
Epoch 4/50
211/211 - 6s - loss: 3.2941 - accuracy500: 0.3631 - val_loss: 3.3150 - val_accuracy500: 0.3443 - 6s/epoch - 27ms/step
Epoch 5/50
211/211 - 6s - loss: 3.2890 - accuracy500: 0.3642 - val_loss: 3.3128 - val_accuracy500: 0.3466 - 6s/epoch - 27ms/step
Epoch 6/50
211/211 - 6s - loss: 3.2815 - accuracy500: 0.3694 - val_loss: 3.3111 - val_accuracy500: 0.3495 - 6s/epoch - 27ms/step
Epoch 7/50
211/211 - 6s - loss: 3.2736 - accuracy500: 0.3773 - val_loss: 3.3154 - val_accuracy500: 0.3451 - 6s/epoch - 28ms/step
Epoch 8/50
211/211 - 6s - loss: 3.2683 - accuracy500: 0.3807 - val_loss: 3.3140 - val_accuracy500: 0.3467 - 6s/epoch - 28ms/step
Epoch 9/50
211/211 - 6s - loss: 3.2603 - accuracy500: 0.3843 - val_loss: 3.3145 - val_accuracy500: 0.3484 - 6s/epoch - 28ms/step
Epoch 10/50
211/211 - 6s - loss: 3.2549 - accuracy500: 0.3922 - val_loss: 3.3195 - val_accuracy500: 0.3469 - 6s/epoch - 28ms/step
Epoch 11/50
211/211 - 6s - loss: 3.2499 - accuracy500: 0.3911 - val_loss: 3.3213 - val_accuracy500: 0.3464 - 6s/epoch - 27ms/step
Epoch 12/50
211/211 - 6s - loss: 3.2417 - accuracy500: 0.3995 - val_loss: 3.3220 - val_accuracy500: 0.3463 - 6s/epoch - 27ms/step
Epoch 13/50
211/211 - 6s - loss: 3.2381 - accuracy500: 0.3983 - val_loss: 3.3258 - val_accuracy500: 0.3466 - 6s/epoch - 27ms/step
Epoch 14/50
211/211 - 6s - loss: 3.2313 - accuracy500: 0.4058 - val_loss: 3.3317 - val_accuracy500: 0.3497 - 6s/epoch - 27ms/step
Epoch 15/50
211/211 - 6s - loss: 3.2240 - accuracy500: 0.4083 - val_loss: 3.3325 - val_accuracy500: 0.3507 - 6s/epoch - 28ms/step
Epoch 16/50
211/211 - 6s - loss: 3.2138 - accuracy500: 0.4158 - val_loss: 3.3376 - val_accuracy500: 0.3481 - 6s/epoch - 27ms/step
testing model: results/LILAK/W6/deepOF_L2/h500
Evaluating performance on  test set...
1059/1059 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1047606
{'0': {'precision': 0.3248187338269581, 'recall': 0.14573921440148982, 'f1-score': 0.20120296456174322, 'support': 86991}, '1': {'precision': 0.30703156662313685, 'recall': 0.33638393132454336, 'f1-score': 0.32103822724463665, 'support': 81077}, '2': {'precision': 0.38279924303261803, 'recall': 0.5322445967726275, 'f1-score': 0.4453181801565413, 'support': 102994}, 'accuracy': 0.34962111989139016, 'macro avg': {'precision': 0.3382165144942377, 'recall': 0.33812258083288693, 'f1-score': 0.3225197906543071, 'support': 271062}, 'weighted avg': {'precision': 0.3415289861299129, 'recall': 0.34962111989139016, 'f1-score': 0.3298019054221795, 'support': 271062}}
[[12678 28193 46120]
 [11539 27273 42265]
 [14814 33362 54818]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0944175
{'0': {'precision': 0.39477611940298507, 'recall': 0.17426155704403207, 'f1-score': 0.2417917269749372, 'support': 18214}, '1': {'precision': 0.373387314439946, 'recall': 0.38521942526175096, 'f1-score': 0.3792110961870563, 'support': 17956}, '2': {'precision': 0.3599693363510258, 'recall': 0.5543313283489797, 'f1-score': 0.4364916008233185, 'support': 17789}, 'accuracy': 0.3697622268759614, 'macro avg': {'precision': 0.37604425673131897, 'recall': 0.3712707702182542, 'f1-score': 0.3524981413284373, 'support': 53959}, 'weighted avg': {'precision': 0.3761835723649074, 'recall': 0.3697622268759614, 'f1-score': 0.3517088538576012, 'support': 53959}}
[[3174 6102 8938]
 [2444 6917 8595]
 [2422 5506 9861]]
Evaluating performance on  val set...
81/81 - 1s - 993ms/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1048458
{'0': {'precision': 0.33778201461709567, 'recall': 0.15439360929557008, 'f1-score': 0.21192185007974482, 'support': 6885}, '1': {'precision': 0.3388755812315063, 'recall': 0.3602996254681648, 'f1-score': 0.34925936683125186, 'support': 6675}, '2': {'precision': 0.35450346420323325, 'recall': 0.5206331260599208, 'f1-score': 0.42179986260590796, 'support': 7076}, 'accuracy': 0.3465787943399884, 'macro avg': {'precision': 0.34372035335061174, 'recall': 0.3451087869412186, 'f1-score': 0.3276603598389682, 'support': 20636}, 'weighted avg': {'precision': 0.34386946055733125, 'recall': 0.3465787943399884, 'f1-score': 0.3283118840471532, 'support': 20636}}
[[1063 2355 3467]
 [1029 2405 3241]
 [1055 2337 3684]]
training model: results/LILAK/W6/deepOF_L2/h1000
Epoch 1/50
211/211 - 8s - loss: 3.3445 - accuracy1000: 0.3478 - val_loss: 3.3474 - val_accuracy1000: 0.3284 - 8s/epoch - 37ms/step
Epoch 2/50
211/211 - 6s - loss: 3.3196 - accuracy1000: 0.3544 - val_loss: 3.3391 - val_accuracy1000: 0.3329 - 6s/epoch - 28ms/step
Epoch 3/50
211/211 - 6s - loss: 3.3024 - accuracy1000: 0.3607 - val_loss: 3.3354 - val_accuracy1000: 0.3303 - 6s/epoch - 27ms/step
Epoch 4/50
211/211 - 6s - loss: 3.2919 - accuracy1000: 0.3667 - val_loss: 3.3367 - val_accuracy1000: 0.3267 - 6s/epoch - 28ms/step
Epoch 5/50
211/211 - 6s - loss: 3.2861 - accuracy1000: 0.3730 - val_loss: 3.3363 - val_accuracy1000: 0.3302 - 6s/epoch - 28ms/step
Epoch 6/50
211/211 - 6s - loss: 3.2793 - accuracy1000: 0.3755 - val_loss: 3.3325 - val_accuracy1000: 0.3323 - 6s/epoch - 28ms/step
Epoch 7/50
211/211 - 6s - loss: 3.2733 - accuracy1000: 0.3788 - val_loss: 3.3306 - val_accuracy1000: 0.3337 - 6s/epoch - 28ms/step
Epoch 8/50
211/211 - 6s - loss: 3.2666 - accuracy1000: 0.3828 - val_loss: 3.3312 - val_accuracy1000: 0.3290 - 6s/epoch - 28ms/step
Epoch 9/50
211/211 - 6s - loss: 3.2616 - accuracy1000: 0.3819 - val_loss: 3.3344 - val_accuracy1000: 0.3404 - 6s/epoch - 27ms/step
Epoch 10/50
211/211 - 6s - loss: 3.2575 - accuracy1000: 0.3861 - val_loss: 3.3357 - val_accuracy1000: 0.3349 - 6s/epoch - 27ms/step
Epoch 11/50
211/211 - 6s - loss: 3.2538 - accuracy1000: 0.3903 - val_loss: 3.3407 - val_accuracy1000: 0.3317 - 6s/epoch - 28ms/step
Epoch 12/50
211/211 - 6s - loss: 3.2489 - accuracy1000: 0.3936 - val_loss: 3.3361 - val_accuracy1000: 0.3318 - 6s/epoch - 27ms/step
Epoch 13/50
211/211 - 6s - loss: 3.2436 - accuracy1000: 0.3960 - val_loss: 3.3391 - val_accuracy1000: 0.3342 - 6s/epoch - 27ms/step
Epoch 14/50
211/211 - 6s - loss: 3.2364 - accuracy1000: 0.4007 - val_loss: 3.3358 - val_accuracy1000: 0.3381 - 6s/epoch - 27ms/step
Epoch 15/50
211/211 - 6s - loss: 3.2309 - accuracy1000: 0.4027 - val_loss: 3.3440 - val_accuracy1000: 0.3396 - 6s/epoch - 28ms/step
Epoch 16/50
211/211 - 6s - loss: 3.2249 - accuracy1000: 0.4080 - val_loss: 3.3487 - val_accuracy1000: 0.3388 - 6s/epoch - 28ms/step
Epoch 17/50
211/211 - 6s - loss: 3.2170 - accuracy1000: 0.4120 - val_loss: 3.3498 - val_accuracy1000: 0.3404 - 6s/epoch - 27ms/step
testing model: results/LILAK/W6/deepOF_L2/h1000
Evaluating performance on  test set...
1059/1059 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1020129
{'0': {'precision': 0.2847707114549915, 'recall': 0.0744422382003626, 'f1-score': 0.1180300941542252, 'support': 81083}, '1': {'precision': 0.3395604395604396, 'recall': 0.1477122695196904, 'f1-score': 0.2058692893401015, 'support': 87860}, '2': {'precision': 0.3772667567542028, 'recall': 0.7819015070652866, 'f1-score': 0.5089605277835323, 'support': 102119}, 'accuracy': 0.36471729714972956, 'macro avg': {'precision': 0.3338659692565446, 'recall': 0.3346853382617799, 'f1-score': 0.277619970425953, 'support': 271062}, 'weighted avg': {'precision': 0.3373764959664864, 'recall': 0.36471729714972956, 'f1-score': 0.2937794675109565, 'support': 271062}}
[[ 6036 11245 63802]
 [ 6885 12978 67997]
 [ 8275 13997 79847]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1031234
{'0': {'precision': 0.42038057085628444, 'recall': 0.09048773915386689, 'f1-score': 0.1489201294957648, 'support': 18555}, '1': {'precision': 0.38709291187739464, 'recall': 0.17707306386241647, 'f1-score': 0.24299135663284482, 'support': 18258}, '2': {'precision': 0.3296325667459688, 'recall': 0.8000116645281699, 'f1-score': 0.46689017852584286, 'support': 17146}, 'accuracy': 0.34524361088974964, 'macro avg': {'precision': 0.3790353498265493, 'recall': 0.35585748918148435, 'f1-score': 0.28626722155148415, 'support': 53959}, 'weighted avg': {'precision': 0.3802810257180862, 'recall': 0.34524361088974964, 'f1-score': 0.2817889173854315, 'support': 53959}}
[[ 1679  2734 14142]
 [ 1271  3233 13754]
 [ 1044  2385 13717]]
Evaluating performance on  val set...
81/81 - 1s - 931ms/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1135229
{'0': {'precision': 0.331986531986532, 'recall': 0.07284278959810875, 'f1-score': 0.1194717072579668, 'support': 6768}, '1': {'precision': 0.3632776934749621, 'recall': 0.16713208600949456, 'f1-score': 0.22893755379171846, 'support': 7162}, '2': {'precision': 0.3306004036326943, 'recall': 0.781688040560692, 'f1-score': 0.4646751174541265, 'support': 6706}, 'accuracy': 0.3359178135297538, 'macro avg': {'precision': 0.3419548763647294, 'recall': 0.34055430538943177, 'f1-score': 0.27102812616793726, 'support': 20636}, 'weighted avg': {'precision': 0.3423961036980701, 'recall': 0.3359178135297538, 'f1-score': 0.2696426929940676, 'support': 20636}}
[[ 493 1110 5165]
 [ 516 1197 5449]
 [ 476  988 5242]]
training model: results/LILAK/W6/deepVOL_L2/h10
Epoch 1/50
211/211 - 9s - loss: 3.3463 - accuracy10: 0.3497 - val_loss: 3.3062 - val_accuracy10: 0.3764 - 9s/epoch - 40ms/step
Epoch 2/50
211/211 - 5s - loss: 3.3058 - accuracy10: 0.3758 - val_loss: 3.3100 - val_accuracy10: 0.4006 - 5s/epoch - 25ms/step
Epoch 3/50
211/211 - 5s - loss: 3.2660 - accuracy10: 0.3953 - val_loss: 3.2893 - val_accuracy10: 0.4157 - 5s/epoch - 26ms/step
Epoch 4/50
211/211 - 6s - loss: 3.2507 - accuracy10: 0.4088 - val_loss: 3.2589 - val_accuracy10: 0.4219 - 6s/epoch - 26ms/step
Epoch 5/50
211/211 - 5s - loss: 3.2246 - accuracy10: 0.4226 - val_loss: 3.2475 - val_accuracy10: 0.4266 - 5s/epoch - 26ms/step
Epoch 6/50
211/211 - 5s - loss: 3.2065 - accuracy10: 0.4269 - val_loss: 3.2478 - val_accuracy10: 0.4218 - 5s/epoch - 25ms/step
Epoch 7/50
211/211 - 5s - loss: 3.1856 - accuracy10: 0.4356 - val_loss: 3.2423 - val_accuracy10: 0.4483 - 5s/epoch - 25ms/step
Epoch 8/50
211/211 - 5s - loss: 3.1663 - accuracy10: 0.4439 - val_loss: 3.2484 - val_accuracy10: 0.4376 - 5s/epoch - 24ms/step
Epoch 9/50
211/211 - 5s - loss: 3.1510 - accuracy10: 0.4438 - val_loss: 3.2088 - val_accuracy10: 0.4406 - 5s/epoch - 24ms/step
Epoch 10/50
211/211 - 5s - loss: 3.1291 - accuracy10: 0.4530 - val_loss: 3.2186 - val_accuracy10: 0.4437 - 5s/epoch - 25ms/step
Epoch 11/50
211/211 - 5s - loss: 3.1072 - accuracy10: 0.4577 - val_loss: 3.2427 - val_accuracy10: 0.4398 - 5s/epoch - 25ms/step
Epoch 12/50
211/211 - 5s - loss: 3.0994 - accuracy10: 0.4590 - val_loss: 3.1980 - val_accuracy10: 0.4474 - 5s/epoch - 24ms/step
Epoch 13/50
211/211 - 5s - loss: 3.0770 - accuracy10: 0.4674 - val_loss: 3.1985 - val_accuracy10: 0.4476 - 5s/epoch - 24ms/step
Epoch 14/50
211/211 - 5s - loss: 3.0660 - accuracy10: 0.4697 - val_loss: 3.1889 - val_accuracy10: 0.4578 - 5s/epoch - 24ms/step
Epoch 15/50
211/211 - 5s - loss: 3.0564 - accuracy10: 0.4725 - val_loss: 3.1576 - val_accuracy10: 0.4561 - 5s/epoch - 25ms/step
Epoch 16/50
211/211 - 5s - loss: 3.0441 - accuracy10: 0.4743 - val_loss: 3.1804 - val_accuracy10: 0.4556 - 5s/epoch - 26ms/step
Epoch 17/50
211/211 - 5s - loss: 3.0381 - accuracy10: 0.4784 - val_loss: 3.1532 - val_accuracy10: 0.4540 - 5s/epoch - 26ms/step
Epoch 18/50
211/211 - 5s - loss: 3.0247 - accuracy10: 0.4798 - val_loss: 3.1633 - val_accuracy10: 0.4630 - 5s/epoch - 26ms/step
Epoch 19/50
211/211 - 5s - loss: 3.0153 - accuracy10: 0.4828 - val_loss: 3.1694 - val_accuracy10: 0.4581 - 5s/epoch - 25ms/step
Epoch 20/50
211/211 - 5s - loss: 3.0133 - accuracy10: 0.4850 - val_loss: 3.1991 - val_accuracy10: 0.4470 - 5s/epoch - 25ms/step
Epoch 21/50
211/211 - 5s - loss: 3.0013 - accuracy10: 0.4866 - val_loss: 3.1947 - val_accuracy10: 0.4465 - 5s/epoch - 25ms/step
Epoch 22/50
211/211 - 5s - loss: 2.9935 - accuracy10: 0.4913 - val_loss: 3.1699 - val_accuracy10: 0.4504 - 5s/epoch - 25ms/step
Epoch 23/50
211/211 - 5s - loss: 2.9811 - accuracy10: 0.4939 - val_loss: 3.1829 - val_accuracy10: 0.4514 - 5s/epoch - 25ms/step
Epoch 24/50
211/211 - 5s - loss: 2.9700 - accuracy10: 0.4976 - val_loss: 3.1624 - val_accuracy10: 0.4574 - 5s/epoch - 25ms/step
Epoch 25/50
211/211 - 5s - loss: 2.9665 - accuracy10: 0.4967 - val_loss: 3.1740 - val_accuracy10: 0.4529 - 5s/epoch - 25ms/step
Epoch 26/50
211/211 - 5s - loss: 2.9582 - accuracy10: 0.4987 - val_loss: 3.1767 - val_accuracy10: 0.4564 - 5s/epoch - 25ms/step
Epoch 27/50
211/211 - 5s - loss: 2.9528 - accuracy10: 0.5020 - val_loss: 3.1492 - val_accuracy10: 0.4557 - 5s/epoch - 26ms/step
Epoch 28/50
211/211 - 5s - loss: 2.9450 - accuracy10: 0.5036 - val_loss: 3.1665 - val_accuracy10: 0.4559 - 5s/epoch - 26ms/step
Epoch 29/50
211/211 - 6s - loss: 2.9366 - accuracy10: 0.5058 - val_loss: 3.1829 - val_accuracy10: 0.4625 - 6s/epoch - 27ms/step
Epoch 30/50
211/211 - 5s - loss: 2.9291 - accuracy10: 0.5093 - val_loss: 3.1740 - val_accuracy10: 0.4579 - 5s/epoch - 26ms/step
Epoch 31/50
211/211 - 5s - loss: 2.9207 - accuracy10: 0.5107 - val_loss: 3.1738 - val_accuracy10: 0.4572 - 5s/epoch - 26ms/step
Epoch 32/50
211/211 - 5s - loss: 2.9138 - accuracy10: 0.5110 - val_loss: 3.1955 - val_accuracy10: 0.4528 - 5s/epoch - 26ms/step
Epoch 33/50
211/211 - 5s - loss: 2.9062 - accuracy10: 0.5141 - val_loss: 3.2117 - val_accuracy10: 0.4572 - 5s/epoch - 26ms/step
Epoch 34/50
211/211 - 5s - loss: 2.8982 - accuracy10: 0.5151 - val_loss: 3.2154 - val_accuracy10: 0.4521 - 5s/epoch - 25ms/step
Epoch 35/50
211/211 - 5s - loss: 2.8962 - accuracy10: 0.5159 - val_loss: 3.2084 - val_accuracy10: 0.4502 - 5s/epoch - 24ms/step
Epoch 36/50
211/211 - 5s - loss: 2.8859 - accuracy10: 0.5187 - val_loss: 3.1979 - val_accuracy10: 0.4507 - 5s/epoch - 24ms/step
Epoch 37/50
211/211 - 5s - loss: 2.8755 - accuracy10: 0.5219 - val_loss: 3.2236 - val_accuracy10: 0.4539 - 5s/epoch - 25ms/step
testing model: results/LILAK/W6/deepVOL_L2/h10
Evaluating performance on  test set...
1059/1059 - 12s - 12s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0719228
{'0': {'precision': 0.4012422476450614, 'recall': 0.5182938617689705, 'f1-score': 0.4523180588728428, 'support': 82760}, '1': {'precision': 0.5619862708389053, 'recall': 0.3133381714069847, 'f1-score': 0.40234624320253265, 'support': 100591}, '2': {'precision': 0.41641762044430464, 'recall': 0.5130876920972228, 'f1-score': 0.4597257335478434, 'support': 87716}, 'accuracy': 0.44055159794441967, 'macro avg': {'precision': 0.45988204630942375, 'recall': 0.44823990842439265, 'f1-score': 0.4381300118744063, 'support': 271067}, 'weighted avg': {'precision': 0.46580386908016924, 'recall': 0.44055159794441967, 'f1-score': 0.43617096860254123, 'support': 271067}}
[[42894 11411 28455]
 [34454 31519 34618]
 [29555 13155 45006]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.008295
{'0': {'precision': 0.4331778660678298, 'recall': 0.4917314857180208, 'f1-score': 0.4606012367599338, 'support': 15299}, '1': {'precision': 0.6583150451109485, 'recall': 0.44668266048974187, 'f1-score': 0.5322326269098078, 'support': 24176}, '2': {'precision': 0.3982563899346146, 'recall': 0.5550952775476388, 'f1-score': 0.46377480387632675, 'support': 14484}, 'accuracy': 0.48855612594747866, 'macro avg': {'precision': 0.49658310037113096, 'recall': 0.4978364745851338, 'f1-score': 0.4855362225153561, 'support': 53959}, 'weighted avg': {'precision': 0.5246753693616816, 'recall': 0.48855612594747866, 'f1-score': 0.4935471111159669, 'support': 53959}}
[[ 7523  2877  4899]
 [ 6128 10799  7249]
 [ 3716  2728  8040]]
Evaluating performance on  val set...
81/81 - 1s - 795ms/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0516044
{'0': {'precision': 0.38957673481140226, 'recall': 0.467680608365019, 'f1-score': 0.4250706880301603, 'support': 5786}, '1': {'precision': 0.6307692307692307, 'recall': 0.3945796460176991, 'f1-score': 0.4854712487240558, 'support': 9040}, '2': {'precision': 0.38563962170233945, 'recall': 0.5332989158492514, 'f1-score': 0.4476059796345778, 'support': 5811}, 'accuracy': 0.4541357755487716, 'macro avg': {'precision': 0.4686618624276575, 'recall': 0.46518639007732315, 'f1-score': 0.45271597212959797, 'support': 20637}, 'weighted avg': {'precision': 0.4941220465903432, 'recall': 0.4541357755487716, 'f1-score': 0.4578745668975385, 'support': 20637}}
[[2706 1034 2046]
 [2582 3567 2891]
 [1658 1054 3099]]
training model: results/LILAK/W6/deepVOL_L2/h20
Epoch 1/50
211/211 - 7s - loss: 3.3336 - accuracy20: 0.3659 - val_loss: 3.2855 - val_accuracy20: 0.3793 - 7s/epoch - 34ms/step
Epoch 2/50
211/211 - 5s - loss: 3.2677 - accuracy20: 0.3908 - val_loss: 3.2792 - val_accuracy20: 0.3822 - 5s/epoch - 25ms/step
Epoch 3/50
211/211 - 6s - loss: 3.2296 - accuracy20: 0.4124 - val_loss: 3.2252 - val_accuracy20: 0.4086 - 6s/epoch - 26ms/step
Epoch 4/50
211/211 - 5s - loss: 3.1990 - accuracy20: 0.4263 - val_loss: 3.1972 - val_accuracy20: 0.4279 - 5s/epoch - 25ms/step
Epoch 5/50
211/211 - 5s - loss: 3.1773 - accuracy20: 0.4395 - val_loss: 3.1994 - val_accuracy20: 0.4296 - 5s/epoch - 25ms/step
Epoch 6/50
211/211 - 5s - loss: 3.1601 - accuracy20: 0.4470 - val_loss: 3.1876 - val_accuracy20: 0.4349 - 5s/epoch - 25ms/step
Epoch 7/50
211/211 - 5s - loss: 3.1434 - accuracy20: 0.4547 - val_loss: 3.2024 - val_accuracy20: 0.4330 - 5s/epoch - 25ms/step
Epoch 8/50
211/211 - 6s - loss: 3.1294 - accuracy20: 0.4593 - val_loss: 3.1860 - val_accuracy20: 0.4434 - 6s/epoch - 26ms/step
Epoch 9/50
211/211 - 5s - loss: 3.1172 - accuracy20: 0.4658 - val_loss: 3.1973 - val_accuracy20: 0.4395 - 5s/epoch - 25ms/step
Epoch 10/50
211/211 - 5s - loss: 3.1029 - accuracy20: 0.4668 - val_loss: 3.1956 - val_accuracy20: 0.4417 - 5s/epoch - 24ms/step
Epoch 11/50
211/211 - 5s - loss: 3.0907 - accuracy20: 0.4710 - val_loss: 3.1817 - val_accuracy20: 0.4422 - 5s/epoch - 25ms/step
Epoch 12/50
211/211 - 6s - loss: 3.0738 - accuracy20: 0.4787 - val_loss: 3.1720 - val_accuracy20: 0.4460 - 6s/epoch - 27ms/step
Epoch 13/50
211/211 - 5s - loss: 3.0663 - accuracy20: 0.4804 - val_loss: 3.1577 - val_accuracy20: 0.4496 - 5s/epoch - 25ms/step
Epoch 14/50
211/211 - 5s - loss: 3.0567 - accuracy20: 0.4835 - val_loss: 3.1848 - val_accuracy20: 0.4453 - 5s/epoch - 24ms/step
Epoch 15/50
211/211 - 5s - loss: 3.0460 - accuracy20: 0.4857 - val_loss: 3.1736 - val_accuracy20: 0.4516 - 5s/epoch - 25ms/step
Epoch 16/50
211/211 - 5s - loss: 3.0389 - accuracy20: 0.4892 - val_loss: 3.1801 - val_accuracy20: 0.4491 - 5s/epoch - 24ms/step
Epoch 17/50
211/211 - 5s - loss: 3.0277 - accuracy20: 0.4905 - val_loss: 3.1687 - val_accuracy20: 0.4485 - 5s/epoch - 25ms/step
Epoch 18/50
211/211 - 5s - loss: 3.0224 - accuracy20: 0.4940 - val_loss: 3.1778 - val_accuracy20: 0.4512 - 5s/epoch - 25ms/step
Epoch 19/50
211/211 - 5s - loss: 3.0143 - accuracy20: 0.4937 - val_loss: 3.1722 - val_accuracy20: 0.4557 - 5s/epoch - 25ms/step
Epoch 20/50
211/211 - 5s - loss: 3.0023 - accuracy20: 0.5005 - val_loss: 3.1839 - val_accuracy20: 0.4468 - 5s/epoch - 25ms/step
Epoch 21/50
211/211 - 5s - loss: 3.0002 - accuracy20: 0.4989 - val_loss: 3.1767 - val_accuracy20: 0.4521 - 5s/epoch - 26ms/step
Epoch 22/50
211/211 - 5s - loss: 2.9884 - accuracy20: 0.5035 - val_loss: 3.1773 - val_accuracy20: 0.4522 - 5s/epoch - 25ms/step
Epoch 23/50
211/211 - 5s - loss: 2.9805 - accuracy20: 0.5050 - val_loss: 3.1734 - val_accuracy20: 0.4533 - 5s/epoch - 26ms/step
testing model: results/LILAK/W6/deepVOL_L2/h20
Evaluating performance on  test set...
1059/1059 - 13s - 13s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0591185
{'0': {'precision': 0.45410989453692646, 'recall': 0.32639089968976215, 'f1-score': 0.3798006052838998, 'support': 96700}, '1': {'precision': 0.4270889844065156, 'recall': 0.42747549565604814, 'f1-score': 0.42728215262363184, 'support': 71824}, '2': {'precision': 0.43999228841334104, 'recall': 0.5564104814565597, 'f1-score': 0.4914003221111197, 'support': 102543}, 'accuracy': 0.4401900637111858, 'macro avg': {'precision': 0.44039705578559435, 'recall': 0.43675895893412325, 'f1-score': 0.43282769333955046, 'support': 271067}, 'weighted avg': {'precision': 0.44160962141648963, 'recall': 0.4401900637111858, 'f1-score': 0.4345991769239096, 'support': 271067}}
[[31562 18919 46219]
 [14721 30703 26400]
 [23220 22267 57056]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0407299
{'0': {'precision': 0.493710984813193, 'recall': 0.28927830549186595, 'f1-score': 0.3648067192179271, 'support': 18318}, '1': {'precision': 0.5075853670911766, 'recall': 0.5432822852177691, 'f1-score': 0.5248275319361017, 'support': 18414}, '2': {'precision': 0.4134455925500702, 'recall': 0.5644047135310849, 'f1-score': 0.4772727272727273, 'support': 17227}, 'accuracy': 0.46379658629700327, 'macro avg': {'precision': 0.47158064815147993, 'recall': 0.4656551014135733, 'f1-score': 0.4556356594755853, 'support': 53959}, 'weighted avg': {'precision': 0.4728201410753546, 'recall': 0.46379658629700327, 'f1-score': 0.45532127964626173, 'support': 53959}}
[[ 5299  5076  7943]
 [ 2559 10004  5851]
 [ 2875  4629  9723]]
Evaluating performance on  val set...
81/81 - 1s - 801ms/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0545133
{'0': {'precision': 0.44715062662567984, 'recall': 0.26979597660151233, 'f1-score': 0.3365367503114433, 'support': 7009}, '1': {'precision': 0.4896640826873385, 'recall': 0.5082700044702727, 'f1-score': 0.49879359508664184, 'support': 6711}, '2': {'precision': 0.41537809786062274, 'recall': 0.5670088188521035, 'f1-score': 0.4794914114554679, 'support': 6917}, 'accuracy': 0.4469641905315695, 'macro avg': {'precision': 0.45073093572454703, 'recall': 0.4483582666412962, 'f1-score': 0.43827391895118434, 'support': 20637}, 'weighted avg': {'precision': 0.4503263412238236, 'recall': 0.4469641905315695, 'f1-score': 0.4372162616948603, 'support': 20637}}
[[1891 1814 3304]
 [1084 3411 2216]
 [1254 1741 3922]]
training model: results/LILAK/W6/deepVOL_L2/h30
Epoch 1/50
211/211 - 7s - loss: 3.3434 - accuracy30: 0.3582 - val_loss: 3.2970 - val_accuracy30: 0.3731 - 7s/epoch - 35ms/step
Epoch 2/50
211/211 - 5s - loss: 3.2794 - accuracy30: 0.3844 - val_loss: 3.2714 - val_accuracy30: 0.3804 - 5s/epoch - 26ms/step
Epoch 3/50
211/211 - 5s - loss: 3.2469 - accuracy30: 0.3997 - val_loss: 3.2432 - val_accuracy30: 0.4035 - 5s/epoch - 25ms/step
Epoch 4/50
211/211 - 5s - loss: 3.2186 - accuracy30: 0.4176 - val_loss: 3.2150 - val_accuracy30: 0.4143 - 5s/epoch - 25ms/step
Epoch 5/50
211/211 - 5s - loss: 3.2029 - accuracy30: 0.4234 - val_loss: 3.2036 - val_accuracy30: 0.4201 - 5s/epoch - 25ms/step
Epoch 6/50
211/211 - 5s - loss: 3.1891 - accuracy30: 0.4331 - val_loss: 3.2038 - val_accuracy30: 0.4176 - 5s/epoch - 26ms/step
Epoch 7/50
211/211 - 5s - loss: 3.1736 - accuracy30: 0.4408 - val_loss: 3.1961 - val_accuracy30: 0.4258 - 5s/epoch - 26ms/step
Epoch 8/50
211/211 - 5s - loss: 3.1625 - accuracy30: 0.4462 - val_loss: 3.1882 - val_accuracy30: 0.4293 - 5s/epoch - 26ms/step
Epoch 9/50
211/211 - 6s - loss: 3.1468 - accuracy30: 0.4509 - val_loss: 3.1904 - val_accuracy30: 0.4305 - 6s/epoch - 26ms/step
Epoch 10/50
211/211 - 5s - loss: 3.1349 - accuracy30: 0.4580 - val_loss: 3.1845 - val_accuracy30: 0.4328 - 5s/epoch - 26ms/step
Epoch 11/50
211/211 - 5s - loss: 3.1269 - accuracy30: 0.4593 - val_loss: 3.1893 - val_accuracy30: 0.4334 - 5s/epoch - 24ms/step
Epoch 12/50
211/211 - 5s - loss: 3.1154 - accuracy30: 0.4636 - val_loss: 3.1809 - val_accuracy30: 0.4392 - 5s/epoch - 24ms/step
Epoch 13/50
211/211 - 5s - loss: 3.1090 - accuracy30: 0.4652 - val_loss: 3.1727 - val_accuracy30: 0.4382 - 5s/epoch - 24ms/step
Epoch 14/50
211/211 - 5s - loss: 3.0964 - accuracy30: 0.4704 - val_loss: 3.1900 - val_accuracy30: 0.4358 - 5s/epoch - 25ms/step
Epoch 15/50
211/211 - 5s - loss: 3.0907 - accuracy30: 0.4712 - val_loss: 3.1827 - val_accuracy30: 0.4381 - 5s/epoch - 25ms/step
Epoch 16/50
211/211 - 5s - loss: 3.0830 - accuracy30: 0.4743 - val_loss: 3.1774 - val_accuracy30: 0.4386 - 5s/epoch - 23ms/step
Epoch 17/50
211/211 - 5s - loss: 3.0780 - accuracy30: 0.4772 - val_loss: 3.1930 - val_accuracy30: 0.4322 - 5s/epoch - 25ms/step
Epoch 18/50
211/211 - 5s - loss: 3.0702 - accuracy30: 0.4804 - val_loss: 3.1929 - val_accuracy30: 0.4341 - 5s/epoch - 24ms/step
Epoch 19/50
211/211 - 5s - loss: 3.0593 - accuracy30: 0.4848 - val_loss: 3.2110 - val_accuracy30: 0.4282 - 5s/epoch - 26ms/step
Epoch 20/50
211/211 - 5s - loss: 3.0511 - accuracy30: 0.4847 - val_loss: 3.2061 - val_accuracy30: 0.4298 - 5s/epoch - 25ms/step
Epoch 21/50
211/211 - 5s - loss: 3.0445 - accuracy30: 0.4868 - val_loss: 3.2147 - val_accuracy30: 0.4293 - 5s/epoch - 24ms/step
Epoch 22/50
211/211 - 5s - loss: 3.0425 - accuracy30: 0.4879 - val_loss: 3.2233 - val_accuracy30: 0.4220 - 5s/epoch - 25ms/step
Epoch 23/50
211/211 - 5s - loss: 3.0336 - accuracy30: 0.4906 - val_loss: 3.2041 - val_accuracy30: 0.4293 - 5s/epoch - 25ms/step
testing model: results/LILAK/W6/deepVOL_L2/h30
Evaluating performance on  test set...
1059/1059 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0687013
{'0': {'precision': 0.4231314261360609, 'recall': 0.42043914626916234, 'f1-score': 0.4217809899581012, 'support': 94456}, '1': {'precision': 0.439472318184259, 'recall': 0.3230441304176206, 'f1-score': 0.3723695485671386, 'support': 76002}, '2': {'precision': 0.4320903209856195, 'recall': 0.5211462195231042, 'f1-score': 0.4724582571163394, 'support': 100609}, 'accuracy': 0.43050980016010804, 'macro avg': {'precision': 0.4315646884353132, 'recall': 0.4215431654032957, 'f1-score': 0.42220293188052643, 'support': 271067}, 'weighted avg': {'precision': 0.4310382754735546, 'recall': 0.43050980016010804, 'f1-score': 0.4267362991728977, 'support': 271067}}
[[39713 13809 40934]
 [23471 24552 27979]
 [30671 17506 52432]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0436289
{'0': {'precision': 0.4665979514269149, 'recall': 0.3902899019290872, 'f1-score': 0.42504621343270443, 'support': 18558}, '1': {'precision': 0.5004544628249409, 'recall': 0.4634160026933004, 'f1-score': 0.48122359796067005, 'support': 17822}, '2': {'precision': 0.4214653718141613, 'recall': 0.5258547130098413, 'f1-score': 0.46790848349868397, 'support': 17579}, 'accuracy': 0.45860746122055634, 'macro avg': {'precision': 0.46283926202200565, 'recall': 0.459853539210743, 'f1-score': 0.45805943163068613, 'support': 53959}, 'weighted avg': {'precision': 0.4630768544666863, 'recall': 0.45860746122055634, 'f1-score': 0.4575647773895468, 'support': 53959}}
[[7243 4163 7152]
 [4026 8259 5537]
 [4254 4081 9244]]
Evaluating performance on  val set...
81/81 - 1s - 773ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0588728
{'0': {'precision': 0.4433006807238917, 'recall': 0.3728529534981148, 'f1-score': 0.4050364077669903, 'support': 7161}, '1': {'precision': 0.47963720433932067, 'recall': 0.41371375977910724, 'f1-score': 0.4442431230439796, 'support': 6519}, '2': {'precision': 0.4174174174174174, 'recall': 0.5394566623544631, 'f1-score': 0.47065462753950343, 'support': 6957}, 'accuracy': 0.4419246983573194, 'macro avg': {'precision': 0.4467851008268766, 'recall': 0.44200779187722833, 'f1-score': 0.4399780527834911, 'support': 20637}, 'weighted avg': {'precision': 0.4460534032429516, 'recall': 0.4419246983573194, 'f1-score': 0.4395421271955927, 'support': 20637}}
[[2670 1480 3011]
 [1595 2697 2227]
 [1758 1446 3753]]
training model: results/LILAK/W6/deepVOL_L2/h50
Epoch 1/50
211/211 - 7s - loss: 3.3536 - accuracy50: 0.3467 - val_loss: 3.3369 - val_accuracy50: 0.3430 - 7s/epoch - 35ms/step
Epoch 2/50
211/211 - 5s - loss: 3.3160 - accuracy50: 0.3568 - val_loss: 3.3063 - val_accuracy50: 0.3529 - 5s/epoch - 25ms/step
Epoch 3/50
211/211 - 5s - loss: 3.2940 - accuracy50: 0.3672 - val_loss: 3.3008 - val_accuracy50: 0.3626 - 5s/epoch - 25ms/step
Epoch 4/50
211/211 - 5s - loss: 3.2814 - accuracy50: 0.3738 - val_loss: 3.2940 - val_accuracy50: 0.3721 - 5s/epoch - 25ms/step
Epoch 5/50
211/211 - 5s - loss: 3.2675 - accuracy50: 0.3821 - val_loss: 3.2920 - val_accuracy50: 0.3785 - 5s/epoch - 26ms/step
Epoch 6/50
211/211 - 6s - loss: 3.2572 - accuracy50: 0.3933 - val_loss: 3.2688 - val_accuracy50: 0.3842 - 6s/epoch - 27ms/step
Epoch 7/50
211/211 - 6s - loss: 3.2441 - accuracy50: 0.3982 - val_loss: 3.2792 - val_accuracy50: 0.3746 - 6s/epoch - 26ms/step
Epoch 8/50
211/211 - 5s - loss: 3.2390 - accuracy50: 0.4046 - val_loss: 3.2676 - val_accuracy50: 0.3860 - 5s/epoch - 26ms/step
Epoch 9/50
211/211 - 5s - loss: 3.2277 - accuracy50: 0.4084 - val_loss: 3.2767 - val_accuracy50: 0.3821 - 5s/epoch - 25ms/step
Epoch 10/50
211/211 - 5s - loss: 3.2145 - accuracy50: 0.4181 - val_loss: 3.2467 - val_accuracy50: 0.3961 - 5s/epoch - 25ms/step
Epoch 11/50
211/211 - 5s - loss: 3.2045 - accuracy50: 0.4227 - val_loss: 3.2461 - val_accuracy50: 0.3993 - 5s/epoch - 25ms/step
Epoch 12/50
211/211 - 5s - loss: 3.1977 - accuracy50: 0.4252 - val_loss: 3.2468 - val_accuracy50: 0.3976 - 5s/epoch - 25ms/step
Epoch 13/50
211/211 - 5s - loss: 3.1846 - accuracy50: 0.4325 - val_loss: 3.2451 - val_accuracy50: 0.4017 - 5s/epoch - 25ms/step
Epoch 14/50
211/211 - 5s - loss: 3.1788 - accuracy50: 0.4351 - val_loss: 3.2511 - val_accuracy50: 0.4003 - 5s/epoch - 24ms/step
Epoch 15/50
211/211 - 5s - loss: 3.1688 - accuracy50: 0.4390 - val_loss: 3.2558 - val_accuracy50: 0.4028 - 5s/epoch - 25ms/step
Epoch 16/50
211/211 - 5s - loss: 3.1599 - accuracy50: 0.4437 - val_loss: 3.2515 - val_accuracy50: 0.4055 - 5s/epoch - 24ms/step
Epoch 17/50
211/211 - 5s - loss: 3.1495 - accuracy50: 0.4487 - val_loss: 3.2569 - val_accuracy50: 0.3970 - 5s/epoch - 25ms/step
Epoch 18/50
211/211 - 5s - loss: 3.1402 - accuracy50: 0.4540 - val_loss: 3.2591 - val_accuracy50: 0.4022 - 5s/epoch - 25ms/step
Epoch 19/50
211/211 - 5s - loss: 3.1361 - accuracy50: 0.4536 - val_loss: 3.2558 - val_accuracy50: 0.4040 - 5s/epoch - 24ms/step
Epoch 20/50
211/211 - 5s - loss: 3.1210 - accuracy50: 0.4590 - val_loss: 3.2655 - val_accuracy50: 0.4038 - 5s/epoch - 25ms/step
Epoch 21/50
211/211 - 5s - loss: 3.1195 - accuracy50: 0.4598 - val_loss: 3.2746 - val_accuracy50: 0.4015 - 5s/epoch - 25ms/step
Epoch 22/50
211/211 - 5s - loss: 3.1082 - accuracy50: 0.4647 - val_loss: 3.2698 - val_accuracy50: 0.4050 - 5s/epoch - 25ms/step
Epoch 23/50
211/211 - 5s - loss: 3.0990 - accuracy50: 0.4679 - val_loss: 3.2768 - val_accuracy50: 0.4028 - 5s/epoch - 25ms/step
testing model: results/LILAK/W6/deepVOL_L2/h50
Evaluating performance on  test set...
1059/1059 - 12s - 12s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0904852
{'0': {'precision': 0.39020238735820256, 'recall': 0.38922785378624397, 'f1-score': 0.3897145113350955, 'support': 91291}, '1': {'precision': 0.36325193234009184, 'recall': 0.31856863924944434, 'f1-score': 0.3394461200269547, 'support': 81433}, '2': {'precision': 0.4087191954912145, 'recall': 0.45129800799243464, 'f1-score': 0.4289545790625861, 'support': 98343}, 'accuracy': 0.3905196870146495, 'macro avg': {'precision': 0.38739117172983634, 'recall': 0.386364833676041, 'f1-score': 0.3860384034748788, 'support': 271067}, 'weighted avg': {'precision': 0.38882391656955984, 'recall': 0.3905196870146495, 'f1-score': 0.38884933804262084, 'support': 271067}}
[[35533 20233 35525]
 [26810 25942 28681]
 [28720 25241 44382]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0693157
{'0': {'precision': 0.4382700528036208, 'recall': 0.3772319013093821, 'f1-score': 0.4054667054376272, 'support': 18482}, '1': {'precision': 0.4211535389039783, 'recall': 0.44107312175804564, 'f1-score': 0.43088323434860787, 'support': 17929}, '2': {'precision': 0.4089446923316385, 'recall': 0.4491679963528607, 'f1-score': 0.4281136277225571, 'support': 17548}, 'accuracy': 0.4218388035360181, 'macro avg': {'precision': 0.4227894280130792, 'recall': 0.4224910064734295, 'f1-score': 0.421487855836264, 'support': 53959}, 'weighted avg': {'precision': 0.4230458380615197, 'recall': 0.4218388035360181, 'f1-score': 0.4212768787006773, 'support': 53959}}
[[6972 5596 5914]
 [4543 7908 5478]
 [4393 5273 7882]]
Evaluating performance on  val set...
81/81 - 1s - 816ms/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0830116
{'0': {'precision': 0.41347851677457326, 'recall': 0.389196675900277, 'f1-score': 0.40097031963470314, 'support': 7220}, '1': {'precision': 0.397685845617372, 'recall': 0.38881140554780724, 'f1-score': 0.3931985582197147, 'support': 6453}, '2': {'precision': 0.39020180562931495, 'recall': 0.422027570361861, 'f1-score': 0.40549116997792495, 'support': 6964}, 'accuracy': 0.40015506129766926, 'macro avg': {'precision': 0.4004553893404201, 'recall': 0.40001188393664844, 'f1-score': 0.3998866826107809, 'support': 20637}, 'weighted avg': {'precision': 0.4006855176277497, 'recall': 0.40015506129766926, 'f1-score': 0.4000657320192201, 'support': 20637}}
[[2810 1863 2547]
 [1898 2509 2046]
 [2088 1937 2939]]
training model: results/LILAK/W6/deepVOL_L2/h100
Epoch 1/50
211/211 - 8s - loss: 3.3596 - accuracy100: 0.3456 - val_loss: 3.3620 - val_accuracy100: 0.3400 - 8s/epoch - 38ms/step
Epoch 2/50
211/211 - 5s - loss: 3.3151 - accuracy100: 0.3587 - val_loss: 3.3564 - val_accuracy100: 0.3409 - 5s/epoch - 25ms/step
Epoch 3/50
211/211 - 5s - loss: 3.2959 - accuracy100: 0.3673 - val_loss: 3.3494 - val_accuracy100: 0.3369 - 5s/epoch - 26ms/step
Epoch 4/50
211/211 - 5s - loss: 3.2834 - accuracy100: 0.3722 - val_loss: 3.3245 - val_accuracy100: 0.3460 - 5s/epoch - 25ms/step
Epoch 5/50
211/211 - 5s - loss: 3.2733 - accuracy100: 0.3835 - val_loss: 3.3364 - val_accuracy100: 0.3502 - 5s/epoch - 24ms/step
Epoch 6/50
211/211 - 5s - loss: 3.2649 - accuracy100: 0.3856 - val_loss: 3.3326 - val_accuracy100: 0.3514 - 5s/epoch - 25ms/step
Epoch 7/50
211/211 - 5s - loss: 3.2564 - accuracy100: 0.3915 - val_loss: 3.3234 - val_accuracy100: 0.3569 - 5s/epoch - 25ms/step
Epoch 8/50
211/211 - 5s - loss: 3.2520 - accuracy100: 0.3959 - val_loss: 3.3288 - val_accuracy100: 0.3563 - 5s/epoch - 25ms/step
Epoch 9/50
211/211 - 5s - loss: 3.2454 - accuracy100: 0.4007 - val_loss: 3.3396 - val_accuracy100: 0.3526 - 5s/epoch - 24ms/step
Epoch 10/50
211/211 - 5s - loss: 3.2372 - accuracy100: 0.4048 - val_loss: 3.3342 - val_accuracy100: 0.3526 - 5s/epoch - 25ms/step
Epoch 11/50
211/211 - 5s - loss: 3.2285 - accuracy100: 0.4087 - val_loss: 3.3375 - val_accuracy100: 0.3569 - 5s/epoch - 25ms/step
Epoch 12/50
211/211 - 5s - loss: 3.2207 - accuracy100: 0.4134 - val_loss: 3.3538 - val_accuracy100: 0.3544 - 5s/epoch - 25ms/step
Epoch 13/50
211/211 - 5s - loss: 3.2118 - accuracy100: 0.4170 - val_loss: 3.3564 - val_accuracy100: 0.3545 - 5s/epoch - 25ms/step
Epoch 14/50
211/211 - 5s - loss: 3.2025 - accuracy100: 0.4202 - val_loss: 3.3840 - val_accuracy100: 0.3547 - 5s/epoch - 25ms/step
Epoch 15/50
211/211 - 5s - loss: 3.1993 - accuracy100: 0.4262 - val_loss: 3.3634 - val_accuracy100: 0.3552 - 5s/epoch - 24ms/step
Epoch 16/50
211/211 - 5s - loss: 3.1903 - accuracy100: 0.4276 - val_loss: 3.3988 - val_accuracy100: 0.3518 - 5s/epoch - 25ms/step
Epoch 17/50
211/211 - 5s - loss: 3.1820 - accuracy100: 0.4330 - val_loss: 3.3905 - val_accuracy100: 0.3554 - 5s/epoch - 25ms/step
testing model: results/LILAK/W6/deepVOL_L2/h100
Evaluating performance on  test set...
1059/1059 - 12s - 12s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1064787
{'0': {'precision': 0.3373992906783657, 'recall': 0.1927166276346604, 'f1-score': 0.24531409535024104, 'support': 85400}, '1': {'precision': 0.3584219439740137, 'recall': 0.14286662830330663, 'f1-score': 0.20429962890578637, 'support': 90364}, '2': {'precision': 0.3645373089456646, 'recall': 0.7124854411718414, 'f1-score': 0.4823064793374341, 'support': 95303}, 'accuracy': 0.35884117210874067, 'macro avg': {'precision': 0.35345284786601466, 'recall': 0.3493562323699361, 'f1-score': 0.31064006786448717, 'support': 271067}, 'weighted avg': {'precision': 0.35394879909265564, 'recall': 0.35884117210874067, 'f1-score': 0.3149642332325534, 'support': 271067}}
[[16458 11034 57908]
 [16995 12910 60459]
 [15326 12075 67902]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0997437
{'0': {'precision': 0.4113070539419087, 'recall': 0.21274883296667918, 'f1-score': 0.2804399335148707, 'support': 18637}, '1': {'precision': 0.3737473710256093, 'recall': 0.1735708129847745, 'f1-score': 0.2370527306967985, 'support': 17405}, '2': {'precision': 0.3558063803951871, 'recall': 0.719595914494614, 'f1-score': 0.47616937196461884, 'support': 17917}, 'accuracy': 0.3684093478381734, 'macro avg': {'precision': 0.38028693512090167, 'recall': 0.36863852014868925, 'f1-score': 0.3312206787254293, 'support': 53959}, 'weighted avg': {'precision': 0.38076290284394904, 'recall': 0.3684093478381734, 'f1-score': 0.33143661773169447, 'support': 53959}}
[[ 3965  2708 11964]
 [ 3005  3021 11379]
 [ 2670  2354 12893]]
Evaluating performance on  val set...
81/81 - 1s - 808ms/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1056232
{'0': {'precision': 0.34192037470725994, 'recall': 0.17758856621559982, 'f1-score': 0.23376363454418098, 'support': 6577}, '1': {'precision': 0.40307486631016043, 'recall': 0.16502463054187191, 'f1-score': 0.2341747572815534, 'support': 7308}, '2': {'precision': 0.3489352730339448, 'recall': 0.7353376777251185, 'f1-score': 0.47328535341499445, 'support': 6752}, 'accuracy': 0.35562339487328587, 'macro avg': {'precision': 0.36464350468378837, 'recall': 0.35931695816086345, 'f1-score': 0.31374124841357626, 'support': 20637}, 'weighted avg': {'precision': 0.3658716088079419, 'recall': 0.35562339487328587, 'f1-score': 0.3122757792735724, 'support': 20637}}
[[1168  985 4424]
 [1262 1206 4840]
 [ 986  801 4965]]
training model: results/LILAK/W6/deepVOL_L2/h200
Epoch 1/50
211/211 - 7s - loss: 3.3554 - accuracy200: 0.3500 - val_loss: 3.3485 - val_accuracy200: 0.3434 - 7s/epoch - 35ms/step
Epoch 2/50
211/211 - 5s - loss: 3.3226 - accuracy200: 0.3507 - val_loss: 3.3337 - val_accuracy200: 0.3438 - 5s/epoch - 24ms/step
Epoch 3/50
211/211 - 5s - loss: 3.3072 - accuracy200: 0.3545 - val_loss: 3.3303 - val_accuracy200: 0.3513 - 5s/epoch - 25ms/step
Epoch 4/50
211/211 - 5s - loss: 3.2911 - accuracy200: 0.3631 - val_loss: 3.3306 - val_accuracy200: 0.3518 - 5s/epoch - 24ms/step
Epoch 5/50
211/211 - 5s - loss: 3.2841 - accuracy200: 0.3688 - val_loss: 3.3130 - val_accuracy200: 0.3599 - 5s/epoch - 25ms/step
Epoch 6/50
211/211 - 5s - loss: 3.2696 - accuracy200: 0.3806 - val_loss: 3.3156 - val_accuracy200: 0.3559 - 5s/epoch - 26ms/step
Epoch 7/50
211/211 - 5s - loss: 3.2628 - accuracy200: 0.3839 - val_loss: 3.3143 - val_accuracy200: 0.3572 - 5s/epoch - 26ms/step
Epoch 8/50
211/211 - 5s - loss: 3.2539 - accuracy200: 0.3939 - val_loss: 3.3144 - val_accuracy200: 0.3610 - 5s/epoch - 26ms/step
Epoch 9/50
211/211 - 5s - loss: 3.2412 - accuracy200: 0.4020 - val_loss: 3.3185 - val_accuracy200: 0.3583 - 5s/epoch - 25ms/step
Epoch 10/50
211/211 - 5s - loss: 3.2373 - accuracy200: 0.4021 - val_loss: 3.3249 - val_accuracy200: 0.3607 - 5s/epoch - 26ms/step
Epoch 11/50
211/211 - 6s - loss: 3.2296 - accuracy200: 0.4074 - val_loss: 3.3304 - val_accuracy200: 0.3590 - 6s/epoch - 27ms/step
Epoch 12/50
211/211 - 5s - loss: 3.2216 - accuracy200: 0.4134 - val_loss: 3.3320 - val_accuracy200: 0.3606 - 5s/epoch - 25ms/step
Epoch 13/50
211/211 - 5s - loss: 3.2123 - accuracy200: 0.4181 - val_loss: 3.3381 - val_accuracy200: 0.3579 - 5s/epoch - 25ms/step
Epoch 14/50
211/211 - 5s - loss: 3.2027 - accuracy200: 0.4259 - val_loss: 3.3443 - val_accuracy200: 0.3567 - 5s/epoch - 25ms/step
Epoch 15/50
211/211 - 5s - loss: 3.2019 - accuracy200: 0.4245 - val_loss: 3.3408 - val_accuracy200: 0.3583 - 5s/epoch - 25ms/step
testing model: results/LILAK/W6/deepVOL_L2/h200
Evaluating performance on  test set...
1059/1059 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1080883
{'0': {'precision': 0.3073924024884308, 'recall': 0.2209954177634786, 'f1-score': 0.257130500747967, 'support': 82056}, '1': {'precision': 0.37509083794510595, 'recall': 0.14076824637589946, 'f1-score': 0.20471047653914212, 'support': 95334}, '2': {'precision': 0.3566671960793211, 'recall': 0.6712319993168013, 'f1-score': 0.4658169520655769, 'support': 93677}, 'accuracy': 0.34837512496910356, 'macro avg': {'precision': 0.3463834788376193, 'recall': 0.3443318878187265, 'f1-score': 0.3092193097842287, 'support': 271067}, 'weighted avg': {'precision': 0.3482305623715612, 'recall': 0.34837512496910356, 'f1-score': 0.31081357582592056, 'support': 271067}}
[[18134 11149 52773]
 [21270 13420 60644]
 [19589 11209 62879]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0973015
{'0': {'precision': 0.38851444926599576, 'recall': 0.22777958211540544, 'f1-score': 0.2871864869476199, 'support': 18474}, '1': {'precision': 0.3853234798392325, 'recall': 0.1707064905226881, 'f1-score': 0.23659594793615413, 'support': 17410}, '2': {'precision': 0.35499082309755753, 'recall': 0.6955463347164592, 'f1-score': 0.47006917180781455, 'support': 18075}, 'accuracy': 0.3660557089642136, 'macro avg': {'precision': 0.3762762507342619, 'recall': 0.3646774691181842, 'f1-score': 0.3312838688971962, 'support': 53959}, 'weighted avg': {'precision': 0.3762552465247576, 'recall': 0.3660557089642136, 'f1-score': 0.33212474089336386, 'support': 53959}}
[[ 4208  2525 11741]
 [ 3336  2972 11102]
 [ 3287  2216 12572]]
Evaluating performance on  val set...
81/81 - 1s - 844ms/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1044561
{'0': {'precision': 0.3661161161161161, 'recall': 0.20810810810810812, 'f1-score': 0.2653727553056412, 'support': 7030}, '1': {'precision': 0.3402021772939347, 'recall': 0.13412017167381973, 'f1-score': 0.19239226033421286, 'support': 6524}, '2': {'precision': 0.35738147700618383, 'recall': 0.7098686997035154, 'f1-score': 0.47541603630862334, 'support': 7083}, 'accuracy': 0.35693172457237, 'macro avg': {'precision': 0.35456659013874486, 'recall': 0.35069899316181435, 'f1-score': 0.31106035064949245, 'support': 20637}, 'weighted avg': {'precision': 0.3549260213498438, 'recall': 0.35693172457237, 'f1-score': 0.3143920803117236, 'support': 20637}}
[[1463  897 4670]
 [1278  875 4371]
 [1255  800 5028]]
training model: results/LILAK/W6/deepVOL_L2/h300
Epoch 1/50
211/211 - 8s - loss: 3.3545 - accuracy300: 0.3523 - val_loss: 3.3551 - val_accuracy300: 0.3418 - 8s/epoch - 36ms/step
Epoch 2/50
211/211 - 5s - loss: 3.3118 - accuracy300: 0.3620 - val_loss: 3.3232 - val_accuracy300: 0.3474 - 5s/epoch - 26ms/step
Epoch 3/50
211/211 - 5s - loss: 3.2955 - accuracy300: 0.3693 - val_loss: 3.3094 - val_accuracy300: 0.3541 - 5s/epoch - 25ms/step
Epoch 4/50
211/211 - 5s - loss: 3.2810 - accuracy300: 0.3751 - val_loss: 3.3110 - val_accuracy300: 0.3510 - 5s/epoch - 26ms/step
Epoch 5/50
211/211 - 5s - loss: 3.2658 - accuracy300: 0.3858 - val_loss: 3.3235 - val_accuracy300: 0.3555 - 5s/epoch - 26ms/step
Epoch 6/50
211/211 - 5s - loss: 3.2571 - accuracy300: 0.3913 - val_loss: 3.3176 - val_accuracy300: 0.3560 - 5s/epoch - 25ms/step
Epoch 7/50
211/211 - 6s - loss: 3.2493 - accuracy300: 0.3958 - val_loss: 3.3180 - val_accuracy300: 0.3571 - 6s/epoch - 26ms/step
Epoch 8/50
211/211 - 6s - loss: 3.2389 - accuracy300: 0.4018 - val_loss: 3.3275 - val_accuracy300: 0.3548 - 6s/epoch - 26ms/step
Epoch 9/50
211/211 - 5s - loss: 3.2293 - accuracy300: 0.4106 - val_loss: 3.3316 - val_accuracy300: 0.3538 - 5s/epoch - 25ms/step
Epoch 10/50
211/211 - 5s - loss: 3.2258 - accuracy300: 0.4098 - val_loss: 3.3279 - val_accuracy300: 0.3625 - 5s/epoch - 25ms/step
Epoch 11/50
211/211 - 5s - loss: 3.2167 - accuracy300: 0.4144 - val_loss: 3.3479 - val_accuracy300: 0.3556 - 5s/epoch - 25ms/step
Epoch 12/50
211/211 - 5s - loss: 3.2092 - accuracy300: 0.4192 - val_loss: 3.3458 - val_accuracy300: 0.3575 - 5s/epoch - 25ms/step
Epoch 13/50
211/211 - 5s - loss: 3.1975 - accuracy300: 0.4249 - val_loss: 3.3558 - val_accuracy300: 0.3542 - 5s/epoch - 25ms/step
testing model: results/LILAK/W6/deepVOL_L2/h300
Evaluating performance on  test set...
1059/1059 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1010728
{'0': {'precision': 0.30256968128895684, 'recall': 0.12307894705368783, 'f1-score': 0.1749798087141339, 'support': 83613}, '1': {'precision': 0.37790013808151923, 'recall': 0.24181601998407382, 'f1-score': 0.29491665225431374, 'support': 91673}, '2': {'precision': 0.36692377546330035, 'recall': 0.6834027625520719, 'f1-score': 0.4774833591684142, 'support': 95781}, 'accuracy': 0.3612243467482209, 'macro avg': {'precision': 0.3491311982779255, 'recall': 0.34943257652994447, 'f1-score': 0.31579327337895396, 'support': 271067}, 'weighted avg': {'precision': 0.35078531970919014, 'recall': 0.3612243467482209, 'f1-score': 0.32243067076639526, 'support': 271067}}
[[10291 18094 55228]
 [11796 22168 57709]
 [11925 18399 65457]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0987636
{'0': {'precision': 0.37019298492745456, 'recall': 0.14616240266963293, 'f1-score': 0.20957773435942426, 'support': 17980}, '1': {'precision': 0.3908862257730433, 'recall': 0.28994732221246705, 'f1-score': 0.332934282653897, 'support': 18224}, '2': {'precision': 0.3511487013376522, 'recall': 0.6594198817234582, 'f1-score': 0.45826565160381233, 'support': 17755}, 'accuracy': 0.36360940714246004, 'macro avg': {'precision': 0.37074263734605006, 'recall': 0.3651765355351861, 'f1-score': 0.3335925562057112, 'support': 53959}, 'weighted avg': {'precision': 0.3709154291171739, 'recall': 0.36360940714246004, 'f1-score': 0.3330697135805473, 'support': 53959}}
[[ 2628  4293 11059]
 [ 2365  5284 10575]
 [ 2106  3941 11708]]
Evaluating performance on  val set...
81/81 - 1s - 790ms/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1035727
{'0': {'precision': 0.33711967545638943, 'recall': 0.12539610683567226, 'f1-score': 0.1827980642322921, 'support': 6627}, '1': {'precision': 0.3905990016638935, 'recall': 0.2604354458466232, 'f1-score': 0.3125052000998419, 'support': 7211}, '2': {'precision': 0.3477252319664771, 'recall': 0.6834828651272246, 'f1-score': 0.4609433120071418, 'support': 6799}, 'accuracy': 0.35644715801715365, 'macro avg': {'precision': 0.35848130302892, 'recall': 0.35643813926983997, 'f1-score': 0.3187488587797586, 'support': 20637}, 'weighted avg': {'precision': 0.359300544768518, 'recall': 0.35644715801715365, 'f1-score': 0.3197572974717215, 'support': 20637}}
[[ 831 1528 4268]
 [ 884 1878 4449]
 [ 750 1402 4647]]
training model: results/LILAK/W6/deepVOL_L2/h500
Epoch 1/50
211/211 - 8s - loss: 3.3560 - accuracy500: 0.3533 - val_loss: 3.3749 - val_accuracy500: 0.3414 - 8s/epoch - 38ms/step
Epoch 2/50
211/211 - 5s - loss: 3.3222 - accuracy500: 0.3577 - val_loss: 3.3262 - val_accuracy500: 0.3465 - 5s/epoch - 25ms/step
Epoch 3/50
211/211 - 5s - loss: 3.2947 - accuracy500: 0.3686 - val_loss: 3.3221 - val_accuracy500: 0.3487 - 5s/epoch - 25ms/step
Epoch 4/50
211/211 - 5s - loss: 3.2885 - accuracy500: 0.3721 - val_loss: 3.3128 - val_accuracy500: 0.3522 - 5s/epoch - 24ms/step
Epoch 5/50
211/211 - 5s - loss: 3.2731 - accuracy500: 0.3765 - val_loss: 3.3155 - val_accuracy500: 0.3565 - 5s/epoch - 25ms/step
Epoch 6/50
211/211 - 5s - loss: 3.2690 - accuracy500: 0.3814 - val_loss: 3.3138 - val_accuracy500: 0.3549 - 5s/epoch - 24ms/step
Epoch 7/50
211/211 - 5s - loss: 3.2553 - accuracy500: 0.3877 - val_loss: 3.3107 - val_accuracy500: 0.3642 - 5s/epoch - 25ms/step
Epoch 8/50
211/211 - 5s - loss: 3.2440 - accuracy500: 0.3932 - val_loss: 3.3167 - val_accuracy500: 0.3605 - 5s/epoch - 25ms/step
Epoch 9/50
211/211 - 5s - loss: 3.2335 - accuracy500: 0.4020 - val_loss: 3.3120 - val_accuracy500: 0.3665 - 5s/epoch - 25ms/step
Epoch 10/50
211/211 - 5s - loss: 3.2215 - accuracy500: 0.4087 - val_loss: 3.3193 - val_accuracy500: 0.3675 - 5s/epoch - 25ms/step
Epoch 11/50
211/211 - 5s - loss: 3.2115 - accuracy500: 0.4138 - val_loss: 3.3228 - val_accuracy500: 0.3701 - 5s/epoch - 25ms/step
Epoch 12/50
211/211 - 5s - loss: 3.2003 - accuracy500: 0.4197 - val_loss: 3.3334 - val_accuracy500: 0.3661 - 5s/epoch - 25ms/step
Epoch 13/50
211/211 - 5s - loss: 3.1899 - accuracy500: 0.4280 - val_loss: 3.3334 - val_accuracy500: 0.3687 - 5s/epoch - 25ms/step
Epoch 14/50
211/211 - 5s - loss: 3.1738 - accuracy500: 0.4331 - val_loss: 3.3459 - val_accuracy500: 0.3719 - 5s/epoch - 25ms/step
Epoch 15/50
211/211 - 5s - loss: 3.1643 - accuracy500: 0.4369 - val_loss: 3.3791 - val_accuracy500: 0.3688 - 5s/epoch - 25ms/step
Epoch 16/50
211/211 - 5s - loss: 3.1545 - accuracy500: 0.4438 - val_loss: 3.3769 - val_accuracy500: 0.3674 - 5s/epoch - 25ms/step
Epoch 17/50
211/211 - 5s - loss: 3.1443 - accuracy500: 0.4470 - val_loss: 3.3768 - val_accuracy500: 0.3672 - 5s/epoch - 24ms/step
testing model: results/LILAK/W6/deepVOL_L2/h500
Evaluating performance on  test set...
1059/1059 - 12s - 12s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1007723
{'0': {'precision': 0.3222335320633997, 'recall': 0.07641906338368164, 'f1-score': 0.12354006968641115, 'support': 86994}, '1': {'precision': 0.33998175841952194, 'recall': 0.24366659266385457, 'f1-score': 0.2838770862221328, 'support': 81078}, '2': {'precision': 0.39265937699854936, 'recall': 0.7332297684353609, 'f1-score': 0.5114349760600294, 'support': 102995}, 'accuracy': 0.37600666993769066, 'macro avg': {'precision': 0.35162488916049034, 'recall': 0.351105141494299, 'f1-score': 0.30628404398952447, 'support': 271067}, 'weighted avg': {'precision': 0.35430125183599254, 'recall': 0.37600666993769066, 'f1-score': 0.31888306794379423, 'support': 271067}}
[[ 6648 18656 61690]
 [ 6204 19756 55118]
 [ 7779 19697 75519]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0938225
{'0': {'precision': 0.38321620504340637, 'recall': 0.10186253502554804, 'f1-score': 0.16094448543773598, 'support': 18201}, '1': {'precision': 0.41460176991150444, 'recall': 0.31261120996441283, 'f1-score': 0.35645447628709104, 'support': 17984}, '2': {'precision': 0.3638536599083265, 'recall': 0.7279734443569258, 'f1-score': 0.4851973375832005, 'support': 17774}, 'accuracy': 0.3783428158416576, 'macro avg': {'precision': 0.38722387828774574, 'recall': 0.38081572978229555, 'f1-score': 0.33419876643600915, 'support': 53959}, 'weighted avg': {'precision': 0.3872987143811807, 'recall': 0.3783428158416576, 'f1-score': 0.3329143490280228, 'support': 53959}}
[[ 1854  4471 11876]
 [ 1616  5622 10746]
 [ 1368  3467 12939]]
Evaluating performance on  val set...
81/81 - 1s - 826ms/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1045917
{'0': {'precision': 0.3587533156498674, 'recall': 0.07858803021499128, 'f1-score': 0.12893231649189704, 'support': 6884}, '1': {'precision': 0.3743820224719101, 'recall': 0.24977511244377812, 'f1-score': 0.2996402877697842, 'support': 6670}, '2': {'precision': 0.36289938006676203, 'recall': 0.7520824509388677, 'f1-score': 0.48956897343994116, 'support': 7083}, 'accuracy': 0.36507244270000483, 'macro avg': {'precision': 0.3653449060628466, 'recall': 0.36014853119921236, 'f1-score': 0.30604719256720747, 'support': 20637}, 'weighted avg': {'precision': 0.365227611757242, 'recall': 0.36507244270000483, 'f1-score': 0.3078833078950324, 'support': 20637}}
[[ 541 1545 4798]
 [ 450 1666 4554]
 [ 517 1239 5327]]
training model: results/LILAK/W6/deepVOL_L2/h1000
Epoch 1/50
211/211 - 8s - loss: 3.3464 - accuracy1000: 0.3600 - val_loss: 3.3621 - val_accuracy1000: 0.3378 - 8s/epoch - 37ms/step
Epoch 2/50
211/211 - 6s - loss: 3.3235 - accuracy1000: 0.3704 - val_loss: 3.3308 - val_accuracy1000: 0.3387 - 6s/epoch - 27ms/step
Epoch 3/50
211/211 - 6s - loss: 3.2982 - accuracy1000: 0.3716 - val_loss: 3.3082 - val_accuracy1000: 0.3438 - 6s/epoch - 26ms/step
Epoch 4/50
211/211 - 5s - loss: 3.2888 - accuracy1000: 0.3685 - val_loss: 3.3085 - val_accuracy1000: 0.3335 - 5s/epoch - 26ms/step
Epoch 5/50
211/211 - 5s - loss: 3.2830 - accuracy1000: 0.3697 - val_loss: 3.3014 - val_accuracy1000: 0.3395 - 5s/epoch - 26ms/step
Epoch 6/50
211/211 - 5s - loss: 3.2743 - accuracy1000: 0.3776 - val_loss: 3.3037 - val_accuracy1000: 0.3369 - 5s/epoch - 25ms/step
Epoch 7/50
211/211 - 5s - loss: 3.2706 - accuracy1000: 0.3784 - val_loss: 3.2991 - val_accuracy1000: 0.3456 - 5s/epoch - 25ms/step
Epoch 8/50
211/211 - 5s - loss: 3.2621 - accuracy1000: 0.3821 - val_loss: 3.3099 - val_accuracy1000: 0.3425 - 5s/epoch - 26ms/step
Epoch 9/50
211/211 - 5s - loss: 3.2547 - accuracy1000: 0.3883 - val_loss: 3.3100 - val_accuracy1000: 0.3462 - 5s/epoch - 25ms/step
Epoch 10/50
211/211 - 5s - loss: 3.2454 - accuracy1000: 0.3951 - val_loss: 3.3130 - val_accuracy1000: 0.3499 - 5s/epoch - 25ms/step
Epoch 11/50
211/211 - 5s - loss: 3.2413 - accuracy1000: 0.3986 - val_loss: 3.3131 - val_accuracy1000: 0.3453 - 5s/epoch - 26ms/step
Epoch 12/50
211/211 - 6s - loss: 3.2398 - accuracy1000: 0.3970 - val_loss: 3.3096 - val_accuracy1000: 0.3467 - 6s/epoch - 26ms/step
Epoch 13/50
211/211 - 6s - loss: 3.2264 - accuracy1000: 0.4051 - val_loss: 3.3246 - val_accuracy1000: 0.3454 - 6s/epoch - 26ms/step
Epoch 14/50
211/211 - 5s - loss: 3.2174 - accuracy1000: 0.4077 - val_loss: 3.3300 - val_accuracy1000: 0.3448 - 5s/epoch - 25ms/step
Epoch 15/50
211/211 - 5s - loss: 3.2132 - accuracy1000: 0.4146 - val_loss: 3.3361 - val_accuracy1000: 0.3448 - 5s/epoch - 25ms/step
Epoch 16/50
211/211 - 5s - loss: 3.2085 - accuracy1000: 0.4158 - val_loss: 3.3282 - val_accuracy1000: 0.3537 - 5s/epoch - 26ms/step
Epoch 17/50
211/211 - 5s - loss: 3.2015 - accuracy1000: 0.4200 - val_loss: 3.3382 - val_accuracy1000: 0.3493 - 5s/epoch - 25ms/step
testing model: results/LILAK/W6/deepVOL_L2/h1000
Evaluating performance on  test set...
1059/1059 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0955902
{'0': {'precision': 0.3111840306261963, 'recall': 0.1403482807952247, 'f1-score': 0.19344858653339453, 'support': 81084}, '1': {'precision': 0.3446725483542586, 'recall': 0.13872891579977692, 'f1-score': 0.19783162644247157, 'support': 87862}, '2': {'precision': 0.38410509558937994, 'recall': 0.748993840640025, 'f1-score': 0.5077974068394112, 'support': 102121}, 'accuracy': 0.36912276300693186, 'macro avg': {'precision': 0.34665389152327825, 'recall': 0.34269034574500895, 'f1-score': 0.29969253993842576, 'support': 271067}, 'weighted avg': {'precision': 0.34951086576189444, 'recall': 0.36912276300693186, 'f1-score': 0.31329614647599935, 'support': 271067}}
[[11380 10878 58826]
 [11854 12189 63819]
 [13336 12297 76488]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100155
{'0': {'precision': 0.38571428571428573, 'recall': 0.1526902569074164, 'f1-score': 0.21877532121773355, 'support': 18567}, '1': {'precision': 0.3938855765571483, 'recall': 0.16999726252395292, 'f1-score': 0.2374942634235888, 'support': 18265}, '2': {'precision': 0.3366988586479368, 'recall': 0.7613125474397151, 'f1-score': 0.4669041949402896, 'support': 17127}, 'accuracy': 0.3517300172353083, 'macro avg': {'precision': 0.3720995736397903, 'recall': 0.3613333556236948, 'f1-score': 0.30772459319387063, 'support': 53959}, 'weighted avg': {'precision': 0.3729223771889151, 'recall': 0.3517300172353083, 'f1-score': 0.3038696465320678, 'support': 53959}}
[[ 2835  2715 13017]
 [ 2490  3105 12670]
 [ 2025  2063 13039]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1030344
{'0': {'precision': 0.370022539444027, 'recall': 0.14528023598820058, 'f1-score': 0.20864223681423427, 'support': 6780}, '1': {'precision': 0.36102348405187523, 'recall': 0.14385474860335196, 'f1-score': 0.20573254768800558, 'support': 7160}, '2': {'precision': 0.3351408543843407, 'recall': 0.7567567567567568, 'f1-score': 0.46454924606993897, 'support': 6697}, 'accuracy': 0.34321849105974706, 'macro avg': {'precision': 0.35539562596008095, 'recall': 0.34863058044943646, 'f1-score': 0.2929746768573929, 'support': 20637}, 'weighted avg': {'precision': 0.35558071740339486, 'recall': 0.34321849105974706, 'f1-score': 0.29067818520022337, 'support': 20637}}
[[ 985  961 4834]
 [ 910 1030 5220]
 [ 767  862 5068]]
training model: results/LILAK/W6/deepVOL_L3/h10
Epoch 1/50
211/211 - 11s - loss: 3.3573 - accuracy10: 0.3488 - val_loss: 3.3403 - val_accuracy10: 0.3689 - 11s/epoch - 51ms/step
Epoch 2/50
211/211 - 8s - loss: 3.3101 - accuracy10: 0.3664 - val_loss: 3.3279 - val_accuracy10: 0.3978 - 8s/epoch - 40ms/step
Epoch 3/50
211/211 - 8s - loss: 3.2767 - accuracy10: 0.3904 - val_loss: 3.3024 - val_accuracy10: 0.4142 - 8s/epoch - 38ms/step
Epoch 4/50
211/211 - 8s - loss: 3.2605 - accuracy10: 0.4060 - val_loss: 3.2768 - val_accuracy10: 0.4165 - 8s/epoch - 39ms/step
Epoch 5/50
211/211 - 8s - loss: 3.2431 - accuracy10: 0.4165 - val_loss: 3.2634 - val_accuracy10: 0.4163 - 8s/epoch - 39ms/step
Epoch 6/50
211/211 - 8s - loss: 3.2235 - accuracy10: 0.4227 - val_loss: 3.2640 - val_accuracy10: 0.4271 - 8s/epoch - 38ms/step
Epoch 7/50
211/211 - 8s - loss: 3.1989 - accuracy10: 0.4340 - val_loss: 3.2327 - val_accuracy10: 0.4376 - 8s/epoch - 40ms/step
Epoch 8/50
211/211 - 8s - loss: 3.1798 - accuracy10: 0.4411 - val_loss: 3.2355 - val_accuracy10: 0.4424 - 8s/epoch - 39ms/step
Epoch 9/50
211/211 - 8s - loss: 3.1659 - accuracy10: 0.4464 - val_loss: 3.2202 - val_accuracy10: 0.4413 - 8s/epoch - 39ms/step
Epoch 10/50
211/211 - 8s - loss: 3.1487 - accuracy10: 0.4490 - val_loss: 3.2280 - val_accuracy10: 0.4457 - 8s/epoch - 38ms/step
Epoch 11/50
211/211 - 9s - loss: 3.1346 - accuracy10: 0.4540 - val_loss: 3.1953 - val_accuracy10: 0.4352 - 9s/epoch - 42ms/step
Epoch 12/50
211/211 - 8s - loss: 3.1165 - accuracy10: 0.4547 - val_loss: 3.2084 - val_accuracy10: 0.4489 - 8s/epoch - 40ms/step
Epoch 13/50
211/211 - 8s - loss: 3.0995 - accuracy10: 0.4612 - val_loss: 3.2050 - val_accuracy10: 0.4433 - 8s/epoch - 39ms/step
Epoch 14/50
211/211 - 8s - loss: 3.0941 - accuracy10: 0.4610 - val_loss: 3.1950 - val_accuracy10: 0.4477 - 8s/epoch - 39ms/step
Epoch 15/50
211/211 - 8s - loss: 3.0746 - accuracy10: 0.4661 - val_loss: 3.1964 - val_accuracy10: 0.4390 - 8s/epoch - 39ms/step
Epoch 16/50
211/211 - 8s - loss: 3.0657 - accuracy10: 0.4654 - val_loss: 3.2076 - val_accuracy10: 0.4309 - 8s/epoch - 38ms/step
Epoch 17/50
211/211 - 8s - loss: 3.0566 - accuracy10: 0.4689 - val_loss: 3.1962 - val_accuracy10: 0.4399 - 8s/epoch - 38ms/step
Epoch 18/50
211/211 - 8s - loss: 3.0479 - accuracy10: 0.4691 - val_loss: 3.1944 - val_accuracy10: 0.4283 - 8s/epoch - 40ms/step
Epoch 19/50
211/211 - 8s - loss: 3.0431 - accuracy10: 0.4737 - val_loss: 3.1927 - val_accuracy10: 0.4391 - 8s/epoch - 39ms/step
Epoch 20/50
211/211 - 8s - loss: 3.0299 - accuracy10: 0.4784 - val_loss: 3.2136 - val_accuracy10: 0.4465 - 8s/epoch - 39ms/step
Epoch 21/50
211/211 - 8s - loss: 3.0297 - accuracy10: 0.4758 - val_loss: 3.2075 - val_accuracy10: 0.4417 - 8s/epoch - 39ms/step
Epoch 22/50
211/211 - 8s - loss: 3.0096 - accuracy10: 0.4845 - val_loss: 3.2068 - val_accuracy10: 0.4486 - 8s/epoch - 39ms/step
Epoch 23/50
211/211 - 8s - loss: 3.0020 - accuracy10: 0.4867 - val_loss: 3.2019 - val_accuracy10: 0.4490 - 8s/epoch - 39ms/step
Epoch 24/50
211/211 - 8s - loss: 2.9873 - accuracy10: 0.4907 - val_loss: 3.2048 - val_accuracy10: 0.4316 - 8s/epoch - 39ms/step
Epoch 25/50
211/211 - 8s - loss: 2.9777 - accuracy10: 0.4946 - val_loss: 3.2117 - val_accuracy10: 0.4439 - 8s/epoch - 39ms/step
Epoch 26/50
211/211 - 8s - loss: 2.9660 - accuracy10: 0.4953 - val_loss: 3.2011 - val_accuracy10: 0.4344 - 8s/epoch - 40ms/step
Epoch 27/50
211/211 - 8s - loss: 2.9612 - accuracy10: 0.4961 - val_loss: 3.2057 - val_accuracy10: 0.4358 - 8s/epoch - 38ms/step
Epoch 28/50
211/211 - 8s - loss: 2.9480 - accuracy10: 0.5013 - val_loss: 3.2095 - val_accuracy10: 0.4380 - 8s/epoch - 38ms/step
Epoch 29/50
211/211 - 8s - loss: 2.9335 - accuracy10: 0.5060 - val_loss: 3.1950 - val_accuracy10: 0.4353 - 8s/epoch - 39ms/step
testing model: results/LILAK/W6/deepVOL_L3/h10
Evaluating performance on  test set...
1059/1059 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0816137
{'0': {'precision': 0.39419557116827264, 'recall': 0.2901643305944901, 'f1-score': 0.3342729278461014, 'support': 82760}, '1': {'precision': 0.564503246865993, 'recall': 0.3232098299052599, 'f1-score': 0.4110629958592787, 'support': 100591}, '2': {'precision': 0.3785348139019626, 'recall': 0.6583405536048156, 'f1-score': 0.4806842302409789, 'support': 87716}, 'accuracy': 0.4215673615748136, 'macro avg': {'precision': 0.4457445439787427, 'recall': 0.4239049047015218, 'f1-score': 0.4086733846487863, 'support': 271067}, 'weighted avg': {'precision': 0.4523277688232352, 'recall': 0.4215673615748136, 'f1-score': 0.41014717123383426, 'support': 271067}}
[[24014 11173 47573]
 [20845 32512 47234]
 [16060 13909 57747]]
Evaluating performance on  train set...
211/211 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0324582
{'0': {'precision': 0.43076245041868666, 'recall': 0.31943264265638277, 'f1-score': 0.3668368112895962, 'support': 15299}, '1': {'precision': 0.6318351452214831, 'recall': 0.48320648577101255, 'f1-score': 0.5476151412164537, 'support': 24176}, '2': {'precision': 0.3584663212435233, 'recall': 0.5970726318696493, 'f1-score': 0.4479784506203217, 'support': 14484}, 'accuracy': 0.46733631090272243, 'macro avg': {'precision': 0.4736879722945644, 'recall': 0.4665705867656815, 'f1-score': 0.45414346770879055, 'support': 53959}, 'weighted avg': {'precision': 0.5014456790659808, 'recall': 0.46733631090272243, 'f1-score': 0.46961396446845305, 'support': 53959}}
[[ 4887  3364  7048]
 [ 4065 11682  8429]
 [ 2393  3443  8648]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.063809
{'0': {'precision': 0.3763888888888889, 'recall': 0.28102315935015554, 'f1-score': 0.3217890362161092, 'support': 5786}, '1': {'precision': 0.6088221037324285, 'recall': 0.4168141592920354, 'f1-score': 0.49484536082474223, 'support': 9040}, '2': {'precision': 0.359498420221169, 'recall': 0.6265702977112373, 'f1-score': 0.4568668046928916, 'support': 5811}, 'accuracy': 0.4378058826379803, 'macro avg': {'precision': 0.44823647094749547, 'recall': 0.4414692054511427, 'f1-score': 0.4245004005779143, 'support': 20637}, 'weighted avg': {'precision': 0.4734497867305073, 'recall': 0.4378058826379803, 'f1-score': 0.4356314593919887, 'support': 20637}}
[[1626 1181 2979]
 [1764 3768 3508]
 [ 930 1240 3641]]
training model: results/LILAK/W6/deepVOL_L3/h20
Epoch 1/50
211/211 - 11s - loss: 3.3637 - accuracy20: 0.3435 - val_loss: 3.3145 - val_accuracy20: 0.3476 - 11s/epoch - 53ms/step
Epoch 2/50
211/211 - 8s - loss: 3.3073 - accuracy20: 0.3641 - val_loss: 3.2909 - val_accuracy20: 0.3626 - 8s/epoch - 38ms/step
Epoch 3/50
211/211 - 8s - loss: 3.2845 - accuracy20: 0.3707 - val_loss: 3.2886 - val_accuracy20: 0.3593 - 8s/epoch - 40ms/step
Epoch 4/50
211/211 - 8s - loss: 3.2669 - accuracy20: 0.3806 - val_loss: 3.2861 - val_accuracy20: 0.3707 - 8s/epoch - 39ms/step
Epoch 5/50
211/211 - 8s - loss: 3.2605 - accuracy20: 0.3886 - val_loss: 3.2577 - val_accuracy20: 0.3818 - 8s/epoch - 38ms/step
Epoch 6/50
211/211 - 8s - loss: 3.2298 - accuracy20: 0.4067 - val_loss: 3.2447 - val_accuracy20: 0.3953 - 8s/epoch - 39ms/step
Epoch 7/50
211/211 - 8s - loss: 3.2016 - accuracy20: 0.4215 - val_loss: 3.2295 - val_accuracy20: 0.4082 - 8s/epoch - 39ms/step
Epoch 8/50
211/211 - 8s - loss: 3.1803 - accuracy20: 0.4305 - val_loss: 3.2110 - val_accuracy20: 0.4203 - 8s/epoch - 39ms/step
Epoch 9/50
211/211 - 8s - loss: 3.1619 - accuracy20: 0.4378 - val_loss: 3.2147 - val_accuracy20: 0.4177 - 8s/epoch - 40ms/step
Epoch 10/50
211/211 - 8s - loss: 3.1509 - accuracy20: 0.4444 - val_loss: 3.1875 - val_accuracy20: 0.4264 - 8s/epoch - 39ms/step
Epoch 11/50
211/211 - 8s - loss: 3.1399 - accuracy20: 0.4503 - val_loss: 3.2026 - val_accuracy20: 0.4259 - 8s/epoch - 38ms/step
Epoch 12/50
211/211 - 8s - loss: 3.1263 - accuracy20: 0.4564 - val_loss: 3.2114 - val_accuracy20: 0.4287 - 8s/epoch - 39ms/step
Epoch 13/50
211/211 - 8s - loss: 3.1173 - accuracy20: 0.4604 - val_loss: 3.1989 - val_accuracy20: 0.4305 - 8s/epoch - 39ms/step
Epoch 14/50
211/211 - 8s - loss: 3.1084 - accuracy20: 0.4630 - val_loss: 3.1963 - val_accuracy20: 0.4378 - 8s/epoch - 38ms/step
Epoch 15/50
211/211 - 8s - loss: 3.0914 - accuracy20: 0.4710 - val_loss: 3.2010 - val_accuracy20: 0.4403 - 8s/epoch - 38ms/step
Epoch 16/50
211/211 - 8s - loss: 3.0770 - accuracy20: 0.4754 - val_loss: 3.2034 - val_accuracy20: 0.4384 - 8s/epoch - 38ms/step
Epoch 17/50
211/211 - 8s - loss: 3.0614 - accuracy20: 0.4792 - val_loss: 3.1934 - val_accuracy20: 0.4394 - 8s/epoch - 39ms/step
Epoch 18/50
211/211 - 8s - loss: 3.0457 - accuracy20: 0.4838 - val_loss: 3.2056 - val_accuracy20: 0.4411 - 8s/epoch - 38ms/step
Epoch 19/50
211/211 - 8s - loss: 3.0327 - accuracy20: 0.4893 - val_loss: 3.2156 - val_accuracy20: 0.4420 - 8s/epoch - 39ms/step
Epoch 20/50
211/211 - 8s - loss: 3.0173 - accuracy20: 0.4924 - val_loss: 3.2226 - val_accuracy20: 0.4380 - 8s/epoch - 39ms/step
testing model: results/LILAK/W6/deepVOL_L3/h20
Evaluating performance on  test set...
1059/1059 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0688952
{'0': {'precision': 0.41664644994339317, 'recall': 0.21312306101344364, 'f1-score': 0.2819983032757724, 'support': 96700}, '1': {'precision': 0.41172759856630825, 'recall': 0.39983849409668076, 'f1-score': 0.40569596112280504, 'support': 71824}, '2': {'precision': 0.41579685617011186, 'recall': 0.6157416888524814, 'f1-score': 0.4963914526957972, 'support': 102543}, 'accuracy': 0.4149048021337898, 'macro avg': {'precision': 0.4147236348932711, 'recall': 0.40956774798753526, 'f1-score': 0.3946952390314582, 'support': 271067}, 'weighted avg': {'precision': 0.41502171703381235, 'recall': 0.4149048021337898, 'f1-score': 0.395877813869769, 'support': 271067}}
[[20609 19410 56681]
 [11074 28718 32032]
 [17781 21622 63140]]
Evaluating performance on  train set...
211/211 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0518924
{'0': {'precision': 0.45475689445121276, 'recall': 0.22415110819958511, 'f1-score': 0.30028887995026876, 'support': 18318}, '1': {'precision': 0.4974992644895557, 'recall': 0.5509938090583252, 'f1-score': 0.5228818800247372, 'support': 18414}, '2': {'precision': 0.39150635800456474, 'recall': 0.5576130492831021, 'f1-score': 0.4600244235327922, 'support': 17227}, 'accuracy': 0.4421505216923961, 'macro avg': {'precision': 0.44792083898177776, 'recall': 0.4442526555136708, 'f1-score': 0.4277317278359327, 'support': 53959}, 'weighted avg': {'precision': 0.4491496928818664, 'recall': 0.4421505216923961, 'f1-score': 0.4272480843956327, 'support': 53959}}
[[ 4106  5328  8884]
 [ 2222 10146  6046]
 [ 2701  4920  9606]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0633796
{'0': {'precision': 0.4188571428571429, 'recall': 0.20915965187615923, 'f1-score': 0.27899895327814256, 'support': 7009}, '1': {'precision': 0.4829318752770799, 'recall': 0.48696170466398453, 'f1-score': 0.4849384181629322, 'support': 6711}, '2': {'precision': 0.3956605593056895, 'recall': 0.5931762324707243, 'f1-score': 0.47469196506044997, 'support': 6917}, 'accuracy': 0.4282114648446964, 'macro avg': {'precision': 0.43248319247997075, 'recall': 0.4297658630036227, 'f1-score': 0.4128764455005083, 'support': 20637}, 'weighted avg': {'precision': 0.43191886504761606, 'recall': 0.4282114648446964, 'f1-score': 0.41156029026220237, 'support': 20637}}
[[1466 1749 3794]
 [ 970 3268 2473]
 [1064 1750 4103]]
training model: results/LILAK/W6/deepVOL_L3/h30
Epoch 1/50
211/211 - 11s - loss: 3.3570 - accuracy30: 0.3431 - val_loss: 3.3218 - val_accuracy30: 0.3511 - 11s/epoch - 52ms/step
Epoch 2/50
211/211 - 8s - loss: 3.3027 - accuracy30: 0.3653 - val_loss: 3.2907 - val_accuracy30: 0.3603 - 8s/epoch - 40ms/step
Epoch 3/50
211/211 - 8s - loss: 3.2821 - accuracy30: 0.3764 - val_loss: 3.2804 - val_accuracy30: 0.3691 - 8s/epoch - 39ms/step
Epoch 4/50
211/211 - 8s - loss: 3.2707 - accuracy30: 0.3817 - val_loss: 3.2720 - val_accuracy30: 0.3797 - 8s/epoch - 39ms/step
Epoch 5/50
211/211 - 8s - loss: 3.2535 - accuracy30: 0.3919 - val_loss: 3.2499 - val_accuracy30: 0.3903 - 8s/epoch - 39ms/step
Epoch 6/50
211/211 - 8s - loss: 3.2294 - accuracy30: 0.4082 - val_loss: 3.2442 - val_accuracy30: 0.4003 - 8s/epoch - 40ms/step
Epoch 7/50
211/211 - 8s - loss: 3.2180 - accuracy30: 0.4156 - val_loss: 3.2429 - val_accuracy30: 0.4034 - 8s/epoch - 39ms/step
Epoch 8/50
211/211 - 8s - loss: 3.2067 - accuracy30: 0.4230 - val_loss: 3.2315 - val_accuracy30: 0.4070 - 8s/epoch - 39ms/step
Epoch 9/50
211/211 - 8s - loss: 3.1911 - accuracy30: 0.4308 - val_loss: 3.2171 - val_accuracy30: 0.4151 - 8s/epoch - 40ms/step
Epoch 10/50
211/211 - 8s - loss: 3.1759 - accuracy30: 0.4371 - val_loss: 3.2280 - val_accuracy30: 0.4124 - 8s/epoch - 39ms/step
Epoch 11/50
211/211 - 8s - loss: 3.1661 - accuracy30: 0.4401 - val_loss: 3.2228 - val_accuracy30: 0.4157 - 8s/epoch - 39ms/step
Epoch 12/50
211/211 - 8s - loss: 3.1542 - accuracy30: 0.4453 - val_loss: 3.2405 - val_accuracy30: 0.4136 - 8s/epoch - 38ms/step
Epoch 13/50
211/211 - 8s - loss: 3.1419 - accuracy30: 0.4505 - val_loss: 3.2412 - val_accuracy30: 0.4119 - 8s/epoch - 39ms/step
Epoch 14/50
211/211 - 8s - loss: 3.1335 - accuracy30: 0.4532 - val_loss: 3.2384 - val_accuracy30: 0.4152 - 8s/epoch - 39ms/step
Epoch 15/50
211/211 - 8s - loss: 3.1244 - accuracy30: 0.4587 - val_loss: 3.2551 - val_accuracy30: 0.4136 - 8s/epoch - 38ms/step
Epoch 16/50
211/211 - 9s - loss: 3.1101 - accuracy30: 0.4618 - val_loss: 3.2794 - val_accuracy30: 0.4065 - 9s/epoch - 40ms/step
Epoch 17/50
211/211 - 8s - loss: 3.1034 - accuracy30: 0.4648 - val_loss: 3.2991 - val_accuracy30: 0.4034 - 8s/epoch - 40ms/step
Epoch 18/50
211/211 - 8s - loss: 3.0907 - accuracy30: 0.4672 - val_loss: 3.3103 - val_accuracy30: 0.4015 - 8s/epoch - 39ms/step
Epoch 19/50
211/211 - 8s - loss: 3.0813 - accuracy30: 0.4731 - val_loss: 3.3221 - val_accuracy30: 0.3998 - 8s/epoch - 40ms/step
testing model: results/LILAK/W6/deepVOL_L3/h30
Evaluating performance on  test set...
1059/1059 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.078508
{'0': {'precision': 0.39682395808784876, 'recall': 0.23174811552468874, 'f1-score': 0.29260989580200375, 'support': 94456}, '1': {'precision': 0.42327669984249855, 'recall': 0.33238598984237255, 'f1-score': 0.37236520149759733, 'support': 76002}, '2': {'precision': 0.4024273149748435, 'recall': 0.6248745142084704, 'f1-score': 0.48956706939582834, 'support': 100609}, 'accuracy': 0.4058775136774303, 'macro avg': {'precision': 0.4075093243017303, 'recall': 0.3963362065251772, 'f1-score': 0.3848473888984765, 'support': 271067}, 'weighted avg': {'precision': 0.4063205379440487, 'recall': 0.4058775136774303, 'f1-score': 0.38807421651082336, 'support': 271067}}
[[21890 15813 56753]
 [14139 25262 36601]
 [19134 18607 62868]]
Evaluating performance on  train set...
211/211 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0659851
{'0': {'precision': 0.4419833367201788, 'recall': 0.23440025864856126, 'f1-score': 0.30633802816901406, 'support': 18558}, '1': {'precision': 0.4751051706693647, 'recall': 0.5006172146784873, 'f1-score': 0.48752766317860163, 'support': 17822}, '2': {'precision': 0.3895729733996369, 'recall': 0.5615222708914045, 'f1-score': 0.4600041941421814, 'support': 17579}, 'accuracy': 0.4288997201578977, 'macro avg': {'precision': 0.43555382692972683, 'recall': 0.4321799147394844, 'f1-score': 0.417956628496599, 'support': 53959}, 'weighted avg': {'precision': 0.4358485964142165, 'recall': 0.4288997201578977, 'f1-score': 0.4162447945431718, 'support': 53959}}
[[4350 5145 9063]
 [2496 8922 6404]
 [2996 4712 9871]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0744928
{'0': {'precision': 0.4213740458015267, 'recall': 0.23125261834939254, 'f1-score': 0.2986205031106302, 'support': 7161}, '1': {'precision': 0.4576190476190476, 'recall': 0.4422457432121491, 'f1-score': 0.44980107652703016, 'support': 6519}, '2': {'precision': 0.39146728163735944, 'recall': 0.5855972401897369, 'f1-score': 0.4692467173462335, 'support': 6957}, 'accuracy': 0.41735717400785, 'macro avg': {'precision': 0.4234867916859779, 'recall': 0.41969853391709283, 'f1-score': 0.40588943232796465, 'support': 20637}, 'weighted avg': {'precision': 0.4227414833437231, 'recall': 0.41735717400785, 'f1-score': 0.40389708064314966, 'support': 20637}}
[[1656 1740 3765]
 [1068 2883 2568]
 [1206 1677 4074]]
training model: results/LILAK/W6/deepVOL_L3/h50
Epoch 1/50
211/211 - 10s - loss: 3.3572 - accuracy50: 0.3404 - val_loss: 3.3177 - val_accuracy50: 0.3529 - 10s/epoch - 48ms/step
Epoch 2/50
211/211 - 8s - loss: 3.3143 - accuracy50: 0.3576 - val_loss: 3.3144 - val_accuracy50: 0.3499 - 8s/epoch - 39ms/step
Epoch 3/50
211/211 - 8s - loss: 3.3004 - accuracy50: 0.3619 - val_loss: 3.3006 - val_accuracy50: 0.3490 - 8s/epoch - 40ms/step
Epoch 4/50
211/211 - 8s - loss: 3.2901 - accuracy50: 0.3694 - val_loss: 3.3096 - val_accuracy50: 0.3515 - 8s/epoch - 39ms/step
Epoch 5/50
211/211 - 8s - loss: 3.2825 - accuracy50: 0.3719 - val_loss: 3.2970 - val_accuracy50: 0.3606 - 8s/epoch - 39ms/step
Epoch 6/50
211/211 - 8s - loss: 3.2763 - accuracy50: 0.3787 - val_loss: 3.2890 - val_accuracy50: 0.3637 - 8s/epoch - 39ms/step
Epoch 7/50
211/211 - 8s - loss: 3.2684 - accuracy50: 0.3831 - val_loss: 3.2946 - val_accuracy50: 0.3691 - 8s/epoch - 39ms/step
Epoch 8/50
211/211 - 8s - loss: 3.2634 - accuracy50: 0.3865 - val_loss: 3.2918 - val_accuracy50: 0.3688 - 8s/epoch - 39ms/step
Epoch 9/50
211/211 - 8s - loss: 3.2607 - accuracy50: 0.3904 - val_loss: 3.2936 - val_accuracy50: 0.3673 - 8s/epoch - 39ms/step
Epoch 10/50
211/211 - 8s - loss: 3.2526 - accuracy50: 0.3925 - val_loss: 3.3005 - val_accuracy50: 0.3683 - 8s/epoch - 39ms/step
Epoch 11/50
211/211 - 8s - loss: 3.2416 - accuracy50: 0.4012 - val_loss: 3.3027 - val_accuracy50: 0.3722 - 8s/epoch - 38ms/step
Epoch 12/50
211/211 - 8s - loss: 3.2365 - accuracy50: 0.4060 - val_loss: 3.2997 - val_accuracy50: 0.3700 - 8s/epoch - 39ms/step
Epoch 13/50
211/211 - 8s - loss: 3.2251 - accuracy50: 0.4124 - val_loss: 3.3041 - val_accuracy50: 0.3744 - 8s/epoch - 38ms/step
Epoch 14/50
211/211 - 8s - loss: 3.2163 - accuracy50: 0.4175 - val_loss: 3.3087 - val_accuracy50: 0.3667 - 8s/epoch - 39ms/step
Epoch 15/50
211/211 - 8s - loss: 3.2128 - accuracy50: 0.4187 - val_loss: 3.3042 - val_accuracy50: 0.3768 - 8s/epoch - 39ms/step
Epoch 16/50
211/211 - 8s - loss: 3.2024 - accuracy50: 0.4244 - val_loss: 3.3170 - val_accuracy50: 0.3683 - 8s/epoch - 38ms/step
testing model: results/LILAK/W6/deepVOL_L3/h50
Evaluating performance on  test set...
1059/1059 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0979722
{'0': {'precision': 0.358084558266404, 'recall': 0.077652780668412, 'f1-score': 0.12762854673772142, 'support': 91291}, '1': {'precision': 0.3499123604686409, 'recall': 0.3260471798902165, 'f1-score': 0.3375584825061025, 'support': 81433}, '2': {'precision': 0.3799966931028388, 'recall': 0.6777096488819743, 'f1-score': 0.4869544886641777, 'support': 98343}, 'accuracy': 0.36997495084241167, 'macro avg': {'precision': 0.36266453727929454, 'recall': 0.36046986981353424, 'f1-score': 0.31738050596933387, 'support': 271067}, 'weighted avg': {'precision': 0.3635792090094095, 'recall': 0.36997495084241167, 'f1-score': 0.32105827284344457, 'support': 271067}}
[[ 7089 24069 60133]
 [ 6272 26551 48610]
 [ 6436 25259 66648]]
Evaluating performance on  train set...
211/211 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0940404
{'0': {'precision': 0.4034365924491772, 'recall': 0.09019586624824154, 'f1-score': 0.14743079508269213, 'support': 18482}, '1': {'precision': 0.38365943945002645, 'recall': 0.4046516816331084, 'f1-score': 0.3938760552675154, 'support': 17929}, '2': {'precision': 0.3618721091955882, 'recall': 0.63756553453385, 'f1-score': 0.46169400598369964, 'support': 17548}, 'accuracy': 0.37269037602624216, 'macro avg': {'precision': 0.38298938036493063, 'recall': 0.3774710274717333, 'f1-score': 0.3343336187779691, 'support': 53959}, 'weighted avg': {'precision': 0.3833480413593543, 'recall': 0.37269037602624216, 'f1-score': 0.33151885999761965, 'support': 53959}}
[[ 1667  6467 10348]
 [ 1293  7255  9381]
 [ 1172  5188 11188]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0986445
{'0': {'precision': 0.39250936329588015, 'recall': 0.07257617728531857, 'f1-score': 0.12250146113383986, 'support': 7220}, '1': {'precision': 0.3669601552007163, 'recall': 0.38106307143964047, 'f1-score': 0.3738786680857533, 'support': 6453}, '2': {'precision': 0.3625902706134434, 'recall': 0.6560884549109707, 'f1-score': 0.4670585228724764, 'support': 6964}, 'accuracy': 0.3659446624993943, 'macro avg': {'precision': 0.37401992970334663, 'recall': 0.3699092345453099, 'f1-score': 0.3211462173640232, 'support': 20637}, 'weighted avg': {'precision': 0.3744240989028685, 'recall': 0.3659446624993943, 'f1-score': 0.31737632155001283, 'support': 20637}}
[[ 524 2251 4445]
 [ 407 2459 3587]
 [ 404 1991 4569]]
training model: results/LILAK/W6/deepVOL_L3/h100
Epoch 1/50
211/211 - 10s - loss: 3.3507 - accuracy100: 0.3510 - val_loss: 3.3894 - val_accuracy100: 0.3279 - 10s/epoch - 49ms/step
Epoch 2/50
211/211 - 8s - loss: 3.3251 - accuracy100: 0.3572 - val_loss: 3.3628 - val_accuracy100: 0.3371 - 8s/epoch - 39ms/step
Epoch 3/50
211/211 - 8s - loss: 3.3136 - accuracy100: 0.3558 - val_loss: 3.3884 - val_accuracy100: 0.3298 - 8s/epoch - 39ms/step
Epoch 4/50
211/211 - 8s - loss: 3.3021 - accuracy100: 0.3602 - val_loss: 3.3242 - val_accuracy100: 0.3370 - 8s/epoch - 39ms/step
Epoch 5/50
211/211 - 8s - loss: 3.2926 - accuracy100: 0.3642 - val_loss: 3.3303 - val_accuracy100: 0.3404 - 8s/epoch - 40ms/step
Epoch 6/50
211/211 - 8s - loss: 3.2866 - accuracy100: 0.3697 - val_loss: 3.3093 - val_accuracy100: 0.3388 - 8s/epoch - 40ms/step
Epoch 7/50
211/211 - 8s - loss: 3.2767 - accuracy100: 0.3766 - val_loss: 3.3159 - val_accuracy100: 0.3429 - 8s/epoch - 38ms/step
Epoch 8/50
211/211 - 8s - loss: 3.2796 - accuracy100: 0.3722 - val_loss: 3.3186 - val_accuracy100: 0.3384 - 8s/epoch - 39ms/step
Epoch 9/50
211/211 - 8s - loss: 3.2694 - accuracy100: 0.3832 - val_loss: 3.3199 - val_accuracy100: 0.3466 - 8s/epoch - 40ms/step
Epoch 10/50
211/211 - 8s - loss: 3.2624 - accuracy100: 0.3880 - val_loss: 3.3224 - val_accuracy100: 0.3485 - 8s/epoch - 39ms/step
Epoch 11/50
211/211 - 8s - loss: 3.2531 - accuracy100: 0.3949 - val_loss: 3.3277 - val_accuracy100: 0.3552 - 8s/epoch - 39ms/step
Epoch 12/50
211/211 - 8s - loss: 3.2446 - accuracy100: 0.3995 - val_loss: 3.3361 - val_accuracy100: 0.3436 - 8s/epoch - 39ms/step
Epoch 13/50
211/211 - 8s - loss: 3.2352 - accuracy100: 0.4086 - val_loss: 3.3358 - val_accuracy100: 0.3476 - 8s/epoch - 38ms/step
Epoch 14/50
211/211 - 8s - loss: 3.2254 - accuracy100: 0.4120 - val_loss: 3.3402 - val_accuracy100: 0.3462 - 8s/epoch - 39ms/step
Epoch 15/50
211/211 - 8s - loss: 3.2172 - accuracy100: 0.4193 - val_loss: 3.3505 - val_accuracy100: 0.3480 - 8s/epoch - 40ms/step
Epoch 16/50
211/211 - 8s - loss: 3.2052 - accuracy100: 0.4259 - val_loss: 3.3628 - val_accuracy100: 0.3430 - 8s/epoch - 39ms/step
testing model: results/LILAK/W6/deepVOL_L3/h100
Evaluating performance on  test set...
1059/1059 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1010965
{'0': {'precision': 0.31068995876002037, 'recall': 0.15702576112412178, 'f1-score': 0.20861529845522003, 'support': 85400}, '1': {'precision': 0.3567894853429816, 'recall': 0.32083573104333585, 'f1-score': 0.33785878267355, 'support': 90364}, '2': {'precision': 0.3604710631652881, 'recall': 0.5546729903570716, 'f1-score': 0.4369663153544121, 'support': 95303}, 'accuracy': 0.3514407877019335, 'macro avg': {'precision': 0.3426501690894301, 'recall': 0.34417816084150976, 'f1-score': 0.32781346549439405, 'support': 271067}, 'weighted avg': {'precision': 0.3435601576897238, 'recall': 0.3514407877019335, 'f1-score': 0.3319851486083145, 'support': 271067}}
[[13410 24755 47235]
 [14822 28992 46550]
 [14930 27511 52862]]
Evaluating performance on  train set...
211/211 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0949649
{'0': {'precision': 0.39770137719211335, 'recall': 0.21537801148253474, 'f1-score': 0.27942916811695095, 'support': 18637}, '1': {'precision': 0.3619500594530321, 'recall': 0.3497845446710715, 'f1-score': 0.35576333089846607, 'support': 17405}, '2': {'precision': 0.35639281224580344, 'recall': 0.5379806887313724, 'f1-score': 0.4287525298578831, 'support': 17917}, 'accuracy': 0.36585185047906743, 'macro avg': {'precision': 0.3720147496303163, 'recall': 0.3677144149616596, 'f1-score': 0.3546483429577667, 'support': 53959}, 'weighted avg': {'precision': 0.3724529989161679, 'recall': 0.36585185047906743, 'f1-score': 0.3536340787995906, 'support': 53959}}
[[4014 5489 9134]
 [3044 6088 8273]
 [3035 5243 9639]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1021241
{'0': {'precision': 0.323379069141781, 'recall': 0.18275809639653337, 'f1-score': 0.23353409753254323, 'support': 6577}, '1': {'precision': 0.37363387978142076, 'recall': 0.29939792008757526, 'f1-score': 0.3324217563050744, 'support': 7308}, '2': {'precision': 0.33731019522776573, 'recall': 0.5527251184834123, 'f1-score': 0.4189492590929501, 'support': 6752}, 'accuracy': 0.34510830062509085, 'macro avg': {'precision': 0.34477438138365585, 'recall': 0.34496037832250703, 'f1-score': 0.3283017043101893, 'support': 20637}, 'weighted avg': {'precision': 0.3457333415402428, 'recall': 0.34510830062509085, 'f1-score': 0.32921632756430774, 'support': 20637}}
[[1202 1777 3598]
 [1386 2188 3734]
 [1129 1891 3732]]
training model: results/LILAK/W6/deepVOL_L3/h200
Epoch 1/50
211/211 - 12s - loss: 3.3555 - accuracy200: 0.3475 - val_loss: 3.3440 - val_accuracy200: 0.3403 - 12s/epoch - 55ms/step
Epoch 2/50
211/211 - 8s - loss: 3.3272 - accuracy200: 0.3551 - val_loss: 3.3419 - val_accuracy200: 0.3361 - 8s/epoch - 40ms/step
Epoch 3/50
211/211 - 8s - loss: 3.3127 - accuracy200: 0.3578 - val_loss: 3.3304 - val_accuracy200: 0.3488 - 8s/epoch - 40ms/step
Epoch 4/50
211/211 - 8s - loss: 3.2953 - accuracy200: 0.3644 - val_loss: 3.3282 - val_accuracy200: 0.3478 - 8s/epoch - 39ms/step
Epoch 5/50
211/211 - 8s - loss: 3.2844 - accuracy200: 0.3681 - val_loss: 3.3238 - val_accuracy200: 0.3493 - 8s/epoch - 39ms/step
Epoch 6/50
211/211 - 8s - loss: 3.2767 - accuracy200: 0.3753 - val_loss: 3.3193 - val_accuracy200: 0.3530 - 8s/epoch - 40ms/step
Epoch 7/50
211/211 - 8s - loss: 3.2700 - accuracy200: 0.3805 - val_loss: 3.3351 - val_accuracy200: 0.3519 - 8s/epoch - 39ms/step
Epoch 8/50
211/211 - 8s - loss: 3.2569 - accuracy200: 0.3932 - val_loss: 3.3410 - val_accuracy200: 0.3555 - 8s/epoch - 39ms/step
Epoch 9/50
211/211 - 9s - loss: 3.2489 - accuracy200: 0.3967 - val_loss: 3.3494 - val_accuracy200: 0.3502 - 9s/epoch - 41ms/step
Epoch 10/50
211/211 - 8s - loss: 3.2326 - accuracy200: 0.4048 - val_loss: 3.3657 - val_accuracy200: 0.3486 - 8s/epoch - 40ms/step
Epoch 11/50
211/211 - 8s - loss: 3.2208 - accuracy200: 0.4111 - val_loss: 3.3702 - val_accuracy200: 0.3507 - 8s/epoch - 39ms/step
Epoch 12/50
211/211 - 8s - loss: 3.2151 - accuracy200: 0.4155 - val_loss: 3.3745 - val_accuracy200: 0.3538 - 8s/epoch - 40ms/step
Epoch 13/50
211/211 - 8s - loss: 3.2026 - accuracy200: 0.4209 - val_loss: 3.4090 - val_accuracy200: 0.3488 - 8s/epoch - 39ms/step
Epoch 14/50
211/211 - 8s - loss: 3.1965 - accuracy200: 0.4273 - val_loss: 3.3740 - val_accuracy200: 0.3511 - 8s/epoch - 39ms/step
Epoch 15/50
211/211 - 8s - loss: 3.1844 - accuracy200: 0.4306 - val_loss: 3.4065 - val_accuracy200: 0.3488 - 8s/epoch - 40ms/step
Epoch 16/50
211/211 - 8s - loss: 3.1726 - accuracy200: 0.4348 - val_loss: 3.4048 - val_accuracy200: 0.3438 - 8s/epoch - 40ms/step
testing model: results/LILAK/W6/deepVOL_L3/h200
Evaluating performance on  test set...
1059/1059 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1050498
{'0': {'precision': 0.2940516060283148, 'recall': 0.18832260894998537, 'f1-score': 0.22960002377273267, 'support': 82056}, '1': {'precision': 0.3972386020422839, 'recall': 0.20280277760295382, 'f1-score': 0.26851845422033954, 'support': 95334}, '2': {'precision': 0.36255034031228656, 'recall': 0.6573331767669759, 'f1-score': 0.4673403637660756, 'support': 93677}, 'accuracy': 0.35549882501374197, 'macro avg': {'precision': 0.35128018279429507, 'recall': 0.34948618777330503, 'f1-score': 0.3218196139197159, 'support': 271067}, 'weighted avg': {'precision': 0.35401458569575994, 'recall': 0.35549882501374197, 'f1-score': 0.3254473658610301, 'support': 271067}}
[[15453 14312 52291]
 [20024 19334 55976]
 [17075 15025 61577]]
Evaluating performance on  train set...
211/211 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0912263
{'0': {'precision': 0.4037532216494845, 'recall': 0.27135433582331925, 'f1-score': 0.32457105859501456, 'support': 18474}, '1': {'precision': 0.38860822189202576, 'recall': 0.22533026995979322, 'f1-score': 0.28525722595891656, 'support': 17410}, '2': {'precision': 0.3686402950903078, 'recall': 0.6413831258644537, 'f1-score': 0.4681864992023908, 'support': 18075}, 'accuracy': 0.3804555310513538, 'macro avg': {'precision': 0.38700057954393935, 'recall': 0.37935591054918866, 'f1-score': 0.35933826125210727, 'support': 53959}, 'weighted avg': {'precision': 0.38710464414926254, 'recall': 0.3804555310513538, 'f1-score': 0.35999416248470595, 'support': 53959}}
[[ 5013  3215 10246]
 [ 3878  3923  9609]
 [ 3525  2957 11593]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1053728
{'0': {'precision': 0.3508083140877598, 'recall': 0.21607396870554765, 'f1-score': 0.26742957746478874, 'support': 7030}, '1': {'precision': 0.34665905197030267, 'recall': 0.18608215818516247, 'f1-score': 0.2421703570716138, 'support': 6524}, '2': {'precision': 0.36181179226864507, 'recall': 0.6541013694762107, 'f1-score': 0.4659090909090909, 'support': 7083}, 'accuracy': 0.35693172457237, 'macro avg': {'precision': 0.3530930527755692, 'recall': 0.352085832122307, 'f1-score': 0.3251696751484978, 'support': 20637}, 'weighted avg': {'precision': 0.353273199967535, 'recall': 0.35693172457237, 'f1-score': 0.3275661884005313, 'support': 20637}}
[[1519 1206 4305]
 [1443 1214 3867]
 [1368 1082 4633]]
training model: results/LILAK/W6/deepVOL_L3/h300
Epoch 1/50
211/211 - 11s - loss: 3.3574 - accuracy300: 0.3512 - val_loss: 3.3783 - val_accuracy300: 0.3332 - 11s/epoch - 51ms/step
Epoch 2/50
211/211 - 8s - loss: 3.3280 - accuracy300: 0.3644 - val_loss: 3.3622 - val_accuracy300: 0.3436 - 8s/epoch - 40ms/step
Epoch 3/50
211/211 - 8s - loss: 3.3143 - accuracy300: 0.3590 - val_loss: 3.3302 - val_accuracy300: 0.3406 - 8s/epoch - 40ms/step
Epoch 4/50
211/211 - 8s - loss: 3.2897 - accuracy300: 0.3731 - val_loss: 3.3025 - val_accuracy300: 0.3546 - 8s/epoch - 40ms/step
Epoch 5/50
211/211 - 8s - loss: 3.2874 - accuracy300: 0.3721 - val_loss: 3.3099 - val_accuracy300: 0.3523 - 8s/epoch - 40ms/step
Epoch 6/50
211/211 - 8s - loss: 3.2793 - accuracy300: 0.3767 - val_loss: 3.3185 - val_accuracy300: 0.3512 - 8s/epoch - 39ms/step
Epoch 7/50
211/211 - 8s - loss: 3.2751 - accuracy300: 0.3831 - val_loss: 3.3120 - val_accuracy300: 0.3589 - 8s/epoch - 38ms/step
Epoch 8/50
211/211 - 8s - loss: 3.2633 - accuracy300: 0.3923 - val_loss: 3.3314 - val_accuracy300: 0.3572 - 8s/epoch - 40ms/step
Epoch 9/50
211/211 - 8s - loss: 3.2590 - accuracy300: 0.3939 - val_loss: 3.3401 - val_accuracy300: 0.3542 - 8s/epoch - 40ms/step
Epoch 10/50
211/211 - 8s - loss: 3.2485 - accuracy300: 0.4001 - val_loss: 3.3068 - val_accuracy300: 0.3639 - 8s/epoch - 40ms/step
Epoch 11/50
211/211 - 9s - loss: 3.2352 - accuracy300: 0.4085 - val_loss: 3.3268 - val_accuracy300: 0.3671 - 9s/epoch - 41ms/step
Epoch 12/50
211/211 - 8s - loss: 3.2275 - accuracy300: 0.4131 - val_loss: 3.3204 - val_accuracy300: 0.3643 - 8s/epoch - 39ms/step
Epoch 13/50
211/211 - 8s - loss: 3.2188 - accuracy300: 0.4165 - val_loss: 3.3325 - val_accuracy300: 0.3686 - 8s/epoch - 40ms/step
Epoch 14/50
211/211 - 8s - loss: 3.1989 - accuracy300: 0.4265 - val_loss: 3.3442 - val_accuracy300: 0.3599 - 8s/epoch - 40ms/step
testing model: results/LILAK/W6/deepVOL_L3/h300
Evaluating performance on  test set...
1059/1059 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1015756
{'0': {'precision': 0.30499709229874555, 'recall': 0.17563058376089843, 'f1-score': 0.22290359059205683, 'support': 83613}, '1': {'precision': 0.3815506025381252, 'recall': 0.1951392449248961, 'f1-score': 0.25821677564629975, 'support': 91673}, '2': {'precision': 0.3697978799550087, 'recall': 0.6796441883045699, 'f1-score': 0.47898018873130627, 'support': 95781}, 'accuracy': 0.3603205111651363, 'macro avg': {'precision': 0.3521151915972931, 'recall': 0.3501380056634548, 'f1-score': 0.32003351832322097, 'support': 271067}, 'weighted avg': {'precision': 0.3537841972826764, 'recall': 0.3603205111651363, 'f1-score': 0.3253304380498922, 'support': 271067}}
[[14685 14241 54687]
 [17534 17889 56250]
 [15929 14755 65097]]
Evaluating performance on  train set...
211/211 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0978462
{'0': {'precision': 0.3603727994477045, 'recall': 0.23225806451612904, 'f1-score': 0.2824675324675325, 'support': 17980}, '1': {'precision': 0.3881928796755295, 'recall': 0.23633669885864794, 'f1-score': 0.29380265356935775, 'support': 18224}, '2': {'precision': 0.35685509655966235, 'recall': 0.6286116586876936, 'f1-score': 0.45526299687952526, 'support': 17755}, 'accuracy': 0.3640541892918698, 'macro avg': {'precision': 0.3684735918942988, 'recall': 0.36573547402082357, 'f1-score': 0.3438443943054718, 'support': 53959}, 'weighted avg': {'precision': 0.36861120874540637, 'recall': 0.3640541892918698, 'f1-score': 0.3431535110363458, 'support': 53959}}
[[ 4176  3614 10190]
 [ 3992  4307  9925]
 [ 3420  3174 11161]]
Evaluating performance on  val set...
81/81 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1015086
{'0': {'precision': 0.3268492449449706, 'recall': 0.19269654443941453, 'f1-score': 0.24245300930320865, 'support': 6627}, '1': {'precision': 0.3784796573875803, 'recall': 0.19608930800166413, 'f1-score': 0.2583356170640358, 'support': 7211}, '2': {'precision': 0.3488533169154995, 'recall': 0.6667156934843359, 'f1-score': 0.4580407214671854, 'support': 6799}, 'accuracy': 0.3500508794882977, 'macro avg': {'precision': 0.35139407308268344, 'recall': 0.3518338486418049, 'f1-score': 0.3196097826114766, 'support': 20637}, 'weighted avg': {'precision': 0.3521393835044165, 'recall': 0.3500508794882977, 'f1-score': 0.3190295630448476, 'support': 20637}}
[[1277 1225 4125]
 [1461 1414 4336]
 [1169 1097 4533]]
training model: results/LILAK/W6/deepVOL_L3/h500
Epoch 1/50
211/211 - 11s - loss: 3.3615 - accuracy500: 0.3520 - val_loss: 3.3486 - val_accuracy500: 0.3410 - 11s/epoch - 51ms/step
Epoch 2/50
211/211 - 8s - loss: 3.3159 - accuracy500: 0.3655 - val_loss: 3.3191 - val_accuracy500: 0.3450 - 8s/epoch - 40ms/step
Epoch 3/50
211/211 - 8s - loss: 3.3019 - accuracy500: 0.3701 - val_loss: 3.3168 - val_accuracy500: 0.3607 - 8s/epoch - 38ms/step
Epoch 4/50
211/211 - 8s - loss: 3.2900 - accuracy500: 0.3806 - val_loss: 3.3058 - val_accuracy500: 0.3595 - 8s/epoch - 39ms/step
Epoch 5/50
211/211 - 8s - loss: 3.2857 - accuracy500: 0.3763 - val_loss: 3.3086 - val_accuracy500: 0.3599 - 8s/epoch - 39ms/step
Epoch 6/50
211/211 - 8s - loss: 3.2784 - accuracy500: 0.3816 - val_loss: 3.2820 - val_accuracy500: 0.3706 - 8s/epoch - 40ms/step
Epoch 7/50
211/211 - 8s - loss: 3.2692 - accuracy500: 0.3848 - val_loss: 3.2955 - val_accuracy500: 0.3553 - 8s/epoch - 39ms/step
Epoch 8/50
211/211 - 8s - loss: 3.2620 - accuracy500: 0.3917 - val_loss: 3.2823 - val_accuracy500: 0.3704 - 8s/epoch - 40ms/step
Epoch 9/50
211/211 - 8s - loss: 3.2572 - accuracy500: 0.3886 - val_loss: 3.2838 - val_accuracy500: 0.3692 - 8s/epoch - 39ms/step
Epoch 10/50
211/211 - 8s - loss: 3.2409 - accuracy500: 0.4041 - val_loss: 3.2964 - val_accuracy500: 0.3670 - 8s/epoch - 39ms/step
Epoch 11/50
211/211 - 8s - loss: 3.2347 - accuracy500: 0.4048 - val_loss: 3.2963 - val_accuracy500: 0.3571 - 8s/epoch - 39ms/step
Epoch 12/50
211/211 - 8s - loss: 3.2235 - accuracy500: 0.4103 - val_loss: 3.3037 - val_accuracy500: 0.3654 - 8s/epoch - 40ms/step
Epoch 13/50
211/211 - 8s - loss: 3.2173 - accuracy500: 0.4119 - val_loss: 3.2967 - val_accuracy500: 0.3734 - 8s/epoch - 38ms/step
Epoch 14/50
211/211 - 8s - loss: 3.2107 - accuracy500: 0.4180 - val_loss: 3.3031 - val_accuracy500: 0.3699 - 8s/epoch - 39ms/step
Epoch 15/50
211/211 - 8s - loss: 3.1904 - accuracy500: 0.4258 - val_loss: 3.3221 - val_accuracy500: 0.3618 - 8s/epoch - 39ms/step
Epoch 16/50
211/211 - 8s - loss: 3.1793 - accuracy500: 0.4326 - val_loss: 3.3235 - val_accuracy500: 0.3617 - 8s/epoch - 40ms/step
testing model: results/LILAK/W6/deepVOL_L3/h500
Evaluating performance on  test set...
1059/1059 - 18s - 18s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0977935
{'0': {'precision': 0.3147096285586423, 'recall': 0.10508770719819757, 'f1-score': 0.15756228294683866, 'support': 86994}, '1': {'precision': 0.331799716690666, 'recall': 0.3495646167887713, 'f1-score': 0.3404505786891055, 'support': 81078}, '2': {'precision': 0.3963882272556019, 'recall': 0.6026894509442206, 'f1-score': 0.4782390964352026, 'support': 102995}, 'accuracy': 0.36728188971730236, 'macro avg': {'precision': 0.34763252416830337, 'recall': 0.3524472583103965, 'f1-score': 0.32541731935704893, 'support': 271067}, 'weighted avg': {'precision': 0.350856106877145, 'recall': 0.36728188971730236, 'f1-score': 0.33411024211348583, 'support': 271067}}
[[ 9142 27080 50772]
 [ 8983 28342 43753]
 [10924 29997 62074]]
Evaluating performance on  train set...
211/211 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0895507
{'0': {'precision': 0.3693948991498583, 'recall': 0.1217515521125213, 'f1-score': 0.1831404958677686, 'support': 18201}, '1': {'precision': 0.38571104558856883, 'recall': 0.4728091637010676, 'f1-score': 0.42484198955757074, 'support': 17984}, '2': {'precision': 0.37518811499131777, 'recall': 0.5470349949364239, 'f1-score': 0.44510059740438096, 'support': 17774}, 'accuracy': 0.3788431957597435, 'macro avg': {'precision': 0.37676468657658163, 'recall': 0.3805319035833376, 'f1-score': 0.3510276942765734, 'support': 53959}, 'weighted avg': {'precision': 0.37674118421666586, 'recall': 0.3788431957597435, 'f1-score': 0.3499864067858573, 'support': 53959}}
[[2216 7363 8622]
 [1911 8503 7570]
 [1872 6179 9723]]
Evaluating performance on  val set...
81/81 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.094705
{'0': {'precision': 0.33865683865683865, 'recall': 0.12013364323067983, 'f1-score': 0.17735363499892773, 'support': 6884}, '1': {'precision': 0.35872791519434627, 'recall': 0.3805097451274363, 'f1-score': 0.3692979265187341, 'support': 6670}, '2': {'precision': 0.37904676258992803, 'recall': 0.5950868276154172, 'f1-score': 0.4631104762951162, 'support': 7083}, 'accuracy': 0.3673014488540001, 'macro avg': {'precision': 0.35881050548037097, 'recall': 0.3652434053245111, 'f1-score': 0.3365873459375927, 'support': 20637}, 'weighted avg': {'precision': 0.3590064976054866, 'recall': 0.3673014488540001, 'f1-score': 0.3374681928967817, 'support': 20637}}
[[ 827 2451 3606]
 [ 833 2538 3299]
 [ 782 2086 4215]]
training model: results/LILAK/W6/deepVOL_L3/h1000
Epoch 1/50
211/211 - 11s - loss: 3.3472 - accuracy1000: 0.3629 - val_loss: 3.3700 - val_accuracy1000: 0.3438 - 11s/epoch - 50ms/step
Epoch 2/50
211/211 - 8s - loss: 3.3080 - accuracy1000: 0.3798 - val_loss: 3.3758 - val_accuracy1000: 0.3472 - 8s/epoch - 39ms/step
Epoch 3/50
211/211 - 8s - loss: 3.2916 - accuracy1000: 0.3824 - val_loss: 3.3276 - val_accuracy1000: 0.3393 - 8s/epoch - 40ms/step
Epoch 4/50
211/211 - 8s - loss: 3.2887 - accuracy1000: 0.3819 - val_loss: 3.3093 - val_accuracy1000: 0.3540 - 8s/epoch - 39ms/step
Epoch 5/50
211/211 - 8s - loss: 3.2880 - accuracy1000: 0.3820 - val_loss: 3.3144 - val_accuracy1000: 0.3413 - 8s/epoch - 39ms/step
Epoch 6/50
211/211 - 8s - loss: 3.2757 - accuracy1000: 0.3786 - val_loss: 3.3175 - val_accuracy1000: 0.3373 - 8s/epoch - 39ms/step
Epoch 7/50
211/211 - 8s - loss: 3.2665 - accuracy1000: 0.3807 - val_loss: 3.3462 - val_accuracy1000: 0.3397 - 8s/epoch - 39ms/step
Epoch 8/50
211/211 - 9s - loss: 3.2638 - accuracy1000: 0.3858 - val_loss: 3.3243 - val_accuracy1000: 0.3393 - 9s/epoch - 40ms/step
Epoch 9/50
211/211 - 8s - loss: 3.2564 - accuracy1000: 0.3860 - val_loss: 3.3505 - val_accuracy1000: 0.3432 - 8s/epoch - 39ms/step
Epoch 10/50
211/211 - 8s - loss: 3.2556 - accuracy1000: 0.3865 - val_loss: 3.3468 - val_accuracy1000: 0.3435 - 8s/epoch - 40ms/step
Epoch 11/50
211/211 - 8s - loss: 3.2459 - accuracy1000: 0.3939 - val_loss: 3.3553 - val_accuracy1000: 0.3449 - 8s/epoch - 40ms/step
Epoch 12/50
211/211 - 8s - loss: 3.2437 - accuracy1000: 0.3954 - val_loss: 3.3431 - val_accuracy1000: 0.3525 - 8s/epoch - 38ms/step
Epoch 13/50
211/211 - 8s - loss: 3.2388 - accuracy1000: 0.3993 - val_loss: 3.3516 - val_accuracy1000: 0.3450 - 8s/epoch - 39ms/step
Epoch 14/50
211/211 - 8s - loss: 3.2246 - accuracy1000: 0.4066 - val_loss: 3.3581 - val_accuracy1000: 0.3456 - 8s/epoch - 39ms/step
testing model: results/LILAK/W6/deepVOL_L3/h1000
Evaluating performance on  test set...
1059/1059 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0982149
{'0': {'precision': 0.2858063684414078, 'recall': 0.027342015687435252, 'f1-score': 0.04990938868315305, 'support': 81084}, '1': {'precision': 0.34269046978755097, 'recall': 0.37709134779540643, 'f1-score': 0.35906883995144795, 'support': 87862}, '2': {'precision': 0.38974842163381906, 'recall': 0.6359416770301897, 'f1-score': 0.4832985425062047, 'support': 102121}, 'accuracy': 0.3699897073417273, 'macro avg': {'precision': 0.33941508662092595, 'recall': 0.3467916801710105, 'f1-score': 0.29742559038026856, 'support': 271067}, 'weighted avg': {'precision': 0.3434032626651129, 'recall': 0.3699897073417273, 'f1-score': 0.31339222312961384, 'support': 271067}}
[[ 2217 29356 49511]
 [ 2556 33132 52174]
 [ 2984 34194 64943]]
Evaluating performance on  train set...
211/211 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.106389
{'0': {'precision': 0.36581045172719223, 'recall': 0.04448753164216082, 'f1-score': 0.07932773109243697, 'support': 18567}, '1': {'precision': 0.37161786508524836, 'recall': 0.4391459074733096, 'f1-score': 0.40256970061983993, 'support': 18265}, '2': {'precision': 0.34126905070226116, 'recall': 0.6001050972149238, 'f1-score': 0.4351028702057404, 'support': 17127}, 'accuracy': 0.3544357753108842, 'macro avg': {'precision': 0.3595657891715673, 'recall': 0.36124617877679804, 'f1-score': 0.3056667673060058, 'support': 53959}, 'weighted avg': {'precision': 0.359986619366157, 'recall': 0.3544357753108842, 'f1-score': 0.3016701648108447, 'support': 53959}}
[[  826  7376 10365]
 [  770  8021  9474]
 [  662  6187 10278]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1068543
{'0': {'precision': 0.32779456193353473, 'recall': 0.03200589970501475, 'f1-score': 0.0583176565439398, 'support': 6780}, '1': {'precision': 0.37744579587519833, 'recall': 0.3987430167597765, 'f1-score': 0.3878022276555284, 'support': 7160}, '2': {'precision': 0.3355088228184675, 'recall': 0.6217709422129312, 'f1-score': 0.43583839229642035, 'support': 6697}, 'accuracy': 0.35063235935455733, 'macro avg': {'precision': 0.3469163935424002, 'recall': 0.35083995289257414, 'f1-score': 0.2939860921652962, 'support': 20637}, 'weighted avg': {'precision': 0.34752442771677394, 'recall': 0.35063235935455733, 'f1-score': 0.2951430621985086, 'support': 20637}}
[[ 217 2379 4184]
 [ 242 2855 4063]
 [ 203 2330 4164]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        14 (peak)  10.84 (ave)

============================================
