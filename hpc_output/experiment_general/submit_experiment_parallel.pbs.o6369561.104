This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/PCAR_orderbooks/PCAR_orderbooks_2020-01-22.csv
data/PCAR_orderbooks/PCAR_orderbooks_2020-01-14.csv
data/PCAR_orderbooks/PCAR_orderbooks_2020-01-02.csv
data/PCAR_orderbooks/PCAR_orderbooks_2020-01-10.csv
data/PCAR_orderbooks/PCAR_orderbooks_2020-01-06.csv
data/PCAR_orderbooks/PCAR_orderbooks_2020-01-08.csv
data/PCAR_orderbooks/PCAR_orderbooks_2020-01-03.csv
data/PCAR_orderbooks/PCAR_orderbooks_2020-01-24.csv
data/PCAR_orderbooks/PCAR_orderbooks_2020-01-07.csv
data/PCAR_orderbooks/PCAR_orderbooks_2020-01-09.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-12-31.csv
data/PCAR_orderbooks/PCAR_orderbooks_2020-01-16.csv
data/PCAR_orderbooks/PCAR_orderbooks_2020-01-15.csv
training model: results/PCAR/W10/deepLOB_L1/h10
Epoch 1/50
428/428 - 20s - loss: 3.2928 - accuracy10: 0.3806 - val_loss: 3.4110 - val_accuracy10: 0.3270 - 20s/epoch - 48ms/step
Epoch 2/50
428/428 - 10s - loss: 3.2316 - accuracy10: 0.4069 - val_loss: 3.3543 - val_accuracy10: 0.3303 - 10s/epoch - 24ms/step
Epoch 3/50
428/428 - 10s - loss: 3.2032 - accuracy10: 0.4232 - val_loss: 3.3140 - val_accuracy10: 0.3473 - 10s/epoch - 24ms/step
Epoch 4/50
428/428 - 10s - loss: 3.1846 - accuracy10: 0.4337 - val_loss: 3.2935 - val_accuracy10: 0.3557 - 10s/epoch - 24ms/step
Epoch 5/50
428/428 - 10s - loss: 3.1751 - accuracy10: 0.4374 - val_loss: 3.3194 - val_accuracy10: 0.3513 - 10s/epoch - 23ms/step
Epoch 6/50
428/428 - 10s - loss: 3.1660 - accuracy10: 0.4428 - val_loss: 3.2612 - val_accuracy10: 0.3863 - 10s/epoch - 24ms/step
Epoch 7/50
428/428 - 10s - loss: 3.1578 - accuracy10: 0.4461 - val_loss: 3.2948 - val_accuracy10: 0.3707 - 10s/epoch - 24ms/step
Epoch 8/50
428/428 - 10s - loss: 3.1451 - accuracy10: 0.4508 - val_loss: 3.3152 - val_accuracy10: 0.3637 - 10s/epoch - 23ms/step
Epoch 9/50
428/428 - 10s - loss: 3.1410 - accuracy10: 0.4513 - val_loss: 3.3058 - val_accuracy10: 0.3695 - 10s/epoch - 24ms/step
Epoch 10/50
428/428 - 11s - loss: 3.1348 - accuracy10: 0.4543 - val_loss: 3.3247 - val_accuracy10: 0.3624 - 11s/epoch - 25ms/step
Epoch 11/50
428/428 - 10s - loss: 3.1280 - accuracy10: 0.4562 - val_loss: 3.3395 - val_accuracy10: 0.3591 - 10s/epoch - 24ms/step
Epoch 12/50
428/428 - 10s - loss: 3.1217 - accuracy10: 0.4580 - val_loss: 3.3565 - val_accuracy10: 0.3578 - 10s/epoch - 24ms/step
Epoch 13/50
428/428 - 10s - loss: 3.1180 - accuracy10: 0.4596 - val_loss: 3.3359 - val_accuracy10: 0.3601 - 10s/epoch - 24ms/step
Epoch 14/50
428/428 - 10s - loss: 3.1129 - accuracy10: 0.4616 - val_loss: 3.3171 - val_accuracy10: 0.3691 - 10s/epoch - 23ms/step
Epoch 15/50
428/428 - 10s - loss: 3.1102 - accuracy10: 0.4623 - val_loss: 3.3530 - val_accuracy10: 0.3557 - 10s/epoch - 23ms/step
Epoch 16/50
428/428 - 10s - loss: 3.1069 - accuracy10: 0.4632 - val_loss: 3.3322 - val_accuracy10: 0.3642 - 10s/epoch - 23ms/step
testing model: results/PCAR/W10/deepLOB_L1/h10
Evaluating performance on  test set...
2104/2104 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1470838
{'0': {'precision': 0.5117111783746622, 'recall': 0.24373504825490963, 'f1-score': 0.3301941140408437, 'support': 219874}, '1': {'precision': 0.19358009030451084, 'recall': 0.6082079613278745, 'f1-score': 0.29368597308994077, 'support': 101365}, '2': {'precision': 0.5165230507828077, 'recall': 0.27416920514259946, 'f1-score': 0.35820437903545793, 'support': 217322}, 'accuracy': 0.3246150389649455, 'macro avg': {'precision': 0.4072714398206602, 'recall': 0.37537073824179457, 'f1-score': 0.3273614887220808, 'support': 538561}, 'weighted avg': {'precision': 0.4537759918187328, 'recall': 0.3246150389649455, 'f1-score': 0.33462555096566976, 'support': 538561}}
[[ 53591 131987  34296]
 [ 18239  61651  21475]
 [ 32899 124840  59583]]
Evaluating performance on  train set...
428/428 - 14s - 14s/epoch - 33ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0871978
{'0': {'precision': 0.4674275138803208, 'recall': 0.20896880774428417, 'f1-score': 0.2888181592940593, 'support': 36259}, '1': {'precision': 0.34965262842320677, 'recall': 0.7417597610883752, 'f1-score': 0.4752708556647148, 'support': 36164}, '2': {'precision': 0.4850588590401449, 'recall': 0.2167462436945321, 'f1-score': 0.2996122007606831, 'support': 37071}, 'accuracy': 0.387573748333242, 'macro avg': {'precision': 0.43404633378122415, 'recall': 0.3891582708423971, 'f1-score': 0.35456707190648573, 'support': 109494}, 'weighted avg': {'precision': 0.4344978614678486, 'recall': 0.387573748333242, 'f1-score': 0.35405480443221843, 'support': 109494}}
[[ 7577 25090  3592]
 [ 4401 26825  4938]
 [ 4232 24804  8035]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0889474
{'0': {'precision': 0.4517918088737201, 'recall': 0.26120200608402533, 'f1-score': 0.3310237040896067, 'support': 12163}, '1': {'precision': 0.3378163537146049, 'recall': 0.6945229681978798, 'f1-score': 0.4545428265834128, 'support': 11320}, '2': {'precision': 0.494472182596291, 'recall': 0.22308930008045053, 'f1-score': 0.3074620246147023, 'support': 12430}, 'accuracy': 0.38459610725920973, 'macro avg': {'precision': 0.4280267817282053, 'recall': 0.39293809145411857, 'f1-score': 0.36434285176257397, 'support': 35913}, 'weighted avg': {'precision': 0.43063832386746537, 'recall': 0.38459610725920973, 'f1-score': 0.3618026640973148, 'support': 35913}}
[[3177 7676 1310]
 [1933 7862 1525]
 [1922 7735 2773]]
training model: results/PCAR/W10/deepLOB_L1/h20
Epoch 1/50
428/428 - 12s - loss: 3.3020 - accuracy20: 0.3732 - val_loss: 3.3843 - val_accuracy20: 0.3436 - 12s/epoch - 29ms/step
Epoch 2/50
428/428 - 10s - loss: 3.2589 - accuracy20: 0.3920 - val_loss: 3.3463 - val_accuracy20: 0.3420 - 10s/epoch - 24ms/step
Epoch 3/50
428/428 - 11s - loss: 3.2408 - accuracy20: 0.4003 - val_loss: 3.2997 - val_accuracy20: 0.3510 - 11s/epoch - 25ms/step
Epoch 4/50
428/428 - 10s - loss: 3.2272 - accuracy20: 0.4072 - val_loss: 3.3163 - val_accuracy20: 0.3538 - 10s/epoch - 24ms/step
Epoch 5/50
428/428 - 10s - loss: 3.2116 - accuracy20: 0.4178 - val_loss: 3.3193 - val_accuracy20: 0.3479 - 10s/epoch - 24ms/step
Epoch 6/50
428/428 - 10s - loss: 3.2045 - accuracy20: 0.4217 - val_loss: 3.3331 - val_accuracy20: 0.3501 - 10s/epoch - 23ms/step
Epoch 7/50
428/428 - 10s - loss: 3.1966 - accuracy20: 0.4240 - val_loss: 3.3098 - val_accuracy20: 0.3610 - 10s/epoch - 23ms/step
Epoch 8/50
428/428 - 10s - loss: 3.1893 - accuracy20: 0.4282 - val_loss: 3.3259 - val_accuracy20: 0.3533 - 10s/epoch - 24ms/step
Epoch 9/50
428/428 - 10s - loss: 3.1849 - accuracy20: 0.4313 - val_loss: 3.3381 - val_accuracy20: 0.3549 - 10s/epoch - 23ms/step
Epoch 10/50
428/428 - 10s - loss: 3.1799 - accuracy20: 0.4314 - val_loss: 3.3078 - val_accuracy20: 0.3620 - 10s/epoch - 23ms/step
Epoch 11/50
428/428 - 10s - loss: 3.1747 - accuracy20: 0.4342 - val_loss: 3.3037 - val_accuracy20: 0.3657 - 10s/epoch - 24ms/step
Epoch 12/50
428/428 - 10s - loss: 3.1695 - accuracy20: 0.4353 - val_loss: 3.3148 - val_accuracy20: 0.3625 - 10s/epoch - 24ms/step
Epoch 13/50
428/428 - 10s - loss: 3.1652 - accuracy20: 0.4376 - val_loss: 3.3096 - val_accuracy20: 0.3612 - 10s/epoch - 24ms/step
testing model: results/PCAR/W10/deepLOB_L1/h20
Evaluating performance on  test set...
2104/2104 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1426739
{'0': {'precision': 0.5084010721990978, 'recall': 0.10985176674451895, 'f1-score': 0.18066639561673542, 'support': 212368}, '1': {'precision': 0.21984195925687225, 'recall': 0.8048042400410327, 'f1-score': 0.3453479670740833, 'support': 116980}, '2': {'precision': 0.47758808008691606, 'recall': 0.1470797703775578, 'f1-score': 0.2248988645790318, 'support': 209213}, 'accuracy': 0.27526315496294756, 'macro avg': {'precision': 0.40194370384762873, 'recall': 0.3539119257210364, 'f1-score': 0.25030440908995016, 'support': 538561}, 'weighted avg': {'precision': 0.43375377402721493, 'recall': 0.27526315496294756, 'f1-score': 0.23361946455059707, 'support': 538561}}
[[ 23329 169143  19896]
 [  9071  94146  13763]
 [ 13487 164955  30771]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0959091
{'0': {'precision': 0.43327763189305324, 'recall': 0.15000413234524368, 'f1-score': 0.22285433634838128, 'support': 36299}, '1': {'precision': 0.33518648061558853, 'recall': 0.7551217893776438, 'f1-score': 0.4642845000509978, 'support': 36169}, '2': {'precision': 0.4370629370629371, 'recall': 0.18230432668935342, 'f1-score': 0.25728987993138935, 'support': 37026}, 'accuracy': 0.360814291194038, 'macro avg': {'precision': 0.40184234985719297, 'recall': 0.362476749470747, 'f1-score': 0.3148095721102562, 'support': 109494}, 'weighted avg': {'precision': 0.40215534079642234, 'recall': 0.360814291194038, 'f1-score': 0.31425019390828773, 'support': 109494}}
[[ 5445 27001  3853]
 [ 4016 27312  4841]
 [ 3106 27170  6750]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.100247
{'0': {'precision': 0.4409986859395532, 'recall': 0.14116261462101456, 'f1-score': 0.2138669385674229, 'support': 11887}, '1': {'precision': 0.32364703724087324, 'recall': 0.7574924860455131, 'f1-score': 0.45352185089974295, 'support': 11645}, '2': {'precision': 0.4281887492272821, 'recall': 0.16783781600839998, 'f1-score': 0.24115121271904377, 'support': 12381}, 'accuracy': 0.35020744577172613, 'macro avg': {'precision': 0.39761149080256947, 'recall': 0.3554976388916426, 'f1-score': 0.30284666739540317, 'support': 35913}, 'weighted avg': {'precision': 0.3985305051824247, 'recall': 0.35020744577172613, 'f1-score': 0.30098269198209404, 'support': 35913}}
[[1678 9023 1186]
 [1235 8821 1589]
 [ 892 9411 2078]]
training model: results/PCAR/W10/deepLOB_L1/h30
Epoch 1/50
428/428 - 12s - loss: 3.3067 - accuracy30: 0.3716 - val_loss: 3.3682 - val_accuracy30: 0.3462 - 12s/epoch - 29ms/step
Epoch 2/50
428/428 - 10s - loss: 3.2734 - accuracy30: 0.3839 - val_loss: 3.3703 - val_accuracy30: 0.3331 - 10s/epoch - 24ms/step
Epoch 3/50
428/428 - 10s - loss: 3.2618 - accuracy30: 0.3881 - val_loss: 3.3149 - val_accuracy30: 0.3428 - 10s/epoch - 24ms/step
Epoch 4/50
428/428 - 10s - loss: 3.2450 - accuracy30: 0.3971 - val_loss: 3.3131 - val_accuracy30: 0.3508 - 10s/epoch - 24ms/step
Epoch 5/50
428/428 - 10s - loss: 3.2332 - accuracy30: 0.4046 - val_loss: 3.3096 - val_accuracy30: 0.3484 - 10s/epoch - 24ms/step
Epoch 6/50
428/428 - 10s - loss: 3.2246 - accuracy30: 0.4103 - val_loss: 3.3296 - val_accuracy30: 0.3527 - 10s/epoch - 23ms/step
Epoch 7/50
428/428 - 10s - loss: 3.2186 - accuracy30: 0.4134 - val_loss: 3.3224 - val_accuracy30: 0.3512 - 10s/epoch - 24ms/step
Epoch 8/50
428/428 - 10s - loss: 3.2136 - accuracy30: 0.4161 - val_loss: 3.3316 - val_accuracy30: 0.3493 - 10s/epoch - 24ms/step
Epoch 9/50
428/428 - 10s - loss: 3.2095 - accuracy30: 0.4175 - val_loss: 3.3147 - val_accuracy30: 0.3553 - 10s/epoch - 23ms/step
Epoch 10/50
428/428 - 10s - loss: 3.2041 - accuracy30: 0.4192 - val_loss: 3.3264 - val_accuracy30: 0.3562 - 10s/epoch - 24ms/step
Epoch 11/50
428/428 - 10s - loss: 3.2010 - accuracy30: 0.4220 - val_loss: 3.3239 - val_accuracy30: 0.3551 - 10s/epoch - 24ms/step
Epoch 12/50
428/428 - 10s - loss: 3.1983 - accuracy30: 0.4222 - val_loss: 3.3328 - val_accuracy30: 0.3521 - 10s/epoch - 23ms/step
Epoch 13/50
428/428 - 10s - loss: 3.1973 - accuracy30: 0.4219 - val_loss: 3.3221 - val_accuracy30: 0.3529 - 10s/epoch - 24ms/step
Epoch 14/50
428/428 - 10s - loss: 3.1937 - accuracy30: 0.4267 - val_loss: 3.3372 - val_accuracy30: 0.3524 - 10s/epoch - 24ms/step
Epoch 15/50
428/428 - 10s - loss: 3.1915 - accuracy30: 0.4252 - val_loss: 3.3267 - val_accuracy30: 0.3604 - 10s/epoch - 24ms/step
testing model: results/PCAR/W10/deepLOB_L1/h30
Evaluating performance on  test set...
2104/2104 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.138849
{'0': {'precision': 0.47694959726629244, 'recall': 0.1476393755371495, 'f1-score': 0.22548121650956665, 'support': 211766}, '1': {'precision': 0.21505587238365367, 'recall': 0.7287988274592678, 'f1-score': 0.33211143125635867, 'support': 117352}, '2': {'precision': 0.4740629605533943, 'recall': 0.1704759767573994, 'f1-score': 0.2507725804185981, 'support': 209443}, 'accuracy': 0.2831545544515849, 'macro avg': {'precision': 0.3886894767344468, 'recall': 0.3489713932512722, 'f1-score': 0.2694550760615078, 'support': 538561}, 'weighted avg': {'precision': 0.41876057456415294, 'recall': 0.2831545544515849, 'f1-score': 0.2585515058401435, 'support': 538561}}
[[ 31265 157980  22521]
 [ 14735  85526  17091]
 [ 19552 154186  35705]]
Evaluating performance on  train set...
428/428 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1003897
{'0': {'precision': 0.4524466237613648, 'recall': 0.12243600375960635, 'f1-score': 0.19272023149054673, 'support': 36174}, '1': {'precision': 0.33511321392362287, 'recall': 0.8191656340355226, 'f1-score': 0.47564456169804537, 'support': 36315}, '2': {'precision': 0.4539551897576589, 'recall': 0.13414403458992027, 'f1-score': 0.20709219858156028, 'support': 37005}, 'accuracy': 0.35747164228176886, 'macro avg': {'precision': 0.4138383424808822, 'recall': 0.3585818907950164, 'f1-score': 0.29181899725671745, 'support': 109494}, 'weighted avg': {'precision': 0.41404142992823484, 'recall': 0.35747164228176886, 'f1-score': 0.29141268672725623, 'support': 109494}}
[[ 4429 29208  2537]
 [ 3133 29748  3434]
 [ 2227 29814  4964]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1038408
{'0': {'precision': 0.437080024434942, 'recall': 0.120010063737001, 'f1-score': 0.18831425187524675, 'support': 11924}, '1': {'precision': 0.3267028126058963, 'recall': 0.8347186147186147, 'f1-score': 0.4696054554310764, 'support': 11550}, '2': {'precision': 0.4531799296899968, 'recall': 0.11399630195353325, 'f1-score': 0.18216855087358685, 'support': 12439}, 'accuracy': 0.34778492467908556, 'macro avg': {'precision': 0.40565425557694507, 'recall': 0.356241660136383, 'f1-score': 0.28002941939330334, 'support': 35913}, 'weighted avg': {'precision': 0.40715798853825136, 'recall': 0.34778492467908556, 'f1-score': 0.2766518183918336, 'support': 35913}}
[[ 1431  9738   755]
 [  953  9641   956]
 [  890 10131  1418]]
training model: results/PCAR/W10/deepLOB_L1/h50
Epoch 1/50
428/428 - 12s - loss: 3.3250 - accuracy50: 0.3631 - val_loss: 3.3560 - val_accuracy50: 0.3458 - 12s/epoch - 29ms/step
Epoch 2/50
428/428 - 10s - loss: 3.2834 - accuracy50: 0.3773 - val_loss: 3.3103 - val_accuracy50: 0.3637 - 10s/epoch - 24ms/step
Epoch 3/50
428/428 - 10s - loss: 3.2717 - accuracy50: 0.3846 - val_loss: 3.3207 - val_accuracy50: 0.3521 - 10s/epoch - 23ms/step
Epoch 4/50
428/428 - 10s - loss: 3.2631 - accuracy50: 0.3883 - val_loss: 3.3456 - val_accuracy50: 0.3441 - 10s/epoch - 23ms/step
Epoch 5/50
428/428 - 10s - loss: 3.2546 - accuracy50: 0.3941 - val_loss: 3.3088 - val_accuracy50: 0.3497 - 10s/epoch - 24ms/step
Epoch 6/50
428/428 - 10s - loss: 3.2460 - accuracy50: 0.4029 - val_loss: 3.3214 - val_accuracy50: 0.3603 - 10s/epoch - 23ms/step
Epoch 7/50
428/428 - 10s - loss: 3.2393 - accuracy50: 0.4064 - val_loss: 3.3144 - val_accuracy50: 0.3539 - 10s/epoch - 23ms/step
Epoch 8/50
428/428 - 10s - loss: 3.2327 - accuracy50: 0.4075 - val_loss: 3.3174 - val_accuracy50: 0.3512 - 10s/epoch - 24ms/step
Epoch 9/50
428/428 - 10s - loss: 3.2276 - accuracy50: 0.4109 - val_loss: 3.3196 - val_accuracy50: 0.3618 - 10s/epoch - 23ms/step
Epoch 10/50
428/428 - 10s - loss: 3.2239 - accuracy50: 0.4123 - val_loss: 3.3142 - val_accuracy50: 0.3576 - 10s/epoch - 23ms/step
Epoch 11/50
428/428 - 10s - loss: 3.2182 - accuracy50: 0.4158 - val_loss: 3.3283 - val_accuracy50: 0.3547 - 10s/epoch - 23ms/step
Epoch 12/50
428/428 - 10s - loss: 3.2134 - accuracy50: 0.4160 - val_loss: 3.3300 - val_accuracy50: 0.3531 - 10s/epoch - 23ms/step
Epoch 13/50
428/428 - 10s - loss: 3.2095 - accuracy50: 0.4206 - val_loss: 3.3287 - val_accuracy50: 0.3535 - 10s/epoch - 23ms/step
Epoch 14/50
428/428 - 10s - loss: 3.2055 - accuracy50: 0.4208 - val_loss: 3.3480 - val_accuracy50: 0.3468 - 10s/epoch - 24ms/step
Epoch 15/50
428/428 - 10s - loss: 3.2023 - accuracy50: 0.4238 - val_loss: 3.3379 - val_accuracy50: 0.3512 - 10s/epoch - 23ms/step
testing model: results/PCAR/W10/deepLOB_L1/h50
Evaluating performance on  test set...
2104/2104 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1147975
{'0': {'precision': 0.4391210219696716, 'recall': 0.415527034605018, 'f1-score': 0.426998352568854, 'support': 221124}, '1': {'precision': 0.16734200065292953, 'recall': 0.3592957572259102, 'f1-score': 0.22833634672326597, 'support': 97012}, '2': {'precision': 0.44283046618082067, 'recall': 0.24313938981512986, 'f1-score': 0.313919127488278, 'support': 220425}, 'accuracy': 0.33484229270221944, 'macro avg': {'precision': 0.34976449626780726, 'recall': 0.33932072721535267, 'f1-score': 0.3230846089267993, 'support': 538561}, 'weighted avg': {'precision': 0.3916831789477349, 'recall': 0.33484229270221944, 'f1-score': 0.34493135050320467, 'support': 538561}}
[[91883 85244 43997]
 [38721 34856 23435]
 [78639 88192 53594]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0967385
{'0': {'precision': 0.38078696771875187, 'recall': 0.3478403588915939, 'f1-score': 0.3635687838629898, 'support': 36557}, '1': {'precision': 0.34456134671414695, 'recall': 0.5877464244298415, 'f1-score': 0.43443743749872443, 'support': 36218}, '2': {'precision': 0.4018156424581006, 'recall': 0.1567036139328413, 'f1-score': 0.22547463704226178, 'support': 36719}, 'accuracy': 0.36309752132536943, 'macro avg': {'precision': 0.3757213189636665, 'recall': 0.36409679908475895, 'f1-score': 0.3411602861346587, 'support': 109494}, 'weighted avg': {'precision': 0.3758563995251464, 'recall': 0.36309752132536943, 'f1-score': 0.3407003337220572, 'support': 109494}}
[[12716 19694  4147]
 [10512 21287  4419]
 [10166 20799  5754]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1038153
{'0': {'precision': 0.3674321503131524, 'recall': 0.39425869078237785, 'f1-score': 0.3803730088849756, 'support': 12053}, '1': {'precision': 0.3242062029382339, 'recall': 0.5445299372070399, 'f1-score': 0.40642946729157037, 'support': 11307}, '2': {'precision': 0.39207821509150165, 'recall': 0.12459173106030431, 'f1-score': 0.18909442630878975, 'support': 12553}, 'accuracy': 0.3473115584885696, 'macro avg': {'precision': 0.361238856114296, 'recall': 0.3544601196832407, 'f1-score': 0.3252989674951119, 'support': 35913}, 'weighted avg': {'precision': 0.36243747607804017, 'recall': 0.3473115584885696, 'f1-score': 0.3217173780026908, 'support': 35913}}
[[4752 6149 1152]
 [3877 6157 1273]
 [4304 6685 1564]]
training model: results/PCAR/W10/deepLOB_L1/h100
Epoch 1/50
428/428 - 12s - loss: 3.3323 - accuracy100: 0.3565 - val_loss: 3.4338 - val_accuracy100: 0.3196 - 12s/epoch - 29ms/step
Epoch 2/50
428/428 - 10s - loss: 3.3088 - accuracy100: 0.3589 - val_loss: 3.3962 - val_accuracy100: 0.3194 - 10s/epoch - 23ms/step
Epoch 3/50
428/428 - 10s - loss: 3.2983 - accuracy100: 0.3585 - val_loss: 3.3423 - val_accuracy100: 0.3198 - 10s/epoch - 24ms/step
Epoch 4/50
428/428 - 10s - loss: 3.2855 - accuracy100: 0.3669 - val_loss: 3.3405 - val_accuracy100: 0.3264 - 10s/epoch - 23ms/step
Epoch 5/50
428/428 - 10s - loss: 3.2797 - accuracy100: 0.3715 - val_loss: 3.3351 - val_accuracy100: 0.3278 - 10s/epoch - 24ms/step
Epoch 6/50
428/428 - 10s - loss: 3.2725 - accuracy100: 0.3776 - val_loss: 3.3417 - val_accuracy100: 0.3314 - 10s/epoch - 23ms/step
Epoch 7/50
428/428 - 10s - loss: 3.2688 - accuracy100: 0.3818 - val_loss: 3.3440 - val_accuracy100: 0.3339 - 10s/epoch - 23ms/step
Epoch 8/50
428/428 - 10s - loss: 3.2658 - accuracy100: 0.3846 - val_loss: 3.3417 - val_accuracy100: 0.3312 - 10s/epoch - 23ms/step
Epoch 9/50
428/428 - 10s - loss: 3.2627 - accuracy100: 0.3845 - val_loss: 3.3300 - val_accuracy100: 0.3361 - 10s/epoch - 23ms/step
Epoch 10/50
428/428 - 10s - loss: 3.2592 - accuracy100: 0.3881 - val_loss: 3.3431 - val_accuracy100: 0.3345 - 10s/epoch - 23ms/step
Epoch 11/50
428/428 - 10s - loss: 3.2551 - accuracy100: 0.3891 - val_loss: 3.3479 - val_accuracy100: 0.3336 - 10s/epoch - 23ms/step
Epoch 12/50
428/428 - 10s - loss: 3.2525 - accuracy100: 0.3928 - val_loss: 3.3484 - val_accuracy100: 0.3359 - 10s/epoch - 23ms/step
Epoch 13/50
428/428 - 10s - loss: 3.2506 - accuracy100: 0.3929 - val_loss: 3.3588 - val_accuracy100: 0.3393 - 10s/epoch - 23ms/step
Epoch 14/50
428/428 - 10s - loss: 3.2473 - accuracy100: 0.3956 - val_loss: 3.3650 - val_accuracy100: 0.3369 - 10s/epoch - 23ms/step
Epoch 15/50
428/428 - 10s - loss: 3.2427 - accuracy100: 0.3963 - val_loss: 3.3624 - val_accuracy100: 0.3377 - 10s/epoch - 23ms/step
Epoch 16/50
428/428 - 10s - loss: 3.2418 - accuracy100: 0.3984 - val_loss: 3.3658 - val_accuracy100: 0.3324 - 10s/epoch - 23ms/step
Epoch 17/50
428/428 - 10s - loss: 3.2393 - accuracy100: 0.4007 - val_loss: 3.3838 - val_accuracy100: 0.3366 - 10s/epoch - 24ms/step
Epoch 18/50
428/428 - 10s - loss: 3.2355 - accuracy100: 0.4014 - val_loss: 3.3707 - val_accuracy100: 0.3367 - 10s/epoch - 23ms/step
Epoch 19/50
428/428 - 10s - loss: 3.2329 - accuracy100: 0.4039 - val_loss: 3.3932 - val_accuracy100: 0.3348 - 10s/epoch - 24ms/step
testing model: results/PCAR/W10/deepLOB_L1/h100
Evaluating performance on  test set...
2104/2104 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1229426
{'0': {'precision': 0.4170820533932926, 'recall': 0.31604737999020915, 'f1-score': 0.3596027773909672, 'support': 208358}, '1': {'precision': 0.2356420984225988, 'recall': 0.5681265698064141, 'f1-score': 0.3331170829880431, 'support': 123821}, '2': {'precision': 0.40190146931719967, 'recall': 0.15997034625112655, 'f1-score': 0.228850479501194, 'support': 206382}, 'accuracy': 0.3141928212403052, 'macro avg': {'precision': 0.35154187371103035, 'recall': 0.3480480986825833, 'f1-score': 0.30719011329340146, 'support': 538561}, 'weighted avg': {'precision': 0.3695496922174583, 'recall': 0.3141928212403052, 'f1-score': 0.30340783213917283, 'support': 538561}}
[[ 65851 114719  27788]
 [ 32131  70346  21344]
 [ 59903 113464  33015]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.105345
{'0': {'precision': 0.3511541325390916, 'recall': 0.4540602992957746, 'f1-score': 0.3960315270463189, 'support': 36352}, '1': {'precision': 0.3386060123358462, 'recall': 0.5009865716634695, 'f1-score': 0.4040937676145846, 'support': 36490}, '2': {'precision': 0.3904705882352941, 'recall': 0.09055440357961367, 'f1-score': 0.1470145287030475, 'support': 36652}, 'accuracy': 0.3480190695380569, 'macro avg': {'precision': 0.36007691103674394, 'recall': 0.3485337581796193, 'f1-score': 0.3157132744546503, 'support': 109494}, 'weighted avg': {'precision': 0.36013312525066293, 'recall': 0.3480190695380569, 'f1-score': 0.3153624505221115, 'support': 109494}}
[[16506 17172  2674]
 [15702 18281  2507]
 [14797 18536  3319]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1109388
{'0': {'precision': 0.3533245556287031, 'recall': 0.4432240482285903, 'f1-score': 0.3932012161617642, 'support': 12109}, '1': {'precision': 0.307180404876412, 'recall': 0.487529954735067, 'f1-score': 0.37689114549384195, 'support': 11267}, '2': {'precision': 0.4118268215417107, 'recall': 0.09332376166547021, 'f1-score': 0.15216543113538822, 'support': 12537}, 'accuracy': 0.33497619246512406, 'macro avg': {'precision': 0.35744392734894187, 'recall': 0.3413592548763758, 'f1-score': 0.3074192642636648, 'support': 35913}, 'weighted avg': {'precision': 0.3592705016990763, 'recall': 0.33497619246512406, 'f1-score': 0.30394019082021223, 'support': 35913}}
[[5367 5862  880]
 [4983 5493  791]
 [4840 6527 1170]]
training model: results/PCAR/W10/deepLOB_L1/h200
Epoch 1/50
428/428 - 12s - loss: 3.3380 - accuracy200: 0.3560 - val_loss: 3.4654 - val_accuracy200: 0.3124 - 12s/epoch - 29ms/step
Epoch 2/50
428/428 - 10s - loss: 3.3110 - accuracy200: 0.3595 - val_loss: 3.4547 - val_accuracy200: 0.3135 - 10s/epoch - 23ms/step
Epoch 3/50
428/428 - 10s - loss: 3.2922 - accuracy200: 0.3664 - val_loss: 3.4062 - val_accuracy200: 0.3084 - 10s/epoch - 23ms/step
Epoch 4/50
428/428 - 10s - loss: 3.2882 - accuracy200: 0.3693 - val_loss: 3.3851 - val_accuracy200: 0.3143 - 10s/epoch - 24ms/step
Epoch 5/50
428/428 - 10s - loss: 3.2847 - accuracy200: 0.3709 - val_loss: 3.3979 - val_accuracy200: 0.3113 - 10s/epoch - 23ms/step
Epoch 6/50
428/428 - 10s - loss: 3.2738 - accuracy200: 0.3770 - val_loss: 3.4146 - val_accuracy200: 0.3092 - 10s/epoch - 23ms/step
Epoch 7/50
428/428 - 10s - loss: 3.2644 - accuracy200: 0.3858 - val_loss: 3.4014 - val_accuracy200: 0.3192 - 10s/epoch - 24ms/step
Epoch 8/50
428/428 - 10s - loss: 3.2598 - accuracy200: 0.3891 - val_loss: 3.4263 - val_accuracy200: 0.3146 - 10s/epoch - 23ms/step
Epoch 9/50
428/428 - 10s - loss: 3.2548 - accuracy200: 0.3947 - val_loss: 3.4120 - val_accuracy200: 0.3177 - 10s/epoch - 24ms/step
Epoch 10/50
428/428 - 10s - loss: 3.2483 - accuracy200: 0.3984 - val_loss: 3.4275 - val_accuracy200: 0.3205 - 10s/epoch - 24ms/step
Epoch 11/50
428/428 - 10s - loss: 3.2445 - accuracy200: 0.4033 - val_loss: 3.4211 - val_accuracy200: 0.3225 - 10s/epoch - 24ms/step
Epoch 12/50
428/428 - 10s - loss: 3.2425 - accuracy200: 0.4028 - val_loss: 3.4310 - val_accuracy200: 0.3223 - 10s/epoch - 24ms/step
Epoch 13/50
428/428 - 10s - loss: 3.2374 - accuracy200: 0.4068 - val_loss: 3.4293 - val_accuracy200: 0.3195 - 10s/epoch - 23ms/step
Epoch 14/50
428/428 - 10s - loss: 3.2352 - accuracy200: 0.4056 - val_loss: 3.4379 - val_accuracy200: 0.3178 - 10s/epoch - 23ms/step
testing model: results/PCAR/W10/deepLOB_L1/h200
Evaluating performance on  test set...
2104/2104 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1576695
{'0': {'precision': 0.41276692412539756, 'recall': 0.008670216826996488, 'f1-score': 0.016983689302238633, 'support': 209568}, '1': {'precision': 0.23245343333589719, 'recall': 0.9906222268413774, 'f1-score': 0.376548312202949, 'support': 125083}, '2': {'precision': 0.4701627486437613, 'recall': 0.0025501446716688736, 'f1-score': 0.005072774807819877, 'support': 203910}, 'accuracy': 0.23441541440988115, 'macro avg': {'precision': 0.3717943687016853, 'recall': 0.33394752944668094, 'f1-score': 0.1328682587710025, 'support': 538561}, 'weighted avg': {'precision': 0.3926195874432325, 'recall': 0.23441541440988115, 'f1-score': 0.09598433575033388, 'support': 538561}}
[[  1817 207389    362]
 [   949 123910    224]
 [  1636 201754    520]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1206775
{'0': {'precision': 0.35404699738903395, 'recall': 0.018548916611950097, 'f1-score': 0.035250994358801045, 'support': 36552}, '1': {'precision': 0.33110071915638856, 'recall': 0.9826108592281323, 'f1-score': 0.49530379041248607, 'support': 36172}, '2': {'precision': 0.4329004329004329, 'recall': 0.0027196083763937995, 'f1-score': 0.005405259317315749, 'support': 36770}, 'accuracy': 0.3317168064003507, 'macro avg': {'precision': 0.3726827164819518, 'recall': 0.33462646140549207, 'f1-score': 0.17865334802953428, 'support': 109494}, 'weighted avg': {'precision': 0.37294691927994017, 'recall': 0.3317168064003507, 'f1-score': 0.1772094766626577, 'support': 109494}}
[[  678 35785    89]
 [  587 35543    42]
 [  650 36020   100]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1299987
{'0': {'precision': 0.38461538461538464, 'recall': 0.07212523563642324, 'f1-score': 0.12147146110842708, 'support': 12201}, '1': {'precision': 0.3088726015969491, 'recall': 0.9416840766645472, 'f1-score': 0.4651694972292644, 'support': 11009}, '2': {'precision': 0.29508196721311475, 'recall': 0.0014169881130441629, 'f1-score': 0.0028204324663115015, 'support': 12703}, 'accuracy': 0.31367471389190543, 'macro avg': {'precision': 0.3295233178084828, 'recall': 0.3384087668046715, 'f1-score': 0.196487130268001, 'support': 35913}, 'weighted avg': {'precision': 0.3297273134570021, 'recall': 0.31367471389190543, 'f1-score': 0.18486209020690125, 'support': 35913}}
[[  880 11303    18]
 [  617 10367    25]
 [  791 11894    18]]
training model: results/PCAR/W10/deepLOB_L1/h300
Epoch 1/50
428/428 - 12s - loss: 3.3410 - accuracy300: 0.3554 - val_loss: 3.3779 - val_accuracy300: 0.3278 - 12s/epoch - 29ms/step
Epoch 2/50
428/428 - 10s - loss: 3.3067 - accuracy300: 0.3590 - val_loss: 3.3393 - val_accuracy300: 0.3392 - 10s/epoch - 24ms/step
Epoch 3/50
428/428 - 10s - loss: 3.2909 - accuracy300: 0.3726 - val_loss: 3.3882 - val_accuracy300: 0.3434 - 10s/epoch - 24ms/step
Epoch 4/50
428/428 - 10s - loss: 3.2775 - accuracy300: 0.3824 - val_loss: 3.4036 - val_accuracy300: 0.3409 - 10s/epoch - 24ms/step
Epoch 5/50
428/428 - 10s - loss: 3.2701 - accuracy300: 0.3855 - val_loss: 3.4281 - val_accuracy300: 0.3481 - 10s/epoch - 24ms/step
Epoch 6/50
428/428 - 10s - loss: 3.2601 - accuracy300: 0.3919 - val_loss: 3.4451 - val_accuracy300: 0.3478 - 10s/epoch - 23ms/step
Epoch 7/50
428/428 - 10s - loss: 3.2551 - accuracy300: 0.3946 - val_loss: 3.4139 - val_accuracy300: 0.3484 - 10s/epoch - 24ms/step
Epoch 8/50
428/428 - 10s - loss: 3.2536 - accuracy300: 0.3933 - val_loss: 3.4051 - val_accuracy300: 0.3428 - 10s/epoch - 24ms/step
Epoch 9/50
428/428 - 10s - loss: 3.2481 - accuracy300: 0.3987 - val_loss: 3.4393 - val_accuracy300: 0.3446 - 10s/epoch - 24ms/step
Epoch 10/50
428/428 - 10s - loss: 3.2424 - accuracy300: 0.4032 - val_loss: 3.4442 - val_accuracy300: 0.3469 - 10s/epoch - 24ms/step
Epoch 11/50
428/428 - 10s - loss: 3.2378 - accuracy300: 0.4062 - val_loss: 3.4170 - val_accuracy300: 0.3482 - 10s/epoch - 23ms/step
Epoch 12/50
428/428 - 10s - loss: 3.2355 - accuracy300: 0.4058 - val_loss: 3.4572 - val_accuracy300: 0.3460 - 10s/epoch - 23ms/step
testing model: results/PCAR/W10/deepLOB_L1/h300
Evaluating performance on  test set...
2104/2104 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1262314
{'0': {'precision': 0.40738974614977685, 'recall': 0.2592408208162646, 'f1-score': 0.31685331401666056, 'support': 210912}, '1': {'precision': 0.22433007090203605, 'recall': 0.43099543016093783, 'f1-score': 0.29507545563121823, 'support': 125825}, '2': {'precision': 0.370398386283409, 'recall': 0.2984233787854765, 'f1-score': 0.33053810059545047, 'support': 201824}, 'accuracy': 0.3140517044494496, 'macro avg': {'precision': 0.33403940111174063, 'recall': 0.32955320992089293, 'f1-score': 0.3141556234144431, 'support': 538561}, 'weighted avg': {'precision': 0.35075878354439544, 'recall': 0.3140517044494496, 'f1-score': 0.3168936424755156, 'support': 538561}}
[[54677 96438 59797]
 [29015 54230 42580]
 [50521 91074 60229]]
Evaluating performance on  train set...
428/428 - 13s - 13s/epoch - 31ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1136808
{'0': {'precision': 0.34160153134471205, 'recall': 0.350204415372036, 'f1-score': 0.34584948320413433, 'support': 36690}, '1': {'precision': 0.328982354363065, 'recall': 0.5323684725210248, 'f1-score': 0.40666318069769175, 'support': 35791}, '2': {'precision': 0.37308408537458815, 'recall': 0.14073433658444331, 'f1-score': 0.2043746934771947, 'support': 37013}, 'accuracy': 0.33894094653588325, 'macro avg': {'precision': 0.3478893236941218, 'recall': 0.34110240815916804, 'f1-score': 0.3189624524596736, 'support': 109494}, 'weighted avg': {'precision': 0.3481188821489358, 'recall': 0.33894094653588325, 'f1-score': 0.3179043597711489, 'support': 109494}}
[[12849 19133  4708]
 [12692 19054  4045]
 [12073 19731  5209]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1151263
{'0': {'precision': 0.3532787512434004, 'recall': 0.3804070198566367, 'f1-score': 0.3663413472982623, 'support': 12137}, '1': {'precision': 0.31058808840054936, 'recall': 0.4518619436875568, 'f1-score': 0.3681367470771052, 'support': 11010}, '2': {'precision': 0.38514503369469677, 'recall': 0.2059376468745104, 'f1-score': 0.268374846876276, 'support': 12766}, 'accuracy': 0.3402946008409211, 'macro avg': {'precision': 0.3496706244462155, 'recall': 0.346068870139568, 'f1-score': 0.33428431375054785, 'support': 35913}, 'weighted avg': {'precision': 0.3515184071861916, 'recall': 0.3402946008409211, 'f1-score': 0.33206760261466534, 'support': 35913}}
[[4617 5333 2187]
 [4025 4975 2010]
 [4427 5710 2629]]
training model: results/PCAR/W10/deepLOB_L1/h500
Epoch 1/50
428/428 - 12s - loss: 3.3435 - accuracy500: 0.3546 - val_loss: 3.4279 - val_accuracy500: 0.3183 - 12s/epoch - 29ms/step
Epoch 2/50
428/428 - 10s - loss: 3.3144 - accuracy500: 0.3607 - val_loss: 3.4810 - val_accuracy500: 0.3205 - 10s/epoch - 24ms/step
Epoch 3/50
428/428 - 10s - loss: 3.2923 - accuracy500: 0.3633 - val_loss: 3.4330 - val_accuracy500: 0.3323 - 10s/epoch - 24ms/step
Epoch 4/50
428/428 - 10s - loss: 3.2744 - accuracy500: 0.3797 - val_loss: 3.4563 - val_accuracy500: 0.3436 - 10s/epoch - 23ms/step
Epoch 5/50
428/428 - 10s - loss: 3.2637 - accuracy500: 0.3892 - val_loss: 3.4400 - val_accuracy500: 0.3425 - 10s/epoch - 24ms/step
Epoch 6/50
428/428 - 10s - loss: 3.2594 - accuracy500: 0.3906 - val_loss: 3.5093 - val_accuracy500: 0.3480 - 10s/epoch - 23ms/step
Epoch 7/50
428/428 - 10s - loss: 3.2529 - accuracy500: 0.3951 - val_loss: 3.4191 - val_accuracy500: 0.3289 - 10s/epoch - 23ms/step
Epoch 8/50
428/428 - 10s - loss: 3.2506 - accuracy500: 0.3978 - val_loss: 3.4644 - val_accuracy500: 0.3343 - 10s/epoch - 24ms/step
Epoch 9/50
428/428 - 10s - loss: 3.2443 - accuracy500: 0.4021 - val_loss: 3.4766 - val_accuracy500: 0.3395 - 10s/epoch - 23ms/step
Epoch 10/50
428/428 - 10s - loss: 3.2400 - accuracy500: 0.4043 - val_loss: 3.5093 - val_accuracy500: 0.3429 - 10s/epoch - 24ms/step
Epoch 11/50
428/428 - 10s - loss: 3.2340 - accuracy500: 0.4077 - val_loss: 3.4710 - val_accuracy500: 0.3395 - 10s/epoch - 23ms/step
Epoch 12/50
428/428 - 10s - loss: 3.2305 - accuracy500: 0.4094 - val_loss: 3.5253 - val_accuracy500: 0.3351 - 10s/epoch - 23ms/step
Epoch 13/50
428/428 - 10s - loss: 3.2263 - accuracy500: 0.4116 - val_loss: 3.4965 - val_accuracy500: 0.3303 - 10s/epoch - 23ms/step
Epoch 14/50
428/428 - 10s - loss: 3.2207 - accuracy500: 0.4162 - val_loss: 3.5201 - val_accuracy500: 0.3377 - 10s/epoch - 23ms/step
Epoch 15/50
428/428 - 10s - loss: 3.2213 - accuracy500: 0.4165 - val_loss: 3.4872 - val_accuracy500: 0.3363 - 10s/epoch - 23ms/step
Epoch 16/50
428/428 - 10s - loss: 3.2131 - accuracy500: 0.4188 - val_loss: 3.4766 - val_accuracy500: 0.3341 - 10s/epoch - 23ms/step
Epoch 17/50
428/428 - 10s - loss: 3.2081 - accuracy500: 0.4223 - val_loss: 3.5190 - val_accuracy500: 0.3264 - 10s/epoch - 24ms/step
testing model: results/PCAR/W10/deepLOB_L1/h500
Evaluating performance on  test set...
2104/2104 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1729491
{'0': {'precision': 0.3843638158706652, 'recall': 0.33147885654573866, 'f1-score': 0.35596782111992276, 'support': 206707}, '1': {'precision': 0.21705402980798952, 'recall': 0.22015093704839314, 'f1-score': 0.21859151507789487, 'support': 130783}, '2': {'precision': 0.3629231350430054, 'recall': 0.4108896857329003, 'f1-score': 0.3854197524240933, 'support': 201071}, 'accuracy': 0.33409214555082895, 'macro avg': {'precision': 0.3214469935738867, 'recall': 0.32083982644234404, 'f1-score': 0.31999302954063696, 'support': 538561}, 'weighted avg': {'precision': 0.3357298173350614, 'recall': 0.33409214555082895, 'f1-score': 0.3336034907026931, 'support': 538561}}
[[68519 53240 84948]
 [41911 28792 60080]
 [67836 50617 82618]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1278558
{'0': {'precision': 0.3370422449104359, 'recall': 0.45489300841630453, 'f1-score': 0.3871987264277938, 'support': 36358}, '1': {'precision': 0.34238442598430635, 'recall': 0.4130760688506385, 'f1-score': 0.37442278898297626, 'support': 36020}, '2': {'precision': 0.39832606389249087, 'recall': 0.18207781010884794, 'f1-score': 0.24991679301800968, 'support': 37116}, 'accuracy': 0.3486583739748297, 'macro avg': {'precision': 0.35925091159574435, 'recall': 0.3500156291252637, 'f1-score': 0.33717943614292656, 'support': 109494}, 'weighted avg': {'precision': 0.359573484865308, 'recall': 0.3486583739748297, 'f1-score': 0.3364603708357077, 'support': 109494}}
[[16539 14451  5368]
 [16301 14879  4840]
 [16231 14127  6758]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1437726
{'0': {'precision': 0.3280393622321873, 'recall': 0.4298889977146588, 'f1-score': 0.3721209552070086, 'support': 12252}, '1': {'precision': 0.2939829437776374, 'recall': 0.341528300155949, 'f1-score': 0.31597708465945257, 'support': 10901}, '2': {'precision': 0.3935770888363687, 'recall': 0.22186520376175548, 'f1-score': 0.28376685210244074, 'support': 12760}, 'accuracy': 0.3291565728287807, 'macro avg': {'precision': 0.33853313161539783, 'recall': 0.3310941672107877, 'f1-score': 0.32395496398963397, 'support': 35913}, 'weighted avg': {'precision': 0.34098766434830974, 'recall': 0.3291565728287807, 'f1-score': 0.32368660863464777, 'support': 35913}}
[[5267 4735 2250]
 [5066 3723 2112]
 [5723 4206 2831]]
training model: results/PCAR/W10/deepLOB_L1/h1000
Epoch 1/50
428/428 - 13s - loss: 3.3322 - accuracy1000: 0.3662 - val_loss: 3.3675 - val_accuracy1000: 0.3400 - 13s/epoch - 30ms/step
Epoch 2/50
428/428 - 11s - loss: 3.3001 - accuracy1000: 0.3762 - val_loss: 3.3586 - val_accuracy1000: 0.3376 - 11s/epoch - 25ms/step
Epoch 3/50
428/428 - 11s - loss: 3.2782 - accuracy1000: 0.3794 - val_loss: 3.4197 - val_accuracy1000: 0.3437 - 11s/epoch - 25ms/step
Epoch 4/50
428/428 - 10s - loss: 3.2557 - accuracy1000: 0.3884 - val_loss: 3.4136 - val_accuracy1000: 0.3452 - 10s/epoch - 24ms/step
Epoch 5/50
428/428 - 10s - loss: 3.2405 - accuracy1000: 0.3996 - val_loss: 3.4156 - val_accuracy1000: 0.3361 - 10s/epoch - 24ms/step
Epoch 6/50
428/428 - 10s - loss: 3.2315 - accuracy1000: 0.4031 - val_loss: 3.4302 - val_accuracy1000: 0.3236 - 10s/epoch - 24ms/step
Epoch 7/50
428/428 - 10s - loss: 3.2243 - accuracy1000: 0.4067 - val_loss: 3.4407 - val_accuracy1000: 0.3236 - 10s/epoch - 24ms/step
Epoch 8/50
428/428 - 10s - loss: 3.2181 - accuracy1000: 0.4103 - val_loss: 3.4387 - val_accuracy1000: 0.3362 - 10s/epoch - 24ms/step
Epoch 9/50
428/428 - 10s - loss: 3.2132 - accuracy1000: 0.4139 - val_loss: 3.4409 - val_accuracy1000: 0.3392 - 10s/epoch - 24ms/step
Epoch 10/50
428/428 - 10s - loss: 3.2084 - accuracy1000: 0.4171 - val_loss: 3.4317 - val_accuracy1000: 0.3225 - 10s/epoch - 24ms/step
Epoch 11/50
428/428 - 11s - loss: 3.1939 - accuracy1000: 0.4263 - val_loss: 3.4487 - val_accuracy1000: 0.3265 - 11s/epoch - 25ms/step
Epoch 12/50
428/428 - 10s - loss: 3.1914 - accuracy1000: 0.4266 - val_loss: 3.4345 - val_accuracy1000: 0.3386 - 10s/epoch - 24ms/step
testing model: results/PCAR/W10/deepLOB_L1/h1000
Evaluating performance on  test set...
2104/2104 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1249812
{'0': {'precision': 0.38973760240630073, 'recall': 0.28419229936749957, 'f1-score': 0.328700136575922, 'support': 207905}, '1': {'precision': 0.22587314180483087, 'recall': 0.30428134556574926, 'f1-score': 0.2592790786565403, 'support': 128184}, '2': {'precision': 0.3688759462007299, 'recall': 0.3903848433363626, 'f1-score': 0.37932573485302945, 'support': 202472}, 'accuracy': 0.3288968194874861, 'macro avg': {'precision': 0.3281622301372871, 'recall': 0.32628616275653716, 'f1-score': 0.3224349833618306, 'support': 538561}, 'weighted avg': {'precision': 0.34289294920454055, 'recall': 0.3288968194874861, 'f1-score': 0.33120978217971525, 'support': 538561}}
[[59085 68161 80659]
 [34603 39004 54577]
 [57914 65516 79042]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1085504
{'0': {'precision': 0.3439498647894579, 'recall': 0.4409045889732585, 'f1-score': 0.3864387162113284, 'support': 36348}, '1': {'precision': 0.3490665495277839, 'recall': 0.43321703102000764, 'f1-score': 0.38661574389413256, 'support': 36686}, '2': {'precision': 0.40166954519286124, 'recall': 0.19136039495337356, 'f1-score': 0.25922348133011336, 'support': 36460}, 'accuracy': 0.3552340767530641, 'macro avg': {'precision': 0.36489531983670104, 'recall': 0.35516067164887993, 'f1-score': 0.34409264714519144, 'support': 109494}, 'weighted avg': {'precision': 0.3648840734567667, 'recall': 0.3552340767530641, 'f1-score': 0.3441371012717176, 'support': 109494}}
[[16026 15111  5211]
 [15611 15893  5182]
 [14957 14526  6977]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1195208
{'0': {'precision': 0.33326765188834157, 'recall': 0.4163794518299688, 'f1-score': 0.3702163365072417, 'support': 12186}, '1': {'precision': 0.31003505696757233, 'recall': 0.39135244768138655, 'f1-score': 0.34597986878030895, 'support': 10847}, '2': {'precision': 0.4176672384219554, 'recall': 0.22686335403726707, 'f1-score': 0.29402294224189973, 'support': 12880}, 'accuracy': 0.34085150224152816, 'macro avg': {'precision': 0.3536566490926231, 'recall': 0.3448650845162075, 'f1-score': 0.33673971584315004, 'support': 35913}, 'weighted avg': {'precision': 0.3565200317353987, 'recall': 0.34085150224152816, 'f1-score': 0.33556972153295256, 'support': 35913}}
[[5074 4982 2130]
 [4658 4245 1944]
 [5493 4465 2922]]
training model: results/PCAR/W10/deepOF_L1/h10
Epoch 1/50
428/428 - 12s - loss: 3.3080 - accuracy10: 0.3697 - val_loss: 3.2982 - val_accuracy10: 0.3666 - 12s/epoch - 28ms/step
Epoch 2/50
428/428 - 10s - loss: 3.2755 - accuracy10: 0.3850 - val_loss: 3.2822 - val_accuracy10: 0.3759 - 10s/epoch - 23ms/step
Epoch 3/50
428/428 - 10s - loss: 3.2610 - accuracy10: 0.3925 - val_loss: 3.2759 - val_accuracy10: 0.3812 - 10s/epoch - 22ms/step
Epoch 4/50
428/428 - 10s - loss: 3.2547 - accuracy10: 0.3957 - val_loss: 3.2689 - val_accuracy10: 0.3814 - 10s/epoch - 23ms/step
Epoch 5/50
428/428 - 10s - loss: 3.2491 - accuracy10: 0.3994 - val_loss: 3.2679 - val_accuracy10: 0.3851 - 10s/epoch - 23ms/step
Epoch 6/50
428/428 - 9s - loss: 3.2444 - accuracy10: 0.4021 - val_loss: 3.2673 - val_accuracy10: 0.3840 - 9s/epoch - 22ms/step
Epoch 7/50
428/428 - 10s - loss: 3.2401 - accuracy10: 0.4053 - val_loss: 3.2629 - val_accuracy10: 0.3856 - 10s/epoch - 22ms/step
Epoch 8/50
428/428 - 9s - loss: 3.2377 - accuracy10: 0.4060 - val_loss: 3.2617 - val_accuracy10: 0.3880 - 9s/epoch - 22ms/step
Epoch 9/50
428/428 - 9s - loss: 3.2343 - accuracy10: 0.4095 - val_loss: 3.2615 - val_accuracy10: 0.3891 - 9s/epoch - 22ms/step
Epoch 10/50
428/428 - 9s - loss: 3.2325 - accuracy10: 0.4089 - val_loss: 3.2613 - val_accuracy10: 0.3879 - 9s/epoch - 22ms/step
Epoch 11/50
428/428 - 9s - loss: 3.2297 - accuracy10: 0.4080 - val_loss: 3.2600 - val_accuracy10: 0.3919 - 9s/epoch - 22ms/step
Epoch 12/50
428/428 - 9s - loss: 3.2263 - accuracy10: 0.4098 - val_loss: 3.2608 - val_accuracy10: 0.3909 - 9s/epoch - 22ms/step
Epoch 13/50
428/428 - 10s - loss: 3.2249 - accuracy10: 0.4116 - val_loss: 3.2604 - val_accuracy10: 0.3879 - 10s/epoch - 22ms/step
Epoch 14/50
428/428 - 9s - loss: 3.2216 - accuracy10: 0.4123 - val_loss: 3.2615 - val_accuracy10: 0.3891 - 9s/epoch - 22ms/step
Epoch 15/50
428/428 - 9s - loss: 3.2181 - accuracy10: 0.4135 - val_loss: 3.2615 - val_accuracy10: 0.3892 - 9s/epoch - 22ms/step
Epoch 16/50
428/428 - 9s - loss: 3.2146 - accuracy10: 0.4156 - val_loss: 3.2623 - val_accuracy10: 0.3900 - 9s/epoch - 21ms/step
Epoch 17/50
428/428 - 9s - loss: 3.2147 - accuracy10: 0.4157 - val_loss: 3.2639 - val_accuracy10: 0.3874 - 9s/epoch - 22ms/step
Epoch 18/50
428/428 - 9s - loss: 3.2128 - accuracy10: 0.4171 - val_loss: 3.2593 - val_accuracy10: 0.3908 - 9s/epoch - 22ms/step
Epoch 19/50
428/428 - 9s - loss: 3.2095 - accuracy10: 0.4179 - val_loss: 3.2642 - val_accuracy10: 0.3880 - 9s/epoch - 22ms/step
Epoch 20/50
428/428 - 10s - loss: 3.2086 - accuracy10: 0.4174 - val_loss: 3.2615 - val_accuracy10: 0.3895 - 10s/epoch - 22ms/step
Epoch 21/50
428/428 - 9s - loss: 3.2033 - accuracy10: 0.4212 - val_loss: 3.2638 - val_accuracy10: 0.3868 - 9s/epoch - 22ms/step
Epoch 22/50
428/428 - 10s - loss: 3.2020 - accuracy10: 0.4209 - val_loss: 3.2639 - val_accuracy10: 0.3874 - 10s/epoch - 22ms/step
Epoch 23/50
428/428 - 10s - loss: 3.1998 - accuracy10: 0.4219 - val_loss: 3.2681 - val_accuracy10: 0.3867 - 10s/epoch - 23ms/step
Epoch 24/50
428/428 - 10s - loss: 3.1982 - accuracy10: 0.4234 - val_loss: 3.2685 - val_accuracy10: 0.3864 - 10s/epoch - 22ms/step
Epoch 25/50
428/428 - 10s - loss: 3.1966 - accuracy10: 0.4233 - val_loss: 3.2674 - val_accuracy10: 0.3885 - 10s/epoch - 22ms/step
Epoch 26/50
428/428 - 9s - loss: 3.1925 - accuracy10: 0.4263 - val_loss: 3.2722 - val_accuracy10: 0.3862 - 9s/epoch - 22ms/step
Epoch 27/50
428/428 - 9s - loss: 3.1927 - accuracy10: 0.4253 - val_loss: 3.2683 - val_accuracy10: 0.3861 - 9s/epoch - 21ms/step
Epoch 28/50
428/428 - 9s - loss: 3.1889 - accuracy10: 0.4269 - val_loss: 3.2710 - val_accuracy10: 0.3882 - 9s/epoch - 22ms/step
testing model: results/PCAR/W10/deepOF_L1/h10
Evaluating performance on  test set...
2104/2104 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0944731
{'0': {'precision': 0.4772194676731049, 'recall': 0.35195182629814753, 'f1-score': 0.40512319809856373, 'support': 219871}, '1': {'precision': 0.22049396779371408, 'recall': 0.42010555911803876, 'f1-score': 0.28920015619959594, 'support': 101365}, '2': {'precision': 0.4680307742674742, 'recall': 0.3946990612921038, 'f1-score': 0.428248333707781, 'support': 217320}, 'accuracy': 0.3820289812015835, 'macro avg': {'precision': 0.38858140324476437, 'recall': 0.38891881556943003, 'f1-score': 0.37419056266864686, 'support': 538556}, 'weighted avg': {'precision': 0.4251916987016588, 'recall': 0.3820289812015835, 'f1-score': 0.39263613143976916, 'support': 538556}}
[[77384 75355 67132]
 [28419 42584 30362]
 [56353 75191 85776]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0704643
{'0': {'precision': 0.43908219695668604, 'recall': 0.3536295230718159, 'f1-score': 0.39175004980003375, 'support': 36148}, '1': {'precision': 0.39246663532874165, 'recall': 0.5301913360390955, 'f1-score': 0.4510499365810119, 'support': 36219}, '2': {'precision': 0.4359161870846714, 'recall': 0.3692829822765717, 'f1-score': 0.3998425127958354, 'support': 37126}, 'accuracy': 0.41734174787429335, 'macro avg': {'precision': 0.422488339790033, 'recall': 0.4177012804624944, 'f1-score': 0.41421416639229364, 'support': 109493}, 'weighted avg': {'precision': 0.42258881099492657, 'recall': 0.41734174787429335, 'f1-score': 0.4141096835711641, 'support': 109493}}
[[12783 14469  8896]
 [ 8171 19203  8845]
 [ 8159 15257 13710]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0876764
{'0': {'precision': 0.41384581786416247, 'recall': 0.3134562898023323, 'f1-score': 0.35672266930208485, 'support': 12091}, '1': {'precision': 0.3636148288523037, 'recall': 0.5410645047585477, 'f1-score': 0.4349366012608911, 'support': 11348}, '2': {'precision': 0.4172661870503597, 'recall': 0.3301266634599968, 'f1-score': 0.3686165689477689, 'support': 12474}, 'accuracy': 0.39116754378637264, 'macro avg': {'precision': 0.39824227792227535, 'recall': 0.3948824860069589, 'f1-score': 0.3867586131702483, 'support': 35913}, 'weighted avg': {'precision': 0.3991615648616857, 'recall': 0.39116754378637264, 'f1-score': 0.3855683854507997, 'support': 35913}}
[[3790 5274 3027]
 [2484 6140 2724]
 [2884 5472 4118]]
training model: results/PCAR/W10/deepOF_L1/h20
Epoch 1/50
428/428 - 12s - loss: 3.3150 - accuracy20: 0.3606 - val_loss: 3.3137 - val_accuracy20: 0.3521 - 12s/epoch - 28ms/step
Epoch 2/50
428/428 - 10s - loss: 3.2854 - accuracy20: 0.3731 - val_loss: 3.3021 - val_accuracy20: 0.3522 - 10s/epoch - 22ms/step
Epoch 3/50
428/428 - 10s - loss: 3.2762 - accuracy20: 0.3796 - val_loss: 3.2922 - val_accuracy20: 0.3619 - 10s/epoch - 22ms/step
Epoch 4/50
428/428 - 10s - loss: 3.2688 - accuracy20: 0.3828 - val_loss: 3.2862 - val_accuracy20: 0.3615 - 10s/epoch - 22ms/step
Epoch 5/50
428/428 - 10s - loss: 3.2625 - accuracy20: 0.3846 - val_loss: 3.2839 - val_accuracy20: 0.3657 - 10s/epoch - 22ms/step
Epoch 6/50
428/428 - 9s - loss: 3.2591 - accuracy20: 0.3875 - val_loss: 3.2817 - val_accuracy20: 0.3677 - 9s/epoch - 22ms/step
Epoch 7/50
428/428 - 9s - loss: 3.2551 - accuracy20: 0.3913 - val_loss: 3.2793 - val_accuracy20: 0.3676 - 9s/epoch - 22ms/step
Epoch 8/50
428/428 - 10s - loss: 3.2533 - accuracy20: 0.3907 - val_loss: 3.2794 - val_accuracy20: 0.3688 - 10s/epoch - 22ms/step
Epoch 9/50
428/428 - 10s - loss: 3.2509 - accuracy20: 0.3939 - val_loss: 3.2762 - val_accuracy20: 0.3719 - 10s/epoch - 23ms/step
Epoch 10/50
428/428 - 9s - loss: 3.2475 - accuracy20: 0.3950 - val_loss: 3.2786 - val_accuracy20: 0.3685 - 9s/epoch - 22ms/step
Epoch 11/50
428/428 - 10s - loss: 3.2474 - accuracy20: 0.3962 - val_loss: 3.2779 - val_accuracy20: 0.3714 - 10s/epoch - 22ms/step
Epoch 12/50
428/428 - 9s - loss: 3.2445 - accuracy20: 0.3969 - val_loss: 3.2766 - val_accuracy20: 0.3728 - 9s/epoch - 22ms/step
Epoch 13/50
428/428 - 9s - loss: 3.2424 - accuracy20: 0.3968 - val_loss: 3.2769 - val_accuracy20: 0.3727 - 9s/epoch - 22ms/step
Epoch 14/50
428/428 - 9s - loss: 3.2406 - accuracy20: 0.4002 - val_loss: 3.2758 - val_accuracy20: 0.3744 - 9s/epoch - 22ms/step
Epoch 15/50
428/428 - 10s - loss: 3.2380 - accuracy20: 0.4011 - val_loss: 3.2763 - val_accuracy20: 0.3713 - 10s/epoch - 23ms/step
Epoch 16/50
428/428 - 9s - loss: 3.2363 - accuracy20: 0.3999 - val_loss: 3.2760 - val_accuracy20: 0.3712 - 9s/epoch - 22ms/step
Epoch 17/50
428/428 - 9s - loss: 3.2361 - accuracy20: 0.4029 - val_loss: 3.2786 - val_accuracy20: 0.3716 - 9s/epoch - 22ms/step
Epoch 18/50
428/428 - 9s - loss: 3.2329 - accuracy20: 0.4041 - val_loss: 3.2751 - val_accuracy20: 0.3732 - 9s/epoch - 22ms/step
Epoch 19/50
428/428 - 9s - loss: 3.2324 - accuracy20: 0.4052 - val_loss: 3.2780 - val_accuracy20: 0.3740 - 9s/epoch - 22ms/step
Epoch 20/50
428/428 - 10s - loss: 3.2291 - accuracy20: 0.4061 - val_loss: 3.2776 - val_accuracy20: 0.3706 - 10s/epoch - 22ms/step
Epoch 21/50
428/428 - 9s - loss: 3.2265 - accuracy20: 0.4071 - val_loss: 3.2791 - val_accuracy20: 0.3730 - 9s/epoch - 22ms/step
Epoch 22/50
428/428 - 9s - loss: 3.2271 - accuracy20: 0.4070 - val_loss: 3.2802 - val_accuracy20: 0.3747 - 9s/epoch - 22ms/step
Epoch 23/50
428/428 - 9s - loss: 3.2239 - accuracy20: 0.4080 - val_loss: 3.2779 - val_accuracy20: 0.3752 - 9s/epoch - 22ms/step
Epoch 24/50
428/428 - 9s - loss: 3.2214 - accuracy20: 0.4101 - val_loss: 3.2801 - val_accuracy20: 0.3724 - 9s/epoch - 22ms/step
Epoch 25/50
428/428 - 10s - loss: 3.2200 - accuracy20: 0.4101 - val_loss: 3.2812 - val_accuracy20: 0.3738 - 10s/epoch - 23ms/step
Epoch 26/50
428/428 - 10s - loss: 3.2179 - accuracy20: 0.4132 - val_loss: 3.2835 - val_accuracy20: 0.3728 - 10s/epoch - 22ms/step
Epoch 27/50
428/428 - 9s - loss: 3.2154 - accuracy20: 0.4133 - val_loss: 3.2838 - val_accuracy20: 0.3735 - 9s/epoch - 22ms/step
Epoch 28/50
428/428 - 9s - loss: 3.2139 - accuracy20: 0.4135 - val_loss: 3.2847 - val_accuracy20: 0.3729 - 9s/epoch - 22ms/step
testing model: results/PCAR/W10/deepOF_L1/h20
Evaluating performance on  test set...
2104/2104 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1025879
{'0': {'precision': 0.4655543492752795, 'recall': 0.34529538626710493, 'f1-score': 0.3965069280162217, 'support': 212366}, '1': {'precision': 0.22025279298257733, 'recall': 0.4361637558878089, 'f1-score': 0.2926991575620068, 'support': 116979}, '2': {'precision': 0.4565480772448877, 'recall': 0.3260153624809403, 'f1-score': 0.38039519695710616, 'support': 209211}, 'accuracy': 0.3575431338616597, 'macro avg': {'precision': 0.38078507316758153, 'recall': 0.3691581682119514, 'f1-score': 0.35653376084511157, 'support': 538556}, 'weighted avg': {'precision': 0.40877410370877515, 'recall': 0.3575431338616597, 'f1-score': 0.3677001176816006, 'support': 538556}}
[[73329 90029 49008]
 [33776 51022 32181]
 [50404 90601 68206]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0800953
{'0': {'precision': 0.42945284426062785, 'recall': 0.34802197802197804, 'f1-score': 0.3844729733831072, 'support': 36400}, '1': {'precision': 0.3598768886401791, 'recall': 0.5348024948024948, 'f1-score': 0.4302391704298378, 'support': 36075}, '2': {'precision': 0.4325563767292022, 'recall': 0.308309471068129, 'f1-score': 0.3600145103543996, 'support': 37018}, 'accuracy': 0.3961349127341474, 'macro avg': {'precision': 0.4072953698766697, 'recall': 0.3970446479642005, 'f1-score': 0.3915755513891148, 'support': 109493}, 'weighted avg': {'precision': 0.4075786967435628, 'recall': 0.3961349127341474, 'f1-score': 0.39128265230380627, 'support': 109493}}
[[12668 16774  6958]
 [ 8768 19293  8014]
 [ 8062 17543 11413]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0936447
{'0': {'precision': 0.3979581206375664, 'recall': 0.32114333753678015, 'f1-score': 0.3554480320089327, 'support': 11895}, '1': {'precision': 0.3421658986175115, 'recall': 0.5347222222222222, 'f1-score': 0.4173022882376556, 'support': 11664}, '2': {'precision': 0.4125649270343804, 'recall': 0.27003399708596404, 'f1-score': 0.32641878669275926, 'support': 12354}, 'accuracy': 0.37292902291649266, 'macro avg': {'precision': 0.38422964876315274, 'recall': 0.37529985228165547, 'f1-score': 0.3663897023131158, 'support': 35913}, 'weighted avg': {'precision': 0.38486236168076304, 'recall': 0.37292902291649266, 'f1-score': 0.3655513580472981, 'support': 35913}}
[[3820 5854 2221]
 [2898 6237 2529]
 [2881 6137 3336]]
training model: results/PCAR/W10/deepOF_L1/h30
Epoch 1/50
428/428 - 11s - loss: 3.3152 - accuracy30: 0.3611 - val_loss: 3.3137 - val_accuracy30: 0.3489 - 11s/epoch - 26ms/step
Epoch 2/50
428/428 - 9s - loss: 3.2845 - accuracy30: 0.3735 - val_loss: 3.3014 - val_accuracy30: 0.3511 - 9s/epoch - 22ms/step
Epoch 3/50
428/428 - 9s - loss: 3.2742 - accuracy30: 0.3797 - val_loss: 3.2946 - val_accuracy30: 0.3557 - 9s/epoch - 22ms/step
Epoch 4/50
428/428 - 10s - loss: 3.2692 - accuracy30: 0.3797 - val_loss: 3.2886 - val_accuracy30: 0.3584 - 10s/epoch - 22ms/step
Epoch 5/50
428/428 - 9s - loss: 3.2626 - accuracy30: 0.3841 - val_loss: 3.2903 - val_accuracy30: 0.3536 - 9s/epoch - 22ms/step
Epoch 6/50
428/428 - 10s - loss: 3.2593 - accuracy30: 0.3858 - val_loss: 3.2880 - val_accuracy30: 0.3566 - 10s/epoch - 23ms/step
Epoch 7/50
428/428 - 10s - loss: 3.2562 - accuracy30: 0.3870 - val_loss: 3.2848 - val_accuracy30: 0.3594 - 10s/epoch - 22ms/step
Epoch 8/50
428/428 - 10s - loss: 3.2554 - accuracy30: 0.3878 - val_loss: 3.2824 - val_accuracy30: 0.3634 - 10s/epoch - 22ms/step
Epoch 9/50
428/428 - 10s - loss: 3.2519 - accuracy30: 0.3902 - val_loss: 3.2816 - val_accuracy30: 0.3611 - 10s/epoch - 22ms/step
Epoch 10/50
428/428 - 9s - loss: 3.2496 - accuracy30: 0.3923 - val_loss: 3.2816 - val_accuracy30: 0.3658 - 9s/epoch - 22ms/step
Epoch 11/50
428/428 - 9s - loss: 3.2486 - accuracy30: 0.3913 - val_loss: 3.2830 - val_accuracy30: 0.3600 - 9s/epoch - 22ms/step
Epoch 12/50
428/428 - 9s - loss: 3.2458 - accuracy30: 0.3936 - val_loss: 3.2806 - val_accuracy30: 0.3686 - 9s/epoch - 22ms/step
Epoch 13/50
428/428 - 9s - loss: 3.2445 - accuracy30: 0.3951 - val_loss: 3.2814 - val_accuracy30: 0.3652 - 9s/epoch - 22ms/step
Epoch 14/50
428/428 - 10s - loss: 3.2430 - accuracy30: 0.3963 - val_loss: 3.2808 - val_accuracy30: 0.3664 - 10s/epoch - 22ms/step
Epoch 15/50
428/428 - 9s - loss: 3.2414 - accuracy30: 0.3959 - val_loss: 3.2805 - val_accuracy30: 0.3679 - 9s/epoch - 22ms/step
Epoch 16/50
428/428 - 9s - loss: 3.2398 - accuracy30: 0.3981 - val_loss: 3.2797 - val_accuracy30: 0.3674 - 9s/epoch - 22ms/step
Epoch 17/50
428/428 - 9s - loss: 3.2372 - accuracy30: 0.3997 - val_loss: 3.2837 - val_accuracy30: 0.3632 - 9s/epoch - 22ms/step
Epoch 18/50
428/428 - 9s - loss: 3.2366 - accuracy30: 0.3993 - val_loss: 3.2822 - val_accuracy30: 0.3650 - 9s/epoch - 22ms/step
Epoch 19/50
428/428 - 10s - loss: 3.2341 - accuracy30: 0.4011 - val_loss: 3.2840 - val_accuracy30: 0.3665 - 10s/epoch - 22ms/step
Epoch 20/50
428/428 - 9s - loss: 3.2324 - accuracy30: 0.4006 - val_loss: 3.2849 - val_accuracy30: 0.3649 - 9s/epoch - 22ms/step
Epoch 21/50
428/428 - 10s - loss: 3.2306 - accuracy30: 0.4030 - val_loss: 3.2858 - val_accuracy30: 0.3635 - 10s/epoch - 23ms/step
Epoch 22/50
428/428 - 9s - loss: 3.2294 - accuracy30: 0.4042 - val_loss: 3.2849 - val_accuracy30: 0.3664 - 9s/epoch - 21ms/step
Epoch 23/50
428/428 - 10s - loss: 3.2277 - accuracy30: 0.4041 - val_loss: 3.2842 - val_accuracy30: 0.3649 - 10s/epoch - 23ms/step
Epoch 24/50
428/428 - 10s - loss: 3.2270 - accuracy30: 0.4047 - val_loss: 3.2864 - val_accuracy30: 0.3651 - 10s/epoch - 22ms/step
Epoch 25/50
428/428 - 10s - loss: 3.2247 - accuracy30: 0.4055 - val_loss: 3.2882 - val_accuracy30: 0.3632 - 10s/epoch - 23ms/step
Epoch 26/50
428/428 - 9s - loss: 3.2239 - accuracy30: 0.4071 - val_loss: 3.2903 - val_accuracy30: 0.3622 - 9s/epoch - 22ms/step
testing model: results/PCAR/W10/deepOF_L1/h30
Evaluating performance on  test set...
2104/2104 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1034182
{'0': {'precision': 0.4694629219873898, 'recall': 0.3196105098128105, 'f1-score': 0.38030752978790955, 'support': 211764}, '1': {'precision': 0.21623080857697272, 'recall': 0.4538947260781757, 'f1-score': 0.2929183221744091, 'support': 117351}, '2': {'precision': 0.4573767502178274, 'recall': 0.3233177840059969, 'f1-score': 0.3788371273364029, 'support': 209441}, 'accuracy': 0.35031268800273324, 'macro avg': {'precision': 0.3810234935940633, 'recall': 0.36560767329899435, 'f1-score': 0.3506876597662405, 'support': 538556}, 'weighted avg': {'precision': 0.40958357491407754, 'recall': 0.35031268800273324, 'f1-score': 0.3606936484784489, 'support': 538556}}
[[67682 96235 47847]
 [31596 53265 32490]
 [44891 96834 67716]]
Evaluating performance on  train set...
428/428 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0821077
{'0': {'precision': 0.4227976338068081, 'recall': 0.33003373334070674, 'f1-score': 0.3707004984704257, 'support': 36166}, '1': {'precision': 0.3510355621883304, 'recall': 0.5315109261759762, 'f1-score': 0.4228201896202115, 'support': 36289}, '2': {'precision': 0.42753457972336223, 'recall': 0.3037691020033479, 'f1-score': 0.35517883637970765, 'support': 37038}, 'accuracy': 0.3879243421953915, 'macro avg': {'precision': 0.4004559252395003, 'recall': 0.38843792050667697, 'f1-score': 0.38289984149011497, 'support': 109493}, 'weighted avg': {'precision': 0.40061606225332425, 'recall': 0.3879243421953915, 'f1-score': 0.3827239168772514, 'support': 109493}}
[[11936 17363  6867]
 [ 8803 19288  8198]
 [ 7492 18295 11251]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0938112
{'0': {'precision': 0.40439148184927726, 'recall': 0.30679725431106647, 'f1-score': 0.34889809129420724, 'support': 11946}, '1': {'precision': 0.3334404283801874, 'recall': 0.5396013864818024, 'f1-score': 0.4121793811021016, 'support': 11540}, '2': {'precision': 0.40966360856269113, 'recall': 0.2694938440492476, 'f1-score': 0.32511406659547615, 'support': 12427}, 'accuracy': 0.36869657227187924, 'macro avg': {'precision': 0.38249850626405185, 'recall': 0.37196416161403884, 'f1-score': 0.36206384633059496, 'support': 35913}, 'weighted avg': {'precision': 0.38341694788203134, 'recall': 0.36869657227187924, 'f1-score': 0.3610023991897317, 'support': 35913}}
[[3665 6043 2238]
 [2725 6227 2588]
 [2673 6405 3349]]
training model: results/PCAR/W10/deepOF_L1/h50
Epoch 1/50
428/428 - 12s - loss: 3.3198 - accuracy50: 0.3602 - val_loss: 3.2982 - val_accuracy50: 0.3596 - 12s/epoch - 28ms/step
Epoch 2/50
428/428 - 10s - loss: 3.2908 - accuracy50: 0.3682 - val_loss: 3.2916 - val_accuracy50: 0.3580 - 10s/epoch - 22ms/step
Epoch 3/50
428/428 - 10s - loss: 3.2791 - accuracy50: 0.3753 - val_loss: 3.2866 - val_accuracy50: 0.3628 - 10s/epoch - 22ms/step
Epoch 4/50
428/428 - 9s - loss: 3.2745 - accuracy50: 0.3771 - val_loss: 3.2828 - val_accuracy50: 0.3666 - 9s/epoch - 22ms/step
Epoch 5/50
428/428 - 10s - loss: 3.2702 - accuracy50: 0.3819 - val_loss: 3.2846 - val_accuracy50: 0.3622 - 10s/epoch - 22ms/step
Epoch 6/50
428/428 - 9s - loss: 3.2687 - accuracy50: 0.3836 - val_loss: 3.2842 - val_accuracy50: 0.3645 - 9s/epoch - 22ms/step
Epoch 7/50
428/428 - 10s - loss: 3.2651 - accuracy50: 0.3847 - val_loss: 3.2825 - val_accuracy50: 0.3649 - 10s/epoch - 23ms/step
Epoch 8/50
428/428 - 10s - loss: 3.2620 - accuracy50: 0.3854 - val_loss: 3.2829 - val_accuracy50: 0.3601 - 10s/epoch - 23ms/step
Epoch 9/50
428/428 - 10s - loss: 3.2598 - accuracy50: 0.3875 - val_loss: 3.2821 - val_accuracy50: 0.3625 - 10s/epoch - 23ms/step
Epoch 10/50
428/428 - 9s - loss: 3.2581 - accuracy50: 0.3877 - val_loss: 3.2833 - val_accuracy50: 0.3615 - 9s/epoch - 21ms/step
Epoch 11/50
428/428 - 9s - loss: 3.2564 - accuracy50: 0.3891 - val_loss: 3.2823 - val_accuracy50: 0.3655 - 9s/epoch - 22ms/step
Epoch 12/50
428/428 - 9s - loss: 3.2554 - accuracy50: 0.3894 - val_loss: 3.2814 - val_accuracy50: 0.3615 - 9s/epoch - 21ms/step
Epoch 13/50
428/428 - 9s - loss: 3.2544 - accuracy50: 0.3904 - val_loss: 3.2812 - val_accuracy50: 0.3637 - 9s/epoch - 21ms/step
Epoch 14/50
428/428 - 9s - loss: 3.2523 - accuracy50: 0.3915 - val_loss: 3.2824 - val_accuracy50: 0.3628 - 9s/epoch - 21ms/step
Epoch 15/50
428/428 - 9s - loss: 3.2500 - accuracy50: 0.3934 - val_loss: 3.2817 - val_accuracy50: 0.3652 - 9s/epoch - 21ms/step
Epoch 16/50
428/428 - 9s - loss: 3.2485 - accuracy50: 0.3937 - val_loss: 3.2846 - val_accuracy50: 0.3610 - 9s/epoch - 21ms/step
Epoch 17/50
428/428 - 9s - loss: 3.2472 - accuracy50: 0.3953 - val_loss: 3.2830 - val_accuracy50: 0.3651 - 9s/epoch - 21ms/step
Epoch 18/50
428/428 - 9s - loss: 3.2454 - accuracy50: 0.3953 - val_loss: 3.2838 - val_accuracy50: 0.3641 - 9s/epoch - 22ms/step
Epoch 19/50
428/428 - 9s - loss: 3.2426 - accuracy50: 0.3994 - val_loss: 3.2832 - val_accuracy50: 0.3639 - 9s/epoch - 22ms/step
Epoch 20/50
428/428 - 9s - loss: 3.2407 - accuracy50: 0.3984 - val_loss: 3.2850 - val_accuracy50: 0.3637 - 9s/epoch - 21ms/step
Epoch 21/50
428/428 - 9s - loss: 3.2396 - accuracy50: 0.3989 - val_loss: 3.2852 - val_accuracy50: 0.3642 - 9s/epoch - 21ms/step
Epoch 22/50
428/428 - 9s - loss: 3.2376 - accuracy50: 0.4018 - val_loss: 3.2858 - val_accuracy50: 0.3622 - 9s/epoch - 21ms/step
Epoch 23/50
428/428 - 9s - loss: 3.2343 - accuracy50: 0.4033 - val_loss: 3.2886 - val_accuracy50: 0.3603 - 9s/epoch - 21ms/step
testing model: results/PCAR/W10/deepOF_L1/h50
Evaluating performance on  test set...
2104/2104 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1096087
{'0': {'precision': 0.47824452513877114, 'recall': 0.2704072864753394, 'f1-score': 0.34547650138091224, 'support': 221122}, '1': {'precision': 0.1817897672629352, 'recall': 0.4676328701603925, 'f1-score': 0.2618044574739442, 'support': 97012}, '2': {'precision': 0.46967885935918235, 'recall': 0.34940704648356335, 'f1-score': 0.40071279916753383, 'support': 220422}, 'accuracy': 0.33826751535587757, 'macro avg': {'precision': 0.3765710505869629, 'recall': 0.3624824010397651, 'f1-score': 0.33599791934079676, 'support': 538556}, 'weighted avg': {'precision': 0.42133729515058216, 'recall': 0.33826751535587757, 'f1-score': 0.35301165632713866, 'support': 538556}}
[[ 59793 103626  57703]
 [ 22388  45366  29258]
 [ 42845 100560  77017]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0860366
{'0': {'precision': 0.41785685138333467, 'recall': 0.280378949674169, 'f1-score': 0.3355836665137314, 'support': 36522}, '1': {'precision': 0.3478870640339546, 'recall': 0.5194533230464015, 'f1-score': 0.41670166441944256, 'support': 36292}, '2': {'precision': 0.41640419521381955, 'recall': 0.34962785244963057, 'f1-score': 0.3801055189993479, 'support': 36679}, 'accuracy': 0.382818992994986, 'macro avg': {'precision': 0.3940493702103696, 'recall': 0.3831533750567337, 'f1-score': 0.377463616644174, 'support': 109493}, 'weighted avg': {'precision': 0.3941783925035401, 'recall': 0.382818992994986, 'f1-score': 0.377384981733097, 'support': 109493}}
[[10240 17970  8312]
 [ 7779 18852  9661]
 [ 6487 17368 12824]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0943667
{'0': {'precision': 0.4028531751041535, 'recall': 0.26415562913907287, 'f1-score': 0.31908404579771016, 'support': 12080}, '1': {'precision': 0.31954492737615287, 'recall': 0.5119900893726219, 'f1-score': 0.3934983677910773, 'support': 11301}, '2': {'precision': 0.4143651997976732, 'recall': 0.3268432812001277, 'f1-score': 0.36543694517553643, 'support': 12532}, 'accuracy': 0.36401860050678025, 'macro avg': {'precision': 0.3789211007593265, 'recall': 0.36766299990394086, 'f1-score': 0.35933978625477464, 'support': 35913}, 'weighted avg': {'precision': 0.38065514614207996, 'recall': 0.36401860050678025, 'f1-score': 0.3586755805581022, 'support': 35913}}
[[3191 6199 2690]
 [2416 5786 3099]
 [2314 6122 4096]]
training model: results/PCAR/W10/deepOF_L1/h100
Epoch 1/50
428/428 - 11s - loss: 3.3220 - accuracy100: 0.3555 - val_loss: 3.3277 - val_accuracy100: 0.3365 - 11s/epoch - 26ms/step
Epoch 2/50
428/428 - 9s - loss: 3.2968 - accuracy100: 0.3623 - val_loss: 3.3139 - val_accuracy100: 0.3399 - 9s/epoch - 22ms/step
Epoch 3/50
428/428 - 10s - loss: 3.2865 - accuracy100: 0.3678 - val_loss: 3.3103 - val_accuracy100: 0.3402 - 10s/epoch - 22ms/step
Epoch 4/50
428/428 - 10s - loss: 3.2796 - accuracy100: 0.3717 - val_loss: 3.3065 - val_accuracy100: 0.3398 - 10s/epoch - 23ms/step
Epoch 5/50
428/428 - 9s - loss: 3.2743 - accuracy100: 0.3747 - val_loss: 3.3056 - val_accuracy100: 0.3375 - 9s/epoch - 22ms/step
Epoch 6/50
428/428 - 10s - loss: 3.2707 - accuracy100: 0.3792 - val_loss: 3.3057 - val_accuracy100: 0.3384 - 10s/epoch - 22ms/step
Epoch 7/50
428/428 - 10s - loss: 3.2677 - accuracy100: 0.3793 - val_loss: 3.3012 - val_accuracy100: 0.3416 - 10s/epoch - 22ms/step
Epoch 8/50
428/428 - 9s - loss: 3.2663 - accuracy100: 0.3792 - val_loss: 3.3010 - val_accuracy100: 0.3371 - 9s/epoch - 22ms/step
Epoch 9/50
428/428 - 9s - loss: 3.2627 - accuracy100: 0.3827 - val_loss: 3.3015 - val_accuracy100: 0.3420 - 9s/epoch - 21ms/step
Epoch 10/50
428/428 - 9s - loss: 3.2616 - accuracy100: 0.3847 - val_loss: 3.3007 - val_accuracy100: 0.3404 - 9s/epoch - 21ms/step
Epoch 11/50
428/428 - 9s - loss: 3.2607 - accuracy100: 0.3849 - val_loss: 3.3007 - val_accuracy100: 0.3422 - 9s/epoch - 22ms/step
Epoch 12/50
428/428 - 9s - loss: 3.2577 - accuracy100: 0.3863 - val_loss: 3.2995 - val_accuracy100: 0.3405 - 9s/epoch - 22ms/step
Epoch 13/50
428/428 - 9s - loss: 3.2565 - accuracy100: 0.3873 - val_loss: 3.3013 - val_accuracy100: 0.3398 - 9s/epoch - 21ms/step
Epoch 14/50
428/428 - 9s - loss: 3.2543 - accuracy100: 0.3896 - val_loss: 3.3011 - val_accuracy100: 0.3401 - 9s/epoch - 21ms/step
Epoch 15/50
428/428 - 9s - loss: 3.2531 - accuracy100: 0.3887 - val_loss: 3.3026 - val_accuracy100: 0.3406 - 9s/epoch - 21ms/step
Epoch 16/50
428/428 - 9s - loss: 3.2514 - accuracy100: 0.3901 - val_loss: 3.3021 - val_accuracy100: 0.3402 - 9s/epoch - 22ms/step
Epoch 17/50
428/428 - 9s - loss: 3.2507 - accuracy100: 0.3911 - val_loss: 3.3005 - val_accuracy100: 0.3427 - 9s/epoch - 22ms/step
Epoch 18/50
428/428 - 9s - loss: 3.2494 - accuracy100: 0.3924 - val_loss: 3.3047 - val_accuracy100: 0.3390 - 9s/epoch - 21ms/step
Epoch 19/50
428/428 - 9s - loss: 3.2469 - accuracy100: 0.3932 - val_loss: 3.3027 - val_accuracy100: 0.3453 - 9s/epoch - 22ms/step
Epoch 20/50
428/428 - 9s - loss: 3.2455 - accuracy100: 0.3944 - val_loss: 3.3050 - val_accuracy100: 0.3426 - 9s/epoch - 22ms/step
Epoch 21/50
428/428 - 9s - loss: 3.2421 - accuracy100: 0.3956 - val_loss: 3.3041 - val_accuracy100: 0.3407 - 9s/epoch - 22ms/step
Epoch 22/50
428/428 - 9s - loss: 3.2407 - accuracy100: 0.3956 - val_loss: 3.3049 - val_accuracy100: 0.3410 - 9s/epoch - 21ms/step
testing model: results/PCAR/W10/deepOF_L1/h100
Evaluating performance on  test set...
2104/2104 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1169341
{'0': {'precision': 0.43363636363636365, 'recall': 0.18772677532684445, 'f1-score': 0.2620211953536355, 'support': 208356}, '1': {'precision': 0.2307762640577855, 'recall': 0.6726861573251494, 'f1-score': 0.34365568416948433, 'support': 123820}, '2': {'precision': 0.4309143935494939, 'recall': 0.18256129469909874, 'f1-score': 0.2564675050627095, 'support': 206380}, 'accuracy': 0.297244854759765, 'macro avg': {'precision': 0.36510900708121435, 'recall': 0.3476580757836975, 'f1-score': 0.2873814615286097, 'support': 538556}, 'weighted avg': {'precision': 0.3859534899587002, 'recall': 0.297244854759765, 'f1-score': 0.2786616409209248, 'support': 538556}}
[[ 39114 139440  29802]
 [ 20572  83292  19956]
 [ 30514 138189  37677]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0899112
{'0': {'precision': 0.41069648986823165, 'recall': 0.2039088485115039, 'f1-score': 0.2725151999412208, 'support': 36379}, '1': {'precision': 0.34411565932973776, 'recall': 0.7119787239876073, 'f1-score': 0.46397941680960547, 'support': 36473}, '2': {'precision': 0.4154559118236473, 'recall': 0.18105401053464698, 'f1-score': 0.2522001938831759, 'support': 36641}, 'accuracy': 0.3655028175317144, 'macro avg': {'precision': 0.39008935367387226, 'recall': 0.3656471943445861, 'f1-score': 0.3295649368780007, 'support': 109493}, 'weighted avg': {'precision': 0.3901105834416828, 'recall': 0.3655028175317144, 'f1-score': 0.3294952100319825, 'support': 109493}}
[[ 7418 24501  4460]
 [ 5631 25968  4874]
 [ 5013 24994  6634]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0999013
{'0': {'precision': 0.3923404255319149, 'recall': 0.19051161252996116, 'f1-score': 0.2564815845109603, 'support': 12099}, '1': {'precision': 0.3158334327645866, 'recall': 0.7063061460464289, 'f1-score': 0.4364865607651295, 'support': 11243}, '2': {'precision': 0.42349336057201226, 'recall': 0.16490334897780606, 'f1-score': 0.23737547234627274, 'support': 12571}, 'accuracy': 0.34302341770389555, 'macro avg': {'precision': 0.3772224062895046, 'recall': 0.3539070358513987, 'f1-score': 0.3101145392074542, 'support': 35913}, 'weighted avg': {'precision': 0.3792937690762022, 'recall': 0.34302341770389555, 'f1-score': 0.3061464137372387, 'support': 35913}}
[[2305 8455 1339]
 [1819 7941 1483]
 [1751 8747 2073]]
training model: results/PCAR/W10/deepOF_L1/h200
Epoch 1/50
428/428 - 11s - loss: 3.3287 - accuracy200: 0.3525 - val_loss: 3.3593 - val_accuracy200: 0.3234 - 11s/epoch - 26ms/step
Epoch 2/50
428/428 - 9s - loss: 3.3060 - accuracy200: 0.3551 - val_loss: 3.3437 - val_accuracy200: 0.3252 - 9s/epoch - 22ms/step
Epoch 3/50
428/428 - 9s - loss: 3.2957 - accuracy200: 0.3607 - val_loss: 3.3381 - val_accuracy200: 0.3198 - 9s/epoch - 21ms/step
Epoch 4/50
428/428 - 9s - loss: 3.2890 - accuracy200: 0.3637 - val_loss: 3.3297 - val_accuracy200: 0.3232 - 9s/epoch - 21ms/step
Epoch 5/50
428/428 - 9s - loss: 3.2842 - accuracy200: 0.3680 - val_loss: 3.3272 - val_accuracy200: 0.3245 - 9s/epoch - 21ms/step
Epoch 6/50
428/428 - 9s - loss: 3.2819 - accuracy200: 0.3692 - val_loss: 3.3258 - val_accuracy200: 0.3232 - 9s/epoch - 22ms/step
Epoch 7/50
428/428 - 10s - loss: 3.2788 - accuracy200: 0.3696 - val_loss: 3.3212 - val_accuracy200: 0.3250 - 10s/epoch - 22ms/step
Epoch 8/50
428/428 - 9s - loss: 3.2762 - accuracy200: 0.3734 - val_loss: 3.3223 - val_accuracy200: 0.3235 - 9s/epoch - 22ms/step
Epoch 9/50
428/428 - 9s - loss: 3.2736 - accuracy200: 0.3734 - val_loss: 3.3210 - val_accuracy200: 0.3250 - 9s/epoch - 22ms/step
Epoch 10/50
428/428 - 9s - loss: 3.2729 - accuracy200: 0.3754 - val_loss: 3.3206 - val_accuracy200: 0.3239 - 9s/epoch - 22ms/step
Epoch 11/50
428/428 - 10s - loss: 3.2703 - accuracy200: 0.3764 - val_loss: 3.3156 - val_accuracy200: 0.3274 - 10s/epoch - 22ms/step
Epoch 12/50
428/428 - 10s - loss: 3.2700 - accuracy200: 0.3770 - val_loss: 3.3164 - val_accuracy200: 0.3269 - 10s/epoch - 23ms/step
Epoch 13/50
428/428 - 9s - loss: 3.2672 - accuracy200: 0.3795 - val_loss: 3.3179 - val_accuracy200: 0.3255 - 9s/epoch - 22ms/step
Epoch 14/50
428/428 - 10s - loss: 3.2661 - accuracy200: 0.3807 - val_loss: 3.3172 - val_accuracy200: 0.3258 - 10s/epoch - 23ms/step
Epoch 15/50
428/428 - 9s - loss: 3.2650 - accuracy200: 0.3799 - val_loss: 3.3186 - val_accuracy200: 0.3261 - 9s/epoch - 21ms/step
Epoch 16/50
428/428 - 9s - loss: 3.2647 - accuracy200: 0.3816 - val_loss: 3.3180 - val_accuracy200: 0.3287 - 9s/epoch - 22ms/step
Epoch 17/50
428/428 - 9s - loss: 3.2618 - accuracy200: 0.3821 - val_loss: 3.3175 - val_accuracy200: 0.3288 - 9s/epoch - 21ms/step
Epoch 18/50
428/428 - 9s - loss: 3.2609 - accuracy200: 0.3836 - val_loss: 3.3179 - val_accuracy200: 0.3295 - 9s/epoch - 21ms/step
Epoch 19/50
428/428 - 9s - loss: 3.2581 - accuracy200: 0.3862 - val_loss: 3.3185 - val_accuracy200: 0.3294 - 9s/epoch - 22ms/step
Epoch 20/50
428/428 - 9s - loss: 3.2585 - accuracy200: 0.3840 - val_loss: 3.3201 - val_accuracy200: 0.3277 - 9s/epoch - 21ms/step
Epoch 21/50
428/428 - 9s - loss: 3.2564 - accuracy200: 0.3857 - val_loss: 3.3202 - val_accuracy200: 0.3290 - 9s/epoch - 21ms/step
testing model: results/PCAR/W10/deepOF_L1/h200
Evaluating performance on  test set...
2104/2104 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1227865
{'0': {'precision': 0.40850406621781415, 'recall': 0.08077607638607223, 'f1-score': 0.13488123789869563, 'support': 209567}, '1': {'precision': 0.23233146751034314, 'recall': 0.7632193281207528, 'f1-score': 0.35622464933523884, 'support': 125082}, '2': {'precision': 0.4109630351322825, 'recall': 0.1737654911307606, 'f1-score': 0.24425418097089518, 'support': 203907}, 'accuracy': 0.2744839905228054, 'macro avg': {'precision': 0.35059952295347996, 'recall': 0.3392536318791952, 'f1-score': 0.24512002273494318, 'support': 538556}, 'weighted avg': {'precision': 0.36851821513253163, 'recall': 0.2744839905228054, 'f1-score': 0.22769978470223823, 'support': 538556}}
[[ 16928 161769  30870]
 [  9702  95465  19915]
 [ 14809 153666  35432]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0966517
{'0': {'precision': 0.4066691738748903, 'recall': 0.08864114544908053, 'f1-score': 0.14555570511957644, 'support': 36597}, '1': {'precision': 0.3385371293166533, 'recall': 0.8083483566772985, 'f1-score': 0.4772157909387127, 'support': 36055}, '2': {'precision': 0.40564019448946514, 'recall': 0.1698379522814256, 'f1-score': 0.23942907435043817, 'support': 36841}, 'accuracy': 0.35295407012320423, 'macro avg': {'precision': 0.38361549922700294, 'recall': 0.35560915146926825, 'f1-score': 0.2874001901362424, 'support': 109493}, 'weighted avg': {'precision': 0.38388772212833405, 'recall': 0.35295407012320423, 'f1-score': 0.28635368480816964, 'support': 109493}}
[[ 3244 28763  4590]
 [ 2332 29145  4578]
 [ 2401 28183  6257]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1072704
{'0': {'precision': 0.37589996210685866, 'recall': 0.08146505707481318, 'f1-score': 0.13390928725701945, 'support': 12177}, '1': {'precision': 0.30789169498055974, 'recall': 0.7983651226158038, 'f1-score': 0.4443995045375262, 'support': 11010}, '2': {'precision': 0.4071957671957672, 'recall': 0.15118654722615119, 'f1-score': 0.22050312303019884, 'support': 12726}, 'accuracy': 0.3259543897752903, 'macro avg': {'precision': 0.3636624747610619, 'recall': 0.3436722423055894, 'f1-score': 0.2662706382749148, 'support': 35913}, 'weighted avg': {'precision': 0.36614024820105573, 'recall': 0.3259543897752903, 'f1-score': 0.259782660305995, 'support': 35913}}
[[ 992 9821 1364]
 [ 783 8790 1437]
 [ 864 9938 1924]]
training model: results/PCAR/W10/deepOF_L1/h300
Epoch 1/50
428/428 - 12s - loss: 3.3353 - accuracy300: 0.3421 - val_loss: 3.3369 - val_accuracy300: 0.3276 - 12s/epoch - 27ms/step
Epoch 2/50
428/428 - 9s - loss: 3.3127 - accuracy300: 0.3469 - val_loss: 3.3214 - val_accuracy300: 0.3287 - 9s/epoch - 21ms/step
Epoch 3/50
428/428 - 9s - loss: 3.3013 - accuracy300: 0.3518 - val_loss: 3.3195 - val_accuracy300: 0.3266 - 9s/epoch - 21ms/step
Epoch 4/50
428/428 - 9s - loss: 3.2964 - accuracy300: 0.3547 - val_loss: 3.3124 - val_accuracy300: 0.3293 - 9s/epoch - 22ms/step
Epoch 5/50
428/428 - 9s - loss: 3.2928 - accuracy300: 0.3551 - val_loss: 3.3131 - val_accuracy300: 0.3257 - 9s/epoch - 22ms/step
Epoch 6/50
428/428 - 9s - loss: 3.2888 - accuracy300: 0.3575 - val_loss: 3.3101 - val_accuracy300: 0.3264 - 9s/epoch - 22ms/step
Epoch 7/50
428/428 - 9s - loss: 3.2856 - accuracy300: 0.3600 - val_loss: 3.3079 - val_accuracy300: 0.3262 - 9s/epoch - 21ms/step
Epoch 8/50
428/428 - 9s - loss: 3.2840 - accuracy300: 0.3617 - val_loss: 3.3115 - val_accuracy300: 0.3241 - 9s/epoch - 22ms/step
Epoch 9/50
428/428 - 9s - loss: 3.2835 - accuracy300: 0.3617 - val_loss: 3.3096 - val_accuracy300: 0.3263 - 9s/epoch - 21ms/step
Epoch 10/50
428/428 - 9s - loss: 3.2810 - accuracy300: 0.3644 - val_loss: 3.3082 - val_accuracy300: 0.3275 - 9s/epoch - 21ms/step
Epoch 11/50
428/428 - 9s - loss: 3.2787 - accuracy300: 0.3650 - val_loss: 3.3078 - val_accuracy300: 0.3261 - 9s/epoch - 22ms/step
Epoch 12/50
428/428 - 9s - loss: 3.2776 - accuracy300: 0.3673 - val_loss: 3.3085 - val_accuracy300: 0.3270 - 9s/epoch - 21ms/step
Epoch 13/50
428/428 - 9s - loss: 3.2766 - accuracy300: 0.3678 - val_loss: 3.3097 - val_accuracy300: 0.3255 - 9s/epoch - 21ms/step
Epoch 14/50
428/428 - 9s - loss: 3.2753 - accuracy300: 0.3688 - val_loss: 3.3088 - val_accuracy300: 0.3250 - 9s/epoch - 22ms/step
Epoch 15/50
428/428 - 9s - loss: 3.2731 - accuracy300: 0.3717 - val_loss: 3.3103 - val_accuracy300: 0.3255 - 9s/epoch - 21ms/step
Epoch 16/50
428/428 - 9s - loss: 3.2722 - accuracy300: 0.3704 - val_loss: 3.3095 - val_accuracy300: 0.3287 - 9s/epoch - 21ms/step
Epoch 17/50
428/428 - 9s - loss: 3.2716 - accuracy300: 0.3719 - val_loss: 3.3100 - val_accuracy300: 0.3313 - 9s/epoch - 21ms/step
Epoch 18/50
428/428 - 9s - loss: 3.2693 - accuracy300: 0.3742 - val_loss: 3.3098 - val_accuracy300: 0.3309 - 9s/epoch - 22ms/step
Epoch 19/50
428/428 - 9s - loss: 3.2686 - accuracy300: 0.3759 - val_loss: 3.3100 - val_accuracy300: 0.3287 - 9s/epoch - 22ms/step
Epoch 20/50
428/428 - 9s - loss: 3.2674 - accuracy300: 0.3748 - val_loss: 3.3117 - val_accuracy300: 0.3295 - 9s/epoch - 22ms/step
Epoch 21/50
428/428 - 10s - loss: 3.2656 - accuracy300: 0.3774 - val_loss: 3.3137 - val_accuracy300: 0.3291 - 10s/epoch - 22ms/step
testing model: results/PCAR/W10/deepOF_L1/h300
Evaluating performance on  test set...
2104/2104 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1141595
{'0': {'precision': 0.40672999334645166, 'recall': 0.13622462768302918, 'f1-score': 0.2040930853708781, 'support': 210909}, '1': {'precision': 0.23414297991448557, 'recall': 0.6993975712105799, 'f1-score': 0.3508343183825127, 'support': 125824}, '2': {'precision': 0.3951604144492473, 'recall': 0.1802767771760404, 'f1-score': 0.24759694722981182, 'support': 201823}, 'accuracy': 0.2843084098960925, 'macro avg': {'precision': 0.3453444625700615, 'recall': 0.3386329920232165, 'f1-score': 0.2675081169944009, 'support': 538556}, 'weighted avg': {'precision': 0.3620724359154061, 'recall': 0.2843084098960925, 'f1-score': 0.25467955885629373, 'support': 538556}}
[[ 28731 147979  34199]
 [ 16332  88001  21491]
 [ 25576 139863  36384]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0952206
{'0': {'precision': 0.385466973772197, 'recall': 0.14143176489831524, 'f1-score': 0.2069364392413394, 'support': 36682}, '1': {'precision': 0.33791573723652224, 'recall': 0.7530650431479878, 'f1-score': 0.4665023139137582, 'support': 35807}, '2': {'precision': 0.4012687854151269, 'recall': 0.17606204734623285, 'f1-score': 0.24474079639368898, 'support': 37004}, 'accuracy': 0.35315499620980334, 'macro avg': {'precision': 0.374883832141282, 'recall': 0.3568529517975119, 'f1-score': 0.3060598498495955, 'support': 109493}, 'weighted avg': {'precision': 0.3752568517680695, 'recall': 0.35315499620980334, 'f1-score': 0.3045973646563051, 'support': 109493}}
[[ 5188 26567  4927]
 [ 4048 26965  4794]
 [ 4223 26266  6515]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1043379
{'0': {'precision': 0.3592730661696179, 'recall': 0.12752232881243797, 'f1-score': 0.18823242187499997, 'support': 12092}, '1': {'precision': 0.30798579631308554, 'recall': 0.7374943464495703, 'f1-score': 0.43451381671862926, 'support': 11055}, '2': {'precision': 0.37580112643231695, 'recall': 0.15157449475168416, 'f1-score': 0.21602009489254817, 'support': 12766}, 'accuracy': 0.3238381644529836, 'macro avg': {'precision': 0.34768666297167344, 'recall': 0.3388637233378975, 'f1-score': 0.27958877782872577, 'support': 35913}, 'weighted avg': {'precision': 0.3493606792637523, 'recall': 0.3238381644529836, 'f1-score': 0.27392223486022377, 'support': 35913}}
[[1542 8949 1601]
 [1289 8153 1613]
 [1461 9370 1935]]
training model: results/PCAR/W10/deepOF_L1/h500
Epoch 1/50
428/428 - 11s - loss: 3.3393 - accuracy500: 0.3416 - val_loss: 3.3365 - val_accuracy500: 0.3248 - 11s/epoch - 26ms/step
Epoch 2/50
428/428 - 9s - loss: 3.3159 - accuracy500: 0.3464 - val_loss: 3.3265 - val_accuracy500: 0.3263 - 9s/epoch - 22ms/step
Epoch 3/50
428/428 - 9s - loss: 3.3047 - accuracy500: 0.3514 - val_loss: 3.3209 - val_accuracy500: 0.3233 - 9s/epoch - 21ms/step
Epoch 4/50
428/428 - 9s - loss: 3.2990 - accuracy500: 0.3522 - val_loss: 3.3194 - val_accuracy500: 0.3227 - 9s/epoch - 22ms/step
Epoch 5/50
428/428 - 9s - loss: 3.2947 - accuracy500: 0.3541 - val_loss: 3.3204 - val_accuracy500: 0.3182 - 9s/epoch - 22ms/step
Epoch 6/50
428/428 - 9s - loss: 3.2917 - accuracy500: 0.3579 - val_loss: 3.3171 - val_accuracy500: 0.3214 - 9s/epoch - 22ms/step
Epoch 7/50
428/428 - 9s - loss: 3.2876 - accuracy500: 0.3596 - val_loss: 3.3161 - val_accuracy500: 0.3196 - 9s/epoch - 21ms/step
Epoch 8/50
428/428 - 9s - loss: 3.2860 - accuracy500: 0.3619 - val_loss: 3.3166 - val_accuracy500: 0.3205 - 9s/epoch - 21ms/step
Epoch 9/50
428/428 - 9s - loss: 3.2839 - accuracy500: 0.3622 - val_loss: 3.3161 - val_accuracy500: 0.3218 - 9s/epoch - 22ms/step
Epoch 10/50
428/428 - 9s - loss: 3.2819 - accuracy500: 0.3648 - val_loss: 3.3180 - val_accuracy500: 0.3191 - 9s/epoch - 21ms/step
Epoch 11/50
428/428 - 9s - loss: 3.2807 - accuracy500: 0.3661 - val_loss: 3.3153 - val_accuracy500: 0.3224 - 9s/epoch - 22ms/step
Epoch 12/50
428/428 - 9s - loss: 3.2793 - accuracy500: 0.3671 - val_loss: 3.3156 - val_accuracy500: 0.3239 - 9s/epoch - 21ms/step
Epoch 13/50
428/428 - 9s - loss: 3.2784 - accuracy500: 0.3670 - val_loss: 3.3141 - val_accuracy500: 0.3248 - 9s/epoch - 22ms/step
Epoch 14/50
428/428 - 9s - loss: 3.2771 - accuracy500: 0.3700 - val_loss: 3.3152 - val_accuracy500: 0.3223 - 9s/epoch - 22ms/step
Epoch 15/50
428/428 - 10s - loss: 3.2748 - accuracy500: 0.3718 - val_loss: 3.3125 - val_accuracy500: 0.3259 - 10s/epoch - 22ms/step
Epoch 16/50
428/428 - 9s - loss: 3.2733 - accuracy500: 0.3735 - val_loss: 3.3136 - val_accuracy500: 0.3254 - 9s/epoch - 22ms/step
Epoch 17/50
428/428 - 9s - loss: 3.2738 - accuracy500: 0.3714 - val_loss: 3.3142 - val_accuracy500: 0.3284 - 9s/epoch - 21ms/step
Epoch 18/50
428/428 - 9s - loss: 3.2714 - accuracy500: 0.3723 - val_loss: 3.3148 - val_accuracy500: 0.3278 - 9s/epoch - 21ms/step
Epoch 19/50
428/428 - 9s - loss: 3.2693 - accuracy500: 0.3728 - val_loss: 3.3178 - val_accuracy500: 0.3240 - 9s/epoch - 22ms/step
Epoch 20/50
428/428 - 9s - loss: 3.2690 - accuracy500: 0.3762 - val_loss: 3.3137 - val_accuracy500: 0.3297 - 9s/epoch - 21ms/step
Epoch 21/50
428/428 - 9s - loss: 3.2667 - accuracy500: 0.3767 - val_loss: 3.3149 - val_accuracy500: 0.3272 - 9s/epoch - 21ms/step
Epoch 22/50
428/428 - 9s - loss: 3.2646 - accuracy500: 0.3788 - val_loss: 3.3151 - val_accuracy500: 0.3285 - 9s/epoch - 22ms/step
Epoch 23/50
428/428 - 9s - loss: 3.2639 - accuracy500: 0.3791 - val_loss: 3.3184 - val_accuracy500: 0.3277 - 9s/epoch - 21ms/step
Epoch 24/50
428/428 - 9s - loss: 3.2617 - accuracy500: 0.3796 - val_loss: 3.3187 - val_accuracy500: 0.3268 - 9s/epoch - 21ms/step
Epoch 25/50
428/428 - 9s - loss: 3.2617 - accuracy500: 0.3798 - val_loss: 3.3191 - val_accuracy500: 0.3291 - 9s/epoch - 21ms/step
testing model: results/PCAR/W10/deepOF_L1/h500
Evaluating performance on  test set...
2104/2104 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.112652
{'0': {'precision': 0.3885805977134452, 'recall': 0.16870500812756406, 'f1-score': 0.2352671312819198, 'support': 206704}, '1': {'precision': 0.2428878122703894, 'recall': 0.6470718671386954, 'f1-score': 0.35319773204868954, 'support': 130783}, '2': {'precision': 0.38815514253271977, 'recall': 0.19381406382883487, 'f1-score': 0.2585357601329498, 'support': 201069}, 'accuracy': 0.29424609511360006, 'macro avg': {'precision': 0.33987451750551817, 'recall': 0.3365303130316981, 'f1-score': 0.28233354115451975, 'support': 538556}, 'weighted avg': {'precision': 0.3530417022107817, 'recall': 0.29424609511360006, 'f1-score': 0.2725927161691519, 'support': 538556}}
[[ 34872 134611  37221]
 [ 21950  84626  24207]
 [ 32920 129179  38970]]
Evaluating performance on  train set...
428/428 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.093789
{'0': {'precision': 0.3881848559359435, 'recall': 0.16932977640878963, 'f1-score': 0.23580100340852514, 'support': 36361}, '1': {'precision': 0.3452017855039074, 'recall': 0.7311669947597527, 'f1-score': 0.46898452783211797, 'support': 36067}, '2': {'precision': 0.39932710714078545, 'recall': 0.18572777552947525, 'f1-score': 0.2535356511490866, 'support': 37065}, 'accuracy': 0.3599499511384289, 'macro avg': {'precision': 0.3775712495268788, 'recall': 0.3620748488993392, 'f1-score': 0.31944039412990993, 'support': 109493}, 'weighted avg': {'precision': 0.3777980470955174, 'recall': 0.3599499511384289, 'f1-score': 0.31861510927729875, 'support': 109493}}
[[ 6157 24917  5287]
 [ 4628 26371  5068]
 [ 5076 25105  6884]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1055211
{'0': {'precision': 0.3575339687690124, 'recall': 0.1440594868442556, 'f1-score': 0.20537014386394084, 'support': 12238}, '1': {'precision': 0.30851982724774246, 'recall': 0.7211159034596678, 'f1-score': 0.4321500261225837, 'support': 10897}, '2': {'precision': 0.373911465892598, 'recall': 0.16129284708092034, 'f1-score': 0.22536905412793878, 'support': 12778}, 'accuracy': 0.3252861080945619, 'macro avg': {'precision': 0.3466550873031176, 'recall': 0.3421560791282812, 'f1-score': 0.2876297413714877, 'support': 35913}, 'weighted avg': {'precision': 0.34848890314062986, 'recall': 0.3252861080945619, 'f1-score': 0.28129714668536476, 'support': 35913}}
[[1763 8621 1854]
 [1442 7858 1597]
 [1726 8991 2061]]
training model: results/PCAR/W10/deepOF_L1/h1000
Epoch 1/50
428/428 - 11s - loss: 3.3470 - accuracy1000: 0.3422 - val_loss: 3.3315 - val_accuracy1000: 0.3294 - 11s/epoch - 26ms/step
Epoch 2/50
428/428 - 10s - loss: 3.3192 - accuracy1000: 0.3513 - val_loss: 3.3211 - val_accuracy1000: 0.3285 - 10s/epoch - 22ms/step
Epoch 3/50
428/428 - 9s - loss: 3.3069 - accuracy1000: 0.3534 - val_loss: 3.3213 - val_accuracy1000: 0.3250 - 9s/epoch - 21ms/step
Epoch 4/50
428/428 - 9s - loss: 3.3005 - accuracy1000: 0.3560 - val_loss: 3.3215 - val_accuracy1000: 0.3214 - 9s/epoch - 21ms/step
Epoch 5/50
428/428 - 9s - loss: 3.2964 - accuracy1000: 0.3576 - val_loss: 3.3211 - val_accuracy1000: 0.3194 - 9s/epoch - 21ms/step
Epoch 6/50
428/428 - 9s - loss: 3.2933 - accuracy1000: 0.3581 - val_loss: 3.3219 - val_accuracy1000: 0.3182 - 9s/epoch - 21ms/step
Epoch 7/50
428/428 - 9s - loss: 3.2899 - accuracy1000: 0.3590 - val_loss: 3.3240 - val_accuracy1000: 0.3168 - 9s/epoch - 21ms/step
Epoch 8/50
428/428 - 9s - loss: 3.2894 - accuracy1000: 0.3594 - val_loss: 3.3229 - val_accuracy1000: 0.3182 - 9s/epoch - 21ms/step
Epoch 9/50
428/428 - 9s - loss: 3.2874 - accuracy1000: 0.3604 - val_loss: 3.3214 - val_accuracy1000: 0.3184 - 9s/epoch - 21ms/step
Epoch 10/50
428/428 - 9s - loss: 3.2855 - accuracy1000: 0.3614 - val_loss: 3.3250 - val_accuracy1000: 0.3154 - 9s/epoch - 21ms/step
Epoch 11/50
428/428 - 9s - loss: 3.2842 - accuracy1000: 0.3618 - val_loss: 3.3256 - val_accuracy1000: 0.3161 - 9s/epoch - 22ms/step
Epoch 12/50
428/428 - 9s - loss: 3.2824 - accuracy1000: 0.3636 - val_loss: 3.3236 - val_accuracy1000: 0.3160 - 9s/epoch - 21ms/step
Epoch 13/50
428/428 - 9s - loss: 3.2809 - accuracy1000: 0.3653 - val_loss: 3.3234 - val_accuracy1000: 0.3165 - 9s/epoch - 21ms/step
Epoch 14/50
428/428 - 9s - loss: 3.2794 - accuracy1000: 0.3666 - val_loss: 3.3261 - val_accuracy1000: 0.3150 - 9s/epoch - 22ms/step
Epoch 15/50
428/428 - 9s - loss: 3.2783 - accuracy1000: 0.3674 - val_loss: 3.3252 - val_accuracy1000: 0.3180 - 9s/epoch - 22ms/step
testing model: results/PCAR/W10/deepOF_L1/h1000
Evaluating performance on  test set...
2104/2104 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1163433
{'0': {'precision': 0.38472730921679793, 'recall': 0.03688276207059095, 'f1-score': 0.06731246132035307, 'support': 207902}, '1': {'precision': 0.23790458229267547, 'recall': 0.7282422143169194, 'f1-score': 0.358645622824475, 'support': 128184}, '2': {'precision': 0.37784466711552933, 'recall': 0.2355953968489159, 'f1-score': 0.2902270964209117, 'support': 202470}, 'accuracy': 0.2761421282095084, 'macro avg': {'precision': 0.3334921862083342, 'recall': 0.3335734577454754, 'f1-score': 0.23872839352191325, 'support': 538556}, 'weighted avg': {'precision': 0.347193880985963, 'recall': 0.2761421282095084, 'f1-score': 0.2204586079477316, 'support': 538556}}
[[  7668 151839  48395]
 [  4686  93349  30149]
 [  7577 147192  47701]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0989314
{'0': {'precision': 0.3836111111111111, 'recall': 0.03801266171208368, 'f1-score': 0.0691710493363386, 'support': 36330}, '1': {'precision': 0.343703632218295, 'recall': 0.7764122407826253, 'f1-score': 0.4764787531147047, 'support': 36697}, '2': {'precision': 0.3641937728300574, 'recall': 0.2296659902374815, 'f1-score': 0.28169250950186675, 'support': 36466}, 'accuracy': 0.349319134556547, 'macro avg': {'precision': 0.36383617205315444, 'recall': 0.34803029757739684, 'f1-score': 0.27578077065097, 'support': 109493}, 'weighted avg': {'precision': 0.36376913572741926, 'recall': 0.349319134556547, 'f1-score': 0.276460815549255, 'support': 109493}}
[[ 1381 27471  7478]
 [ 1062 28492  7143]
 [ 1157 26934  8375]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1069288
{'0': {'precision': 0.34563456345634563, 'recall': 0.031501230516817066, 'f1-score': 0.05774001954740245, 'support': 12190}, '1': {'precision': 0.3041351874155991, 'recall': 0.7692236684205668, 'f1-score': 0.4359175559740532, 'support': 10833}, '2': {'precision': 0.3644468458732946, 'recall': 0.20930954228083787, 'f1-score': 0.2659044990883556, 'support': 12890}, 'accuracy': 0.3178514743964581, 'macro avg': {'precision': 0.3380721989150797, 'recall': 0.3366781470727405, 'f1-score': 0.25318735820327043, 'support': 35913}, 'weighted avg': {'precision': 0.33986861741187885, 'recall': 0.3178514743964581, 'f1-score': 0.2465306355748241, 'support': 35913}}
[[ 384 9289 2517]
 [ 312 8333 2188]
 [ 415 9777 2698]]
training model: results/PCAR/W10/deepLOB_L2/h10
Epoch 1/50
428/428 - 23s - loss: 3.3213 - accuracy10: 0.3630 - val_loss: 3.4098 - val_accuracy10: 0.3288 - 23s/epoch - 54ms/step
Epoch 2/50
428/428 - 20s - loss: 3.2578 - accuracy10: 0.3917 - val_loss: 3.3753 - val_accuracy10: 0.3278 - 20s/epoch - 47ms/step
Epoch 3/50
428/428 - 20s - loss: 3.2074 - accuracy10: 0.4196 - val_loss: 3.3224 - val_accuracy10: 0.3529 - 20s/epoch - 48ms/step
Epoch 4/50
428/428 - 21s - loss: 3.1589 - accuracy10: 0.4445 - val_loss: 3.2963 - val_accuracy10: 0.3781 - 21s/epoch - 49ms/step
Epoch 5/50
428/428 - 20s - loss: 3.1313 - accuracy10: 0.4549 - val_loss: 3.2713 - val_accuracy10: 0.3880 - 20s/epoch - 47ms/step
Epoch 6/50
428/428 - 20s - loss: 3.1132 - accuracy10: 0.4630 - val_loss: 3.2589 - val_accuracy10: 0.3971 - 20s/epoch - 47ms/step
Epoch 7/50
428/428 - 20s - loss: 3.0970 - accuracy10: 0.4662 - val_loss: 3.2372 - val_accuracy10: 0.4051 - 20s/epoch - 47ms/step
Epoch 8/50
428/428 - 20s - loss: 3.0832 - accuracy10: 0.4704 - val_loss: 3.2521 - val_accuracy10: 0.4051 - 20s/epoch - 47ms/step
Epoch 9/50
428/428 - 20s - loss: 3.0736 - accuracy10: 0.4739 - val_loss: 3.2415 - val_accuracy10: 0.4126 - 20s/epoch - 47ms/step
Epoch 10/50
428/428 - 20s - loss: 3.0636 - accuracy10: 0.4770 - val_loss: 3.2512 - val_accuracy10: 0.4116 - 20s/epoch - 47ms/step
Epoch 11/50
428/428 - 20s - loss: 3.0539 - accuracy10: 0.4800 - val_loss: 3.2492 - val_accuracy10: 0.4116 - 20s/epoch - 47ms/step
Epoch 12/50
428/428 - 20s - loss: 3.0445 - accuracy10: 0.4819 - val_loss: 3.2552 - val_accuracy10: 0.4096 - 20s/epoch - 47ms/step
Epoch 13/50
428/428 - 20s - loss: 3.0340 - accuracy10: 0.4854 - val_loss: 3.2740 - val_accuracy10: 0.4089 - 20s/epoch - 47ms/step
Epoch 14/50
428/428 - 20s - loss: 3.0313 - accuracy10: 0.4858 - val_loss: 3.2799 - val_accuracy10: 0.4109 - 20s/epoch - 47ms/step
Epoch 15/50
428/428 - 20s - loss: 3.0232 - accuracy10: 0.4892 - val_loss: 3.2903 - val_accuracy10: 0.4094 - 20s/epoch - 47ms/step
Epoch 16/50
428/428 - 20s - loss: 3.0150 - accuracy10: 0.4918 - val_loss: 3.2661 - val_accuracy10: 0.4149 - 20s/epoch - 47ms/step
Epoch 17/50
428/428 - 20s - loss: 3.0075 - accuracy10: 0.4924 - val_loss: 3.2524 - val_accuracy10: 0.4137 - 20s/epoch - 48ms/step
testing model: results/PCAR/W10/deepLOB_L2/h10
Evaluating performance on  test set...
2104/2104 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1404649
{'0': {'precision': 0.5161179774862362, 'recall': 0.31508045516977906, 'f1-score': 0.3912872808194226, 'support': 219874}, '1': {'precision': 0.21340240225273494, 'recall': 0.6758644502540324, 'f1-score': 0.3243820386981915, 'support': 101365}, '2': {'precision': 0.537046818727491, 'recall': 0.20585122537064815, 'f1-score': 0.29762292846165617, 'support': 217322}, 'accuracy': 0.33890868443871724, 'macro avg': {'precision': 0.4221890661554874, 'recall': 0.3989320435981532, 'f1-score': 0.33776408265975677, 'support': 538561}, 'weighted avg': {'precision': 0.46758778936026374, 'recall': 0.33890868443871724, 'f1-score': 0.34089897893586046, 'support': 538561}}
[[ 69278 125149  25447]
 [ 19739  68509  13117]
 [ 45212 127374  44736]]
Evaluating performance on  train set...
428/428 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0782725
{'0': {'precision': 0.4884783850695106, 'recall': 0.28296422957058937, 'f1-score': 0.3583465763232804, 'support': 36259}, '1': {'precision': 0.3741643622305152, 'recall': 0.7707388563212034, 'f1-score': 0.5037683674022664, 'support': 36164}, '2': {'precision': 0.48956844812803657, 'recall': 0.18483450675730356, 'f1-score': 0.26835333973015846, 'support': 37071}, 'accuracy': 0.4108444298317716, 'macro avg': {'precision': 0.4507370651426874, 'recall': 0.4128458642163655, 'f1-score': 0.3768227611519017, 'support': 109494}, 'weighted avg': {'precision': 0.4510914725966188, 'recall': 0.4108444298317716, 'f1-score': 0.3759082178637924, 'support': 109494}}
[[10260 22279  3720]
 [ 4867 27873  3424]
 [ 5877 24342  6852]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.080962
{'0': {'precision': 0.439840442852491, 'recall': 0.44421606511551426, 'f1-score': 0.44201742545097555, 'support': 12163}, '1': {'precision': 0.36327538098304357, 'recall': 0.5980565371024735, 'f1-score': 0.4519962611830685, 'support': 11320}, '2': {'precision': 0.49429200881233726, 'recall': 0.1985518905872888, 'f1-score': 0.2833036790449406, 'support': 12430}, 'accuracy': 0.40767967031437086, 'macro avg': {'precision': 0.4324692775492906, 'recall': 0.4136081642684255, 'f1-score': 0.39243912189299485, 'support': 35913}, 'weighted avg': {'precision': 0.43455312250940475, 'recall': 0.40767967031437086, 'f1-score': 0.39022973165375113, 'support': 35913}}
[[5403 5509 1251]
 [3276 6770 1274]
 [3605 6357 2468]]
training model: results/PCAR/W10/deepLOB_L2/h20
Epoch 1/50
428/428 - 23s - loss: 3.3359 - accuracy20: 0.3546 - val_loss: 3.3388 - val_accuracy20: 0.3409 - 23s/epoch - 53ms/step
Epoch 2/50
428/428 - 20s - loss: 3.2746 - accuracy20: 0.3798 - val_loss: 3.2940 - val_accuracy20: 0.3616 - 20s/epoch - 47ms/step
Epoch 3/50
428/428 - 20s - loss: 3.2272 - accuracy20: 0.4110 - val_loss: 3.2852 - val_accuracy20: 0.3737 - 20s/epoch - 47ms/step
Epoch 4/50
428/428 - 20s - loss: 3.1983 - accuracy20: 0.4260 - val_loss: 3.3073 - val_accuracy20: 0.3564 - 20s/epoch - 47ms/step
Epoch 5/50
428/428 - 20s - loss: 3.1800 - accuracy20: 0.4336 - val_loss: 3.2955 - val_accuracy20: 0.3760 - 20s/epoch - 47ms/step
Epoch 6/50
428/428 - 20s - loss: 3.1659 - accuracy20: 0.4393 - val_loss: 3.2714 - val_accuracy20: 0.3824 - 20s/epoch - 47ms/step
Epoch 7/50
428/428 - 20s - loss: 3.1578 - accuracy20: 0.4433 - val_loss: 3.2989 - val_accuracy20: 0.3753 - 20s/epoch - 47ms/step
Epoch 8/50
428/428 - 20s - loss: 3.1479 - accuracy20: 0.4462 - val_loss: 3.2979 - val_accuracy20: 0.3741 - 20s/epoch - 47ms/step
Epoch 9/50
428/428 - 20s - loss: 3.1424 - accuracy20: 0.4494 - val_loss: 3.3102 - val_accuracy20: 0.3724 - 20s/epoch - 47ms/step
Epoch 10/50
428/428 - 20s - loss: 3.1386 - accuracy20: 0.4498 - val_loss: 3.2983 - val_accuracy20: 0.3791 - 20s/epoch - 47ms/step
Epoch 11/50
428/428 - 21s - loss: 3.1297 - accuracy20: 0.4527 - val_loss: 3.3201 - val_accuracy20: 0.3765 - 21s/epoch - 48ms/step
Epoch 12/50
428/428 - 21s - loss: 3.1239 - accuracy20: 0.4556 - val_loss: 3.3025 - val_accuracy20: 0.3842 - 21s/epoch - 48ms/step
Epoch 13/50
428/428 - 20s - loss: 3.1168 - accuracy20: 0.4571 - val_loss: 3.3118 - val_accuracy20: 0.3794 - 20s/epoch - 47ms/step
Epoch 14/50
428/428 - 20s - loss: 3.1122 - accuracy20: 0.4576 - val_loss: 3.3057 - val_accuracy20: 0.3788 - 20s/epoch - 47ms/step
Epoch 15/50
428/428 - 20s - loss: 3.1071 - accuracy20: 0.4596 - val_loss: 3.3144 - val_accuracy20: 0.3787 - 20s/epoch - 47ms/step
Epoch 16/50
428/428 - 20s - loss: 3.1006 - accuracy20: 0.4624 - val_loss: 3.2906 - val_accuracy20: 0.3870 - 20s/epoch - 47ms/step
testing model: results/PCAR/W10/deepLOB_L2/h20
Evaluating performance on  test set...
2104/2104 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1378889
{'0': {'precision': 0.5031320162803334, 'recall': 0.23108942966925336, 'f1-score': 0.3167123252309549, 'support': 212368}, '1': {'precision': 0.23083874498982285, 'recall': 0.6922123439904257, 'f1-score': 0.3462201186063117, 'support': 116980}, '2': {'precision': 0.5101957133674668, 'recall': 0.22004846735145522, 'f1-score': 0.30748012169098377, 'support': 209213}, 'accuracy': 0.32696017721298054, 'macro avg': {'precision': 0.41472215821254105, 'recall': 0.3811167470037115, 'f1-score': 0.3234708551760834, 'support': 538561}, 'weighted avg': {'precision': 0.4467316278064679, 'recall': 0.32696017721298054, 'f1-score': 0.3195352638949897, 'support': 538561}}
[[ 49076 137091  26201]
 [ 18009  80975  17996]
 [ 30456 132720  46037]]
Evaluating performance on  train set...
428/428 - 8s - 8s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0876062
{'0': {'precision': 0.4525992438563327, 'recall': 0.26383646932422383, 'f1-score': 0.3333507370472859, 'support': 36299}, '1': {'precision': 0.35971294304155815, 'recall': 0.7026182642594487, 'f1-score': 0.4758231367666195, 'support': 36169}, '2': {'precision': 0.47608277733800747, 'recall': 0.2274077675147194, 'f1-score': 0.3077935370668226, 'support': 37026}, 'accuracy': 0.3964600800043838, 'macro avg': {'precision': 0.42946498807863276, 'recall': 0.39795416703279735, 'f1-score': 0.37232247029357596, 'support': 109494}, 'weighted avg': {'precision': 0.4298573282858257, 'recall': 0.3964600800043838, 'f1-score': 0.37177113760779096, 'support': 109494}}
[[ 9577 22526  4196]
 [ 5686 25413  5070]
 [ 5897 22709  8420]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0922626
{'0': {'precision': 0.4232598357111976, 'recall': 0.3294355177925465, 'f1-score': 0.3705000236529637, 'support': 11887}, '1': {'precision': 0.33609156674264196, 'recall': 0.5824817518248175, 'f1-score': 0.42624187011028375, 'support': 11645}, '2': {'precision': 0.46951690075628955, 'recall': 0.2456990550036346, 'f1-score': 0.32258748674443266, 'support': 12381}, 'accuracy': 0.38261910728705484, 'macro avg': {'precision': 0.4096227677367097, 'recall': 0.3858721082069996, 'f1-score': 0.37310979350256, 'support': 35913}, 'weighted avg': {'precision': 0.41094212987165346, 'recall': 0.38261910728705484, 'f1-score': 0.37205680483334325, 'support': 35913}}
[[3916 6539 1432]
 [2857 6783 2005]
 [2479 6860 3042]]
training model: results/PCAR/W10/deepLOB_L2/h30
Epoch 1/50
428/428 - 22s - loss: 3.3338 - accuracy30: 0.3545 - val_loss: 3.4088 - val_accuracy30: 0.3269 - 22s/epoch - 52ms/step
Epoch 2/50
428/428 - 20s - loss: 3.2786 - accuracy30: 0.3762 - val_loss: 3.3815 - val_accuracy30: 0.3382 - 20s/epoch - 47ms/step
Epoch 3/50
428/428 - 20s - loss: 3.2470 - accuracy30: 0.3953 - val_loss: 3.3628 - val_accuracy30: 0.3471 - 20s/epoch - 47ms/step
Epoch 4/50
428/428 - 21s - loss: 3.2217 - accuracy30: 0.4110 - val_loss: 3.3412 - val_accuracy30: 0.3614 - 21s/epoch - 49ms/step
Epoch 5/50
428/428 - 21s - loss: 3.2099 - accuracy30: 0.4160 - val_loss: 3.3272 - val_accuracy30: 0.3708 - 21s/epoch - 49ms/step
Epoch 6/50
428/428 - 21s - loss: 3.1972 - accuracy30: 0.4244 - val_loss: 3.3213 - val_accuracy30: 0.3801 - 21s/epoch - 48ms/step
Epoch 7/50
428/428 - 21s - loss: 3.1887 - accuracy30: 0.4273 - val_loss: 3.3105 - val_accuracy30: 0.3820 - 21s/epoch - 48ms/step
Epoch 8/50
428/428 - 21s - loss: 3.1815 - accuracy30: 0.4312 - val_loss: 3.3015 - val_accuracy30: 0.3818 - 21s/epoch - 48ms/step
Epoch 9/50
428/428 - 20s - loss: 3.1717 - accuracy30: 0.4360 - val_loss: 3.3184 - val_accuracy30: 0.3757 - 20s/epoch - 48ms/step
Epoch 10/50
428/428 - 20s - loss: 3.1639 - accuracy30: 0.4366 - val_loss: 3.3052 - val_accuracy30: 0.3833 - 20s/epoch - 48ms/step
Epoch 11/50
428/428 - 21s - loss: 3.1595 - accuracy30: 0.4405 - val_loss: 3.3008 - val_accuracy30: 0.3883 - 21s/epoch - 48ms/step
Epoch 12/50
428/428 - 21s - loss: 3.1534 - accuracy30: 0.4425 - val_loss: 3.3266 - val_accuracy30: 0.3816 - 21s/epoch - 48ms/step
Epoch 13/50
428/428 - 21s - loss: 3.1457 - accuracy30: 0.4456 - val_loss: 3.3136 - val_accuracy30: 0.3820 - 21s/epoch - 48ms/step
Epoch 14/50
428/428 - 21s - loss: 3.1399 - accuracy30: 0.4476 - val_loss: 3.3297 - val_accuracy30: 0.3771 - 21s/epoch - 48ms/step
Epoch 15/50
428/428 - 21s - loss: 3.1330 - accuracy30: 0.4483 - val_loss: 3.3082 - val_accuracy30: 0.3856 - 21s/epoch - 48ms/step
Epoch 16/50
428/428 - 21s - loss: 3.1257 - accuracy30: 0.4521 - val_loss: 3.3386 - val_accuracy30: 0.3784 - 21s/epoch - 48ms/step
Epoch 17/50
428/428 - 21s - loss: 3.1189 - accuracy30: 0.4547 - val_loss: 3.3561 - val_accuracy30: 0.3782 - 21s/epoch - 49ms/step
Epoch 18/50
428/428 - 21s - loss: 3.1112 - accuracy30: 0.4573 - val_loss: 3.3535 - val_accuracy30: 0.3831 - 21s/epoch - 48ms/step
Epoch 19/50
428/428 - 20s - loss: 3.1042 - accuracy30: 0.4601 - val_loss: 3.3449 - val_accuracy30: 0.3816 - 20s/epoch - 48ms/step
Epoch 20/50
428/428 - 20s - loss: 3.0976 - accuracy30: 0.4614 - val_loss: 3.3730 - val_accuracy30: 0.3738 - 20s/epoch - 47ms/step
Epoch 21/50
428/428 - 20s - loss: 3.0930 - accuracy30: 0.4625 - val_loss: 3.3643 - val_accuracy30: 0.3804 - 20s/epoch - 47ms/step
testing model: results/PCAR/W10/deepLOB_L2/h30
Evaluating performance on  test set...
2104/2104 - 39s - 39s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1237721
{'0': {'precision': 0.45610185397009184, 'recall': 0.4613205141524135, 'f1-score': 0.45869634116279884, 'support': 211766}, '1': {'precision': 0.23800306192478926, 'recall': 0.4610062035585248, 'f1-score': 0.31393257122961765, 'support': 117352}, '2': {'precision': 0.49014052583862194, 'recall': 0.22715010766652502, 'f1-score': 0.31043336693778606, 'support': 209443}, 'accuracy': 0.3701846216120365, 'macro avg': {'precision': 0.39474848057783435, 'recall': 0.3831589417924877, 'f1-score': 0.36102075977673415, 'support': 538561}, 'weighted avg': {'precision': 0.4218157324500787, 'recall': 0.3701846216120365, 'f1-score': 0.369493892341202, 'support': 538561}}
[[97692 84464 29610]
 [43373 54100 19879]
 [73124 88744 47575]]
Evaluating performance on  train set...
428/428 - 8s - 8s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0865793
{'0': {'precision': 0.4187469719764388, 'recall': 0.45397246641234035, 'f1-score': 0.4356488174981099, 'support': 36174}, '1': {'precision': 0.37567552714016156, 'recall': 0.5646977832851439, 'f1-score': 0.451189192757035, 'support': 36315}, '2': {'precision': 0.47654557042702356, 'recall': 0.20205377651668693, 'f1-score': 0.28378404023152104, 'support': 37005}, 'accuracy': 0.4055564688476081, 'macro avg': {'precision': 0.42365602318120793, 'recall': 0.40690800873805705, 'f1-score': 0.390207350162222, 'support': 109494}, 'weighted avg': {'precision': 0.42399563963342896, 'recall': 0.4055564688476081, 'f1-score': 0.3894781838997186, 'support': 109494}}
[[16422 15895  3857]
 [11452 20507  4356]
 [11343 18185  7477]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1012042
{'0': {'precision': 0.3886335370140053, 'recall': 0.6027339818852734, 'f1-score': 0.47256468422263864, 'support': 11924}, '1': {'precision': 0.3556495769039323, 'recall': 0.37116883116883115, 'f1-score': 0.3632435180477885, 'support': 11550}, '2': {'precision': 0.46310100633619083, 'recall': 0.19977490151941474, 'f1-score': 0.2791350744172985, 'support': 12439}, 'accuracy': 0.3886893325536714, 'macro avg': {'precision': 0.40246137341804283, 'recall': 0.39122590485783976, 'f1-score': 0.37164775889590856, 'support': 35913}, 'weighted avg': {'precision': 0.4038184592323475, 'recall': 0.3886893325536714, 'f1-score': 0.3704086297106751, 'support': 35913}}
[[7187 3463 1274]
 [5656 4287 1607]
 [5650 4304 2485]]
training model: results/PCAR/W10/deepLOB_L2/h50
Epoch 1/50
428/428 - 22s - loss: 3.3417 - accuracy50: 0.3522 - val_loss: 3.3522 - val_accuracy50: 0.3421 - 22s/epoch - 52ms/step
Epoch 2/50
428/428 - 20s - loss: 3.2895 - accuracy50: 0.3741 - val_loss: 3.3702 - val_accuracy50: 0.3282 - 20s/epoch - 47ms/step
Epoch 3/50
428/428 - 20s - loss: 3.2635 - accuracy50: 0.3903 - val_loss: 3.3658 - val_accuracy50: 0.3549 - 20s/epoch - 48ms/step
Epoch 4/50
428/428 - 21s - loss: 3.2379 - accuracy50: 0.4070 - val_loss: 3.3590 - val_accuracy50: 0.3641 - 21s/epoch - 48ms/step
Epoch 5/50
428/428 - 21s - loss: 3.2199 - accuracy50: 0.4170 - val_loss: 3.3619 - val_accuracy50: 0.3675 - 21s/epoch - 48ms/step
Epoch 6/50
428/428 - 21s - loss: 3.2050 - accuracy50: 0.4244 - val_loss: 3.3432 - val_accuracy50: 0.3602 - 21s/epoch - 48ms/step
Epoch 7/50
428/428 - 20s - loss: 3.1973 - accuracy50: 0.4289 - val_loss: 3.3435 - val_accuracy50: 0.3662 - 20s/epoch - 47ms/step
Epoch 8/50
428/428 - 20s - loss: 3.1904 - accuracy50: 0.4316 - val_loss: 3.3362 - val_accuracy50: 0.3686 - 20s/epoch - 47ms/step
Epoch 9/50
428/428 - 20s - loss: 3.1801 - accuracy50: 0.4362 - val_loss: 3.3392 - val_accuracy50: 0.3655 - 20s/epoch - 47ms/step
Epoch 10/50
428/428 - 20s - loss: 3.1744 - accuracy50: 0.4389 - val_loss: 3.3301 - val_accuracy50: 0.3681 - 20s/epoch - 47ms/step
Epoch 11/50
428/428 - 21s - loss: 3.1673 - accuracy50: 0.4417 - val_loss: 3.3355 - val_accuracy50: 0.3648 - 21s/epoch - 48ms/step
Epoch 12/50
428/428 - 20s - loss: 3.1595 - accuracy50: 0.4457 - val_loss: 3.3224 - val_accuracy50: 0.3701 - 20s/epoch - 48ms/step
Epoch 13/50
428/428 - 20s - loss: 3.1522 - accuracy50: 0.4467 - val_loss: 3.3390 - val_accuracy50: 0.3689 - 20s/epoch - 47ms/step
Epoch 14/50
428/428 - 20s - loss: 3.1444 - accuracy50: 0.4501 - val_loss: 3.3493 - val_accuracy50: 0.3659 - 20s/epoch - 47ms/step
Epoch 15/50
428/428 - 20s - loss: 3.1378 - accuracy50: 0.4522 - val_loss: 3.3629 - val_accuracy50: 0.3666 - 20s/epoch - 47ms/step
Epoch 16/50
428/428 - 20s - loss: 3.1292 - accuracy50: 0.4563 - val_loss: 3.3905 - val_accuracy50: 0.3598 - 20s/epoch - 48ms/step
Epoch 17/50
428/428 - 21s - loss: 3.1236 - accuracy50: 0.4569 - val_loss: 3.3998 - val_accuracy50: 0.3613 - 21s/epoch - 49ms/step
Epoch 18/50
428/428 - 21s - loss: 3.1152 - accuracy50: 0.4589 - val_loss: 3.4081 - val_accuracy50: 0.3624 - 21s/epoch - 48ms/step
Epoch 19/50
428/428 - 21s - loss: 3.1066 - accuracy50: 0.4642 - val_loss: 3.4260 - val_accuracy50: 0.3591 - 21s/epoch - 49ms/step
Epoch 20/50
428/428 - 20s - loss: 3.1004 - accuracy50: 0.4654 - val_loss: 3.4245 - val_accuracy50: 0.3626 - 20s/epoch - 48ms/step
Epoch 21/50
428/428 - 20s - loss: 3.0912 - accuracy50: 0.4671 - val_loss: 3.4171 - val_accuracy50: 0.3667 - 20s/epoch - 48ms/step
Epoch 22/50
428/428 - 20s - loss: 3.0806 - accuracy50: 0.4707 - val_loss: 3.4762 - val_accuracy50: 0.3606 - 20s/epoch - 48ms/step
testing model: results/PCAR/W10/deepLOB_L2/h50
Evaluating performance on  test set...
2104/2104 - 39s - 39s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1393535
{'0': {'precision': 0.4524130857266249, 'recall': 0.30319639659195746, 'f1-score': 0.36307119106672875, 'support': 221124}, '1': {'precision': 0.1746374590299229, 'recall': 0.3817156640415619, 'f1-score': 0.23963864270992083, 'support': 97012}, '2': {'precision': 0.4389257755546085, 'recall': 0.3550913008959964, 'f1-score': 0.3925828027154927, 'support': 220425}, 'accuracy': 0.338580030860014, 'macro avg': {'precision': 0.35532544010371875, 'recall': 0.3466677871765052, 'f1-score': 0.3317642121640474, 'support': 538561}, 'weighted avg': {'precision': 0.39685668739520624, 'recall': 0.338580030860014, 'f1-score': 0.35291571864389853, 'support': 538561}}
[[67044 87100 66980]
 [26908 37031 33073]
 [54240 87914 78271]]
Evaluating performance on  train set...
428/428 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0887656
{'0': {'precision': 0.4265633517638813, 'recall': 0.299669010039117, 'f1-score': 0.3520300776040746, 'support': 36557}, '1': {'precision': 0.3779864834851033, 'recall': 0.6578496880004417, 'f1-score': 0.4801112320154757, 'support': 36218}, '2': {'precision': 0.41774954278563864, 'recall': 0.23638987989869006, 'f1-score': 0.30192879628502356, 'support': 36719}, 'accuracy': 0.3969258589511754, 'macro avg': {'precision': 0.4074331260115411, 'recall': 0.39796952597941626, 'f1-score': 0.37802336863485797, 'support': 109494}, 'weighted avg': {'precision': 0.40753955806566156, 'recall': 0.3969258589511754, 'f1-score': 0.3775947140381979, 'support': 109494}}
[[10955 19025  6577]
 [ 6871 23826  5521]
 [ 7856 20183  8680]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1100874
{'0': {'precision': 0.3777680525164114, 'recall': 0.35808512403550985, 'f1-score': 0.3676633444075305, 'support': 12053}, '1': {'precision': 0.3461196494347771, 'recall': 0.4820022994605112, 'f1-score': 0.4029128007984327, 'support': 11307}, '2': {'precision': 0.3914436055822466, 'recall': 0.2726041583685175, 'f1-score': 0.321389997652031, 'support': 12553}, 'accuracy': 0.36722078356027066, 'macro avg': {'precision': 0.371777102511145, 'recall': 0.3708971939548462, 'f1-score': 0.36398871428599805, 'support': 35913}, 'weighted avg': {'precision': 0.3725838775377516, 'recall': 0.36722078356027066, 'f1-score': 0.3625870846016147, 'support': 35913}}
[[4316 4970 2767]
 [3304 5450 2553]
 [3805 5326 3422]]
training model: results/PCAR/W10/deepLOB_L2/h100
Epoch 1/50
428/428 - 23s - loss: 3.3419 - accuracy100: 0.3506 - val_loss: 3.4388 - val_accuracy100: 0.3195 - 23s/epoch - 53ms/step
Epoch 2/50
428/428 - 21s - loss: 3.3004 - accuracy100: 0.3618 - val_loss: 3.4035 - val_accuracy100: 0.3185 - 21s/epoch - 48ms/step
Epoch 3/50
428/428 - 20s - loss: 3.2827 - accuracy100: 0.3718 - val_loss: 3.3964 - val_accuracy100: 0.3324 - 20s/epoch - 48ms/step
Epoch 4/50
428/428 - 20s - loss: 3.2681 - accuracy100: 0.3802 - val_loss: 3.3924 - val_accuracy100: 0.3359 - 20s/epoch - 48ms/step
Epoch 5/50
428/428 - 20s - loss: 3.2568 - accuracy100: 0.3910 - val_loss: 3.4393 - val_accuracy100: 0.3322 - 20s/epoch - 48ms/step
Epoch 6/50
428/428 - 20s - loss: 3.2491 - accuracy100: 0.3933 - val_loss: 3.4075 - val_accuracy100: 0.3435 - 20s/epoch - 47ms/step
Epoch 7/50
428/428 - 20s - loss: 3.2406 - accuracy100: 0.4003 - val_loss: 3.3871 - val_accuracy100: 0.3505 - 20s/epoch - 48ms/step
Epoch 8/50
428/428 - 20s - loss: 3.2330 - accuracy100: 0.4045 - val_loss: 3.4317 - val_accuracy100: 0.3475 - 20s/epoch - 47ms/step
Epoch 9/50
428/428 - 20s - loss: 3.2239 - accuracy100: 0.4114 - val_loss: 3.4016 - val_accuracy100: 0.3533 - 20s/epoch - 48ms/step
Epoch 10/50
428/428 - 20s - loss: 3.2151 - accuracy100: 0.4148 - val_loss: 3.3985 - val_accuracy100: 0.3513 - 20s/epoch - 47ms/step
Epoch 11/50
428/428 - 20s - loss: 3.2080 - accuracy100: 0.4184 - val_loss: 3.4033 - val_accuracy100: 0.3528 - 20s/epoch - 48ms/step
Epoch 12/50
428/428 - 20s - loss: 3.1998 - accuracy100: 0.4225 - val_loss: 3.3953 - val_accuracy100: 0.3526 - 20s/epoch - 48ms/step
Epoch 13/50
428/428 - 20s - loss: 3.1929 - accuracy100: 0.4249 - val_loss: 3.3999 - val_accuracy100: 0.3577 - 20s/epoch - 47ms/step
Epoch 14/50
428/428 - 20s - loss: 3.1868 - accuracy100: 0.4288 - val_loss: 3.3814 - val_accuracy100: 0.3583 - 20s/epoch - 48ms/step
Epoch 15/50
428/428 - 21s - loss: 3.1798 - accuracy100: 0.4321 - val_loss: 3.4013 - val_accuracy100: 0.3551 - 21s/epoch - 48ms/step
Epoch 16/50
428/428 - 21s - loss: 3.1709 - accuracy100: 0.4352 - val_loss: 3.4149 - val_accuracy100: 0.3522 - 21s/epoch - 48ms/step
Epoch 17/50
428/428 - 20s - loss: 3.1633 - accuracy100: 0.4376 - val_loss: 3.4352 - val_accuracy100: 0.3459 - 20s/epoch - 48ms/step
Epoch 18/50
428/428 - 20s - loss: 3.1532 - accuracy100: 0.4423 - val_loss: 3.4011 - val_accuracy100: 0.3485 - 20s/epoch - 47ms/step
Epoch 19/50
428/428 - 20s - loss: 3.1470 - accuracy100: 0.4451 - val_loss: 3.4187 - val_accuracy100: 0.3482 - 20s/epoch - 47ms/step
Epoch 20/50
428/428 - 20s - loss: 3.1392 - accuracy100: 0.4466 - val_loss: 3.4222 - val_accuracy100: 0.3493 - 20s/epoch - 48ms/step
Epoch 21/50
428/428 - 21s - loss: 3.1302 - accuracy100: 0.4513 - val_loss: 3.4228 - val_accuracy100: 0.3509 - 21s/epoch - 48ms/step
Epoch 22/50
428/428 - 20s - loss: 3.1214 - accuracy100: 0.4548 - val_loss: 3.4220 - val_accuracy100: 0.3492 - 20s/epoch - 48ms/step
Epoch 23/50
428/428 - 21s - loss: 3.1129 - accuracy100: 0.4581 - val_loss: 3.4396 - val_accuracy100: 0.3511 - 21s/epoch - 50ms/step
Epoch 24/50
428/428 - 21s - loss: 3.1039 - accuracy100: 0.4613 - val_loss: 3.4807 - val_accuracy100: 0.3429 - 21s/epoch - 48ms/step
testing model: results/PCAR/W10/deepLOB_L2/h100
Evaluating performance on  test set...
2104/2104 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1570674
{'0': {'precision': 0.412883152262645, 'recall': 0.4248025033835994, 'f1-score': 0.41875802815502056, 'support': 208358}, '1': {'precision': 0.24761722999408364, 'recall': 0.5239175907156298, 'f1-score': 0.33629337024307554, 'support': 123821}, '2': {'precision': 0.40845296850634216, 'recall': 0.12310666627903596, 'f1-score': 0.18919150362082765, 'support': 206382}, 'accuracy': 0.3319772504878742, 'macro avg': {'precision': 0.35631778358769023, 'recall': 0.35727558679275506, 'f1-score': 0.31474763400630795, 'support': 538561}, 'weighted avg': {'precision': 0.3731890378629599, 'recall': 0.3319772504878742, 'f1-score': 0.31182630663465283, 'support': 538561}}
[[88511 97412 22435]
 [44588 64872 14361]
 [81274 99701 25407]]
Evaluating performance on  train set...
428/428 - 8s - 8s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1246624
{'0': {'precision': 0.37053599948891586, 'recall': 0.4786531690140845, 'f1-score': 0.4177119468017428, 'support': 36352}, '1': {'precision': 0.36214398011041643, 'recall': 0.5428884625924911, 'f1-score': 0.43446793578384074, 'support': 36490}, '2': {'precision': 0.3935912166475169, 'recall': 0.0841154643675652, 'f1-score': 0.13860851972575025, 'support': 36652}, 'accuracy': 0.3679927667269439, 'macro avg': {'precision': 0.3754237320822831, 'recall': 0.3685523653247136, 'f1-score': 0.3302628007704446, 'support': 109494}, 'weighted avg': {'precision': 0.3754567716972158, 'recall': 0.3679927667269439, 'f1-score': 0.329869025991173, 'support': 109494}}
[[17400 16277  2675]
 [14605 19810  2075]
 [14954 18615  3083]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1281809
{'0': {'precision': 0.3567906768265352, 'recall': 0.5916260632587331, 'f1-score': 0.4451348328569653, 'support': 12109}, '1': {'precision': 0.33084972791963163, 'recall': 0.35075885328836426, 'f1-score': 0.3405135274857832, 'support': 11267}, '2': {'precision': 0.41578812033941887, 'recall': 0.12897822445561138, 'f1-score': 0.1968829903811031, 'support': 12537}, 'accuracy': 0.3545512766964609, 'macro avg': {'precision': 0.36780950836186194, 'recall': 0.35712104700090297, 'f1-score': 0.32751045024128383, 'support': 35913}, 'weighted avg': {'precision': 0.3692478449268593, 'recall': 0.3545512766964609, 'f1-score': 0.32564880838847216, 'support': 35913}}
[[7164 3731 1214]
 [6257 3952 1058]
 [6658 4262 1617]]
training model: results/PCAR/W10/deepLOB_L2/h200
Epoch 1/50
428/428 - 23s - loss: 3.3299 - accuracy200: 0.3593 - val_loss: 3.4636 - val_accuracy200: 0.3346 - 23s/epoch - 54ms/step
Epoch 2/50
428/428 - 20s - loss: 3.2955 - accuracy200: 0.3678 - val_loss: 3.5060 - val_accuracy200: 0.3442 - 20s/epoch - 47ms/step
Epoch 3/50
428/428 - 20s - loss: 3.2729 - accuracy200: 0.3804 - val_loss: 3.4958 - val_accuracy200: 0.3453 - 20s/epoch - 47ms/step
Epoch 4/50
428/428 - 20s - loss: 3.2583 - accuracy200: 0.3932 - val_loss: 3.4367 - val_accuracy200: 0.3445 - 20s/epoch - 47ms/step
Epoch 5/50
428/428 - 20s - loss: 3.2432 - accuracy200: 0.4020 - val_loss: 3.5178 - val_accuracy200: 0.3443 - 20s/epoch - 47ms/step
Epoch 6/50
428/428 - 20s - loss: 3.2289 - accuracy200: 0.4094 - val_loss: 3.4714 - val_accuracy200: 0.3469 - 20s/epoch - 48ms/step
Epoch 7/50
428/428 - 20s - loss: 3.2203 - accuracy200: 0.4130 - val_loss: 3.5093 - val_accuracy200: 0.3502 - 20s/epoch - 48ms/step
Epoch 8/50
428/428 - 20s - loss: 3.2103 - accuracy200: 0.4165 - val_loss: 3.4871 - val_accuracy200: 0.3494 - 20s/epoch - 47ms/step
Epoch 9/50
428/428 - 20s - loss: 3.2023 - accuracy200: 0.4221 - val_loss: 3.5135 - val_accuracy200: 0.3425 - 20s/epoch - 48ms/step
Epoch 10/50
428/428 - 21s - loss: 3.1916 - accuracy200: 0.4253 - val_loss: 3.5149 - val_accuracy200: 0.3505 - 21s/epoch - 48ms/step
Epoch 11/50
428/428 - 21s - loss: 3.1819 - accuracy200: 0.4311 - val_loss: 3.4967 - val_accuracy200: 0.3505 - 21s/epoch - 48ms/step
Epoch 12/50
428/428 - 21s - loss: 3.1752 - accuracy200: 0.4351 - val_loss: 3.4784 - val_accuracy200: 0.3521 - 21s/epoch - 49ms/step
Epoch 13/50
428/428 - 21s - loss: 3.1655 - accuracy200: 0.4402 - val_loss: 3.4977 - val_accuracy200: 0.3511 - 21s/epoch - 48ms/step
Epoch 14/50
428/428 - 20s - loss: 3.1541 - accuracy200: 0.4444 - val_loss: 3.5366 - val_accuracy200: 0.3530 - 20s/epoch - 48ms/step
testing model: results/PCAR/W10/deepLOB_L2/h200
Evaluating performance on  test set...
2104/2104 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1651225
{'0': {'precision': 0.40583908598237817, 'recall': 0.2740781035272561, 'f1-score': 0.32719163080288355, 'support': 209568}, '1': {'precision': 0.24192759950715165, 'recall': 0.5776724255094617, 'f1-score': 0.34103196422461096, 'support': 125083}, '2': {'precision': 0.39765148434322894, 'recall': 0.19181501642881663, 'f1-score': 0.2587951169484236, 'support': 203910}, 'accuracy': 0.31344267408891474, 'macro avg': {'precision': 0.3484727232775862, 'recall': 0.34785518182184477, 'f1-score': 0.309006237325306, 'support': 538561}, 'weighted avg': {'precision': 0.36466998106572124, 'recall': 0.31344267408891474, 'f1-score': 0.30450981256006054, 'support': 538561}}
[[ 57438 116083  36047]
 [ 29626  72257  23200]
 [ 54465 110332  39113]]
Evaluating performance on  train set...
428/428 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1406912
{'0': {'precision': 0.355104837604495, 'recall': 0.3544539286495951, 'f1-score': 0.35477908457357227, 'support': 36552}, '1': {'precision': 0.35426650117051867, 'recall': 0.6233550812783368, 'f1-score': 0.45177771766898095, 'support': 36172}, '2': {'precision': 0.391689809869686, 'recall': 0.09972803916236062, 'f1-score': 0.15897858319604613, 'support': 36770}, 'accuracy': 0.3577456298975286, 'macro avg': {'precision': 0.3670203828815666, 'recall': 0.3591790163634309, 'f1-score': 0.3218451284795331, 'support': 109494}, 'weighted avg': {'precision': 0.36711376160673515, 'recall': 0.3577456298975286, 'f1-score': 0.3210699326627414, 'support': 109494}}
[[12956 20241  3355]
 [11284 22548  2340]
 [12245 20858  3667]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1497923
{'0': {'precision': 0.35098749402036494, 'recall': 0.4209491025325793, 'f1-score': 0.3827979429082507, 'support': 12201}, '1': {'precision': 0.31880945075176437, 'recall': 0.4718866382051049, 'f1-score': 0.3805303252270729, 'support': 11009}, '2': {'precision': 0.3933801404212638, 'recall': 0.15437298275997796, 'f1-score': 0.22173224785165083, 'support': 12703}, 'accuracy': 0.34227160081307606, 'macro avg': {'precision': 0.35439236173113103, 'recall': 0.3490695744992207, 'f1-score': 0.3283535053289915, 'support': 35913}, 'weighted avg': {'precision': 0.35611838558850445, 'recall': 0.34227160081307606, 'f1-score': 0.3251313116784433, 'support': 35913}}
[[5136 5454 1611]
 [4401 5195 1413]
 [5096 5646 1961]]
training model: results/PCAR/W10/deepLOB_L2/h300
Epoch 1/50
428/428 - 23s - loss: 3.3378 - accuracy300: 0.3549 - val_loss: 3.5052 - val_accuracy300: 0.3082 - 23s/epoch - 53ms/step
Epoch 2/50
428/428 - 20s - loss: 3.2923 - accuracy300: 0.3744 - val_loss: 3.4182 - val_accuracy300: 0.3207 - 20s/epoch - 48ms/step
Epoch 3/50
428/428 - 21s - loss: 3.2702 - accuracy300: 0.3842 - val_loss: 3.4545 - val_accuracy300: 0.3191 - 21s/epoch - 48ms/step
Epoch 4/50
428/428 - 20s - loss: 3.2582 - accuracy300: 0.3938 - val_loss: 3.4688 - val_accuracy300: 0.3369 - 20s/epoch - 48ms/step
Epoch 5/50
428/428 - 21s - loss: 3.2454 - accuracy300: 0.3993 - val_loss: 3.4833 - val_accuracy300: 0.3295 - 21s/epoch - 48ms/step
Epoch 6/50
428/428 - 20s - loss: 3.2394 - accuracy300: 0.4039 - val_loss: 3.4779 - val_accuracy300: 0.3306 - 20s/epoch - 48ms/step
Epoch 7/50
428/428 - 20s - loss: 3.2246 - accuracy300: 0.4129 - val_loss: 3.4843 - val_accuracy300: 0.3427 - 20s/epoch - 48ms/step
Epoch 8/50
428/428 - 20s - loss: 3.2217 - accuracy300: 0.4136 - val_loss: 3.4714 - val_accuracy300: 0.3343 - 20s/epoch - 47ms/step
Epoch 9/50
428/428 - 20s - loss: 3.2107 - accuracy300: 0.4201 - val_loss: 3.5521 - val_accuracy300: 0.3272 - 20s/epoch - 47ms/step
Epoch 10/50
428/428 - 20s - loss: 3.2071 - accuracy300: 0.4227 - val_loss: 3.5268 - val_accuracy300: 0.3384 - 20s/epoch - 47ms/step
Epoch 11/50
428/428 - 20s - loss: 3.1974 - accuracy300: 0.4281 - val_loss: 3.5899 - val_accuracy300: 0.3258 - 20s/epoch - 47ms/step
Epoch 12/50
428/428 - 20s - loss: 3.1857 - accuracy300: 0.4313 - val_loss: 3.5694 - val_accuracy300: 0.3261 - 20s/epoch - 48ms/step
testing model: results/PCAR/W10/deepLOB_L2/h300
Evaluating performance on  test set...
2104/2104 - 39s - 39s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1493928
{'0': {'precision': 0.39099037138927095, 'recall': 0.24258932635411926, 'f1-score': 0.29941013307117026, 'support': 210912}, '1': {'precision': 0.23534906641251138, 'recall': 0.6908086628253527, 'f1-score': 0.3510874416594467, 'support': 125825}, '2': {'precision': 0.38313397440908975, 'recall': 0.07284564769303949, 'f1-score': 0.12241618338280662, 'support': 201824}, 'accuracy': 0.28369674001645123, 'macro avg': {'precision': 0.3364911374036241, 'recall': 0.33541454562417045, 'f1-score': 0.25763791937114117, 'support': 538561}, 'weighted avg': {'precision': 0.351683446708819, 'recall': 0.28369674001645123, 'f1-score': 0.24515568548067554, 'support': 538561}}
[[ 51165 144575  15172]
 [ 30405  86921   8499]
 [ 49290 137832  14702]]
Evaluating performance on  train set...
428/428 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1268272
{'0': {'precision': 0.35192043170034915, 'recall': 0.18130280730444262, 'f1-score': 0.23931500935386385, 'support': 36690}, '1': {'precision': 0.33969460922116684, 'recall': 0.7663937861473554, 'f1-score': 0.47073966020250557, 'support': 35791}, '2': {'precision': 0.34481357309763283, 'recall': 0.09169751168508362, 'f1-score': 0.14486938705822094, 'support': 37013}, 'accuracy': 0.34226532960710176, 'macro avg': {'precision': 0.34547620467304957, 'recall': 0.3464647017122939, 'f1-score': 0.28497468553819677, 'support': 109494}, 'weighted avg': {'precision': 0.3455217197178227, 'recall': 0.34226532960710176, 'f1-score': 0.2830361617502975, 'support': 109494}}
[[ 6652 26527  3511]
 [ 5423 27430  2938]
 [ 6827 26792  3394]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1426514
{'0': {'precision': 0.3432885533473965, 'recall': 0.25475817747384033, 'f1-score': 0.2924706772606886, 'support': 12137}, '1': {'precision': 0.3123874242672343, 'recall': 0.6930971843778383, 'f1-score': 0.43066764490095377, 'support': 11010}, '2': {'precision': 0.36803874092009686, 'recall': 0.07143976186746044, 'f1-score': 0.11965363421674101, 'support': 12766}, 'accuracy': 0.32397738980313534, 'macro avg': {'precision': 0.3412382395115759, 'recall': 0.339765041239713, 'f1-score': 0.2809306521261278, 'support': 35913}, 'weighted avg': {'precision': 0.34261301700625285, 'recall': 0.32397738980313534, 'f1-score': 0.27340700233017, 'support': 35913}}
[[3092 8197  848]
 [2661 7631  718]
 [3254 8600  912]]
training model: results/PCAR/W10/deepLOB_L2/h500
Epoch 1/50
428/428 - 22s - loss: 3.3427 - accuracy500: 0.3568 - val_loss: 3.4256 - val_accuracy500: 0.3186 - 22s/epoch - 52ms/step
Epoch 2/50
428/428 - 20s - loss: 3.2990 - accuracy500: 0.3713 - val_loss: 3.4740 - val_accuracy500: 0.3233 - 20s/epoch - 48ms/step
Epoch 3/50
428/428 - 20s - loss: 3.2742 - accuracy500: 0.3845 - val_loss: 3.4835 - val_accuracy500: 0.3257 - 20s/epoch - 47ms/step
Epoch 4/50
428/428 - 20s - loss: 3.2500 - accuracy500: 0.3993 - val_loss: 3.5788 - val_accuracy500: 0.3249 - 20s/epoch - 47ms/step
Epoch 5/50
428/428 - 20s - loss: 3.2315 - accuracy500: 0.4099 - val_loss: 3.5664 - val_accuracy500: 0.3242 - 20s/epoch - 47ms/step
Epoch 6/50
428/428 - 20s - loss: 3.2238 - accuracy500: 0.4128 - val_loss: 3.5921 - val_accuracy500: 0.3351 - 20s/epoch - 47ms/step
Epoch 7/50
428/428 - 20s - loss: 3.2239 - accuracy500: 0.4140 - val_loss: 3.5433 - val_accuracy500: 0.3216 - 20s/epoch - 47ms/step
Epoch 8/50
428/428 - 20s - loss: 3.2167 - accuracy500: 0.4161 - val_loss: 3.6905 - val_accuracy500: 0.3214 - 20s/epoch - 47ms/step
Epoch 9/50
428/428 - 20s - loss: 3.2065 - accuracy500: 0.4225 - val_loss: 3.7006 - val_accuracy500: 0.3282 - 20s/epoch - 47ms/step
Epoch 10/50
428/428 - 20s - loss: 3.1960 - accuracy500: 0.4262 - val_loss: 3.7319 - val_accuracy500: 0.3277 - 20s/epoch - 47ms/step
Epoch 11/50
428/428 - 20s - loss: 3.1823 - accuracy500: 0.4325 - val_loss: 3.6404 - val_accuracy500: 0.3365 - 20s/epoch - 48ms/step
testing model: results/PCAR/W10/deepLOB_L2/h500
Evaluating performance on  test set...
2104/2104 - 41s - 41s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.152097
{'0': {'precision': 0.39270160684787503, 'recall': 0.27831665110518755, 'f1-score': 0.32575982786200647, 'support': 206707}, '1': {'precision': 0.24021589573341676, 'recall': 0.6047192677947439, 'f1-score': 0.3438445619282808, 'support': 130783}, '2': {'precision': 0.3838771287601464, 'recall': 0.11995265354029173, 'f1-score': 0.1827882425606572, 'support': 201071}, 'accuracy': 0.29845458546014286, 'macro avg': {'precision': 0.3389315437804794, 'recall': 0.33432952414674105, 'f1-score': 0.2841308774503148, 'support': 538561}, 'weighted avg': {'precision': 0.3523776966682299, 'recall': 0.29845458546014286, 'f1-score': 0.27677324351457316, 'support': 538561}}
[[ 57530 126291  22886]
 [ 35871  79087  15825]
 [ 53097 123855  24119]]
Evaluating performance on  train set...
428/428 - 8s - 8s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1326045
{'0': {'precision': 0.33941020521716364, 'recall': 0.2852192089773915, 'f1-score': 0.3099639820059482, 'support': 36358}, '1': {'precision': 0.3367268131713824, 'recall': 0.665741254858412, 'f1-score': 0.44724203851354505, 'support': 36020}, '2': {'precision': 0.3655190266632151, 'recall': 0.07608578510615369, 'f1-score': 0.12595334730832702, 'support': 37116}, 'accuracy': 0.33950718760845344, 'macro avg': {'precision': 0.3472186816839204, 'recall': 0.34234874964731904, 'f1-score': 0.29438645594260676, 'support': 109494}, 'weighted avg': {'precision': 0.3473777580995372, 'recall': 0.33950718760845344, 'f1-score': 0.2927485809608383, 'support': 109494}}
[[10370 23488  2500]
 [ 9638 23980  2402]
 [10545 23747  2824]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.145528
{'0': {'precision': 0.33749873006197295, 'recall': 0.27113940581129614, 'f1-score': 0.30070151618013125, 'support': 12252}, '1': {'precision': 0.30564855352390763, 'recall': 0.6532428217594716, 'f1-score': 0.41644492529021315, 'support': 10901}, '2': {'precision': 0.3935786435786436, 'recall': 0.08550156739811912, 'f1-score': 0.14048416173062064, 'support': 12760}, 'accuracy': 0.3211650377300699, 'macro avg': {'precision': 0.3455753090548414, 'recall': 0.3366279316562956, 'f1-score': 0.285876867733655, 'support': 35913}, 'weighted avg': {'precision': 0.34775632263377887, 'recall': 0.3211650377300699, 'f1-score': 0.27890844570240025, 'support': 35913}}
[[3322 8049  881]
 [2980 7121  800]
 [3541 8128 1091]]
training model: results/PCAR/W10/deepLOB_L2/h1000
Epoch 1/50
428/428 - 23s - loss: 3.3469 - accuracy1000: 0.3651 - val_loss: 3.4859 - val_accuracy1000: 0.3334 - 23s/epoch - 54ms/step
Epoch 2/50
428/428 - 20s - loss: 3.2808 - accuracy1000: 0.3857 - val_loss: 3.4669 - val_accuracy1000: 0.3356 - 20s/epoch - 47ms/step
Epoch 3/50
428/428 - 20s - loss: 3.2474 - accuracy1000: 0.4037 - val_loss: 3.4707 - val_accuracy1000: 0.3349 - 20s/epoch - 47ms/step
Epoch 4/50
428/428 - 20s - loss: 3.2315 - accuracy1000: 0.4112 - val_loss: 3.4561 - val_accuracy1000: 0.3354 - 20s/epoch - 47ms/step
Epoch 5/50
428/428 - 20s - loss: 3.2134 - accuracy1000: 0.4172 - val_loss: 3.4680 - val_accuracy1000: 0.3396 - 20s/epoch - 47ms/step
Epoch 6/50
428/428 - 20s - loss: 3.1937 - accuracy1000: 0.4270 - val_loss: 3.5454 - val_accuracy1000: 0.3457 - 20s/epoch - 47ms/step
Epoch 7/50
428/428 - 20s - loss: 3.1733 - accuracy1000: 0.4368 - val_loss: 3.4541 - val_accuracy1000: 0.3542 - 20s/epoch - 48ms/step
Epoch 8/50
428/428 - 20s - loss: 3.1575 - accuracy1000: 0.4419 - val_loss: 3.5286 - val_accuracy1000: 0.3582 - 20s/epoch - 48ms/step
Epoch 9/50
428/428 - 20s - loss: 3.1498 - accuracy1000: 0.4455 - val_loss: 3.5057 - val_accuracy1000: 0.3517 - 20s/epoch - 47ms/step
Epoch 10/50
428/428 - 20s - loss: 3.1288 - accuracy1000: 0.4563 - val_loss: 3.5318 - val_accuracy1000: 0.3569 - 20s/epoch - 48ms/step
Epoch 11/50
428/428 - 20s - loss: 3.1152 - accuracy1000: 0.4594 - val_loss: 3.5565 - val_accuracy1000: 0.3570 - 20s/epoch - 48ms/step
Epoch 12/50
428/428 - 20s - loss: 3.1021 - accuracy1000: 0.4654 - val_loss: 3.5659 - val_accuracy1000: 0.3600 - 20s/epoch - 47ms/step
Epoch 13/50
428/428 - 20s - loss: 3.0880 - accuracy1000: 0.4689 - val_loss: 3.5412 - val_accuracy1000: 0.3564 - 20s/epoch - 47ms/step
Epoch 14/50
428/428 - 20s - loss: 3.0804 - accuracy1000: 0.4726 - val_loss: 3.5558 - val_accuracy1000: 0.3499 - 20s/epoch - 47ms/step
Epoch 15/50
428/428 - 20s - loss: 3.0694 - accuracy1000: 0.4762 - val_loss: 3.5501 - val_accuracy1000: 0.3518 - 20s/epoch - 47ms/step
Epoch 16/50
428/428 - 20s - loss: 3.0530 - accuracy1000: 0.4814 - val_loss: 3.5482 - val_accuracy1000: 0.3471 - 20s/epoch - 47ms/step
Epoch 17/50
428/428 - 20s - loss: 3.0419 - accuracy1000: 0.4840 - val_loss: 3.5385 - val_accuracy1000: 0.3679 - 20s/epoch - 47ms/step
testing model: results/PCAR/W10/deepLOB_L2/h1000
Evaluating performance on  test set...
2104/2104 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2068884
{'0': {'precision': 0.38846711905145753, 'recall': 0.25497703277939443, 'f1-score': 0.30787502867580224, 'support': 207905}, '1': {'precision': 0.22810433016118695, 'recall': 0.2943269050739562, 'f1-score': 0.2570184820595268, 'support': 128184}, '2': {'precision': 0.3619207354426048, 'recall': 0.42310541704531984, 'f1-score': 0.3901287192063264, 'support': 202472}, 'accuracy': 0.3275506395747186, 'macro avg': {'precision': 0.32616406155174976, 'recall': 0.3241364516328902, 'f1-score': 0.3183407433138851, 'support': 538561}, 'weighted avg': {'precision': 0.34031873267895363, 'recall': 0.3275506395747186, 'f1-score': 0.3266938322238417, 'support': 538561}}
[[53011 63749 91145]
 [30567 37728 59889]
 [52884 63921 85667]]
Evaluating performance on  train set...
428/428 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1342244
{'0': {'precision': 0.3532918939490042, 'recall': 0.38310223396060306, 'f1-score': 0.367593680292491, 'support': 36348}, '1': {'precision': 0.35781676912568305, 'recall': 0.45693179959657637, 'f1-score': 0.4013455598917806, 'support': 36686}, '2': {'precision': 0.38947957470621153, 'recall': 0.24816236972024136, 'f1-score': 0.30316128059506453, 'support': 36460}, 'accuracy': 0.36290572999433757, 'macro avg': {'precision': 0.3668627459269662, 'recall': 0.36273213442580693, 'f1-score': 0.3573668402597787, 'support': 109494}, 'weighted avg': {'precision': 0.36685795611806754, 'recall': 0.36290572999433757, 'f1-score': 0.35744715319521964, 'support': 109494}}
[[13925 15315  7108]
 [12848 16763  7075]
 [12642 14770  9048]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1525464
{'0': {'precision': 0.35258204019333506, 'recall': 0.3412112259970458, 'f1-score': 0.3468034530213937, 'support': 12186}, '1': {'precision': 0.3233881810615276, 'recall': 0.46565870747672167, 'f1-score': 0.3816972719715861, 'support': 10847}, '2': {'precision': 0.40359957652040934, 'recall': 0.26638198757763976, 'f1-score': 0.3209391515831813, 'support': 12880}, 'accuracy': 0.35196168518363824, 'macro avg': {'precision': 0.35985659925842395, 'recall': 0.35775064035046905, 'f1-score': 0.34981329219205365, 'support': 35913}, 'weighted avg': {'precision': 0.3620616180033203, 'recall': 0.35196168518363824, 'f1-score': 0.3480665346806414, 'support': 35913}}
[[4158 5329 2699]
 [3425 5051 2371]
 [4210 5239 3431]]
training model: results/PCAR/W10/deepOF_L2/h10
Epoch 1/50
428/428 - 15s - loss: 3.2906 - accuracy10: 0.3765 - val_loss: 3.2532 - val_accuracy10: 0.3927 - 15s/epoch - 36ms/step
Epoch 2/50
428/428 - 13s - loss: 3.2130 - accuracy10: 0.4133 - val_loss: 3.2126 - val_accuracy10: 0.4130 - 13s/epoch - 30ms/step
Epoch 3/50
428/428 - 13s - loss: 3.1729 - accuracy10: 0.4324 - val_loss: 3.2008 - val_accuracy10: 0.4221 - 13s/epoch - 30ms/step
Epoch 4/50
428/428 - 13s - loss: 3.1459 - accuracy10: 0.4457 - val_loss: 3.1903 - val_accuracy10: 0.4278 - 13s/epoch - 30ms/step
Epoch 5/50
428/428 - 13s - loss: 3.1253 - accuracy10: 0.4516 - val_loss: 3.1885 - val_accuracy10: 0.4280 - 13s/epoch - 29ms/step
Epoch 6/50
428/428 - 12s - loss: 3.1093 - accuracy10: 0.4581 - val_loss: 3.1876 - val_accuracy10: 0.4292 - 12s/epoch - 29ms/step
Epoch 7/50
428/428 - 13s - loss: 3.0943 - accuracy10: 0.4642 - val_loss: 3.1883 - val_accuracy10: 0.4293 - 13s/epoch - 29ms/step
Epoch 8/50
428/428 - 12s - loss: 3.0811 - accuracy10: 0.4700 - val_loss: 3.1825 - val_accuracy10: 0.4297 - 12s/epoch - 29ms/step
Epoch 9/50
428/428 - 13s - loss: 3.0684 - accuracy10: 0.4731 - val_loss: 3.1788 - val_accuracy10: 0.4333 - 13s/epoch - 29ms/step
Epoch 10/50
428/428 - 12s - loss: 3.0585 - accuracy10: 0.4787 - val_loss: 3.1833 - val_accuracy10: 0.4332 - 12s/epoch - 29ms/step
Epoch 11/50
428/428 - 12s - loss: 3.0472 - accuracy10: 0.4808 - val_loss: 3.1830 - val_accuracy10: 0.4314 - 12s/epoch - 29ms/step
Epoch 12/50
428/428 - 12s - loss: 3.0391 - accuracy10: 0.4830 - val_loss: 3.1789 - val_accuracy10: 0.4351 - 12s/epoch - 29ms/step
Epoch 13/50
428/428 - 12s - loss: 3.0284 - accuracy10: 0.4871 - val_loss: 3.1837 - val_accuracy10: 0.4354 - 12s/epoch - 29ms/step
Epoch 14/50
428/428 - 13s - loss: 3.0206 - accuracy10: 0.4898 - val_loss: 3.1767 - val_accuracy10: 0.4382 - 13s/epoch - 29ms/step
Epoch 15/50
428/428 - 13s - loss: 3.0129 - accuracy10: 0.4940 - val_loss: 3.1760 - val_accuracy10: 0.4401 - 13s/epoch - 29ms/step
Epoch 16/50
428/428 - 13s - loss: 3.0015 - accuracy10: 0.4967 - val_loss: 3.1843 - val_accuracy10: 0.4373 - 13s/epoch - 30ms/step
Epoch 17/50
428/428 - 13s - loss: 2.9963 - accuracy10: 0.4988 - val_loss: 3.1871 - val_accuracy10: 0.4374 - 13s/epoch - 30ms/step
Epoch 18/50
428/428 - 13s - loss: 2.9866 - accuracy10: 0.5015 - val_loss: 3.1879 - val_accuracy10: 0.4396 - 13s/epoch - 30ms/step
Epoch 19/50
428/428 - 13s - loss: 2.9770 - accuracy10: 0.5046 - val_loss: 3.1890 - val_accuracy10: 0.4397 - 13s/epoch - 30ms/step
Epoch 20/50
428/428 - 13s - loss: 2.9705 - accuracy10: 0.5054 - val_loss: 3.1978 - val_accuracy10: 0.4396 - 13s/epoch - 30ms/step
Epoch 21/50
428/428 - 13s - loss: 2.9645 - accuracy10: 0.5066 - val_loss: 3.1904 - val_accuracy10: 0.4404 - 13s/epoch - 30ms/step
Epoch 22/50
428/428 - 12s - loss: 2.9537 - accuracy10: 0.5114 - val_loss: 3.2004 - val_accuracy10: 0.4413 - 12s/epoch - 29ms/step
Epoch 23/50
428/428 - 12s - loss: 2.9481 - accuracy10: 0.5118 - val_loss: 3.1897 - val_accuracy10: 0.4428 - 12s/epoch - 29ms/step
Epoch 24/50
428/428 - 12s - loss: 2.9377 - accuracy10: 0.5156 - val_loss: 3.2064 - val_accuracy10: 0.4400 - 12s/epoch - 29ms/step
Epoch 25/50
428/428 - 12s - loss: 2.9296 - accuracy10: 0.5190 - val_loss: 3.2054 - val_accuracy10: 0.4435 - 12s/epoch - 29ms/step
testing model: results/PCAR/W10/deepOF_L2/h10
Evaluating performance on  test set...
2104/2104 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0808783
{'0': {'precision': 0.5106540861426466, 'recall': 0.4287923373250679, 'f1-score': 0.46615656559413593, 'support': 219871}, '1': {'precision': 0.2484780145611857, 'recall': 0.45217777339318305, 'f1-score': 0.3207173544929118, 'support': 101365}, '2': {'precision': 0.5113796623571273, 'recall': 0.3987806000368121, 'f1-score': 0.44811512219840793, 'support': 217320}, 'accuracy': 0.42108341565222557, 'macro avg': {'precision': 0.4235039210203199, 'recall': 0.42658357025168764, 'f1-score': 0.4116630140951519, 'support': 538556}, 'weighted avg': {'precision': 0.46160107165033043, 'recall': 0.42108341565222557, 'f1-score': 0.43150239386076894, 'support': 538556}}
[[94279 69608 55984]
 [28708 45835 26822]
 [61637 69020 86663]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0195715
{'0': {'precision': 0.5182623425203797, 'recall': 0.40627420604182807, 'f1-score': 0.4554857718849345, 'support': 36148}, '1': {'precision': 0.43254401280372473, 'recall': 0.6566443027140452, 'f1-score': 0.5215398616273588, 'support': 36219}, '2': {'precision': 0.5275485251413724, 'recall': 0.3718957065129559, 'f1-score': 0.4362539100761477, 'support': 37126}, 'accuracy': 0.47743691377530983, 'macro avg': {'precision': 0.492784960155159, 'recall': 0.47827140508960975, 'f1-score': 0.471093181196147, 'support': 109493}, 'weighted avg': {'precision': 0.4930564081864904, 'recall': 0.4774369137753099, 'f1-score': 0.47081470592517316, 'support': 109493}}
[[14686 15068  6394]
 [ 6465 23783  5971]
 [ 7186 16133 13807]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0603737
{'0': {'precision': 0.46213476446034585, 'recall': 0.3845835745595898, 'f1-score': 0.41980770098857945, 'support': 12091}, '1': {'precision': 0.40261127596439167, 'recall': 0.5978145928798027, 'f1-score': 0.4811688772253352, 'support': 11348}, '2': {'precision': 0.48083546272636374, 'recall': 0.3469616802950136, 'f1-score': 0.4030733410942957, 'support': 12474}, 'accuracy': 0.43889399381839445, 'macro avg': {'precision': 0.44852716771703377, 'recall': 0.44311994924480197, 'f1-score': 0.43468330643607017, 'support': 35913}, 'weighted avg': {'precision': 0.4498216734548108, 'recall': 0.43889399381839445, 'f1-score': 0.4333844621228041, 'support': 35913}}
[[4650 4926 2515]
 [2406 6784 2158]
 [3006 5140 4328]]
training model: results/PCAR/W10/deepOF_L2/h20
Epoch 1/50
428/428 - 14s - loss: 3.3148 - accuracy20: 0.3589 - val_loss: 3.2902 - val_accuracy20: 0.3692 - 14s/epoch - 34ms/step
Epoch 2/50
428/428 - 12s - loss: 3.2579 - accuracy20: 0.3897 - val_loss: 3.2688 - val_accuracy20: 0.3820 - 12s/epoch - 29ms/step
Epoch 3/50
428/428 - 12s - loss: 3.2264 - accuracy20: 0.4077 - val_loss: 3.2562 - val_accuracy20: 0.3865 - 12s/epoch - 29ms/step
Epoch 4/50
428/428 - 12s - loss: 3.2077 - accuracy20: 0.4182 - val_loss: 3.2486 - val_accuracy20: 0.3948 - 12s/epoch - 29ms/step
Epoch 5/50
428/428 - 12s - loss: 3.1940 - accuracy20: 0.4248 - val_loss: 3.2436 - val_accuracy20: 0.3955 - 12s/epoch - 29ms/step
Epoch 6/50
428/428 - 12s - loss: 3.1802 - accuracy20: 0.4295 - val_loss: 3.2412 - val_accuracy20: 0.3949 - 12s/epoch - 29ms/step
Epoch 7/50
428/428 - 12s - loss: 3.1697 - accuracy20: 0.4341 - val_loss: 3.2401 - val_accuracy20: 0.3980 - 12s/epoch - 29ms/step
Epoch 8/50
428/428 - 12s - loss: 3.1598 - accuracy20: 0.4404 - val_loss: 3.2399 - val_accuracy20: 0.4002 - 12s/epoch - 29ms/step
Epoch 9/50
428/428 - 12s - loss: 3.1496 - accuracy20: 0.4437 - val_loss: 3.2396 - val_accuracy20: 0.4009 - 12s/epoch - 29ms/step
Epoch 10/50
428/428 - 13s - loss: 3.1416 - accuracy20: 0.4464 - val_loss: 3.2388 - val_accuracy20: 0.4022 - 13s/epoch - 29ms/step
Epoch 11/50
428/428 - 13s - loss: 3.1337 - accuracy20: 0.4501 - val_loss: 3.2448 - val_accuracy20: 0.4009 - 13s/epoch - 29ms/step
Epoch 12/50
428/428 - 12s - loss: 3.1246 - accuracy20: 0.4537 - val_loss: 3.2471 - val_accuracy20: 0.3985 - 12s/epoch - 29ms/step
Epoch 13/50
428/428 - 12s - loss: 3.1173 - accuracy20: 0.4541 - val_loss: 3.2419 - val_accuracy20: 0.4031 - 12s/epoch - 29ms/step
Epoch 14/50
428/428 - 13s - loss: 3.1094 - accuracy20: 0.4598 - val_loss: 3.2473 - val_accuracy20: 0.4021 - 13s/epoch - 29ms/step
Epoch 15/50
428/428 - 13s - loss: 3.1016 - accuracy20: 0.4623 - val_loss: 3.2513 - val_accuracy20: 0.4014 - 13s/epoch - 29ms/step
Epoch 16/50
428/428 - 12s - loss: 3.0934 - accuracy20: 0.4641 - val_loss: 3.2545 - val_accuracy20: 0.3986 - 12s/epoch - 29ms/step
Epoch 17/50
428/428 - 13s - loss: 3.0859 - accuracy20: 0.4687 - val_loss: 3.2576 - val_accuracy20: 0.3995 - 13s/epoch - 29ms/step
Epoch 18/50
428/428 - 12s - loss: 3.0773 - accuracy20: 0.4705 - val_loss: 3.2557 - val_accuracy20: 0.4026 - 12s/epoch - 29ms/step
Epoch 19/50
428/428 - 12s - loss: 3.0683 - accuracy20: 0.4751 - val_loss: 3.2638 - val_accuracy20: 0.4033 - 12s/epoch - 29ms/step
Epoch 20/50
428/428 - 13s - loss: 3.0596 - accuracy20: 0.4774 - val_loss: 3.2733 - val_accuracy20: 0.4029 - 13s/epoch - 29ms/step
testing model: results/PCAR/W10/deepOF_L2/h20
Evaluating performance on  test set...
2104/2104 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1010863
{'0': {'precision': 0.46747494266789286, 'recall': 0.37819142423928503, 'f1-score': 0.41812000874608246, 'support': 212366}, '1': {'precision': 0.23843927761645253, 'recall': 0.40992827772506174, 'f1-score': 0.30150491526009854, 'support': 116979}, '2': {'precision': 0.460691387242058, 'recall': 0.3647418156789079, 'f1-score': 0.4071399416831844, 'support': 209211}, 'accuracy': 0.37986021880732923, 'macro avg': {'precision': 0.38886853584213443, 'recall': 0.3842871725477515, 'f1-score': 0.3755882885631218, 'support': 538556}, 'weighted avg': {'precision': 0.41509123981016444, 'recall': 0.37986021880732923, 'f1-score': 0.3885248174731361, 'support': 538556}}
[[80315 77002 55049]
 [34745 47953 34281]
 [56746 76157 76308]]
Evaluating performance on  train set...
428/428 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0567008
{'0': {'precision': 0.47549784177880955, 'recall': 0.3601373626373626, 'f1-score': 0.40985477340586846, 'support': 36400}, '1': {'precision': 0.38686796856481226, 'recall': 0.5881358281358281, 'f1-score': 0.46672826063045814, 'support': 36075}, '2': {'precision': 0.4706990140689044, 'recall': 0.3443459938408342, 'f1-score': 0.39772851370536205, 'support': 37018}, 'accuracy': 0.42991789429461247, 'macro avg': {'precision': 0.4443549414708421, 'recall': 0.4308730615380083, 'f1-score': 0.4247705159138962, 'support': 109493}, 'weighted avg': {'precision': 0.44467426693511886, 'recall': 0.42991789429461247, 'f1-score': 0.42449334546101103, 'support': 109493}}
[[13109 16455  6836]
 [ 7360 21217  7498]
 [ 7100 17171 12747]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0812063
{'0': {'precision': 0.4234673566878981, 'recall': 0.3577133249264397, 'f1-score': 0.3878229959440368, 'support': 11895}, '1': {'precision': 0.36797397433580337, 'recall': 0.5236625514403292, 'f1-score': 0.4322258783568623, 'support': 11664}, '2': {'precision': 0.43805309734513276, 'recall': 0.3285575522098106, 'f1-score': 0.3754856614246069, 'support': 12354}, 'accuracy': 0.40158159997772397, 'macro avg': {'precision': 0.4098314761229447, 'recall': 0.40331114285885983, 'f1-score': 0.39851151190850204, 'support': 35913}, 'weighted avg': {'precision': 0.4104614097696413, 'recall': 0.40158159997772397, 'f1-score': 0.3980003631873793, 'support': 35913}}
[[4255 5146 2494]
 [2843 6108 2713]
 [2950 5345 4059]]
training model: results/PCAR/W10/deepOF_L2/h30
Epoch 1/50
428/428 - 16s - loss: 3.3213 - accuracy30: 0.3512 - val_loss: 3.3121 - val_accuracy30: 0.3455 - 16s/epoch - 37ms/step
Epoch 2/50
428/428 - 13s - loss: 3.2698 - accuracy30: 0.3813 - val_loss: 3.2926 - val_accuracy30: 0.3623 - 13s/epoch - 30ms/step
Epoch 3/50
428/428 - 12s - loss: 3.2461 - accuracy30: 0.3980 - val_loss: 3.2857 - val_accuracy30: 0.3619 - 12s/epoch - 29ms/step
Epoch 4/50
428/428 - 12s - loss: 3.2312 - accuracy30: 0.4053 - val_loss: 3.2794 - val_accuracy30: 0.3710 - 12s/epoch - 29ms/step
Epoch 5/50
428/428 - 12s - loss: 3.2218 - accuracy30: 0.4084 - val_loss: 3.2783 - val_accuracy30: 0.3731 - 12s/epoch - 29ms/step
Epoch 6/50
428/428 - 13s - loss: 3.2097 - accuracy30: 0.4156 - val_loss: 3.2737 - val_accuracy30: 0.3733 - 13s/epoch - 30ms/step
Epoch 7/50
428/428 - 13s - loss: 3.2002 - accuracy30: 0.4202 - val_loss: 3.2729 - val_accuracy30: 0.3754 - 13s/epoch - 29ms/step
Epoch 8/50
428/428 - 12s - loss: 3.1935 - accuracy30: 0.4238 - val_loss: 3.2787 - val_accuracy30: 0.3706 - 12s/epoch - 29ms/step
Epoch 9/50
428/428 - 13s - loss: 3.1849 - accuracy30: 0.4282 - val_loss: 3.2753 - val_accuracy30: 0.3773 - 13s/epoch - 29ms/step
Epoch 10/50
428/428 - 12s - loss: 3.1795 - accuracy30: 0.4306 - val_loss: 3.2713 - val_accuracy30: 0.3818 - 12s/epoch - 29ms/step
Epoch 11/50
428/428 - 12s - loss: 3.1717 - accuracy30: 0.4331 - val_loss: 3.2756 - val_accuracy30: 0.3806 - 12s/epoch - 29ms/step
Epoch 12/50
428/428 - 13s - loss: 3.1641 - accuracy30: 0.4381 - val_loss: 3.2767 - val_accuracy30: 0.3837 - 13s/epoch - 30ms/step
Epoch 13/50
428/428 - 12s - loss: 3.1579 - accuracy30: 0.4394 - val_loss: 3.2800 - val_accuracy30: 0.3801 - 12s/epoch - 29ms/step
Epoch 14/50
428/428 - 12s - loss: 3.1493 - accuracy30: 0.4414 - val_loss: 3.2860 - val_accuracy30: 0.3776 - 12s/epoch - 29ms/step
Epoch 15/50
428/428 - 12s - loss: 3.1433 - accuracy30: 0.4452 - val_loss: 3.2882 - val_accuracy30: 0.3777 - 12s/epoch - 29ms/step
Epoch 16/50
428/428 - 12s - loss: 3.1374 - accuracy30: 0.4475 - val_loss: 3.2925 - val_accuracy30: 0.3790 - 12s/epoch - 29ms/step
Epoch 17/50
428/428 - 12s - loss: 3.1292 - accuracy30: 0.4527 - val_loss: 3.2935 - val_accuracy30: 0.3794 - 12s/epoch - 29ms/step
Epoch 18/50
428/428 - 12s - loss: 3.1241 - accuracy30: 0.4525 - val_loss: 3.2910 - val_accuracy30: 0.3828 - 12s/epoch - 29ms/step
Epoch 19/50
428/428 - 12s - loss: 3.1150 - accuracy30: 0.4566 - val_loss: 3.2985 - val_accuracy30: 0.3844 - 12s/epoch - 29ms/step
Epoch 20/50
428/428 - 12s - loss: 3.1058 - accuracy30: 0.4594 - val_loss: 3.3083 - val_accuracy30: 0.3831 - 12s/epoch - 29ms/step
testing model: results/PCAR/W10/deepOF_L2/h30
Evaluating performance on  test set...
2104/2104 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1127027
{'0': {'precision': 0.46862942578302313, 'recall': 0.31201242893031866, 'f1-score': 0.37461021215797885, 'support': 211764}, '1': {'precision': 0.2272568524731689, 'recall': 0.49350239878654634, 'f1-score': 0.31120461274738975, 'support': 117351}, '2': {'precision': 0.4557658219422822, 'recall': 0.31059343681514123, 'f1-score': 0.3694295368713973, 'support': 209441}, 'accuracy': 0.351007137605003, 'macro avg': {'precision': 0.38388403339949145, 'recall': 0.3720360881773354, 'f1-score': 0.3517481205922553, 'support': 538556}, 'weighted avg': {'precision': 0.4110319263540068, 'recall': 0.351007137605003, 'f1-score': 0.35877944189615096, 'support': 538556}}
[[66073 98182 47509]
 [29269 57913 30169]
 [45650 98740 65051]]
Evaluating performance on  train set...
428/428 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0698938
{'0': {'precision': 0.4644838601210491, 'recall': 0.3055632361886855, 'f1-score': 0.3686247039594383, 'support': 36166}, '1': {'precision': 0.36479860178337353, 'recall': 0.621179971892309, 'f1-score': 0.4596562060316878, 'support': 36289}, '2': {'precision': 0.46009703864815127, 'recall': 0.2969922782007668, 'f1-score': 0.3609752896006301, 'support': 37038}, 'accuracy': 0.4072680445325272, 'macro avg': {'precision': 0.42979316685085794, 'recall': 0.4079118287605871, 'f1-score': 0.3964187331972521, 'support': 109493}, 'weighted avg': {'precision': 0.429961494001488, 'recall': 0.4072680445325272, 'f1-score': 0.3962075007562958, 'support': 109493}}
[[11051 19150  5965]
 [ 6804 22542  6943]
 [ 5937 20101 11000]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0911822
{'0': {'precision': 0.42080185938407905, 'recall': 0.30311401305876445, 'f1-score': 0.35239161111381445, 'support': 11946}, '1': {'precision': 0.3447562929653176, 'recall': 0.5779896013864818, 'f1-score': 0.43189691455952345, 'support': 11540}, '2': {'precision': 0.4326089687225223, 'recall': 0.27713848877444275, 'f1-score': 0.3378457916421424, 'support': 12427}, 'accuracy': 0.38245203686687274, 'macro avg': {'precision': 0.3993890403573063, 'recall': 0.38608070107322967, 'f1-score': 0.37404477243849343, 'support': 35913}, 'weighted avg': {'precision': 0.40045159934666436, 'recall': 0.38245203686687274, 'f1-score': 0.3729059179995943, 'support': 35913}}
[[3621 6187 2138]
 [2491 6670 2379]
 [2493 6490 3444]]
training model: results/PCAR/W10/deepOF_L2/h50
Epoch 1/50
428/428 - 17s - loss: 3.3278 - accuracy50: 0.3509 - val_loss: 3.3004 - val_accuracy50: 0.3557 - 17s/epoch - 39ms/step
Epoch 2/50
428/428 - 14s - loss: 3.2802 - accuracy50: 0.3764 - val_loss: 3.2854 - val_accuracy50: 0.3669 - 14s/epoch - 32ms/step
Epoch 3/50
428/428 - 13s - loss: 3.2585 - accuracy50: 0.3917 - val_loss: 3.2774 - val_accuracy50: 0.3739 - 13s/epoch - 31ms/step
Epoch 4/50
428/428 - 13s - loss: 3.2443 - accuracy50: 0.3992 - val_loss: 3.2709 - val_accuracy50: 0.3758 - 13s/epoch - 30ms/step
Epoch 5/50
428/428 - 13s - loss: 3.2314 - accuracy50: 0.4078 - val_loss: 3.2692 - val_accuracy50: 0.3827 - 13s/epoch - 30ms/step
Epoch 6/50
428/428 - 13s - loss: 3.2232 - accuracy50: 0.4122 - val_loss: 3.2659 - val_accuracy50: 0.3801 - 13s/epoch - 30ms/step
Epoch 7/50
428/428 - 13s - loss: 3.2154 - accuracy50: 0.4174 - val_loss: 3.2642 - val_accuracy50: 0.3874 - 13s/epoch - 31ms/step
Epoch 8/50
428/428 - 13s - loss: 3.2059 - accuracy50: 0.4218 - val_loss: 3.2641 - val_accuracy50: 0.3856 - 13s/epoch - 30ms/step
Epoch 9/50
428/428 - 12s - loss: 3.1998 - accuracy50: 0.4242 - val_loss: 3.2625 - val_accuracy50: 0.3901 - 12s/epoch - 29ms/step
Epoch 10/50
428/428 - 13s - loss: 3.1925 - accuracy50: 0.4281 - val_loss: 3.2616 - val_accuracy50: 0.3946 - 13s/epoch - 30ms/step
Epoch 11/50
428/428 - 13s - loss: 3.1853 - accuracy50: 0.4316 - val_loss: 3.2614 - val_accuracy50: 0.3897 - 13s/epoch - 30ms/step
Epoch 12/50
428/428 - 13s - loss: 3.1794 - accuracy50: 0.4338 - val_loss: 3.2640 - val_accuracy50: 0.3897 - 13s/epoch - 29ms/step
Epoch 13/50
428/428 - 13s - loss: 3.1743 - accuracy50: 0.4370 - val_loss: 3.2677 - val_accuracy50: 0.3891 - 13s/epoch - 29ms/step
Epoch 14/50
428/428 - 13s - loss: 3.1669 - accuracy50: 0.4399 - val_loss: 3.2695 - val_accuracy50: 0.3883 - 13s/epoch - 29ms/step
Epoch 15/50
428/428 - 12s - loss: 3.1628 - accuracy50: 0.4396 - val_loss: 3.2688 - val_accuracy50: 0.3914 - 12s/epoch - 29ms/step
Epoch 16/50
428/428 - 12s - loss: 3.1535 - accuracy50: 0.4440 - val_loss: 3.2735 - val_accuracy50: 0.3892 - 12s/epoch - 29ms/step
Epoch 17/50
428/428 - 13s - loss: 3.1476 - accuracy50: 0.4457 - val_loss: 3.2702 - val_accuracy50: 0.3932 - 13s/epoch - 29ms/step
Epoch 18/50
428/428 - 13s - loss: 3.1425 - accuracy50: 0.4467 - val_loss: 3.2806 - val_accuracy50: 0.3889 - 13s/epoch - 29ms/step
Epoch 19/50
428/428 - 13s - loss: 3.1345 - accuracy50: 0.4522 - val_loss: 3.2770 - val_accuracy50: 0.3941 - 13s/epoch - 29ms/step
Epoch 20/50
428/428 - 12s - loss: 3.1269 - accuracy50: 0.4548 - val_loss: 3.2845 - val_accuracy50: 0.3912 - 12s/epoch - 29ms/step
Epoch 21/50
428/428 - 12s - loss: 3.1208 - accuracy50: 0.4568 - val_loss: 3.2947 - val_accuracy50: 0.3917 - 12s/epoch - 29ms/step
testing model: results/PCAR/W10/deepOF_L2/h50
Evaluating performance on  test set...
2104/2104 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0881273
{'0': {'precision': 0.460725427201192, 'recall': 0.4922395781514277, 'f1-score': 0.47596142283364196, 'support': 221122}, '1': {'precision': 0.19779917469050895, 'recall': 0.2149321733393807, 'f1-score': 0.20601006782692033, 'support': 97012}, '2': {'precision': 0.46455961075502555, 'recall': 0.41497218970883126, 'f1-score': 0.4383680472351887, 'support': 220422}, 'accuracy': 0.41066295798394226, 'macro avg': {'precision': 0.37436140421557546, 'recall': 0.3740479803998799, 'f1-score': 0.373446512631917, 'support': 538556}, 'weighted avg': {'precision': 0.4149328574382272, 'recall': 0.41066295798394226, 'f1-score': 0.4119477865765502, 'support': 538556}}
[[108845  41759  70518]
 [ 41254  20851  34907]
 [ 86148  42805  91469]]
Evaluating performance on  train set...
428/428 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0661775
{'0': {'precision': 0.4268011026398788, 'recall': 0.47056568643557306, 'f1-score': 0.44761619502793365, 'support': 36522}, '1': {'precision': 0.4025322982611934, 'recall': 0.38719276975642014, 'f1-score': 0.39471355739385683, 'support': 36292}, '2': {'precision': 0.43465337879185245, 'recall': 0.40666321328280486, 'f1-score': 0.42019268691193873, 'support': 36679}, 'accuracy': 0.42152466367713004, 'macro avg': {'precision': 0.42132892656430826, 'recall': 0.42147388982493267, 'f1-score': 0.4208408131112431, 'support': 109493}, 'weighted avg': {'precision': 0.4213875162778921, 'recall': 0.42152466367713004, 'f1-score': 0.4208947664507416, 'support': 109493}}
[[17186 10236  9100]
 [11939 14052 10301]
 [11142 10621 14916]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0862017
{'0': {'precision': 0.3984197134056515, 'recall': 0.4925496688741722, 'f1-score': 0.4405123269415858, 'support': 12080}, '1': {'precision': 0.3633992610302108, 'recall': 0.29590301743208564, 'f1-score': 0.32619616641467103, 'support': 11301}, '2': {'precision': 0.4154708329795364, 'recall': 0.39044047239067986, 'f1-score': 0.402566950512156, 'support': 12532}, 'accuracy': 0.39503800852059145, 'macro avg': {'precision': 0.3924299358051329, 'recall': 0.3929643862323125, 'f1-score': 0.389758481289471, 'support': 35913}, 'weighted avg': {'precision': 0.39334964123694016, 'recall': 0.39503800852059145, 'f1-score': 0.39129843816793064, 'support': 35913}}
[[5950 2861 3269]
 [4342 3344 3615]
 [4642 2997 4893]]
training model: results/PCAR/W10/deepOF_L2/h100
Epoch 1/50
428/428 - 16s - loss: 3.3310 - accuracy100: 0.3460 - val_loss: 3.3317 - val_accuracy100: 0.3333 - 16s/epoch - 38ms/step
Epoch 2/50
428/428 - 13s - loss: 3.2967 - accuracy100: 0.3624 - val_loss: 3.3200 - val_accuracy100: 0.3416 - 13s/epoch - 30ms/step
Epoch 3/50
428/428 - 13s - loss: 3.2801 - accuracy100: 0.3732 - val_loss: 3.3138 - val_accuracy100: 0.3426 - 13s/epoch - 30ms/step
Epoch 4/50
428/428 - 12s - loss: 3.2680 - accuracy100: 0.3816 - val_loss: 3.3086 - val_accuracy100: 0.3456 - 12s/epoch - 29ms/step
Epoch 5/50
428/428 - 12s - loss: 3.2584 - accuracy100: 0.3876 - val_loss: 3.3095 - val_accuracy100: 0.3429 - 12s/epoch - 29ms/step
Epoch 6/50
428/428 - 13s - loss: 3.2496 - accuracy100: 0.3945 - val_loss: 3.3111 - val_accuracy100: 0.3447 - 13s/epoch - 29ms/step
Epoch 7/50
428/428 - 13s - loss: 3.2437 - accuracy100: 0.3969 - val_loss: 3.3075 - val_accuracy100: 0.3486 - 13s/epoch - 29ms/step
Epoch 8/50
428/428 - 13s - loss: 3.2374 - accuracy100: 0.4021 - val_loss: 3.3133 - val_accuracy100: 0.3441 - 13s/epoch - 29ms/step
Epoch 9/50
428/428 - 12s - loss: 3.2323 - accuracy100: 0.4048 - val_loss: 3.3138 - val_accuracy100: 0.3464 - 12s/epoch - 29ms/step
Epoch 10/50
428/428 - 12s - loss: 3.2255 - accuracy100: 0.4084 - val_loss: 3.3148 - val_accuracy100: 0.3482 - 12s/epoch - 29ms/step
Epoch 11/50
428/428 - 12s - loss: 3.2212 - accuracy100: 0.4109 - val_loss: 3.3176 - val_accuracy100: 0.3463 - 12s/epoch - 29ms/step
Epoch 12/50
428/428 - 13s - loss: 3.2145 - accuracy100: 0.4139 - val_loss: 3.3140 - val_accuracy100: 0.3498 - 13s/epoch - 29ms/step
Epoch 13/50
428/428 - 12s - loss: 3.2106 - accuracy100: 0.4167 - val_loss: 3.3166 - val_accuracy100: 0.3514 - 12s/epoch - 29ms/step
Epoch 14/50
428/428 - 12s - loss: 3.2037 - accuracy100: 0.4206 - val_loss: 3.3227 - val_accuracy100: 0.3514 - 12s/epoch - 29ms/step
Epoch 15/50
428/428 - 12s - loss: 3.1993 - accuracy100: 0.4223 - val_loss: 3.3243 - val_accuracy100: 0.3524 - 12s/epoch - 29ms/step
Epoch 16/50
428/428 - 13s - loss: 3.1927 - accuracy100: 0.4251 - val_loss: 3.3317 - val_accuracy100: 0.3517 - 13s/epoch - 30ms/step
Epoch 17/50
428/428 - 13s - loss: 3.1874 - accuracy100: 0.4277 - val_loss: 3.3366 - val_accuracy100: 0.3506 - 13s/epoch - 29ms/step
testing model: results/PCAR/W10/deepOF_L2/h100
Evaluating performance on  test set...
2104/2104 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1211972
{'0': {'precision': 0.4240439361112511, 'recall': 0.24235443183781605, 'f1-score': 0.3084309090575926, 'support': 208356}, '1': {'precision': 0.23304917241275253, 'recall': 0.6237199160071071, 'f1-score': 0.3393152535670742, 'support': 123820}, '2': {'precision': 0.422186652135908, 'recall': 0.18020156991956585, 'f1-score': 0.25259025568056404, 'support': 206380}, 'accuracy': 0.306216995075721, 'macro avg': {'precision': 0.35975992021997055, 'recall': 0.34875863925482964, 'f1-score': 0.3001121394350769, 'support': 538556}, 'weighted avg': {'precision': 0.37942039109832876, 'recall': 0.306216995075721, 'f1-score': 0.29413287040091224, 'support': 538556}}
[[ 50496 126688  31172]
 [ 26864  77229  19727]
 [ 41722 127468  37190]]
Evaluating performance on  train set...
428/428 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0898434
{'0': {'precision': 0.41624607180268547, 'recall': 0.2403034717831716, 'f1-score': 0.3047001620745543, 'support': 36379}, '1': {'precision': 0.3506964444677174, 'recall': 0.7344885257587804, 'f1-score': 0.4747255473547107, 'support': 36473}, '2': {'precision': 0.4212178798644964, 'recall': 0.13913375726645016, 'f1-score': 0.2091744624979485, 'support': 36641}, 'accuracy': 0.3710648169289361, 'macro avg': {'precision': 0.3960534653782997, 'recall': 0.371308584936134, 'f1-score': 0.32953339064240444, 'support': 109493}, 'weighted avg': {'precision': 0.39607474086284933, 'recall': 0.3710648169289361, 'f1-score': 0.32937003794914654, 'support': 109493}}
[[ 8742 24048  3589]
 [ 6268 26789  3416]
 [ 5992 25551  5098]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1032734
{'0': {'precision': 0.3863187030446817, 'recall': 0.24225142573766428, 'f1-score': 0.2977750685766535, 'support': 12099}, '1': {'precision': 0.3233899727291798, 'recall': 0.6855821399982212, 'f1-score': 0.4394777353326872, 'support': 11243}, '2': {'precision': 0.4183923402360276, 'recall': 0.14947100469334182, 'f1-score': 0.22025553862384245, 'support': 12571}, 'accuracy': 0.3485645866399354, 'macro avg': {'precision': 0.3760336720032964, 'recall': 0.35910152347640906, 'f1-score': 0.3191694475110611, 'support': 35913}, 'weighted avg': {'precision': 0.37784516917659, 'recall': 0.3485645866399354, 'f1-score': 0.31500184081237037, 'support': 35913}}
[[2931 7835 1333]
 [2256 7708 1279]
 [2400 8292 1879]]
training model: results/PCAR/W10/deepOF_L2/h200
Epoch 1/50
428/428 - 14s - loss: 3.3325 - accuracy200: 0.3475 - val_loss: 3.3603 - val_accuracy200: 0.3266 - 14s/epoch - 34ms/step
Epoch 2/50
428/428 - 13s - loss: 3.3013 - accuracy200: 0.3593 - val_loss: 3.3541 - val_accuracy200: 0.3265 - 13s/epoch - 30ms/step
Epoch 3/50
428/428 - 13s - loss: 3.2834 - accuracy200: 0.3700 - val_loss: 3.3465 - val_accuracy200: 0.3271 - 13s/epoch - 30ms/step
Epoch 4/50
428/428 - 13s - loss: 3.2723 - accuracy200: 0.3787 - val_loss: 3.3444 - val_accuracy200: 0.3310 - 13s/epoch - 30ms/step
Epoch 5/50
428/428 - 13s - loss: 3.2624 - accuracy200: 0.3859 - val_loss: 3.3443 - val_accuracy200: 0.3332 - 13s/epoch - 30ms/step
Epoch 6/50
428/428 - 13s - loss: 3.2546 - accuracy200: 0.3914 - val_loss: 3.3418 - val_accuracy200: 0.3342 - 13s/epoch - 30ms/step
Epoch 7/50
428/428 - 13s - loss: 3.2474 - accuracy200: 0.3960 - val_loss: 3.3439 - val_accuracy200: 0.3339 - 13s/epoch - 29ms/step
Epoch 8/50
428/428 - 13s - loss: 3.2400 - accuracy200: 0.4003 - val_loss: 3.3445 - val_accuracy200: 0.3351 - 13s/epoch - 29ms/step
Epoch 9/50
428/428 - 12s - loss: 3.2359 - accuracy200: 0.4043 - val_loss: 3.3475 - val_accuracy200: 0.3361 - 12s/epoch - 29ms/step
Epoch 10/50
428/428 - 12s - loss: 3.2311 - accuracy200: 0.4057 - val_loss: 3.3463 - val_accuracy200: 0.3361 - 12s/epoch - 29ms/step
Epoch 11/50
428/428 - 12s - loss: 3.2246 - accuracy200: 0.4085 - val_loss: 3.3498 - val_accuracy200: 0.3372 - 12s/epoch - 29ms/step
Epoch 12/50
428/428 - 12s - loss: 3.2206 - accuracy200: 0.4115 - val_loss: 3.3465 - val_accuracy200: 0.3395 - 12s/epoch - 29ms/step
Epoch 13/50
428/428 - 12s - loss: 3.2147 - accuracy200: 0.4133 - val_loss: 3.3511 - val_accuracy200: 0.3379 - 12s/epoch - 29ms/step
Epoch 14/50
428/428 - 12s - loss: 3.2116 - accuracy200: 0.4154 - val_loss: 3.3473 - val_accuracy200: 0.3403 - 12s/epoch - 29ms/step
Epoch 15/50
428/428 - 12s - loss: 3.2063 - accuracy200: 0.4183 - val_loss: 3.3562 - val_accuracy200: 0.3370 - 12s/epoch - 29ms/step
Epoch 16/50
428/428 - 12s - loss: 3.1999 - accuracy200: 0.4223 - val_loss: 3.3536 - val_accuracy200: 0.3392 - 12s/epoch - 29ms/step
testing model: results/PCAR/W10/deepOF_L2/h200
Evaluating performance on  test set...
2104/2104 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.131259
{'0': {'precision': 0.4035345698614319, 'recall': 0.21344486488807876, 'f1-score': 0.2792066538707614, 'support': 209567}, '1': {'precision': 0.24058732144575662, 'recall': 0.6995251115268384, 'f1-score': 0.3580356284282695, 'support': 125082}, '2': {'precision': 0.40988394795620325, 'recall': 0.12869592510311073, 'f1-score': 0.19588698540663607, 'support': 203907}, 'accuracy': 0.2942516655649552, 'macro avg': {'precision': 0.35133527975446394, 'recall': 0.34722196717267595, 'f1-score': 0.277709755901889, 'support': 538556}, 'weighted avg': {'precision': 0.36809334353184137, 'recall': 0.2942516655649552, 'f1-score': 0.2659687030505827, 'support': 538556}}
[[ 44731 140817  24019]
 [ 23822  87498  13762]
 [ 42295 135370  26242]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1014135
{'0': {'precision': 0.41463898439566255, 'recall': 0.17135284312921825, 'f1-score': 0.24249337793159453, 'support': 36597}, '1': {'precision': 0.34956527836208107, 'recall': 0.8296491471363195, 'f1-score': 0.49188091459955446, 'support': 36055}, '2': {'precision': 0.41286802318972377, 'recall': 0.09858581471729866, 'f1-score': 0.15916560760769535, 'support': 36841}, 'accuracy': 0.3636396847287041, 'macro avg': {'precision': 0.3923574286491558, 'recall': 0.3665292683276122, 'f1-score': 0.29784663337961476, 'support': 109493}, 'weighted avg': {'precision': 0.3926149604596231, 'recall': 0.3636396847287041, 'f1-score': 0.29657710244421653, 'support': 109493}}
[[ 6271 27470  2856]
 [ 3833 29913  2309]
 [ 5020 28189  3632]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.115646
{'0': {'precision': 0.3685191460521857, 'recall': 0.17861542251786156, 'f1-score': 0.24061065324409536, 'support': 12177}, '1': {'precision': 0.3174803852303573, 'recall': 0.7754768392370572, 'f1-score': 0.4505184286204258, 'support': 11010}, '2': {'precision': 0.40153944836433614, 'recall': 0.09838126669809838, 'f1-score': 0.15804089876293867, 'support': 12726}, 'accuracy': 0.3331662629131512, 'macro avg': {'precision': 0.3625129932156264, 'recall': 0.350824509484339, 'f1-score': 0.28305666020915327, 'support': 35913}, 'weighted avg': {'precision': 0.36457293188394846, 'recall': 0.3331662629131512, 'f1-score': 0.2757038482254725, 'support': 35913}}
[[2175 9002 1000]
 [1606 8538  866]
 [2121 9353 1252]]
training model: results/PCAR/W10/deepOF_L2/h300
Epoch 1/50
428/428 - 15s - loss: 3.3400 - accuracy300: 0.3395 - val_loss: 3.3360 - val_accuracy300: 0.3343 - 15s/epoch - 35ms/step
Epoch 2/50
428/428 - 13s - loss: 3.3082 - accuracy300: 0.3507 - val_loss: 3.3230 - val_accuracy300: 0.3344 - 13s/epoch - 30ms/step
Epoch 3/50
428/428 - 13s - loss: 3.2918 - accuracy300: 0.3635 - val_loss: 3.3181 - val_accuracy300: 0.3354 - 13s/epoch - 30ms/step
Epoch 4/50
428/428 - 13s - loss: 3.2821 - accuracy300: 0.3696 - val_loss: 3.3136 - val_accuracy300: 0.3390 - 13s/epoch - 29ms/step
Epoch 5/50
428/428 - 13s - loss: 3.2758 - accuracy300: 0.3749 - val_loss: 3.3121 - val_accuracy300: 0.3363 - 13s/epoch - 29ms/step
Epoch 6/50
428/428 - 12s - loss: 3.2674 - accuracy300: 0.3823 - val_loss: 3.3121 - val_accuracy300: 0.3392 - 12s/epoch - 29ms/step
Epoch 7/50
428/428 - 13s - loss: 3.2628 - accuracy300: 0.3833 - val_loss: 3.3108 - val_accuracy300: 0.3417 - 13s/epoch - 30ms/step
Epoch 8/50
428/428 - 12s - loss: 3.2593 - accuracy300: 0.3874 - val_loss: 3.3137 - val_accuracy300: 0.3415 - 12s/epoch - 29ms/step
Epoch 9/50
428/428 - 12s - loss: 3.2553 - accuracy300: 0.3908 - val_loss: 3.3119 - val_accuracy300: 0.3401 - 12s/epoch - 29ms/step
Epoch 10/50
428/428 - 13s - loss: 3.2505 - accuracy300: 0.3913 - val_loss: 3.3100 - val_accuracy300: 0.3414 - 13s/epoch - 29ms/step
Epoch 11/50
428/428 - 13s - loss: 3.2464 - accuracy300: 0.3958 - val_loss: 3.3142 - val_accuracy300: 0.3395 - 13s/epoch - 29ms/step
Epoch 12/50
428/428 - 12s - loss: 3.2412 - accuracy300: 0.3997 - val_loss: 3.3120 - val_accuracy300: 0.3462 - 12s/epoch - 29ms/step
Epoch 13/50
428/428 - 13s - loss: 3.2389 - accuracy300: 0.4012 - val_loss: 3.3112 - val_accuracy300: 0.3473 - 13s/epoch - 30ms/step
Epoch 14/50
428/428 - 13s - loss: 3.2350 - accuracy300: 0.4032 - val_loss: 3.3143 - val_accuracy300: 0.3450 - 13s/epoch - 29ms/step
Epoch 15/50
428/428 - 13s - loss: 3.2303 - accuracy300: 0.4062 - val_loss: 3.3146 - val_accuracy300: 0.3456 - 13s/epoch - 30ms/step
Epoch 16/50
428/428 - 13s - loss: 3.2268 - accuracy300: 0.4076 - val_loss: 3.3157 - val_accuracy300: 0.3479 - 13s/epoch - 30ms/step
Epoch 17/50
428/428 - 13s - loss: 3.2211 - accuracy300: 0.4120 - val_loss: 3.3180 - val_accuracy300: 0.3490 - 13s/epoch - 29ms/step
Epoch 18/50
428/428 - 12s - loss: 3.2175 - accuracy300: 0.4136 - val_loss: 3.3245 - val_accuracy300: 0.3453 - 12s/epoch - 29ms/step
Epoch 19/50
428/428 - 13s - loss: 3.2124 - accuracy300: 0.4158 - val_loss: 3.3274 - val_accuracy300: 0.3496 - 13s/epoch - 30ms/step
Epoch 20/50
428/428 - 12s - loss: 3.2086 - accuracy300: 0.4173 - val_loss: 3.3334 - val_accuracy300: 0.3492 - 12s/epoch - 29ms/step
testing model: results/PCAR/W10/deepOF_L2/h300
Evaluating performance on  test set...
2104/2104 - 33s - 33s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1119478
{'0': {'precision': 0.40630332908957933, 'recall': 0.28447339847991315, 'f1-score': 0.3346449995398478, 'support': 210909}, '1': {'precision': 0.24791450650847385, 'recall': 0.5453729018311292, 'f1-score': 0.3408748264479642, 'support': 125824}, '2': {'precision': 0.39504798632718346, 'recall': 0.22332935294788006, 'f1-score': 0.28534619743097894, 'support': 201823}, 'accuracy': 0.32251427892364026, 'macro avg': {'precision': 0.3497552739750789, 'recall': 0.3510585510863075, 'f1-score': 0.3202886744729303, 'support': 538556}, 'weighted avg': {'precision': 0.3650806851031043, 'recall': 0.32251427892364026, 'f1-score': 0.3176258401634201, 'support': 538556}}
[[ 59998 107212  43699]
 [ 31880  68621  25323]
 [ 55790 100960  45073]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0904242
{'0': {'precision': 0.4066442177212645, 'recall': 0.2205713974156262, 'f1-score': 0.28600717580727836, 'support': 36682}, '1': {'precision': 0.3573851203501094, 'recall': 0.7298014354735107, 'f1-score': 0.47980757755193854, 'support': 35807}, '2': {'precision': 0.4082301529497451, 'recall': 0.1817641336071776, 'f1-score': 0.2515332834704563, 'support': 37004}, 'accuracy': 0.37398737818856, 'macro avg': {'precision': 0.39075316367370627, 'recall': 0.37737898883210486, 'f1-score': 0.33911601227655774, 'support': 109493}, 'weighted avg': {'precision': 0.3910712171424671, 'recall': 0.37398737818856, 'f1-score': 0.33773412705748873, 'support': 109493}}
[[ 8091 23240  5351]
 [ 5276 26132  4399]
 [ 6530 23748  6726]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1047676
{'0': {'precision': 0.35952472211575315, 'recall': 0.23271584518690042, 'f1-score': 0.2825443044329534, 'support': 12092}, '1': {'precision': 0.32236782236782235, 'recall': 0.6408864767073722, 'f1-score': 0.42896497441951986, 'support': 11055}, '2': {'precision': 0.38163064833005894, 'recall': 0.18259439135202882, 'f1-score': 0.24700646391861816, 'support': 12766}, 'accuracy': 0.3405452064711943, 'macro avg': {'precision': 0.35450773093787813, 'recall': 0.3520655710821005, 'f1-score': 0.3195052475903638, 'support': 35913}, 'weighted avg': {'precision': 0.3559448130950212, 'recall': 0.3405452064711943, 'f1-score': 0.31498393450271894, 'support': 35913}}
[[2814 7252 2026]
 [2219 7085 1751]
 [2794 7641 2331]]
training model: results/PCAR/W10/deepOF_L2/h500
Epoch 1/50
428/428 - 14s - loss: 3.3417 - accuracy500: 0.3419 - val_loss: 3.3295 - val_accuracy500: 0.3332 - 14s/epoch - 34ms/step
Epoch 2/50
428/428 - 13s - loss: 3.3105 - accuracy500: 0.3494 - val_loss: 3.3239 - val_accuracy500: 0.3296 - 13s/epoch - 29ms/step
Epoch 3/50
428/428 - 13s - loss: 3.2956 - accuracy500: 0.3609 - val_loss: 3.3172 - val_accuracy500: 0.3348 - 13s/epoch - 30ms/step
Epoch 4/50
428/428 - 13s - loss: 3.2853 - accuracy500: 0.3682 - val_loss: 3.3136 - val_accuracy500: 0.3385 - 13s/epoch - 30ms/step
Epoch 5/50
428/428 - 13s - loss: 3.2802 - accuracy500: 0.3697 - val_loss: 3.3119 - val_accuracy500: 0.3373 - 13s/epoch - 30ms/step
Epoch 6/50
428/428 - 13s - loss: 3.2734 - accuracy500: 0.3761 - val_loss: 3.3137 - val_accuracy500: 0.3344 - 13s/epoch - 29ms/step
Epoch 7/50
428/428 - 13s - loss: 3.2688 - accuracy500: 0.3809 - val_loss: 3.3089 - val_accuracy500: 0.3402 - 13s/epoch - 30ms/step
Epoch 8/50
428/428 - 13s - loss: 3.2646 - accuracy500: 0.3837 - val_loss: 3.3102 - val_accuracy500: 0.3408 - 13s/epoch - 30ms/step
Epoch 9/50
428/428 - 13s - loss: 3.2590 - accuracy500: 0.3868 - val_loss: 3.3086 - val_accuracy500: 0.3420 - 13s/epoch - 30ms/step
Epoch 10/50
428/428 - 13s - loss: 3.2558 - accuracy500: 0.3902 - val_loss: 3.3120 - val_accuracy500: 0.3403 - 13s/epoch - 30ms/step
Epoch 11/50
428/428 - 13s - loss: 3.2505 - accuracy500: 0.3928 - val_loss: 3.3087 - val_accuracy500: 0.3447 - 13s/epoch - 30ms/step
Epoch 12/50
428/428 - 13s - loss: 3.2458 - accuracy500: 0.3965 - val_loss: 3.3118 - val_accuracy500: 0.3438 - 13s/epoch - 30ms/step
Epoch 13/50
428/428 - 13s - loss: 3.2418 - accuracy500: 0.3979 - val_loss: 3.3109 - val_accuracy500: 0.3439 - 13s/epoch - 30ms/step
Epoch 14/50
428/428 - 13s - loss: 3.2382 - accuracy500: 0.3997 - val_loss: 3.3150 - val_accuracy500: 0.3433 - 13s/epoch - 30ms/step
Epoch 15/50
428/428 - 13s - loss: 3.2339 - accuracy500: 0.4020 - val_loss: 3.3182 - val_accuracy500: 0.3441 - 13s/epoch - 30ms/step
Epoch 16/50
428/428 - 13s - loss: 3.2281 - accuracy500: 0.4050 - val_loss: 3.3221 - val_accuracy500: 0.3424 - 13s/epoch - 30ms/step
Epoch 17/50
428/428 - 13s - loss: 3.2240 - accuracy500: 0.4090 - val_loss: 3.3223 - val_accuracy500: 0.3461 - 13s/epoch - 30ms/step
Epoch 18/50
428/428 - 13s - loss: 3.2191 - accuracy500: 0.4099 - val_loss: 3.3238 - val_accuracy500: 0.3459 - 13s/epoch - 30ms/step
Epoch 19/50
428/428 - 13s - loss: 3.2139 - accuracy500: 0.4127 - val_loss: 3.3282 - val_accuracy500: 0.3481 - 13s/epoch - 30ms/step
testing model: results/PCAR/W10/deepOF_L2/h500
Evaluating performance on  test set...
2104/2104 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1080047
{'0': {'precision': 0.3915480766258257, 'recall': 0.36764648966638286, 'f1-score': 0.3792210384490631, 'support': 206704}, '1': {'precision': 0.25290212399319956, 'recall': 0.5027411819578997, 'f1-score': 0.3365193914501043, 'support': 130783}, '2': {'precision': 0.38926238045639616, 'recall': 0.16356574111374703, 'f1-score': 0.23034280371344426, 'support': 201069}, 'accuracy': 0.32425968701490654, 'macro avg': {'precision': 0.34457086035847384, 'recall': 0.34465113757934324, 'f1-score': 0.3153610778708706, 'support': 538556}, 'weighted avg': {'precision': 0.3570259168759691, 'recall': 0.32425968701490654, 'f1-score': 0.31326792070546544, 'support': 538556}}
[[75994 99242 31468]
 [44901 65750 20132]
 [73191 94990 32888]]
Evaluating performance on  train set...
428/428 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0901612
{'0': {'precision': 0.39317212994267237, 'recall': 0.29424383267786913, 'f1-score': 0.3365894326207667, 'support': 36361}, '1': {'precision': 0.36117633417398615, 'recall': 0.6909085867967949, 'f1-score': 0.4743720314864698, 'support': 36067}, '2': {'precision': 0.40490705200571986, 'recall': 0.14515041143936327, 'f1-score': 0.2136955830950111, 'support': 37065}, 'accuracy': 0.3744348953814399, 'macro avg': {'precision': 0.3864185053741261, 'recall': 0.37676761030467576, 'f1-score': 0.3415523490674159, 'support': 109493}, 'weighted avg': {'precision': 0.38660515781000315, 'recall': 0.3744348953814399, 'f1-score': 0.34037364221057775, 'support': 109493}}
[[10699 21470  4192]
 [ 7433 24919  3715]
 [ 9080 22605  5380]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1038266
{'0': {'precision': 0.3643175566726738, 'recall': 0.31385847360679847, 'f1-score': 0.33721083358939463, 'support': 12238}, '1': {'precision': 0.32542224810716364, 'recall': 0.6153069652197852, 'f1-score': 0.42570077140408236, 'support': 10897}, '2': {'precision': 0.3787242971044901, 'recall': 0.141258412897167, 'f1-score': 0.20576835385316916, 'support': 12778}, 'accuracy': 0.34391445994486675, 'macro avg': {'precision': 0.35615470062810917, 'recall': 0.3568079505745836, 'f1-score': 0.32289331961554874, 'support': 35913}, 'weighted avg': {'precision': 0.35764162182455156, 'recall': 0.34391445994486675, 'f1-score': 0.3172933342520283, 'support': 35913}}
[[3841 6778 1619]
 [2850 6705 1342]
 [3852 7121 1805]]
training model: results/PCAR/W10/deepOF_L2/h1000
Epoch 1/50
428/428 - 15s - loss: 3.3463 - accuracy1000: 0.3439 - val_loss: 3.3275 - val_accuracy1000: 0.3310 - 15s/epoch - 35ms/step
Epoch 2/50
428/428 - 13s - loss: 3.3125 - accuracy1000: 0.3527 - val_loss: 3.3168 - val_accuracy1000: 0.3304 - 13s/epoch - 30ms/step
Epoch 3/50
428/428 - 13s - loss: 3.2971 - accuracy1000: 0.3604 - val_loss: 3.3166 - val_accuracy1000: 0.3346 - 13s/epoch - 30ms/step
Epoch 4/50
428/428 - 13s - loss: 3.2846 - accuracy1000: 0.3682 - val_loss: 3.3159 - val_accuracy1000: 0.3302 - 13s/epoch - 31ms/step
Epoch 5/50
428/428 - 13s - loss: 3.2802 - accuracy1000: 0.3706 - val_loss: 3.3154 - val_accuracy1000: 0.3339 - 13s/epoch - 30ms/step
Epoch 6/50
428/428 - 13s - loss: 3.2716 - accuracy1000: 0.3772 - val_loss: 3.3148 - val_accuracy1000: 0.3329 - 13s/epoch - 30ms/step
Epoch 7/50
428/428 - 13s - loss: 3.2664 - accuracy1000: 0.3818 - val_loss: 3.3147 - val_accuracy1000: 0.3367 - 13s/epoch - 30ms/step
Epoch 8/50
428/428 - 13s - loss: 3.2634 - accuracy1000: 0.3840 - val_loss: 3.3171 - val_accuracy1000: 0.3359 - 13s/epoch - 30ms/step
Epoch 9/50
428/428 - 13s - loss: 3.2582 - accuracy1000: 0.3857 - val_loss: 3.3170 - val_accuracy1000: 0.3349 - 13s/epoch - 30ms/step
Epoch 10/50
428/428 - 13s - loss: 3.2532 - accuracy1000: 0.3885 - val_loss: 3.3174 - val_accuracy1000: 0.3342 - 13s/epoch - 30ms/step
Epoch 11/50
428/428 - 13s - loss: 3.2499 - accuracy1000: 0.3921 - val_loss: 3.3201 - val_accuracy1000: 0.3338 - 13s/epoch - 30ms/step
Epoch 12/50
428/428 - 13s - loss: 3.2451 - accuracy1000: 0.3946 - val_loss: 3.3192 - val_accuracy1000: 0.3361 - 13s/epoch - 30ms/step
Epoch 13/50
428/428 - 13s - loss: 3.2401 - accuracy1000: 0.3990 - val_loss: 3.3196 - val_accuracy1000: 0.3376 - 13s/epoch - 30ms/step
Epoch 14/50
428/428 - 13s - loss: 3.2364 - accuracy1000: 0.3992 - val_loss: 3.3196 - val_accuracy1000: 0.3385 - 13s/epoch - 30ms/step
Epoch 15/50
428/428 - 13s - loss: 3.2333 - accuracy1000: 0.4031 - val_loss: 3.3190 - val_accuracy1000: 0.3419 - 13s/epoch - 30ms/step
Epoch 16/50
428/428 - 13s - loss: 3.2272 - accuracy1000: 0.4042 - val_loss: 3.3166 - val_accuracy1000: 0.3432 - 13s/epoch - 31ms/step
Epoch 17/50
428/428 - 13s - loss: 3.2208 - accuracy1000: 0.4093 - val_loss: 3.3183 - val_accuracy1000: 0.3461 - 13s/epoch - 30ms/step
testing model: results/PCAR/W10/deepOF_L2/h1000
Evaluating performance on  test set...
2104/2104 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1064609
{'0': {'precision': 0.39672213556490304, 'recall': 0.2581264249502169, 'f1-score': 0.31275770529732816, 'support': 207902}, '1': {'precision': 0.24770240312924507, 'recall': 0.43671597079198654, 'f1-score': 0.31610955980134453, 'support': 128184}, '2': {'precision': 0.3777751455259239, 'recall': 0.33078974662913024, 'f1-score': 0.35272462989588105, 'support': 202470}, 'accuracy': 0.32795103944622284, 'macro avg': {'precision': 0.3407332280733573, 'recall': 0.34187738079044455, 'f1-score': 0.3271972983315179, 'support': 538556}, 'weighted avg': {'precision': 0.3541301999895413, 'recall': 0.32795103944622284, 'f1-score': 0.3285810502070717, 'support': 538556}}
[[53665 85881 68356]
 [30247 55980 41957]
 [51359 84136 66975]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.093089
{'0': {'precision': 0.38620927256619747, 'recall': 0.2159922928709056, 'f1-score': 0.2770442027962152, 'support': 36330}, '1': {'precision': 0.36383084049361764, 'recall': 0.5607815352753631, 'f1-score': 0.441330059297226, 'support': 36697}, '2': {'precision': 0.3550731303467942, 'recall': 0.31755607963582516, 'f1-score': 0.33526831598604495, 'support': 36466}, 'accuracy': 0.3653749554766058, 'macro avg': {'precision': 0.36837108113553646, 'recall': 0.3647766359273646, 'f1-score': 0.35121419269316206, 'support': 109493}, 'weighted avg': {'precision': 0.368339345868233, 'recall': 0.3653749554766058, 'f1-score': 0.35149643798566044, 'support': 109493}}
[[ 7847 17765 10718]
 [ 5803 20579 10315]
 [ 6668 18218 11580]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1043824
{'0': {'precision': 0.34471218206157966, 'recall': 0.21123872026251025, 'f1-score': 0.2619532044760936, 'support': 12190}, '1': {'precision': 0.31441483742223264, 'recall': 0.49450752330840947, 'f1-score': 0.38441390692834837, 'support': 10833}, '2': {'precision': 0.35940377027619463, 'recall': 0.3179984484096199, 'f1-score': 0.3374356863552171, 'support': 12890}, 'accuracy': 0.3350040375351544, 'macro avg': {'precision': 0.3395102632533356, 'recall': 0.3412482306601799, 'f1-score': 0.32793426591988634, 'support': 35913}, 'weighted avg': {'precision': 0.34084626825901065, 'recall': 0.3350040375351544, 'f1-score': 0.3259853371602798, 'support': 35913}}
[[2575 5725 3890]
 [2060 5357 3416]
 [2835 5956 4099]]
training model: results/PCAR/W10/deepVOL_L2/h10
Epoch 1/50
428/428 - 15s - loss: 3.3064 - accuracy10: 0.3727 - val_loss: 3.3887 - val_accuracy10: 0.3423 - 15s/epoch - 35ms/step
Epoch 2/50
428/428 - 12s - loss: 3.2247 - accuracy10: 0.4139 - val_loss: 3.2716 - val_accuracy10: 0.3922 - 12s/epoch - 28ms/step
Epoch 3/50
428/428 - 12s - loss: 3.1764 - accuracy10: 0.4385 - val_loss: 3.2179 - val_accuracy10: 0.4225 - 12s/epoch - 28ms/step
Epoch 4/50
428/428 - 13s - loss: 3.1459 - accuracy10: 0.4491 - val_loss: 3.2043 - val_accuracy10: 0.4226 - 13s/epoch - 29ms/step
Epoch 5/50
428/428 - 12s - loss: 3.1244 - accuracy10: 0.4565 - val_loss: 3.1625 - val_accuracy10: 0.4425 - 12s/epoch - 28ms/step
Epoch 6/50
428/428 - 12s - loss: 3.1081 - accuracy10: 0.4625 - val_loss: 3.1623 - val_accuracy10: 0.4427 - 12s/epoch - 28ms/step
Epoch 7/50
428/428 - 12s - loss: 3.0974 - accuracy10: 0.4665 - val_loss: 3.1453 - val_accuracy10: 0.4497 - 12s/epoch - 28ms/step
Epoch 8/50
428/428 - 12s - loss: 3.0874 - accuracy10: 0.4702 - val_loss: 3.1486 - val_accuracy10: 0.4475 - 12s/epoch - 28ms/step
Epoch 9/50
428/428 - 12s - loss: 3.0781 - accuracy10: 0.4734 - val_loss: 3.1437 - val_accuracy10: 0.4531 - 12s/epoch - 29ms/step
Epoch 10/50
428/428 - 12s - loss: 3.0664 - accuracy10: 0.4770 - val_loss: 3.1375 - val_accuracy10: 0.4521 - 12s/epoch - 29ms/step
Epoch 11/50
428/428 - 12s - loss: 3.0608 - accuracy10: 0.4792 - val_loss: 3.1464 - val_accuracy10: 0.4522 - 12s/epoch - 28ms/step
Epoch 12/50
428/428 - 12s - loss: 3.0540 - accuracy10: 0.4813 - val_loss: 3.1329 - val_accuracy10: 0.4550 - 12s/epoch - 28ms/step
Epoch 13/50
428/428 - 12s - loss: 3.0464 - accuracy10: 0.4827 - val_loss: 3.1398 - val_accuracy10: 0.4565 - 12s/epoch - 27ms/step
Epoch 14/50
428/428 - 12s - loss: 3.0398 - accuracy10: 0.4856 - val_loss: 3.1410 - val_accuracy10: 0.4577 - 12s/epoch - 28ms/step
Epoch 15/50
428/428 - 12s - loss: 3.0382 - accuracy10: 0.4852 - val_loss: 3.1339 - val_accuracy10: 0.4600 - 12s/epoch - 28ms/step
Epoch 16/50
428/428 - 12s - loss: 3.0295 - accuracy10: 0.4894 - val_loss: 3.1410 - val_accuracy10: 0.4595 - 12s/epoch - 28ms/step
Epoch 17/50
428/428 - 12s - loss: 3.0278 - accuracy10: 0.4888 - val_loss: 3.1386 - val_accuracy10: 0.4596 - 12s/epoch - 28ms/step
Epoch 18/50
428/428 - 12s - loss: 3.0213 - accuracy10: 0.4908 - val_loss: 3.1411 - val_accuracy10: 0.4592 - 12s/epoch - 28ms/step
Epoch 19/50
428/428 - 12s - loss: 3.0176 - accuracy10: 0.4926 - val_loss: 3.1357 - val_accuracy10: 0.4592 - 12s/epoch - 28ms/step
Epoch 20/50
428/428 - 12s - loss: 3.0121 - accuracy10: 0.4931 - val_loss: 3.1358 - val_accuracy10: 0.4596 - 12s/epoch - 28ms/step
Epoch 21/50
428/428 - 12s - loss: 3.0075 - accuracy10: 0.4955 - val_loss: 3.1405 - val_accuracy10: 0.4600 - 12s/epoch - 28ms/step
Epoch 22/50
428/428 - 12s - loss: 3.0039 - accuracy10: 0.4967 - val_loss: 3.1390 - val_accuracy10: 0.4577 - 12s/epoch - 28ms/step
testing model: results/PCAR/W10/deepVOL_L2/h10
Evaluating performance on  test set...
2104/2104 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0579075
{'0': {'precision': 0.5109108296867302, 'recall': 0.5612760035292941, 'f1-score': 0.5349104834392737, 'support': 219874}, '1': {'precision': 0.2834393614003809, 'recall': 0.3450402012528979, 'f1-score': 0.31122085780387965, 'support': 101365}, '2': {'precision': 0.5279782509777269, 'recall': 0.4217980692244688, 'f1-score': 0.46895295685516164, 'support': 217322}, 'accuracy': 0.4642946667137056, 'macro avg': {'precision': 0.440776147354946, 'recall': 0.44270475800222026, 'f1-score': 0.43836143269943834, 'support': 538561}, 'weighted avg': {'precision': 0.47498450146570453, 'recall': 0.4642946667137056, 'f1-score': 0.46619343839731164, 'support': 538561}}
[[123410  42427  54037]
 [ 38476  34975  27914]
 [ 79663  45993  91666]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0244986
{'0': {'precision': 0.4778839626090135, 'recall': 0.504757439532254, 'f1-score': 0.4909532304143139, 'support': 36259}, '1': {'precision': 0.4596891568770142, 'recall': 0.4890775356708329, 'f1-score': 0.47392818863879965, 'support': 36164}, '2': {'precision': 0.48603300733496335, 'recall': 0.4289876183539694, 'f1-score': 0.4557321144560187, 'support': 37071}, 'accuracy': 0.47392551190019544, 'macro avg': {'precision': 0.474535375606997, 'recall': 0.47427419785235214, 'f1-score': 0.4735378445030441, 'support': 109494}, 'weighted avg': {'precision': 0.47463352224281685, 'recall': 0.47392551190019544, 'f1-score': 0.47340545975601606, 'support': 109494}}
[[18302  9876  8081]
 [ 9741 17687  8736]
 [10255 10913 15903]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0451431
{'0': {'precision': 0.4496925291116054, 'recall': 0.5651566225437803, 'f1-score': 0.500856133192466, 'support': 12163}, '1': {'precision': 0.4466926070038911, 'recall': 0.3549469964664311, 'f1-score': 0.3955697760275659, 'support': 11320}, '2': {'precision': 0.47102819807427787, 'recall': 0.4407884151246983, 'f1-score': 0.4554068655972072, 'support': 12430}, 'accuracy': 0.4558516414668783, 'macro avg': {'precision': 0.45580444472992476, 'recall': 0.4536306780449699, 'f1-score': 0.4506109249390797, 'support': 35913}, 'weighted avg': {'precision': 0.4561315135168818, 'recall': 0.4558516414668783, 'f1-score': 0.451938583577682, 'support': 35913}}
[[6874 2329 2960]
 [4109 4018 3193]
 [4303 2648 5479]]
training model: results/PCAR/W10/deepVOL_L2/h20
Epoch 1/50
428/428 - 16s - loss: 3.3148 - accuracy20: 0.3666 - val_loss: 3.3312 - val_accuracy20: 0.3522 - 16s/epoch - 37ms/step
Epoch 2/50
428/428 - 12s - loss: 3.2477 - accuracy20: 0.3995 - val_loss: 3.2747 - val_accuracy20: 0.3787 - 12s/epoch - 29ms/step
Epoch 3/50
428/428 - 12s - loss: 3.2045 - accuracy20: 0.4226 - val_loss: 3.2448 - val_accuracy20: 0.3920 - 12s/epoch - 28ms/step
Epoch 4/50
428/428 - 12s - loss: 3.1805 - accuracy20: 0.4338 - val_loss: 3.2329 - val_accuracy20: 0.4023 - 12s/epoch - 29ms/step
Epoch 5/50
428/428 - 12s - loss: 3.1602 - accuracy20: 0.4417 - val_loss: 3.2145 - val_accuracy20: 0.4093 - 12s/epoch - 28ms/step
Epoch 6/50
428/428 - 12s - loss: 3.1512 - accuracy20: 0.4471 - val_loss: 3.2084 - val_accuracy20: 0.4167 - 12s/epoch - 28ms/step
Epoch 7/50
428/428 - 12s - loss: 3.1432 - accuracy20: 0.4495 - val_loss: 3.2139 - val_accuracy20: 0.4156 - 12s/epoch - 28ms/step
Epoch 8/50
428/428 - 12s - loss: 3.1366 - accuracy20: 0.4504 - val_loss: 3.2066 - val_accuracy20: 0.4208 - 12s/epoch - 28ms/step
Epoch 9/50
428/428 - 12s - loss: 3.1313 - accuracy20: 0.4540 - val_loss: 3.2137 - val_accuracy20: 0.4184 - 12s/epoch - 28ms/step
Epoch 10/50
428/428 - 12s - loss: 3.1237 - accuracy20: 0.4557 - val_loss: 3.2199 - val_accuracy20: 0.4192 - 12s/epoch - 28ms/step
Epoch 11/50
428/428 - 12s - loss: 3.1210 - accuracy20: 0.4562 - val_loss: 3.2057 - val_accuracy20: 0.4236 - 12s/epoch - 28ms/step
Epoch 12/50
428/428 - 12s - loss: 3.1161 - accuracy20: 0.4587 - val_loss: 3.2072 - val_accuracy20: 0.4246 - 12s/epoch - 28ms/step
Epoch 13/50
428/428 - 12s - loss: 3.1082 - accuracy20: 0.4605 - val_loss: 3.2089 - val_accuracy20: 0.4272 - 12s/epoch - 28ms/step
Epoch 14/50
428/428 - 12s - loss: 3.1050 - accuracy20: 0.4615 - val_loss: 3.2153 - val_accuracy20: 0.4285 - 12s/epoch - 29ms/step
Epoch 15/50
428/428 - 13s - loss: 3.0991 - accuracy20: 0.4644 - val_loss: 3.2118 - val_accuracy20: 0.4254 - 13s/epoch - 29ms/step
Epoch 16/50
428/428 - 13s - loss: 3.0958 - accuracy20: 0.4646 - val_loss: 3.2097 - val_accuracy20: 0.4285 - 13s/epoch - 29ms/step
Epoch 17/50
428/428 - 12s - loss: 3.0921 - accuracy20: 0.4650 - val_loss: 3.2162 - val_accuracy20: 0.4282 - 12s/epoch - 28ms/step
Epoch 18/50
428/428 - 12s - loss: 3.0871 - accuracy20: 0.4677 - val_loss: 3.2132 - val_accuracy20: 0.4302 - 12s/epoch - 28ms/step
Epoch 19/50
428/428 - 12s - loss: 3.0825 - accuracy20: 0.4678 - val_loss: 3.2206 - val_accuracy20: 0.4270 - 12s/epoch - 28ms/step
Epoch 20/50
428/428 - 12s - loss: 3.0801 - accuracy20: 0.4691 - val_loss: 3.2222 - val_accuracy20: 0.4298 - 12s/epoch - 28ms/step
Epoch 21/50
428/428 - 12s - loss: 3.0753 - accuracy20: 0.4711 - val_loss: 3.2267 - val_accuracy20: 0.4299 - 12s/epoch - 29ms/step
testing model: results/PCAR/W10/deepVOL_L2/h20
Evaluating performance on  test set...
2104/2104 - 35s - 35s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1004491
{'0': {'precision': 0.489615913618498, 'recall': 0.4710219995479545, 'f1-score': 0.48013900655433184, 'support': 212368}, '1': {'precision': 0.2613704003945556, 'recall': 0.39413574970080356, 'f1-score': 0.31430801585651424, 'support': 116980}, '2': {'precision': 0.49703212401097197, 'recall': 0.37502449656570097, 'f1-score': 0.4274933936306427, 'support': 209213}, 'accuracy': 0.4170298257764673, 'macro avg': {'precision': 0.4160061460080085, 'recall': 0.413394081938153, 'f1-score': 0.4073134720138296, 'support': 538561}, 'weighted avg': {'precision': 0.44292001006793247, 'recall': 0.4170298257764673, 'f1-score': 0.4236680480028688, 'support': 538561}}
[[100030  62816  49522]
 [ 40999  46106  29875]
 [ 63274  67479  78460]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0550517
{'0': {'precision': 0.46570503385340006, 'recall': 0.4358246783657952, 'f1-score': 0.4502696779518707, 'support': 36299}, '1': {'precision': 0.4026228224701507, 'recall': 0.5118471619342531, 'f1-score': 0.4507121119902617, 'support': 36169}, '2': {'precision': 0.4745625021155604, 'recall': 0.37865283854588666, 'f1-score': 0.42121708302663396, 'support': 37026}, 'accuracy': 0.4416041061610682, 'macro avg': {'precision': 0.4476301194797037, 'recall': 0.44210822628197827, 'f1-score': 0.4407329576562555, 'support': 109494}, 'weighted avg': {'precision': 0.4478623768708623, 'recall': 0.4416041061610682, 'f1-score': 0.44059153135966245, 'support': 109494}}
[[15820 12923  7556]
 [ 9689 18513  7967]
 [ 8461 14545 14020]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0696568
{'0': {'precision': 0.4341360307994263, 'recall': 0.48380583831075963, 'f1-score': 0.4576271186440678, 'support': 11887}, '1': {'precision': 0.3807063606335225, 'recall': 0.38600257621296696, 'f1-score': 0.38333617601910286, 'support': 11645}, '2': {'precision': 0.45519845289621513, 'recall': 0.39924077215087633, 'f1-score': 0.42538726333907056, 'support': 12381}, 'accuracy': 0.4229387686910033, 'macro avg': {'precision': 0.42334694810972134, 'recall': 0.423016395558201, 'f1-score': 0.4221168526674137, 'support': 35913}, 'weighted avg': {'precision': 0.42407241425105646, 'recall': 0.4229387686910033, 'f1-score': 0.42242316254463624, 'support': 35913}}
[[5751 3388 2748]
 [3982 4495 3168]
 [3514 3924 4943]]
training model: results/PCAR/W10/deepVOL_L2/h30
Epoch 1/50
428/428 - 14s - loss: 3.3338 - accuracy30: 0.3531 - val_loss: 3.3124 - val_accuracy30: 0.3520 - 14s/epoch - 33ms/step
Epoch 2/50
428/428 - 12s - loss: 3.2747 - accuracy30: 0.3838 - val_loss: 3.2783 - val_accuracy30: 0.3704 - 12s/epoch - 28ms/step
Epoch 3/50
428/428 - 12s - loss: 3.2423 - accuracy30: 0.4007 - val_loss: 3.2786 - val_accuracy30: 0.3774 - 12s/epoch - 28ms/step
Epoch 4/50
428/428 - 12s - loss: 3.2209 - accuracy30: 0.4152 - val_loss: 3.2568 - val_accuracy30: 0.3950 - 12s/epoch - 28ms/step
Epoch 5/50
428/428 - 12s - loss: 3.2046 - accuracy30: 0.4232 - val_loss: 3.2428 - val_accuracy30: 0.4019 - 12s/epoch - 28ms/step
Epoch 6/50
428/428 - 12s - loss: 3.1944 - accuracy30: 0.4273 - val_loss: 3.2493 - val_accuracy30: 0.3987 - 12s/epoch - 27ms/step
Epoch 7/50
428/428 - 12s - loss: 3.1826 - accuracy30: 0.4336 - val_loss: 3.2329 - val_accuracy30: 0.4077 - 12s/epoch - 28ms/step
Epoch 8/50
428/428 - 12s - loss: 3.1772 - accuracy30: 0.4346 - val_loss: 3.2377 - val_accuracy30: 0.4060 - 12s/epoch - 28ms/step
Epoch 9/50
428/428 - 12s - loss: 3.1691 - accuracy30: 0.4377 - val_loss: 3.2339 - val_accuracy30: 0.4090 - 12s/epoch - 28ms/step
Epoch 10/50
428/428 - 12s - loss: 3.1655 - accuracy30: 0.4391 - val_loss: 3.2292 - val_accuracy30: 0.4086 - 12s/epoch - 28ms/step
Epoch 11/50
428/428 - 12s - loss: 3.1593 - accuracy30: 0.4411 - val_loss: 3.2331 - val_accuracy30: 0.4110 - 12s/epoch - 28ms/step
Epoch 12/50
428/428 - 12s - loss: 3.1547 - accuracy30: 0.4424 - val_loss: 3.2416 - val_accuracy30: 0.4089 - 12s/epoch - 28ms/step
Epoch 13/50
428/428 - 12s - loss: 3.1493 - accuracy30: 0.4444 - val_loss: 3.2321 - val_accuracy30: 0.4101 - 12s/epoch - 28ms/step
Epoch 14/50
428/428 - 12s - loss: 3.1460 - accuracy30: 0.4462 - val_loss: 3.2320 - val_accuracy30: 0.4120 - 12s/epoch - 28ms/step
Epoch 15/50
428/428 - 12s - loss: 3.1391 - accuracy30: 0.4488 - val_loss: 3.2395 - val_accuracy30: 0.4109 - 12s/epoch - 28ms/step
Epoch 16/50
428/428 - 12s - loss: 3.1349 - accuracy30: 0.4482 - val_loss: 3.2342 - val_accuracy30: 0.4107 - 12s/epoch - 28ms/step
Epoch 17/50
428/428 - 12s - loss: 3.1303 - accuracy30: 0.4519 - val_loss: 3.2475 - val_accuracy30: 0.4110 - 12s/epoch - 28ms/step
Epoch 18/50
428/428 - 12s - loss: 3.1277 - accuracy30: 0.4520 - val_loss: 3.2485 - val_accuracy30: 0.4083 - 12s/epoch - 28ms/step
Epoch 19/50
428/428 - 12s - loss: 3.1244 - accuracy30: 0.4522 - val_loss: 3.2566 - val_accuracy30: 0.4087 - 12s/epoch - 28ms/step
Epoch 20/50
428/428 - 12s - loss: 3.1167 - accuracy30: 0.4555 - val_loss: 3.2663 - val_accuracy30: 0.4078 - 12s/epoch - 28ms/step
testing model: results/PCAR/W10/deepVOL_L2/h30
Evaluating performance on  test set...
2104/2104 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.102634
{'0': {'precision': 0.4658517493156198, 'recall': 0.49742168242305185, 'f1-score': 0.4811193857719985, 'support': 211766}, '1': {'precision': 0.249033938172043, 'recall': 0.3536624855136683, 'f1-score': 0.2922664150305625, 'support': 117352}, '2': {'precision': 0.4897796800834088, 'recall': 0.3409233061023763, 'f1-score': 0.4020144638277628, 'support': 209443}, 'accuracy': 0.40523543294074393, 'macro avg': {'precision': 0.4015551225236906, 'recall': 0.3973358246796988, 'f1-score': 0.39180008821010787, 'support': 538561}, 'weighted avg': {'precision': 0.42791274859049677, 'recall': 0.40523543294074393, 'f1-score': 0.4092050696792708, 'support': 538561}}
[[105337  60826  45603]
 [ 47068  41503  28781]
 [ 73712  64327  71404]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0654429
{'0': {'precision': 0.44417933636666296, 'recall': 0.44258307071377234, 'f1-score': 0.44337976681713703, 'support': 36174}, '1': {'precision': 0.3872106797885912, 'recall': 0.4680435081922071, 'f1-score': 0.42380720848761394, 'support': 36315}, '2': {'precision': 0.4625093050010151, 'recall': 0.36938251587623294, 'f1-score': 0.4107333343349509, 'support': 37005}, 'accuracy': 0.4262881984400972, 'macro avg': {'precision': 0.43129977371875644, 'recall': 0.4266696982607375, 'f1-score': 0.4259734365465673, 'support': 109494}, 'weighted avg': {'precision': 0.4314798617441405, 'recall': 0.4262881984400972, 'f1-score': 0.4258549829044119, 'support': 109494}}
[[16010 12894  7270]
 [10703 16997  8615]
 [ 9331 14005 13669]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0786598
{'0': {'precision': 0.41115221263186735, 'recall': 0.5033545790003354, 'f1-score': 0.45260538420933566, 'support': 11924}, '1': {'precision': 0.358480611975732, 'recall': 0.35298701298701296, 'f1-score': 0.3557126030624264, 'support': 11550}, '2': {'precision': 0.4554415610541139, 'recall': 0.3640164000321569, 'f1-score': 0.4046289263214334, 'support': 12439}, 'accuracy': 0.4067329379333389, 'macro avg': {'precision': 0.4083581285539044, 'recall': 0.4067859973398351, 'f1-score': 0.40431563786439845, 'support': 35913}, 'weighted avg': {'precision': 0.40955274217398197, 'recall': 0.4067329379333389, 'f1-score': 0.40482628522249475, 'support': 35913}}
[[6002 3486 2436]
 [4495 4077 2978]
 [4101 3810 4528]]
training model: results/PCAR/W10/deepVOL_L2/h50
Epoch 1/50
428/428 - 15s - loss: 3.3278 - accuracy50: 0.3648 - val_loss: 3.3179 - val_accuracy50: 0.3603 - 15s/epoch - 34ms/step
Epoch 2/50
428/428 - 12s - loss: 3.2780 - accuracy50: 0.3859 - val_loss: 3.3185 - val_accuracy50: 0.3615 - 12s/epoch - 28ms/step
Epoch 3/50
428/428 - 12s - loss: 3.2591 - accuracy50: 0.3926 - val_loss: 3.2946 - val_accuracy50: 0.3708 - 12s/epoch - 28ms/step
Epoch 4/50
428/428 - 12s - loss: 3.2469 - accuracy50: 0.4027 - val_loss: 3.2803 - val_accuracy50: 0.3801 - 12s/epoch - 28ms/step
Epoch 5/50
428/428 - 12s - loss: 3.2346 - accuracy50: 0.4131 - val_loss: 3.2623 - val_accuracy50: 0.3846 - 12s/epoch - 27ms/step
Epoch 6/50
428/428 - 12s - loss: 3.2260 - accuracy50: 0.4156 - val_loss: 3.2688 - val_accuracy50: 0.3874 - 12s/epoch - 27ms/step
Epoch 7/50
428/428 - 12s - loss: 3.2220 - accuracy50: 0.4165 - val_loss: 3.2667 - val_accuracy50: 0.3905 - 12s/epoch - 27ms/step
Epoch 8/50
428/428 - 12s - loss: 3.2139 - accuracy50: 0.4206 - val_loss: 3.2630 - val_accuracy50: 0.3929 - 12s/epoch - 27ms/step
Epoch 9/50
428/428 - 12s - loss: 3.2070 - accuracy50: 0.4248 - val_loss: 3.2698 - val_accuracy50: 0.3922 - 12s/epoch - 27ms/step
Epoch 10/50
428/428 - 12s - loss: 3.2009 - accuracy50: 0.4285 - val_loss: 3.2590 - val_accuracy50: 0.3959 - 12s/epoch - 28ms/step
Epoch 11/50
428/428 - 12s - loss: 3.1949 - accuracy50: 0.4301 - val_loss: 3.2702 - val_accuracy50: 0.3963 - 12s/epoch - 28ms/step
Epoch 12/50
428/428 - 12s - loss: 3.1892 - accuracy50: 0.4325 - val_loss: 3.2714 - val_accuracy50: 0.3958 - 12s/epoch - 28ms/step
Epoch 13/50
428/428 - 12s - loss: 3.1836 - accuracy50: 0.4353 - val_loss: 3.2769 - val_accuracy50: 0.3953 - 12s/epoch - 28ms/step
Epoch 14/50
428/428 - 12s - loss: 3.1784 - accuracy50: 0.4372 - val_loss: 3.2796 - val_accuracy50: 0.3940 - 12s/epoch - 28ms/step
Epoch 15/50
428/428 - 12s - loss: 3.1743 - accuracy50: 0.4390 - val_loss: 3.2792 - val_accuracy50: 0.3979 - 12s/epoch - 27ms/step
Epoch 16/50
428/428 - 12s - loss: 3.1707 - accuracy50: 0.4398 - val_loss: 3.2778 - val_accuracy50: 0.3951 - 12s/epoch - 28ms/step
Epoch 17/50
428/428 - 12s - loss: 3.1633 - accuracy50: 0.4432 - val_loss: 3.2812 - val_accuracy50: 0.3988 - 12s/epoch - 28ms/step
Epoch 18/50
428/428 - 12s - loss: 3.1610 - accuracy50: 0.4452 - val_loss: 3.2921 - val_accuracy50: 0.3949 - 12s/epoch - 27ms/step
Epoch 19/50
428/428 - 12s - loss: 3.1576 - accuracy50: 0.4462 - val_loss: 3.2939 - val_accuracy50: 0.3951 - 12s/epoch - 28ms/step
Epoch 20/50
428/428 - 12s - loss: 3.1519 - accuracy50: 0.4467 - val_loss: 3.3016 - val_accuracy50: 0.3967 - 12s/epoch - 28ms/step
testing model: results/PCAR/W10/deepVOL_L2/h50
Evaluating performance on  test set...
2104/2104 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0819889
{'0': {'precision': 0.4451243515190696, 'recall': 0.6289864510410449, 'f1-score': 0.5213190025956502, 'support': 221124}, '1': {'precision': 0.20221284835073647, 'recall': 0.1507133138168474, 'f1-score': 0.17270563499235164, 'support': 97012}, '2': {'precision': 0.4753015377613056, 'recall': 0.33162753771123965, 'f1-score': 0.39067393511837956, 'support': 220425}, 'accuracy': 0.4211296399107993, 'macro avg': {'precision': 0.3742129125437039, 'recall': 0.3704424341897106, 'f1-score': 0.3615661909021271, 'support': 538561}, 'weighted avg': {'precision': 0.41371932132207895, 'recall': 0.4211296399107993, 'f1-score': 0.40505154353974276, 'support': 538561}}
[[139084  26615  55425]
 [ 57120  14621  25271]
 [116257  31069  73099]]
Evaluating performance on  train set...
428/428 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0767056
{'0': {'precision': 0.3960877628862372, 'recall': 0.6192521268156578, 'f1-score': 0.48314498831513913, 'support': 36557}, '1': {'precision': 0.4004207252938217, 'recall': 0.24175824175824176, 'f1-score': 0.3014891968666609, 'support': 36218}, '2': {'precision': 0.43451580087290387, 'recall': 0.36060350227402704, 'f1-score': 0.39412430051196573, 'support': 36719}, 'accuracy': 0.40764790764790765, 'macro avg': {'precision': 0.4103414296843209, 'recall': 0.4072046236159756, 'f1-score': 0.3929194952312553, 'support': 109494}, 'weighted avg': {'precision': 0.41040791156388445, 'recall': 0.40764790764790765, 'f1-score': 0.3932043514754428, 'support': 109494}}
[[22638  5655  8264]
 [18494  8756  8968]
 [16022  7456 13241]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0872369
{'0': {'precision': 0.38662041625371657, 'recall': 0.647307724218037, 'f1-score': 0.4841001458132969, 'support': 12053}, '1': {'precision': 0.37064039408866994, 'recall': 0.16635712390554525, 'f1-score': 0.2296422903186424, 'support': 11307}, '2': {'precision': 0.42062300619253146, 'recall': 0.35712578666454237, 'f1-score': 0.3862823661195123, 'support': 12553}, 'accuracy': 0.39445326204995407, 'macro avg': {'precision': 0.39262793884497266, 'recall': 0.3902635449293748, 'f1-score': 0.3666749340838172, 'support': 35913}, 'weighted avg': {'precision': 0.39347443571412816, 'recall': 0.39445326204995407, 'f1-score': 0.3697944191802076, 'support': 35913}}
[[7802 1317 2934]
 [6185 1881 3241]
 [6193 1877 4483]]
training model: results/PCAR/W10/deepVOL_L2/h100
Epoch 1/50
428/428 - 15s - loss: 3.3318 - accuracy100: 0.3575 - val_loss: 3.3424 - val_accuracy100: 0.3473 - 15s/epoch - 34ms/step
Epoch 2/50
428/428 - 12s - loss: 3.2986 - accuracy100: 0.3678 - val_loss: 3.3085 - val_accuracy100: 0.3583 - 12s/epoch - 28ms/step
Epoch 3/50
428/428 - 12s - loss: 3.2777 - accuracy100: 0.3779 - val_loss: 3.3080 - val_accuracy100: 0.3567 - 12s/epoch - 28ms/step
Epoch 4/50
428/428 - 12s - loss: 3.2668 - accuracy100: 0.3839 - val_loss: 3.3024 - val_accuracy100: 0.3599 - 12s/epoch - 28ms/step
Epoch 5/50
428/428 - 12s - loss: 3.2577 - accuracy100: 0.3906 - val_loss: 3.3119 - val_accuracy100: 0.3584 - 12s/epoch - 27ms/step
Epoch 6/50
428/428 - 12s - loss: 3.2493 - accuracy100: 0.3978 - val_loss: 3.3082 - val_accuracy100: 0.3593 - 12s/epoch - 28ms/step
Epoch 7/50
428/428 - 12s - loss: 3.2427 - accuracy100: 0.3994 - val_loss: 3.3064 - val_accuracy100: 0.3608 - 12s/epoch - 28ms/step
Epoch 8/50
428/428 - 12s - loss: 3.2360 - accuracy100: 0.4057 - val_loss: 3.3014 - val_accuracy100: 0.3637 - 12s/epoch - 28ms/step
Epoch 9/50
428/428 - 12s - loss: 3.2308 - accuracy100: 0.4066 - val_loss: 3.2951 - val_accuracy100: 0.3638 - 12s/epoch - 28ms/step
Epoch 10/50
428/428 - 12s - loss: 3.2260 - accuracy100: 0.4100 - val_loss: 3.3078 - val_accuracy100: 0.3564 - 12s/epoch - 28ms/step
Epoch 11/50
428/428 - 12s - loss: 3.2231 - accuracy100: 0.4101 - val_loss: 3.3073 - val_accuracy100: 0.3599 - 12s/epoch - 29ms/step
Epoch 12/50
428/428 - 12s - loss: 3.2160 - accuracy100: 0.4122 - val_loss: 3.3037 - val_accuracy100: 0.3644 - 12s/epoch - 28ms/step
Epoch 13/50
428/428 - 12s - loss: 3.2090 - accuracy100: 0.4170 - val_loss: 3.2999 - val_accuracy100: 0.3619 - 12s/epoch - 28ms/step
Epoch 14/50
428/428 - 12s - loss: 3.2038 - accuracy100: 0.4196 - val_loss: 3.3070 - val_accuracy100: 0.3655 - 12s/epoch - 28ms/step
Epoch 15/50
428/428 - 12s - loss: 3.1985 - accuracy100: 0.4233 - val_loss: 3.3103 - val_accuracy100: 0.3668 - 12s/epoch - 28ms/step
Epoch 16/50
428/428 - 12s - loss: 3.1946 - accuracy100: 0.4238 - val_loss: 3.3065 - val_accuracy100: 0.3670 - 12s/epoch - 28ms/step
Epoch 17/50
428/428 - 12s - loss: 3.1891 - accuracy100: 0.4260 - val_loss: 3.3073 - val_accuracy100: 0.3677 - 12s/epoch - 29ms/step
Epoch 18/50
428/428 - 12s - loss: 3.1860 - accuracy100: 0.4266 - val_loss: 3.3139 - val_accuracy100: 0.3635 - 12s/epoch - 29ms/step
Epoch 19/50
428/428 - 12s - loss: 3.1825 - accuracy100: 0.4280 - val_loss: 3.3230 - val_accuracy100: 0.3643 - 12s/epoch - 28ms/step
testing model: results/PCAR/W10/deepVOL_L2/h100
Evaluating performance on  test set...
2104/2104 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1131978
{'0': {'precision': 0.41331181162172426, 'recall': 0.48051430710603865, 'f1-score': 0.444386742832794, 'support': 208358}, '1': {'precision': 0.25521778876485507, 'recall': 0.48025779148932735, 'f1-score': 0.3333090448458896, 'support': 123821}, '2': {'precision': 0.43236371675825913, 'recall': 0.13266176313825817, 'f1-score': 0.20302848286652872, 'support': 206382}, 'accuracy': 0.3471547327043733, 'macro avg': {'precision': 0.3669644390482795, 'recall': 0.364477953911208, 'f1-score': 0.32690809018173744, 'support': 538561}, 'weighted avg': {'precision': 0.38426516747505923, 'recall': 0.3471547327043733, 'f1-score': 0.32635786207315076, 'support': 538561}}
[[100119  85406  22833]
 [ 51243  59466  13112]
 [ 90874  88129  27379]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0867647
{'0': {'precision': 0.3988598797407398, 'recall': 0.4215173855633803, 'f1-score': 0.40987575064532095, 'support': 36352}, '1': {'precision': 0.37465298732649366, 'recall': 0.5954508084406687, 'f1-score': 0.4599248557972165, 'support': 36490}, '2': {'precision': 0.4244763797584467, 'recall': 0.15150605696824185, 'f1-score': 0.22330799855229821, 'support': 36652}, 'accuracy': 0.3890989460609714, 'macro avg': {'precision': 0.3993297489418934, 'recall': 0.38949141699076356, 'f1-score': 0.3643695349982785, 'support': 109494}, 'weighted avg': {'precision': 0.39936754641154504, 'recall': 0.3890989460609714, 'f1-score': 0.36410347634060286, 'support': 109494}}
[[15323 17176  3853]
 [11086 21728  3676]
 [12008 19091  5553]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0985688
{'0': {'precision': 0.37436023925510264, 'recall': 0.5013626228425139, 'f1-score': 0.4286521217256231, 'support': 12109}, '1': {'precision': 0.3434456435904185, 'recall': 0.46321114759918347, 'f1-score': 0.39443751653251713, 'support': 11267}, '2': {'precision': 0.416, 'recall': 0.14931801866475233, 'f1-score': 0.219756999471738, 'support': 12537}, 'accuracy': 0.3664968117394815, 'macro avg': {'precision': 0.37793529428184036, 'recall': 0.3712972630354832, 'f1-score': 0.3476155459099594, 'support': 35913}, 'weighted avg': {'precision': 0.37919756643759317, 'recall': 0.3664968117394815, 'f1-score': 0.34499400058821655, 'support': 35913}}
[[6071 4714 1324]
 [4744 5219 1304]
 [5402 5263 1872]]
training model: results/PCAR/W10/deepVOL_L2/h200
Epoch 1/50
428/428 - 15s - loss: 3.3272 - accuracy200: 0.3611 - val_loss: 3.3713 - val_accuracy200: 0.3275 - 15s/epoch - 34ms/step
Epoch 2/50
428/428 - 12s - loss: 3.2902 - accuracy200: 0.3694 - val_loss: 3.3622 - val_accuracy200: 0.3367 - 12s/epoch - 28ms/step
Epoch 3/50
428/428 - 12s - loss: 3.2765 - accuracy200: 0.3793 - val_loss: 3.3379 - val_accuracy200: 0.3463 - 12s/epoch - 28ms/step
Epoch 4/50
428/428 - 12s - loss: 3.2652 - accuracy200: 0.3874 - val_loss: 3.3176 - val_accuracy200: 0.3539 - 12s/epoch - 28ms/step
Epoch 5/50
428/428 - 12s - loss: 3.2536 - accuracy200: 0.3939 - val_loss: 3.3071 - val_accuracy200: 0.3517 - 12s/epoch - 28ms/step
Epoch 6/50
428/428 - 12s - loss: 3.2461 - accuracy200: 0.3984 - val_loss: 3.3047 - val_accuracy200: 0.3541 - 12s/epoch - 28ms/step
Epoch 7/50
428/428 - 12s - loss: 3.2392 - accuracy200: 0.4048 - val_loss: 3.2982 - val_accuracy200: 0.3594 - 12s/epoch - 28ms/step
Epoch 8/50
428/428 - 12s - loss: 3.2336 - accuracy200: 0.4058 - val_loss: 3.2995 - val_accuracy200: 0.3585 - 12s/epoch - 28ms/step
Epoch 9/50
428/428 - 12s - loss: 3.2272 - accuracy200: 0.4080 - val_loss: 3.2905 - val_accuracy200: 0.3650 - 12s/epoch - 28ms/step
Epoch 10/50
428/428 - 12s - loss: 3.2209 - accuracy200: 0.4127 - val_loss: 3.2970 - val_accuracy200: 0.3650 - 12s/epoch - 28ms/step
Epoch 11/50
428/428 - 12s - loss: 3.2148 - accuracy200: 0.4135 - val_loss: 3.3016 - val_accuracy200: 0.3622 - 12s/epoch - 28ms/step
Epoch 12/50
428/428 - 12s - loss: 3.2076 - accuracy200: 0.4179 - val_loss: 3.3086 - val_accuracy200: 0.3638 - 12s/epoch - 28ms/step
Epoch 13/50
428/428 - 12s - loss: 3.2035 - accuracy200: 0.4193 - val_loss: 3.3129 - val_accuracy200: 0.3612 - 12s/epoch - 28ms/step
Epoch 14/50
428/428 - 12s - loss: 3.1979 - accuracy200: 0.4213 - val_loss: 3.3117 - val_accuracy200: 0.3677 - 12s/epoch - 28ms/step
Epoch 15/50
428/428 - 12s - loss: 3.1910 - accuracy200: 0.4242 - val_loss: 3.3185 - val_accuracy200: 0.3601 - 12s/epoch - 28ms/step
Epoch 16/50
428/428 - 12s - loss: 3.1877 - accuracy200: 0.4256 - val_loss: 3.3218 - val_accuracy200: 0.3613 - 12s/epoch - 28ms/step
Epoch 17/50
428/428 - 12s - loss: 3.1804 - accuracy200: 0.4310 - val_loss: 3.3257 - val_accuracy200: 0.3636 - 12s/epoch - 28ms/step
Epoch 18/50
428/428 - 12s - loss: 3.1765 - accuracy200: 0.4313 - val_loss: 3.3373 - val_accuracy200: 0.3613 - 12s/epoch - 28ms/step
Epoch 19/50
428/428 - 12s - loss: 3.1728 - accuracy200: 0.4325 - val_loss: 3.3484 - val_accuracy200: 0.3517 - 12s/epoch - 28ms/step
testing model: results/PCAR/W10/deepVOL_L2/h200
Evaluating performance on  test set...
2104/2104 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.10552
{'0': {'precision': 0.40024045954490806, 'recall': 0.4288918155443579, 'f1-score': 0.4140711018155517, 'support': 209568}, '1': {'precision': 0.2676374921397518, 'recall': 0.4729739453003206, 'f1-score': 0.341840685056568, 'support': 125083}, '2': {'precision': 0.41362355017107444, 'recall': 0.18852925310185867, 'f1-score': 0.2590044870844731, 'support': 203910}, 'accuracy': 0.34812398224156593, 'macro avg': {'precision': 0.360500500618578, 'recall': 0.36346500464884574, 'f1-score': 0.33830542465219765, 'support': 538561}, 'weighted avg': {'precision': 0.3745099834013374, 'recall': 0.34812398224156593, 'f1-score': 0.33858395991467477, 'support': 538561}}
[[89882 82909 36777]
 [48200 59161 17722]
 [86488 78979 38443]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.085907
{'0': {'precision': 0.38815327384823495, 'recall': 0.4082129568833443, 'f1-score': 0.397930473510861, 'support': 36552}, '1': {'precision': 0.3888004683240949, 'recall': 0.5875539091009621, 'f1-score': 0.4679473771123466, 'support': 36172}, '2': {'precision': 0.4008541793776693, 'recall': 0.1786782703290726, 'f1-score': 0.2471783295711061, 'support': 36770}, 'accuracy': 0.390377554934517, 'macro avg': {'precision': 0.3926026405166663, 'recall': 0.39148171210445964, 'f1-score': 0.37101872673143793, 'support': 109494}, 'weighted avg': {'precision': 0.39263226461392176, 'recall': 0.390377554934517, 'f1-score': 0.370435771558317, 'support': 109494}}
[[14921 15964  5667]
 [10766 21253  4153]
 [12754 17446  6570]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0984231
{'0': {'precision': 0.3617954340255385, 'recall': 0.4597983771821982, 'f1-score': 0.4049518172303028, 'support': 12201}, '1': {'precision': 0.3470770136945958, 'recall': 0.4281951130892906, 'f1-score': 0.38339229799520147, 'support': 11009}, '2': {'precision': 0.3898901098901099, 'recall': 0.20947807604502874, 'f1-score': 0.2725317492830807, 'support': 12703}, 'accuracy': 0.3615682343441094, 'macro avg': {'precision': 0.3662541858700814, 'recall': 0.36582385543883916, 'f1-score': 0.3536252881695283, 'support': 35913}, 'weighted avg': {'precision': 0.3672210898628203, 'recall': 0.3615682343441094, 'f1-score': 0.3515037379722962, 'support': 35913}}
[[5610 4293 2298]
 [4429 4714 1866]
 [5467 4575 2661]]
training model: results/PCAR/W10/deepVOL_L2/h300
Epoch 1/50
428/428 - 14s - loss: 3.3415 - accuracy300: 0.3486 - val_loss: 3.4104 - val_accuracy300: 0.3231 - 14s/epoch - 33ms/step
Epoch 2/50
428/428 - 12s - loss: 3.2978 - accuracy300: 0.3580 - val_loss: 3.3166 - val_accuracy300: 0.3378 - 12s/epoch - 29ms/step
Epoch 3/50
428/428 - 12s - loss: 3.2810 - accuracy300: 0.3693 - val_loss: 3.3045 - val_accuracy300: 0.3466 - 12s/epoch - 28ms/step
Epoch 4/50
428/428 - 12s - loss: 3.2732 - accuracy300: 0.3763 - val_loss: 3.3002 - val_accuracy300: 0.3493 - 12s/epoch - 28ms/step
Epoch 5/50
428/428 - 12s - loss: 3.2642 - accuracy300: 0.3832 - val_loss: 3.2975 - val_accuracy300: 0.3506 - 12s/epoch - 28ms/step
Epoch 6/50
428/428 - 12s - loss: 3.2579 - accuracy300: 0.3876 - val_loss: 3.3005 - val_accuracy300: 0.3535 - 12s/epoch - 28ms/step
Epoch 7/50
428/428 - 12s - loss: 3.2523 - accuracy300: 0.3920 - val_loss: 3.3016 - val_accuracy300: 0.3517 - 12s/epoch - 29ms/step
Epoch 8/50
428/428 - 12s - loss: 3.2475 - accuracy300: 0.3956 - val_loss: 3.3095 - val_accuracy300: 0.3505 - 12s/epoch - 28ms/step
Epoch 9/50
428/428 - 12s - loss: 3.2431 - accuracy300: 0.3991 - val_loss: 3.3160 - val_accuracy300: 0.3452 - 12s/epoch - 27ms/step
Epoch 10/50
428/428 - 12s - loss: 3.2353 - accuracy300: 0.4027 - val_loss: 3.3131 - val_accuracy300: 0.3471 - 12s/epoch - 29ms/step
Epoch 11/50
428/428 - 12s - loss: 3.2331 - accuracy300: 0.4039 - val_loss: 3.3210 - val_accuracy300: 0.3455 - 12s/epoch - 28ms/step
Epoch 12/50
428/428 - 12s - loss: 3.2262 - accuracy300: 0.4091 - val_loss: 3.3244 - val_accuracy300: 0.3500 - 12s/epoch - 28ms/step
Epoch 13/50
428/428 - 12s - loss: 3.2206 - accuracy300: 0.4107 - val_loss: 3.3162 - val_accuracy300: 0.3530 - 12s/epoch - 28ms/step
Epoch 14/50
428/428 - 12s - loss: 3.2141 - accuracy300: 0.4147 - val_loss: 3.3220 - val_accuracy300: 0.3502 - 12s/epoch - 28ms/step
Epoch 15/50
428/428 - 12s - loss: 3.2077 - accuracy300: 0.4172 - val_loss: 3.3253 - val_accuracy300: 0.3517 - 12s/epoch - 28ms/step
testing model: results/PCAR/W10/deepVOL_L2/h300
Evaluating performance on  test set...
2104/2104 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1002946
{'0': {'precision': 0.3949108386497687, 'recall': 0.4355418373539675, 'f1-score': 0.4142323752491409, 'support': 210912}, '1': {'precision': 0.26479325331951037, 'recall': 0.42222133916153387, 'f1-score': 0.32547012317089236, 'support': 125825}, '2': {'precision': 0.3938205607831594, 'recall': 0.2055057872205486, 'f1-score': 0.2700779120990034, 'support': 201824}, 'accuracy': 0.34622447596465394, 'macro avg': {'precision': 0.3511748842508129, 'recall': 0.35442298791201665, 'f1-score': 0.3365934701730122, 'support': 538561}, 'weighted avg': {'precision': 0.3641026490216109, 'recall': 0.34622447596465394, 'f1-score': 0.3394732658101749, 'support': 538561}}
[[91861 76815 42236]
 [51094 53126 21605]
 [89657 70691 41476]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0879043
{'0': {'precision': 0.3840672251736821, 'recall': 0.40983919324066503, 'f1-score': 0.396534901505762, 'support': 36690}, '1': {'precision': 0.3813903743315508, 'recall': 0.547986924087061, 'f1-score': 0.449756925334801, 'support': 35791}, '2': {'precision': 0.39118253422847177, 'recall': 0.19992975441061248, 'f1-score': 0.2646164848918291, 'support': 37013}, 'accuracy': 0.384039308089941, 'macro avg': {'precision': 0.38554671124456824, 'recall': 0.3859186239127795, 'f1-score': 0.370302770577464, 'support': 109494}, 'weighted avg': {'precision': 0.3855974621323667, 'recall': 0.384039308089941, 'f1-score': 0.36933864509658554, 'support': 109494}}
[[15037 15428  6225]
 [10886 19613  5292]
 [13229 16384  7400]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0997574
{'0': {'precision': 0.35327334781259695, 'recall': 0.4690615473345967, 'f1-score': 0.4030157157015433, 'support': 12137}, '1': {'precision': 0.3372888015717092, 'recall': 0.38982742960944594, 'f1-score': 0.3616599957868127, 'support': 11010}, '2': {'precision': 0.37890569772373817, 'recall': 0.20993263355788813, 'f1-score': 0.27017490800947624, 'support': 12766}, 'accuracy': 0.352657811934397, 'macro avg': {'precision': 0.3564892823693481, 'recall': 0.35627387016731027, 'f1-score': 0.3449502064992774, 'support': 35913}, 'weighted avg': {'precision': 0.3574844336270222, 'recall': 0.352657811934397, 'f1-score': 0.3431161743861948, 'support': 35913}}
[[5693 4142 2302]
 [4627 4292 2091]
 [5795 4291 2680]]
training model: results/PCAR/W10/deepVOL_L2/h500
Epoch 1/50
428/428 - 14s - loss: 3.3518 - accuracy500: 0.3492 - val_loss: 3.3311 - val_accuracy500: 0.3424 - 14s/epoch - 34ms/step
Epoch 2/50
428/428 - 12s - loss: 3.3152 - accuracy500: 0.3565 - val_loss: 3.3112 - val_accuracy500: 0.3444 - 12s/epoch - 28ms/step
Epoch 3/50
428/428 - 12s - loss: 3.2934 - accuracy500: 0.3625 - val_loss: 3.3043 - val_accuracy500: 0.3421 - 12s/epoch - 29ms/step
Epoch 4/50
428/428 - 12s - loss: 3.2862 - accuracy500: 0.3660 - val_loss: 3.2992 - val_accuracy500: 0.3459 - 12s/epoch - 28ms/step
Epoch 5/50
428/428 - 12s - loss: 3.2754 - accuracy500: 0.3719 - val_loss: 3.3007 - val_accuracy500: 0.3415 - 12s/epoch - 28ms/step
Epoch 6/50
428/428 - 12s - loss: 3.2703 - accuracy500: 0.3778 - val_loss: 3.3019 - val_accuracy500: 0.3385 - 12s/epoch - 28ms/step
Epoch 7/50
428/428 - 12s - loss: 3.2644 - accuracy500: 0.3813 - val_loss: 3.3077 - val_accuracy500: 0.3393 - 12s/epoch - 28ms/step
Epoch 8/50
428/428 - 12s - loss: 3.2584 - accuracy500: 0.3865 - val_loss: 3.3093 - val_accuracy500: 0.3392 - 12s/epoch - 28ms/step
Epoch 9/50
428/428 - 12s - loss: 3.2543 - accuracy500: 0.3873 - val_loss: 3.3131 - val_accuracy500: 0.3416 - 12s/epoch - 28ms/step
Epoch 10/50
428/428 - 12s - loss: 3.2485 - accuracy500: 0.3930 - val_loss: 3.3164 - val_accuracy500: 0.3397 - 12s/epoch - 29ms/step
Epoch 11/50
428/428 - 12s - loss: 3.2432 - accuracy500: 0.3937 - val_loss: 3.3181 - val_accuracy500: 0.3430 - 12s/epoch - 29ms/step
Epoch 12/50
428/428 - 12s - loss: 3.2384 - accuracy500: 0.3981 - val_loss: 3.3208 - val_accuracy500: 0.3422 - 12s/epoch - 28ms/step
Epoch 13/50
428/428 - 12s - loss: 3.2323 - accuracy500: 0.4036 - val_loss: 3.3365 - val_accuracy500: 0.3395 - 12s/epoch - 28ms/step
Epoch 14/50
428/428 - 12s - loss: 3.2258 - accuracy500: 0.4049 - val_loss: 3.3374 - val_accuracy500: 0.3407 - 12s/epoch - 28ms/step
testing model: results/PCAR/W10/deepVOL_L2/h500
Evaluating performance on  test set...
2104/2104 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0939901
{'0': {'precision': 0.38505618021809984, 'recall': 0.47266420585659896, 'f1-score': 0.4243860273996404, 'support': 206707}, '1': {'precision': 0.2753014836841816, 'recall': 0.26829175045686365, 'f1-score': 0.27175142118062545, 'support': 130783}, '2': {'precision': 0.38489937790317147, 'recall': 0.30124682326143504, 'f1-score': 0.3379737865540311, 'support': 201071}, 'accuracy': 0.3590363951344416, 'macro avg': {'precision': 0.348419013935151, 'recall': 0.34740092652496585, 'f1-score': 0.34470374504476564, 'support': 538561}, 'weighted avg': {'precision': 0.3583450428073694, 'recall': 0.3590363951344416, 'f1-score': 0.3550586765810535, 'support': 538561}}
[[97703 47695 61309]
 [60205 35088 35490]
 [95829 44670 60572]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0934653
{'0': {'precision': 0.35331458583185144, 'recall': 0.4699653446284174, 'f1-score': 0.40337582625118035, 'support': 36358}, '1': {'precision': 0.38944791949959207, 'recall': 0.3578012215435869, 'f1-score': 0.37295443693661107, 'support': 36020}, '2': {'precision': 0.36349370519633367, 'recall': 0.2745985558788663, 'f1-score': 0.31285396362520146, 'support': 37116}, 'accuracy': 0.3668420187407529, 'macro avg': {'precision': 0.3687520701759257, 'recall': 0.3674550406836235, 'f1-score': 0.36306140893766425, 'support': 109494}, 'weighted avg': {'precision': 0.36865178123108916, 'recall': 0.3668420187407529, 'f1-score': 0.3626832961003354, 'support': 109494}}
[[17087  9792  9479]
 [14764 12888  8368]
 [16511 10413 10192]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994838
{'0': {'precision': 0.3420528859823713, 'recall': 0.4909402546523017, 'f1-score': 0.4031906693032141, 'support': 12252}, '1': {'precision': 0.33251231527093594, 'recall': 0.23529951380607284, 'f1-score': 0.2755842062852538, 'support': 10901}, '2': {'precision': 0.36122102882984736, 'recall': 0.30047021943573665, 'f1-score': 0.32805681526482416, 'support': 12760}, 'accuracy': 0.3456686993567789, 'macro avg': {'precision': 0.34526207669438486, 'recall': 0.3422366626313704, 'f1-score': 0.33561056361776404, 'support': 35913}, 'weighted avg': {'precision': 0.345967450107018, 'recall': 0.3456686993567789, 'f1-score': 0.33776182651958025, 'support': 35913}}
[[6015 2584 3653]
 [5209 2565 3127]
 [6361 2565 3834]]
training model: results/PCAR/W10/deepVOL_L2/h1000
Epoch 1/50
428/428 - 14s - loss: 3.3546 - accuracy1000: 0.3513 - val_loss: 3.3777 - val_accuracy1000: 0.3375 - 14s/epoch - 33ms/step
Epoch 2/50
428/428 - 12s - loss: 3.3162 - accuracy1000: 0.3548 - val_loss: 3.3060 - val_accuracy1000: 0.3446 - 12s/epoch - 28ms/step
Epoch 3/50
428/428 - 12s - loss: 3.2946 - accuracy1000: 0.3633 - val_loss: 3.3063 - val_accuracy1000: 0.3458 - 12s/epoch - 28ms/step
Epoch 4/50
428/428 - 12s - loss: 3.2851 - accuracy1000: 0.3698 - val_loss: 3.3014 - val_accuracy1000: 0.3483 - 12s/epoch - 28ms/step
Epoch 5/50
428/428 - 12s - loss: 3.2747 - accuracy1000: 0.3783 - val_loss: 3.3116 - val_accuracy1000: 0.3439 - 12s/epoch - 28ms/step
Epoch 6/50
428/428 - 12s - loss: 3.2670 - accuracy1000: 0.3830 - val_loss: 3.3117 - val_accuracy1000: 0.3459 - 12s/epoch - 28ms/step
Epoch 7/50
428/428 - 12s - loss: 3.2620 - accuracy1000: 0.3852 - val_loss: 3.3085 - val_accuracy1000: 0.3459 - 12s/epoch - 28ms/step
Epoch 8/50
428/428 - 12s - loss: 3.2569 - accuracy1000: 0.3888 - val_loss: 3.3068 - val_accuracy1000: 0.3459 - 12s/epoch - 28ms/step
Epoch 9/50
428/428 - 12s - loss: 3.2502 - accuracy1000: 0.3946 - val_loss: 3.3057 - val_accuracy1000: 0.3446 - 12s/epoch - 28ms/step
Epoch 10/50
428/428 - 12s - loss: 3.2441 - accuracy1000: 0.3976 - val_loss: 3.3036 - val_accuracy1000: 0.3507 - 12s/epoch - 28ms/step
Epoch 11/50
428/428 - 12s - loss: 3.2354 - accuracy1000: 0.4035 - val_loss: 3.3103 - val_accuracy1000: 0.3446 - 12s/epoch - 29ms/step
Epoch 12/50
428/428 - 12s - loss: 3.2286 - accuracy1000: 0.4054 - val_loss: 3.3107 - val_accuracy1000: 0.3516 - 12s/epoch - 29ms/step
Epoch 13/50
428/428 - 12s - loss: 3.2229 - accuracy1000: 0.4108 - val_loss: 3.3169 - val_accuracy1000: 0.3515 - 12s/epoch - 29ms/step
Epoch 14/50
428/428 - 12s - loss: 3.2200 - accuracy1000: 0.4137 - val_loss: 3.3283 - val_accuracy1000: 0.3445 - 12s/epoch - 29ms/step
testing model: results/PCAR/W10/deepVOL_L2/h1000
Evaluating performance on  test set...
2104/2104 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0938168
{'0': {'precision': 0.3894033237260072, 'recall': 0.4886847358168394, 'f1-score': 0.43343138154119837, 'support': 207905}, '1': {'precision': 0.2610847477364698, 'recall': 0.20988578917805653, 'f1-score': 0.23270236257249247, 'support': 128184}, '2': {'precision': 0.38945716543911296, 'recall': 0.3358489075032597, 'f1-score': 0.3606719105533662, 'support': 202472}, 'accuracy': 0.3648686035565145, 'macro avg': {'precision': 0.34664841230053, 'recall': 0.34480647749938526, 'f1-score': 0.34226855155568564, 'support': 538561}, 'weighted avg': {'precision': 0.35888220001800214, 'recall': 0.3648686035565145, 'f1-score': 0.3583015370531405, 'support': 538561}}
[[101600  39618  66687]
 [ 61365  26904  39915]
 [ 97947  36525  68000]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0925891
{'0': {'precision': 0.36581290581840487, 'recall': 0.475844613183669, 'f1-score': 0.4136364179889751, 'support': 36348}, '1': {'precision': 0.40410863992240004, 'recall': 0.3179687074088208, 'f1-score': 0.35590065901879425, 'support': 36686}, '2': {'precision': 0.3537949440729301, 'recall': 0.3235874931431706, 'f1-score': 0.3380176773102984, 'support': 36460}, 'accuracy': 0.3722487076917457, 'macro avg': {'precision': 0.37457216327124493, 'recall': 0.3724669379118868, 'f1-score': 0.36918491810602266, 'support': 109494}, 'weighted avg': {'precision': 0.3746420874730997, 'recall': 0.3722487076917457, 'f1-score': 0.3691120299976276, 'support': 109494}}
[[17296  8297 10755]
 [14227 11665 10794]
 [15758  8904 11798]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001996
{'0': {'precision': 0.346119436367703, 'recall': 0.5079599540456261, 'f1-score': 0.4117060192883273, 'support': 12186}, '1': {'precision': 0.3226406988400401, 'recall': 0.2077072001475062, 'f1-score': 0.25272013460459897, 'support': 10847}, '2': {'precision': 0.36583378598587724, 'recall': 0.31374223602484475, 'f1-score': 0.33779152386525124, 'support': 12880}, 'accuracy': 0.34761785425890346, 'macro avg': {'precision': 0.3448646403978734, 'recall': 0.34313646340599235, 'f1-score': 0.33407255925272583, 'support': 35913}, 'weighted avg': {'precision': 0.34609846783596027, 'recall': 0.34761785425890346, 'f1-score': 0.3371776147492016, 'support': 35913}}
[[6190 2343 3653]
 [5242 2253 3352]
 [6452 2387 4041]]
training model: results/PCAR/W10/deepVOL_L3/h10
Epoch 1/50
428/428 - 21s - loss: 3.3243 - accuracy10: 0.3620 - val_loss: 3.3349 - val_accuracy10: 0.3231 - 21s/epoch - 49ms/step
Epoch 2/50
428/428 - 17s - loss: 3.2843 - accuracy10: 0.3648 - val_loss: 3.3263 - val_accuracy10: 0.3290 - 17s/epoch - 40ms/step
Epoch 3/50
428/428 - 17s - loss: 3.2581 - accuracy10: 0.3848 - val_loss: 3.2716 - val_accuracy10: 0.3769 - 17s/epoch - 41ms/step
Epoch 4/50
428/428 - 17s - loss: 3.2198 - accuracy10: 0.4126 - val_loss: 3.2373 - val_accuracy10: 0.3988 - 17s/epoch - 40ms/step
Epoch 5/50
428/428 - 17s - loss: 3.1871 - accuracy10: 0.4272 - val_loss: 3.2225 - val_accuracy10: 0.4072 - 17s/epoch - 40ms/step
Epoch 6/50
428/428 - 17s - loss: 3.1537 - accuracy10: 0.4421 - val_loss: 3.1707 - val_accuracy10: 0.4347 - 17s/epoch - 40ms/step
Epoch 7/50
428/428 - 17s - loss: 3.1264 - accuracy10: 0.4560 - val_loss: 3.1547 - val_accuracy10: 0.4437 - 17s/epoch - 40ms/step
Epoch 8/50
428/428 - 18s - loss: 3.1112 - accuracy10: 0.4619 - val_loss: 3.1357 - val_accuracy10: 0.4515 - 18s/epoch - 42ms/step
Epoch 9/50
428/428 - 17s - loss: 3.1000 - accuracy10: 0.4665 - val_loss: 3.1440 - val_accuracy10: 0.4501 - 17s/epoch - 40ms/step
Epoch 10/50
428/428 - 17s - loss: 3.0862 - accuracy10: 0.4707 - val_loss: 3.1333 - val_accuracy10: 0.4538 - 17s/epoch - 40ms/step
Epoch 11/50
428/428 - 17s - loss: 3.0766 - accuracy10: 0.4716 - val_loss: 3.1397 - val_accuracy10: 0.4504 - 17s/epoch - 40ms/step
Epoch 12/50
428/428 - 18s - loss: 3.0656 - accuracy10: 0.4769 - val_loss: 3.1218 - val_accuracy10: 0.4576 - 18s/epoch - 42ms/step
Epoch 13/50
428/428 - 18s - loss: 3.0550 - accuracy10: 0.4798 - val_loss: 3.1222 - val_accuracy10: 0.4576 - 18s/epoch - 41ms/step
Epoch 14/50
428/428 - 18s - loss: 3.0481 - accuracy10: 0.4827 - val_loss: 3.1156 - val_accuracy10: 0.4598 - 18s/epoch - 42ms/step
Epoch 15/50
428/428 - 18s - loss: 3.0421 - accuracy10: 0.4842 - val_loss: 3.1148 - val_accuracy10: 0.4611 - 18s/epoch - 41ms/step
Epoch 16/50
428/428 - 18s - loss: 3.0366 - accuracy10: 0.4855 - val_loss: 3.1160 - val_accuracy10: 0.4613 - 18s/epoch - 42ms/step
Epoch 17/50
428/428 - 18s - loss: 3.0314 - accuracy10: 0.4867 - val_loss: 3.1189 - val_accuracy10: 0.4602 - 18s/epoch - 42ms/step
Epoch 18/50
428/428 - 18s - loss: 3.0269 - accuracy10: 0.4878 - val_loss: 3.1108 - val_accuracy10: 0.4630 - 18s/epoch - 42ms/step
Epoch 19/50
428/428 - 18s - loss: 3.0214 - accuracy10: 0.4895 - val_loss: 3.1112 - val_accuracy10: 0.4652 - 18s/epoch - 42ms/step
Epoch 20/50
428/428 - 18s - loss: 3.0151 - accuracy10: 0.4915 - val_loss: 3.1102 - val_accuracy10: 0.4635 - 18s/epoch - 42ms/step
Epoch 21/50
428/428 - 17s - loss: 3.0110 - accuracy10: 0.4928 - val_loss: 3.1150 - val_accuracy10: 0.4628 - 17s/epoch - 41ms/step
Epoch 22/50
428/428 - 17s - loss: 3.0051 - accuracy10: 0.4947 - val_loss: 3.1072 - val_accuracy10: 0.4658 - 17s/epoch - 41ms/step
Epoch 23/50
428/428 - 17s - loss: 2.9988 - accuracy10: 0.4968 - val_loss: 3.1112 - val_accuracy10: 0.4654 - 17s/epoch - 41ms/step
Epoch 24/50
428/428 - 18s - loss: 2.9967 - accuracy10: 0.4973 - val_loss: 3.1122 - val_accuracy10: 0.4669 - 18s/epoch - 41ms/step
Epoch 25/50
428/428 - 17s - loss: 2.9931 - accuracy10: 0.4987 - val_loss: 3.1168 - val_accuracy10: 0.4641 - 17s/epoch - 41ms/step
Epoch 26/50
428/428 - 18s - loss: 2.9841 - accuracy10: 0.5004 - val_loss: 3.1200 - val_accuracy10: 0.4658 - 18s/epoch - 41ms/step
Epoch 27/50
428/428 - 17s - loss: 2.9820 - accuracy10: 0.5004 - val_loss: 3.1221 - val_accuracy10: 0.4653 - 17s/epoch - 40ms/step
Epoch 28/50
428/428 - 17s - loss: 2.9760 - accuracy10: 0.5021 - val_loss: 3.1162 - val_accuracy10: 0.4647 - 17s/epoch - 40ms/step
Epoch 29/50
428/428 - 17s - loss: 2.9726 - accuracy10: 0.5042 - val_loss: 3.1251 - val_accuracy10: 0.4641 - 17s/epoch - 40ms/step
Epoch 30/50
428/428 - 18s - loss: 2.9675 - accuracy10: 0.5065 - val_loss: 3.1297 - val_accuracy10: 0.4633 - 18s/epoch - 41ms/step
Epoch 31/50
428/428 - 18s - loss: 2.9648 - accuracy10: 0.5065 - val_loss: 3.1290 - val_accuracy10: 0.4603 - 18s/epoch - 41ms/step
Epoch 32/50
428/428 - 17s - loss: 2.9607 - accuracy10: 0.5075 - val_loss: 3.1192 - val_accuracy10: 0.4664 - 17s/epoch - 41ms/step
testing model: results/PCAR/W10/deepVOL_L3/h10
Evaluating performance on  test set...
2104/2104 - 39s - 39s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0439397
{'0': {'precision': 0.5127477533894855, 'recall': 0.5958185142399738, 'f1-score': 0.5511706670593433, 'support': 219874}, '1': {'precision': 0.2997121855707606, 'recall': 0.2763478518226212, 'f1-score': 0.2875562034204529, 'support': 101365}, '2': {'precision': 0.5280376789274375, 'recall': 0.46068506639916806, 'f1-score': 0.4920673147811385, 'support': 217322}, 'accuracy': 0.4811599800208333, 'macro avg': {'precision': 0.44683253929589456, 'recall': 0.4442838108205877, 'f1-score': 0.44359806175364486, 'support': 538561}, 'weighted avg': {'precision': 0.4788212100003684, 'recall': 0.4811599800208333, 'f1-score': 0.4777050079593339, 'support': 538561}}
[[131005  31701  57168]
 [ 41036  28012  32317]
 [ 83455  33750 100117]]
Evaluating performance on  train set...
428/428 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0111706
{'0': {'precision': 0.4870339151130504, 'recall': 0.5417965194848176, 'f1-score': 0.5129577648671584, 'support': 36259}, '1': {'precision': 0.4874539877300613, 'recall': 0.4394148877336578, 'f1-score': 0.46218951777092665, 'support': 36164}, '2': {'precision': 0.4891678975873954, 'recall': 0.4823986404467104, 'f1-score': 0.4857596870798191, 'support': 37071}, 'accuracy': 0.4878714815423676, 'macro avg': {'precision': 0.487885266810169, 'recall': 0.48787001588839524, 'f1-score': 0.4869689899059681, 'support': 109494}, 'weighted avg': {'precision': 0.4878951529016784, 'recall': 0.4878714815423676, 'f1-score': 0.48698152114930543, 'support': 109494}}
[[19645  8041  8573]
 [10171 15891 10102]
 [10520  8668 17883]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0362453
{'0': {'precision': 0.45849980667611806, 'recall': 0.5849708131217627, 'f1-score': 0.5140710234456848, 'support': 12163}, '1': {'precision': 0.4650190114068441, 'recall': 0.3241166077738516, 'f1-score': 0.3819885476314419, 'support': 11320}, '2': {'precision': 0.4730107956817273, 'recall': 0.4758648431214803, 'f1-score': 0.47443352717064374, 'support': 12430}, 'accuracy': 0.4649848244368335, 'macro avg': {'precision': 0.46550987125489646, 'recall': 0.4616507546723649, 'f1-score': 0.4568310327492568, 'support': 35913}, 'weighted avg': {'precision': 0.4655771600270367, 'recall': 0.4649848244368335, 'f1-score': 0.45871870799122566, 'support': 35913}}
[[7115 1927 3121]
 [4182 3669 3469]
 [4221 2294 5915]]
training model: results/PCAR/W10/deepVOL_L3/h20
Epoch 1/50
428/428 - 20s - loss: 3.3300 - accuracy20: 0.3566 - val_loss: 3.3578 - val_accuracy20: 0.3338 - 20s/epoch - 47ms/step
Epoch 2/50
428/428 - 17s - loss: 3.2944 - accuracy20: 0.3646 - val_loss: 3.3031 - val_accuracy20: 0.3458 - 17s/epoch - 39ms/step
Epoch 3/50
428/428 - 17s - loss: 3.2718 - accuracy20: 0.3780 - val_loss: 3.2842 - val_accuracy20: 0.3607 - 17s/epoch - 39ms/step
Epoch 4/50
428/428 - 18s - loss: 3.2452 - accuracy20: 0.3962 - val_loss: 3.2725 - val_accuracy20: 0.3833 - 18s/epoch - 42ms/step
Epoch 5/50
428/428 - 17s - loss: 3.2165 - accuracy20: 0.4159 - val_loss: 3.2538 - val_accuracy20: 0.3948 - 17s/epoch - 39ms/step
Epoch 6/50
428/428 - 17s - loss: 3.1950 - accuracy20: 0.4285 - val_loss: 3.2209 - val_accuracy20: 0.4123 - 17s/epoch - 39ms/step
Epoch 7/50
428/428 - 17s - loss: 3.1819 - accuracy20: 0.4335 - val_loss: 3.2292 - val_accuracy20: 0.4151 - 17s/epoch - 39ms/step
Epoch 8/50
428/428 - 17s - loss: 3.1718 - accuracy20: 0.4390 - val_loss: 3.2299 - val_accuracy20: 0.4171 - 17s/epoch - 39ms/step
Epoch 9/50
428/428 - 16s - loss: 3.1588 - accuracy20: 0.4450 - val_loss: 3.2236 - val_accuracy20: 0.4180 - 16s/epoch - 38ms/step
Epoch 10/50
428/428 - 16s - loss: 3.1484 - accuracy20: 0.4484 - val_loss: 3.2228 - val_accuracy20: 0.4188 - 16s/epoch - 38ms/step
Epoch 11/50
428/428 - 16s - loss: 3.1428 - accuracy20: 0.4483 - val_loss: 3.1971 - val_accuracy20: 0.4272 - 16s/epoch - 38ms/step
Epoch 12/50
428/428 - 16s - loss: 3.1361 - accuracy20: 0.4523 - val_loss: 3.1915 - val_accuracy20: 0.4282 - 16s/epoch - 39ms/step
Epoch 13/50
428/428 - 16s - loss: 3.1288 - accuracy20: 0.4536 - val_loss: 3.1919 - val_accuracy20: 0.4278 - 16s/epoch - 38ms/step
Epoch 14/50
428/428 - 17s - loss: 3.1235 - accuracy20: 0.4564 - val_loss: 3.1895 - val_accuracy20: 0.4278 - 17s/epoch - 39ms/step
Epoch 15/50
428/428 - 16s - loss: 3.1173 - accuracy20: 0.4588 - val_loss: 3.1985 - val_accuracy20: 0.4249 - 16s/epoch - 38ms/step
Epoch 16/50
428/428 - 16s - loss: 3.1122 - accuracy20: 0.4602 - val_loss: 3.1913 - val_accuracy20: 0.4299 - 16s/epoch - 38ms/step
Epoch 17/50
428/428 - 17s - loss: 3.1041 - accuracy20: 0.4640 - val_loss: 3.2054 - val_accuracy20: 0.4257 - 17s/epoch - 40ms/step
Epoch 18/50
428/428 - 17s - loss: 3.0991 - accuracy20: 0.4649 - val_loss: 3.1905 - val_accuracy20: 0.4309 - 17s/epoch - 39ms/step
Epoch 19/50
428/428 - 17s - loss: 3.0959 - accuracy20: 0.4668 - val_loss: 3.1941 - val_accuracy20: 0.4267 - 17s/epoch - 40ms/step
Epoch 20/50
428/428 - 16s - loss: 3.0915 - accuracy20: 0.4663 - val_loss: 3.1976 - val_accuracy20: 0.4273 - 16s/epoch - 39ms/step
Epoch 21/50
428/428 - 18s - loss: 3.0872 - accuracy20: 0.4692 - val_loss: 3.1878 - val_accuracy20: 0.4298 - 18s/epoch - 41ms/step
Epoch 22/50
428/428 - 16s - loss: 3.0850 - accuracy20: 0.4674 - val_loss: 3.1891 - val_accuracy20: 0.4267 - 16s/epoch - 38ms/step
Epoch 23/50
428/428 - 16s - loss: 3.0830 - accuracy20: 0.4699 - val_loss: 3.1909 - val_accuracy20: 0.4276 - 16s/epoch - 38ms/step
Epoch 24/50
428/428 - 17s - loss: 3.0775 - accuracy20: 0.4715 - val_loss: 3.1951 - val_accuracy20: 0.4267 - 17s/epoch - 39ms/step
Epoch 25/50
428/428 - 17s - loss: 3.0722 - accuracy20: 0.4732 - val_loss: 3.1926 - val_accuracy20: 0.4298 - 17s/epoch - 40ms/step
Epoch 26/50
428/428 - 17s - loss: 3.0699 - accuracy20: 0.4745 - val_loss: 3.1841 - val_accuracy20: 0.4339 - 17s/epoch - 40ms/step
Epoch 27/50
428/428 - 17s - loss: 3.0658 - accuracy20: 0.4744 - val_loss: 3.1815 - val_accuracy20: 0.4365 - 17s/epoch - 40ms/step
Epoch 28/50
428/428 - 16s - loss: 3.0620 - accuracy20: 0.4762 - val_loss: 3.1960 - val_accuracy20: 0.4289 - 16s/epoch - 39ms/step
Epoch 29/50
428/428 - 17s - loss: 3.0576 - accuracy20: 0.4776 - val_loss: 3.1917 - val_accuracy20: 0.4319 - 17s/epoch - 39ms/step
Epoch 30/50
428/428 - 17s - loss: 3.0546 - accuracy20: 0.4788 - val_loss: 3.1982 - val_accuracy20: 0.4326 - 17s/epoch - 39ms/step
Epoch 31/50
428/428 - 17s - loss: 3.0509 - accuracy20: 0.4790 - val_loss: 3.1970 - val_accuracy20: 0.4317 - 17s/epoch - 39ms/step
Epoch 32/50
428/428 - 17s - loss: 3.0481 - accuracy20: 0.4812 - val_loss: 3.2026 - val_accuracy20: 0.4354 - 17s/epoch - 39ms/step
Epoch 33/50
428/428 - 17s - loss: 3.0440 - accuracy20: 0.4820 - val_loss: 3.2082 - val_accuracy20: 0.4327 - 17s/epoch - 39ms/step
Epoch 34/50
428/428 - 16s - loss: 3.0399 - accuracy20: 0.4827 - val_loss: 3.2078 - val_accuracy20: 0.4305 - 16s/epoch - 38ms/step
Epoch 35/50
428/428 - 17s - loss: 3.0361 - accuracy20: 0.4849 - val_loss: 3.2153 - val_accuracy20: 0.4319 - 17s/epoch - 39ms/step
Epoch 36/50
428/428 - 17s - loss: 3.0329 - accuracy20: 0.4845 - val_loss: 3.2230 - val_accuracy20: 0.4281 - 17s/epoch - 39ms/step
Epoch 37/50
428/428 - 16s - loss: 3.0279 - accuracy20: 0.4871 - val_loss: 3.2275 - val_accuracy20: 0.4291 - 16s/epoch - 38ms/step
testing model: results/PCAR/W10/deepVOL_L3/h20
Evaluating performance on  test set...
2104/2104 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0694891
{'0': {'precision': 0.4845416164310028, 'recall': 0.5355562043245686, 'f1-score': 0.5087733032129638, 'support': 212368}, '1': {'precision': 0.2791299576573872, 'recall': 0.23048384339203282, 'f1-score': 0.2524850987718485, 'support': 116980}, '2': {'precision': 0.48707060861509066, 'recall': 0.4824795782288864, 'f1-score': 0.4847642236597559, 'support': 209213}, 'accuracy': 0.44867340932596306, 'macro avg': {'precision': 0.4169140609011602, 'recall': 0.41617320864849594, 'f1-score': 0.415340875214856, 'support': 538561}, 'weighted avg': {'precision': 0.44090689761265545, 'recall': 0.44867340932596306, 'f1-score': 0.44377861233098953, 'support': 538561}}
[[113735  34089  64544]
 [ 48262  26962  41756]
 [ 72730  35542 100941]]
Evaluating performance on  train set...
428/428 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0352849
{'0': {'precision': 0.46959843088675546, 'recall': 0.5012810270255379, 'f1-score': 0.4849227817234533, 'support': 36299}, '1': {'precision': 0.44086156551226097, 'recall': 0.38820536923885096, 'f1-score': 0.4128613014202123, 'support': 36169}, '2': {'precision': 0.47283852225107337, 'recall': 0.49673202614379086, 'f1-score': 0.48449086574555805, 'support': 37026}, 'accuracy': 0.4623906332767092, 'macro avg': {'precision': 0.46109950621669665, 'recall': 0.4620728074693932, 'f1-score': 0.4607583162964079, 'support': 109494}, 'weighted avg': {'precision': 0.46120147707307746, 'recall': 0.4623906332767092, 'f1-score': 0.46097275887210554, 'support': 109494}}
[[18196  8585  9518]
 [11141 14041 10987]
 [ 9411  9223 18392]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0613158
{'0': {'precision': 0.43540802213001384, 'recall': 0.5296542441322453, 'f1-score': 0.47792917599726725, 'support': 11887}, '1': {'precision': 0.41520100502512564, 'recall': 0.2838127951910691, 'f1-score': 0.3371588880387656, 'support': 11645}, '2': {'precision': 0.44786185429481956, 'recall': 0.4880865842823681, 'f1-score': 0.4671098399938162, 'support': 12381}, 'accuracy': 0.435608275554813, 'macro avg': {'precision': 0.43282362714998635, 'recall': 0.4338512078685608, 'f1-score': 0.427399301343283, 'support': 35913}, 'weighted avg': {'precision': 0.4331492351126674, 'recall': 0.435608275554813, 'f1-score': 0.42855362390372237, 'support': 35913}}
[[6296 2136 3455]
 [4345 3305 3995]
 [3819 2519 6043]]
training model: results/PCAR/W10/deepVOL_L3/h30
Epoch 1/50
428/428 - 19s - loss: 3.3273 - accuracy30: 0.3547 - val_loss: 3.3304 - val_accuracy30: 0.3275 - 19s/epoch - 44ms/step
Epoch 2/50
428/428 - 17s - loss: 3.2890 - accuracy30: 0.3593 - val_loss: 3.3108 - val_accuracy30: 0.3483 - 17s/epoch - 40ms/step
Epoch 3/50
428/428 - 17s - loss: 3.2641 - accuracy30: 0.3791 - val_loss: 3.2853 - val_accuracy30: 0.3664 - 17s/epoch - 40ms/step
Epoch 4/50
428/428 - 17s - loss: 3.2457 - accuracy30: 0.3952 - val_loss: 3.2757 - val_accuracy30: 0.3809 - 17s/epoch - 39ms/step
Epoch 5/50
428/428 - 17s - loss: 3.2326 - accuracy30: 0.4030 - val_loss: 3.2691 - val_accuracy30: 0.3877 - 17s/epoch - 39ms/step
Epoch 6/50
428/428 - 17s - loss: 3.2209 - accuracy30: 0.4114 - val_loss: 3.2687 - val_accuracy30: 0.3887 - 17s/epoch - 40ms/step
Epoch 7/50
428/428 - 17s - loss: 3.2145 - accuracy30: 0.4165 - val_loss: 3.2475 - val_accuracy30: 0.4015 - 17s/epoch - 39ms/step
Epoch 8/50
428/428 - 16s - loss: 3.2019 - accuracy30: 0.4246 - val_loss: 3.2471 - val_accuracy30: 0.4058 - 16s/epoch - 38ms/step
Epoch 9/50
428/428 - 17s - loss: 3.1946 - accuracy30: 0.4277 - val_loss: 3.2559 - val_accuracy30: 0.4017 - 17s/epoch - 39ms/step
Epoch 10/50
428/428 - 17s - loss: 3.1882 - accuracy30: 0.4282 - val_loss: 3.2411 - val_accuracy30: 0.4080 - 17s/epoch - 40ms/step
Epoch 11/50
428/428 - 17s - loss: 3.1831 - accuracy30: 0.4315 - val_loss: 3.2291 - val_accuracy30: 0.4107 - 17s/epoch - 39ms/step
Epoch 12/50
428/428 - 17s - loss: 3.1805 - accuracy30: 0.4328 - val_loss: 3.2372 - val_accuracy30: 0.4070 - 17s/epoch - 40ms/step
Epoch 13/50
428/428 - 17s - loss: 3.1725 - accuracy30: 0.4358 - val_loss: 3.2330 - val_accuracy30: 0.4092 - 17s/epoch - 39ms/step
Epoch 14/50
428/428 - 17s - loss: 3.1672 - accuracy30: 0.4379 - val_loss: 3.2350 - val_accuracy30: 0.4120 - 17s/epoch - 39ms/step
Epoch 15/50
428/428 - 17s - loss: 3.1648 - accuracy30: 0.4399 - val_loss: 3.2326 - val_accuracy30: 0.4082 - 17s/epoch - 39ms/step
Epoch 16/50
428/428 - 17s - loss: 3.1616 - accuracy30: 0.4405 - val_loss: 3.2317 - val_accuracy30: 0.4111 - 17s/epoch - 40ms/step
Epoch 17/50
428/428 - 16s - loss: 3.1584 - accuracy30: 0.4420 - val_loss: 3.2405 - val_accuracy30: 0.4068 - 16s/epoch - 38ms/step
Epoch 18/50
428/428 - 16s - loss: 3.1534 - accuracy30: 0.4436 - val_loss: 3.2496 - val_accuracy30: 0.4035 - 16s/epoch - 38ms/step
Epoch 19/50
428/428 - 16s - loss: 3.1480 - accuracy30: 0.4454 - val_loss: 3.2451 - val_accuracy30: 0.4024 - 16s/epoch - 38ms/step
Epoch 20/50
428/428 - 16s - loss: 3.1428 - accuracy30: 0.4460 - val_loss: 3.2445 - val_accuracy30: 0.4024 - 16s/epoch - 39ms/step
Epoch 21/50
428/428 - 17s - loss: 3.1376 - accuracy30: 0.4495 - val_loss: 3.2551 - val_accuracy30: 0.4054 - 17s/epoch - 39ms/step
testing model: results/PCAR/W10/deepVOL_L3/h30
Evaluating performance on  test set...
2104/2104 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0925537
{'0': {'precision': 0.4565836444649591, 'recall': 0.5792147936873719, 'f1-score': 0.5106398922584714, 'support': 211766}, '1': {'precision': 0.2509449135504624, 'recall': 0.2659094007771491, 'f1-score': 0.2582105237027414, 'support': 117352}, '2': {'precision': 0.48643932732468675, 'recall': 0.3380872122725515, 'f1-score': 0.39891721664962493, 'support': 209443}, 'accuracy': 0.4171727993672026, 'macro avg': {'precision': 0.3979892951133694, 'recall': 0.3944038022456908, 'f1-score': 0.3892558775369459, 'support': 538561}, 'weighted avg': {'precision': 0.42338582181332246, 'recall': 0.4171727993672026, 'f1-score': 0.4121874911260172, 'support': 538561}}
[[122658  45308  43800]
 [ 55189  31205  30958]
 [ 90796  47837  70810]]
Evaluating performance on  train set...
428/428 - 9s - 9s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0662879
{'0': {'precision': 0.4322583828863283, 'recall': 0.4842981146679936, 'f1-score': 0.4568009073960601, 'support': 36174}, '1': {'precision': 0.39457865168539324, 'recall': 0.3868098581853229, 'f1-score': 0.3906556351248001, 'support': 36315}, '2': {'precision': 0.4508916529297168, 'recall': 0.4065396568031347, 'f1-score': 0.42756856615034816, 'support': 37005}, 'accuracy': 0.42568542568542567, 'macro avg': {'precision': 0.4259095625004794, 'recall': 0.4258825432188171, 'f1-score': 0.42500836955706944, 'support': 109494}, 'weighted avg': {'precision': 0.42605881687717373, 'recall': 0.42568542568542567, 'f1-score': 0.4249835626070454, 'support': 109494}}
[[17519 10683  7972]
 [11919 14047 10349]
 [11091 10870 15044]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0761129
{'0': {'precision': 0.40932327166504384, 'recall': 0.5640724589064072, 'f1-score': 0.47439695302581464, 'support': 11924}, '1': {'precision': 0.37047177759056443, 'recall': 0.3045887445887446, 'f1-score': 0.3343153093224366, 'support': 11550}, '2': {'precision': 0.4521782674011017, 'recall': 0.3629712999437254, 'f1-score': 0.40269354263289336, 'support': 12439}, 'accuracy': 0.4109653885779523, 'macro avg': {'precision': 0.4106577722189033, 'recall': 0.41054416781295905, 'f1-score': 0.4038019349937148, 'support': 35913}, 'weighted avg': {'precision': 0.41167168408953037, 'recall': 0.4109653885779523, 'f1-score': 0.40450967803760524, 'support': 35913}}
[[6726 2853 2345]
 [4907 3518 3125]
 [4799 3125 4515]]
training model: results/PCAR/W10/deepVOL_L3/h50
Epoch 1/50
428/428 - 19s - loss: 3.3311 - accuracy50: 0.3601 - val_loss: 3.3131 - val_accuracy50: 0.3447 - 19s/epoch - 45ms/step
Epoch 2/50
428/428 - 17s - loss: 3.2931 - accuracy50: 0.3653 - val_loss: 3.2910 - val_accuracy50: 0.3608 - 17s/epoch - 40ms/step
Epoch 3/50
428/428 - 17s - loss: 3.2698 - accuracy50: 0.3812 - val_loss: 3.2782 - val_accuracy50: 0.3760 - 17s/epoch - 39ms/step
Epoch 4/50
428/428 - 17s - loss: 3.2607 - accuracy50: 0.3900 - val_loss: 3.2689 - val_accuracy50: 0.3823 - 17s/epoch - 40ms/step
Epoch 5/50
428/428 - 18s - loss: 3.2538 - accuracy50: 0.3946 - val_loss: 3.2714 - val_accuracy50: 0.3824 - 18s/epoch - 42ms/step
Epoch 6/50
428/428 - 17s - loss: 3.2460 - accuracy50: 0.4017 - val_loss: 3.2663 - val_accuracy50: 0.3814 - 17s/epoch - 39ms/step
Epoch 7/50
428/428 - 17s - loss: 3.2437 - accuracy50: 0.4015 - val_loss: 3.2694 - val_accuracy50: 0.3819 - 17s/epoch - 39ms/step
Epoch 8/50
428/428 - 17s - loss: 3.2373 - accuracy50: 0.4052 - val_loss: 3.2640 - val_accuracy50: 0.3813 - 17s/epoch - 39ms/step
Epoch 9/50
428/428 - 18s - loss: 3.2300 - accuracy50: 0.4111 - val_loss: 3.2663 - val_accuracy50: 0.3798 - 18s/epoch - 42ms/step
Epoch 10/50
428/428 - 18s - loss: 3.2265 - accuracy50: 0.4106 - val_loss: 3.2702 - val_accuracy50: 0.3795 - 18s/epoch - 41ms/step
Epoch 11/50
428/428 - 16s - loss: 3.2195 - accuracy50: 0.4147 - val_loss: 3.2671 - val_accuracy50: 0.3854 - 16s/epoch - 39ms/step
Epoch 12/50
428/428 - 16s - loss: 3.2146 - accuracy50: 0.4167 - val_loss: 3.2707 - val_accuracy50: 0.3858 - 16s/epoch - 38ms/step
Epoch 13/50
428/428 - 17s - loss: 3.2049 - accuracy50: 0.4220 - val_loss: 3.2950 - val_accuracy50: 0.3810 - 17s/epoch - 40ms/step
Epoch 14/50
428/428 - 17s - loss: 3.2031 - accuracy50: 0.4229 - val_loss: 3.2853 - val_accuracy50: 0.3791 - 17s/epoch - 39ms/step
Epoch 15/50
428/428 - 17s - loss: 3.2008 - accuracy50: 0.4268 - val_loss: 3.2744 - val_accuracy50: 0.3842 - 17s/epoch - 39ms/step
Epoch 16/50
428/428 - 16s - loss: 3.1975 - accuracy50: 0.4277 - val_loss: 3.2772 - val_accuracy50: 0.3867 - 16s/epoch - 38ms/step
Epoch 17/50
428/428 - 16s - loss: 3.1932 - accuracy50: 0.4311 - val_loss: 3.2777 - val_accuracy50: 0.3894 - 16s/epoch - 38ms/step
Epoch 18/50
428/428 - 16s - loss: 3.1860 - accuracy50: 0.4342 - val_loss: 3.2855 - val_accuracy50: 0.3908 - 16s/epoch - 38ms/step
testing model: results/PCAR/W10/deepVOL_L3/h50
Evaluating performance on  test set...
2104/2104 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0774958
{'0': {'precision': 0.42951404656795233, 'recall': 0.7827553770734972, 'f1-score': 0.5546694867049615, 'support': 221124}, '1': {'precision': 0.20628112894299944, 'recall': 0.06147693068898693, 'f1-score': 0.09472380165814301, 'support': 97012}, '2': {'precision': 0.46824727190910115, 'recall': 0.226594079618918, 'f1-score': 0.3053993818271868, 'support': 220425}, 'accuracy': 0.4252016020469362, 'macro avg': {'precision': 0.3680141491400177, 'recall': 0.356942129127134, 'f1-score': 0.3182642233967638, 'support': 538561}, 'weighted avg': {'precision': 0.4051556162159417, 'recall': 0.4252016020469362, 'f1-score': 0.3697960672307599, 'support': 538561}}
[[173086  11055  36983]
 [ 71310   5964  19738]
 [158585  11893  49947]]
Evaluating performance on  train set...
428/428 - 9s - 9s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0810256
{'0': {'precision': 0.38291825592700623, 'recall': 0.7002762808764396, 'f1-score': 0.4951069508374269, 'support': 36557}, '1': {'precision': 0.4395306859205776, 'recall': 0.17480258435032303, 'f1-score': 0.2501284026707755, 'support': 36218}, '2': {'precision': 0.40038958739153535, 'recall': 0.30787875486805194, 'f1-score': 0.3480924962280999, 'support': 36719}, 'accuracy': 0.39487095183297716, 'macro avg': {'precision': 0.40761284307970636, 'recall': 0.39431920669827153, 'f1-score': 0.36444261657876736, 'support': 109494}, 'weighted avg': {'precision': 0.4075033364752848, 'recall': 0.39487095183297716, 'f1-score': 0.3647723497058612, 'support': 109494}}
[[25600  3553  7404]
 [20361  6331  9526]
 [20894  4520 11305]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0884941
{'0': {'precision': 0.3698925574464748, 'recall': 0.7826267319339584, 'f1-score': 0.502356543735854, 'support': 12053}, '1': {'precision': 0.41726892354507417, 'recall': 0.0970195454143451, 'f1-score': 0.15743398392652125, 'support': 11307}, '2': {'precision': 0.41403238242097146, 'recall': 0.2566717119413686, 'f1-score': 0.3168920580280305, 'support': 12553}, 'accuracy': 0.3829254030573887, 'macro avg': {'precision': 0.4003979544708402, 'recall': 0.3787726630965573, 'f1-score': 0.32556086189680195, 'support': 35913}, 'weighted avg': {'precision': 0.4002373293781352, 'recall': 0.3829254030573887, 'f1-score': 0.32893257267093506, 'support': 35913}}
[[9433  658 1962]
 [7612 1097 2598]
 [8457  874 3222]]
training model: results/PCAR/W10/deepVOL_L3/h100
Epoch 1/50
428/428 - 19s - loss: 3.3390 - accuracy100: 0.3537 - val_loss: 3.3895 - val_accuracy100: 0.3179 - 19s/epoch - 46ms/step
Epoch 2/50
428/428 - 17s - loss: 3.3084 - accuracy100: 0.3485 - val_loss: 3.3222 - val_accuracy100: 0.3191 - 17s/epoch - 39ms/step
Epoch 3/50
428/428 - 17s - loss: 3.2966 - accuracy100: 0.3512 - val_loss: 3.3131 - val_accuracy100: 0.3276 - 17s/epoch - 39ms/step
Epoch 4/50
428/428 - 16s - loss: 3.2909 - accuracy100: 0.3560 - val_loss: 3.3105 - val_accuracy100: 0.3338 - 16s/epoch - 38ms/step
Epoch 5/50
428/428 - 16s - loss: 3.2864 - accuracy100: 0.3609 - val_loss: 3.3101 - val_accuracy100: 0.3336 - 16s/epoch - 38ms/step
Epoch 6/50
428/428 - 17s - loss: 3.2813 - accuracy100: 0.3670 - val_loss: 3.3099 - val_accuracy100: 0.3408 - 17s/epoch - 39ms/step
Epoch 7/50
428/428 - 18s - loss: 3.2765 - accuracy100: 0.3714 - val_loss: 3.3233 - val_accuracy100: 0.3384 - 18s/epoch - 41ms/step
Epoch 8/50
428/428 - 17s - loss: 3.2726 - accuracy100: 0.3760 - val_loss: 3.3114 - val_accuracy100: 0.3449 - 17s/epoch - 40ms/step
Epoch 9/50
428/428 - 17s - loss: 3.2660 - accuracy100: 0.3815 - val_loss: 3.3217 - val_accuracy100: 0.3505 - 17s/epoch - 39ms/step
Epoch 10/50
428/428 - 17s - loss: 3.2587 - accuracy100: 0.3900 - val_loss: 3.3278 - val_accuracy100: 0.3483 - 17s/epoch - 39ms/step
Epoch 11/50
428/428 - 16s - loss: 3.2547 - accuracy100: 0.3915 - val_loss: 3.3235 - val_accuracy100: 0.3469 - 16s/epoch - 38ms/step
Epoch 12/50
428/428 - 16s - loss: 3.2508 - accuracy100: 0.3971 - val_loss: 3.3313 - val_accuracy100: 0.3475 - 16s/epoch - 38ms/step
Epoch 13/50
428/428 - 17s - loss: 3.2443 - accuracy100: 0.3993 - val_loss: 3.3275 - val_accuracy100: 0.3475 - 17s/epoch - 39ms/step
Epoch 14/50
428/428 - 16s - loss: 3.2405 - accuracy100: 0.4002 - val_loss: 3.3318 - val_accuracy100: 0.3469 - 16s/epoch - 39ms/step
Epoch 15/50
428/428 - 16s - loss: 3.2380 - accuracy100: 0.4013 - val_loss: 3.3406 - val_accuracy100: 0.3443 - 16s/epoch - 38ms/step
Epoch 16/50
428/428 - 16s - loss: 3.2312 - accuracy100: 0.4077 - val_loss: 3.3438 - val_accuracy100: 0.3464 - 16s/epoch - 38ms/step
testing model: results/PCAR/W10/deepVOL_L3/h100
Evaluating performance on  test set...
2104/2104 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1149032
{'0': {'precision': 0.39919279862622636, 'recall': 0.3503297209610382, 'f1-score': 0.37316851221332675, 'support': 208358}, '1': {'precision': 0.24426070038910505, 'recall': 0.6489367716300143, 'f1-score': 0.354926553896917, 'support': 123821}, '2': {'precision': 0.38628631248364304, 'recall': 0.050062505451056775, 'f1-score': 0.08863762123116385, 'support': 206382}, 'accuracy': 0.3039172907061596, 'macro avg': {'precision': 0.3432466038329915, 'recall': 0.3497763326807031, 'f1-score': 0.2722442291138025, 'support': 538561}, 'weighted avg': {'precision': 0.35862633770741265, 'recall': 0.3039172907061596, 'f1-score': 0.25993938521865595, 'support': 538561}}
[[ 72994 125078  10286]
 [ 37340  80352   6129]
 [ 72520 123530  10332]]
Evaluating performance on  train set...
428/428 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0953292
{'0': {'precision': 0.3739698237606187, 'recall': 0.3245488556338028, 'f1-score': 0.3475110456553755, 'support': 36352}, '1': {'precision': 0.35922158697393974, 'recall': 0.7249109345026035, 'f1-score': 0.48039082150607937, 'support': 36490}, '2': {'precision': 0.37015548851241586, 'recall': 0.04351740696278512, 'f1-score': 0.07787895803325115, 'support': 36652}, 'accuracy': 0.36390121833159805, 'macro avg': {'precision': 0.36778229974899146, 'recall': 0.3643257323663971, 'f1-score': 0.3019269417315687, 'support': 109494}, 'weighted avg': {'precision': 0.36777801255760256, 'recall': 0.36390121833159805, 'f1-score': 0.3015380037103016, 'support': 109494}}
[[11798 23061  1493]
 [ 8817 26452  1221]
 [10933 24124  1595]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1038654
{'0': {'precision': 0.35447761194029853, 'recall': 0.34519778677017093, 'f1-score': 0.34977615999330575, 'support': 12109}, '1': {'precision': 0.33132556998170704, 'recall': 0.6590929262447857, 'f1-score': 0.44097387173396674, 'support': 11267}, '2': {'precision': 0.34601873536299765, 'recall': 0.04714046422589136, 'f1-score': 0.08297648297648298, 'support': 12537}, 'accuracy': 0.3396263191601927, 'macro avg': {'precision': 0.3439406390950011, 'recall': 0.35047705908028265, 'f1-score': 0.2912421715679185, 'support': 35913}, 'weighted avg': {'precision': 0.3442611724226567, 'recall': 0.3396263191601927, 'f1-score': 0.2852495837513354, 'support': 35913}}
[[4180 7296  633]
 [3357 7426  484]
 [4255 7691  591]]
training model: results/PCAR/W10/deepVOL_L3/h200
Epoch 1/50
428/428 - 19s - loss: 3.3335 - accuracy200: 0.3542 - val_loss: 3.3919 - val_accuracy200: 0.3084 - 19s/epoch - 46ms/step
Epoch 2/50
428/428 - 17s - loss: 3.2978 - accuracy200: 0.3507 - val_loss: 3.3187 - val_accuracy200: 0.3151 - 17s/epoch - 39ms/step
Epoch 3/50
428/428 - 17s - loss: 3.2895 - accuracy200: 0.3561 - val_loss: 3.3135 - val_accuracy200: 0.3234 - 17s/epoch - 40ms/step
Epoch 4/50
428/428 - 17s - loss: 3.2815 - accuracy200: 0.3644 - val_loss: 3.3050 - val_accuracy200: 0.3351 - 17s/epoch - 39ms/step
Epoch 5/50
428/428 - 18s - loss: 3.2767 - accuracy200: 0.3688 - val_loss: 3.3010 - val_accuracy200: 0.3451 - 18s/epoch - 43ms/step
Epoch 6/50
428/428 - 17s - loss: 3.2671 - accuracy200: 0.3779 - val_loss: 3.2951 - val_accuracy200: 0.3512 - 17s/epoch - 39ms/step
Epoch 7/50
428/428 - 17s - loss: 3.2645 - accuracy200: 0.3789 - val_loss: 3.2928 - val_accuracy200: 0.3511 - 17s/epoch - 39ms/step
Epoch 8/50
428/428 - 17s - loss: 3.2583 - accuracy200: 0.3873 - val_loss: 3.2970 - val_accuracy200: 0.3529 - 17s/epoch - 39ms/step
Epoch 9/50
428/428 - 17s - loss: 3.2522 - accuracy200: 0.3918 - val_loss: 3.2938 - val_accuracy200: 0.3531 - 17s/epoch - 39ms/step
Epoch 10/50
428/428 - 16s - loss: 3.2455 - accuracy200: 0.3957 - val_loss: 3.2969 - val_accuracy200: 0.3527 - 16s/epoch - 38ms/step
Epoch 11/50
428/428 - 16s - loss: 3.2391 - accuracy200: 0.3994 - val_loss: 3.2971 - val_accuracy200: 0.3583 - 16s/epoch - 38ms/step
Epoch 12/50
428/428 - 17s - loss: 3.2350 - accuracy200: 0.4028 - val_loss: 3.2961 - val_accuracy200: 0.3575 - 17s/epoch - 39ms/step
Epoch 13/50
428/428 - 18s - loss: 3.2299 - accuracy200: 0.4062 - val_loss: 3.3015 - val_accuracy200: 0.3587 - 18s/epoch - 41ms/step
Epoch 14/50
428/428 - 17s - loss: 3.2249 - accuracy200: 0.4084 - val_loss: 3.3069 - val_accuracy200: 0.3573 - 17s/epoch - 40ms/step
Epoch 15/50
428/428 - 17s - loss: 3.2202 - accuracy200: 0.4121 - val_loss: 3.3038 - val_accuracy200: 0.3589 - 17s/epoch - 40ms/step
Epoch 16/50
428/428 - 17s - loss: 3.2128 - accuracy200: 0.4152 - val_loss: 3.3145 - val_accuracy200: 0.3582 - 17s/epoch - 39ms/step
Epoch 17/50
428/428 - 17s - loss: 3.2078 - accuracy200: 0.4194 - val_loss: 3.3172 - val_accuracy200: 0.3569 - 17s/epoch - 39ms/step
testing model: results/PCAR/W10/deepVOL_L3/h200
Evaluating performance on  test set...
2104/2104 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1015152
{'0': {'precision': 0.3970184857678886, 'recall': 0.5988032524049474, 'f1-score': 0.47746690281918164, 'support': 209568}, '1': {'precision': 0.2709100250533642, 'recall': 0.4089044874203529, 'f1-score': 0.32590161845291193, 'support': 125083}, '2': {'precision': 0.39432354600243447, 'recall': 0.06513657986366535, 'f1-score': 0.11180464070911181, 'support': 203910}, 'accuracy': 0.35264157634882587, 'macro avg': {'precision': 0.3540840189412291, 'recall': 0.35761477322965524, 'f1-score': 0.30505772066040177, 'support': 538561}, 'weighted avg': {'precision': 0.36670892053919846, 'recall': 0.35264157634882587, 'f1-score': 0.3038181753189534, 'support': 538561}}
[[125490  71201  12877]
 [ 66412  51147   7524]
 [124179  66449  13282]]
Evaluating performance on  train set...
428/428 - 9s - 9s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0869682
{'0': {'precision': 0.3799782372143634, 'recall': 0.5254432042022325, 'f1-score': 0.4410255232671619, 'support': 36552}, '1': {'precision': 0.398441868985865, 'recall': 0.5712153046555347, 'f1-score': 0.4694362085221916, 'support': 36172}, '2': {'precision': 0.3694303440496334, 'recall': 0.07125373946151754, 'f1-score': 0.11946559664401989, 'support': 36770}, 'accuracy': 0.3880395272800336, 'macro avg': {'precision': 0.38261681674995396, 'recall': 0.3893040827730949, 'f1-score': 0.34330910947779114, 'support': 109494}, 'weighted avg': {'precision': 0.38253564179152405, 'recall': 0.3880395272800336, 'f1-score': 0.34242571693176455, 'support': 109494}}
[[19206 14982  2364]
 [13402 20662  2108]
 [17937 16213  2620]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0986266
{'0': {'precision': 0.3523085388424791, 'recall': 0.5772477665765101, 'f1-score': 0.4375621272365805, 'support': 12201}, '1': {'precision': 0.3469709481270175, 'recall': 0.41983831410664, 'f1-score': 0.3799424578709412, 'support': 11009}, '2': {'precision': 0.3537101114955786, 'recall': 0.07242383688892387, 'f1-score': 0.12023000522739152, 'support': 12703}, 'accuracy': 0.3504302063319689, 'macro avg': {'precision': 0.35099653282169174, 'recall': 0.35650330585735795, 'f1-score': 0.3125781967783044, 'support': 35913}, 'weighted avg': {'precision': 0.3511680783191535, 'recall': 0.3504302063319689, 'f1-score': 0.3076536014679438, 'support': 35913}}
[[7043 4264  894]
 [5600 4622  787]
 [7348 4435  920]]
training model: results/PCAR/W10/deepVOL_L3/h300
Epoch 1/50
428/428 - 20s - loss: 3.3385 - accuracy300: 0.3502 - val_loss: 3.3651 - val_accuracy300: 0.3187 - 20s/epoch - 47ms/step
Epoch 2/50
428/428 - 19s - loss: 3.3120 - accuracy300: 0.3506 - val_loss: 3.3206 - val_accuracy300: 0.3301 - 19s/epoch - 43ms/step
Epoch 3/50
428/428 - 18s - loss: 3.2904 - accuracy300: 0.3614 - val_loss: 3.3078 - val_accuracy300: 0.3345 - 18s/epoch - 43ms/step
Epoch 4/50
428/428 - 18s - loss: 3.2822 - accuracy300: 0.3682 - val_loss: 3.3074 - val_accuracy300: 0.3372 - 18s/epoch - 43ms/step
Epoch 5/50
428/428 - 18s - loss: 3.2769 - accuracy300: 0.3710 - val_loss: 3.3142 - val_accuracy300: 0.3285 - 18s/epoch - 43ms/step
Epoch 6/50
428/428 - 18s - loss: 3.2719 - accuracy300: 0.3758 - val_loss: 3.3000 - val_accuracy300: 0.3419 - 18s/epoch - 41ms/step
Epoch 7/50
428/428 - 17s - loss: 3.2646 - accuracy300: 0.3816 - val_loss: 3.3040 - val_accuracy300: 0.3397 - 17s/epoch - 40ms/step
Epoch 8/50
428/428 - 17s - loss: 3.2607 - accuracy300: 0.3809 - val_loss: 3.3075 - val_accuracy300: 0.3395 - 17s/epoch - 39ms/step
Epoch 9/50
428/428 - 17s - loss: 3.2584 - accuracy300: 0.3827 - val_loss: 3.3097 - val_accuracy300: 0.3440 - 17s/epoch - 40ms/step
Epoch 10/50
428/428 - 17s - loss: 3.2516 - accuracy300: 0.3890 - val_loss: 3.3197 - val_accuracy300: 0.3405 - 17s/epoch - 40ms/step
Epoch 11/50
428/428 - 17s - loss: 3.2453 - accuracy300: 0.3923 - val_loss: 3.3228 - val_accuracy300: 0.3426 - 17s/epoch - 40ms/step
Epoch 12/50
428/428 - 17s - loss: 3.2403 - accuracy300: 0.3958 - val_loss: 3.3299 - val_accuracy300: 0.3429 - 17s/epoch - 39ms/step
Epoch 13/50
428/428 - 17s - loss: 3.2335 - accuracy300: 0.3998 - val_loss: 3.3339 - val_accuracy300: 0.3437 - 17s/epoch - 39ms/step
Epoch 14/50
428/428 - 17s - loss: 3.2298 - accuracy300: 0.4007 - val_loss: 3.3435 - val_accuracy300: 0.3445 - 17s/epoch - 40ms/step
Epoch 15/50
428/428 - 17s - loss: 3.2209 - accuracy300: 0.4062 - val_loss: 3.3492 - val_accuracy300: 0.3447 - 17s/epoch - 39ms/step
Epoch 16/50
428/428 - 17s - loss: 3.2144 - accuracy300: 0.4099 - val_loss: 3.3654 - val_accuracy300: 0.3417 - 17s/epoch - 39ms/step
testing model: results/PCAR/W10/deepVOL_L3/h300
Evaluating performance on  test set...
2104/2104 - 37s - 37s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.100541
{'0': {'precision': 0.3955902089857481, 'recall': 0.5869556971627977, 'f1-score': 0.4726373097745165, 'support': 210912}, '1': {'precision': 0.2621643534570127, 'recall': 0.3906139479435724, 'f1-score': 0.3137514004194077, 'support': 125825}, '2': {'precision': 0.3595040239075157, 'recall': 0.06795029332487712, 'f1-score': 0.11429714423826212, 'support': 201824}, 'accuracy': 0.3465884087410711, 'macro avg': {'precision': 0.3390861954500921, 'recall': 0.3485066461437491, 'f1-score': 0.3002286181440621, 'support': 538561}, 'weighted avg': {'precision': 0.35089449858500926, 'recall': 0.3465884087410711, 'f1-score': 0.3012296788584354, 'support': 538561}}
[[123796  72069  15047]
 [ 67290  49149   9386]
 [121854  66256  13714]]
Evaluating performance on  train set...
428/428 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0904936
{'0': {'precision': 0.3723467781336518, 'recall': 0.5608340147179068, 'f1-score': 0.4475547290463607, 'support': 36690}, '1': {'precision': 0.38604379688276874, 'recall': 0.4989522505657847, 'f1-score': 0.4352955514929921, 'support': 35791}, '2': {'precision': 0.36828901154039134, 'recall': 0.0793234809391295, 'f1-score': 0.13053239968878516, 'support': 37013}, 'accuracy': 0.3778380550532449, 'macro avg': {'precision': 0.375559862185604, 'recall': 0.37970324874094036, 'f1-score': 0.3377942267427126, 'support': 109494}, 'weighted avg': {'precision': 0.3754523353617492, 'recall': 0.3778380550532449, 'f1-score': 0.3363822839779135, 'support': 109494}}
[[20577 13690  2423]
 [15320 17858  2613]
 [19366 14711  2936]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1007
{'0': {'precision': 0.3411330647118792, 'recall': 0.5789733871632199, 'f1-score': 0.4293132942326491, 'support': 12137}, '1': {'precision': 0.33972153972153973, 'recall': 0.3767484105358765, 'f1-score': 0.3572782084409991, 'support': 11010}, '2': {'precision': 0.36146907216494845, 'recall': 0.08788970703430989, 'f1-score': 0.14139886578449906, 'support': 12766}, 'accuracy': 0.3424108261632278, 'macro avg': {'precision': 0.34744122553278917, 'recall': 0.3478705015778021, 'f1-score': 0.3093301228193824, 'support': 35913}, 'weighted avg': {'precision': 0.3479291714420951, 'recall': 0.3424108261632278, 'f1-score': 0.30488420481836603, 'support': 35913}}
[[7027 4113  997]
 [5877 4148  985]
 [7695 3949 1122]]
training model: results/PCAR/W10/deepVOL_L3/h500
Epoch 1/50
428/428 - 19s - loss: 3.3429 - accuracy500: 0.3559 - val_loss: 3.3731 - val_accuracy500: 0.3164 - 19s/epoch - 44ms/step
Epoch 2/50
428/428 - 16s - loss: 3.3209 - accuracy500: 0.3517 - val_loss: 3.3295 - val_accuracy500: 0.3228 - 16s/epoch - 39ms/step
Epoch 3/50
428/428 - 18s - loss: 3.3009 - accuracy500: 0.3532 - val_loss: 3.3127 - val_accuracy500: 0.3141 - 18s/epoch - 42ms/step
Epoch 4/50
428/428 - 17s - loss: 3.2906 - accuracy500: 0.3561 - val_loss: 3.3060 - val_accuracy500: 0.3239 - 17s/epoch - 39ms/step
Epoch 5/50
428/428 - 17s - loss: 3.2837 - accuracy500: 0.3630 - val_loss: 3.2971 - val_accuracy500: 0.3434 - 17s/epoch - 39ms/step
Epoch 6/50
428/428 - 17s - loss: 3.2783 - accuracy500: 0.3694 - val_loss: 3.3097 - val_accuracy500: 0.3373 - 17s/epoch - 40ms/step
Epoch 7/50
428/428 - 17s - loss: 3.2740 - accuracy500: 0.3751 - val_loss: 3.3013 - val_accuracy500: 0.3496 - 17s/epoch - 40ms/step
Epoch 8/50
428/428 - 16s - loss: 3.2660 - accuracy500: 0.3822 - val_loss: 3.3096 - val_accuracy500: 0.3513 - 16s/epoch - 38ms/step
Epoch 9/50
428/428 - 16s - loss: 3.2665 - accuracy500: 0.3830 - val_loss: 3.3102 - val_accuracy500: 0.3428 - 16s/epoch - 38ms/step
Epoch 10/50
428/428 - 17s - loss: 3.2567 - accuracy500: 0.3873 - val_loss: 3.3141 - val_accuracy500: 0.3449 - 17s/epoch - 39ms/step
Epoch 11/50
428/428 - 16s - loss: 3.2519 - accuracy500: 0.3916 - val_loss: 3.3184 - val_accuracy500: 0.3449 - 16s/epoch - 38ms/step
Epoch 12/50
428/428 - 16s - loss: 3.2454 - accuracy500: 0.3956 - val_loss: 3.3156 - val_accuracy500: 0.3429 - 16s/epoch - 38ms/step
Epoch 13/50
428/428 - 16s - loss: 3.2414 - accuracy500: 0.3969 - val_loss: 3.3299 - val_accuracy500: 0.3426 - 16s/epoch - 38ms/step
Epoch 14/50
428/428 - 16s - loss: 3.2378 - accuracy500: 0.4002 - val_loss: 3.3265 - val_accuracy500: 0.3443 - 16s/epoch - 38ms/step
Epoch 15/50
428/428 - 17s - loss: 3.2304 - accuracy500: 0.4044 - val_loss: 3.3322 - val_accuracy500: 0.3441 - 17s/epoch - 39ms/step
testing model: results/PCAR/W10/deepVOL_L3/h500
Evaluating performance on  test set...
2104/2104 - 39s - 39s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0977798
{'0': {'precision': 0.38766863214878367, 'recall': 0.39217346292094607, 'f1-score': 0.3899080362468015, 'support': 206707}, '1': {'precision': 0.27484506115285473, 'recall': 0.306538311554254, 'f1-score': 0.28982783113498434, 'support': 130783}, '2': {'precision': 0.3780911606423078, 'recall': 0.3452163663581521, 'f1-score': 0.3609066731832611, 'support': 201071}, 'accuracy': 0.35384663947073774, 'macro avg': {'precision': 0.3468682846479821, 'recall': 0.3479760469444508, 'f1-score': 0.3468808468550157, 'support': 538561}, 'weighted avg': {'precision': 0.3566950621003784, 'recall': 0.35384663947073774, 'f1-score': 0.35477715499530366, 'support': 538561}}
[[81065 56086 69556]
 [46074 40090 44619]
 [81970 49688 69413]]
Evaluating performance on  train set...
428/428 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0932553
{'0': {'precision': 0.3675929356551809, 'recall': 0.4093184443588756, 'f1-score': 0.38733521595981407, 'support': 36358}, '1': {'precision': 0.3780649099603215, 'recall': 0.4126596335369239, 'f1-score': 0.39460550069024103, 'support': 36020}, '2': {'precision': 0.3624423264742532, 'recall': 0.2899558142041168, 'f1-score': 0.32217216243320507, 'support': 37116}, 'accuracy': 0.36995634463988897, 'macro avg': {'precision': 0.36936672402991855, 'recall': 0.37064463069997206, 'f1-score': 0.3680376263610867, 'support': 109494}, 'weighted avg': {'precision': 0.36929193746452066, 'recall': 0.36995634463988897, 'f1-score': 0.36763809795605457, 'support': 109494}}
[[14882 11869  9607]
 [11832 14864  9324]
 [13771 12583 10762]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0996912
{'0': {'precision': 0.34420475319926874, 'recall': 0.38418217433888346, 'f1-score': 0.3630963860068654, 'support': 12252}, '1': {'precision': 0.3424955133654482, 'recall': 0.3326300339418402, 'f1-score': 0.33749069247952346, 'support': 10901}, '2': {'precision': 0.34700884044288044, 'recall': 0.31684952978056424, 'f1-score': 0.33124411126131664, 'support': 12760}, 'accuracy': 0.34461058669562555, 'macro avg': {'precision': 0.3445697023358658, 'recall': 0.344553912687096, 'f1-score': 0.34394372991590183, 'support': 35913}, 'weighted avg': {'precision': 0.34468223293641154, 'recall': 0.34461058669562555, 'f1-score': 0.3440068448687049, 'support': 35913}}
[[4707 3413 4132]
 [3799 3626 3476]
 [5169 3548 4043]]
training model: results/PCAR/W10/deepVOL_L3/h1000
Epoch 1/50
428/428 - 19s - loss: 3.3405 - accuracy1000: 0.3540 - val_loss: 3.3100 - val_accuracy1000: 0.3242 - 19s/epoch - 45ms/step
Epoch 2/50
428/428 - 17s - loss: 3.3044 - accuracy1000: 0.3553 - val_loss: 3.3264 - val_accuracy1000: 0.3119 - 17s/epoch - 39ms/step
Epoch 3/50
428/428 - 17s - loss: 3.2989 - accuracy1000: 0.3534 - val_loss: 3.3267 - val_accuracy1000: 0.3121 - 17s/epoch - 39ms/step
Epoch 4/50
428/428 - 17s - loss: 3.2940 - accuracy1000: 0.3572 - val_loss: 3.3234 - val_accuracy1000: 0.3185 - 17s/epoch - 39ms/step
Epoch 5/50
428/428 - 17s - loss: 3.2894 - accuracy1000: 0.3625 - val_loss: 3.3255 - val_accuracy1000: 0.3211 - 17s/epoch - 39ms/step
Epoch 6/50
428/428 - 17s - loss: 3.2857 - accuracy1000: 0.3635 - val_loss: 3.3196 - val_accuracy1000: 0.3324 - 17s/epoch - 39ms/step
Epoch 7/50
428/428 - 17s - loss: 3.2792 - accuracy1000: 0.3717 - val_loss: 3.3229 - val_accuracy1000: 0.3365 - 17s/epoch - 39ms/step
Epoch 8/50
428/428 - 17s - loss: 3.2748 - accuracy1000: 0.3756 - val_loss: 3.3251 - val_accuracy1000: 0.3321 - 17s/epoch - 39ms/step
Epoch 9/50
428/428 - 16s - loss: 3.2739 - accuracy1000: 0.3809 - val_loss: 3.3035 - val_accuracy1000: 0.3460 - 16s/epoch - 39ms/step
Epoch 10/50
428/428 - 16s - loss: 3.2726 - accuracy1000: 0.3807 - val_loss: 3.3149 - val_accuracy1000: 0.3416 - 16s/epoch - 38ms/step
Epoch 11/50
428/428 - 16s - loss: 3.2637 - accuracy1000: 0.3846 - val_loss: 3.3161 - val_accuracy1000: 0.3430 - 16s/epoch - 38ms/step
Epoch 12/50
428/428 - 16s - loss: 3.2590 - accuracy1000: 0.3902 - val_loss: 3.3184 - val_accuracy1000: 0.3422 - 16s/epoch - 38ms/step
Epoch 13/50
428/428 - 16s - loss: 3.2537 - accuracy1000: 0.3936 - val_loss: 3.3238 - val_accuracy1000: 0.3443 - 16s/epoch - 38ms/step
Epoch 14/50
428/428 - 17s - loss: 3.2463 - accuracy1000: 0.3992 - val_loss: 3.3218 - val_accuracy1000: 0.3433 - 17s/epoch - 40ms/step
Epoch 15/50
428/428 - 17s - loss: 3.2442 - accuracy1000: 0.3993 - val_loss: 3.3283 - val_accuracy1000: 0.3404 - 17s/epoch - 39ms/step
Epoch 16/50
428/428 - 17s - loss: 3.2338 - accuracy1000: 0.4073 - val_loss: 3.3265 - val_accuracy1000: 0.3430 - 17s/epoch - 39ms/step
Epoch 17/50
428/428 - 16s - loss: 3.2312 - accuracy1000: 0.4067 - val_loss: 3.3275 - val_accuracy1000: 0.3461 - 16s/epoch - 38ms/step
Epoch 18/50
428/428 - 16s - loss: 3.2258 - accuracy1000: 0.4113 - val_loss: 3.3576 - val_accuracy1000: 0.3441 - 16s/epoch - 39ms/step
Epoch 19/50
428/428 - 16s - loss: 3.2213 - accuracy1000: 0.4114 - val_loss: 3.3475 - val_accuracy1000: 0.3451 - 16s/epoch - 38ms/step
testing model: results/PCAR/W10/deepVOL_L3/h1000
Evaluating performance on  test set...
2104/2104 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.103068
{'0': {'precision': 0.3810949201652652, 'recall': 0.47826170606767515, 'f1-score': 0.4241850266307466, 'support': 207905}, '1': {'precision': 0.26032689922727126, 'recall': 0.2554608999563128, 'f1-score': 0.2578709464035406, 'support': 128184}, '2': {'precision': 0.3653388999005657, 'recall': 0.27401319688648307, 'f1-score': 0.3131535202959944, 'support': 202472}, 'accuracy': 0.34844520862075046, 'macro avg': {'precision': 0.3355869064310341, 'recall': 0.33591193430349037, 'f1-score': 0.33173649777676056, 'support': 538561}, 'weighted avg': {'precision': 0.3464272020591453, 'recall': 0.34844520862075046, 'f1-score': 0.342857980649968, 'support': 538561}}
[[ 99433  48973  59499]
 [ 58558  32746  36880]
 [102923  44069  55480]]
Evaluating performance on  train set...
428/428 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0888425
{'0': {'precision': 0.38276767676767676, 'recall': 0.5212666446572026, 'f1-score': 0.441408070077346, 'support': 36348}, '1': {'precision': 0.40429516416467814, 'recall': 0.364853077468244, 'f1-score': 0.3835628214863955, 'support': 36686}, '2': {'precision': 0.35920705173503925, 'recall': 0.2648930334613275, 'f1-score': 0.30492367436500545, 'support': 36460}, 'accuracy': 0.38349133285842146, 'macro avg': {'precision': 0.3820899642224647, 'recall': 0.3836709185289247, 'f1-score': 0.376631521976249, 'support': 109494}, 'weighted avg': {'precision': 0.38213510342079404, 'recall': 0.38349133285842146, 'f1-score': 0.3765795693605986, 'support': 109494}}
[[18947  8953  8448]
 [14520 13385  8781]
 [16033 10769  9658]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1023154
{'0': {'precision': 0.3395778845569004, 'recall': 0.45814869522402757, 'f1-score': 0.39005135012400877, 'support': 12186}, '1': {'precision': 0.34613681647110917, 'recall': 0.2882824744168895, 'f1-score': 0.3145717016246668, 'support': 10847}, '2': {'precision': 0.3491090247173788, 'recall': 0.2829192546583851, 'f1-score': 0.31254824599022213, 'support': 12880}, 'accuracy': 0.3439979951549578, 'macro avg': {'precision': 0.3449412419151295, 'recall': 0.34311680809976736, 'f1-score': 0.3390570992462993, 'support': 35913}, 'weighted avg': {'precision': 0.3449772056868641, 'recall': 0.3439979951549578, 'f1-score': 0.3394577564806057, 'support': 35913}}
[[5583 2929 3674]
 [4600 3127 3120]
 [6258 2978 3644]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        17 (peak)  12.61 (ave)

============================================
